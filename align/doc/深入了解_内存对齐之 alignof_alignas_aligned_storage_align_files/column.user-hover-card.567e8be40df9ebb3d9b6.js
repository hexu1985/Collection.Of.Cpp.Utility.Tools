(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{1221:function(e,t,n){"use strict";n.r(t);var a=n(24),o=n(12),r=n(13),c=n(14),l=n(15),s=n(6),i=n(0),u=n(1),d=n.n(u),p=n(10),b=n(23),h=n(62),f=n(5),O=n(17),m=n(8),v=Object.assign;function j(e){return d.a.createElement(m.a,v(v({width:"24",height:"24",viewBox:"0 0 24 24","data-new-api":"BriefcaseFill24","data-old-api":"Company"},e),{className:"Zi Zi--Company"+(e.className?" ".concat(e.className):"")}),d.a.createElement("path",{d:"M21.5 8.199V18.8c0 .939-.768 1.699-1.715 1.699H4.215c-.947 0-1.715-.76-1.715-1.699V8.2c0-.938.768-1.699 1.715-1.699h15.572A1.707 1.707 0 0121.5 8.199zM6.944 11.5a.75.75 0 000 1.5h10.112a.75.75 0 000-1.5H6.944z",fillRule:"evenodd",clipRule:"evenodd"}),d.a.createElement("path",{d:"M6.75 5c0-.966.784-1.75 1.75-1.75h7c.966 0 1.75.784 1.75 1.75v2a.75.75 0 01-1.5 0V5a.25.25 0 00-.25-.25h-7a.25.25 0 00-.25.25v2a.75.75 0 01-1.5 0V5z",fillRule:"evenodd",clipRule:"evenodd"}))}var g=n(1615),w=n(132),y=n.n(w),M=n(323),k=n(177),C=n(82),R=n(209),S=n(295),N=n(250),B=n(150),U=n(2),x=n.n(U),T=n(7),F=n.n(T),P=n(18),E=n(79),A=n(1340),z=n(157),H=n(229),L=n(65),_=n(1280),q=n(37),G=n(1507),I=n(26);function V(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(s.a)(e);if(t){var o=Object(s.a)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return Object(l.a)(this,n)}}var Z=function(e){Object(c.a)(n,e);var t=V(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={modalShown:!1},e.handleSendMessage=function(){var t=e.props,n=t.onModalOpen,a=t.user.allowMessage,o=t.dispatch,r=t.doNotCheckAllowMessageSetting;a||void 0===a&&r?(e.setState({modalShown:!0}),n&&n()):o(Object(q.g)(I.N.blocked,"red")),O.a.trackEvent(Object(L.a)(e),{action:"Message",element:"Button",is_intent:!0})},e.handleCloseModal=function(){var t=e.props.onModalClose;e.setState({modalShown:!1}),t&&t()},e}return Object(r.a)(n,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.preset,a=e.color,o=e.icon,r=e.label,c=e.className,l=e.tooltip,s=e.tooltipPreset,u=e.authRequired,d=this.state.modalShown,p="3d198a56310c02c4a83efb9f4a4c027e"===t.id;return Object(i.c)(i.a,{children:[Object(i.b)(P.c,{preset:n,color:a,className:c,icon:o,label:r,onClick:u(this.handleSendMessage,p?I.P.serviceAccountMessage:I.P.message),"data-tooltip":l,"aria-label":l,"data-tooltip-preset":s}),Object(i.b)(G.a,{memberHashId:t.id,handleCloseModal:this.handleCloseModal,isModalShow:d})]})}}]),n}(u.Component);Z.propTypes={onModalOpen:x.a.func,onModalClose:x.a.func},Z.defaultProps={preset:"outline",color:"grey",icon:_.a,label:"发私信",doNotCheckAllowMessageSetting:!1};var J=Object(b.compose)(E.a,Object(p.connect)())(Z),K=n(211);function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(s.a)(e);if(t){var o=Object(s.a)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return Object(l.a)(this,n)}}var Q=function(e){Object(c.a)(n,e);var t=D(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={reportModalShown:!1},e.handleShieldUser=function(){var t=e.props,n=t.user.urlToken,a=t.updateUserBlocking,o=t.showNotification;a(n,!1).then((function(){return o("屏蔽已取消")}))},e}return Object(r.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.user,a=t.user,o=a.urlToken,r=a.isBlocking,c=a.isOrg,l=t.canShowMutualFollowStatus,s=t.className,u=t.buttonClassName,d=t.onModalOpen,p=t.onModalClose,b=t.authRequired,h=this.state.reportModalShown,f=F()("MemberButtonGroup",s);return r?Object(i.c)("div",{className:f,children:[Object(i.c)(P.c,{className:u,preset:"primary",color:"red",onClick:this.handleShieldUser,children:[Object(i.b)(A.a,{center:!0,text:!0})," 已屏蔽"]}),!c&&Object(i.c)(P.c,{className:u,onClick:b((function(){e.setState({reportModalShown:!0}),d&&d()}),I.P.report),children:["举报用户",Object(i.b)(H.a,{shown:h,onClose:function(){e.setState({reportModalShown:!1}),p&&p()},type:"member",urlToken:o,zaEnabled:!0})]})]}):Object(i.c)("div",{className:f,children:[Object(i.b)(z.a,{id:o,type:n.type,gender:n.gender,isFollowing:n.isFollowing,isFollowed:n.isFollowed,canShowMutualFollowStatus:l,className:u,preset:z.a.PRESETS.primary}),Object(i.b)(J,{user:n,className:u,onModalOpen:d,onModalClose:p})]})}}]),n}(u.Component);Q.propTypes={user:x.a.object.isRequired,buttonClassName:x.a.string,onModalOpen:x.a.func,onModalClose:x.a.func};var W=Object(b.compose)(E.a,Object(p.connect)(null,{updateUserBlocking:K.k,showNotification:q.g}))(Q);function X(e){var t=this,n=e.user,a=e.user.isOrg,o=e.className,r=e.buttonClassName,c=e.onModalOpen,l=e.onModalClose,s=e.currentUser,u=e.authRequired,d=e.router,p=F()("ProfileButtonGroup",o);return s&&n.urlToken===s.urlToken?Object(i.b)("div",{className:p,children:Object(i.c)(P.c,{color:"blue",className:r,onClick:u((function(){O.a.trackEvent(t,{action:"OpenUrl",element:"Link"},{link:{url:"".concat(location.origin,"/people/edit")}}),d.push("/people/edit")}),I.P.editProfile),children:["编辑",a?"机构":"个人","资料"]})}):Object(i.b)(W,{user:n,canShowMutualFollowStatus:!0,className:p,buttonClassName:r,onModalOpen:c,onModalClose:l})}X.propTypes={user:x.a.object.isRequired,buttonClassName:x.a.string,onModalOpen:x.a.func,onModalClose:x.a.func};var Y=Object(b.compose)(h.withRouter,E.a)(X),$=n(494),ee=n(106),te=n(844),ne=n(843),ae=["toggler","user","id","urlToken","mutuals","onRef","currentUser"];function oe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(s.a)(e);if(t){var o=Object(s.a)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return Object(l.a)(this,n)}}var re=function(e,t){return e.map((function(e){return t[e]})).slice(0,3)},ce=Object(C.isBrowser)()?y()(re,(function(e,t){return"".concat(e.join(","),"-").concat(t.length)})):re,le=[];var se=function(e){return Object(i.b)(f.Flex,Object.assign({css:{"&:not(:last-child)":{marginBottom:8}}},e))},ie=function(e){Object(c.a)(n,e);var t=oe(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={isLoading:!1,childModalOpened:!1},e.loadUserProfile=function(){var t=e.props,n=t.id,a=t.urlToken;return(0,t.dispatch)(Object(K.h)(a||n,!1))},e.load=function(){var t=e.props,n=t.id;(t.urlToken||n)&&(e.setState({isLoading:!0}),e.loadUserProfile().then((function(){return e.setState({isLoading:!1})})),e.loadMutuals())},e.loadMutuals=function(){var t=e.props,n=t.user,a=t.dispatch,o=t.mutuals,r=void 0===o?[]:o,c=t.currentUser;return!r.length&&c&&n?a(Object(K.f)(n.urlToken,"mutuals")):Promise.resolve()},e.track=function(){var t=e.props.user;e.hoverCardElement&&t&&(O.a.setModule(e.hoverCardElement,{module:"UserItem"},{card:{content:{type:"User",member_hash_id:t.id}}}),O.a.trackCardShow(e.hoverCardElement))},e.handleOpen=function(){e.load(),e.track()},e}return Object(r.a)(n,[{key:"render",value:function(){var e,t,n=this,o=this.props,r=o.toggler,c=o.user,l=o.id,s=o.urlToken,u=o.mutuals,d=void 0===u?[]:u,p=o.onRef,b=o.currentUser,O=Object(a.default)(o,ae),m=c||{},v=m.isOrg,w=m.headline,y=m.avatarUrl,C=m.badge,B=m.badgeV2,U=m.answerCount,x=m.articlesCount,T=m.followerCount,F=m.employments,P=m.coverUrl,E=m.gender,A=m.isFollowed,z=m.isFollowing,H=this.state,L=H.isLoading,_=H.childModalOpened,q=d.length,G=Object(k.d)(B||C),V=G.bestAnswerer,Z=G.identity,J="//www.zhihu.com/".concat(v?"org":"people","/").concat(s||l),K=b&&c&&b.urlToken===c.urlToken,D=q>0&&!K,Q=F&&F[0];if(null!=Z&&Z.length)t=Object(i.c)(se,{children:[Object(i.b)("a",{href:"".concat(I.x,"/account/verification/intro"),target:"_blank",rel:"noopener noreferrer",css:{marginRight:".3em"},children:Object(i.b)(k.a,{})}),Object(i.b)("div",{children:Z.slice(0,2).map((function(e){return e.description})).join("，")})]});else if(Q){var W=Q.company,X=Q.job;t=Object(i.c)(se,{children:[(W||X)&&Object(i.b)(f.Box,{as:"span",mr:".3em",color:"GBL05A",children:Object(i.b)(j,{text:!0,center:!0})}),Object(i.c)("div",{children:[W&&W.name,W&&X&&Object(i.b)(f.Box,{display:"inline-block",width:"1px",height:"10px",mx:"8px",bg:"GBK09A"}),X&&X.name]})]})}else t=null;return Object(i.c)(S.b,Object.assign(Object.assign({toggler:r,onOpen:this.handleOpen,isLoading:L,globalClose:!_,stickHover:_,preventCloseOnTarget:!0},O),{},{onRef:function(e){p&&"function"==typeof p&&p(e),n.hoverCardElement=e},children:[Object(i.b)(S.a,{coverUrl:P,title:Object(i.c)("span",{css:{display:"flex"},children:[Object(i.b)($.a,{user:c,noHoverCard:!0}),Object(i.b)(ne.a,{isFollowed:A,isFollowing:z})]}),subtitle:w&&Object(i.b)(N.a,{inline:!0,html:w}),avatarUrl:y}),(t||V||D)&&Object(i.c)("div",{children:[t,Boolean(null==V||null===(e=V.topics)||void 0===e?void 0:e.length)&&Object(i.c)(se,{children:[Object(i.b)("span",{css:{marginRight:".3em"},children:Object(i.b)(k.b,{})}),Object(i.c)("div",{children:[Object(i.b)(te.a,{expandable:!1,noHoverCard:!0,topics:V.topics,user:c}),"的优秀答主"]})]}),D&&Object(i.c)(se,{color:"GBL05A",children:[Object(i.b)(f.Box,{mr:".3em",children:Object(i.b)(g.a,{text:!0,center:!0})}),Object(i.b)("div",{children:Object(i.c)(M.CJKSpace,{children:[d.map((function(e,t){return Object(i.c)(h.Link,{to:"//www.zhihu.com/".concat(v?"org":"people","/").concat(e.urlToken),target:"_blank",children:[e.name,t<q-1&&"、"]},t)})),"也关注了",I.H[E]]})})]})]}),Object(i.c)("div",{children:[Object(i.c)(R.a,{children:[Object(i.b)(R.a.Item,{tag:ee.a,preset:"plain",to:"".concat(J,"/answers"),name:"回答",value:U,target:"_blank"}),Object(i.b)(R.a.Item,{tag:ee.a,preset:"plain",to:"".concat(J,"/posts"),name:"文章",value:x,target:"_blank"}),Object(i.b)(R.a.Item,{tag:ee.a,preset:"plain",to:"".concat(J,"/followers"),name:"关注者",value:T,target:"_blank"})]}),c&&!K&&Object(i.b)(Y,{className:"HoverCard-buttons",user:c,onModalOpen:function(){n.hoverCardElement.style.opacity="0",n.setState({childModalOpened:!0})},onModalClose:function(){return n.setState({childModalOpened:!1})}})]})]}))}}]),n}(u.PureComponent);t.default=Object(b.compose)(B.a,Object(p.connect)((function(e,t){var n=t.id,a=t.urlToken,o=e.entities,r=e.people.mutualsByUser,c=o.users[a]||Object.values(o.users).find((function(e){return e.id===n}))||t.user,l=r[a||n]||{ids:le,isFetching:!1},s=l.ids,i=l.isFetching;return{user:c,mutuals:ce(s,o.users),isFetching:i}})))(ie)},1615:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(1),o=n.n(a),r=n(8),c=Object.assign;function l(e){return o.a.createElement(r.a,c(c({width:"24",height:"24",viewBox:"0 0 24 24","data-new-api":"UsersFill24","data-old-api":"Users"},e),{className:"Zi Zi--Users"+(e.className?" ".concat(e.className):"")}),o.a.createElement("path",{d:"M4.5 8A5.5 5.5 0 0110 2.5 5.5 5.5 0 0115.5 8a5.5 5.5 0 01-5.5 5.5A5.5 5.5 0 014.5 8zm-.602 7.738c.965-1.075 2.418-1.574 4.19-1.325 1.263.178 2.56.178 3.825 0 1.77-.249 3.224.25 4.189 1.325.628.7 1.212 1.69 1.657 2.656.442.961.78 1.973.868 2.733.07.6-.424 1.023-.927 1.023H2.3c-.503 0-.997-.423-.927-1.023.088-.76.426-1.772.868-2.733.444-.967 1.029-1.956 1.657-2.656zm12.312-2.046a.743.743 0 01-.309-.24.747.747 0 01.081-.995c.338-.335.655-.827.92-1.37.441-.906.652-1.98.59-3.065-.036-.607-.135-1.289-.302-1.782a.75.75 0 011.42-.48c.228.672.34 1.503.379 2.176.076 1.327-.178 2.658-.739 3.809a7.991 7.991 0 01-.594 1.028c.89.564 1.632 1.316 2.22 2.083.768 1.002 1.308 2.075 1.585 2.907a.75.75 0 11-1.423.474c-.223-.668-.682-1.595-1.352-2.468-.667-.87-1.507-1.643-2.476-2.077z",fillRule:"evenodd",clipRule:"evenodd"}))}}}]);
//# sourceMappingURL=column.user-hover-card.567e8be40df9ebb3d9b6.js.map