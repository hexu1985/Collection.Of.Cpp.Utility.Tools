(self.webpackChunkheifetz=self.webpackChunkheifetz||[]).push([[8593],{62639:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(87363),o=n.n(r),i=n(66980),a=Object.assign,c=function(e){return o().createElement(i.Z,a({width:"18",height:"18",viewBox:"0 0 18 18"},e),o().createElement("path",{d:"M5.457 10.786 2.21 9.974a.54.54 0 0 1 0-1.048l3.248-.812a2.414 2.414 0 0 0 1.757-1.757l.812-3.248a.54.54 0 0 1 1.048 0l.812 3.248c.216.865.892 1.54 1.757 1.757l3.247.812a.54.54 0 0 1 0 1.048l-3.248.812a2.414 2.414 0 0 0-1.756 1.757l-.812 3.248a.54.54 0 0 1-1.048 0l-.812-3.248a2.414 2.414 0 0 0-1.757-1.757ZM13.697 1.584a.27.27 0 0 1 .506 0l.454 1.227a.9.9 0 0 0 .532.532l1.227.454a.27.27 0 0 1 0 .506l-1.227.454a.9.9 0 0 0-.532.532l-.454 1.227a.27.27 0 0 1-.506 0l-.454-1.227a.9.9 0 0 0-.532-.532l-1.227-.454a.27.27 0 0 1 0-.506l1.227-.454a.9.9 0 0 0 .532-.532l.454-1.227Z"}))}},80685:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(87363),o=n.n(r),i=n(66980),a=Object.assign,c=function(e){return o().createElement(i.Z,a({width:"16",height:"16",fill:"none",viewBox:"0 0 16 16"},e),o().createElement("g",{clipPath:"url(#id-1734640460-a)",dataFigmaSkipParse:"true"},o().createElement("foreignObject",{width:"2250",height:"2250",x:"-1125",y:"-1125",transform:"matrix(.00667 0 0 .00667 8 8)"},o().createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",style:{background:"conic-gradient(from 90deg,rgba(133,144,166,.1357) 0deg,#8590a6 277.5deg,rgba(133,144,166,0) 316.439deg,rgba(133,144,166,.1357) 360deg)",height:"100%",width:"100%",opacity:"1"}}))),o().createElement("path",{d:"M13.46 4.032a.75.75 0 0 0-1.213.882l1.214-.882ZM8 2.75a.75.75 0 1 0 0-1.5v1.5Zm4.854 1.723-.607.441a5.25 5.25 0 0 1 .999 3.292l.75.03.749.029a6.75 6.75 0 0 0-1.284-4.233l-.607.441Zm1.141 3.763-.749-.03a5.25 5.25 0 0 1-1.254 3.204l.57.487.57.487a6.75 6.75 0 0 0 1.613-4.119l-.75-.03Zm-1.433 3.66-.57-.486a5.25 5.25 0 0 1-2.968 1.74l.147.735.146.735a6.75 6.75 0 0 0 3.816-2.236l-.57-.487Zm-3.391 1.989-.147-.736a5.25 5.25 0 0 1-3.407-.471l-.34.668-.341.668a6.75 6.75 0 0 0 4.38.606l-.145-.735Zm-3.895-.539.34-.668a5.25 5.25 0 0 1-2.384-2.48l-.68.314-.682.314a6.75 6.75 0 0 0 3.066 3.188l.34-.668Zm-2.725-2.834.681-.314a5.25 5.25 0 0 1-.337-3.424l-.73-.175-.728-.175a6.75 6.75 0 0 0 .433 4.402l.681-.314Zm-.385-3.913.73.175A5.25 5.25 0 0 1 4.75 3.877l-.465-.589-.464-.589a6.75 6.75 0 0 0-2.385 3.725l.73.175Zm2.12-3.31.464.588A5.25 5.25 0 0 1 8 2.75v-1.5A6.75 6.75 0 0 0 3.821 2.7l.464.588Z",dataFigmaGradientFill:'{"type":"GRADIENT_ANGULAR","stops":[{"color":{"r":0.52156865596771240,"g":0.56470590829849243,"b":0.65098041296005249,"a":1.0},"position":0.77083331346511841},{"color":{"r":0.52156865596771240,"g":0.56470590829849243,"b":0.65098041296005249,"a":0.0},"position":0.87899827957153320}],"stopsVar":[],"transform":{"m00":13.333333015441895,"m01":5.5631016948609613e-07,"m02":1.3333336114883423,"m10":-5.5630999895583955e-07,"m11":13.333333015441895,"m12":1.333334207534790},"opacity":1.0,"blendMode":"NORMAL","visible":true}'}),o().createElement("defs",null,o().createElement("clipPath",{id:"id-1734640460-a"},o().createElement("path",{d:"M13.46 4.032a.75.75 0 0 0-1.213.882l1.214-.882ZM8 2.75a.75.75 0 1 0 0-1.5v1.5Zm4.854 1.723-.607.441a5.25 5.25 0 0 1 .999 3.292l.75.03.749.029a6.75 6.75 0 0 0-1.284-4.233l-.607.441Zm1.141 3.763-.749-.03a5.25 5.25 0 0 1-1.254 3.204l.57.487.57.487a6.75 6.75 0 0 0 1.613-4.119l-.75-.03Zm-1.433 3.66-.57-.486a5.25 5.25 0 0 1-2.968 1.74l.147.735.146.735a6.75 6.75 0 0 0 3.816-2.236l-.57-.487Zm-3.391 1.989-.147-.736a5.25 5.25 0 0 1-3.407-.471l-.34.668-.341.668a6.75 6.75 0 0 0 4.38.606l-.145-.735Zm-3.895-.539.34-.668a5.25 5.25 0 0 1-2.384-2.48l-.68.314-.682.314a6.75 6.75 0 0 0 3.066 3.188l.34-.668Zm-2.725-2.834.681-.314a5.25 5.25 0 0 1-.337-3.424l-.73-.175-.728-.175a6.75 6.75 0 0 0 .433 4.402l.681-.314Zm-.385-3.913.73.175A5.25 5.25 0 0 1 4.75 3.877l-.465-.589-.464-.589a6.75 6.75 0 0 0-2.385 3.725l.73.175Zm2.12-3.31.464.588A5.25 5.25 0 0 1 8 2.75v-1.5A6.75 6.75 0 0 0 3.821 2.7l.464.588Z"}))))}},15243:function(e,t){"use strict";t.Z={Popover:"ddLajxN_Q0AuobBZjX9m",arrow:"W329ne7r9Ot4gzRWR_AA","arrow--top":"w2j9r5Z9lHt9PvAmRayf","arrow--bottom":"cApyvfK_BuxctlL0gXe_","arrow--left":"saunLECwfTBPsqThUWtO","arrow--right":"RhQaE5TkssFiFDfVK18R",content:"Hd4HpgivEXthJjQIraJI","content-enter":"ANnfP2VN3I39bhxQBO6U","content-enter-active":"IJ34IiXWG8RSIazVpj4O","content-leave":"i5jbKhy30Rl2CfXvIatH","content-leave-active":"MOQr6PlCSuOsv44V0nUy","content--fixed":"iu6FC73GJyA4U_F5hVlW","content--top":"Q3aW4lGNloPwsNZozG74","content--arrowed":"ppT2GYHiMrV3Rj29VP7O","content--enter":"qNMJ8yjaJck7PqHKsACa","content--bottom":"PyIzdhf5t6OptzHvhQKO","content--left":"J1kFp8NPNRphbsX0iU3g","content--right":"w7Vrabm02QLkRZ5iseWC"}},31504:function(e,t,n){"use strict";var r,o,i,a,c,s,u,l,d,p,f,h,_,m=n(85879),g=n(49899);n(37237);var T=n(82452),E=n(28005),y=n(81901),C=n(29087),S=n(53862),I=n(54231),A=n(84286),b=n(87363),w=n.n(b),Z=n(78193),x=n.n(Z),k=n(55462),R=n(79855),N=n(67516),O=n.n(N),P=n(80714);n(97476);var D=n(66263),L=n(45732),M=n(23113),B=n(22107),U=n(94707),G=n(55164),F=n(71728),H=n(18645),z=n(32599),q={mark:function(){return null},measure:function(){return null},getEntriesByType:function(){return[]},getEntriesByName:function(){return[]},clearMarks:function(){return null},clearMeasures:function(){return null}},V="undefined"!=typeof window&&window.performance?window.performance:q,W=function(e){V.mark(e)},X=function(e,t,n){try{var r,o=V.measure(n,e,t);return null!==(r=null==o?void 0:o.duration)&&void 0!==r?r:null}catch(e){return null}},K=function(e,t){var n=V.getEntriesByType("navigation"),r=V.getEntriesByName(e,"mark")[0];if(!n.length||!r)return null;var o=n[0].navigationStart;try{return V.measure(t,{start:o,end:r.startTime}).duration}catch(e){return null}},j=function(e){var t=e.spanName,n=e.data,r=(0,F._)(e,["spanName","data"]),o=n?Object.keys(n).reduce(function(e,t){return e["".concat(t,".default")]=n[t],e},{}):void 0;(0,I.nP)((0,G._)({spanName:"WebVitals.".concat(t)},o&&{data:o},r))},Y=function(){function e(t,n){(0,B._)(this,e),this.env=t,this.spanName=n,this.data={},this.hasFlushed=!1,this.flushTimer=null,this.eventListeners=null,this.requiredMetrics=new Set(["responseEnd","domInteractive","FCP","TTFB","HydrateDuration"]),this.collectedMetrics=new Set,this._addEventListeners()}return(0,U._)(e,[{key:"_addEventListeners",value:function(){var e=this;if("undefined"!=typeof window){var t=function(){"hidden"===document.visibilityState&&e.flush()},n=function(){return e.flush()};document.addEventListener("visibilitychange",t),window.addEventListener("pagehide",n),window.addEventListener("beforeunload",n),"complete"===document.readyState?this._checkAndFlush():window.addEventListener("load",function(){return e._checkAndFlush()},{once:!0}),setTimeout(function(){return e.flush()},1e4),this.eventListeners={remove:function(){document.removeEventListener("visibilitychange",t),window.removeEventListener("pagehide",n),window.removeEventListener("beforeunload",n)}}}}},{key:"_removeEventListeners",value:function(){this.eventListeners&&(this.eventListeners.remove(),this.eventListeners=null)}},{key:"_checkAndFlush",value:function(){var e=this;Array.from(this.requiredMetrics).every(function(t){return e.collectedMetrics.has(t)})&&(this.flushTimer&&clearTimeout(this.flushTimer),this.flushTimer=setTimeout(function(){e.flush()},500))}},{key:"addMetric",value:function(e,t){return!this.hasFlushed&&"number"==typeof t&&!!Number.isFinite(t)&&(this.data[e]=t,this.collectedMetrics.add(e),this._checkAndFlush(),!0)}},{key:"getPlatform",value:function(e){if(e.userAgent){var t=e.userAgent,n=[[t.Android,"Android"],[t.iOS,"iOS"],[t.HarmonyOS,"OpenHarmony"],[!t.Mobile,"v1"]].find(function(e){return e[0]});if(n)return n[1]}return"unknown"}},{key:"flush",value:function(){if(!this.hasFlushed&&0!==Object.keys(this.data).length){this.hasFlushed=!0,this.flushTimer&&(clearTimeout(this.flushTimer),this.flushTimer=null);var e=this.getPlatform(this.env);j({spanName:this.spanName,sampleRate:1,data:this.data,_options:{version:e}}),this._removeEventListeners()}}},{key:"dispose",value:function(){this._removeEventListeners(),this.flushTimer&&(clearTimeout(this.flushTimer),this.flushTimer=null)}}]),e}(),Q=function(e){if("function"!=typeof PerformanceObserver)return null;var t=["responseEnd","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd"],n=new PerformanceObserver(function(r){var o=r.getEntriesByType("navigation");if(o.length){var i=o[0];t.forEach(function(t){var n=i[t];n>0&&e.addMetric(t,Math.round(n))});var a=i.domContentLoadedEventStart,c=i.domContentLoadedEventEnd,s=i.responseEnd;a>0&&c>0&&e.addMetric("domContentLoadDuration",Math.round(c-a)),s>0&&c>0&&e.addMetric("clientReceiveToDCLDuration",Math.round(c-s)),n.disconnect()}});try{n.observe({type:"navigation",buffered:!0})}catch(e){return n.disconnect(),null}return n},J=function(e){if("function"==typeof H.U9)try{(0,H.U9)(function(t){var n=t.name,r=t.value;["FCP","LCP","FID","CLS","INP","TTFB"].includes(n)&&e.addMetric(n,r)})}catch(e){}},$=function(e){if("function"==typeof PerformanceObserver){var t=new PerformanceObserver(function(t){t.getEntries().forEach(function(t){var n=t.name,r=t.duration;n.includes("Hydrate")&&e.addMetric(n,r),[z.b.HydrateDuration,z.b.HydrateStart,z.b.HydrateEnd].includes(n)&&e.addMetric(n,r)})});return t.observe({entryTypes:["measure"]}),t}return null},ee=function(e,t){if(t&&"string"==typeof t){var n="undefined"==typeof window?q:window.performance||q,r=new Y(e,t);J(r);var o=$(r),i=Q(r);return setTimeout(function(){var e,t;((null===(e=n.getEntriesByType)||void 0===e?void 0:e.call(n,"mark"))||[]).forEach(function(e){z.b[e.name]&&r.addMetric(e.name,e.startTime)}),((null===(t=n.getEntriesByType)||void 0===t?void 0:t.call(n,"measure"))||[]).forEach(function(e){var t=e.name,n=e.duration;t===z.b.HydrateDuration&&r.addMetric(t,n),["HydrateStart","HydrateEnd","HydrateDuration"].some(function(e){return t.includes(e)})&&r.addMetric(t,n)})},100),function(){o&&o.disconnect(),i&&i.disconnect(),r.dispose()}}},et=["Search","ProfileTimeline"],en=function(e,t){if(t&&"string"==typeof t){var n=e.userAgent.Mobile,r=!n&&et.includes(t);if(n||r){if("function"==typeof V.getEntriesByName&&V.getEntriesByName(z.b.HydrateStart,"mark").length>0)try{V.measure(z.b.HydrateDuration,z.b.HydrateStart,z.b.HydrateEnd)}catch(e){console.error(e)}if(n){(0,z.C4)(e,t),ee(e,t);return}r&&ee(e,t)}}},er=n(57477),eo=n(11558),ei=n(47570),ea=n(74135),ec=n(54422),es=function(e){if(204===e.status||"0"===e.headers.get("content-length"))return!1;var t=e.headers.get("content-type");return t&&-1!==t.indexOf("application/json")};function eu(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e(t,n).catch(function(e){throw e.fetchOptions=n,e}).then(function(e){return n.responseProcessor?n.responseProcessor(e):es(e)?e.json().then(function(t){return{json:t,res:e}}):e.text().then(function(t){return{text:t,res:e}})}).then(function(e){var t=e.json,r=e.text,o=e.res,i=e.payload,a=(0,ea.camelizeKeys)(t),c=a||r||i,s=t||r||i,u=a&&a.code;if(o.status>=300||u&&!n.ignoreCode){var l,d=new eo.Z(o,n);throw d.payload=null!==(l=null==c?void 0:c.error)&&void 0!==l?l:c,d.res=o,d}return a&&Array.isArray(a)&&(c={count:Number(o.headers.get("x-result-count")),data:a},s=(0,er._)((0,G._)({},c),{data:t})),Object.assign(o,{res:o,payload:c,payloadOrigin:s})})}}function el(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=(0,ei.Z)(fetch,e);return function(e,r){return e=e.replace("zhuanlan.zhihu.com/api/api","zhuanlan.zhihu.com/api"),!(0,ec.sD)(e)&&t&&(e="".concat(/zhihu.(com|dev)$/.test(t)?"":"http".concat("s",":"),"//").concat(t).concat(e)),n(e,r)}}var ed=n(87320),ep=n(15030),ef=n(94009),eh=n(18837),e_=n.n(eh);function em(e){return e.replace(/(members|people|roundtables?)\/(\w+)/g,"$1").replace(/(\/appview|\/api|\/v4|\/\d+|-|\w{32})/g,"").substring(1).replace(/\//g,"-")||"Unknown"}var ev=function(){function e(){var t=this;(0,B._)(this,e),(0,ed._)(this,"_apiStatus",void 0),(0,ed._)(this,"_timer",null),(0,ed._)(this,"prefer",function(e,n){var r=(0,ef._)(t._getApiStatus(e),2),o=r[0];return!1===r[1]?(eE("checking_again",o),t.check(o),n):e}),(0,ed._)(this,"check",function(e){var n=(0,ef._)(t._getApiStatus(e),2),r=n[0];!1===n[1]&&t._timer||(t._deactivate(r),t._ticktock())}),(0,ed._)(this,"_getApiStatus",function(e){var n=eg(e);return[n,t._apiStatus.get(n)]}),(0,ed._)(this,"_healing",function(e){t._apiStatus.delete(e),eE("healing",e)}),(0,ed._)(this,"_deactivate",function(e){t._apiStatus.set(e,!1)}),(0,ed._)(this,"_ticktock",function(){if(!t._timer){var e=1e3*(Math.floor(7*Math.random())+8);console.log("HealthCheckProbe will check after ".concat(e,"ms.")),t._timer=setTimeout(function(){Promise.all(Array.from(t._apiStatus.entries()).map(function(e){return(0,ef._)(e,1)[0]}).map(function(e){return fetch(e).then(function(t){return[e,t.ok]},function(){return[e,!1]})})).then(function(e){e.forEach(function(e){var n=(0,ef._)(e,2),r=n[0];t[n[1]?"_healing":"_deactivate"](r),eE("checked",r)})}).finally(function(){t._timer&&clearTimeout(t._timer),t._timer=null})},e)}}),this._apiStatus=new Map}return(0,U._)(e,null,[{key:"instance",value:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();function eg(e){return e.split("?")[0]}(0,ed._)(ev,"_instance",null);var eT=e_()(em);function eE(e,t){var n=new URL(t,"https://www.zhihu.com");I.ZP.increment("HCP.".concat(e,".").concat(eT(n.pathname),".count"))}var ey=n(57045),eC=Object.values(D.AW);function eS(e){var t=e.payload,n=e.res,r=t||{},o=r.code,i=r.message;if(403===(n&&n.status)&&eC.includes(o)){var a=Object.keys(D.AW).find(function(e){return D.AW[e]===o});location.href="/account/unhuman?".concat(ey.stringify({type:a,message:i,next:location.href}))}throw e}var eI=n(4667),eA=n.n(eI),eb=eA()(function(){var e,t={xZst81:void 0};try{window.addEventListener("wdfs1",function(e){var n;t.xZst81=null==e?void 0:null===(n=e.detail)||void 0===n?void 0:n.xzst81}),n.e(1243).then(n.t.bind(n,80177,23)).then(function(e){var n=e.wdfs1;t.xZst81=n()})}catch(t){null===(e=window.Raven)||void 0===e||e.captureException(t,{fingerprint:["zswsdid-sdk"],level:"warning"})}return t}),ew=n(62082);function eZ(e){var t=e.protocol,n=e.host;return[t?t.replace(":",""):"",n?n.replace(/\.|:/g,"-"):""].join("-")}var ex=function(e,t){var n,r=null==t?void 0:t();if(r){var o={type:"ZERR_NO_AUTH_TOKEN",appName:"heifetz",spanName:"default",error:{name:e.name,message:e.message,payload:e.payload||"Unknown"},currentUser:r};(0,ew.zB)(o),null===(n=window.Raven)||void 0===n||n.captureMessage("ZERR_NO_AUTH_TOKEN",{extra:o})}},ek=n(10840),eR=n(20382),eN=n(91723),eO=n(88545),eP={skipAutoSign:function(e){return!1},captureException:function(e,t){var n;null===(n=window.Raven)||void 0===n||n.captureException(e,{fingerprint:["ZsAutoSignature"],extra:t})}},eD=function(e){var t=e.ua,n=e.authInfo,r=e.passVars,o=e.xUDId;return t.ZhihuHybrid||t.Zhihu?(0,eN.Z)({userAgent:t,authInfo:n,xUDId:o,xAppVersion:null==r?void 0:r["x-app-version"],xZst81:null==r?void 0:r["x-zst-81"]},eP):(0,eO.Z)({},eP)},eL=function(){return null},eM=n(4661),eB=n(58909),eU=n(7407),eG=n(3343),eF=n(54826),eH=n(63315),ez=n(29065),eq=function(e,t){var n=Object.keys(t).map(function(e){var n=t[e];return"".concat(e,"=").concat(n)}).join("&"),r=e.includes("?")?"&":"?";return"".concat(e).concat(r).concat(n)},eV=function(e,t){try{var n=new URL(e,"https://www.zhihu.com"),r=new URLSearchParams(n.search),o=r.get("member_id"),i=r.get("creator_token"),a={};return!o&&t.member_id&&(a.member_id=t.member_id),!i&&t.creator_token&&(a.creator_token=t.creator_token),eq(e,a)}catch(e){console.error(e)}return e},eW=["Creator","OrgAnalyticsWork"],eX=function(e){var t=e.query,n=t.member_id,r=t.creator_token,o=e.spanName,i=e.isOffice,a=(n||r)&&eW.some(function(e){return o.includes(e)});return function(e){return a?function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=a.method;return"GET"===(void 0===c?"GET":c)&&(t=eV(t,i?{member_id:n,creator_token:r}:"OrgAnalyticsWork"===o?{creator_token:r}:{})),e(t,a)}:e}},eK=n(57138),ej=n(47024),eY=n(61533),eQ=n.n(eY),eJ=n(39658),e$=n(51770),e0=n(13649),e1=n(26144),e2=n(6080),e3=n(10644),e4=n(41402),e5=n(5150),e6=n(92258),e7=n(63638),e8=n(32e3),e9=(0,b.createContext)({totalOffset:0}),te=function(e){var t=e.children,n=(0,ef._)((0,b.useState)(function(){return new Map}),2),r=n[0],o=n[1],i=(0,b.useCallback)(function(e,t){return o(function(n){return new Map(n.set(e,t))})},[]),a=(0,b.useCallback)(function(e){return o(function(t){return t.delete(e),new Map(t)})},[]),c=(0,b.useMemo)(function(){var e=0;return r.forEach(function(t){return e+=t}),{totalOffset:e,addOffset:i,removeOffset:a}},[i,r,a]);return(0,m.tZ)(e9.Provider,{value:c,children:t})},tt=function(e,t){var n=(0,b.useContext)(e9),r=n.addOffset,o=n.removeOffset;(0,b.useEffect)(function(){if(e)return r(e,t),function(){o(e)}},[e,t,r,o])},tn=function(e){return tt(e.id,e.height),null},tr=(0,b.forwardRef)(function(e,t){var n=e.name,r=e.offset,o=(0,F._)(e,["name","offset"]),i=(0,b.useContext)(e9).totalOffset;return(0,m.tZ)("a",(0,G._)({ref:t,name:n,css:{display:"block",position:"relative",top:-i+(void 0===r?0:r),width:0,height:0}},o))}),to=n(17727),ti=n(67689),ta=n(77350),tc=n(70400),ts=function(e){var t=e.store,n=e.canaryConfig,r=e.children,o=t.getState().env.userAgent,i=(0,ef._)((0,b.useState)(function(){return(0,e3.Z)()}),1)[0];return(0,m.tZ)(e6.Provider,{store:t,children:(0,m.tZ)(e5.HK,{children:(0,m.BX)(e7.ZAProvider,{children:[(0,m.tZ)(eJ.ql,{htmlAttributes:{"data-theme":"light"}}),(0,m.tZ)(e0.I.Provider,{value:o,children:(0,m.tZ)(e4.nq,{value:i,children:(0,m.tZ)(e1.d,{isDarkMode:!1,ua:o,children:(0,m.tZ)(te,{children:(0,m.tZ)(ti.j,{children:(0,m.tZ)(e2.a,{value:n,children:(0,m.tZ)(e$.c6,{preProxyUrl:null,useDevProxy:!0,children:r})})})})})})})]})})})},tu={en:"en.zhihu.com"},tl=function(e){var t=e.store,n=e.canaryConfig,r=e.children,o=t.getState().env,i=o.theme,a=o.userAgent,c=o.ctx,s=(0,ef._)((0,b.useState)("dark"===i),2),u=s[0],l=s[1],d=(0,ef._)((0,b.useState)(function(){return(0,e3.Z)()}),1)[0];return((0,b.useEffect)(function(){if(a.ZhihuHybrid)return(0,k.Z)("base/themeChange").listen(function(e){l("dark"===e.theme)})},[a.ZhihuHybrid]),c.host===tu.en||c.host&&c.host.includes("--en-zhihu-com"))?(0,m.tZ)(ts,(0,G._)({},e)):(0,m.tZ)(e6.Provider,{store:t,children:(0,m.tZ)(e5.HK,{children:(0,m.BX)(e7.ZAProvider,{children:[(0,m.tZ)(eJ.ql,{htmlAttributes:{"data-theme":u?"dark":"light"}}),(0,m.tZ)(e0.I.Provider,{value:a,children:(0,m.tZ)(to.YY.Provider,{value:u,children:(0,m.tZ)(to.Ge.Provider,{value:l,children:(0,m.tZ)(e4.nq,{value:d,children:(0,m.tZ)(e1.d,{isDarkMode:u,ua:a,children:(0,m.tZ)(te,{children:(0,m.tZ)(ti.j,{children:(0,m.tZ)(e2.a,{value:n,children:(0,m.tZ)(ew.ZP,{appName:"heifetz",fallback:(0,m.tZ)(tc.ds,{}),release:P.Z.release,children:(0,m.tZ)(e$.c6,{preProxyUrl:null,useDevProxy:!0,children:(0,m.tZ)(e8.iH,{children:(0,m.tZ)(ta.Z,{path:c.path,children:r})})})})})})})})})})})})]})})})},td=n(81956),tp=n(75597),tf=n(74128),th=n(55536),t_=n(31252),tm=(0,th.combineReducers)({global:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{count:0},t=arguments.length>1?arguments[1]:void 0;if("undefined"==typeof window)return e;var n=t.type;return n.endsWith("request")?{count:e.count+1}:n.endsWith("success")||n.endsWith("failure")?{count:e.count?e.count-1:0}:e},local:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.id,o=t.urlToken;return["request","success","failure"].includes(n.split("/").pop())?(0,er._)((0,G._)({},e),(0,ed._)({},"".concat(n.slice(0,n.lastIndexOf("/")),"/").concat(r||o||""),n.endsWith("request"))):e}}),tv=n(6366),tg=n(22712),tT=n(8866),tE=n(89250),ty=n(58857),tC=n(79540),tS=n(84054),tI=n.n(tS),tA={BABY:"knowledgeBaby",B_SIDE:"bSide",DIGITAL:"knowledgeDigital",CREATOR_SUPPORT:"creatorSupport",ACG:"knowledgeAcg",XIAOPENG_CAR:"knowledgeXiaopengCar",CAR:"knowledgeCar",SEA_SALT:"seaSalt",SCIENCE:"knowledgeScience",VIDEO_MAKER_ACQUISITION:"videoMakerAcquisition",VIDEO_MAKER_ACQUISITION_V2:"videoMakerAcquisitionV2",VIDEO_MAKER_ACQUISITION_V3:"videoMakerAcquisitionV3",BRAND_RENEWAL_QA:"brandRenewalQa",BRAND_RENEWAL_QA_ACTION:"brandRenewalQaAction",VOTE:"vote",ZHIHU_CAR:"zhihuCar",SCHOOL_NEWS:"schoolNews"};d={},(0,ed._)(d,tA.BABY,{id:3}),(0,ed._)(d,tA.B_SIDE,{id:4}),(0,ed._)(d,tA.DIGITAL,{id:5}),(0,ed._)(d,tA.ACG,{id:10}),(0,ed._)(d,tA.XIAOPENG_CAR,{id:11}),(0,ed._)(d,tA.CAR,{id:12}),(0,ed._)(d,tA.SCIENCE,{id:15}),(0,ed._)(d,tA.VIDEO_MAKER_ACQUISITION,{id:1}),(0,ed._)(d,tA.VIDEO_MAKER_ACQUISITION_V2,{id:3}),(0,ed._)(d,tA.VIDEO_MAKER_ACQUISITION_V3,{id:5}),(0,ed._)(d,tA.VOTE,{id:2}),(0,ed._)(d,tA.ZHIHU_CAR,{id:21});var tb=(0,G._)({},(0,eM.FH)("campaign",["LOAD_SINGLE","TOGGLE_FOLLOW_USER","APPLY_KNOWLEDGE","LOAD_LIST","POLL","REFRESH_VIDEO_LIST","ACCEPT_INVITATION","SUBMIT_INVITATION_CODE","APPLY_VIDEO_MAKER_ACQUISITION","LOAD_INVITEE_INFO","APPLY_ACCEPT_INVITE","APPLY_INVITE","LOAD_VOTE_USERS","APPLY_VOTE","GET_SHARE_POSTER","GET_IDENTITY_VERIFY_STATUS","FOLLOW_USER"]),(0,eM.co)("campaign",["UPDATE_ZHIHU2020_RECOMMENDED_MEMBER_FOLLOE_STATUS","REFRESH_RESERVATION","SHARE_POSITION"])),tw="boarding",tZ=(0,G._)({},(0,eM.FH)(tw,["GET","GET_SHARE_LINK","GET_SHARE_POSTER","GET_BUBBLES","GET_REWARD_LIST","GET_WITHDRAWAL_LIST","BIND_INVITER","GET_INVITER","GET_INVITE_LIST","CALL","DRAW_REWARD","GET_TASK","GET_NOTIFICATION","WITHDRAW"]),(0,eM.co)(tw,["CLEAR"])),tx={},tk="card-collecting",tR=(0,G._)({},(0,eM.FH)(tk,["GET_PROFILE","DRAW_PRIZE","GET_TASK_LIST","GET_SHARE_LINK","GET_GIVER_INFO","GET_INVITER_INFO","GET_PROFILE","GET_CARD_LIST","FUSE_CARD","GET_SHARE_KEY","GET_FUSE_STATUS","GET_RECEIVED_CARD","RECEIVE_CARD","GET_PRIZE_LIST","GET_SHARE_POSTER","WITHDRAW"]),(0,eM.co)(tk,["SET_MODAL","SET_PANEL","SHIFT_CARD","SET_NEW_COIN_COUNT","SET_SHARE_INTENTION","CONSUME_NEW_USER_CARD","SET_MESSAGE","CLEAR_RECEIVED_CARD","CLEAR_PRIZE"])),tN={message:null,profile:{balance:"0",chance:0,coinNum:0,gatherClose:!1,isGotMagicCard:!1,isPay:!1,partitionStart:!1,totalDone:0,withdrawStart:!1},sharePoster:{share:"",sendCard:"",invite:""},shareLink:null,shareIntention:"share",shareKey:null,shareCardId:null,inviterInfo:null,giverInfo:null,prize:null,receivedCard:null,newCoinCount:null,newCardList:[],newUserCardCount:1,taskList:[],prizeList:null,cardList:null,panel:{showTaskPanel:!1,showRewardPanel:!1},modal:{showWelcomeModal:!1,showFusionModal:!1,showFusionPromptModal:!1,showShareModal:!1,showBackModal:!1}},tO=(0,eM.FH)("searchGaokaoSubPage",["GET_ACE_MAJORS","GET_EMPLOYMENT_DESTINATION","GET_SCORES","GET_ADMISSIONS_GUIDE","GET_ADMISSIONS_PLAN","GET_ADMISSIONS_INFO","GET_ADMISSIONS_SCHOOL","GET_IMAGES","GET_PROVINCE_LINE","GET_SCHOOL_INFO","GET_COURSES","GET_COLLEGES","GET_STATS","GET_TOPIC","GET_SCORE_STAGE"]),tP=(0,eM.co)("searchGaokaoSubPage",["UPDATE_ADMISSIONS_INFO"]),tD=(0,eM.FH)("searchHealth",["GET_HEALTH"]),tL=(0,G._)({},(0,eM.FH)("zhiboPandian2020",["GET_STATISTICS"])),tM=n(31824);(0,tM.P1)([eU.Xj,function(e){var t,n,r,o;return null===(t=e.campaign)||void 0===t?void 0:null===(n=t.single)||void 0===n?void 0:null===(r=n.featuredQuestionsConfig)||void 0===r?void 0:null===(o=r.data)||void 0===o?void 0:o.config}],function(e,t){return t?e?t:t.filter(function(e){return"1"===e.isPublic}):null});var tB=(0,th.combineReducers)({single:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.meta,o=t.payload,i=t.needMerge;if(n===tb.LOAD_SINGLE.request)return(0,er._)((0,G._)({},e),(0,ed._)({},r.stateKey,(0,er._)((0,G._)({},e[r.stateKey]),{refreshLoading:!0})));if(n===tb.LOAD_SINGLE.success){var a=r.time;return(0,er._)((0,G._)({},e),(0,ed._)({},r.stateKey,(0,er._)((0,G._)({},i&&e[r.stateKey],o,a&&{time:a}),{refreshLoading:!1})))}return n===tb.LOAD_SINGLE.failure?(0,er._)((0,G._)({},e),(0,ed._)({},r.stateKey,(0,er._)((0,G._)({},e[r.stateKey]),{refreshLoading:!1}))):n===tb.REFRESH_RESERVATION?(0,er._)((0,G._)({},e),(0,ed._)({},r.stateKey,(0,er._)((0,G._)({},e[r.stateKey]),{data:(e[r.stateKey].data||[]).concat(o)}))):n===tb.SHARE_POSITION?(0,er._)((0,G._)({},e),(0,ed._)({},r.stateKey,(0,er._)((0,G._)({},e[r.stateKey]),{data:o}))):n===tb.UPDATE_ZHIHU2020_RECOMMENDED_MEMBER_FOLLOE_STATUS?(0,er._)((0,G._)({},e),(0,ed._)({},r.stateKey,(0,er._)((0,G._)({},e[r.stateKey]),{data:e[r.stateKey].data.map(function(e){return e.urlToken===o?(0,er._)((0,G._)({},e),{isFollowing:!e.isFollowing}):e})}))):e},list:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,r=n.type,o=n.meta,i=n.payload;return r===tb.LOAD_LIST.request?(0,er._)((0,G._)({},t),(0,ed._)({},o.stateKey,(0,er._)((0,G._)({},t[o.stateKey]),{isLoading:!0}))):r===tb.LOAD_LIST.failure?(0,er._)((0,G._)({},t),(0,ed._)({},o.stateKey,(0,er._)((0,G._)({},t[o.stateKey]),{isLoading:!1}))):r===tb.LOAD_LIST.success?(0,er._)((0,G._)({},t),(0,ed._)({},o.stateKey,(0,er._)((0,G._)({},t[o.stateKey],i),{data:(0,g._)(!o.isRefetch&&(null===(e=t[o.stateKey])||void 0===e?void 0:e.data)||[]).concat((0,g._)(i.data||[])),isLoading:!1}))):t},videoMakerAcq:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.meta,o=t.payload;return n===tb.LOAD_INVITEE_INFO.success?(0,er._)((0,G._)({},e),(0,ed._)({},r.stateKey,o)):n===tb.GET_SHARE_POSTER.success?(0,er._)((0,G._)({},e),{sharePoster:o.posterUrl}):e},vote:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.meta,o=t.payload;if(n===tb.LOAD_VOTE_USERS.success){var i=r.stateKey,a=o.activityInfo,c=o.userInfo,s=o.items;return{activityInfo:a,userInfo:c,candidatesList:(0,er._)((0,G._)({},e.candidatesList),(0,ed._)({},i,s))}}return e},cardCollecting:function(){var e,t,n,r,o,i,a,c,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tN,u=arguments.length>1?arguments[1]:void 0,l=u.type,d=u.payload,p=u.meta;if(l.endsWith("/success")&&(null==d?void 0:null===(e=d.error)||void 0===e?void 0:e.message))return s.error?s:(0,er._)((0,G._)({},s),{message:{text:d.error.message,closePage:l===tR.GET_SHARE_LINK.success}});if(l===tR.SET_MODAL)return(0,er._)((0,G._)({},s),{modal:(0,G._)({},s.modal,d)});if(l===tR.SET_PANEL)return(0,er._)((0,G._)({},s),{panel:(0,G._)({},s.panel,d)});if(l===tR.SET_NEW_COIN_COUNT)return(0,er._)((0,G._)({},s),{newCoinCount:d});if(l===tR.SHIFT_CARD)return(0,er._)((0,G._)({},s),{newCardList:s.newCardList.slice(1)});if(l===tR.DRAW_PRIZE.request)return(0,er._)((0,G._)({},s),{prize:null});if(l===tR.DRAW_PRIZE.success)return(null===(n=d.data)||void 0===n?void 0:n.prizeType)==="element"?(0,er._)((0,G._)({},s),{newCardList:s.newCardList.concat((0,G._)({},d.data,p))}):(0,er._)((0,G._)({},s),{prize:d.data});if(l===tR.GET_TASK_LIST.success)return(0,er._)((0,G._)({},s),{taskList:(null===(r=d.data)||void 0===r?void 0:r.taskList)||[]});if(l===tR.GET_SHARE_LINK.success)return d.error?(0,er._)((0,G._)({},s),{error:null===(o=d.error)||void 0===o?void 0:o.message}):(0,er._)((0,G._)({},s),{shareLink:d.data.linkUrl.replace("intention=invite&","")});if(l===tR.GET_INVITER_INFO.success)return(0,er._)((0,G._)({},s),{inviterInfo:d.data});if(l===tR.SET_SHARE_INTENTION)return(0,er._)((0,G._)({},s),{shareIntention:d});if(l===tR.GET_PROFILE.success)return(0,er._)((0,G._)({},s),{profile:(0,G._)({},s.profile,d.data)});if(l===tR.GET_CARD_LIST.success){var f=d.data.elements;return(0,er._)((0,G._)({},s),{cardList:f})}return l===tR.GET_GIVER_INFO.success?(0,er._)((0,G._)({},s),{giverInfo:d.data}):l===tR.CONSUME_NEW_USER_CARD?(0,er._)((0,G._)({},s),{newUserCardCount:s.newUserCardCount-1}):l===tR.GET_SHARE_KEY.success?(0,er._)((0,G._)({},s,d.data.posterUrl&&{sharePoster:(0,er._)((0,G._)({},s.sharePoster),{sendCard:d.data.posterUrl})}),{shareKey:d.data.shareKey,shareCardId:p.shareCardId}):l===tR.GET_FUSE_STATUS.success?(0,er._)((0,G._)({},s),{profile:(0,er._)((0,G._)({},s.profile),{fusionStatus:(null===(i=d.data)||void 0===i?void 0:null===(a=i.collections)||void 0===a?void 0:null===(c=a[0])||void 0===c?void 0:c.status)||0})}):l===tR.SET_MESSAGE?(0,er._)((0,G._)({},s),{message:d}):l===tR.GET_RECEIVED_CARD.success?(0,er._)((0,G._)({},s),{receivedCard:d}):l===tR.CLEAR_RECEIVED_CARD?(0,er._)((0,G._)({},s),{receivedCard:null}):l===tR.CLEAR_PRIZE?(0,er._)((0,G._)({},s),{prize:null}):l===tR.RECEIVE_CARD.success&&(null==d?void 0:null===(t=d.data)||void 0===t?void 0:t.length)?(0,er._)((0,G._)({},s),{newCardList:s.newCardList.concat(d.data.filter(function(e){return e.linkId}))}):l===tR.GET_PRIZE_LIST.success&&(null==d?void 0:d.data)?(0,er._)((0,G._)({},s),{prizeList:d.data}):l===tR.GET_SHARE_POSTER.success?(0,er._)((0,G._)({},s),{sharePoster:(0,er._)((0,G._)({},s.sharePoster),(0,ed._)({},s.shareIntention,d.data.imgUrl))}):s},zhiboPandian2020:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;if(t.type===tL.GET_STATISTICS.success){var n=t.payload;return(0,G._)({},e,n)}return e},boarding:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tx,n=arguments.length>1?arguments[1]:void 0,r=n.type,o=n.payload;switch(r){case tZ.GET.success:return(0,er._)((0,G._)({},t),{profile:(0,G._)({},t.profile,o.data)});case tZ.GET_SHARE_LINK.success:var i,a,c=null===(i=o.error)||void 0===i?void 0:i.code;return(0,er._)((0,G._)({},t),{shareLink:null===(a=o.data)||void 0===a?void 0:a.linkUrl,taskError:1005===c||1003===c?["邀请任务已结束","快去提醒好友做任务得剩余奖励吧"]:null});case tZ.GET_SHARE_POSTER.success:return(0,er._)((0,G._)({},t),{sharePoster:null===(e=o.data)||void 0===e?void 0:e.imgUrl});case tZ.GET_BUBBLES.success:return(0,er._)((0,G._)({},t),{bubbles:o.data});case tZ.GET_REWARD_LIST.success:return(0,er._)((0,G._)({},t),{rewardList:o.data});case tZ.GET_WITHDRAWAL_LIST.success:return(0,er._)((0,G._)({},t),{withdrawalList:o.data});case tZ.GET_INVITER.success:return(0,er._)((0,G._)({},t),{inviter:o.data});case tZ.GET_INVITE_LIST.success:return(0,er._)((0,G._)({},t),{inviteList:o.data});case tZ.DRAW_REWARD.success:return(0,er._)((0,G._)({},t),{currentReward:o.data});case tZ.CLEAR:return(0,er._)((0,G._)({},t),{currentReward:null});case tZ.GET_TASK.success:return(0,er._)((0,G._)({},t),{task:o.data});case tZ.GET_NOTIFICATION.success:return(0,er._)((0,G._)({},t),{notification:o.data});default:return t}},searchGaokaoSubPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.meta,o=(void 0===r?{}:r).isReset;if(n===tO.GET_TOPIC.success)return(0,er._)((0,G._)({},e),{topic:t.payload});if(n===tO.GET_COURSES.success)return(0,er._)((0,G._)({},e),{courses:t.payload});if(n===tO.GET_COLLEGES.request)return(0,er._)((0,G._)({},e),{universities:(0,er._)((0,G._)({},e.universities),{isLoading:!0})});if(n===tO.GET_COLLEGES.success){var i,a=t.payload,c=a.universities,s=a.paging,u=a.provinces,l=a.tags,d=a.types,p=o?c:(0,g._)((null===(i=e.universities)||void 0===i?void 0:i.universities)||[]).concat((0,g._)(c));return(0,er._)((0,G._)({},e),{universities:(0,er._)((0,G._)({},e.universities),{isLoading:!1,paging:s,provinces:u,tags:l,types:d,universities:p})})}if(n===tO.GET_STATS.success)return(0,er._)((0,G._)({},e),{stats:t.payload});if(n===tO.GET_ACE_MAJORS.success)return(0,er._)((0,G._)({},e),{aceMajors:t.payload});if(n===tO.GET_EMPLOYMENT_DESTINATION.success)return(0,er._)((0,G._)({},e),{employmentDestination:t.payload});if(n===tO.GET_SCORES.success)return(0,er._)((0,G._)({},e),{scores:t.payload});if(n===tO.GET_PROVINCE_LINE.success)return(0,er._)((0,G._)({},e),{provinceLine:t.payload});if(n===tO.GET_ADMISSIONS_GUIDE.success)return(0,er._)((0,G._)({},e),{intro:t.payload});if(n===tO.GET_ADMISSIONS_PLAN.success)return(0,er._)((0,G._)({},e),{recruit:t.payload});if(n===tO.GET_SCORE_STAGE.success)return(0,er._)((0,G._)({},e),{scoreStage:t.payload});if(n===tP.UPDATE_ADMISSIONS_INFO||n===tO.GET_ADMISSIONS_INFO.success)return(0,er._)((0,G._)({},e),{admissionsInfo:t.payload});if(n===tO.GET_ADMISSIONS_SCHOOL.success)return t.meta.update?(0,er._)((0,G._)({},e),{admissionsSchool:(0,er._)((0,G._)({},e.admissionsSchool),{recruitmentInfo:t.payload.recruitmentInfo,salaryInfo:t.payload.salaryInfo,topSchools:t.payload.topSchools})}):(0,er._)((0,G._)({},e),{admissionsSchool:t.payload});if(n===tO.GET_SCHOOL_INFO.success)return(0,er._)((0,G._)({},e),{schoolInfo:t.payload});if(n===tO.GET_IMAGES.request)return(0,er._)((0,G._)({},e),{images:(0,er._)((0,G._)({},e.images),{isLoading:!0,isDrained:!1})});if(n===tO.GET_IMAGES.success){var f,h,_=t.payload||{},m=_.imageInfo.thumbnails,T=_.videoInfo.thumbnails,E=t.meta.isPC,y=(null===(f=e.images)||void 0===f?void 0:f.thumbnails)||[],C=(null===(h=e.images)||void 0===h?void 0:h.videoThumbnails)||[],S=T.length>0?E?T:(0,g._)(T).concat([{type:"text"}]):[];return(0,er._)((0,G._)({},e),{images:(0,er._)((0,G._)({},t.payload),{isLoading:!1,isDrained:!m.length,thumbnails:(0,g._)(y).concat((0,g._)(S),(0,g._)(m)),videoThumbnails:(0,g._)(C).concat((0,g._)(T))})})}return e},searchHealth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===tD.GET_HEALTH.success?(0,G._)({},e,t.payload):e}}),tU=n(13737),tG=n(73086),tF=n(33068),tH=n(64813),tz=n(73135),tq=n(28953),tV=n(86871),tW=(0,G._)({},(0,eM.FH)("chat",["SEARCH_USER"]),(0,eM.co)("chat",["CLEAR_SEARCH_RESULT"])),tX=(0,tV.Z)(tW.SEARCH_USER,tW.CLEAR_SEARCH_RESULT),tK=n(25130),tj=(0,th.combineReducers)({recents:tF.ZP,strangers:tH.Z,friends:tz.ZP,search:tX,config:tK.ZP}),tY={isChatMqttExisted:!1},tQ=(0,eM.co)("chatGlobal",["SET_CHAT_MQTT_STATUS"]),tJ=(0,th.combineReducers)({chats:tG.ZP,inbox:tj,global:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tY,t=arguments.length>1?arguments[1]:void 0;if(t.type===tQ.SET_CHAT_MQTT_STATUS){var n=t.meta.status;return(0,er._)((0,G._)({},e),{isChatMqttExisted:n})}return e}}),t$=n(25809),t0=n(20760),t1=n(67927),t2=function(e){if(!e)return!1;var t=e.childCommentCount,n=e.isDelete,r=e.collapsed;return t>0||!n&&!r},t3=(0,G._)({},(0,eM.FH)("commentMangage",["LOAD_UPDATE_STATUS","UPDATE_VISIT_STATUS","LOAD_COMMENT_LIST","UPDATE_COMMENT","UPDATE_COMMENT_LIKE","UPDATE_COMMENT_DISLIKE","UPDATE_COMMENT_HOT","UPDATE_COMMENT_COLLAPSED","DELETE_COMMENT","APPROVE_COMMENT","REJECT_COMMENT","REPLY_COMMENT","LOAD_SUB_COMMENT_LIST","UPDATE_SUB_COMMENT","UPDATE_SUB_COMMENT_LIKE","UPDATE_SUB_COMMENT_DISLIKE","UPDATE_SUB_COMMENT_HOT","UPDATE_SUB_COMMENT_COLLAPSED","DELETE_SUB_COMMENT","APPROVE_SUB_COMMENT","REJECT_SUB_COMMENT","REPLY_SUB_COMMENT"])),t4=(0,t0.HF)();t4.getSelectors(function(e){return e.commentManage.commentList});var t5=(0,t0.HF)();t5.getSelectors(function(e){return e.commentManage.subCommentList});var t6=t4.getInitialState({nextOffset:0,urlToken:""}),t7=function(e,t){var n=t.meta;t4.updateOne(e,n)},t8=(0,t0.oM)({name:"commentManage/commentList",initialState:t6,reducers:{resetCommentList:function(e,t){var n=t.payload;return(0,er._)((0,G._)({},t6),{urlToken:n})}},extraReducers:(p={},(0,ed._)(p,t3.LOAD_COMMENT_LIST.success,function(e,t){var n,r=t.payload,o=t.meta.urlToken;o===e.urlToken&&r&&(e.nextOffset=r.nextOffset,e.urlToken=o,t4.addMany(e,((null===(n=r.data)||void 0===n?void 0:n.filter(t2))||[]).map(function(e){return(0,er._)((0,G._)({},e),{_id:(0,t0.x0)()})})))}),(0,ed._)(p,t3.UPDATE_COMMENT_LIKE.request,t7),(0,ed._)(p,t3.UPDATE_COMMENT_DISLIKE.request,t7),(0,ed._)(p,t3.UPDATE_COMMENT_HOT.request,t7),(0,ed._)(p,t3.UPDATE_COMMENT_COLLAPSED.request,t7),(0,ed._)(p,t3.DELETE_COMMENT.success,t7),(0,ed._)(p,t3.REPLY_COMMENT.success,t7),(0,ed._)(p,t3.APPROVE_COMMENT.success,t7),(0,ed._)(p,t3.UPDATE_COMMENT.success,function(e,t){var n=t.payload;n&&t4.updateOne(e,{id:n.id,changes:n})}),p)});t8.actions.resetCommentList;var t9=t5.getInitialState({paging:{next:"",isEnd:!1}}),ne=function(e,t){var n=t.meta,r=t.payload;n.inConversation&&t5.addOne(e,r)},nt=function(e,t){var n=t.meta;t5.updateOne(e,n)},nn=(0,t0.oM)({name:"commentManage/subCommentList",initialState:t9,reducers:{resetSubCommentList:function(){return t9}},extraReducers:(f={},(0,ed._)(f,t3.LOAD_SUB_COMMENT_LIST.success,function(e,t){var n,r=t.payload;r&&(e.paging=r.paging,t5.addMany(e,((null===(n=r.data)||void 0===n?void 0:n.filter(t2))||[]).map(function(e){return(0,er._)((0,G._)({},e),{_id:(0,t0.x0)()})})))}),(0,ed._)(f,t3.UPDATE_SUB_COMMENT_LIKE.request,nt),(0,ed._)(f,t3.UPDATE_SUB_COMMENT_DISLIKE.request,nt),(0,ed._)(f,t3.UPDATE_SUB_COMMENT_HOT.request,nt),(0,ed._)(f,t3.UPDATE_SUB_COMMENT_COLLAPSED.request,nt),(0,ed._)(f,t3.DELETE_SUB_COMMENT.success,nt),(0,ed._)(f,t3.REPLY_SUB_COMMENT.success,ne),(0,ed._)(f,t3.REPLY_COMMENT.success,ne),(0,ed._)(f,t3.APPROVE_SUB_COMMENT.success,nt),(0,ed._)(f,t3.UPDATE_SUB_COMMENT.success,function(e,t){var n=t.payload;n&&t5.updateOne(e,{id:n.id,changes:n})}),f)});nn.actions.resetSubCommentList;var nr=(0,th.combineReducers)({commentList:t8.reducer,subCommentList:nn.reducer}),no=n(803),ni=n(69906),na=(0,G._)({},(0,eM.FH)("comment",["GET","GET_COLLAPSED","GET_REVERSE","GET_REVIEWING","GET_CONVERSATION","UPDATE_LIKE","UPDATE_DISLIKE","UPDATE_FEATURED","UPDATE_COLLAPSED","APPROVE","REJECT","DELETE","ADD","GET_MORE_REPLY_COMMENT","GET_CONVERSATION_MORE","GET_STICKERS","GET_COMMENT_WITH_PIC_PERMISSION","LOAD_NOTI_COMMENTS"]),(0,eM.co)("comment",["ORDER"])),nc={ebook:"book",collection:"favlist"},ns=function(e){var t=e.parentType,n=e.parentId;return"".concat(t,"_").concat(n)},nu=(0,th.combineReducers)({pagination:(0,ni.Fd)(na.GET,{mapActionToKey:ns,additionalCaseTypes:[na.APPROVE.success,na.ADD.success,na.GET_CONVERSATION.success].concat((0,g._)(Object.values(na.UPDATE_FEATURED)),(0,g._)(Object.values(na.UPDATE_COLLAPSED))),additionalCase:function(e,t){switch(t.type){case na.APPROVE.success:return(0,er._)((0,G._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.id])});case na.ADD.success:var n=t.replyToId,r=t.id;if(n&&!r){var o=e.ids.indexOf(n);return(0,er._)((0,G._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids.slice(0,o+1)).concat([t.result],(0,g._)(e.ids.slice(o+1))),newIds:(0,g._)(e.newIds.slice(0,o+1)).concat([t.result],(0,g._)(e.newIds.slice(o+1)))})}return(0,er._)((0,G._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.result]),newIds:(0,g._)(e.newIds).concat([t.result])});case na.UPDATE_COLLAPSED.request:var i=e.ids,a=i.indexOf(t.id),c=i.slice();return t.expect?c.splice(a,1):c.push(t.id),(0,er._)((0,G._)({},e),{ids:c,newIds:c,index:a});case na.UPDATE_COLLAPSED.success:return delete e.index,(0,G._)({},e);case na.UPDATE_COLLAPSED.failure:var s=e.ids.slice(),u=s.indexOf(t.id);return t.expect?s.splice(u,0,t.id):s.splice(u,1),delete e.index,(0,er._)((0,G._)({},e),{ids:s,newIds:s});default:return e}}}),collapsed:(0,ni.Fd)(na.GET_COLLAPSED,{mapActionToKey:ns,additionalCaseTypes:(0,g._)(Object.values(na.UPDATE_COLLAPSED)),additionalCase:function(e,t){switch(t.type){case na.UPDATE_COLLAPSED.request:var n=e.ids,r=n.indexOf(t.id),o=n.slice();return t.expect?o.push(t.id):o.splice(r,1),(0,er._)((0,G._)({},e),{ids:o,newIds:o,index:r});case na.UPDATE_COLLAPSED.success:return delete e.index,(0,G._)({},e);case na.UPDATE_COLLAPSED.failure:var i=e.ids,a=e.index,c=i.slice();return t.expect?c.splice(a,1):c.splice(a,0,t.id),delete e.index,(0,er._)((0,G._)({},e),{ids:i,newIds:c});default:return e}}}),reverse:(0,ni.Fd)(na.GET_REVERSE,{mapActionToKey:ns,additionalCaseTypes:[na.APPROVE.success,na.ADD.success],additionalCase:function(e,t){switch(t.type){case na.APPROVE.success:return(0,er._)((0,G._)({},e),{totals:e.totals+1,ids:[t.id].concat((0,g._)(e.ids))});case na.ADD.success:var n=t.replyToId,r=t.id;if(n&&!r){var o=e.ids.indexOf(n);return(0,er._)((0,G._)({},e),{totals:e.totals+1,newIds:(0,g._)(e.newIds.slice(0,o+1)).concat([t.result],(0,g._)(e.newIds.slice(o+1))),ids:(0,g._)(e.ids.slice(0,o+1)).concat([t.result],(0,g._)(e.ids.slice(o+1)))})}return(0,er._)((0,G._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.result]),newIds:(0,g._)(e.newIds).concat([t.result])});default:return null}}}),reviewing:(0,ni.Fd)(na.GET_REVIEWING,{mapActionToKey:ns,additionalCaseTypes:[na.APPROVE.success],additionalCase:function(e,t){if(t.type===na.APPROVE.success){var n=e.ids;return n.splice(n.indexOf(t.id),1),(0,er._)((0,G._)({},e),{ids:n})}return e}}),conversation:(0,ni.Fd)(na.GET_CONVERSATION,{additionalCaseTypes:[na.ADD.success].concat((0,g._)(Object.values(na.UPDATE_FEATURED))),additionalCase:function(e,t){return t.type===na.ADD.success?(0,er._)((0,G._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.payload.id])}):e}}),parent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=ns(t);switch(t.type){case na.GET.success:var r=t.payload,o=r.featuredCounts,i=r.collapsedCounts,a=r.reviewingCounts,c=r.commonCounts,s=r.commentStatus;return(0,er._)((0,G._)({},e),(0,ed._)({},n,{featuredCounts:o,collapsedCounts:i,reviewingCounts:a,commonCounts:c,commentStatus:s}));case na.APPROVE.success:var u=e[n].reviewingCounts-1;return(0,er._)((0,G._)({},e),(0,ed._)({},n,(0,er._)((0,G._)({},e[n]),{reviewingCounts:u})));case na.REJECT.success:var l=e[n].reviewingCounts+1;return(0,er._)((0,G._)({},e),(0,ed._)({},n,(0,er._)((0,G._)({},e[n]),{reviewingCounts:l})));case na.UPDATE_COLLAPSED.success:var d=e[n]||{};return(0,er._)((0,G._)({},e),(0,ed._)({},n,(0,er._)((0,G._)({},d),{collapsedCounts:d.collapsedCounts+(t.expect?1:-1)})));case na.DELETE.success:var p=e[n]||{};return(0,er._)((0,G._)({},e),(0,ed._)({},n,(0,G._)({},p,t.collapsed&&{collapsedCounts:p.collapsedCounts-1},t.reviewing?{reviewingCounts:p.reviewingCounts-1}:{commonCount:p.commonCount-1})));default:return e}}}),nl=n(46942),nd=n.n(nl);function np(e,t){var n=e[t]&&e[t].ids||[],r=n.filter(function(e){return String(e).includes("_featured")}).length,o=n.length-r;return{featuredCounts:r,commonCounts:o}}var nf=(0,G._)({},(0,eM.FH)("commentV2",["GET","GET_COLLAPSED","GET_REVERSE","GET_REVIEWING","GET_CONVERSATION","UPDATE_LIKE","UPDATE_DISLIKE","UPDATE_FEATURED","UPDATE_COLLAPSED","APPROVE","REJECT","DELETE","ADD","GET_MORE_REPLY_COMMENT","GET_CONVERSATION_MORE","GET_STICKERS","GET_COMMENT_WITH_PIC_PERMISSION","LOAD_NOTI_COMMENTS"]),(0,eM.co)("comment",["ORDER"])),nh=function(e){var t=e.parentType,n=e.parentId;return"".concat(t,"_").concat(n)},n_=(0,th.combineReducers)({stickers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===nf.GET_STICKERS.success?(0,g._)(e).concat((0,g._)(t.payload.data)):e},commentWithPicPermission:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===nf.GET_COMMENT_WITH_PIC_PERMISSION.success?(0,G._)({},e,t.payload):e},notificationsComments:(0,ni.Fd)(nf.LOAD_NOTI_COMMENTS,{mapActionToKey:function(e){return e.notificationId||e.id},additionalCaseTypes:[nf.ADD.success].concat((0,g._)(Object.values(nf.UPDATE_FEATURED))),additionalCase:function(e,t){switch(t.type){case nf.ADD.success:var n=t.replyType,r=t.result;if("notification"===n)return(0,er._)((0,G._)({},e),{ids:(0,g._)(e.ids).concat([r])});return e;case nf.UPDATE_FEATURED.success:var o=t.notificationId,i=t.commentId;if(o){var a=e.ids,c=a.indexOf("".concat(i,"_featured"));-1===c?a.unshift("".concat(i,"_featured")):a.splice(c,1)}return e;default:return e}}}),pagination:(0,ni.Fd)(nf.GET,{mapActionToKey:nh,additionalCaseTypes:[nf.APPROVE.success,nf.REJECT.success,nf.ADD.success,nf.ADD.failure,nf.GET_CONVERSATION.success].concat((0,g._)(Object.values(nf.UPDATE_FEATURED)),(0,g._)(Object.values(nf.UPDATE_COLLAPSED))),additionalCase:function(e,t){switch(t.type){case nf.APPROVE.success:return(0,er._)((0,G._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.id])});case nf.REJECT.success:var n=e.ids;return(0,er._)((0,G._)({},e),{totals:e.totals-1,ids:n.filter(function(e){return e!==t.id})});case nf.ADD.success:var r=t.replyToId,o=t.shouldUpdateChildComments;switch(t.replyType){case"comment":return(0,er._)((0,G._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.result]),newIds:(0,g._)(e.newIds).concat([t.result])});case"replyToFeatured":if(o)return(0,G._)({totals:e.totals+1},e);return(0,er._)((0,G._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.result]),newIds:(0,g._)(e.newIds).concat([t.result])});case"replyToSubFeatured":var i=e.ids.indexOf("".concat(r,"_featured"));return(0,er._)((0,G._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids.slice(0,i+1)).concat([t.result],(0,g._)(e.ids.slice(i+1))),newIds:(0,g._)(e.newIds.slice(0,i+1)).concat([t.result],(0,g._)(e.newIds.slice(i+1)))});case"replyToCommon":case"replyToSubCommon":return(0,er._)((0,G._)({},e),{totals:e.totals+1});default:return e}case nf.UPDATE_COLLAPSED.request:var a=e.ids,c=a.indexOf(t.id),s=a.slice();return t.expect?s.splice(c,1):s.push(t.id),(0,er._)((0,G._)({},e),{ids:s,newIds:s,index:c});case nf.UPDATE_COLLAPSED.success:return delete e.index,(0,G._)({},e);case nf.UPDATE_COLLAPSED.failure:var u=e.ids.slice(),l=u.indexOf(t.id);return t.expect?u.splice(l,0,t.id):u.splice(l,1),delete e.index,(0,er._)((0,G._)({},e),{ids:u,newIds:u});case nf.UPDATE_FEATURED.request:var d=t.commentId,p=e.ids,f=e.newIds,h=p.indexOf("".concat(d,"_featured"));if(-1===h)return(0,er._)((0,G._)({},e),{ids:["".concat(d,"_featured")].concat((0,g._)(p)),newIds:["".concat(d,"_featured")].concat((0,g._)(f))});return p.splice(h,1),f.splice(h,1),e;default:return e}}}),collapsed:(0,ni.Fd)(nf.GET_COLLAPSED,{mapActionToKey:nh,additionalCaseTypes:(0,g._)(Object.values(nf.UPDATE_COLLAPSED)),additionalCase:function(e,t){switch(t.type){case nf.UPDATE_COLLAPSED.request:var n=e.ids,r=n.indexOf(t.id),o=n.slice();return t.expect?o.push(t.id):o.splice(r,1),(0,er._)((0,G._)({},e),{ids:o,newIds:o,index:r});case nf.UPDATE_COLLAPSED.success:return delete e.index,(0,G._)({},e);case nf.UPDATE_COLLAPSED.failure:var i=e.ids,a=e.index,c=i.slice();return t.expect?c.splice(a,1):c.splice(a,0,t.id),delete e.index,(0,er._)((0,G._)({},e),{ids:i,newIds:c});default:return e}}}),reverse:(0,ni.Fd)(nf.GET_REVERSE,{mapActionToKey:nh,additionalCaseTypes:[nf.APPROVE.success,nf.ADD.success],additionalCase:function(e,t){switch(t.type){case nf.APPROVE.success:return(0,er._)((0,G._)({},e),{totals:e.totals+1,ids:[t.id].concat((0,g._)(e.ids))});case nf.ADD.success:var n=t.replyToId,r=t.id;if(n&&!r){var o=e.ids.indexOf(n);return(0,er._)((0,G._)({},e),{totals:e.totals+1,newIds:(0,g._)(e.newIds.slice(0,o+1)).concat([t.result],(0,g._)(e.newIds.slice(o+1))),ids:(0,g._)(e.ids.slice(0,o+1)).concat([t.result],(0,g._)(e.ids.slice(o+1)))})}return(0,er._)((0,G._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.result]),newIds:(0,g._)(e.newIds).concat([t.result])});default:return null}}}),reviewing:(0,ni.Fd)(nf.GET_REVIEWING,{mapActionToKey:nh,additionalCaseTypes:[nf.APPROVE.success,nf.REJECT.success],additionalCase:function(e,t){switch(t.type){case nf.APPROVE.success:var n=e.ids;return n.splice(n.indexOf(t.id),1),(0,er._)((0,G._)({},e),{ids:n});case nf.REJECT.success:return(0,er._)((0,G._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids).concat([t.id])});default:return e}}}),conversation:(0,ni.Fd)(nf.GET_CONVERSATION,{additionalCaseTypes:[nf.ADD.success].concat((0,g._)(Object.values(nf.UPDATE_FEATURED))),additionalCase:function(e,t){switch(t.type){case nf.ADD.success:var n=t.replyToId,r=t.replyType,o=t.isAnchorComments;if("conversation"===r){var i=e.ids.indexOf(n);if(-1===i&&(i=e.ids.indexOf("".concat(n,"_featured"))),o&&-1===i)return e;return(0,er._)((0,G._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids.slice(0,i+1)).concat([t.result],(0,g._)(e.ids.slice(i+1)))})}return e;case nf.UPDATE_FEATURED.request:var a=t.commentId,c=e.ids,s=e.newIds,u=c.indexOf("".concat(a,"_featured")),l=c.indexOf(a);return -1!==u?(c.splice(u,1,a),s.splice(u,1,a)):-1!==l&&(c.splice(l,1,"".concat(a,"_featured")),s.splice(l,1,"".concat(a,"_featured"))),e;default:return e}}}),conversationMore:(0,ni.Fd)(nf.GET_CONVERSATION_MORE,{additionalCaseTypes:[nf.ADD.success].concat((0,g._)(Object.values(nf.UPDATE_FEATURED))),additionalCase:function(e,t){switch(t.type){case nf.ADD.success:var n=t.replyToId,r=t.replyType,o=t.isAnchorComments;if("conversation"===r){if(!o)return(0,G._)({},e);var i=e.ids.indexOf(n);if(-1===i&&-1===(i=e.ids.indexOf("".concat(n,"_featured"))))return e;return(0,er._)((0,G._)({},e),{totals:e.totals+1,ids:(0,g._)(e.ids.slice(0,i+1)).concat([t.result],(0,g._)(e.ids.slice(i+1)))})}return e;case nf.UPDATE_FEATURED.request:var a=t.commentId,c=e.ids,s=e.newIds,u=c.indexOf("".concat(a,"_featured")),l=c.indexOf(a);return -1!==u?(c.splice(u,1,a),s.splice(u,1,a)):-1!==l&&(c.splice(l,1,"".concat(a,"_featured")),s.splice(l,1,"".concat(a,"_featured"))),e;default:return e}}}),parent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=nh(t);switch(t.type){case nf.GET.success:var r=t.payload,o=r.featuredCounts,i=r.collapsedCounts,a=r.reviewingCounts,c=r.commonCounts,s=r.commentStatus;return(0,er._)((0,G._)({},e),(0,ed._)({},n,{featuredCounts:o,collapsedCounts:i,reviewingCounts:a,commonCounts:c,commentStatus:s}));case nf.APPROVE.success:var u=e[n].reviewingCounts-1;return(0,er._)((0,G._)({},e),(0,ed._)({},n,(0,er._)((0,G._)({},e[n]),{reviewingCounts:u})));case nf.REJECT.success:var l=e[n].reviewingCounts+1;return(0,er._)((0,G._)({},e),(0,ed._)({},n,(0,er._)((0,G._)({},e[n]),{reviewingCounts:l})));case nf.UPDATE_COLLAPSED.success:var d=e[n]||{};return(0,er._)((0,G._)({},e),(0,ed._)({},n,(0,er._)((0,G._)({},d),{collapsedCounts:d.collapsedCounts+(t.expect?1:-1)})));case nf.DELETE.success:var p=e[n]||{};return(0,er._)((0,G._)({},e),(0,ed._)({},n,(0,G._)({},p,t.collapsed&&{collapsedCounts:p.collapsedCounts-1},t.reviewing?{reviewingCounts:p.reviewingCounts-1}:{commonCount:p.commonCount-1})));case nf.LOAD_NOTI_COMMENTS.success:var f=t.notificationsComments,h=t.notificationId;return(0,er._)((0,G._)({},e),(0,ed._)({},h,(0,G._)({},np(f,h))));case nf.UPDATE_FEATURED.request:case nf.UPDATE_FEATURED.success:var _=t.notificationsComments,m=t.notificationId;if(m)return(0,er._)((0,G._)({},e),(0,ed._)({},m,(0,G._)({},np(_,m))));return e;default:return e}}}),nm=(0,eM.FH)("commercialReport",["GET_COMMERCIAL_REPORT_INFO"]).GET_COMMERCIAL_REPORT_INFO,nv=(0,eM.co)("commercialReport",["UPDATE_LOCAL_ANSWER_COMMERCIAL_REPORT_INFO"]).UPDATE_LOCAL_ANSWER_COMMERCIAL_REPORT_INFO,ng={commercialTypes:[]},nT=n(31274),nE=n(11556),ny=(0,G._)({},(0,eM.FH)("creationRanking",["GET_CREATION_RANKING","GET_CREATION_RANKING_TYPE","GET__CREATION_RANKING_POSTER","GET__CREATION_RANKING_MONTHLIST"])),nC=n(19958),nS=n(74351),nI=function(e){return e.creatorMCN},nA=(0,tM.P1)(nI,function(e){return e.mcn});(0,tM.P1)(nA,function(e){return e.id}),(0,tM.P1)(nI,function(e){return e.isNoAuth}),(0,tM.P1)(nI,function(e){return e.mcnStatistics}),(0,tM.P1)(nI,function(e){return e.creatorManageData}),(0,tM.P1)(nI,function(e){return e.creatorManageDataTotal}),(0,tM.P1)(nI,function(e){return e.creatorCheeseManageData}),(0,tM.P1)(nI,function(e){return e.creatorCheeseManageDataTotal}),(0,tM.P1)(nI,function(e){return e.mcnDomains}),(0,tM.P1)(nI,function(e){return e.mcnRight}),(0,tM.P1)(nI,function(e){return e.statisticHealthScoreData}),(0,tM.P1)(nI,function(e){return e.healthScore});var nb=(0,G._)({},(0,eM.FH)("creator-mcn",["GET_HOME_DATA","LOAD_ACTIVITY_LIST","GET_CREATOR_MANAGE_DATA","GET_CREATOR_CHEESE_MANAGE_DATA","DOWNLOAD_CREATOR_CHEESE_MANAGE_DATA_EXCEL_CHECK","SEARCH_PEOPLE","DOWNLOAD_CREATORS","GET_MCN_DOMAINS","GET_INVITE_STATUS","LAUNCH_UNBIND","ACCEPT_UNBIND","REJECT_UNBIND","SUBMIT_INVITATION","GET_CONTENTS","GET_CONTENT_ANALYSIS","DOWNLOAD_CONTENTS","GET_CREATOR_STATISTICS","DOWNLOAD_CREATOR_STATISTICS","GET_CREATOR_INCOME","GET_CREATOR_INCOME_STATISTICS","GET_MCN_INCOME","GET_INCOME_TYPE","DOWNLOAD_CREATOR_INCOME","DOWNLOAD_MCN_INCOME","LOAD_PAYMENT_LIST","LOAD_PAYMENT_DETAIL","LOAD_CREATOR_BALANCE","LOAD_CREATOR_BALANCE_DETAIL","GET_CONTENTS_PROMOTE_DETAIL","GET_CONTENTS_PROMOTE_COUPON_LIST","CHECK_CONTENTS_PROMOTE_COUPON","USE_CONTENTS_PROMOTE_COUPON","POST_CREATE_ORDER","POST_PAYMENT","GET_PAYMENT_STATUS","GET_SALT_AGGR","GET_SALT_DETAIL","GET_HEALTH_SCORE","LOAD_HEALTHSCORE_LIST","LOAD_STATISTIC_HEALTH_SCORE_DATA","BEFORE_DOWNLOAD_CHECK","LOAD_BEFORE_PROMOTION_DATA","LOAD_AFTER_PROMOTION_DATA","LOAD_PROMOTION_DETAIL_DATA"])),nw={mcn:{},mcnStatistics:{},mcnRight:{bind:!1,coupon:!1},isNoAuth:!1,creatorManageData:[],creatorManageDataTotal:1,mcnDomains:[],bill:{list:{},detail:{}},healthScore:{healthScore:"0",updateTime:"",evaluate:""},healthScoreRecordInfo:{},statisticHealthScoreData:void 0,beforeDownloadCheckResult:{},beforePromotionData:[],afterPromotionData:[]},nZ=n(26267),nx=(0,G._)({},(0,eM.FH)("creatorSalt",["GET_AUTHOR_STATUS","GET_AUTHOR_STATUS_NEW","GET_AUTHOR_WEBSITES","GET_AUTHOR_CONTRIBUTES_DOMAIN","CREATE_AUTHOR_DRAFT","PUBLISH_AUTHOR_DRAFT","UPDATE_AUTHOR_DRAFT","GET_QUESTION_RECOMMEND","SUB_USER_INFO","SUB_INSTITUTION_INFO","GET_AUTHOR_CONTRIBUTES_LIST","SUBMIT_AUTHOR_DRAFT","DELETE_AUTHOR_DRAFT","GET_DRAFT_INFO","GET_HAS_SUBMIT_ARTICLES","TRANSFER_CONTENT_TO_DRAFT","GET_BANNER_IMG_LIST","GET_CLAIM_BANNER_IMG_LIST","GET_REST_CONTRIBUTION_NUMBER","GET_AUTHOR_INFO","GET_All_BIND_ACCOUNT","OPERATE_INVITE_REQUEST","GET_AUTHOR_INVITE_STATUS","INVITE_AUTHOR","GET_INVITE_ACCOUNT_INFO","GET_INVITATION","HANDLE_INVITATION","UPLOAD_FILE","UPLOAD_IMG_WITH_WATERMARK","UPDATE_AUTHOR_INFO","CANCEL_INVITE_AUTHOR","GET_BOUND_INSTITUTION_INFO","GET_GROWTH_LEVEL","GET_TAGS_TREE","GET_LONG_SECTIONS","UPDATE_LONG_SECTIONS","GET_AUTHOR_CONTRIBUTES_DOMAIN_ALL","GET_MANUSCRIPT_LIST","GET_STATUS_COUNT","GET_STATUS_MAP","CREATE_CONTROBUTION","UPDATE_CONTROBUTION","GET_CONTRIBUTION_INFO","GET_COMMUNITY_CONTENT","CALLBACK_CONTROBUTION","UPLOAD_MANUSCRIPT","GET_All_BIND_ACCOUNT_NEW","GET_UNREAD_COUNT","UPDATE_AUTHOR_INFO_IN_SIGN_ON_LINE","CHOOSE_SETTLEMENT_INFO","GET_SIGN_LIST","GET_BANK_LIST","SUBMIT_CONTRACT_DESC_INFO","GET_CONTRACT_PDF","GET_WELFARE_CONFIG","GET_MANUSCRIPT_STATUS_TEXT"])),nk={recommendQuestionList:[],bannerList:[],claimBannerList:[],sites:[],domains:{},hasRecored:!1,hasClaim:!1,hasContributedList:[],notContributedList:[],contributesTotal:null,previewPageTitle:"",previewPageContent:"",restContributionNumber:"-"},nR=n(40382),nN=n(74065),nO=(0,G._)({},(0,eM.FH)("EDIT_VIDEO",["GET_ENABLED","GET_ZVIDEO_WHITELIST"])),nP={editVideoEnabled:!1,isZvideoUser:!1},nD=(0,th.combineReducers)({eduSectionState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e}}),nL=n(62039),nM=n(87441),nB=(0,eM.FH)("explore",["GET_RECOMMENDATIONS","GET_LATEST_SPECIALS","GET_LATEST_ROUNDTABLES","GET_HOT_COLLECTIONS","GET_RECOMMEND_COLUMNS","FOLLOW_SPECIAL","UNFOLLOW_SPECIAL","FOLLOW_ROUNDTABLE","UNFOLLOW_ROUNDTABLE","FOLLOW_COLLECTION","UNFOLLOW_COLLECTION","GET_RECENT_HOT_QUESTION","GET_POTENTIAL_QUESTION"]),nU=(0,th.combineReducers)({recommendations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===nB.GET_RECOMMENDATIONS.request?{isLoading:!0}:t.type===nB.GET_RECOMMENDATIONS.success?{isDrained:!0,items:t.payload.data}:t.type===nB.GET_RECOMMENDATIONS.failure?{isError:!0}:e},specials:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{entities:{},order:[]},t=arguments.length>1?arguments[1]:void 0;if(t.type===nB.GET_LATEST_SPECIALS.success){var n=t.payload.data;return{entities:n.reduce(function(e,t){return(0,er._)((0,G._)({},e),(0,ed._)({},t.id,t))},{}),order:n.map(function(e){return e.id})}}if([nB.FOLLOW_SPECIAL.request,nB.UNFOLLOW_SPECIAL.failure].includes(t.type)){var r=t.meta.id,o=e.entities;return o[r]?(0,er._)((0,G._)({},e),{entities:(0,er._)((0,G._)({},o),(0,ed._)({},r,(0,er._)((0,G._)({},o[r]),{isFollowing:!0})))}):e}if([nB.UNFOLLOW_SPECIAL.request,nB.FOLLOW_SPECIAL.failure].includes(t.type)){var i=t.meta.id,a=e.entities;return a[i]?(0,er._)((0,G._)({},e),{entities:(0,er._)((0,G._)({},a),(0,ed._)({},i,(0,er._)((0,G._)({},a[i]),{isFollowing:!1})))}):e}return e},roundtables:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{entities:{},order:[]},t=arguments.length>1?arguments[1]:void 0;if(t.type===nB.GET_LATEST_ROUNDTABLES.success){var n=t.payload.data;return{entities:n.reduce(function(e,t){return(0,er._)((0,G._)({},e),(0,ed._)({},t.urlToken,t))},{}),order:n.map(function(e){return e.urlToken})}}if([nB.FOLLOW_ROUNDTABLE.request,nB.UNFOLLOW_ROUNDTABLE.failure].includes(t.type)){var r=t.meta.urlToken,o=e.entities;return o[r]?(0,er._)((0,G._)({},e),{entities:(0,er._)((0,G._)({},o),(0,ed._)({},r,(0,er._)((0,G._)({},o[r]),{followersCount:o[r].followersCount+1,isFollowing:!0})))}):e}if([nB.UNFOLLOW_ROUNDTABLE.request,nB.FOLLOW_ROUNDTABLE.failure].includes(t.type)){var i=t.meta.urlToken,a=e.entities;return a[i]?(0,er._)((0,G._)({},e),{entities:(0,er._)((0,G._)({},a),(0,ed._)({},i,(0,er._)((0,G._)({},a[i]),{followersCount:a[i].followersCount-1,isFollowing:!1})))}):e}return e},collections:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===nB.GET_HOT_COLLECTIONS.success)return t.payload.data.reduce(function(e,t){return(0,er._)((0,G._)({},e),(0,ed._)({},t.id,t))},{});if([nB.FOLLOW_COLLECTION.request,nB.UNFOLLOW_COLLECTION.failure].includes(t.type)){var n=t.meta.id;return e[n]?(0,er._)((0,G._)({},e),(0,ed._)({},n,(0,er._)((0,G._)({},e[n]),{followerCount:e[n].followerCount+1,isFollowing:!0}))):e}if([nB.UNFOLLOW_COLLECTION.request,nB.FOLLOW_COLLECTION.failure].includes(t.type)){var r=t.meta.id;return e[r]?(0,er._)((0,G._)({},e),(0,ed._)({},r,(0,er._)((0,G._)({},e[r]),{followerCount:e[r].followerCount-1,isFollowing:!1}))):e}return e},columns:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===nB.GET_RECOMMEND_COLUMNS.success?t.payload.data.reduce(function(e,t){return(0,er._)((0,G._)({},e),(0,ed._)({},t.urlToken,t))},{}):e},square:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{hotQuestionList:[],potentialList:[]},t=arguments.length>1?arguments[1]:void 0;if(t.type===nB.GET_RECENT_HOT_QUESTION.success){var n=t.payload.data;return(0,er._)((0,G._)({},e),{hotQuestionList:(void 0===n?[]:n).slice(0,4)})}if(t.type===nB.GET_POTENTIAL_QUESTION.success){var r=t.payload.data;return(0,er._)((0,G._)({},e),{potentialList:r.slice(0,4)})}return e}}),nG=n(35528),nF=(0,G._)({},(0,eM.FH)("guide",["GET_TOPICS","SUBMIT_TOPICS"]),(0,eM.co)("guide",["CHANGE_SELECT_TOPIC"])),nH=(0,th.combineReducers)({guide:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isShowGuide:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case nF.SUBMIT_TOPICS.request:case nF.SUBMIT_TOPICS.failure:return(0,er._)((0,G._)({},e),{isSubmitTopic:"fail"});case nF.SUBMIT_TOPICS.success:var n=t.payload.success;return(0,er._)((0,G._)({},e),{isSubmitTopic:n?"done":"fail"});case nF.GET_TOPICS.request:case nF.GET_TOPICS.failure:return(0,er._)((0,G._)({},e),{isFetching:!1});case nF.GET_TOPICS.success:var r=t.payload.data;return(0,er._)((0,G._)({data:r},e),{isFetching:!0});case nF.CHANGE_SELECT_TOPIC:var o=t.data.index,i=e.data,a=e.data[o],c=a.relatedTopics,s=a.isFollowing,u=a.isSelected,l=Object.entries(i).map(function(e,t){var n=(0,ef._)(e,2),r=(n[0],n[1]);return t===o?(0,er._)((0,G._)({},r),{isFollowing:!s,isSelected:!0}):r}),d=[];if(c&&!u){var p=c.map(function(e){return(0,er._)((0,G._)({},e),{isRelated:!0})});d=(0,g._)(l.slice(0,o+1)).concat((0,g._)(p),(0,g._)(l.slice(o+1)))}else d=l;return{data:(0,G._)({},d),isFetching:!0};default:return e}}}),nz=(0,eM.co)("guideZhidaCard",["CLICK_SEARCH_ITEM_POSITION"]),nq={isShowGuideZhidaCard:!1,guideZhidaCardInView:!1,isClickedBeforeAbIndex:!1,isManualClose:!1,clickedPosition:-1},nV=(0,th.combineReducers)({cardStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nq,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===nz.CLICK_SEARCH_ITEM_POSITION?(0,er._)((0,G._)({},e),(0,ed._)({},r.key,r.value)):e}}),nW=(0,eM.FH)("helpCenter",["LOAD_QUESTION_CATEGORIES","LOAD_CATEGORY_QUESTIONS","LOAD_COMMON_QUESTIONS","LOAD_QUESTION_DETAIL","LOAD_RELATED_QUESTIONS","SEARCH_QUESTIONS","LOAD_QUESTION_ALL_TYPES","LOAD_FAQ_QUESTIONS","LOAD_FAQ_QUESTION_DETAIL"]),nX={entities:{question:{},category:{}},categories:[],commonQuestions:[],relatedQuestions:{},faqTypes:[]},nK=n(45347),nj=(0,G._)({},(0,eM.FH)("HOT_SPOT",["LOAD_HOT_SPOT_LIST"]));function nY(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.contentType,o=t.payload,i=t.id;return n===nj.LOAD_HOT_SPOT_LIST.success?(0,er._)((0,G._)({},e),(0,ed._)({},r,(0,ed._)({},i,o.data))):e}var nQ=(0,eM.FH)("knowledgePlan",["APPLY_ACTIVITY","LOAD_ALL_CREATION_RANK_LIST","LOAD_FEATURED_QUESTIONS","LOAD_LIST","SEND_MESSAGE"]),nJ=(0,th.combineReducers)({lists:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.meta,o=t.payload;return n===nQ.LOAD_LIST.success?(0,er._)((0,G._)({},e),(0,ed._)({},r.stateKey,o)):e},allCreationRankList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===nQ.LOAD_ALL_CREATION_RANK_LIST.success?(0,G._)({},e,r):e},featuredQuestions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===nQ.LOAD_FEATURED_QUESTIONS.request?(0,er._)((0,G._)({},e),{isLoading:!0}):n===nQ.LOAD_FEATURED_QUESTIONS.failure?(0,er._)((0,G._)({},e),{isLoading:!1}):n===nQ.LOAD_FEATURED_QUESTIONS.success?(0,er._)((0,G._)((0,er._)((0,G._)({},e),{isLoading:!1}),r),{data:(0,g._)((null==e?void 0:e.data)||[]).concat((0,g._)(r.data))}):e}}),n$=n(10416),n0=n(71240),n1=(0,eM.FH)("mcn",["LOAD_RANK_LIST","VOTE_PRODUCT","LOAD_ELIGIBLE_CONTENT","LOAD_CONTENT_PRODUCTS","POST_CONTENT_PRODUCTS"]),n2={products:{},rankList:{total:{},yesterday:{}}},n3=(0,th.combineReducers)({household:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n2,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,o=t.meta;if(n===n1.LOAD_RANK_LIST.success){var i={},a={};for(var c in r){var s=function(e){var t={},n=[];return e.forEach(function(e){var r=e.linkcardId;t[r]=e,n.push(r)}),{entities:t,ids:n}}(r[c]),u=s.entities,l=s.ids;Object.assign(i,u),a[c]=l}return(0,er._)((0,G._)({},e),{products:(0,G._)({},e.products,i),rankList:(0,er._)((0,G._)({},e.rankList),(0,ed._)({},o.type,a))})}if(n===n1.VOTE_PRODUCT.request){var d=o.id,p=o.topicStatus;return(0,er._)((0,G._)({},e),{products:(0,er._)((0,G._)({},e.products),(0,ed._)({},d,(0,er._)((0,G._)({},e.products[d]),{topicStatus:p})))})}if(n===n1.VOTE_PRODUCT.failure){var f=o.id,h=o.originalStatus;return(0,er._)((0,G._)({},e),{products:(0,er._)((0,G._)({},e.products),(0,ed._)({},f,(0,er._)((0,G._)({},e.products[f]),{topicStatus:h})))})}return e}}),n4=n(33530),n5=n(38030),n6={isFetching:!1,isDrained:!1,isPrevDrained:!1,result:[],next:null,key:null},n7=function(e,t){var n=e.request,r=e.success,o=e.failure;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n6,i=arguments.length>1?arguments[1]:void 0;switch(i.type){case t:return n6;case n:var a=i.key,c=a!==e.key;return(0,er._)((0,G._)({},c?n6:e),{key:a,isFetching:!0});case r:var s=i.result,u=i.next,l=i.isDrained,d=i.isPrevDrained;return(0,er._)((0,G._)({},e),{result:(0,g._)(e.result).concat((0,g._)(s)),next:u,isDrained:l||s.length<10,isPrevDrained:d,isFetching:!1});case o:return(0,er._)((0,G._)({},e),{isFetching:!1});default:return e}}},n8=n(84),n9=(0,G._)({},(0,eM.FH)("notifications",["GET_RECENT","GET_HISTORY","GET_NOTIFICATION_ACTORS","MARK_ALL_READ"]),(0,eM.co)("notifications",["CHANGE_RECENT_NOTIFICATION_ENTRY","CLEAR_NOTIFICATION_ACTORS"]));new n8.fK.Array(new n8.fK.Object({target:tq.l.USER}));var re=n7(n9.GET_RECENT,n9.CHANGE_RECENT_NOTIFICATION_ENTRY),rt=n7(n9.GET_HISTORY),rn=n7(n9.GET_NOTIFICATION_ACTORS,n9.CLEAR_NOTIFICATION_ACTORS),rr=(0,th.combineReducers)({recent:re,history:rt,notificationActors:rn,recentNotificationEntry:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",t=arguments.length>1?arguments[1]:void 0;return t.type===n9.CHANGE_RECENT_NOTIFICATION_ENTRY?t.entry:e}}),ro=(0,eM.co)("oiaModal",["SHOW","HIDE"]),ri={visible:!1,cancelCallback:null},ra=n(84210),rc=n(30841),rs=(0,eM.FH)("publicEditPermission",["GET_PUBLIC_EDIT_PERMMISSION"]),ru=n(92638),rl=n(19680),rd=n(40195),rp=n(35586),rf=n(72238),rh=n(39041),r_=n(67036),rm=(0,eM.FH)("RING",["FETCH_RING_LIST","FETCH_RING_DETAIL","FETCH_RING_RANK","FETCH_RING_FRIENDS","FETCH_RINGS_SQUARE","FETCH_RECOMMEND_INVITATIONS","POST_USER_JOIN_RING","DELETE_USER_LEAVE_RING","FETCH_RING_FEEDS","FETCH_RING_TAB_FEEDS","FETCH_RING_TAB_HEADER","RING_CHOICENESS","RING_BOTTOM","RING_BAN","DELETE_RING_CONTENT"]),rv=function(e){return"ringFeeds".concat(e[0].toUpperCase()+e.slice(1))},rg={rankList:{},membersList:{},membersListPaging:{}},rT=n(87964),rE=n(53582),ry=n.n(rE),rC=n(92769),rS=n.n(rC);n(38322);var rI=n(89910),rA=n.n(rI),rb=n(56628),rw=n(44169),rZ=function(e){return(null==e?void 0:e.map(function(e){return{val:e,title:e}}))||[]},rx=function(e){var t=e.classificationsOfAllHits,n=e.indexOfAllHits;return rb.WD.map(function(e){return"indexedBy"===e.key?(0,er._)((0,G._)({},e),{options:rZ(n)}):"classification"===e.key?(0,er._)((0,G._)({},e),{options:rZ(t)}):e})},rk={SearchPageStart:"SearchPageStart",SearchIconClick:"SearchIconClick",SearchPullForNext:"SearchPullForNext",SearchRequestStart:"SearchRequestStart",SearchRequestEnd:"SearchRequestEnd",SearchRenderEnd:"SearchRenderEnd",SearchPageStartDuration:"SearchPageStartDuration",SearchTotalDuration:"SearchTotalDuration",SearchIconClickDuration:"SearchIconClickDuration",SearchPullForNextDuration:"SearchPullForNextDuration",SearchRequestDuration:"SearchRequestDuration",SearchRequestDurationFirst:"SearchRequestDurationFirst",SearchRequestDurationSecond:"SearchRequestDurationSecond",SearchServerDuration:"SearchServerDuration",SearchEnvoyUpstreamServiceTime:"SearchEnvoyUpstreamServiceTime"},rR={PULL_FOR_NEXT:"pullForNext",SEARCH_ICON_CLICK:"searchIconClick",PAGE_START:"pageStart"};h={},(0,ed._)(h,rR.PULL_FOR_NEXT,function(e){var t=X(rk.SearchPullForNext,rk.SearchRenderEnd,rk.SearchPullForNextDuration),n={};return null!==t&&(n[rk.SearchPullForNextDuration]=t),null!==e&&(n[rk.SearchRequestDurationSecond]=e),n}),(0,ed._)(h,rR.SEARCH_ICON_CLICK,function(e){var t=X(rk.SearchIconClick,rk.SearchRenderEnd,rk.SearchIconClickDuration),n={};return null!==t&&(n[rk.SearchIconClickDuration]=t),null!==e&&(n[rk.SearchRequestDurationFirst]=e),n}),(0,ed._)(h,rR.PAGE_START,function(e){var t={},n=X(rk.SearchPageStart,rk.SearchRenderEnd,rk.SearchPageStartDuration);null!==n&&(t[rk.SearchPageStartDuration]=n),null!==e&&(t[rk.SearchRequestDurationFirst]=e);var r=K(rk.SearchRenderEnd,rk.SearchTotalDuration);return null!==r&&(t[rk.SearchTotalDuration]=r),t});var rN=function(){W(rk.SearchIconClick)},rO=(0,eM.FH)("search",["GET_GENERAL","GET_GENERAL_A_DAY","GET_GENERAL_A_WEEK","GET_GENERAL_THREE_MONTHS","GET_PEOPLE","GET_TOPIC","GET_COLUMN","GET_LIVE","GET_KM_COURSE","GET_ALBUM","GET_EBOOK","GET_KM_GENERAL","GET_FAVLIST","GET_SUGGEST","GET_TOP_SEARCH","GET_NEW_TOP_SEARCH","GET_NEW_TOP_SEARCH_ZHIDA","REPORT_READ_ZHIDA_CARD","LIKE_TOPIC","CANCEL_LIKE_TOPIC","DISLIKE_TOPIC","GET_MOBILE_TOP_SEARCH","CANCEL_DISLIKE_TOPIC","GET_ZVIDEO","GET_SCHOLAR","GET_RING","GET_SIDEBAR","GET_CALENDAR","GET_SCORES","GET_STATS","GET_COURSES","GET_UNIVERSITIES","GET_ACE_MAJORS","GET_ADMISSIONS_GUIDE","GET_EMPLOYMENT_DESTINATION","GET_CUSTOM_FILTER_TAGS","GET_ZHIDA_RELATED_QUESTIONS","GET_HAS_SCHOLAR_TAB"]),rP=(0,eM.co)("search",["UPDATE_SEARCH_VALUE","CLEAR_SEARCH_QUERY_DATA","SHOW_ZHIDA_RELATED_QUESTIONS_CARD"]),rD=Object.values(rS()(rO,["GET_TOP_SEARCH","GET_MOBILE_TOP_SEARCH","GET_NEW_TOP_SEARCH","GET_NEW_TOP_SEARCH_ZHIDA","REPORT_READ_ZHIDA_CARD"])).map(function(e){return e.success});tq.l.SEARCH_ADVANCED_GENERAL_ARRAY,tq.l.SEARCH_ADVANCED_GENERAL_ONE_DAY_ARRAY,tq.l.SEARCH_ADVANCED_GENERAL_ONE_WEEK_ARRAY,tq.l.SEARCH_ADVANCED_GENERAL_THREE_MONTHS_ARRAY,rO.GET_GENERAL,rO.GET_GENERAL_A_DAY,rO.GET_GENERAL_A_WEEK,rO.GET_GENERAL_THREE_MONTHS,new n8.fK.Array(new n8.fK.Entity("searchKnowledgeGeneral")),new n8.fK.Array(new n8.fK.Entity("searchKnowledge"));var rL=function(e){return e.query},rM=function(e){return"".concat(e.query,"/").concat(e.customQuery)};function rB(e){return{API:{types:rO.GET_SUGGEST,endpoint:"/search/suggest",query:{q:e},headers:{"X-API-Version":"3.0.91","X-App-Za":"OS=Web"}},NOTIFICATION:!1}}var rU=(0,th.combineReducers)({recommendSearch:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;if(n.type===rO.GET_GENERAL.success&&(null===(e=n.payload.relatedSearchResult)||void 0===e?void 0:e.length)){var r=n.payload.relatedSearchResult.map(function(e){return e.object||{}});return rA()((0,g._)(t).concat((0,g._)(r)),function(e,t){return e.id===t.id&&e.type===t.type})}return t},topSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===rO.GET_NEW_TOP_SEARCH.success?t.payload?t.payload.recommendQueries:e:t.type===rO.GET_NEW_TOP_SEARCH_ZHIDA.success?t.payload?t.payload.queryList:e:t.type===rO.GET_TOP_SEARCH.success?t.payload?t.payload.topSearch:e:t.type===rO.GET_MOBILE_TOP_SEARCH.success&&t.payload?{words:t.payload.data}:e},searchValue:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===rP.UPDATE_SEARCH_VALUE?{value:t.data.searchValue}:e},suggestSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===rO.GET_SUGGEST.success&&t.payload?t.payload:e},attachedInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{generalByQuery:{}},t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.loadSearchType,o=t.searchType,i=null==n?void 0:n.searchActionInfo;if(rD.includes(t.type)&&i){if("general"===o){var a=rM(t);return(0,er._)((0,G._)({},e),(0,ed._)({},r,(0,er._)((0,G._)({},e[r]),(0,ed._)({},a,i))))}return(0,er._)((0,G._)({},e),(0,ed._)({},r,i))}return e},nextOffset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{generalByQuery:{}},t=arguments.length>1?arguments[1]:void 0;if(t.type===rP.CLEAR_SEARCH_QUERY_DATA)return{};if(rD.includes(t.type)){var n,r=t.nextOffset,o=t.loadSearchType,i=t.payload,a=t.searchType,c=null==i?void 0:null===(n=i.paging)||void 0===n?void 0:n.next,s=c?(0,ey.parse)(c.split("?")[1]):{},u=s.offset,l=s.limit,d=u?{offset:Number(u),limit:Number(l)}:{offset:r||0,limit:20};if("general"===a){var p=rM(t);return(0,er._)((0,G._)({},e),(0,ed._)({},o,(0,er._)((0,G._)({},e[o]),(0,ed._)({},p,d))))}return(0,er._)((0,G._)({},e),(0,ed._)({},o,d))}return e},topicReview:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.id,o=t.totalVotes,i=t.currentStatus;switch(n){case rO.LIKE_TOPIC.success:return(0,er._)((0,G._)({},e),(0,ed._)({},r,{status:"like",totalVotes:"dislike"===i?o:o+1}));case rO.DISLIKE_TOPIC.success:return(0,er._)((0,G._)({},e),(0,ed._)({},r,{status:"dislike",totalVotes:"like"===i?o:o+1}));case rO.CANCEL_LIKE_TOPIC.success:case rO.CANCEL_DISLIKE_TOPIC.success:return(0,er._)((0,G._)({},e),(0,ed._)({},r,{status:"none",totalVotes:o-1}))}return e},sidebar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===rO.GET_SIDEBAR.success&&t.payload?t.payload:e},calendar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===rO.GET_CALENDAR.success&&t.payload?t.payload:e},scores:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return t.type===rO.GET_SCORES.success&&t.payload?t.payload:e},majors:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,r=n.type,o=n.meta;switch(r){case rO.GET_UNIVERSITIES.request:return(0,er._)((0,G._)({},t),(0,ed._)({},o.dataType,(0,er._)((0,G._)({},t[o.dataType]),{isLoading:!0})));case rO.GET_COURSES.success:case rO.GET_STATS.success:return(0,er._)((0,G._)({},t),(0,ed._)({},o.dataType,n.payload));case rO.GET_UNIVERSITIES.success:return o.isReset?(0,ed._)({},o.dataType,(0,er._)((0,G._)({},n.payload),{isLoading:!1})):(0,er._)((0,G._)({},t),(0,ed._)({},o.dataType,(0,er._)((0,G._)({},t[o.dataType],n.payload),{isLoading:!1,universities:(0,g._)((null===(e=t[o.dataType])||void 0===e?void 0:e.universities)||[]).concat((0,g._)(n.payload.universities))})))}return t},university:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.meta;switch(n){case rO.GET_ACE_MAJORS.success:case rO.GET_ADMISSIONS_GUIDE.success:case rO.GET_EMPLOYMENT_DESTINATION.success:case rO.GET_SCORES.success:return(0,er._)((0,G._)({},e),(0,ed._)({},r.dataType,t.payload))}return e},generalByQuery:(0,ni.Fd)(rO.GET_GENERAL,{mapActionToKey:rM}),generalByQueryInADay:(0,ni.Fd)(rO.GET_GENERAL_A_DAY,{mapActionToKey:rL}),generalByQueryInAWeek:(0,ni.Fd)(rO.GET_GENERAL_A_WEEK,{mapActionToKey:rL}),generalByQueryInThreeMonths:(0,ni.Fd)(rO.GET_GENERAL_THREE_MONTHS,{mapActionToKey:rL}),peopleByQuery:(0,ni.Fd)(rO.GET_PEOPLE,{mapActionToKey:rL}),topicByQuery:(0,ni.Fd)(rO.GET_TOPIC,{mapActionToKey:rL}),zvideoByQuery:(0,ni.Fd)(rO.GET_ZVIDEO,{mapActionToKey:rL}),scholarByQuery:(0,ni.Fd)(rO.GET_SCHOLAR,{mapActionToKey:rL,getExtraData:function(e,t){if(!e.ids||0===e.ids.length)return{scholarFilter:rx(t.payload)}}}),columnByQuery:(0,ni.Fd)(rO.GET_COLUMN,{mapActionToKey:rL}),liveByQuery:(0,ni.Fd)(rO.GET_LIVE,{mapActionToKey:rL}),albumByQuery:(0,ni.Fd)(rO.GET_ALBUM,{mapActionToKey:rL}),eBookByQuery:(0,ni.Fd)(rO.GET_EBOOK,{mapActionToKey:rL}),kmGeneralByQuery:(0,ni.Fd)(rO.GET_KM_GENERAL,{mapActionToKey:rL}),kmCourseByQuery:(0,ni.Fd)(rO.GET_KM_COURSE,{mapActionToKey:rL}),favlistByQuery:(0,ni.Fd)(rO.GET_FAVLIST,{mapActionToKey:rL}),ringByQuery:(0,ni.Fd)(rO.GET_RING,{mapActionToKey:rL}),customFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{requestFinished:!1,keys:[],tags:[]},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;if(n===rO.GET_CUSTOM_FILTER_TAGS.success){var o=r.data,i=void 0===o?[]:o;return{requestFinished:!0,keys:(0,g._)(new Set(ry()(i).map(function(e){return e.group}))),tags:i}}return n===rO.GET_CUSTOM_FILTER_TAGS.failure?(0,er._)((0,G._)({},e),{requestFinished:!0}):e},zhidaRelatedQuestions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isLoading:!1,data:[],showZhidaRelatedQuestionsCard:!1},t=arguments.length>1?arguments[1]:void 0;return t.type===rP.SHOW_ZHIDA_RELATED_QUESTIONS_CARD?(0,er._)((0,G._)({},e),{showZhidaRelatedQuestionsCard:t.meta}):t.type===rO.GET_ZHIDA_RELATED_QUESTIONS.request?(0,er._)((0,G._)({},e),{isLoading:!0}):t.type===rO.GET_ZHIDA_RELATED_QUESTIONS.success?(0,er._)((0,G._)({},e),{data:t.payload.queries||[],isLoading:!1}):t.type===rO.GET_ZHIDA_RELATED_QUESTIONS.failure?(0,er._)((0,G._)({},e),{isLoading:!1}):e}}),rG=(0,G._)({},(0,eM.FH)("social",["UNBIND_SOCIAL_ACCOUNT","DELETE_SOCIAL_ACCOUNT","GET_SOCIAL_BIND","GET_MESSAGE_SETTING","UPDATE_MESSAGE_SETTING","GET_NOTIFICATION_SETTING","UPDATE_NOTIFICATION_SETTING","GET_EMAIL_SETTING","UPDATE_EMAIL_SETTING","GET_PRIVACY_SETTING","UPDATE_PRIVACY_SETTING","GET_BLOCKED_USERS","UNBLOCK_USER","GET_BLOCKED_FOLLOWEES","UNBLOCK_FOLLOWEE","GET_IGNORED_TOPICS","GET_RESTRICTED_TOPICS","RELEASE_IGNORED_TOPIC","GET_LABORATORY_SETTING","UPDATE_LABORATORY_SETTING","UPDATE_WATERMARK_SETTING","GET_PROFILE","UPDATE_AVATAR","UPDATE_ADMIN_PHONE","UPDATE_ADMIN","GET_ORG_PHONE_VERIFY_CODE","GET_WALL_E_BLACKLIST","UNDO_WALL_E_BLOCK"])),rF=rG.UNBIND_SOCIAL_ACCOUNT,rH=rG.DELETE_SOCIAL_ACCOUNT,rz=rG.GET_SOCIAL_BIND,rq=rG.GET_MESSAGE_SETTING,rV=rG.UPDATE_MESSAGE_SETTING,rW=rG.GET_NOTIFICATION_SETTING,rX=rG.UPDATE_NOTIFICATION_SETTING,rK=rG.GET_EMAIL_SETTING,rj=rG.UPDATE_EMAIL_SETTING,rY=rG.GET_PRIVACY_SETTING,rQ=rG.UPDATE_PRIVACY_SETTING,rJ=rG.GET_BLOCKED_USERS,r$=rG.UNBLOCK_USER,r0=rG.GET_BLOCKED_FOLLOWEES,r1=rG.UNBLOCK_FOLLOWEE,r2=rG.GET_IGNORED_TOPICS,r3=rG.GET_RESTRICTED_TOPICS,r4=rG.RELEASE_IGNORED_TOPIC,r5=rG.GET_LABORATORY_SETTING,r6=rG.UPDATE_LABORATORY_SETTING,r7=(rG.UPDATE_WATERMARK_SETTING,rG.GET_PROFILE),r8=(rG.UPDATE_AVATAR,rG.UPDATE_ADMIN_PHONE,rG.UPDATE_ADMIN,rG.GET_ORG_PHONE_VERIFY_CODE,rG.GET_WALL_E_BLACKLIST),r9=rG.UNDO_WALL_E_BLOCK,oe={socialBind:null,inboxMsg:null,notification:{},email:{},privacyFlag:null,blockedUsers:{isFetching:!1,paging:{pageNo:1,pageSize:6},data:[]},blockedFollowees:{isFetching:!1,paging:{pageNo:1,pageSize:6},data:[]},ignoredTopics:{isFetching:!1,paging:{pageNo:1,pageSize:6},data:[]},restrictedTopics:null,laboratory:{}};function ot(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(0,er._)((0,G._)({},e),{isFetching:t})}function on(e){var t=e.page,n=e.payload,r=n.paging,o=void 0===r?{}:r,i=n.data;return{paging:(0,G._)({},o,t),data:(void 0===i?[]:i).map(function(e){return(0,er._)((0,G._)({},e),{isBlocked:!0})}),isFetching:!1}}function or(e,t){var n=e.paging,r=e.data;return{paging:(0,er._)((0,G._)({},n),{totals:n.totals-1}),data:r.map(function(e){return e.urlToken===t?(0,er._)((0,G._)({},e),{isBlocked:!1}):e})}}var oo=n(40861),oi=(0,G._)({},(0,eM.FH)("sms",["SUPPORTED_COUNTRIES"]));function oa(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{supportedCountries:[]},t=arguments.length>1?arguments[1]:void 0;return t.type===oi.SUPPORTED_COUNTRIES.success?{supportedCountries:t.payload.data}:e}var oc=(0,eM.FH)("specials",["GET_SPECIALS","FOLLOW_SPECIAL","UNFOLLOW_SPECIAL"]),os={entities:{},all:{data:[],paging:{},isLoading:!1}},ou=(0,G._)({},(0,eM.FH)("streaming",["CHECK_WHITE_LIST_STATUS","CHECK_ACTOR_STATUS","LOAD_CATEGORY_DATA","LOAD_ACTIVITY_DATA","CHECK_THEATER_STATUS","GET_THEATER_INFO","GET_PUSH_DRAMA_INFO","START_PUSH_DRAMA","CLOSE_PUSH_DRAMA","GET_PULL_INFO","CREATE_PULL_INFO","UPDATE_PULL_INFO","START_PULL_DRAMA","CLOSE_PULL_DRAMA","START_PREVIEW_PULL_DRAMA","STOP_PREVIEW_PULL_DRAMA"])),ol=n(55344),od=n(76741),op=n(15042),of=n(44986),oh={headerData:null,feedLoading:!1,feedError:!1,feedPaging:{},feedList:[]},o_=n(57266),om=n.n(o_),ov=n(95769),og=n.n(ov),oT=function(e){var t=e.payloadOrigin,n=e.currentUser;if((0,nS.isBrowser)()){var r=t.data.map(function(e){return e.target}).filter(function(e){return!!e});og()(r,function(e){return"".concat(e.type,"_").concat(e.id)}).length<r.length&&window.Raven.captureException(Error("topstory recommend list duplication"),{extra:om()({payloadOrigin:t,currentUser:n},Boolean),level:"warning"})}},oE=(0,G._)({},(0,eM.FH)("topstory",["GET_RECOMMEND","GET_FOLLOW","GET_FOLLOW_WONDERFUL","GET_ASIDEDATA","UNINTEREST","UNINTEREST_REASONS","GET_ANNOUNCEMENT","GET_HOT_LIST_CATEGORIES","UPDATE_HOT_LIST_CATEGORIES","GET_HOT_LIST","GET_GUEST_FEEDS","GET_FOLLOW_EXTRA","GET_HOT_DAILY","GET_HOT_HIGHLIGHT","GET_BANNER","GET_COMMERCIAL_BANNER","GET_VIDEOS"]),(0,eM.co)("topstory",["DIMISS_ANNOUNCEMENT","UPDATE_FOLLOW_COUNT","RESET_RECOMMEND","RESET_FOLLOW","RESET_FOLLOW_WONDERFUL","RESET_HOT_LIST","CLEAR_VIDEOS"])),oy=(0,ed._)({},P.Z.isMobileEntry?"mobile":"desktop",!0);(0,G._)({limit:ni.VZ},oy);var oC=n(9813),oS=(0,G._)({},(0,eM.FH)("negativeFeedback",["NEGATIVE_FEEDBACK_UNINTERESTED","NEGATIVE_FEEDBACK_CONTENT"]));function oI(){return{meta:{},isFetching:!1,isDrained:!1,afterId:0,items:[],next:null}}r={},["repeat","quality"].forEach(function(e){return r[e]=e});var oA=(0,th.combineReducers)({recommend:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isDrained:!1,afterId:0,items:[],next:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case oE.GET_RECOMMEND.request:return(0,er._)((0,G._)({},e),{isFetching:!0});case oE.GET_RECOMMEND.success:var n=t.result,r=t.isDrained,o=t.next,i=t.payloadOrigin,a=t.currentUser,c=e.items,s=n.filter(function(e){var t=e.id;return!c.find(function(e){return e.id===t})});oT({payloadOrigin:i,currentUser:a});var u=(0,g._)(c).concat((0,g._)(s));return(0,er._)((0,G._)({},e),{isDrained:r,isFetching:!1,afterId:(u[u.length-1]||{}).id,items:u,next:o,sessionToken:t.payload.sessionToken,serverPayloadOrigin:(0,nS.isBrowser)()?null:i});case oE.GET_RECOMMEND.failure:return(0,er._)((0,G._)({},e),{isFetching:!1,isDrained:!0});case oE.RESET_RECOMMEND:return oI();default:return e}},follow:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isDrained:!1,afterId:0,items:[],next:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case oE.GET_FOLLOW.request:return(0,er._)((0,G._)({},e),{isFetching:!0});case oE.GET_FOLLOW.success:var n=t.result,r=t.isDrained,o=t.next,i=e.items,a=n.filter(function(e){var t=e.id;return!i.find(function(e){return e.id===t})}),c=(0,g._)(i).concat((0,g._)(a));return(0,er._)((0,G._)({},e),{isDrained:r,isFetching:!1,afterId:(c[c.length-1]||{}).id,items:c,next:o,sessionToken:t.payload.sessionToken});case oE.GET_FOLLOW.failure:return(0,er._)((0,G._)({},e),{isFetching:!1,isDrained:!0});case oE.RESET_FOLLOW:return oI();default:return e}},followWonderful:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isDrained:!1,afterId:0,items:[],next:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case oE.GET_FOLLOW_WONDERFUL.request:return(0,er._)((0,G._)({},e),{isFetching:!0});case oE.GET_FOLLOW_WONDERFUL.success:var n=t.result,r=t.isDrained,o=t.next,i=t.hasNew,a=e.items,c=n.filter(function(e){var t=e.id;return!a.find(function(e){return e.id===t})}),s=(0,g._)(a).concat((0,g._)(c));return(0,er._)((0,G._)({},e),{isDrained:r,isFetching:!1,afterId:(s[s.length-1]||{}).id,items:s,next:o,sessionToken:t.payload.sessionToken,hasNew:i});case oE.GET_FOLLOW_WONDERFUL.failure:return(0,er._)((0,G._)({},e),{isFetching:!1,isDrained:!0,hasNew:!0});case oE.RESET_FOLLOW_WONDERFUL:return oI();default:return e}},sidebar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return t.type===oE.GET_ASIDEDATA.success?t.payload:e},announcement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===oE.GET_ANNOUNCEMENT.success&&t.payload?(0,er._)((0,G._)({},e),{data:t.payload}):t.type===oE.DIMISS_ANNOUNCEMENT?(0,er._)((0,G._)({},e),{dimiss:!0}):e},hotList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=(t.payload||{}).data;return t.type===oE.GET_HOT_LIST.success?n:t.type===oE.RESET_HOT_LIST?[]:e},hotListHeadZone:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=(t.payload||{}).headZone;return t.type===oE.GET_HOT_LIST.success?n||{}:e},guestFeeds:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isDrained:!1,afterId:0,items:[],next:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case oE.GET_GUEST_FEEDS.request:return(0,er._)((0,G._)({},e),{isFetching:!0});case oE.GET_GUEST_FEEDS.success:var n=t.result,r=t.isDrained,o=t.next,i=t.offset,a=e.items,c=n.slice(i||0).filter(function(e){var t=e.id;return!a.find(function(e){return e.id===t})}),s=(0,g._)(a).concat((0,g._)(c));return(0,er._)((0,G._)({},e),{isDrained:r,isFetching:!1,afterId:(s[s.length-1]||{}).id,items:s,next:o,sessionToken:t.payload.sessionToken});case oE.GET_GUEST_FEEDS.failure:return(0,er._)((0,G._)({},e),{isFetching:!1,isDrained:!0});default:return e}},followExtra:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isNewUser:null,isFetched:!1,followCount:0,followers:[]},t=arguments.length>1?arguments[1]:void 0;if(t.type===oE.GET_FOLLOW_EXTRA.success){var n=t.payload.guideCard.styleType;return(0,er._)((0,G._)({},e),{isNewUser:"big"===n,isFetched:!0})}if(t.type===oE.UPDATE_FOLLOW_COUNT){var r,o=t.payload.urlToken,i=e.followers;return r=i.findIndex(function(e){return e===o})>-1?i.filter(function(e){return e!==o}):(0,g._)(i).concat([o]),(0,er._)((0,G._)({},e),{followers:r,followCount:r.length})}return e},hotDaily:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{data:[],paging:{}},t=arguments.length>1?arguments[1]:void 0;return t.type===oE.GET_HOT_DAILY.success?t.payload:e},hotHighlight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isDrained:!1,data:[],paging:{}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case oE.GET_HOT_HIGHLIGHT.request:case oE.GET_HOT_HIGHLIGHT.failure:return(0,er._)((0,G._)({},e),{isFetching:t.type===oE.GET_HOT_HIGHLIGHT.request});case oE.GET_HOT_HIGHLIGHT.success:return(0,er._)((0,G._)({},e),{isFetching:!1,paging:t.payload.paging,data:(0,g._)(e.data).concat((0,g._)(r.data))});default:return e}},banner:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;if(n===oE.GET_BANNER.success){var o=t.meta.position;return(0,er._)((0,G._)({},e),(0,ed._)({},o,r.data))}return e},commercialBanner:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{show:!1,banner:{},trackData:{}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;if(n===oE.GET_COMMERCIAL_BANNER.success){var o=(0,op.iL)((0,of.PO)({adjson:null==r?void 0:r.banner})),i=o.creative,a=o.ad,c=void 0===a?{}:a,s=c.id,u=c.template,l=void 0===u?"":u,d=c.impressionTracks,p=c.viewTracks,f=c.clickTracks,h=(void 0===i?{asset:{}}:i).asset,_=h.imgs,m=h.landingUrl,g=h.imgHue;return(0,er._)((0,G._)({},e),{show:"home_top_big_pc_template"===l,trackData:"home_top_big_pc_template"===l?{impressionTracks:void 0===d?[]:d,viewTracks:void 0===p?[]:p,clickTracks:void 0===f?[]:f}:{},banner:{id:s,url:void 0===m?"":m,imageUrl:(void 0===_?[]:_)[0],bgColor:g?"#".concat(g):"GBK99A"}})}return e},video:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{items:[],next:null,isLoading:!1,isDrained:!1},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,o=t.index;switch(n){case oE.CLEAR_VIDEOS:return(0,er._)((0,G._)({},e),{items:[],isLoading:!1});case oE.GET_VIDEOS.request:return(0,er._)((0,G._)({},e,t.clear&&{items:[]}),{isLoading:!0});case oE.GET_VIDEOS.success:return(0,er._)((0,G._)({},e),{items:(0,g._)(e.items).concat((0,g._)(r.data)),next:r.paging.next,isDrained:r.paging.isEnd,isLoading:!1});case oS.NEGATIVE_FEEDBACK_UNINTERESTED.success:case oS.NEGATIVE_FEEDBACK_CONTENT.success:return(0,oC.Uy)(e,function(e){e.items[o]&&(e.items[o].blocked=t.blocked,e.items[o].blockedType=t.blockedType)})}return e},ringTab:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oh,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case rm.FETCH_RING_TAB_HEADER.success:return(0,er._)((0,G._)({},t),{headerData:n.payload});case rm.FETCH_RING_TAB_FEEDS.request:return(0,er._)((0,G._)({},t),{feedLoading:!0});case rm.FETCH_RING_TAB_FEEDS.success:return(0,er._)((0,G._)({},t),{feedList:nd()((null!==(e=t.feedList)&&void 0!==e?e:[]).concat(n.result)),feedLoading:!1,feedPaging:n.payload.paging});case rm.FETCH_RING_TAB_FEEDS.failure:return(0,er._)((0,G._)({},t),{feedLoading:!1,feedError:!0});case"RESET_RING_TAB_FEEDS":return(0,er._)((0,G._)({},t),{feedList:[],feedPaging:{},feedLoading:!1,feedError:!1});default:return t}}}),ob=n(2493);function ow(e,t){var n=e.feeds[t.id],r=n.target,o=(e["".concat(r.schema,"s")]||{})[r.id];return null!=o?(0,G._)({},n,o&&{target:o}):n}var oZ={meta:{},isFetching:!1,items:[],isDrained:!1},ox=function(e,t){var n=e.topstory[t]||oZ,r=n.meta,o=n.isFetching,i=n.isDrained,a=n.items,c=n.serverPayloadOrigin;return(0,G._)({meta:r,isFetching:o,isDrained:i,items:a},"recommend"===t&&{serverPayloadOrigin:c,currentUser:e.currentUser})},ok=function(e){return(0,ob.Z)(function(t){return ox(t,e)},function(e){return e.entities},function(t,n){return(0,er._)((0,G._)({},t),{items:t.items.map(function(t){return function(e,t){var n,r,o,i,a,c,s,u=t.id,l=t.schema;try{switch(l){case"actionCard":return n=e.actionCards,r=e.topics,i=(o=n[u]).card,(a=o.card.topicList)?(0,er._)((0,G._)({},o),{card:(0,er._)((0,G._)({},i),{topicList:a.map(function(e){return r[e]})})}):null;case"feed":return ow(e,{id:u});case"feedAdvert":return e.feedAdverts[u];case"feedGroup":return s=(c=e.feedGroups)&&c[u],(0,er._)((0,G._)({},s),{list:s.list.map(function(t){return ow(e,{id:t})})});default:return t}}catch(e){(0,nS.isBrowser)()&&window.Raven.captureException(e,{level:"warning",extra:t})}return null}(n,t,e)}).filter(Boolean)})})};ok("follow"),ok("followWonderful"),ok("recommend"),(0,tM.P1)(function(e){var t=e.topstory.guestFeeds||oZ;return{isFetching:t.isFetching,isDrained:t.isDrained,items:t.items}},function(e){return e.entities},function(e,t){return(0,er._)((0,G._)({},e),{items:e.items.map(function(e){return ow(t,e)}).filter(Boolean)})});var oR=n(42308),oN=n(96354),oO=n(37209),oP=n(42412),oD=(0,eM.FH)("WALL-E",["LOAD_PROTECT_HISTORY"]),oL={protectHistory:{total:0,pages:{},entities:{}}},oM=(0,eM.FH)("zhiPlus",["LOAD_ZHIPLUS_PERMISSION"]),oB={permissionStatus:9999},oU=n(23561),oG=n(41492),oF={common:nT.ZP,loading:tm,entities:nM.ZP,currentUser:eB.ZP,account:tv.ZP,settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;if(n===rz.success)return(0,er._)((0,G._)({},e),{socialBind:r});if(n===rF.success||n===rH.success){var o=t.account,i=(0,G._)({},e.socialBind);return i[o]&&delete i[o],(0,er._)((0,G._)({},e),{socialBind:i})}if(n===rq.success)return(0,er._)((0,G._)({},e),{inboxMsg:r.inboxmsg});if(n===rV.success){var a=t.input;return(0,er._)((0,G._)({},e),{inboxMsg:(0,G._)({},e.inboxMsg,a)})}if(n===rW.success)return(0,er._)((0,G._)({},e),{notification:r});if(n===rX.success){var c=t.input,s=c.key,u=c.option,l=(0,G._)({},e.notification[s],u);return(0,er._)((0,G._)({},e),{notification:(0,er._)((0,G._)({},e.notification),(0,ed._)({},s,l))})}if(n===rY.success)return(0,er._)((0,G._)({},e),{privacyFlag:r.memberPrivateFlag});if(n===rK.success)return(0,er._)((0,G._)({},e),{email:r});if(n===rj.success){var d=t.input;return(0,er._)((0,G._)({},e),{email:(0,G._)({},e.email,d)})}if(n===rQ.success)return(0,er._)((0,G._)({},e),{privacyFlag:!e.privacyFlag});if(n===rJ.request)return(0,er._)((0,G._)({},e),{blockedUsers:ot(e.blockedUsers,!0)});if(n===rJ.success)return(0,er._)((0,G._)({},e),{blockedUsers:on(t)});if(n===rJ.failure)return(0,er._)((0,G._)({},e),{blockedUsers:ot(e.blockedUsers,!1)});if(n===r8.request)return(0,er._)((0,G._)({},e),{wallEBlacklist:ot(e.wallEBlacklist,!0)});if(n===r8.success)return(0,er._)((0,G._)({},e),{wallEBlacklist:on(t)});if(n===r8.failure)return(0,er._)((0,G._)({},e),{wallEBlacklist:ot(e.wallEBlacklist,!1)});if(n===r9.success)return(0,er._)((0,G._)({},e),{wallEBlacklist:or(e.wallEBlacklist,t.meta.urlToken)});if(n===r$.success)return(0,er._)((0,G._)({},e),{blockedUsers:or(e.blockedUsers,t.meta.urlToken)});if(n===r0.request)return(0,er._)((0,G._)({},e),{blockedFollowees:ot(e.blockedFollowees,!0)});if(n===r0.success)return(0,er._)((0,G._)({},e),{blockedFollowees:on(t)});if(n===r0.failure)return(0,er._)((0,G._)({},e),{blockedFollowees:ot(e.blockedFollowees,!1)});if(t.type===r7.success)return(0,er._)((0,G._)({},e),{account:t.payload});if(n===r1.success)return(0,er._)((0,G._)({},e),{blockedFollowees:or(e.blockedFollowees,t.urlToken)});if(n===r2.request)return(0,er._)((0,G._)({},e),{ignoredTopics:ot(e.ignoredTopics,!0)});if(n===r2.success)return(0,er._)((0,G._)({},e),{ignoredTopics:on(t)});if(n===r2.failure)return(0,er._)((0,G._)({},e),{ignoredTopics:ot(e.ignoredTopics,!1)});if(n===r3.success)return(0,er._)((0,G._)({},e),{restrictedTopics:r.data});if(n===r4.success){var p=e.ignoredTopics,f=p.paging,h=p.data;return(0,er._)((0,G._)({},e),{ignoredTopics:{paging:(0,er._)((0,G._)({},f),{totals:f.totals-1}),data:h.filter(function(e){return e.id!==t.id})}})}if(n===r5.success)return(0,er._)((0,G._)({},e),{laboratory:{useTopstory:r.useTopstory.enable}});if(n===r6.success){var _=t.input.useTopstory;return(0,er._)((0,G._)({},e),{laboratory:{useTopstory:_}})}return e},notification:t1.ZP,people:ra.ZP,env:eU.ZP,me:eB.me,label:n$.ZP,ecommerce:t_.B,oiaModal:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ri,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case ro.SHOW:return(0,er._)((0,G._)({},t),{visible:!0,cancelCallback:(null===(e=n.payload)||void 0===e?void 0:e.callback)||null});case ro.HIDE:return(0,er._)((0,G._)({},t),{visible:!1,cancelCallback:null});default:return t}}},oH={comments:nu,commentsV2:n_,pushNotifications:rl.ZP,messages:n5.ZP,register:rf.ZP,login:eH.ZP,switches:ol.ZP,captcha:tU.ZP,sms:oa,chat:tJ,emoticons:nL.ZP,creator:nC.ZP,creators:nR.ZPm};(0,th.combineReducers)((0,er._)((0,G._)({},oF,oH),{question:rd.ZP,shareTexts:oo.ZP,answers:tT.ZP,banner:ty.ZP,topic:od.ZP,captcha:tU.ZP,sms:oa,explore:nU,articles:tE.ZP,favlists:nG.ZP,pins:rc.ZP,publishedModal:ru.ZP,topstory:oA,upload:oR.ZP,video:oO.ZP,zvideos:oG.ZP,guide:nH,reward:r_.ZP,search:rU,creator:nC.ZP,creatorSalt:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nk,t=arguments.length>1?arguments[1]:void 0,n=t.payload;switch(t.type){case nx.GET_QUESTION_RECOMMEND.success:return(0,er._)((0,G._)({},e),{recommendQuestionList:n.data});case nx.GET_BANNER_IMG_LIST.success:return(0,er._)((0,G._)({},e),{bannerList:JSON.parse(n.data.config).list});case nx.GET_CLAIM_BANNER_IMG_LIST.success:return(0,er._)((0,G._)({},e),{claimBannerList:JSON.parse(n.data.config).list});case nx.GET_AUTHOR_WEBSITES.success:return(0,er._)((0,G._)({},e),{sites:n.data});case nx.GET_AUTHOR_CONTRIBUTES_DOMAIN.success:return(0,er._)((0,G._)({},e),{domains:n});case nx.GET_AUTHOR_CONTRIBUTES_DOMAIN_ALL.success:return(0,er._)((0,G._)({},e),{domainsAll:n});case nx.GET_AUTHOR_STATUS.success:return(0,er._)((0,G._)({},e),{hasRecored:n.hasRecored,hasClaim:n.hasClaim});case nx.GET_AUTHOR_STATUS_NEW.success:return(0,er._)((0,G._)({},e),{statusFetched:!0,hasClue:n.isClue,hasContract:n.isSettlementContract,isExclusive:1===n.exclusiveLevel,isInstitution:n.isInstitution,isOperation:n.isOperatorAccount});case nx.GET_AUTHOR_CONTRIBUTES_LIST.success:return(0,er._)((0,G._)({},e),{hasContributedList:n.data,contributesTotal:n.paging});case nx.GET_DRAFT_INFO.success:return(0,er._)((0,G._)({},e),{previewPageTitle:n.title,previewPageContent:n.content});case nx.GET_REST_CONTRIBUTION_NUMBER.success:return(0,er._)((0,G._)({},e),{restContributionNumber:n.specificNum});case nx.GET_REST_CONTRIBUTION_NUMBER.failure:return(0,er._)((0,G._)({},e),{restContributionNumber:0});case nx.GET_DRAFT_INFO.failure:return(0,er._)((0,G._)({},e),{previewPageTitle:"",previewPageContent:""});case nx.GET_STATUS_COUNT.success:return(0,er._)((0,G._)({},e),{statusCount:n,restContributionNumber:3-((null==n?void 0:n.submit)||0)});case nx.GET_STATUS_COUNT.failure:return(0,er._)((0,G._)({},e),{restContributionNumber:0});case nx.GET_UNREAD_COUNT.success:return(0,er._)((0,G._)({},e),{unread:null==n?void 0:n.unreadCount})}return e},publicEditPermission:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===rs.GET_PUBLIC_EDIT_PERMMISSION.success){var n=t.payload,r=n.isQuestionRedirectEditable,o=n.isQuestionTopicEditable,i=n.isQuestionEditable;return(0,er._)((0,G._)({},e),{isQuestionRedirectEditable:r,isQuestionTopicEditable:o,isQuestionEditable:i})}return e},readStatus:rp.ZP,draftHistory:nN.ZP,notifications:rr,specials:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:os,t=arguments.length>1?arguments[1]:void 0;if(t.type===oc.GET_SPECIALS.request)return(0,er._)((0,G._)({},e),{all:(0,er._)((0,G._)({},e.all),{isLoading:!0})});if(t.type===oc.GET_SPECIALS.success){var n=t.payload,r=n.data,o=n.paging;return(0,er._)((0,G._)({},e),{entities:(0,G._)({},e.entities||{},r.reduce(function(e,t){return(0,G._)((0,ed._)({},t.id,t),e)},{})),all:{data:(0,g._)(e.all.data).concat((0,g._)(r.map(function(e){return e.id}))),paging:o,isLoading:!1}})}if(t.type===oc.GET_SPECIALS.failure)return(0,er._)((0,G._)({},e),{all:(0,er._)((0,G._)({},e.all),{paging:(0,er._)((0,G._)({},e.all.paging),{isEnd:!0}),isLoading:!1})});if([oc.FOLLOW_SPECIAL.request,oc.UNFOLLOW_SPECIAL.failure].includes(t.type)){var i=t.meta.id,a=e.entities;return a[i]?(0,er._)((0,G._)({},e),{entities:(0,er._)((0,G._)({},a),(0,ed._)({},i,(0,er._)((0,G._)({},a[i]),{isFollowing:!0})))}):e}if([oc.UNFOLLOW_SPECIAL.request,oc.FOLLOW_SPECIAL.failure].includes(t.type)){var c=t.meta.id,s=e.entities;return s[c]?(0,er._)((0,G._)({},e),{entities:(0,er._)((0,G._)({},s),(0,ed._)({},c,(0,er._)((0,G._)({},s[c]),{isFollowing:!1})))}):e}return e},collections:t$.ZP,userProfit:oN.ZP,mcn:n0.ZP,mcnActivity:n3,brand:tC.ZP,host:nK.ZP,campaign:tB,knowledgePlan:nJ,wallE:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oL,t=arguments.length>1?arguments[1]:void 0;if(t.type===oD.LOAD_PROTECT_HISTORY.success){var n=t.meta,r=t.payload,o=r.data,i=r.paging.totals;return(0,er._)((0,G._)({},e),{protectHistory:(0,oP.q)(e.protectHistory,n.paging,{data:o,total:i})})}return e},roundtables:rT.ZP,helpCenter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nX,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,o=t.meta;if(n===nW.LOAD_QUESTION_CATEGORIES.success){var i={},a=r.data.map(function(e){var t=e.id;return i[t]=(0,er._)((0,G._)({},e),{questions:[]}),t});return(0,er._)((0,G._)({},e),{entities:(0,er._)((0,G._)({},e.entities),{category:i}),categories:a})}if(n===nW.LOAD_CATEGORY_QUESTIONS.success){var c={},s=r.data.map(function(e){var t=e.id;return c[t]=e,t});return(0,er._)((0,G._)({},e),{entities:(0,er._)((0,G._)({},e.entities),{category:(0,er._)((0,G._)({},e.entities.category),(0,ed._)({},o.categoryId,(0,er._)((0,G._)({},e.entities.category[o.categoryId]),{questions:s}))),question:(0,G._)({},e.entities.question,c)})})}if(n===nW.LOAD_COMMON_QUESTIONS.success){var u={},l=r.data.map(function(e){var t=e.id;return u[t]=e,t});return(0,er._)((0,G._)({},e),{entities:(0,er._)((0,G._)({},e.entities),{question:(0,G._)({},e.entities.question,u)}),commonQuestions:l})}if(n===nW.LOAD_QUESTION_DETAIL.success)return(0,er._)((0,G._)({},e),{entities:(0,er._)((0,G._)({},e.entities),{question:(0,er._)((0,G._)({},e.entities.question),(0,ed._)({},r.id,r))})});if(n===nW.LOAD_RELATED_QUESTIONS.success){var d={},p=r.data.map(function(e){var t=e.id;return d[t]=e,t});return(0,er._)((0,G._)({},e),{entities:(0,er._)((0,G._)({},e.entities),{question:(0,G._)({},e.entities.question,d)}),relatedQuestions:(0,er._)((0,G._)({},e.relatedQuestions),(0,ed._)({},o.questionId,p))})}return n===nW.LOAD_QUESTION_ALL_TYPES.success?(0,er._)((0,G._)({},e),{faqTypes:null==r?void 0:r.data}):e},republish:rh.ZP,commercialReport:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ng,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,o=t.meta;if(n===nm.success){var i=r.data||{},a=i.isReported,c=i.commercialTypes,s=void 0===c?[]:c,u=o.type,l=o.urlToken;return(0,G._)((0,er._)((0,G._)({},e),{commercialTypes:s}),l&&(0,ed._)({},"".concat(u,"s"),(0,ed._)({},l,{isCommercialReported:a,selectedCommercialTypes:s.filter(function(e){return e.isRecognized})})))}if(n===nv){var d=o.questionId,p=r.isCommercialReported;return(0,er._)((0,G._)({},e),{questions:(0,ed._)({},d,{isCommercialReported:p})})}return e},creatorMCN:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nw,t=arguments.length>1?arguments[1]:void 0,n=t.payload;switch(t.type){case nb.GET_HOME_DATA.success:return(0,er._)((0,G._)({},e),{mcn:n.mcn,mcnStatistics:n.mcnStatistics,mcnRight:n.mcnRight||{}});case nb.GET_HOME_DATA.failure:if(2e4===t.err.payload.code)return(0,er._)((0,G._)({},e),{isNoAuth:!0});break;case nb.GET_CREATOR_MANAGE_DATA.success:return(0,er._)((0,G._)({},e),{creatorManageData:n.data,creatorManageDataTotal:n.paging.totals});case nb.GET_CREATOR_CHEESE_MANAGE_DATA.success:return(0,er._)((0,G._)({},e),{creatorCheeseManageData:n.data,creatorCheeseManageDataTotal:n.paging.totals});case nb.GET_MCN_DOMAINS.success:return(0,er._)((0,G._)({},e),{mcnDomains:n.data});case nb.LOAD_PAYMENT_LIST.success:return(0,er._)((0,G._)({},e),{bill:(0,er._)((0,G._)({},e.bill),{list:n})});case nb.LOAD_PAYMENT_DETAIL.success:return(0,er._)((0,G._)({},e),{bill:(0,er._)((0,G._)({},e.bill),{detail:n})});case nb.GET_HEALTH_SCORE.success:return(0,er._)((0,G._)({},e),{healthScore:n});case nb.LOAD_HEALTHSCORE_LIST.success:return(0,er._)((0,G._)({},e),{healthScoreRecordInfo:n});case nb.LOAD_STATISTIC_HEALTH_SCORE_DATA.success:return(0,er._)((0,G._)({},e),{statisticHealthScoreData:n.data});case nb.LOAD_STATISTIC_HEALTH_SCORE_DATA.failure:return(0,er._)((0,G._)({},e),{statisticHealthScoreData:null});case nb.BEFORE_DOWNLOAD_CHECK.success:return(0,er._)((0,G._)({},e),{beforeDownloadCheckResult:n.data});case nb.LOAD_BEFORE_PROMOTION_DATA.success:return(0,er._)((0,G._)({},e),{beforePromotionData:n.data});case nb.LOAD_AFTER_PROMOTION_DATA.success:return(0,er._)((0,G._)({},e),{afterPromotionData:n.data});case nb.LOAD_PROMOTION_DETAIL_DATA.success:return(0,er._)((0,G._)({},e),{promotionDetailData:n.data})}return e},commentManage:nr,commentPermission:no.ZP,creatorRightStatus:nZ.ZP,zhiPlus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oB,t=arguments.length>1?arguments[1]:void 0;if(t.type===oM.LOAD_ZHIPLUS_PERMISSION.success){var n=t.payload.permissionStatus;return(0,er._)((0,G._)({},e),{permissionStatus:null==n?void 0:n.zhiZixuan})}return e},streaming:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.meta;switch(t.type){case ou.CHECK_WHITE_LIST_STATUS.success:return(0,er._)((0,G._)({},e),{showCategorySelector:(null==n?void 0:n.isMediaExternal)!==1,whiteListStatus:null==n?void 0:n.status});case ou.CHECK_ACTOR_STATUS.request:return(0,er._)((0,G._)({},e),{isCheckingStatus:!0});case ou.CHECK_ACTOR_STATUS.success:return(0,er._)((0,G._)({},e),{actorStatus:n,isCheckingStatus:!1});case ou.CHECK_ACTOR_STATUS.failure:var o=t.err,i=(void 0===o?{}:o).payload;return(0,er._)((0,G._)({},e),{actorStatus:i,isCheckingStatus:!1});case ou.LOAD_CATEGORY_DATA.success:var a=n.data;return(0,er._)((0,G._)({},e),{categoryList:a});case ou.LOAD_ACTIVITY_DATA.success:var c=n.data;return(0,er._)((0,G._)({},e),{activities:c});case ou.CHECK_THEATER_STATUS.success:return(0,er._)((0,G._)({},e),{theater:null==n?void 0:n.theater});case ou.GET_THEATER_INFO.success:var s=n.theater,u=(void 0===s?{}:s).drama;return(0,er._)((0,G._)({},e),{currentDramaInfo:u});case ou.GET_PUSH_DRAMA_INFO.success:return(0,er._)((0,G._)({},e),{pushStreamingRes:n});case ou.START_PUSH_DRAMA.success:return(0,er._)((0,G._)({},e),{currentDramaInfo:null==n?void 0:n.drama});case ou.GET_PULL_INFO.success:return(0,er._)((0,G._)({},e),{currentPullInfo:n});case ou.CREATE_PULL_INFO.success:return(0,er._)((0,G._)({},e),{currentPullInfo:(0,er._)((0,G._)({},e.currentPullInfo,r.data),{id:n.id})});case ou.UPDATE_PULL_INFO.success:return(0,er._)((0,G._)({},e),{currentPullInfo:(0,G._)({},e.currentPullInfo,r.data)});case ou.START_PULL_DRAMA.success:return(0,er._)((0,G._)({},e),{currentPullInfo:(0,er._)((0,G._)({},e.currentPullInfo),{theater:(0,er._)((0,G._)({},e.currentPullInfo.theater),{drama:n.drama})})});case ou.START_PREVIEW_PULL_DRAMA.success:return(0,er._)((0,G._)({},e),{currentPullInfo:(0,er._)((0,G._)({},e.currentPullInfo),{preview:n})});case ou.STOP_PREVIEW_PULL_DRAMA.success:return(0,er._)((0,G._)({},e),{currentPullInfo:(0,er._)((0,G._)({},e.currentPullInfo),{preview:void 0})})}return e},creationRanking:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===ny.GET_CREATION_RANKING.success?(0,er._)((0,G._)({},e),{creationRankData:t.payload}):t.type===ny.GET__CREATION_RANKING_POSTER.success?(0,er._)((0,G._)({},e),{posterData:t.payload}):t.type===ny.GET_CREATION_RANKING_TYPE.success?(0,er._)((0,G._)({},e),{rankTypeData:t.payload}):t.type===ny.GET__CREATION_RANKING_MONTHLIST.success?(0,er._)((0,G._)({},e),{monthList:t.payload}):e},eduSections:nD,adPromotion:tg.ZP,editVideo:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nP,o=arguments.length>1?arguments[1]:void 0;switch(o.type){case nO.GET_ENABLED.success:return(0,er._)((0,G._)({},r),{editVideoEnabled:null===(e=o.payload)||void 0===e?void 0:e.pinVideoSwitch});case nO.GET_ZVIDEO_WHITELIST.success:return(0,er._)((0,G._)({},r),{isZvideoUser:null===(t=o.payload)||void 0===t?void 0:null===(n=t.data)||void 0===n?void 0:n.isZvideo});default:return r}},zhidaEntry:oU.Z,guideZhidaCard:nV,hotSpot:nY,contentColumnCard:nE.Z,rings:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rg,r=arguments.length>1?arguments[1]:void 0;if(r.type===rm.DELETE_RING_CONTENT.success){var o,i=function(e){var t;return(0,ed._)({},e,n[e]?(0,er._)((0,G._)({},n[e]),(0,ed._)({},r.meta.ringId,(null!==(o=null===(t=n[e])||void 0===t?void 0:t[r.meta.ringId])&&void 0!==o?o:[]).filter(function(e){return e.id!==r.meta.contentToken}))):void 0)};return(0,G._)({},n,i(rv("new")),i(rv("hot")),i(rv("essence")))}if("RESET_RING_FEEDS"===r.type){var a=rv(r.payload.tabType);return(0,er._)((0,G._)({},n),(0,ed._)({},a,(0,er._)((0,G._)({},n[a]),(0,ed._)({},r.payload.ringId,[]))))}if(r.type===rm.RING_CHOICENESS.success){var c,s,u=rv("essence"),l=null!==(s=null===(c=n[u])||void 0===c?void 0:c[r.meta.ringId])&&void 0!==s?s:[],d=r.meta.pinToken;return(0,er._)((0,G._)({},n),(0,ed._)({},u,(0,er._)((0,G._)({},n[u]),(0,ed._)({},r.meta.ringId,"POST"===r.meta.method?nd()([{id:d,schema:"pins"}].concat((0,g._)(l))):l.filter(function(e){return e.id!==d})))))}if(r.type===rm.FETCH_RING_FEEDS.success){var p,f,h=rv(r.meta.tabType);return(0,er._)((0,G._)({},n),(0,ed._)({},h,(0,er._)((0,G._)({},n[h]),(0,ed._)({},r.meta.ringId,nd()((null!==(f=null===(p=n[h])||void 0===p?void 0:p[r.meta.ringId])&&void 0!==f?f:[]).concat(r.result))))))}return r.type===rm.FETCH_RING_RANK.success?(0,er._)((0,G._)({},n),{rankList:(0,er._)((0,G._)({},n.rankList),(0,ed._)({},r.meta.ringId,nd()((null!==(e=n.rankList[r.meta.ringId])&&void 0!==e?e:[]).concat(r.result))))}):r.type===rm.FETCH_RING_FRIENDS.success?(0,er._)((0,G._)({},n),{membersListPaging:(0,ed._)({},r.meta.ringId,(0,G._)({},r.payload.paging)),membersList:(0,er._)((0,G._)({},n.membersList),(0,ed._)({},r.meta.ringId,nd()((null!==(t=n.membersList[r.meta.ringId])&&void 0!==t?t:[]).concat(r.result))))}):n},menuIgnoreSet:n4.ZP}));var oz=n(10886),oq=n(61436),oV=n(35102),oW=function(e){var t=e.width,n=e.height;return t>=1366&&n>=550},oX="articleDraft",oK=(0,G._)({},(0,eM.FH)(oX,["UPLOAD_COVER","UPLOAD_CONTENT_IMAGE","UPLOAD_VIDEO","UPDATE_DRAFT","GET_DRAFT","REVIEW_COLUMN","PUBLISH_COLUMN","LOAD_DISCLAIMERS","ADD_TOPIC","DELETE_TOPIC","FETCH_RECOMMEND_TOPIC","SCHEDULED_PUBLISH","CANCEL_SCHEDULED_PUBLISH","VALIDATE_SCHEDULED_PUBLISH","LOAD_LIMITED","LOAD_CITYS","GET_AI_TASK","GET_ACCOUNT_BINDING"]),(0,eM.co)(oX,["TOGGLE_FULL_SCREEN","REMOVE_COVER","RESET_DRAFT","SELECT_COLUMN"])),oj=oK.UPLOAD_COVER,oY=oK.UPLOAD_CONTENT_IMAGE,oQ=oK.UPLOAD_VIDEO,oJ=oK.UPDATE_DRAFT,o$=oK.GET_DRAFT,o0=oK.REVIEW_COLUMN,o1=oK.LOAD_DISCLAIMERS,o2=oK.ADD_TOPIC,o3=oK.DELETE_TOPIC,o4=oK.FETCH_RECOMMEND_TOPIC,o5=(oK.TOGGLE_FULL_SCREEN,oK.REMOVE_COVER),o6=oK.RESET_DRAFT,o7=oK.SELECT_COLUMN,o8=oK.LOAD_LIMITED;function o9(e,t,n){var r=new FormData;return"string"==typeof t?r.append("url",t):(t.length&&(t=t[0]),r.append("picture",t)),n&&r.append("source",n),{API:{types:e,endpoint:"uploaded_images",root:P.Z.fetchRoot.zhuanlan,method:"POST",body:r}}}function ie(e,t,n){return function(r){return(0,oR.x1)(t,(0,G._)({autoRotate:!1},n&&{source:n})).then(function(t){return r({type:e.success,payload:(0,ea.camelizeKeys)(t)})},function(t){return r({type:e.failure,err:t})})}}function it(e){var t=e.payload,n=t.dataRawheight,r=t.dataRawwidth,o=t.hash;return{url:t.src,width:r,height:n,id:o,watermark:t.watermark,watermarkSrc:t.watermarkSrc,originalSrc:t.originalSrc}}function ir(e){return{API:{root:P.Z.fetchRoot.zhuanlan,method:"GET",types:o1,endpoint:"articles/".concat(e,"/disclaimers")}}}function io(e,t){return{API:{types:o2,endpoint:"articles/".concat(e,"/topics"),root:P.Z.fetchRoot.zhuanlan,method:"POST",body:t}}}function ii(e){return function(t,n){n().selectedColumn!==e&&t({type:o7,payload:e})}}function ia(){return{API:{method:"GET",types:oK.GET_ACCOUNT_BINDING,endpoint:"editor/import/account_binding",root:P.Z.fetchRoot.www},FAILSAFE:!0}}var ic={titleImage:"",titleImageSize:{},isTitleImageFullScreen:!1,canTitleImageFullScreen:!1,title:"",titleImageUploading:!1,error:"",content:"",draftLoading:!1,updating:!1,globalLoading:!1,pendingVideo:{resource:null,error:null},deleteFail:{fail:!1},recommendTopics:[],selectedColumn:null,articleDisclaimers:[],aiTask:null},is=(0,tM.P1)([eB.ib,function(e){return e.articleDraft},function(e){return e.me.columnContributions},eU.Hu,function(e){return e.userProfit.permission.visible},eB.W5,eB.wY],function(e,t,n,r,o,i,a){return{currentUser:e,draft:t,myColumns:n,isMobile:r,showUserProfitButton:o,isOrg:i,currentUserToken:a,showAIAssistant:t.showAIAssistant}}),iu=n(97712),il=n(83213),id="columnAutocomplete",ip=(0,G._)({},(0,eM.FH)(id,["FETCH_TOPICS","FETCH_USERS","FETCH_MY_FRIENDS"]),(0,eM.co)(id,["RESET_USERS","RESET_FRIENDS"])),ih={users:[],friends:[]},i_=n(24316),im=(0,eM.FH)("column",["IGNORE_CONTRIBUTE_REQUEST","GET_RECOMMENDED_CONTRIBUTORS","INVITE_CONTRIBUTOR","CANCEL_INVITE_CONTRIBUTOR","SET_AUTO_INVITE"]),iv=(0,th.combineReducers)({contributeRequests:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===im.IGNORE_CONTRIBUTE_REQUEST.success?e.filter(function(e){return e.article.id!==t.articleId}):e},autoInviteEnabled:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return t.type===im.GET_RECOMMENDED_CONTRIBUTORS.success?!!t.payload.isAuto:t.type===im.SET_AUTO_INVITE.success?t.meta:e},recommendedContributors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===im.GET_RECOMMENDED_CONTRIBUTORS.success?t.payload.data:t.type===im.INVITE_CONTRIBUTOR.success?e.map(function(e){return e.author.id===t.userId?(0,er._)((0,G._)({},e),{hasInvited:!0}):e}):e}}),ig=(0,eM.FH)("column",["GET_FOLLOWING_COLUMNS"]),iT=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.offset,r=void 0===n?0:n,o=t.limit,i=void 0===o?ni.VZ:o;return function(t,n){var o,a=((null===(o=n().followingColumns)||void 0===o?void 0:o[e])||{}).paging,c=a?{endpoint:a.next}:{endpoint:"members/".concat(encodeURIComponent(e),"/following-columns"),query:{include:"data[*].intro,followers,articles_count,voteup_count,items_count",offset:r,limit:i}};return t({urlToken:e,API:(0,G._)({types:ig.GET_FOLLOWING_COLUMNS},c),schema:tq.l.COLUMN_ARRAY})}},iE=n(35677),iy=(0,eM.FH)("previewArticle",["GET"]),iC=(0,eM.FH)("recommendations",["GET","GET_HOME"]);function iS(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){return n({API:{root:P.Z.fetchRoot.zhuanlan,types:iC.GET_HOME,endpoint:"/recommendations/".concat(e),query:t}})}}var iI="requestColumn",iA=(0,G._)({},(0,eM.FH)(iI,["SUBMIT_REQUEST","CHECK_REQUEST","GET_CATEGORIES"]),(0,eM.co)(iI,["CLEAR_REQUEST_ERROR"])),ib={categories:[],error:null},iw=(0,th.combineReducers)((0,er._)((0,G._)({},oF,oH),{answers:tT.ZP,sms:oa,comments:nu,recommendation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{homeRecommendations:[]},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,o=t.parentId;if(n===iC.GET.success){var i,a=e[o]?e[o].data:[];if(!Array.isArray(r.data))return e;var c=(0,g._)(a).concat((0,g._)(r.data));return(0,er._)((0,G._)({},e),(i={},(0,ed._)(i,o,{data:c,paging:r.paging}),(0,ed._)(i,"list",c),i))}return n===iC.GET_HOME.success&&Array.isArray(r.data)?(0,er._)((0,G._)({},e),{homeRecommendations:r.data.filter(Boolean)}):e},shareTexts:oo.ZP,articles:tE.ZP,previewPost:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.payload;return t.type===iy.GET.success&&n?n:e},favlists:nG.ZP,columns:oz.ZP,reward:r_.ZP,video:oO.ZP,switches:ol.ZP,messages:n5.ZP,register:rf.ZP,login:eH.ZP,topstory:oA,readStatus:rp.ZP,column:il.ZP,requestColumn:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ib,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case iA.SUBMIT_REQUEST.success:var n=t.payload.manualCensor;return(0,er._)((0,G._)({},e),{manualCensor:n,error:null});case iA.CHECK_REQUEST.success:case iA.CLEAR_REQUEST_ERROR:return(0,er._)((0,G._)({},e),{error:null});case iA.SUBMIT_REQUEST.failure:case iA.CHECK_REQUEST.failure:return(0,er._)((0,G._)({},e),{error:t.err.payload});case iA.GET_CATEGORIES.success:return(0,er._)((0,G._)({},e),{categories:t.payload.data||[]})}return e},articleContribution:oq.ZP,columnContribution:iv,draftHistory:nN.ZP,upload:oR.ZP,articleDraft:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ic,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case oK.UPLOAD_COVER.request:return(0,er._)((0,G._)({},n),{titleImageUploading:!0});case oK.UPLOAD_COVER.success:var o=it(r),i=o.url,a=o.width,c=o.height,s=oW({width:a,height:c});return(0,er._)((0,G._)({},n),{titleImage:i,titleImageSize:{width:a,height:c},canTitleImageFullScreen:s,isTitleImageFullScreen:s,titleImageUploading:!1});case oK.UPLOAD_COVER.failure:return(0,er._)((0,G._)({},n),{titleImageUploading:!1});case oK.UPLOAD_CONTENT_IMAGE.request:return(0,er._)((0,G._)({},n),{globalLoading:!0});case oK.UPLOAD_CONTENT_IMAGE.success:case oK.UPLOAD_CONTENT_IMAGE.failure:return(0,er._)((0,G._)({},n),{globalLoading:!1});case oK.UPLOAD_VIDEO.request:return(0,er._)((0,G._)({},n),{globalLoading:!0,pendingVideo:(0,G._)({},n.pendingVideo)});case oK.UPLOAD_VIDEO.success:return(0,er._)((0,G._)({},n),{globalLoading:!1,pendingVideo:(0,er._)((0,G._)({},n.pendingVideo),{resource:r.payload})});case oK.UPLOAD_VIDEO.failure:return(0,er._)((0,G._)({},n),{globalLoading:!1,pendingVideo:(0,G._)({},n.pendingVideo)});case oK.DELETE_TOPIC.failure:return(0,er._)((0,G._)({},n),{deleteFail:!0});case oK.TOGGLE_FULL_SCREEN:return(0,er._)((0,G._)({},n),{isTitleImageFullScreen:!n.isTitleImageFullScreen});case oK.REMOVE_COVER:return(0,er._)((0,G._)({},n),{titleImage:"",titleImageSize:{},isTitleImageFullScreen:!1,canTitleImageFullScreen:!1});case oK.RESET_DRAFT:return(0,er._)((0,G._)({},n),{content:"",title:""});case oK.UPDATE_DRAFT.request:var u=r.meta.id;return(0,er._)((0,G._)({},n),{draftLoading:!u,updating:!0});case oK.UPDATE_DRAFT.success:var l=r.meta,d=r.payload,p=l.body,f=(0,er._)((0,G._)({},rS()(p,["isTitleImageFullScreen","delta_time"]),d),{updatedTime:new Date().toISOString(),updating:!1,draftLoading:!1,error:""});return(0,G._)({},n,f);case oK.UPDATE_DRAFT.failure:return(0,er._)((0,G._)({},n),{updating:!1,draftLoading:!1,updatedTime:new Date().toISOString(),error:function(e){if(!e)return"尝试保存时发生未知错误";var t=e.message,n=e.status,r=e.payload,o=e.errors;return r&&r.message?"尝试保存时发生错误：".concat(r.message):Array.isArray(o)&&o[0]?"尝试保存时发生错误：".concat(o[0].message):t?(0,oV.hu)(t)?"尝试保存时发生网络请求错误":t.startsWith("request http")?"尝试保存时发生错误".concat(n?"："+n:""):"尝试保存时发生错误：".concat(t):""}(r.err||r.error)});case oK.GET_DRAFT.success:var h=r.payload;return(0,er._)((0,G._)({},n,h),{updatedTime:new Date(1e3*h.updated).toISOString()});case oK.FETCH_RECOMMEND_TOPIC.success:return(0,er._)((0,G._)({},n),{recommendTopics:r.payload.data||[]});case oK.LOAD_DISCLAIMERS.success:return(0,er._)((0,G._)({},n),{articleDisclaimers:r.payload.data});case oK.SELECT_COLUMN:return(0,er._)((0,G._)({},n),{selectedColumn:r.payload});case oK.CANCEL_SCHEDULED_PUBLISH.success:return(0,er._)((0,G._)({},n),{schedule:null});case oK.LOAD_CITYS.success:return(0,er._)((0,G._)({},n),{cityData:null===(e=r.payload)||void 0===e?void 0:null===(t=e.data)||void 0===t?void 0:t.regions});case oK.GET_AI_TASK.success:return(0,er._)((0,G._)({},n),{aiTask:r.payload});default:return n}},articleDrafts:iu.ZP,columnAutocomplete:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ih,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ip.FETCH_USERS.success:return(0,er._)((0,G._)({},e),{users:t.payload.data||[]});case ip.RESET_USERS:return(0,er._)((0,G._)({},e),{users:[]});case ip.FETCH_MY_FRIENDS.success:return(0,er._)((0,G._)({},e),{friends:t.payload.data||[]});case ip.RESET_FRIENDS:return(0,er._)((0,G._)({},e),{friends:[]});default:return e}},columnCollection:i_.ZP,ecommerce:t_.B,chat:tJ,emoticons:nL.ZP,userProfit:oN.ZP,mcn:n0.ZP,zvideos:oG.ZP,republish:rh.ZP,commentPermission:no.ZP,menuIgnoreSet:n4.ZP,creatorRightStatus:nZ.ZP,adPromotion:tg.ZP,paidColumn:iE.ZP,followingColumns:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ig.GET_FOLLOWING_COLUMNS.request:return(0,er._)((0,G._)({},e),{loading:!0});case ig.GET_FOLLOWING_COLUMNS.success:var n,r,o=t.urlToken,i=t.payload||{},a=i.paging,c=i.data;return(0,er._)((0,G._)({},e),(r={},(0,ed._)(r,o,{paging:a,data:(null===(n=e[o])||void 0===n?void 0:n.data)?(0,g._)(e[o].data).concat((0,g._)(c)):c}),(0,ed._)(r,"loading",!1),r));default:return e}},hotSpot:nY,contentColumnCard:nE.Z,publishedModal:ru.ZP,pins:rc.ZP})),iZ=n(14914),ix=(0,nS.isBrowser)()?(0,m.tZ)(iZ.Route,{path:"*",onEnter:function(e){var t=e.location;if(/^\/{2,}/.test(t.pathname)){var n=(0,ef._)(/^\/{1,}(\/.*)$/.exec(t.pathname),2)[1];t.pathname=n}window.location="".concat(t.pathname).concat(t.search)}}):null,ik=/#comment-(\d+)/;function iR(e){var t=e.match(ik);return t&&t[1]}var iN=function(e,t){"undefined"!=typeof window&&window.Raven&&window.Raven.captureException(e,{logger:"RouteLoader",fingerprint:["RouteLoader"],extra:t})},iO=function(e){return function(){return e().then(function(e){return e.default}).catch(function(e){return console.error(e),iN(e,{target:"resolveComponent"}),tc.Ko})}};function iP(e){return e.routes[e.routes.length-1].name}var iD=n(20857),iL=n(86325),iM=n(85626),iB=n(45913),iU=n(14168),iG=n.n(iU),iF=n(11786),iH=n(32546),iz=n(26113),iq=n(25734),iV=n(29229),iW=n(97813),iX=n(34473),iK=n(7522),ij=n(24405),iY=n(19818),iQ=n(95951),iJ=n(67814),i$=n.n(iJ),i0=n(87641),i1=n(87494),i2=n(56722),i3=function(e){var t=e.top,n=e.right,r=e.bg,o=e.background,i=(0,F._)(e,["top","right","bg","background"]),a=ae();return(0,m.tZ)(i0.xu,(0,G._)({color:"GBK99B",p:".5px 4px",sx:(0,G._)({position:"absolute",right:void 0===n?"5px":n,top:void 0===t?"0":t,fontSize:11,transform:"scale(0.8) translate(100%, -50%)",border:"2px solid",borderColor:a.bgColor,borderRadius:9999,fontWeight:"normal"},o?{background:o}:{bg:void 0===r?"GRD03A":r})},i))},i4={bgColor:"GBK99A",logo:"MapBrand",headerTitle:"MapBrand",navColor:"MapText03A",navActiveColor:"MapBrand"},i5={orgHome:{pathname:"/organization",label:"管理中心",isRouterLink:!0,needsLogin:!0,getIsActive:function(e){return"/organization"===e||e.startsWith("/organization/question")}},orgRecommend:{pathname:"/index",label:"推荐",isRouterLink:!0,needsLogin:!0},follow:{pathname:"/follow",label:"关注",isRouterLink:!0,needsLogin:!0},recommend:{pathname:"/",label:"推荐",isRouterLink:!0,needsLogin:!0},hot:{pathname:"/hot",label:"热榜",isRouterLink:!0,needsLogin:!0},columnSquare:{pathname:"/column-square",label:"专栏",isRouterLink:!0,needsLogin:!0},ring:{pathname:"/ring-feeds",label:"圈子",isRouterLink:!0,needsLogin:!0,badge:(0,m.tZ)(i3,{right:"5px",background:"linear-gradient(270deg, #1CBEFE 0%, #00CA9E 100%)",children:"New"})},consult:{pathname:"/consult",label:"付费咨询",target:"_blank"},education:{pathname:"/education/learning",label:"知学堂",target:"_blank"}},i6=[i5.follow,i5.recommend,i5.hot,i5.columnSquare,i5.ring,"separator",i5.consult,i5.education],i7=[i5.orgHome,"separator",i5.follow,i5.orgRecommend,i5.hot,i5.columnSquare,i5.ring,"separator",i5.consult,i5.education],i8=[{label:"消息",Icon:iW.Z,href:"/notifications"},{label:"私信",Icon:iK.Z,href:"/messages"},{label:"创作中心",Icon:iX.Z,href:"/creator"}],i9=(0,b.createContext)(i4),ae=function(){return(0,b.useContext)(i9)},at=(0,i2.E)(i0.xu),an=function(){return(0,m.tZ)(i0.xu,{bg:"MapUIFrame08A",mx:"10px",width:"1px",height:"15px"})},ar=function(){var e=ae();return(0,m.tZ)(at,{layoutId:"navigation-link-active-indicator",transition:{ease:"easeOut",duration:.2},bg:e.navActiveColor,css:{position:"absolute",bottom:-10,left:0,right:0,height:"4px"}})},ao=function(e){var t=e.href,n=e.isActive,r=e.children,o=e.onClick,i=e.target,a=e.rel,c=e.badge,s=ae(),u=(0,ij.F)();return(0,m.tZ)(i0.rU,{href:t,target:i,rel:a,onClick:o,className:n?"is-active":"","aria-current":n?"page":void 0,sx:(0,er._)((0,G._)({display:"flex",alignItems:"center",height:"100%",color:n?"MapText02A":s.navColor,fontWeight:n?"bold":"normal",padding:"0 12px",fontSize:"16px",transition:"color 0.15s ease-out",textDecoration:"none"},(0,i1.k)(u)),{"&:hover":{fontWeight:"bold",color:"MapText02A"}}),children:(0,m.BX)(i0.kC,{alignItems:"center",css:{position:"relative",gap:"2px"},children:[r,c,n&&(0,m.tZ)(ar,{})]})})},ai=n(44066),aa=function(){return(0,m.BX)(i0.kC,{flex:1,as:"form",action:"/search",alignItems:"center",px:"12px",sx:{maxWidth:365,borderRadius:9999,paddingLeft:16,height:38,border:"1px solid",borderColor:"GBK09A",color:"GBK02A","&:focus-within":{borderColor:"GBL05A",svg:{color:"MapBrand"}}},children:[(0,m.tZ)("input",{name:"q",type:"text",placeholder:"搜索你感兴趣的内容...",css:{color:"inherit",width:"100%",border:"none",outline:"none",fontSize:"14px"}}),(0,m.tZ)(i0.zx,{bg:"unset",p:0,type:"submit",display:"flex",alignItems:"center",justifyContent:"center",sx:{color:"inherit",cursor:"pointer"},children:(0,m.tZ)(ai.ZP,{size:18})})]})},ac=(0,b.forwardRef)(function(e,t){var n=e.href,r=e.label,o=e.Icon,i=e.count,a=(0,F._)(e,["href","label","Icon","count"]),c=(0,ij.F)();return(0,m.BX)(i0.rU,(0,er._)((0,G._)({ref:t,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",href:n,minWidth:"48px",color:"MapText04A",fontSize:"12px",lineHeight:"14px",sx:(0,er._)((0,G._)({position:"relative",gap:"2px",transition:"color 0.15s ease-out",textDecoration:"none"},(0,i1.k)(c)),{"&:hover":{color:"MapText02A"}})},a),{children:[o&&(0,m.tZ)(o,{size:18}),(0,m.tZ)(i0.xv,{children:r}),"number"==typeof i&&i>0&&(0,m.tZ)(i3,{top:"1px",right:"50%",children:i>99?"99+":i})]}))}),as=function(e){var t=e.zoom,n=void 0===t?1:t,r=e.color,o=void 0===r?"primary":r,i=(0,F._)(e,["zoom","color"]);return(0,m.BX)("svg",(0,er._)((0,G._)({viewBox:"0 0 64 30",fill:(0,ij.F)().colors[o]||o,width:64*n,height:30*n},i),{children:[(0,m.tZ)("path",{d:"M29.05 4.582H16.733V25.94h3.018l.403 2.572 4.081-2.572h4.815V4.582zm-5.207 18.69l-2.396 1.509-.235-1.508h-1.724V7.233h6.78v16.04h-2.425zM14.46 14.191H9.982c0-.471.033-.954.039-1.458v-5.5h5.106V5.935a1.352 1.352 0 0 0-.404-.957 1.378 1.378 0 0 0-.968-.396H5.783c.028-.088.056-.177.084-.255.274-.82 1.153-3.326 1.153-3.326a4.262 4.262 0 0 0-2.413.698c-.57.4-.912.682-1.371 1.946-.532 1.453-.997 2.856-1.31 3.693C1.444 8.674.28 11.025.28 11.025a5.85 5.85 0 0 0 2.52-.61c1.119-.593 1.679-1.502 2.054-2.883l.09-.3h2.334v5.5c0 .5-.045.982-.073 1.46h-4.12c-.71 0-1.39.278-1.893.775a2.638 2.638 0 0 0-.783 1.874h6.527a17.717 17.717 0 0 1-.778 3.649 16.796 16.796 0 0 1-3.012 5.273A33.104 33.104 0 0 1 0 28.74s3.13 1.175 5.425-.954c1.388-1.292 2.631-3.814 3.23-5.727a28.09 28.09 0 0 0 1.12-5.229h5.967v-1.37a1.254 1.254 0 0 0-.373-.899 1.279 1.279 0 0 0-.909-.37z"}),(0,m.tZ)("path",{d:"M11.27 19.675l-2.312 1.491 5.038 7.458a6.905 6.905 0 0 0 .672-2.218 3.15 3.15 0 0 0-.28-2.168l-3.118-4.563zM51.449 15.195V5.842c4.181-.205 7.988-.405 9.438-.483l.851-.05c.387-.399.885-2.395.689-3.021-.073-.25-.213-.666-.638-.555a33.279 33.279 0 0 1-4.277.727c-2.766.321-3.97.404-7.804.682-6.718.487-12.709.72-12.709.72a2.518 2.518 0 0 0 .788 1.834 2.567 2.567 0 0 0 1.883.706c2.278-.095 5.598-.25 8.996-.41v9.203h-12.78c0 .703.281 1.377.783 1.874a2.69 2.69 0 0 0 1.892.777h10.105v7.075c0 .887-.464 1.192-1.231 1.214h-3.92a4.15 4.15 0 0 0 .837 1.544 4.2 4.2 0 0 0 1.403 1.067 6.215 6.215 0 0 0 2.71.277c1.36-.066 2.967-.826 2.967-3.57v-7.607h11.28c.342 0 .67-.135.91-.374.242-.239.378-.563.378-.902v-1.375H51.449z"}),(0,m.tZ)("path",{d:"M42.614 8.873a2.304 2.304 0 0 0-1.508-.926 2.334 2.334 0 0 0-1.727.405l-.376.272 4.255 5.85 2.24-1.62-2.884-3.98zM57.35 8.68l-3.125 4.097 2.24 1.663 4.517-5.927-.375-.277a2.32 2.32 0 0 0-1.722-.452 2.327 2.327 0 0 0-1.536.896z"})]}))},au=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return{transitionProperty:"".concat(t.join(",")),transitionDuration:"0.25s",transitionTimingFunction:"ease-in-out"}},al={root:{position:"fixed",zIndex:100,width:"100%",top:0},placeholder:{width:"100%"},container:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:16,padding:"0 20px",margin:"0 auto"},header:{position:"relative",minWidth:"1175px",overflow:"hidden",backgroundClip:"content-box"},headerInner:{width:"100%",height:"100%",position:"relative",display:"flex",alignItems:"center",gap:16,transition:"transform 0.3s ease-out"},navigation:{display:"flex",flexShrink:0,alignItems:"center",height:"100%"},headerTitle:{fontSize:"18px",flex:"1"},middle:{flex:"1",justifyContent:"flex-end"},userActionLinks:{flexShrink:0,display:"flex",alignItems:"center",justifyContent:"flex-end",gap:6},profile:{position:"relative",flexShrink:0}},ad=function(){},ap=function(e){var t,n,r=e.currentUser,o=e.middle,i=void 0===o?(0,m.tZ)(aa,{}):o,a=e.profile,c=e.headerTitle,s=e.className,u=e.shouldShowOutlet,l=e.outlet,d=e.navigate,p=e.pathname,f=e.onNavClick,h=void 0===f?ad:f,_=e.height,g=void 0===_?62:_,T=e.maxWidth,E=e.navItems,y=e.isInBase,C=void 0===y||y,S=e.base,I=void 0===S?"https://www.zhihu.com":S,A=e.userActionLinks,w=void 0===A?i8:A,Z=e.theme,x=void 0===Z?i4:Z,k=(0,ef._)((0,iQ.h)(),2),R=k[0],N=k[1],O=(0,ef._)((0,iQ.h)(),2),P=O[0],D=O[1],L=(0,b.useMemo)(function(){return(0,G._)({},i4,x)},[x]),M=!!r,B=M&&(0,m.tZ)("div",{css:al.userActionLinks,children:null==w?void 0:w.map(function(e,t){return(0,m.tZ)(b.Fragment,{children:"function"==typeof e.render?e.render():(0,m.tZ)(ac,(0,G._)({},e))},t)})}),U=null==r?void 0:r.isOrg,F=(0,m.tZ)("nav",{css:al.navigation,children:(null!=E?E:U?i7:i6).map(function(e,t){return"separator"===e?(0,m.tZ)(an,{},t):(0,m.tZ)(ao,{href:e.needsLogin&&!M?"".concat(I,"/signin?next=").concat(encodeURIComponent(e.pathname)):"".concat(I).concat(e.pathname),isActive:C&&(e.getIsActive?e.getIsActive(p):p===e.pathname),target:e.target,badge:e.badge,onClick:function(t){h(e,t),!t.defaultPrevented&&d&&e.isRouterLink&&!(t.metaKey||t.shiftKey||t.altKey)&&(t.preventDefault(),d(e.pathname))},children:e.label},t)})}),H=(0,ij.F)(),z=(0,er._)((0,G._)({},al.header,(0,iY.d)(H),au("background-color","box-shadow")),{"--logo-width":"".concat(null!==(t=null==N?void 0:N.width)&&void 0!==t?t:64,"px"),"--profile-width":"".concat(null!==(n=null==D?void 0:D.width)&&void 0!==n?n:34,"px")}),q=(0,m.BX)(m.HY,{children:[c?(0,m.tZ)(i0.xv,{color:L.headerTitle,css:al.headerTitle,children:c}):(0,m.BX)(m.HY,{children:[F,i&&(0,m.tZ)(i0.kC,{css:al.middle,children:i})]}),B]}),V=(0,m.tZ)("div",{css:al.root,children:(0,m.tZ)(i0.xu,{as:"header",role:"banner",className:i$()("AppHeader",s),bg:L.bgColor,sx:z,children:(0,m.BX)("div",{css:(0,er._)((0,G._)({},al.container),{height:g,maxWidth:void 0===T?1338:T}),children:[(0,m.tZ)("a",{ref:R,href:"".concat(I),"aria-label":"知乎",children:(0,m.tZ)(as,{color:L.logo})}),(0,m.BX)("div",{css:al.headerInner,children:[(0,m.tZ)("div",{css:(0,G._)({},al.headerInner,u&&{transform:"translateY(-100%)"}),children:q}),(0,m.tZ)("div",{css:{pointerEvents:u?"auto":"none",position:"absolute",top:0,left:"calc(50% - (var(--logo-width) - var(--profile-width)) / 2)",transform:"translateX(-50%)",width:"100%",height:"100%",maxWidth:1032},children:l})]}),a&&(0,m.tZ)("div",{ref:P,css:al.profile,children:a})]})})});return(0,m.BX)(i9.Provider,{value:L,children:[V,(0,m.tZ)("div",{css:(0,er._)((0,G._)({},al.placeholder),{height:g})})]})},af=n(7459),ah=function(e){var t=(0,ij.F)();return(0,m.BX)(i0.rU,(0,er._)((0,G._)({href:"https://zhida.zhihu.com/",target:"_blank",px:"13px",color:"MapAI",display:"flex",justifyContent:"center",alignItems:"center",flexShrink:0,fontSize:"14px",fontWeight:"bold",css:(0,G._)({gap:"2px",whiteSpace:"nowrap",borderRadius:9999,transition:"background .15s ease-out",background:"linear-gradient(270deg, rgba(43, 64, 253, 0.16) 0%, rgba(150, 106, 255, 0.16) 100%)","&:hover":{filter:"brightness(0.85)"}},(0,i1.k)(t))},e),{children:[(0,m.tZ)(af.Z,{size:16}),"直答"]}))},a_=n(23719),am=n(26609),av=n(53910),ag=n(29892),aT=n(83921),aE=n(85456),ay=n.n(aE),aC=n(25452),aS=n(16028),aI=n(24752),aA=n(97727),ab=n(45842),aw=n(3028),aZ=n(21379),ax=n(25480),ak=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"renderGroupItems",value:function(e,t){var n=this,r=this.props,o=r.renderItem,i=r.isItemDisabled,a=this.state,c=a.id,s=a.selectedIndex,u=a.selectedGroupKey;return e.map(function(e,r){var a=e.data||r;return(0,m.tZ)(ax.Z,{id:"".concat(c,"-").concat(t,"-").concat(a),tag:"div",disabled:i(e),hovered:r===s&&t===u,onMouseEnter:function(){n.setState({selectedIndex:r,selectedGroupKey:t})},onClick:function(){return n.handleClose(!0,r,t)},onMouseDown:function(e){return e.preventDefault()},role:"option",children:o(e)},a)})}}]),n}(n(58718).Z),aR=function(){var e="undefined"!=typeof location&&location.hostname.includes("zhuanlan")?"".concat(P.Z.fetchRoot.zhuanlan,"/v4"):"".concat(P.Z.fetchRoot.www,"/api/v4");return(0,e$.dJ)("".concat(e,"/search/preset_words"),{method:"GET",headers:{"X-API-Version":"3.0.91","X-App-Za":"OS=Web"}}).catch(function(e){return(0,ep._)(e,Error)&&console.error("getRemotePresetWords",e.message),null})},aN="search:preset_words",aO="搜索你感兴趣的内容…",aP=function(){return O().get(aN)},aD=function(e){O().set(aN,e)},aL=function(e){var t=aP();if(t){var n=t.words;aD({nextRequestTime:t.nextRequestTime,words:n.map(function(t){return t.id===e?(0,er._)((0,G._)({},t),{valid:0}):t})})}},aM=function(e){return!e||!e.lastUpdateTime||e.lastUpdateTime+3e4<Date.now()},aB=function(e){var t=aP();if(t){var n=t.words,r=t.nextRequestTime,o=t.lastUpdateTime,i=t.lastId,a=aM(t);aD({nextRequestTime:r,lastUpdateTime:a?Date.now():o,lastId:a?e:i,words:n.map(function(t){return t.id===e?(0,er._)((0,G._)({},t),{times:t.times+1}):t})})}},aU=function(e){if(!e)return null;var t=e.presetWords||{},n=t.nextRequestTs,r=t.words,o=(aP()||{}).words,i=(void 0===o?[]:o).reduce(function(e,t){return e[t.id]=t,e},{}),a={nextRequestTime:n?1e3*n:Date.now()+6e5,words:Array.isArray(r)?r.map(function(e){var t,n=e.id,r=e.beginTs,o=e.endTs,a=(null===(t=i[n])||void 0===t?void 0:t.times)||0;return(0,er._)((0,G._)({},e),{times:a,beginTs:1e3*r,endTs:1e3*o})}):[]};return aD(a),a},aG=function(e){var t=e.reduce(function(e,t){return e+t.weight},0);return e.reduce(function(e,n){var r=n.id,o=n.weight,i=e&&e[e.length-1]&&e[e.length-1].range[1]||0;return(0,g._)(e).concat([{id:r,range:[i,i+o/t]}])},[])},aF=function(e){var t=Math.random();return e.find(function(n,r){var o=n.range,i=r===e.length-1?1:o[1];return o[0]<t&&i>t})||e[e.length-1]},aH=function(e){var t=Date.now(),n=e.filter(function(e){var n=e.valid,r=e.beginTs,o=e.endTs;return n&&r<t&&o>t});if(!n.length)return!1;var r=[],o=n.filter(function(e){return e.weight>=10}),i=(aF(aG((r=o.length>0?o:n).map(function(e){var t=e.weight,n=e.times;return{weight:t/((void 0===n?0:n)+1),id:e.id}})))||{}).id,a=void 0===i?"-1":i;return r.find(function(e){return e.id===a})},az=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("function"!=typeof e)throw TypeError("fetchData must be a function");var n=aP(),r=n||{},o=r.nextRequestTime,i=r.words;if(o&&(o<Date.now()||o>325036512e5)||!i)return e(n?n.words.map(function(e){return{valid:e.valid,id:e.id}}):null).then(aU).then(function(e){var t=aH(e.words.filter(function(e){return"general"===e.type}));return aB(t.id),t});var a=i.filter(function(e){return"general"===e.type});if(!t&&!aM(n)){var c=n.lastId;return Promise.resolve(a.find(function(e){return c===e.id}))}var s=aH(a);return aB(s.id),Promise.resolve(s)},aq=n(69383),aV=n(82644),aW=function(e,t){return e.map(function(e,n){return(0,G._)({data:(null==e?void 0:e.query)||e,index:n,id:null==e?void 0:e.rawId,wordType:null==e?void 0:e.wordType,iconUrl:null==e?void 0:e.iconUrl,targetUrl:null==e?void 0:e.targetUrl,label:null==e?void 0:e.label},t)})},aX=function(e,t){return"string"==typeof t&&e.startsWith(t)?(0,m.BX)("span",{children:[(0,m.tZ)("em",{children:t}),e.slice(t.length)]}):e},aK=function(e){return e?{history:{SearchSource:"SuggestionHistory",zaModuleName:"SearchHistoryItem"},suggest:{SearchSource:"Suggestion",zaModuleName:"SearchSuggestionItem"},searchLink:{SearchSource:"",zaModuleName:"SearchSuggestionList"}}:{topSearch:{SearchSource:"Hot",zaModuleName:"HotSearchWordItem"},history:{SearchSource:"History",zaModuleName:"SearchHistoryItem"}}},aj=function(e,t,n,r){aq.Z.trackCardShow(e,{},{search:(0,G._)({search_source:aK(r)[n].SearchSource,raw_query:t},r&&{input_query:r})})},aY=function(e){var t=e.type,n=e.index,r=e.rawSearchResult,o=e.data,i=null;(i="searchLink"!==t?(document.querySelectorAll(".SearchBar-menu div[data-za-detail-view-path-module =\n    ".concat(aK(r)[t].zaModuleName,"]"))||[])[n]:document.querySelector(".SearchBar-menu div[data-za-detail-view-element_name=ViewSeachResult]"))&&aq.Z.trackEvent(i,(0,G._)({action:"Click"},"searchLink"===t?{element_name:"ViewSeachResult"}:{}),{search:(0,G._)({search_source:aK(r)[t].SearchSource,raw_query:o},r&&{input_query:r})})},aQ=function(e,t){return t?"SearchSuggestionList":"history"===e?"SearchHistoryList":"topSearch"===e?"HotSearchWordList":""},aJ=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"handleDelete",function(t,n){var r=e.props.rawSearchResult;aq.Z.trackEvent(t.target,{action:"Delete"},{search:(0,G._)({raw_query:n},r&&{input_query:r,search_source:"SuggestionHistory"},!r&&{search_source:"History"})}),e.props.onDelete(t,n)}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.index,n=e.data,r=e.rawSearchResult;aq.Z.setModule(this.container,{module:"SearchHistoryItem",index:t}),aj(this.container,n,"history",r)}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,r=t.rawSearchResult;return(0,m.BX)("div",{ref:function(t){e.container=t},className:"SearchBar-historyItem",children:[(0,m.tZ)("span",{className:i$()("SearchBar-historyItemContent",{blueFont:r}),children:aX(n,r)}),(0,m.BX)("div",{className:"SearchBar-historyIconWrapper SearchBar-historyDelete",children:[(0,m.tZ)("span",{className:"preventCloseOnTarget SearchBar-historyIconShade",onClick:function(t){return e.handleDelete(t,n)},role:"button",tabIndex:0,"aria-label":"删除",onMouseDown:function(e){return e.preventDefault()}}),(0,m.tZ)(aV.HN,{width:18,height:18,fill:"#d3d3d3"})]})]})}}]),n}(b.Component),a$=n(46826),a0=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"componentDidMount",value:function(){aq.Z.trackCardShow(this.container,{name:"清空"})}},{key:"render",value:function(){var e=this,t=this.props,n=t.label,r=t.onDelete;return(0,m.BX)("div",{role:"button",tabIndex:0,className:"SearchBar-label SearchBar-label--history","data-za-detail-view-path-module":aQ("history",""),onMouseDown:function(e){return e.preventDefault()},children:[n,(0,m.BX)("div",{ref:function(t){e.container=t},className:"SearchBar-historyIconWrapper",children:[(0,m.tZ)("span",{role:"button",tabIndex:0,className:"SearchBar-historyIconShade preventCloseOnTarget",onClick:function(e){aq.Z.trackEvent(e.target,{action:"Click",name:"清空"}),r(e,null)}}),(0,m.tZ)(a$.Z,{size:16,center:!0,style:{marginRight:"4px"}}),"清空"]})]})}}]),n}(b.Component),a1=function(e){var t=e.handleReportShow;return(0,m.tZ)(m.HY,{children:(0,m.tZ)("div",{role:"button",tabIndex:0,className:"ReportsItem",onClick:function(e){e.stopPropagation(),t()},children:"举报"})})},a2="search::top-search",a3=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=e.rawSearchResult;aj(this.container,t,"history",n)}},{key:"render",value:function(){var e=this,t=this.props.rawSearchResult;return(0,m.BX)("div",{ref:function(t){e.container=t},className:"SearchBar-searchLink","data-za-detail-view-element_name":"ViewSeachResult",children:["查看「",t.length>12?"".concat(t.slice(0,12),"..."):t,"」的搜索结果"]})}}]),n}(b.Component),a4=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=e.rawSearchResult,r=e.index;aq.Z.setModule(this.container,{module:"SearchSuggestionItem",index:r}),aj(this.container,t,"suggest",n)}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,r=t.rawSearchResult,o=t.iconUrl;return(0,m.BX)("div",{ref:function(t){e.container=t},className:"SearchBar-defaultResult",children:[aX(n,r),o&&(0,m.tZ)(i0.Ee,{src:o,ml:"14px",width:"52px",style:{display:"inline-block",verticalAlign:"middle"}})]})}}]),n}(b.Component),a5=n(57032),a6=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.index,n=e.query;aq.Z.setModule(this.container,{module:"HotSearchWordItem",index:t}),aj(this.container,n,"topSearch","")}},{key:"render",value:function(){var e=this,t=this.props,n=t.index,r=t.query,o=t.label,i=t.attachedInfo,a=t.zaInfo;return(0,m.BX)(e7.ZAClick,{as:"div",className:"SearchBar-topSearchItem",ref:function(t){e.container=t},zaAction:"OpenUrl",zaType:"Text",zaText:r,zaModuleIndex:n,zaModuleId:(null==a?void 0:a.moduleId)||"search_guess_your_want_word",shouldTrackShow:!0,view:{elementLocation:{page:{pageId:"10148"},content:null==a?void 0:a.content}},extra:{attachedInfoBytes:i},children:[r,"hot"===o&&(0,m.tZ)(a5.ZP,{css:{marginLeft:5,fill:"#FA2925"},size:18})]},n)}}]),n}(b.Component),a7=n(58183),a8=n(66980),a9=Object.assign,ce=function(e){return w().createElement(a8.Z,a9({width:"38",height:"38",fill:"none",viewBox:"0 0 38 38"},e),w().createElement("path",{fill:"url(#id-2361276011-a)",d:"M31.96 5.895a.291.291 0 0 1 .547 0l.49 1.324a.971.971 0 0 0 .573.573l1.324.49a.291.291 0 0 1 0 .546l-1.324.49a.971.971 0 0 0-.573.574l-.49 1.323a.291.291 0 0 1-.546 0l-.49-1.323a.97.97 0 0 0-.574-.574l-1.323-.49a.291.291 0 0 1 0-.546l1.323-.49a.97.97 0 0 0 .574-.573l.49-1.324Z"}),w().createElement("path",{fill:"#7C63FF",fillRule:"evenodd",d:"M23.37 22.258c.021-.05.041-.1.06-.152l1.88-5.296a1.888 1.888 0 0 0-1.78-2.52h-3.623a2.36 2.36 0 0 0-2.036 1.166c-.004.009.004-.008 0 0l.012-.026c.466-1.053 1.452-3.284 3.117-4.831 1.957-1.82 5.09-1.522 7.167.16 2.977 2.41 4.414 6.549 2.999 10.563-1.704 4.831-6.506 8.062-11.628 8.062h-.17c2.143-1.69 3.345-4.995 4.002-7.126Z",clipRule:"evenodd"}),w().createElement("mask",{id:"id-2361276011-c",width:"15",height:"21",x:"17",y:"9",maskUnits:"userSpaceOnUse",style:{maskType:"alpha"}},w().createElement("path",{fill:"#000",fillRule:"evenodd",d:"m23.369 22.252.06-.15 1.88-5.297a1.888 1.888 0 0 0-1.78-2.52h-3.623a2.36 2.36 0 0 0-2.036 1.166c-.004.008.004-.009 0 0l.012-.026c.466-1.054 1.452-3.284 3.117-4.832 1.957-1.819 5.09-1.521 7.167.16 2.977 2.41 4.414 6.55 2.999 10.564-1.704 4.83-6.505 8.062-11.628 8.062h-.17c2.143-1.69 3.345-4.995 4.002-7.127Z",clipRule:"evenodd"}),w().createElement("path",{fill:"url(#id-2361276011-b)",fillRule:"evenodd",d:"m23.369 22.252.06-.15 1.88-5.297a1.888 1.888 0 0 0-1.78-2.52h-3.623a2.36 2.36 0 0 0-2.036 1.166c-.004.008.004-.009 0 0l.012-.026c.466-1.054 1.452-3.284 3.117-4.832 1.957-1.819 5.09-1.521 7.167.16 2.977 2.41 4.414 6.55 2.999 10.564-1.704 4.83-6.505 8.062-11.628 8.062h-.17c2.143-1.69 3.345-4.995 4.002-7.127Z",clipRule:"evenodd"})),w().createElement("g",{filter:"url(#id-2361276011-d)",mask:"url(#id-2361276011-c)"},w().createElement("path",{fill:"#594CF8",d:"M32.189 11.927c-.517-1.25-4.157-6.615-10.352-4.373-6.196 2.242-3.785 10.218-3.785 10.218s1.592-3.883 5.496-5.497c3.904-1.615 9.158.902 8.64-.348Z"})),w().createElement("path",{fill:"#191B1F",fillRule:"evenodd",d:"m6.142 15.815.693-1.973c.061-.162.12-.337.183-.52l.28-.8c.673-1.768 1.973-3.866 6.632-3.866h8.497c-2.877 1.402-3.757 4.16-4.46 6.357-.074.234-.147.46-.22.68a2.385 2.385 0 0 0-.064.163l-2.173 6.12a1.271 1.271 0 0 0 1.198 1.696.15.15 0 0 1 .142.2l-.296.85a.147.147 0 0 0 .22.17l.922-.619a3.54 3.54 0 0 1 1.974-.6h1.535c.893 0 1.7-.503 2.1-1.282a21.49 21.49 0 0 0-.198.463c-.8 1.916-2.705 6.473-7.288 6.473-.516 0-.924.02-1.237.052H7.19l2.727-7.733 1.363-3.866.527-1.493.708-2.006h-.275c-3.207-.007-4.985-.01-6.06 1.529l-.037.005Z",clipRule:"evenodd"}),w().createElement("path",{fill:"url(#id-2361276011-e)",fillRule:"evenodd",d:"m6.142 15.815.693-1.973c.061-.162.12-.337.183-.52l.28-.8c.673-1.768 1.973-3.866 6.632-3.866h8.497c-2.877 1.402-3.757 4.16-4.46 6.357-.074.234-.147.46-.22.68a2.385 2.385 0 0 0-.064.163l-2.173 6.12a1.271 1.271 0 0 0 1.198 1.696.15.15 0 0 1 .142.2l-.296.85a.147.147 0 0 0 .22.17l.922-.619a3.54 3.54 0 0 1 1.974-.6h1.535c.893 0 1.7-.503 2.1-1.282a21.49 21.49 0 0 0-.198.463c-.8 1.916-2.705 6.473-7.288 6.473-.516 0-.924.02-1.237.052H7.19l2.727-7.733 1.363-3.866.527-1.493.708-2.006h-.275c-3.207-.007-4.985-.01-6.06 1.529l-.037.005Z",clipRule:"evenodd"}),w().createElement("defs",null,w().createElement("linearGradient",{id:"id-2361276011-a",x1:"28.636",x2:"36.505",y1:"12.232",y2:"9.14",gradientUnits:"userSpaceOnUse"},w().createElement("stop",{offset:".235",stopColor:"#9868FF"}),w().createElement("stop",{offset:"1",stopColor:"#594CF8"})),w().createElement("linearGradient",{id:"id-2361276011-b",x1:"31.749",x2:"38.02",y1:"30.861",y2:"16.462",gradientUnits:"userSpaceOnUse"},w().createElement("stop",{stopColor:"#594CF8"}),w().createElement("stop",{offset:"1",stopColor:"#9868FF"})),w().createElement("radialGradient",{id:"id-2361276011-e",cx:"0",cy:"0",r:"1",gradientTransform:"rotate(71.939 -3.884 22.188) scale(22.8396 24.3453)",gradientUnits:"userSpaceOnUse"},w().createElement("stop",{offset:".419",stopColor:"#7C63FF"}),w().createElement("stop",{offset:"1",stopColor:"#5C4FFF"})),w().createElement("filter",{id:"id-2361276011-d",width:"26.436",height:"22.561",x:"11.689",y:"1.112",colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},w().createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),w().createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),w().createElement("feGaussianBlur",{result:"effect1_foregroundBlur_1474_2797",stdDeviation:"2.95"}))))},ct=Object.assign,cn=function(e){return w().createElement(a8.Z,ct({width:"73",height:"20",fill:"none",viewBox:"0 0 73 20"},e),w().createElement("path",{fill:"#191B1F",d:"M17.728 1.503v-.13h-7.352L9.42 19.311h6.24a1.18 1.18 0 0 0 1.18-1.118l.887-16.69Zm-5.513 15.65.752-13.607h1.992l-.722 13.384a.236.236 0 0 1-.236.223h-1.786ZM8.134 15.112a49.445 49.445 0 0 1-.574-4.398V10.6H6.307l.083-.411h2.72l.117-2.143H6.759c.085-.694.15-1.428.192-2.187l.08-1.484h2.256L9.39 2.2H4.942c.095-.383.21-.922.335-1.606l.028-.148H2.611l-.015.113a9.044 9.044 0 0 1-1.358 3.839l-.018.03-.23 4.092.21-.14.168-.116-.103 1.908h2.461a30.07 30.07 0 0 1-1.2 4.225L.704 19.53h2.717l1.754-5.044.05-.146a37.691 37.691 0 0 0 1.047 5.098l.028.092h3.01l-.06-.168a24.766 24.766 0 0 1-1.116-4.25ZM2.992 6.69a10.64 10.64 0 0 0 1.266-2.316h.102s-.035.7-.08 1.471a34.9 34.9 0 0 1-.195 2.2H1.669A7.37 7.37 0 0 0 2.992 6.69ZM53.029 3.894l.118-2.155H47.07l.077-1.283h-2.683l-.078 1.283h-6.112l-.1 2.155h6.112l-.058 1.07h-5.072l-.647 12.28h-1.676l-.128 2.157h16.146l.123-2.255H51.58l.631-12.199h-5.305l.06-1.07 6.062.017Zm-11.347 3.96.032-.752h7.442c.134 0 .242.113.235.247l-.023.505h-7.686Zm7.242 8.412-.05.978h-7.663l.052-.975 7.661-.003Zm.158-3.127-.05.977h-7.688l.05-.977h7.688Zm.16-3.127-.05.974h-7.688l.05-.975h7.688Z"}),w().createElement("path",{stroke:"#EF3131",strokeLinecap:"square",strokeWidth:".056",d:"M27.938 2.11 27.16 16.28l-.098 1.772-.082 1.507"}),w().createElement("path",{fill:"#191B1F",d:"M32.364 4.31a34.207 34.207 0 0 1-1.88 3.852l-.107.188h2.802l.035-.07a49.704 49.704 0 0 0 1.754-3.877l.067-.17h-2.638l-.033.077ZM24.02 4.32l-.026-.087h-2.668l.047.16a37.368 37.368 0 0 0 1.373 3.88l.033.077h2.757l-.08-.178A32.43 32.43 0 0 1 24.02 4.32ZM35.278.703c-2.153.256-4.32.382-6.488.378h-7.768l-.13 2.153h6.164l2.464-.013a57.122 57.122 0 0 0 5.666-.35l.135-.043.11-2.143-.153.018ZM20.049 9.833l-.11 2.155h15.446l.113-2.155h-15.45Z"}),w().createElement("path",{fill:"#191B1F",fillRule:"evenodd",d:"m29.673 1.379-.917 17.037a1.18 1.18 0 0 1-1.179 1.116H23.71V16.81h2.182a.236.236 0 0 0 .236-.223l.827-15.354 2.72.147Z",clipRule:"evenodd"}),w().createElement("path",{fill:"#191B1F",d:"M70.084 12.858H56.63l-.353 6.699H68.76a1.18 1.18 0 0 0 1.179-1.12l.282-5.576-.136-.003Zm-11.026 4.544.13-2.389h8.217l-.12 2.166a.236.236 0 0 1-.236.223h-7.991ZM72.088 1.746h-.133s-1.188.012-2.233 0h-1.9c.104-.38.188-.764.251-1.153l.025-.148H65.39l-.015.106a5.406 5.406 0 0 1-1.253 2.698l.088-1.503h-.133s-1.185.012-2.23 0h-1.644c.103-.38.187-.764.25-1.153l.028-.148h-2.726l-.018.106a8.999 8.999 0 0 1-.599 2.004 3.76 3.76 0 0 1-1.115 1.534l-.043.035-.163 3.057.18-.07c1.377-.531 2.507-1.614 3.369-3.215h.514c.386 1.524.584 2.238.824 2.611l.038.06 2.573-.02-.057-.165c-.18-.521-.532-1.737-.737-2.486h1.097L63.49 6.57l.155-.028A4.912 4.912 0 0 0 66.903 3.9h.81c.16.57.333 1.12.5 1.633.13.403.298.792.502 1.163l.035.065h2.636l-.073-.17a28.08 28.08 0 0 1-.93-2.694h1.59l.115-2.15ZM58.354 9.633l-.113 2.155h10.27l.112-2.155H58.354Z"}),w().createElement("path",{fill:"#191B1F",d:"m64.258 5.874-.694-.398-.609.521c-.452.371-.93.711-1.428 1.018a18.389 18.389 0 0 1-5.851 2.41l-.123 2.33.4-.082a20.548 20.548 0 0 0 7.827-3.476c1.39.782 4.701 2.589 7.518 3.76l.303.125.125-2.391a84.036 84.036 0 0 1-7.468-3.817Z"}))},cr=function(e){var t=e.data,n=e.onUpdate,r=(0,e6.useDispatch)();return(0,b.useEffect)(function(){var e;r((e=t.map(function(e){return{type:e.wordType,content:e.data}}),{API:{endpoint:"ai_ingress/community/report_exposure",types:rO.REPORT_READ_ZHIDA_CARD,method:"POST",body:{exposure_list:e.map(function(e){return{report_type:e.type,report_content:e.content}}),zhida_source:"ai_search_query"}},NOTIFICATION:!1})).catch(function(){})},[t,r]),(0,m.BX)(e7.ZAShow,{as:i0.kC,zaType:"Block",zaModuleId:"search_drop_down_box_zhida_module",className:"SearchBar-label",justifyContent:"space-between",alignItems:"center",pt:"10px",mx:"16px",onMouseDown:function(e){return e.preventDefault()},children:[(0,m.tZ)(ce,{size:24}),(0,m.tZ)(cn,{style:{width:48.7,height:13,marginLeft:3}}),(0,m.BX)(e7.ZAClick,{as:i0.kC,zaType:"Button",zaModuleId:"search_drop_down_box_zhida_module_refresh_button",className:"preventCloseOnTarget",alignItems:"center",style:{marginLeft:"auto",fontSize:14,cursor:"pointer"},onClick:n,children:[(0,m.tZ)(a7.Z,{size:"16",style:{marginRight:4}}),"换一换"]})]})},co=function(e){return e?"search::history_".concat(e):"search::history_guest"},ci=function(e,t,n){var r=O().get(e)||[];return t?r.filter(function(e){var n=e.q;return"string"==typeof n&&n.toLowerCase().startsWith(t.toLowerCase())}).slice(0,2).map(function(e){return e.q}):r.slice(0,n?10:5).map(function(e){return e.q})},ca=function(e,t,n){var r=O().get(e)||[],o=r.findIndex(function(e){return e.q===t}),i=[];return t&&(i=o>-1?(0,g._)(r.slice(0,o)).concat((0,g._)(r.slice(o+1))):r),O().set(e,i),i.slice(0,n?10:5).map(function(e){return e.q})},cc=function(e){return function(t){return e(t).then(function(e){return e.payload.suggest.map(function(e){return{query:e.query,rawId:e.rawId,iconUrl:e.iconUrl,targetUrl:e.targetUrl,label:e.label}})})}},cs=function(){var e=O().get(a2)||{},t=e.words,n=e.timeStamp;return t&&"string"==typeof t[0]?(O().delete(a2),null):t&&n&&new Date().getTime()-Number(n)<6e5?t:null},cu=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"state",{rawSearchResult:"",searchResults:{},presetWordsData:{query:""},completeTopSearchData:[],reportModalShown:!1,askDropdownVisible:!1}),(0,ed._)((0,iD._)(e),"domRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"askButtonRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"plusPanelRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"presetWordsTimer",null),(0,ed._)((0,iD._)(e),"componentWillUnmount",function(){document.removeEventListener("visibilitychange",e.visibleCallback),e.stopPresetWordsRotation()}),(0,ed._)((0,iD._)(e),"getLabels",function(){return{history:"搜索历史",topSearch:e.props.supportTopSearchZhida?"知乎直答":"搜索发现"}}),(0,ed._)((0,iD._)(e),"visibleCallback",function(){!1===document.hidden?(e.handleUpdatePresetWords(),e.state.rawSearchResult||e.startPresetWordsRotation()):e.stopPresetWordsRotation()}),(0,ed._)((0,iD._)(e),"handleReportHide",function(){e.setState({reportModalShown:!1})}),(0,ed._)((0,iD._)(e),"handleReportShow",function(){e.setState({reportModalShown:!0})}),(0,ed._)((0,iD._)(e),"handleUpdatePresetWords",function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];az(aR,t).then(function(t){if(!t)return e.setState({presetWordsData:{query:aO}});e.setState({presetWordsData:t})})}),(0,ed._)((0,iD._)(e),"startPresetWordsRotation",function(t){e.stopPresetWordsRotation(),e.presetWordsTimer=setInterval(function(){(!e.state.rawSearchResult||t)&&e.handleUpdatePresetWords(!0)},8e3)}),(0,ed._)((0,iD._)(e),"stopPresetWordsRotation",function(){e.presetWordsTimer&&(clearInterval(e.presetWordsTimer),e.presetWordsTimer=null)}),(0,ed._)((0,iD._)(e),"getCurrentHistoryKey",function(){return co((e.props.currentUser||{}).id)}),(0,ed._)((0,iD._)(e),"getHistoryData",function(t){return ci(e.getCurrentHistoryKey(),t)}),(0,ed._)((0,iD._)(e),"handleChange",ay()(function(t){return void 0===t?null:t?(e.stopPresetWordsRotation(),e.handleInputHasValue(t)):(e.startPresetWordsRotation(),e.handleInputIsEmpty({rawSearchResult:t}))},300)),(0,ed._)((0,iD._)(e),"handleInputHasValue",function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=cc(e.props.getSuggestActionCreator),o=e.getHistoryData(t);r(t).then(function(r){e.updateAutoComplete({suggestData:rA()((0,g._)(aW(o,{type:"history",rawSearchResult:t})).concat((0,g._)(aW(r,{type:"suggest",rawSearchResult:t}))),function(e,t){var n=e.data,r=t.data;return n.toLowerCase()===r.toLowerCase()})},(0,G._)({rawSearchResult:t},n))})}),(0,ed._)((0,iD._)(e),"fetchZhidaTime",Date.now()),(0,ed._)((0,iD._)(e),"handleInputIsEmptyFormZhidaAb",function(t,n){if(!(Date.now()-e.fetchZhidaTime<1e3)){var r;return e.fetchZhidaTime=Date.now(),(r=e.props.loadTopSearchZhida,function(){return r().then(function(e){var t=((null==e?void 0:e.payload)||{}).queryList,n=void 0===t?[]:t;return n.length>2?n.map(function(e){return{query:e.introWord,rawId:e.wordId,wordType:e.wordType}}):[]})})().then(function(r){e.setState({completeZhidaTopSearchData:r}),e.updateAutoComplete({topSearchData:r.slice(0,5),historyData:n},t)})}}),(0,ed._)((0,iD._)(e),"handleInputIsEmpty",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.props,r=n.loadTopSearchActionCreatorV2,o=n.supportTopSearchZhida,i=e.getHistoryData();if(o)return e.handleInputIsEmptyFormZhidaAb(t,i);var a=cs(),c=function(n){e.setState({completeTopSearchData:n}),e.updateAutoComplete({topSearchData:n.map(function(e){return e.queryDisplay}),historyData:i},t)};return a?c(a):r().then(function(e){var t,n=((null==e?void 0:null===(t=e.payload)||void 0===t?void 0:t.recommendQueries)||{}).queries,r=(void 0===n?[]:n).map(function(e){return{queryDisplay:e.queryDisplay,query:e.query,label:e.label,attachedInfo:e.attachedInfo}}).slice(0,5);return O().set(a2,{words:r,timeStamp:new Date().getTime()}),r}).then(c)}),(0,ed._)((0,iD._)(e),"handleDeleteData",function(t,n){t.stopPropagation();var r=e.state,o=r.rawSearchResult,i=r.searchResults.suggest,a=ca(e.getCurrentHistoryKey(),n);if(o){var c=(void 0===i?[]:i).filter(function(e){var t=e.type,r=e.data;return!("history"===t&&r===n)});e.updateAutoComplete({suggestData:c})}else e.updateAutoComplete({historyData:a})}),(0,ed._)((0,iD._)(e),"handleUpdateZhidaData",function(t){t.stopPropagation();var n,r=e.state,o=r.completeZhidaTopSearchData,i=r.searchResults.topSearch,a=void 0===i?[]:i,c=null===(n=a[a.length-1])||void 0===n?void 0:n.id,s=(o.findIndex(function(e){return e.rawId===c})+1)%o.length,u=Math.min(s+5,o.length);e.updateAutoComplete({topSearchData:o.slice(s,u)})}),(0,ed._)((0,iD._)(e),"updateAutoComplete",function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.state,o=r.searchResults,i=r.rawSearchResult,a=(n||{}).rawSearchResult,c=void 0===a?i:a,s=t.topSearchData,u=t.historyData,l=t.suggestData,d=void 0===l?[]:l;if(!c){var p=o.topSearch,f=o.history,h=e.props.supportTopSearchStyleV2,_=s?{topSearch:aW(s,{type:"topSearch",rawSearchResult:c})}:{topSearch:void 0===p?[]:p},m=u?{history:aW(u,{type:"history",rawSearchResult:c})}:{history:void 0===f?[]:f};return e.setState((0,G._)({searchResults:h?(0,G._)({},m,_):(0,G._)({},_,m)},n))}var g=aW([c],{type:"searchLink",rawSearchResult:c});return e.setState((0,G._)({searchResults:(0,G._)({suggest:d,searchLink:g},d.length>0&&{reports:[{type:"reports"}]})},n))}),(0,ed._)((0,iD._)(e),"handleSelect",function(t,n){var r=e.props.supportTopSearchZhida,o=n.data,i=n.type,a=e.state.completeTopSearchData;aY(n),e.autoComplete.inputNode.blur();var c=o;"topSearch"===i&&(c=(a.find(function(e){return e.displayQuery===o})||{}).query||o);var s=(0,G._)({q:c},"topSearch"===i&&{utm_content:"search_hot",search_source:"Guess"},"history"===i&&{utm_content:"search_history",search_source:"History"},"suggest"===i&&{utm_content:"search_suggestion",search_source:"Suggestion"});if(n.targetUrl){window.open(n.targetUrl);return}if(r&&"topSearch"===i){window.open("//zhida.zhihu.com/search?".concat((0,ey.stringify)({q:c,zhida_source:"ai_search_query",is_preview:"1"})));return}window.open("//www.zhihu.com/search?".concat((0,ey.stringify)(s)))}),(0,ed._)((0,iD._)(e),"handleFocus",function(){(0,e.props.setEnvVars)({isPageHeaderDisabled:!0});var t=e.state.rawSearchResult,n={isFocus:!0};return t?e.handleInputHasValue(t,n):e.handleInputIsEmpty(n)}),(0,ed._)((0,iD._)(e),"focusInput",function(t){if(t.preventDefault(),e.autoCompleteInput.closest(".AppHeader.is-hidden")){setTimeout(function(){return e.autoCompleteInput.focus()},300);return}e.autoCompleteInput.focus()}),(0,ed._)((0,iD._)(e),"handleSubmit",function(){var t=e.props.location.query.type;if(e.autoComplete&&e.autoComplete.inputNode){var n=e.autoComplete.inputNode.value,r=void 0===t?"content":t,o=n;if(!n){var i=e.state.presetWordsData||{},a=i.realQuery,c=i.type,s=i.id;if(!a||!c)return;r="general"===c?"content":c,o=a,aL(s)}rN();var u=(0,G._)({type:r,q:o},!n&&{utm_content:"search_preset",search_source:"Preset"}),l=e.props.router;if((0,aZ.y)())return location.href="//".concat(P.Z.wwwHost,"/search?").concat((0,ey.stringify)(u));l.push("/search?".concat((0,ey.stringify)(u)))}}),(0,ed._)((0,iD._)(e),"renderItem",function(t){var n,r,o=e.props.supportTopSearchZhida,i=t.type,a=t.data,c=t.index,s=t.rawSearchResult,u=t.wordType,l=t.id,d=t.iconUrl,p=t.label,f=e.state,h=f.completeTopSearchData,_=(f.searchResults||{}).suggest,g=null;switch(i){case"topSearch":g=(0,m.tZ)(a6,(0,G._)({index:c,label:(null===(n=h[c])||void 0===n?void 0:n.label)||"",query:a,attachedInfo:(null===(r=h[c])||void 0===r?void 0:r.attachedInfo)||""},o&&{zaInfo:{moduleId:"search_drop_down_box_zhida_module_guide_word",content:{type:"search_suggested_word"===u?"SearchExpansionWord":"AIInterestExpansionWord",id:l}}}));break;case"history":var T=t.data;g=(0,m.tZ)(aJ,{data:T,index:c,onDelete:e.handleDeleteData,rawSearchResult:s});break;case"searchLink":g=(0,m.tZ)(a3,{index:c,data:a,rawSearchResult:s});break;case"suggest":g=(0,m.tZ)(a4,{data:a,index:c,rawSearchResult:s,iconUrl:"ai"===p?d:""});break;case"reports":g=(void 0===_?[]:_).length>1?(0,m.tZ)(a1,{handleReportShow:e.handleReportShow}):null}return g&&(0,m.tZ)("div",{"data-za-module":"TopNavBar",children:(0,m.tZ)("div",{"data-za-module":aQ(i,s),children:g})})}),(0,ed._)((0,iD._)(e),"renderAutoCompleteLabel",function(t){return"搜索历史"===t?(0,m.tZ)(a0,{onDelete:e.handleDeleteData,label:t}):"知乎直答"===t?(0,m.tZ)(cr,{data:e.state.searchResults.topSearch,onUpdate:e.handleUpdateZhidaData}):(0,m.tZ)("div",{onMouseDown:function(e){return e.preventDefault()},role:"button",tabIndex:0,className:"SearchBar-label",children:t})}),(0,ed._)((0,iD._)(e),"renderAskMenu",function(t,n,r){return r?(0,m.tZ)(aS.Z,{preventCloseOnTarget:!0,forwardedRef:e.plusPanelRef,inAppHeader:n,toggleEvent:"hover",hitSlopInset:"-18px 0 0 0",stickHover:!1,toggler:(0,m.tZ)(aC.ZP,{"aria-label":"创作",className:"SearchBar-askDropdownButton",preset:"primary",color:"blue",css:function(e){return(0,er._)((0,G._)({},t(e)),{borderRadius:9999,width:38,height:38,padding:0,display:"flex",alignItems:"center",justifyContent:"center"})},children:(0,m.tZ)(av.ZP,{size:16})})}):(0,m.tZ)(aS.Z,{forwardedRef:e.plusPanelRef,inAppHeader:n,toggler:(0,m.tZ)(aC.ZP,{className:"SearchBar-askDropdownButton",preset:"primary",color:"blue",css:function(e){return(0,er._)((0,G._)({},t(e)),{borderLeft:"none !important",borderRadius:"0 999px 999px 0 !important",padding:"0 9px 0 4px",width:29,height:34,display:"flex",alignItems:"center",justifyContent:"center"})},children:(0,m.tZ)(aT.ZP,{size:16})})})}),(0,ed._)((0,iD._)(e),"ask",function(t){var n,r;null===(n=e.plusPanelRef.current)||void 0===n||null===(r=n.ask)||void 0===r||r.call(n,t)}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){var e;if(null===(e=this.autoComplete)||void 0===e?void 0:e.inputNode){var t,n,r=null===(t=this.autoComplete)||void 0===t?void 0:null===(n=t.inputNode)||void 0===n?void 0:n.value;r?this.setState({rawSearchResult:r}):(this.handleUpdatePresetWords(),this.startPresetWordsRotation()),document.addEventListener("visibilitychange",this.visibleCallback)}}},{key:"componentDidUpdate",value:function(e){var t=e.location,n=this.props.location;if(t.pathname!==n.pathname||t.search!==n.search){var r=(n.query||{}).q,o=this.state.rawSearchResult;r?o!==r&&(this.stopPresetWordsRotation(),this.setState({rawSearchResult:r}),this.handleInputHasValue(r)):this.presetWordsTimer||(this.handleUpdatePresetWords(),this.startPresetWordsRotation(!0))}}},{key:"render",value:function(){var e=this,t=this.state,n=t.searchResults,r=t.rawSearchResult,o=t.isFocus,i=t.presetWordsData,a=t.reportModalShown,c=this.props.location.query.q,s=this.props,u=s.className,l=s.theme,d=s.currentUser,p=s.setEnvVars,f=s.inAppHeader,h=s.inputPadding,_=s.isNewNavigation,g=s.pathname,T=l.searchInputColor,E=l.searchButtonColor,y=l.searchButtonBg,C=l.searchButtonOpacity,S=l.searchAreaColor,I=l.searchBorder,A=l.searchBorderColor,b=l.searchPlaceHolderOpacity,w=l.searchInputOpacity,Z=l.searchIconOpacity,x=function(e){return(0,G._)({backgroundColor:"".concat(e.colors[y]," !important"),color:"".concat(e.colors[E]," !important"),opacity:C,border:"".concat(I," !important"),"&:hover":{opacity:1}},(0,iq.W5)("background-color","color"))},k=o&&_||r,R=(0,m.tZ)(e4.ms,{children:function(t){var a,s,u=t.css;return(0,m.tZ)(ak,{autoSelect:!1,ref:function(t){return e.autoComplete=t},onRef:function(t){return e.autoCompleteInput=t},labels:e.getLabels(),groups:n,renderLabel:e.renderAutoCompleteLabel,value:c||"",renderItem:e.renderItem,inputProps:{type:"text",maxLength:100,grey:!_,placeholder:i&&i.query,className:i$()("SearchBar-input",{"SearchBar-input--focus":o}),css:function(e){return(0,G._)((0,er._)((0,G._)((0,er._)((0,G._)({},h&&{"--inputPadding":h}),{input:(0,G._)({},T&&{color:e.colors[T]})}),S&&{backgroundColor:"".concat(e.colorMod(e.colors[S]).alpha(w)," !important")}),{borderColor:"".concat((0,iq.pe)(e)(A)," !important"),"input::placeholder":(0,G._)({},S&&{color:"".concat(e.colorMod(e.colors[S]).alpha(b)," !important")})}),(0,iq.W5)("background-color","border","color"))},after:(0,m.tZ)(aC.ZP,{className:"SearchBar-searchButton",preset:"primary",color:k?"blue":null,onClick:e.handleSubmit,"aria-label":"搜索",children:_?(0,m.tZ)(ag.Z,{size:20,center:!0,className:i$()("SearchBar-searchIcon",{isFocus:o,hasValue:k}),css:(0,G._)({color:"var(--MapBrand)",opacity:1,"&:hover":{opacity:1}},(0,iq.W5)("color"))}):(0,m.tZ)(ai.ZP,{size:18,center:!0,className:i$()("SearchBar-searchIcon",{isFocus:o,hasValue:r}),css:function(e){return(0,G._)({color:e.colors[S],opacity:Z,"&:hover":{opacity:1}},(0,iq.W5)("color"))}})})},menuProps:{menuClassName:i$()("SearchBar-menu",{"SearchBar-hasValueMenu":r,"SearchBar-noValueMenu":!r}),menuContainerClassName:i$()("SearchBar-menuContainer",u((0,G._)({},h&&{"--inputPadding":h}))),"data-za-module":"TopNavBar",positionStatus:"fixed",style:(0,er._)((0,G._)({},h&&{"--inputPadding":h}),{width:null===(a=null===(s=e.domRef.current)||void 0===s?void 0:s.querySelector(".SearchBar-input"))||void 0===a?void 0:a.getBoundingClientRect().width})},onFocus:e.handleFocus,onBlur:function(){setTimeout(function(){e.setState({isFocus:!1}),p({isPageHeaderDisabled:!1}),e.state.rawSearchResult||e.startPresetWordsRotation()},100),e.autoComplete.menu.popover.close()},onSelect:e.handleSelect,onEnterInput:e.handleSubmit,onChange:e.handleChange})}}),N=g.includes("/creator")&&"column"!==P.Z.currentEntry;return(0,m.BX)("div",{className:i$()("SearchBar",u),role:"search","data-za-module":"PresetWordItem",children:[(0,m.tZ)(aA.yW,{input:"/",action:this.focusInput}),N?(0,m.BX)(m.HY,{children:[(0,m.tZ)("div",{css:function(e){return{display:"flex",alignItems:"center",padding:"4px 12px",borderRadius:"8px",backgroundColor:e.colors.MapUIFrame10A,position:"relative",left:"-18px"}},children:(0,m.tZ)(i0.xv,{css:{fontSize:17,color:"var(--MapText02A)",fontWeight:500,whiteSpace:"nowrap"},children:"创作中心"})}),(0,m.tZ)("form",{className:"SearchBar-tool"})]}):(0,m.tZ)("form",{className:i$()("SearchBar-tool",{"SearchBar-tool--focus":o}),ref:this.domRef,onSubmit:function(e){return e.preventDefault()},children:R}),_&&!N&&(0,m.tZ)(ah,{mx:"15px"}),d&&!d.isOrg&&(0,m.BX)("div",{className:"SearchBar-askContainer",children:[!_&&!N&&(0,m.tZ)(e7.ZAShow,{as:aC.ZP,zaType:"Button",zaModuleId:"pc_ask_button",shouldTrackClick:!0,ref:this.askButtonRef,className:"SearchBar-askButton",preset:"primary",color:"blue",onClick:this.ask,css:function(e){return(0,G._)({width:48,paddingRight:0},x(e))},children:"提问"}),this.renderAskMenu(x,f,_)]}),(0,m.tZ)(aI.y,{type:"search_suggested_word",shown:a,onClose:this.handleReportHide,zaEnabled:!0,List:n.suggest})]})}}]),n}(b.PureComponent);(0,ed._)(cu,"defaultProps",{theme:iq.mv.normal});var cl=(0,th.compose)((0,aw.Z)(null),iZ.withRouter,ab.Z,(0,e6.connect)(function(e){var t=(0,eU.tQ)(e,{paramId:"ws_ai_search"});return{supportTopSearchZhida:"exp1"===t,supportTopSearchStyleV2:["exp1","exp2"].includes(t)}},{loadTopSearchActionCreatorV2:function(){return{API:{endpoint:"search/recommend_query/v2",types:rO.GET_NEW_TOP_SEARCH},NOTIFICATION:!1}},loadTopSearchZhida:function(){return{API:{endpoint:"/ai_ingress/ai_chat/get_guide_card",types:rO.GET_NEW_TOP_SEARCH_ZHIDA,query:{tab_type:"zhida",ai_ab_value:4,zhida_source:"ai_search_query"},root:"".concat("","https://www.zhihu.com")},NOTIFICATION:!1}},getSuggestActionCreator:rB,setEnvVars:eU.Ct}))(cu),cd=n(9887);function cp(e){return(0,m.tZ)(aC.ZP,(0,er._)((0,G._)({preset:"primary",className:"SimpleSearchBar-plainSearchButton"},e),{children:(0,m.tZ)(ai.J7,{center:!0,size:18})}))}function cf(e){return(0,m.tZ)(aC.ZP,(0,er._)((0,G._)({preset:"primary",className:"SimpleSearchBar-solidSearchButton",color:"blue",type:"submit"},e),{children:(0,m.tZ)(ai.J7,{center:!0,fill:"#fff",size:18})}))}var ch=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"state",{inputValue:e.props.initialValue}),(0,ed._)((0,iD._)(e),"handleChange",function(t){e.setState({inputValue:t.target.value})}),(0,ed._)((0,iD._)(e),"handleSubmit",function(t){t.preventDefault();var n=e.state.inputValue,r=e.props.type;n&&(location.href="/search?type=".concat(encodeURIComponent(r),"&q=").concat(encodeURIComponent(n)))}),e}return(0,U._)(n,[{key:"render",value:function(){var e,t=this.props,n=t.className,r=t.searchButtonType,o=this.state.inputValue;return"plain"===r?e=cp:"solid"===r&&(e=cf),(0,m.tZ)("form",{className:"SimpleSearchBar-wrapper",onSubmit:this.handleSubmit,children:(0,m.tZ)(cd.Z,{className:i$()("SimpleSearchBar-input",n),onChange:this.handleChange,value:o,placeholder:aO,after:e&&(0,m.tZ)(e,{onClick:this.handleSubmit})})})}}]),n}(b.PureComponent);(0,ed._)(ch,"propTypes",{className:iG().string,initialValue:iG().string.isRequired,type:iG().oneOf(["content","people","topic","column","km_general","live","album","publication","zvideo","scholar","km_course"]).isRequired,searchButtonType:iG().oneOf(["solid","plain"])}),(0,ed._)(ch,"defaultProps",{initialValue:"",type:"content",searchButtonType:"plain"});var c_=n(85576),cm=n(32854),cv=n(91850),cg=n(7835),cT=n(75616),cE=n(17518),cy=n(50953),cC=n(15408),cS=(0,b.memo)((0,iZ.withRouter)(function(e){var t=e.location,n=(0,e0.n)(),r=(0,eU.dD)(),o=(0,e6.useSelector)(function(e){return e.pushNotifications.notificationsCount}),i=(0,e6.useSelector)(function(e){return e.messages.messageCount}),a=(0,e6.useDispatch)(),c=t.pathname,s=(0,cy.n)(),u=(0,e6.useSelector)(eU.Kv),l=(0,cy.Z)(),d=(0,ef._)((0,cv.k)(),2),p=d[0],f=d[1];(0,cg.b)(function(){if(!s){u&&(u.startsWith("https://www.zhihu.com")||u.startsWith("https://zhuanlan.zhihu.com"))&&c.startsWith("/p/")&&f.on();return}a((0,eB.sF)(["availableMessageTypes","defaultNotificationsCount","followNotificationsCount","voteThankNotificationsCount","messagesCount"])),(0,cE.Z)([{name:"zhihu/notification/badge/web/v1/".concat(l.id,"/"),onMessage:rl.F7},{name:"zhihu/message/web/v1/user/".concat(l.id,"/"),onMessage:n5.nB}])});var h=(0,b.useMemo)(function(){return function(e){var t=e.notificationsCount,n=e.messageCount;if(e.isMobile)return"";var r=[],o="".concat(99,"+");n&&r.push("".concat(n>99?o:n," 封私信"));var i=Object.keys(t).reduce(function(e,n){return e+t[n]},0);return i&&r.push("".concat(i>99?o:i," 条消息")),r.length?"(".concat(r.join(" / "),") "):""}({notificationsCount:o,messageCount:i,isMobile:r})},[o,i,r]);return(0,m.BX)(m.HY,{children:[(0,m.tZ)(eJ.ql,{titleTemplate:n.Zhihu?"".concat(h,"%s"):"".concat(h,"%s - 知乎")}),p&&!s&&(0,m.tZ)(cC.Z,{defaultType:"login",onClose:f.off}),(0,m.tZ)(cT.ZP,{})]})})),cI=(0,n(82790).Z)(),cA="https://".concat(P.Z.wwwHost),cb=(0,b.forwardRef)(function(e,t){return(0,m.tZ)(ac,(0,G._)({ref:t,as:"button",Icon:iW.Z,label:"消息",href:"".concat(cA,"/notifications")},e))}),cw=[],cZ=function(){var e=(0,iV._)(function(){return n.e(358).then(n.bind(n,79226))});return e?(0,m.tZ)(e,{IconButton:cb}):(0,m.tZ)(cb,{})},cx=(0,b.forwardRef)(function(e,t){return(0,m.tZ)(ac,(0,G._)({ref:t,Icon:iX.Z,label:"创作中心",target:"_blank",href:"".concat(cA,"/creator")},e))}),ck=function(e){var t=e.pathname,n="column"===P.Z.currentEntry;return"/creator"!==t&&"/creator/"!==t||n?(0,m.tZ)(cx,{}):null},cR=(0,b.forwardRef)(function(e,t){return(0,m.tZ)(ac,(0,G._)({ref:t,as:"button",Icon:iK.Z,href:"".concat(cA,"/messages"),label:"私信"},e))}),cN=function(){var e=(0,iV._)(function(){return n.e(3786).then(n.bind(n,37700))});return e?(0,m.tZ)(e,{IconButton:cR}):(0,m.tZ)(cR,{})},cO=(0,b.memo)((0,c_.Z)(function(e){var t=e.pathname,n=e.currentUser,r=e.headerTitle,o=e.shouldShowOutlet,i=e.outlet,a=e.navigate,c=e.authRequired,s=(0,e6.useSelector)(function(e){return e.switches.isCreator}),u=!(null==t?void 0:t.startsWith("/mcn")),l=(0,m.tZ)(cl,{inAppHeader:!0,isNewNavigation:!0,inputPadding:"16px",pathname:t,css:u&&{height:38,".SearchBar-input":{marginLeft:"auto",maxWidth:365,borderRadius:9999,height:"100%",border:"1px solid var(--MapUIFrame08B)"},".SearchBar-input:focus-within":{border:"1px solid var(--MapText05A)"},".SearchBar-askButton":{marginLeft:16,height:"100%"},".SearchBar-askDropdownButton":{width:34,height:34},".SearchBar-searchButton":{height:38,borderBottomRightRadius:9999,borderTopRightRadius:9999,position:"relative",right:"-1px"}}}),d="main"===P.Z.currentEntry,p=(0,b.useMemo)(function(){return[{label:"消息",href:"/notifications",render:function(){return(0,m.tZ)(cZ,{})}},{label:"私信",href:"/messages",render:function(){return(0,m.tZ)(cN,{})}},s&&{label:"创作中心",href:"/creator",render:function(){return(0,m.tZ)(ck,{pathname:t})}}].filter(Boolean)},[t,s]),f=(null==n?void 0:n.isOrg)?i7:i6,h="column"!==P.Z.currentEntry&&(null==t?void 0:t.startsWith("/creator"))?cw:f;return(0,m.BX)(m.HY,{children:[(0,m.tZ)(e4.xB,{styles:{":root":{"--app-header-height":"62px"}}}),(0,m.tZ)(cS,{}),(0,m.tZ)(tn,{id:"PCAppHeader",height:62}),(0,m.tZ)(ap,{navItems:h,headerTitle:r,height:62,base:cA,isInBase:"column"!==P.Z.currentEntry,currentUser:n,pathname:t,navigate:d?a:void 0,outlet:i,shouldShowOutlet:o,userActionLinks:p,onNavClick:function(e,r){if("object"==typeof e&&e.needsLogin&&!n){r.preventDefault(),c(function(){})(r);return}d&&e.isRouterLink&&t===e.pathname&&(r.preventDefault(),(0,a_.X5)(window,{top:0,behavior:"smooth"}),cI.emit("requestRefreshCurrentPage",{pathname:t}))},middle:(0,m.BX)(m.HY,{children:[l,!n&&(0,m.BX)(i0.kC,{alignItems:"center",ml:"16px",children:[(0,m.tZ)(cm.Z,{}),(0,m.tZ)(am.Z,{currentUser:n,enableGuidesForLogin:!0})]})]}),profile:n?(0,m.tZ)(am.Z,{currentUser:n,enableGuidesForLogin:!0}):null})]})})),cP=b.memo((0,iZ.withRouter)(function(e){var t=e.currentUser,n=e.headerTitle,r=e.location,o=e.router,i=(0,e6.useSelector)(function(e){return e.env.appHeaderTheme}),a=iz.Z.useInletProps(),c=a.shown||i.disable?"normal":"custom",s=(0,b.useMemo)(function(){return(0,G._)({type:c,bgColor:i[c].bgColor},iq.mv[c])},[c,i]),u=r.pathname;return(0,m.tZ)(cO,{currentUser:t,headerTitle:n,theme:s,pathname:u,navigate:o.push,outlet:(0,m.tZ)(iz.Z.Outlet,{}),shouldShowOutlet:a.shown})})),cD=n(64074),cL=n(65733),cM=n(45471);function cB(e){var t=e.onClose,n=e.shown,r=void 0!==n&&n,o=e.delay,i=void 0===o?300:o,a=(0,e0.n)(),c=(0,e6.useSelector)(function(e){return(0,eB.ib)(e)}),s=(0,ef._)((0,cv.k)(r),2),u=s[0],l=s[1],d=(0,cL.A)(function(){var e=l.off;i?setTimeout(e,i):e(),null==t||t()}),p=(0,cL.A)(function(){return l.toggle()});(0,b.useEffect)(function(){r!==u&&p()},[r,u,p]);var f=(0,ef._)((0,b.useState)("register"),2),h=f[0],_=f[1];return((0,cg.b)(function(){!c&&(0,cM.gl)()&&_("login")}),u)?P.Z.isMobileEntry?(0,m.tZ)(cM.uq,{onClose:d}):a.Zhihu?(0,m.tZ)(cM.uq,{isAppView:!0,onClose:d}):(0,m.tZ)(cM.Vy,{defaultType:h,onClose:d}):null}function cU(e){return(0,cy.n)()?null:(0,m.tZ)(cB,(0,G._)({},e))}var cG=n(44073),cF=n(49274),cH=n(84871),cz=n.n(cH),cq=n(34459),cV=n(38020),cW=n(49998),cX=n(70877),cK=function(e){var t=e.children;return(0,m.tZ)("div",{css:function(e){return{backgroundColor:e.colors.GBK99A,boxSizing:"border-box",width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center"}},children:t})};function cj(){return(0,m.tZ)(cK,{children:P.Z.isMobileEntry?(0,m.tZ)(cV.Z,{}):(0,m.BX)(m.HY,{children:[(0,m.tZ)(cW.Z,{active:!0}),(0,m.tZ)(cX.Z,{})]})})}var cY=function(e){var t;return null===(t=(0,g._)(e).reverse().find(function(e){return void 0!==e.loadingUI}))||void 0===t?void 0:t.loadingUI};function cQ(e){var t=e.routes,n=e.params,r=e.location,o=e.children,i=e.csrType,a=e.Component,c=(0,F._)(e,["Component"]),s="render"===i,u=(0,ef._)((0,cv.k)(s),2),l=u[0],d=u[1],p=(0,ef._)((0,cv.k)(!1),2),f=p[0],h=p[1],_=(0,ef._)((0,b.useState)(null),2),g=_[0],T=_[1],E=(0,ef._)((0,b.useState)(0),2),y=E[0],C=E[1],S=(0,e0.n)(),I=(0,e6.useStore)(),A=(0,td.Z)(),w=(0,cL.A)(function(){d.on(),f&&h.off(),g&&T(null),C(function(e){return e+1}),(0,cq.R)(t,function(e){return{route:e,params:n,location:r,dispatch:I.dispatch,getState:I.getState,ua:S,ctx:null,http:A}}).catch(T).finally(function(){return h.on()})}),Z=(0,b.useMemo)(function(){return cY(t)},[t]);return((0,b.useEffect)(function(){s&&w()},[s,w]),!l||g)?(0,m.tZ)("div",{css:function(e){return{backgroundColor:e.colors.GBK99A,position:"absolute",top:0,left:0,height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"}},children:(0,m.tZ)(cF.H.EI1,(0,er._)((0,G._)({image:"loadingError",content:(0,cG.n$)(g)},y<=1&&{buttonText:"点击重试",buttonOnClick:w}),{preset:"normal"}))}):f?a?(0,m.tZ)(a,(0,G._)({},c)):o:void 0!==Z?Z:(0,m.tZ)(cj,{})}function cJ(e){var t=e.Component,n=e.children;return e.enable?(0,m.tZ)(cQ,(0,G._)({},e)):t?(0,m.tZ)(t,(0,G._)({},e)):n}var c$=n(49906),c0=n(16836),c1=n(94935),c2=n(28248),c3=n(94681),c4=n(26299),c5=function(){var e=(0,ef._)((0,cv.k)(),2),t=e[0],n=e[1],r=(0,e6.useSelector)(function(e){return e.loading.global.count});return(0,b.useEffect)(function(){r?n.on():n.off()},[n,r]),(0,m.tZ)(cW.Z,{active:t})},c6=n.p+"assets/apple-touch-icon-152.81060cab.png",c7=n.p+"assets/apple-touch-icon-120.d5793cac.png",c8=n.p+"assets/apple-touch-icon-76.7abf3393.png",c9=n.p+"assets/apple-touch-icon-60.362a8eac.png",se=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"render",value:function(){var e=this.props.ua;return(0,m.tZ)(eJ.ql,{title:"知乎",titleTemplate:e.Zhihu?"%s":"%s - 知乎",link:[{rel:"apple-touch-icon",href:c6},{rel:"apple-touch-icon",href:c6,sizes:"152x152"},{rel:"apple-touch-icon",href:c7,sizes:"120x120"},{rel:"apple-touch-icon",href:c8,sizes:"76x76"},{rel:"apple-touch-icon",href:c9,sizes:"60x60"}]})}}]),n}(b.Component),st=(0,e6.connect)(function(e){return{ua:e.env.userAgent}})(se),sn=n(4416);function sr(e){(0,a_.yZ)(window,{behavior:"smooth",top:window.innerHeight/2*(e?1:-1)})}function so(e){(0,a_.zT)(document.body,{behavior:"smooth",block:e})}var si=function(){(0,sn.n)("shift+u",function(){return sr(!1)}),(0,sn.n)("shift+d",function(){return sr(!0)}),(0,sn.n)("g g",function(){return so("start")}),(0,sn.n)("shift+g",function(){return so("end")})};function sa(){return si(),(0,m.tZ)(m.HY,{children:!1})}var sc=n(31467),ss=function(e){var t=e.keyMap,n=t.key,r=t.hint,o=n.split(/[ +]/),i=n.includes("+")?"+":" ";return(0,m.BX)("div",{className:"KeyHint",children:[(0,m.tZ)("div",{className:"KeyHint-keyContainer",children:o.map(function(e,t){return(0,m.BX)("div",{className:"KeyHint-key",children:[(0,m.tZ)("kbd",{className:"KeyHint-kbd",children:e}),t<o.length-1&&(0,m.tZ)("div",{className:i$()("KeyHint-separator",{"KeyHint-separator--space":" "===i}),children:i})]},t)})}),(0,m.BX)("div",{children:["：",r]})]})},su=[["操作",[{key:"V",hint:"赞同"},{key:"D",hint:"反对"},{key:"L",hint:"喜欢"},{key:"C",hint:"展开 / 收起评论"},{key:"O",hint:"展开 / 收起全文"},{key:"F",hint:"收藏"},{key:"S",hint:"分享"}]],["导航",[{key:"J",hint:"主内容下一项"},{key:"K",hint:"主内容上一项"},{key:"G G",hint:"滚动到页面顶部"},{key:"Shift+G",hint:"滚动到页面底部"},{key:"Shift+U",hint:"向上滚动半屏"},{key:"Shift+D",hint:"向下滚动半屏"},{key:"Shift+S",hint:"侧边栏第一项"},{key:"/",hint:"搜索"},{key:"?",hint:"快捷键帮助"}]]],sl=function(){var e=(0,ef._)((0,cv.k)(),2),t=e[0],n=e[1];return(0,m.BX)(m.HY,{children:[(0,m.tZ)(sn.y,{input:"?",action:n.toggle}),(0,m.tZ)(sn.y,{input:"？",action:n.toggle}),(0,m.tZ)(sc.Z,{className:"ShortcutHintModal",title:"快捷键帮助",onClose:n.off,children:t&&(0,m.tZ)("div",{className:"ShortcutHintModal-content",children:(0,m.tZ)("div",{className:"ShortcutHintModal-hintListContainer",children:su.map(function(e){var t=(0,ef._)(e,2),n=t[0],r=t[1];return(0,m.BX)("div",{className:"ShortcutHintModal-hintList",children:[(0,m.tZ)("div",{className:"ShortcutHintModal-hintTitle",children:n}),r.map(function(e){return(0,m.tZ)(ss,{keyMap:e},e.key)})]},n)})})})})]})},sd=n(83821),sp=n(62317),sf=function(e,t){if(e.closest)return e.closest(t);do{if(e.matches(t))break;e=e.parentElement}while(e);return e},sh=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),(e=t.call(this)).state={show:!1},e.onGlobalMouseover=e.handleGlobalMouseover.bind((0,iD._)(e)),e.onCancelEvent=e.handleCancelEvent.bind((0,iD._)(e)),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){document.body.addEventListener("mouseover",this.onGlobalMouseover),window.addEventListener("scroll",this.onCancelEvent),window.addEventListener("resize",this.onCancelEvent)}},{key:"componentWillUnmount",value:function(){document.body.removeEventListener("mouseover",this.onGlobalMouseover),window.removeEventListener("scroll",this.onCancelEvent),window.removeEventListener("resize",this.onCancelEvent)}},{key:"handleGlobalMouseover",value:function(e){var t=this;clearTimeout(this.showTimeout),clearTimeout(this.hideTimeout);var n=sf(e.target,"[data-tooltip]");n&&!n.disabled?this.showTimeout=setTimeout(function(){var e,r,o=n.getAttribute("data-tooltip-position")||"top",i=n.getAttribute("data-tooltip"),a="1"===n.getAttribute("data-tooltip-richtext"),c=n.getAttribute("data-tooltip-classname"),s=n.getAttribute("data-tooltip-preset")||"black",u=null!==n.getAttribute("data-tooltip-will-hide-on-click"),l=n.getBoundingClientRect(),d=l.left,p=l.right,f=l.top,h=l.bottom;switch(o){case"left":e=d-4,r=(f+h)/2;break;case"right":e=p+4,r=(f+h)/2;break;case"bottom":e=(d+p)/2,r=h+4;break;default:e=(d+p)/2,r=f-4}t.setState({show:!0,content:i,isTooltipRichText:a,position:o,className:c,preset:s,willHideOnClick:u,x:Math.round(e),y:Math.round(r)})},100):this.state.show&&(this.hideTimeout=setTimeout(function(){sf(e.target,".GlobalTooltip")||t.setState({show:!1})},120))}},{key:"handleCancelEvent",value:function(){clearTimeout(this.showTimeout),clearTimeout(this.hideTimeout),this.state.show&&this.setState({show:!1})}},{key:"render",value:function(){var e=this.state,t=e.show,n=e.content,r=e.isTooltipRichText,o=e.position,i=e.preset,a=e.restricted,c=e.className,s=e.contentClassName,u=e.contentChildrenClassName,l=e.x,d=e.y;return(0,m.tZ)(sp.Z,{className:i$()("GlobalTooltip",c),contentClassName:s,contentChildrenClassName:u,shown:t,content:n,isTooltipRichText:r,position:o,preset:i,restricted:a,x:l,y:d})}}]),n}(b.Component),s_=function(e){var t=e.whitelist,n=void 0===t?["/term","/terms","/unregister"]:t,r=e.currentUrlPath,o=(0,cy.Z)(["isDestroyWaiting"]),i=(0,cL.A)(function(){(null==n?void 0:n.some(function(e){return r.startsWith(e)}))||(window.location.href="".concat(P.Z.protocol,"//").concat(P.Z.wwwHost,"/unregister?version=2&is_waiting_page=1"))});return(0,b.useEffect)(function(){(null==o?void 0:o.isDestroyWaiting)&&i()},[o,i]),null},sm=function(e){var t=(0,ek._)({},(0,eR._)(e)),n=t.currentUrlPath;return(0,b.useMemo)(function(){return!(n.match(/\/story\/\d+$/)||n.match(/\/authorize$/))},[n])?(0,m.tZ)(s_,(0,G._)({},t)):null};function sv(){var e=(0,td.Z)();return(0,cg.b)(function(){window.__ZHToolkit__={fetch:e}}),null}var sg=function(){var e=function(e){return(0,g._)(Array(e).keys()).map(function(e){return e+1})},t="text-shadow:".concat((0,g._)(e(4).map(function(e){return"".concat(.7*e,"px -").concat(e,"px 0 rgb(255 255 255 / ").concat(100-4*(e-1),"%)")})).concat((0,g._)(e(3).map(function(e){return"-".concat(e,"px ").concat(e,"px ").concat(2*e,"px rgb(0 0 0 / 70%)")}))).flat().join(","));console.log("%c知乎 ฅ՞•ﻌ•՞ฅ","color:#1772F6;font-weight:bold;font-size:6em;padding:10px 30px;".concat(t,";").concat("background: linear-gradient(to right top,oklab(58.2% -0.04 -0.21),oklab(58.2% -0.376 -0.21));")),console.log("加入知乎 https://s.zhihu.com/BDXoD")},sT=function(e){var t=e.location;return(0,e7.usePageShow)(t),null},sE=function(e){var t=e.location;return(0,e7.usePageDisappear)(t),null},sy=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.silent,n=e.fillCurrentUserIfNeeded,r=e.location.pathname;!t&&(sg(),r.match(/\/story\/\d+$/)||r.match(/\/authorize$/)||n(["email","accountStatus","isBindPhone"]))}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.location,r=e.userAgent,o=e.disableMainHelmet,i=e.disableWechatShareImage,a=e.disableCornerButtons,c=e.disableTrackPageShow,s=void 0!==c&&c,u=e.hideBackToTopButton;return(0,m.BX)("div",{className:t,children:[!o&&(0,m.tZ)(st,{}),r.Wechat&&!i&&(0,m.tZ)(iH.J,{}),!r.Zhihu&&(0,m.tZ)(c5,{}),!s&&(0,m.tZ)(sT,{location:n}),!s&&(0,m.tZ)(sE,{location:n}),(0,m.tZ)(c1.z,{}),this.props.children,(0,m.tZ)(c2.Z,{}),(0,m.tZ)(sh,{}),(0,m.tZ)(c0.Z,{style:{display:"none"},children:(0,m.tZ)("i",{children:"想来知乎工作？请发送邮件到 jobs@zhihu.com"})}),!(void 0!==a&&a)&&!r.Mobile&&!r.Zhihu&&!(void 0!==u&&u)&&(0,m.tZ)(sd.ZP,{children:(0,m.tZ)("div",{role:"complementary",children:(0,m.tZ)(c4.ZP,{children:(0,m.tZ)(c4.zV,{onClick:function(e){e.preventDefault(),(0,a_.X5)(window,{top:0,behavior:"smooth"})}})})})}),(0,m.tZ)(sd.ZP,{children:(0,m.tZ)(sm,{currentUrlPath:n.pathname})}),(0,m.tZ)(sd.ZP,{children:(0,m.tZ)(c3.Z,{})}),(0,m.tZ)(sl,{}),(0,m.tZ)(sa,{}),(0,m.tZ)(sv,{})]})}}]),n}(b.Component),sC=(0,th.compose)((0,e6.connect)(function(e){var t="/launcher"===e.env.ctx.path||"zhida"===P.Z.currentEntry;return{currentUser:(0,eB.ib)(e),account:e.account,userAgent:e.env.userAgent,disableMainHelmet:t,ua:(0,eU.Uh)(e)}},{fillCurrentUserIfNeeded:eB.sF}),iZ.withRouter)(sy),sS=n(19319),sI=(0,e6.connect)(function(e){return{account:e.account,notification:(0,t1._X)(e)}})(function(e){var t,n=e.account,r=e.notification,o=n.isAppealed,i=n.spamLevel,a=(0,b.useMemo)(function(){var e=o||i?D.Wy:D.If,t=6===i?(0,er._)((0,G._)({},r),{theme:"red"}):r;return(0,m.tZ)(sS.Z,{notification:t,delay:e})},[o,i,r]);if(!(null==r?void 0:null===(t=r.zaProps)||void 0===t?void 0:t.shouldTrackShow))return a;var c=r.zaProps,s=c.zaText,u=c.zaBlock,l=c.key;return(0,m.tZ)(e7.ZAShow,{zaType:"Text",zaText:s||r.text,zaBlock:u,children:a},l)}),sA=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{color:"#3e7ac2"};return(0,m.tZ)("a",{target:"_blank",rel:"noopener noreferrer",href:e,style:n,children:t})},sb=sA("/term/community","知乎社区管理规定"),sw=sA("/term/community","知乎社区管理规定",{color:"#fff","text-decoration":"underline"}),sZ=sA("/question/19551824","知乎用户信息管理规范"),sx=sA("/settings/profile#rename-section","修改"),sk=sA("/people/edit","修改"),sR=sA("/account/unblock","验证"),sN={ads:"发布垃圾信息",unfriendly:"发布不友善内容",illegal:"发布违反法律法规的内容",politics:"发布不宜公开讨论的政治内容",animus_edit:"恶意编辑",other:"其他原因"},sO={hang:(0,m.BX)("span",{children:["由于严重违反 ",sb,"，该账号已被停用。"]}),lock:function(e){var t=e.unBlockInfo,n=t.isAppealed,r=t.spamLevel;return n?(0,m.tZ)("span",{children:"你的账号由于存在异常行为暂时被知乎反作弊系统限制使用，我们已收到了您的申诉信息，24 小时内会以私信的方式告知你申诉结果，请耐心等待。"}):6===r?(0,m.BX)("span",{children:["您的账号由于违反 ",sw," ，已被永久封禁。"]}):4===r?(0,m.BX)("span",{children:["您的账号异常 ，部分功能暂不可用。如需恢复，请完成"," ",sA("/account/unblock","账号验证")]}):(0,m.BX)("span",{children:["你的网络环境或行为异常，请进行安全",sR]})},ban:function(e){var t=e.expiredAt,n=e.reason;return t>999?(0,m.BX)("span",{children:["由于严重违反\xa0",sb,"\xa0，该账号已被永久禁言"]}):(0,m.BX)("span",{children:["您的账号由于\xa0",(0,m.tZ)("a",{target:"_blank",href:"/term/community",style:{color:"#3e7ac2"},children:sN[n]||"违反知乎社区规定"}),"\xa0暂时被限制使用，",t," 天后恢复正常。"]})},isForceRenamed:function(e){var t=e.isOrg;return(0,m.BX)("span",{children:["您的用户名不符合 ",sZ,"，请您\xa0",t?sx:sk,"。"]})},notBindPhone:(0,m.BX)("span",{children:["您的账号未激活，无法正常使用赞同、评论等功能。请 ",(0,m.tZ)(cM.$7,{})," 。"]})},sP={profile:{hang:(0,m.BX)("span",{children:["由于严重违反 ",sb,"，该账号已被停用"]}),lock:function(e){var t=e.unBlockInfo,n=t.isAppealed,r=t.spamLevel;return n&&3===r||!r?null:4===r?(0,m.BX)("span",{children:["您的账号异常 ，部分功能暂不可用。如需恢复，请完成"," ",sA("/account/unblock","账号验证")]}):6===r?(0,m.BX)("span",{children:["您的账号由于违反 ",sb," ，已被永久封禁。"]}):(0,m.BX)("span",{children:["你的网络环境或行为异常，请进行安全",sR]})},ban:function(e){var t=e.isCurrentUser,n=e.expiredAt,r=e.reason;return n>999?(0,m.BX)("span",{children:["由于严重违反\xa0",sb,"\xa0，该账号已被永久禁言"]}):t?(0,m.BX)("span",{children:["您的账号由于\xa0",(0,m.tZ)("a",{href:"/term/community",target:"_blank",style:{color:"#3e7ac2"},children:sN[r]||"违反知乎社区规定"}),"\xa0暂时被限制使用，",n," 天后恢复正常。"]}):(0,m.BX)("span",{children:["由于违反 ",sb,"，该用户暂时处于禁言状态，",n," ","日后将恢复正常使用。"]})},isForceRenamed:function(e){var t=e.isCurrentUser,n=e.hasRenamed,r=e.isOrg;return t?(0,m.tZ)("span",{children:n?"您的用户名已修改，请等待管理员确认。申诉邮箱：i@zhihu.com。":(0,m.BX)("span",{children:["您的用户名不符合 ",sZ,"，请您\xa0",r?sx:sk]})}):(0,m.BX)("span",{children:["由于违反 ",sZ," ，该用户暂时处于改名状态。"]})},notBindPhone:function(){return null}},behavior:sO};function sD(e,t,n){var r,o="object"==typeof e?e.name:e;if("ban"===o){var i=e.createdAt,a=e.expiredAt;r={reason:e.reason,expiredAt:Math.ceil((0,rw.NV)(a-Date.now()/1e3+i))}}return o===D.Pw.lock&&(r={unBlockInfo:t}),o===D.Pw.isForceRenamed&&(r={isOrg:!!(n&&"organization"===n.userType)}),function(e,t,n){if(!t)return"";var r=sP[e];return"function"==typeof r[t]?r[t]((0,G._)({},n)):r[t]}("behavior",o,r)}function sL(e,t){var n=e.accountStatus,r=e.isForceRenamed,o=e.isBindPhone,i=e.userType,a=e.isRealname;if(n&&n.length){var c=n.find(function(e){var n=e.name;return t.includes(n)});if(c)return c}return!1===o&&!a&&t.includes("notBindPhone")?"notBindPhone":r&&t.includes("isForceRenamed")?"isForceRenamed":"guest"===i&&t.includes("isGuest")?"isGuest":null}function sM(e,t,n){for(var r=arguments.length,o=Array(r>3?r-3:0),i=3;i<r;i++)o[i-3]=arguments[i];var a=e.canWrite,c=e.alertTimeSpan;if(!a)return t.apply(void 0,(0,g._)(o));var s=new Date().getTime(),u=O().get(D.iG);return isNaN(u)||u>s||u+1e3*c<s?(O().set(D.iG,s),t.apply(void 0,(0,g._)(o))):n.apply(void 0,(0,g._)(o))}var sB=n(69140),sU=n(65357),sG=n(82865),sF=(0,e6.connect)(function(e){var t=e.entities.users[e.currentUser],n=t.isActive,r=t.email,o=t.isZombie,i=t.isBindPhone,a=e.account;return{isActive:n,email:r,isZombie:o,errorStatus:a.errorStatus,challenge:a.challenge,isBindPhone:i}},{getUnlockRequest:tv.F4})(function(e){var t=e.globalShow,n=e.toggleGlobalShow,r=e.isZombie,o=e.getUnlockRequest,i=e.isActive,a=e.email,c=e.challenge,s=e.errorStatus,u=e.isBindPhone,l=(0,ef._)((0,b.useState)(!1),2),d=l[0],p=l[1],f=(0,ef._)((0,b.useState)(""),2),h=f[0],_=f[1],g=(0,cL.A)(function(){r&&(I.ZP.increment("logIn.zombieStatus.closeModal.count"),(0,sG.Fu)())}),T=(0,cL.A)(function(){g(),(0,sU.o$)(),_("")}),E=(0,cL.A)(function(){g(),(0,sU.o$)()}),y=(0,b.useCallback)(function(){d&&T(),n(!d)},[n,d,T]);(0,b.useEffect)(function(){r&&(I.ZP.increment("logIn.zombieStatus.showModal.count"),p(!0))},[r]),(0,b.useEffect)(function(){void 0!==u&&!u&&(0,sU.wb)()&&p(!0)},[u]),(0,b.useEffect)(function(){t&&I.ZP.increment("logIn.GlobalVerificationModal.show.count"),p(t)},[t]);var C=(0,cL.A)(function(){var e=document.querySelector(".VerificationDialogModalHeader"),t="";t=r?(null==c?void 0:c.length)?sB.SAFETY_VERIFICATION:sB.BIND_PHONE:i&&a?sB.CONFIRM_BIND_PHONE:s&&!e&&c&&c.length?sB.SAFETY_VERIFICATION:sB.BIND_PHONE,I.ZP.increment("logIn.GlobalVerificationModal.initialStep.".concat(t,".count")),_(t)});return(0,b.useEffect)(function(){d&&o().then(function(){C()})},[d]),(0,m.tZ)(cM.t,{currentStep:h,onToggle:y,shown:d,onSuccess:E})}),sH=n(84954),sz=n(76295);function sq(){return"undefined"==typeof document?null:document.querySelector(".VerificationDialogModalHeader")}var sV=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"state",{authModalShown:!1,bindPhoneModalShown:!1,signInModalShown:!1}),(0,ed._)((0,iD._)(e),"handleAuthModalClose",function(){return e.setState({authModalShown:!1})}),(0,ed._)((0,iD._)(e),"closeModal",function(){var t=e.props.recoverDefaultType;iF.c.close(),t()}),(0,ed._)((0,iD._)(e),"handleInitAccount",function(t){var n=t||e.props,r=n.currentUser,o=n.account,i=n.getUnblockInfo;r&&r.accountStatus&&r.accountStatus.find(function(e){return"lock"===e.name})&&!o.isUnblockInfoFetched&&i()}),(0,ed._)((0,iD._)(e),"handleBindPhoneModalToggle",function(){e.setState(function(e){return{bindPhoneModalShown:!e.bindPhoneModalShown}})}),(0,ed._)((0,iD._)(e),"handleToggleSignInModalShown",function(){e.setState({signInModalShown:!e.state.signInModalShown})}),(0,ed._)((0,iD._)(e),"handleLogin",function(){e.props.userAgent.Wechat?e.handleToggleSignInModalShown():location.href="https://www.zhihu.com/signin?next=".concat(encodeURIComponent(location.href))}),e}return(0,U._)(n,[{key:"getChildContext",value:function(){var e=this,t=this.props,n=t.isMobile,r=t.showNotification;return{currentUser:this.props.currentUser,isMobile:n,authRequired:function(e,t,n,r,o,i){var a=this;return function(c){for(var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:D.zg,u=arguments.length,l=Array(u>2?u-2:0),d=2;d<u;d++)l[d-2]=arguments[d];var p=function(e){return function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];e.apply(void 0,(0,g._)(n)),"function"==typeof m&&m.apply(void 0,(0,g._)(n))}};if(!c){var f="function"==typeof e?e():e;return sD(sL(f,s),null,f)}var h=(0,ef._)(Array.isArray(c)?c:[c],2),_=h[0],m=h[1];return function(){for(var c=arguments.length,u=Array(c),d=0;d<c;d++)u[d]=arguments[d];var f="function"==typeof e?e():e;if(!f)return p(r).apply(a,(0,g._)(u));var h=sL(f,s);return h?"notBindPhone"===h&&i?p(sM.bind(null,t,i,_)).apply(a,(0,g._)(u)):"isGuest"===h?p(r).apply(a,(0,g._)(u)):p(function(){return o.apply(void 0,[sD(h,h.name===D.Pw.lock?n():null,f)].concat((0,g._)(l)))}).apply(a,(0,g._)(u)):_.apply(void 0,(0,g._)(u))}}}(function(){return e.props.currentUser},D.xR,function(){return e.props.account},function(){return n?(0,sz.ZP)():e.setState({authModalShown:!0})},function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return r.apply(void 0,[e,"white"].concat((0,g._)(n)))},this.handleBindPhoneModalToggle),handleBindPhoneModalToggle:this.handleBindPhoneModalToggle}}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.account,n=e.currentUser,r=e.getUnlockRequest,o=t.errorStatus;if(!t.isFetching){var i=sq();o&&!i&&n&&"guest"!==n.userType&&r()}}},{key:"componentDidMount",value:function(){var e=this.props.edition;if(O().isSupported()){var t=Object.keys(e).find(function(t){return!!e[t]});t&&window.sessionStorage.setItem("utm_source",t)}}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.requestUnlockTicket,r=t.unlockTicketByDigits,o=t.unlockTicketByPassword,i=t.account,a=i.unlockTicketStatus,c=i.isFetching,s=i.errorStatus,u=i.challenge;!c&&s&&u&&u.length&&!sq()&&iF.c.show((0,m.tZ)(iF.c,{account:i,unlockTicketByDigits:r,requestUnlockTicket:n,unlockTicketByPassword:o,onClose:this.closeModal})),a&&iF.c.close(),e.currentUser&&this.props.currentUser&&(!e.currentUser.accountStatus&&this.props.currentUser.accountStatus&&this.handleInitAccount(),void 0===e.currentUser.isBindPhone&&void 0!==this.props.currentUser.isBindPhone&&this.unlockRequestIfNeed())}},{key:"componentWillUnmount",value:function(){(0,this.props.recoverDefaultType)()}},{key:"unlockRequestIfNeed",value:function(){var e=this.props,t=e.currentUser,n=e.getUnlockRequest;t&&!1===t.isBindPhone&&"guest"!==t.userType&&n()}},{key:"renderAppHeader",value:function(){var e=this.props,t=e.currentUser,n=e.isMobile,r=e.isZhihu,o=e.itemInfo,i=e.routes.some(function(e){return e.showAppHeader});return!1===i||r?null:n?(0,m.tZ)(cD.Z,{currentUser:t,onLogin:this.handleLogin,tag:"div",itemInfo:o}):i?(0,m.tZ)(cP,{currentUser:t}):null}},{key:"render",value:function(){var e=this.props,t=e.currentUser,n=e.userAgent,r=e.children,o=this.state,i=o.authModalShown,a=o.bindPhoneModalShown,c=o.signInModalShown;return(0,m.BX)(sC,{className:"App",children:[n.Wechat&&(0,m.tZ)(iH.J,{}),this.renderAppHeader(),(0,m.tZ)(sI,{}),(0,m.tZ)("main",{role:"main",className:"App-main",children:r}),(0,m.tZ)(cU,{shown:i,onClose:this.handleAuthModalClose}),t&&(0,m.tZ)(sF,{globalShow:a,toggleGlobalShow:this.handleBindPhoneModalToggle}),(0,m.tZ)(sH.w,{}),c&&(0,m.tZ)(c$.Z,{buttons:[{name:"zhihu",text:"使用知乎账号登录",fill:"#0f88eb",color:"#fff"},{name:"wechat",text:(0,m.BX)("span",{children:[(0,m.tZ)(iB.F3,{text:!0,center:!0}),"\xa0微信快速登录"]}),fill:"#12b370",color:"#fff"}],onClose:this.handleLogin})]})}}]),n}(b.Component);(0,ed._)(sV,"fetchData",function(e){return(0,e.dispatch)((0,eU.ph)())}),(0,ed._)(sV,"childContextTypes",{currentUser:iG().object,authRequired:iG().func,handleBindPhoneModalToggle:iG().func,isMobile:iG().bool});var sW=(0,th.compose)(function(e){return cz()(function(t){var n=(0,e6.useSelector)(function(e){return e.env.mode}),r=(0,e6.useSelector)(function(e){return e.env.vars.csrType})||"downgrade";return(0,m.tZ)(cJ,(0,er._)((0,G._)({},t),{enable:"csr"===n,csrType:r,Component:e}))},e)},(0,e6.connect)(function(e,t){var n,r=e.env,o=r.userAgent,i=r.trafficSource,a=(0,eU.Hu)(e),c="p"===(n=t.location.pathname.split("/").slice(1))[0]?{type:"article",id:Number(n[1])}:"answer"===n[2]?{type:"answer",id:Number(n[3])}:"question"===n[0]?{type:"question",id:Number(n[1])}:"topic"===n[0]?{type:"topic",id:Number(n[1])}:null;return c&&(c.readStatus=(0,rp.O8)(e,c)),{trafficSource:i,currentUser:(0,eB.ib)(e),account:e.account,userAgent:o,isMobile:a,isZhihu:(0,eU.nR)(e),itemInfo:c||void 0,edition:(0,eU.cM)(e)}},{showNotification:t1.c0,unlockTicketByDigits:tv.LC,getUnblockInfo:tv.sQ,unlockTicketByPassword:tv.Hr,getUnlockRequest:tv.F4,requestUnlockTicket:tv.MM,recoverDefaultType:tv.Z3}))(sV),sX=n(93883),sK=n(48504),sj=n(55679),sY=n(96485),sQ=function(e){var t=e.className,n=new Date().getFullYear();return(0,m.BX)("div",{className:i$()("ColumnHomeBottom",t),children:[(0,m.tZ)("h3",{className:"ColumnHomeBottom-title",children:"在知乎创作"}),(0,m.BX)("footer",{className:"ColumnHomeBottom-footer",children:[(0,m.BX)("span",{children:["\xa9 ",n," 知乎"]}),(0,m.tZ)("span",{children:" \xb7 "}),(0,m.tZ)("a",{target:"_blank",href:"/",rel:"noopener noreferrer",children:"知乎专栏"}),(0,m.tZ)("span",{children:" \xb7 "}),(0,m.tZ)("a",{target:"_blank",href:"https://www.zhihu.com/roundtable",rel:"noopener noreferrer",children:"圆桌"}),(0,m.tZ)("span",{children:"\xb7"}),(0,m.tZ)("a",{target:"_blank",href:"https://www.zhihu.com/explore",rel:"noopener noreferrer",children:"发现"}),(0,m.tZ)("span",{children:" \xb7 "}),(0,m.tZ)("a",{target:"_blank",href:"https://www.zhihu.com/app",rel:"noopener noreferrer",children:"移动应用"}),(0,m.tZ)("span",{children:" \xb7 "}),(0,m.tZ)("a",{href:"https://www.zhihu.com/signin?no_qrcode=1",children:"使用机构账号登录"}),(0,m.tZ)("span",{children:" \xb7 "}),(0,m.tZ)("a",{href:"https://www.zhihu.com/contact",children:"联系我们"}),(0,m.tZ)("span",{children:" \xb7 "}),(0,m.tZ)("a",{target:"_blank",href:"https://www.zhihu.com/careers",rel:"noopener noreferrer",children:"来知乎工作"}),(0,m.tZ)("br",{}),(0,m.tZ)("a",{href:"https://tsm.miit.gov.cn/dxxzsp/",target:"_blank",rel:"noopener noreferrer",children:"京ICP证110745号"}),(0,m.tZ)("span",{children:" \xb7 "}),(0,m.tZ)("a",{href:"https://beian.miit.gov.cn/",target:"_blank",rel:"noopener noreferrer",children:"京ICP备13052560号-1"}),(0,m.tZ)("span",{children:" \xb7 "}),(0,m.BX)("a",{target:"_blank",rel:"noopener noreferrer",href:"http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010802020088",children:[(0,m.tZ)("img",{src:"https://pic3.zhimg.com/80/v2-d0289dc0a46fc5b15b3363ffa78cf6c7.png",alt:""}),"京公网安备 11010802020088 号"]}),(0,m.tZ)("span",{children:" \xb7 "}),(0,m.tZ)("a",{href:"http://zhstatic.zhihu.com/assets/zhihu/publish-license.jpg",target:"_blank",rel:"noopener noreferrer",children:"出版物经营许可证"})]})]})},sJ=n(99178),s$=n(65849),s0=n(55698),s1=n(30722);function s2(e){var t=e.className,n=e.column,r=e.index,o=n.columnType,i=n.id,a=n.imageUrl,c=n.title,s=n.description,u=n.followers,l=n.itemsCount;return(0,m.tZ)(e7.ZAEnv,{content:{type:"Column",token:String(i),id:String(i)},children:(0,m.BX)(e7.ZAClick,{zaModuleId:"column_card",zaModuleIndex:r,zaType:"Card",shouldTrackShow:!0,as:"a",className:i$()("ColumnHomeColumnCard",t),target:"_blank",href:"https://www.zhihu.com/column/".concat(i),rel:"noopener noreferrer",children:[(0,m.tZ)(s0.qE,{className:"ColumnHomeColumnCard-Avatar",round:!0,size:48,url:a,alt:""}),(0,m.BX)("div",{className:"ColumnHomeColumnCard-info",children:[(0,m.tZ)("div",{className:"ColumnHomeColumnCard-title",children:c}),(0,m.tZ)("div",{className:"ColumnHomeColumnCard-description",children:s})]}),(0,m.BX)("div",{className:"ColumnHomeColumnCard-meta",children:[(0,s1.uf)(u)," 人","paid_column"===o?"付费":"","订阅 |"," ",(0,s1.uf)(l),"篇内容"]}),(0,m.tZ)(aC.ZP,{className:"ColumnHomeColumnCard-followButton",preset:"outline",color:"green",children:"进入专栏"})]})})}function s3(e){var t=e.children;return(0,m.BX)("h3",{className:"ColumnHomeTitle",children:[(0,m.tZ)("div",{className:"ColumnHomeTitle-text",children:t}),(0,m.tZ)("div",{className:"ColumnHomeTitle-line"})]})}function s4(){var e=(0,ef._)((0,b.useState)(!1),2),t=e[0],n=e[1],r=(0,cy.Z)(["urlToken"]),o=(0,e6.useSelector)(function(e){return e.followingColumns})||{},i=o.loading,a=o[null==r?void 0:r.urlToken]||{},c=a.paging,s=a.data,u=(null==s?void 0:s.length)>0,l=(0,e6.useDispatch)(),d=(0,cL.A)(function(){null!=c&&c.isEnd||l(iT(r.urlToken))});return((0,b.useEffect)(function(){(null==r?void 0:r.urlToken)&&!u&&!i&&d()},[r,l,i,u,d]),(null==r?void 0:r.urlToken)&&u)?(0,m.BX)("div",{className:"ColumnHomeRecommendation",css:{margin:"0 auto"},children:[(0,m.tZ)(s3,{children:"已订阅专栏"}),t?(0,m.tZ)(sJ.ZP,{isDrained:null==c?void 0:c.isEnd,onLoad:d,isLoading:i,css:{display:"flex",flexWrap:"wrap"},children:s.map(function(e,t){return(0,m.tZ)(s2,{index:t,column:e,css:{margin:"0 8px 16px"}},e.id)})}):(0,m.tZ)(i0.kC,{flexWrap:"wrap",children:s.slice(0,8).map(function(e,t){return(0,m.tZ)(s2,{index:t,column:e,css:{margin:"0 8px 16px"}},e.id)})}),!t&&!(null==c?void 0:c.isEnd)&&(0,m.BX)(i0.zx,{bg:"unset",fontSize:15,lineHeight:1.4,fontWeight:"bold",color:"MapText06A",mt:"20px",textAlign:"center",onClick:function(){return n(!0)},children:["展开 ",(0,m.tZ)(s$.Z,{text:!0,center:!0,css:{marginLeft:4}})]})]}):null}var s5=n(44812),s6=function(e){var t=e.recommendations,n=e.onChange,r=(0,ef._)((0,b.useState)(!1),2),o=r[0],i=r[1];return(0,m.BX)("div",{className:"ColumnHomeRecommendation",children:[(0,m.tZ)(s3,{children:"专栏 \xb7 发现"}),(0,m.tZ)("div",{className:"ColumnHomeRecommendation-cardContainer",children:(void 0===t?[]:t).map(function(e,t){return(0,m.tZ)(s2,{className:"ColumnHomeRecommendation-card",column:e,index:t},e.id)})}),(0,m.tZ)(aC.ZP,{className:i$()("ColumnHomeRecommendation-refreshButton",{"ColumnHomeRecommendation-refreshButton--rotating":o}),color:"grey",icon:s5.x,label:"换一换",onClick:function(e){i(!0),n(e)},onTransitionEnd:function(){i(!1)}})]})},s7=function(){return(0,m.BX)("div",{className:"ColumnHomeTop",children:[(0,m.tZ)("h1",{className:"ColumnHomeTop-logo",children:"知乎专栏"}),(0,m.tZ)("h2",{className:"ColumnHomeTop-subTitle",children:"随心写作，自由表达"})]})},s8={limit:8,offset:0,seed:7};function s9(e){var t=e.homeRecommendations,n=e.getHomeRecommendations,r=(0,b.useCallback)(function(){window.innerWidth<=1020?(s8.offset+=6,s8.limit=6):(s8.offset+=8,s8.limit=8),n("columns",s8)},[n]);return(0,m.BX)("div",{className:"ColumnHome",children:[(0,m.tZ)(eJ.ql,{title:"知乎专栏 - 随心写作，自由表达"}),(0,m.tZ)(s7,{}),(0,m.tZ)(s4,{}),(0,m.tZ)(s6,{recommendations:t,onChange:r}),(0,m.tZ)(sQ,{className:"ColumnHome-HomeBottom"})]})}s9.fetchData=function(e){return(0,e.dispatch)(iS("columns",s8))};var ue=(0,th.compose)((0,sY.g)({scene:sY.k.article}),sj.dT,(0,sX.Z)({pageId:"60333"}),(0,e6.connect)(function(e){var t=e.recommendation.homeRecommendations;return{currentUser:(0,eB.ib)(e),isMobile:(0,eU.Hu)(e),homeRecommendations:t}},{getHomeRecommendations:iS,showNotification:t1.c0}),(0,sK.Z)({shouldLoad:function(e){return 0===e.homeRecommendations.length},load:function(e){return(0,e.getHomeRecommendations)("columns",s8)}}))(s9),ut=function(e){var t=e.ua,n=e.env,r=e.location,o=n.ctx;if(!t.ZhihuHybrid&&(t.UC||t.Quark||t.MQQBrowser)){var i=Error();throw i.redirect="https://oia.zhihu.com".concat((0,eK.Qu)(r.pathname),"?app_from=uckoc_interc&is_from_paid=1&redirect_from=").concat(encodeURIComponent(o.href)),i}},un=n(91777),ur=n(44765),uo=n(20408),ui=n(30037),ua=n(19180),uc=n(2913),us=n(32210),uu=n(7489),ul=n(16471),ud=n(99447),up=n(57730),uf=n(16850),uh=n(6148);function u_(e,t){return!t.BaiduApp&&!t.Zhixuetang}function um(e,t){var n=(0,e0.n)(),r=(0,uh.dj)(P.Z.apollo.app_oia_config),o=t||(n.BaiduApp?_.BaiduApp:null)||(n.Wechat?_.WeixinApp:null);if(!r||!o)return u_(e,n);var i=r[o];if(!i)return u_(e,n);var a=i[e];return"1"===a?!n.Zhixuetang:"0"!==a&&u_(e,n)}(o=_||(_={})).BaiduApp="baidu_app",o.WeixinApp="wx_app";var uv=n(95167),ug=(0,iZ.withRouter)(function(e){var t=e.location.query,n=e.noAutoPull,r=(0,e0.n)(),o=(0,uf.Z)(),i=(0,e6.useSelector)(eU.cM),a=(0,uv.r)(i),c=(null==t?void 0:t.utm_medium)==="svipgrowth"||(null==t?void 0:t.no_app)==="1",s=um("auto_pull")&&!(void 0!==n&&n)&&!c;return(0,cg.b)(function(){o&&s&&setTimeout(function(){return(0,uv.Z)(r,a)},400)}),null}),uT=n(45870),uE=(0,b.createContext)({request:function(e){}}),uy=function(e){return function(t){return cz()(function(n){return(0,m.tZ)(uC,{catcher:function(t){return e(t,n)},children:(0,m.tZ)(t,(0,G._)({},n))})},t)}};function uC(e){var t=e.catcher,n=e.children,r=(0,b.useContext)(uE),o=(0,uT._u)(),i=(0,uT.e2)(),a=(0,cL.A)(function(e){var n=(0,ef._)(t(e)||[],2),a=n[0],c=n[1];if("oiaWithTrack"===a)return o(c);if("openDeeplink"===a)return i(c);if("replaceLocation"===a){location.href=c.schema;return}return r.request(e)});return(0,m.tZ)(uE.Provider,{value:(0,b.useState)({request:a})[0],children:n})}var uS=(0,tM.P1)(eU.Hu,eU.Kv,function(e,t){var n=decodeURIComponent(t.split("?title=")[1]||"");return{isSearchSpecialSource:e&&t.includes("zhihu.com/search-special")&&!!n,searchSpecialTitle:n}}),uI=n(11264),uA=n(49910),ub=n(19821),uw=n(87038),uZ=n(27258),ux=n(91770),uk=n(78),uR=n(94226),uN=n(53159),uO=n(13901),uP=n(73739),uD=n(97345),uL=n(85661),uM=n(28814),uB=function(e,t){var n=t.urlToken||t.id,r=e.people.mutualsByUser[n]||{isDrained:!1,isFetching:!1,ids:[]};return{isDrained:r.isDrained,isFetching:r.isFetching,items:r.ids.map(function(t){var n=(0,uM.np)(e,{id:t});return n.code?null:n}).filter(Boolean)}},uU=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"render",value:function(){var e=this.props,t=e.items,n=e.author;return t&&t.length?(0,m.BX)("div",{className:"AuthorCard-item",children:[(0,m.tZ)("span",{className:"AuthorCard-item-icon",children:(0,m.tZ)(uP.l,{text:!0,center:!0})}),(0,m.tZ)("div",{className:"AuthorCard-item-value",children:(0,m.BX)(uD.CJKSpace,{children:[t.slice(0,3).map(function(e,t){return(0,m.BX)("span",{children:[0!==t&&"、",(0,m.tZ)(uL.Z,{user:e,noBadge:!0,noHoverCard:!0,children:e.name})]},e.urlToken)}),"也关注了",D.K_[n.gender]]})})]}):null}}]),n}(b.Component);(0,ed._)(uU,"propTypes",{author:iG().object.isRequired});var uG=(0,th.compose)((0,e6.connect)(function(e,t){var n=t.author;return(0,G._)({currentUser:(0,eB.ib)(e)},n&&uB(e,{urlToken:n.urlToken}))},{loadItems:ra.XD}),(0,sK.Z)({shouldLoad:function(e){return e.currentUser&&e.author&&e.author.urlToken&&e.currentUser.urlToken!==e.author.urlToken&&!e.isDrained},load:function(e){return e.loadItems(e.author.urlToken,"mutuals")}}))(uU),uF=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"componentDidMount",value:function(){this.nextItem()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.answer.author.urlToken!==e.answer.author.urlToken&&this.nextItem(e)}},{key:"componentDidUpdate",value:function(e){!e.user&&this.props.user&&this.props.onLoad&&this.props.onLoad()}},{key:"nextItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=e.answer.author.urlToken,n=e.loadProfile,r=e.isDrained;t&&(r||n({urlToken:t,shouldOmitBadgeTitle:!0}))}},{key:"render",value:function(){var e,t=this.props,n=t.user,r=t.isSelf;if(!n)return null;var o=n.urlToken,i=n.isOrg,a=n.headline,c=n.badge,s=n.badgeV2,u=n.answerCount,l=n.articlesCount,d=n.followerCount,p=(0,uN.a)(s,c),f=p.identity,h=p.bestAnswerer,_=p.baike,g=i?"org":"people";return(0,m.BX)(ub.ZP,{className:"AuthorCard",role:"complementary","aria-label":"关于作者",children:[(0,m.tZ)(ub.h4,{className:"AuthorCard-title",children:"关于作者"}),(0,m.tZ)(ub.$0,{children:(0,m.BX)("div",{className:"AuthorCard-user",children:[(0,m.tZ)("div",{className:"AuthorCard-user-avatar",children:(0,m.tZ)(uR.Z,{user:n,avatarProps:{size:60},noHoverCard:!0})}),(0,m.BX)("div",{className:"AuthorCard-user-content",children:[(0,m.tZ)("div",{className:"AuthorCard-user-name",children:(0,m.tZ)(uk.Z,{user:n,noBadge:!0,noHoverCard:!0})}),a&&(0,m.tZ)("div",{className:"AuthorCard-user-headline",children:(0,m.tZ)(uw.Z,{html:a})})]})]})}),(0,m.BX)(ub.$0,{children:[f&&(0,m.BX)("div",{className:"AuthorCard-item",children:[(0,m.tZ)("a",{className:"AuthorCard-item-icon",href:"https://zhuanlan.zhihu.com/p/96956163",target:"_blank",rel:"noreferrer",children:(0,m.tZ)(uA.xV,{center:!0,size:19})}),(0,m.tZ)("div",{className:"AuthorCard-item-value",children:f.slice(0,2).map(function(e){return e.description}).join("，")})]}),!!(null==h?void 0:null===(e=h.topics)||void 0===e?void 0:e.length)&&(0,m.BX)("div",{className:"AuthorCard-item",children:[(0,m.tZ)("span",{className:"AuthorCard-item-icon",children:(0,m.tZ)(uA.CG,{center:!0,size:19})}),(0,m.BX)("div",{children:[(0,m.tZ)(uZ.Z,{topics:h.topics,user:n,noHoverCard:!0}),"的优秀答主"]})]}),!!_&&(0,m.BX)("div",{className:"AuthorCard-item",children:[(0,m.tZ)("span",{className:"AuthorCard-item-icon",children:(0,m.tZ)(uA.Vs,{center:!0,size:19})}),(0,m.tZ)("div",{children:_.description})]}),n&&!r&&(0,m.tZ)(uG,{author:n})]}),o&&(0,m.BX)(ub.$0,{children:[(0,m.tZ)("div",{className:"AuthorCard-counts",children:(0,m.BX)(ux.Z,{children:[(0,m.tZ)(ux.Z.Item,{preset:"plain",href:"".concat(D.rX,"/").concat(g,"/").concat(o,"/answers"),name:"回答",value:u,"data-za-detail-view-element_name":"Answer"}),(0,m.tZ)(ux.Z.Item,{preset:"plain",href:"".concat(D.rX,"/").concat(g,"/").concat(o,"/posts"),name:"文章",value:l,"data-za-detail-view-element_name":"Post"}),(0,m.tZ)(ux.Z.Item,{preset:"plain",href:"".concat(D.rX,"/").concat(g,"/").concat(o,"/followers"),name:"关注者",value:d,"data-za-detail-view-element_name":"Follower"})]})}),!r&&(0,m.tZ)(uO.Z,{className:"AuthorCard-buttons",user:n})]})]})}}]),n}(b.Component),uH=(0,e6.connect)(function(e,t){var n=t.answer,r=n.author,o=n.author.urlToken,i=e.entities.users,a=o?i[o]:r;return{currentUser:(0,eB.ib)(e),isDrained:a&&void 0!==a.answerCount&&"undefined"!=typeof articlesCount&&"undefined"!=typeof followerCount&&void 0!==a.badge,user:a,isSelf:(0,eB.pG)(e,a)}},{loadProfile:ra.hr})(uF),uz=function(){var e=location.href,t=(0,T.tL)(e),n=t.utm_source,r=t.utm_medium;location.href="https://www.zhihu.com/oauth/redirect/login/wechat_mp?next=/oauth/account_callback&from=".concat(encodeURIComponent(e),"&utm_source=").concat(n,"&ref_source=").concat(r)},uq=function(){var e=(0,cy.n)(),t=(0,eU.dD)(),n=(0,e0.n)();return(0,cg.b)(function(){!e&&t&&(null==n?void 0:n.Wechat)&&.2>Math.random()&&(I.ZP.increment("mobile.autowechatlogin.count"),uz())}),null},uV=n(8858),uW=n(84344),uX=n(61255),uK=n(5975),uj=n(99365),uY=n(48933),uQ=n(38267),uJ=n.p+"assets/placeholder.0682898a.svg",u$=function(){return(0,m.tZ)(uQ.Z,{title:"该内容仅作者可见",subtitle:"",errorImage:uJ})},u0=n(97419),u1=n(9338),u2=n(30971),u3=n(36892),u4=n(82371),u5={HOT:"hot",NEW:"new",ACTIVITY:"activity"},u6={1:"#FF501A",2:"#F77932",3:"#FA9D14"},u7="#9196A1",u8={main:"OpenUrl",question:"OpenUrl",article:"OpenUrl",search:"Search",answer:"Search"},u9=function(e){var t,n=e.tag;if(!n)return null;var r=(t={},(0,ed._)(t,u5.HOT,{className:"HotSearchCard-tagHot",text:"热"}),(0,ed._)(t,u5.NEW,{className:"HotSearchCard-tagNew",text:"新"}),(0,ed._)(t,u5.ACTIVITY,{className:"HotSearchCard-tagActivity",text:"活动"}),t)[n];return r?(0,m.tZ)("span",{className:"HotSearchCard-tag ".concat(r.className),children:r.text}):null},le=function(e){var t=e.item,n=e.index,r=e.refreshKey,o=e.isRead,i=e.sceneType,a=e.onItemClick,c=(0,b.useCallback)(function(){a(t.id)},[t.id,a]),s=u6[t.rank]||u7,u=u8[i];return(0,m.BX)("div",{className:"HotSearchCard-item ".concat(o?"HotSearchCard-itemRead":""),children:[(0,m.tZ)("span",{className:"HotSearchCard-dot",style:{backgroundColor:s}}),(0,m.BX)(e7.ZAClick,{as:"a",className:"HotSearchCard-itemLink",href:t.searchUrl,target:"_blank",rel:"noopener noreferrer","data-za-not-track-link":!0,zaAction:u,zaType:"Text",zaText:t.query,zaModuleIndex:n,zaModuleId:"pc_hot_search",shouldTrackShow:!0,extra:{attachedInfoBytes:t.attachedInfo,configMap:{query:t.query}},onClick:c,children:[(0,m.tZ)("span",{className:"HotSearchCard-itemText",title:t.title,children:t.title}),(0,m.tZ)("span",{className:"HotSearchCard-heat",children:t.heat})]}),(0,m.tZ)(u9,{tag:t.tag})]},"".concat(r,"-").concat(n))},lt=["p/1989281404731807461"],ln=function(e){var t,n=e.sceneType,r=void 0===n?"search":n,o=e.contentType,i=e.contentToken,a="undefined"!=typeof window&&lt.some(function(e){return window.location.pathname.endsWith(e)}),c=(0,ef._)((0,b.useState)([]),2),s=c[0],u=c[1],l=(0,ef._)((0,b.useState)([]),2),d=l[0],p=l[1],f=(0,ef._)((0,b.useState)(0),2),h=f[0],_=f[1],g=(0,ef._)((0,b.useState)(new Set),2),T=g[0],E=g[1],y=(0,ef._)((0,b.useState)(!1),2),C=y[0],S=y[1],I=(0,ef._)((0,b.useState)(null),2),A=I[0],w=I[1],Z=(0,b.useCallback)((t=(0,u1._)(function(e){var t;return(0,u2.__generator)(this,function(n){switch(n.label){case 0:var a;return a=(0,u1._)(function(n){var a,c,s,l,d,f;return(0,u2.__generator)(this,function(h){switch(h.label){case 0:if(e.aborted)return[2];h.label=1;case 1:return h.trys.push([1,3,,6]),c=new URLSearchParams,o&&i&&(c.set("content_type",o),c.set("content_token",i)),s="/api/v4/search/hot_search".concat(c.toString()?"?".concat(c.toString()):""),[4,(0,u4.d)(s)];case 2:if(l=h.sent(),e.aborted)return[2];if((null==l?void 0:null===(a=l.hotSearchQueries)||void 0===a?void 0:a.length)>0)return f=Math.min(10,(d=l.hotSearchQueries.map(function(e){var t,n,o;return{id:e.query,rank:e.index+1,title:e.query,heat:e.hotShow,tag:e.label||"",searchUrl:e.redirectLink||(t=e.query,n=new URLSearchParams({q:t,search_source:"Trending",utm_content:"search_hot",utm_medium:"organic",utm_source:"zhihu",type:"content"}),o="/search?".concat(n.toString()),"article"===r?"https://www.zhihu.com".concat(o):o),attachedInfo:e.attachedInfo,query:e.query}})).length),u(d),p(d.slice(0,f)),_(0),[2];return u([]),p([]),[3,6];case 3:if(h.sent(),e.aborted)return[2];if(!(n<3))return[3,5];return[4,new Promise(function(e){return setTimeout(e,1e3)})];case 4:return h.sent(),[2,t(n+1)];case 5:return[3,6];case 6:return[2]}})}),[4,(t=function(e){return a.apply(this,arguments)})(0)];case 1:return n.sent(),[2]}})}),function(e){return t.apply(this,arguments)}),[r,o,i]),x=(0,cL.A)((0,u3.N)(function(){if(0!==s.length){null!==A&&clearTimeout(A),S(!0);var e=window.setTimeout(function(){S(!1),w(null)},300);w(e);var t=h+10>=s.length?0:h+10,n=Math.min(10,s.length-t);p(s.slice(t,t+n)),_(t)}},300)),k=(0,cL.A)(function(e){E(function(t){var n=new Set(t);return n.add(e),n})});return((0,cg.b)(function(){var e=new AbortController;return Z(e.signal),function(){e.abort()}}),(0,b.useEffect)(function(){return function(){null!==A&&clearTimeout(A)}},[A]),a||0===d.length)?null:(0,m.tZ)(e7.ZAEnv,{children:(0,m.BX)("div",{className:"HotSearchCard",children:[(0,m.tZ)("svg",{width:"0",height:"0",style:{position:"absolute"},children:(0,m.tZ)("defs",{children:(0,m.BX)("linearGradient",{id:"fire-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,m.tZ)("stop",{offset:"0%",stopColor:"#EA3B37"}),(0,m.tZ)("stop",{offset:"100%",stopColor:"#FF7878"})]})})}),(0,m.BX)("div",{className:"HotSearchCard-header",children:[(0,m.tZ)(a5.ZP,{size:18,fill:"url(#fire-gradient)"}),(0,m.tZ)("div",{className:"HotSearchCard-title",children:"大家都在搜"}),(0,m.BX)(e7.ZAClick,{as:"div",className:"HotSearchCard-change",onClick:x,role:"button",tabIndex:0,zaType:"Button",zaModuleId:"hot_search_refresh",children:[(0,m.tZ)(a7.Z,{size:16,fill:u7,style:{marginRight:6},className:C?"HotSearchCard-iconRotating":""}),"换一换"]})]}),(0,m.tZ)("div",{className:"HotSearchCard-list",children:d.map(function(e,t){return(0,m.tZ)(le,{item:e,index:t,refreshKey:h,isRead:T.has(e.id),sceneType:r,onItemClick:k},e.id)})})]})})},lr=n(99953),lo=n(92748),li=(0,m.tZ)(eJ.ql,{meta:[{name:"robots",content:"noindex"}]}),la=(0,th.compose)((0,aw.Z)(null))(function(e){var t=e.entity,n=void 0===t?{}:t,r=n.type,o=n.id,i=n.isCollapsed,a=n.suggestEdit,c=void 0===a?{}:a,s=n.adminClosedComment,u="";"question"===r?u=o:"answer"===r&&(u=n.question.id);var l=(0,e6.useSelector)(function(e){return(0,rd.Md)(e,{id:u})});if(l){var d=l.status,p=l.adminClosedComment,f=l.isMuted,h=l.visibleOnlyToAuthor;if((null==d?void 0:d.isClose)||(null==d?void 0:d.isSuggest)||(null==d?void 0:d.isEvaluate)||p||f||h)return li}return"question"===r&&l.redirection?(0,m.tZ)("link",{rel:"canonical",href:"https://www.zhihu.com/question/".concat(l.redirection.to.id)}):"answer"===r&&((null==c?void 0:c.status)||i||s)||"article"===r&&((null==c?void 0:c.status)||s)?li:""}),lc=n(76536),ls=n(92525),lu=n(69755),ll=function(){var e=(0,ef._)((0,b.useState)(!1),2),t=e[0],n=e[1];return(0,b.useEffect)(function(){n(!0)},[]),t},ld=function(e){return"calc(".concat(e,"px + 2em)")},lp=function(){var e=ll();return(0,m.BX)(m.HY,{children:[(0,m.tZ)(e4.xB,{styles:{html:{scrollPaddingTop:ld(D.BR),scrollPaddingBottom:56}}}),e&&(0,m.tZ)(c0.Z,{children:(0,m.tZ)("div",{id:"_scroll-padding-polyfill_",style:{position:"fixed",top:0,left:0,right:0,pointerEvents:"none",background:"transparent",height:ld(D.BR+56)}})})]})},lf=(0,b.forwardRef)(function(e,t){var n=e.children,r=(0,ef._)((0,cv.k)(),2),o=r[0],i=r[1],a=(0,ef._)((0,cv.k)(),2),c=a[0],s=a[1],u=(0,b.useRef)(!0),l=(0,e6.useSelector)(function(e){return e.env.vars.isPageHeaderDisabled});(0,b.useImperativeHandle)(t,function(){return{disableScrollDirection:function(){u.current=!1},enableScrollDirection:function(){u.current=!0}}});var d=(0,b.useRef)({on:(0,cL.A)(function(){return!l&&s.on()}),off:(0,cL.A)(function(){return!l&&s.off()})}).current,p=(0,lu.M)().scrollY,f=(0,ef._)((0,b.useState)(),2),h=f[0],_=f[1];return(0,cg.b)(function(){return p.onChange(function(){u.current&&(p.getPrevious()>p.get()?_("up"):_("down"))})}),(0,b.useEffect)(function(){o?d.on():d.off()},[o,d]),(0,b.useEffect)(function(){o&&("down"===h?d.on():"up"===h&&d.off())},[o,h,d]),(0,m.BX)(m.HY,{children:[(0,m.tZ)(lp,{}),(0,m.tZ)(aA.yW,{input:"/",action:d.off}),(0,m.tZ)(ls.Z,{top:D.BR,onStickyChange:function(e){e?i.on():i.off()},children:null}),(0,m.tZ)(iz.Z.Inlet,{shown:c,children:(0,m.tZ)("div",{className:i$()("PageHeader",{"is-shown":c}),css:(0,G._)({},{".AppHeader-profileMenu, .AppHeader-zhihuLogo":{display:"none"}}),children:n})})]})}),lh=n(53030),l_=n(3707),lm=n(80565),lv=n(94382),lg=(0,b.memo)(function(e){var t=e.members,n=e.maxLength,r=e.size,o=void 0===r?20:r,i=t.slice(0,n);return(0,m.tZ)(i0.kC,{alignItems:"center",css:function(e){return{".UserLink":{borderRadius:"50%",border:"2px solid ".concat(e.colors.GBK99B),"&:nth-of-type(1)":{zIndex:1},"&:nth-of-type(n+2)":{marginLeft:-10}}}},children:i.map(function(e){return(0,m.tZ)(uL.Z,{user:e,avatar:!0,avatarProps:{size:o,round:!0}},e.id)})})});function lT(e){var t=e.members,n=e.hasMultiProposer;return(0,m.BX)(i0.kC,{alignItems:"center",children:[n?(0,m.tZ)(lg,{members:t,maxLength:2}):(0,m.tZ)(uL.Z,{user:t[0],avatar:!0,avatarProps:{size:20,round:!0}}),(0,m.BX)(i0.kC,{ml:"8px",fontSize:15,lineHeight:"20px",color:"GBK05A",children:[(0,m.tZ)(uL.Z,{user:t[0],css:{".UserLink-link":(0,G._)({maxWidth:90},(0,lm.S)(1))}}),n&&"等 ".concat(t.length," 人")]})]})}var lE=function(e){var t=e.children,n=e.extraStyle,r=(0,F._)(e,["children","extraStyle"]);return(0,m.tZ)(aC.ZP,(0,er._)((0,G._)({},r),{css:{"&.Button":(0,G._)({fontSize:15,padding:0},n)},children:t}))},ly={invite:{requestText:"转载",cardShowId:8931,clickId:8932},self_recommend:{requestText:"推荐",cardShowId:8957,clickId:8958}},lC=(0,iZ.withRouter)(function(e){var t=(0,ef._)((0,b.useState)(!0),2),n=t[0],r=t[1],o=(0,e6.useDispatch)(),i=e.entityType,a=e.id,c=e.isAuthor,s=e.onShowAllRequests,u="1"===e.location.query.has_contribution_apply;(0,b.useEffect)(function(){(c||u)&&o((0,rh.$T)(a))},[o,u,a,c]);var l=c?"invite":"self_recommend",d=(0,e6.useSelector)(function(e){return(0,rh.bG)(e,{isAuthor:c,requestType:l,entityType:"article"})}),p=ly[l],f=p.cardShowId,h=p.clickId,_=p.requestText,g=d.map(function(e){return e.proposer}),T=g.length>1,E=c?"申请转载此文章到".concat(T?"他们的":"","专栏"):"申请推荐此文章到你的专栏",y=function(e,t){var n="approve"===t?"通过":"拒绝";aq.Z.trackEvent(e.target,{id:h,action:"Click",element:"Button"},{button:{text:n}}),o((0,rh.gT)({requestId:d[0].id,action:t,articleId:a})).then(function(){o((0,t1.c0)("已".concat(n).concat(_,"申请"))),r(!1)})};return n&&(null==d?void 0:d[0])?(0,m.tZ)(ud.r,{trackCardShow:!0,module:"Content",moduleName:c?T?"多人申请":"单人申请":"推荐申请处理",view:{id:f,element:"Dialog"},extra:{button:{text:"".concat(_,"申请处理")}},children:(0,m.BX)(i0.kC,{justifyContent:"space-between",width:600,height:48,p:"12px",bg:"GBK99A",css:{position:"fixed",top:68,left:"50%",transform:"translateX(-50%)",borderRadius:8,boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.1)"},children:[(0,m.BX)(i0.kC,{flex:1,children:[(0,m.tZ)(lT,{members:g,hasMultiProposer:T}),(0,m.BX)(i0.kC,{my:"8px",fontSize:15,lineHeight:1.4,alignItems:"center",color:"GBK02A",children:[(0,m.tZ)(i0.xv,{ml:"8px",flexShrink:0,children:E}),!T&&(0,m.tZ)(i0.rU,{flex:1,ml:"4px",fontWeight:"bold",color:"GBL05A",href:"https://www.zhihu.com/column/".concat(d[0].destination.id),css:[(0,lm.S)(1)],children:(0,m.tZ)(lv.Z,{column:d[0].destination})})]})]}),(0,m.BX)(i0.kC,{ml:"10px",flexShrink:0,alignItems:"center",children:[(0,m.tZ)(i0.kC,{fontSize:15,fontWeight:"bold",lineHeight:1.4,alignItems:"center",children:T?(0,m.tZ)(i0.rU,{"data-za-not-track-link":!0,onClick:function(e){aq.Z.trackEvent(e.target,{id:h,action:"Click",element:"Button"},{button:{text:"ViewAll"}}),s({id:a,entityType:i}),r(!1)},children:(0,m.tZ)(lE,{preset:"plain",color:"blue",children:"查看详情"})}):(0,m.BX)(m.HY,{children:[(0,m.tZ)(lE,{preset:"plain",color:"blue",onClick:function(e){return y(e,"approve")},children:"通过"}),(0,m.tZ)(lE,{preset:"plain",color:"grey",extraStyle:{marginLeft:22},onClick:function(e){return y(e,"reject")},children:"拒绝"})]})}),(0,m.tZ)(i0.xv,{ml:"24px",as:aV.HN,color:"GBK07A",size:16,onClick:function(){r(!1)}})]})]})}):null}),lS={article:{text:"转载",subtitle:"他人申请将你的文章转载至他的专栏",description:"申请转载文章到专栏",zaInfo:{pageShowId:8935,profileEntryCardShowId:8933,profileEntryClickId:8934,listModalCardShowId:8937,listModalClickId:8938}},column:{text:"推荐",subtitle:"他人推荐他们的文章到你的专栏",description:"申请推荐文章到你的专栏",zaInfo:{pageShowId:8961,profileEntryCardShowId:8959,profileEntryClickId:8960,listModalCardShowId:8962,listModalClickId:8963}}},lI={answer:"Answer",article:"Post"},lA=n(58245);function lb(e){var t=e.request,n=e.description,r=e.cardShowId,o=e.clickId,i=(0,e6.useDispatch)(),a=(0,ef._)((0,b.useState)(""),2),c=a[0],s=a[1],u=t.id,l=t.destination,d=t.destination.id,p=t.object,f=p.id,h=p.type,_=p.title,g=p.imageUrl,T=p.voteupCount,E=void 0===T?0:T,y=p.commentCount,C=void 0===y?0:y,S=t.proposer,I=t.created,A=t.updated,w=t.state,Z=function(e,t){var n="approve"===t?"通过":"拒绝";aq.Z.trackEvent(e.target,{id:o,action:"Click",element:"Button"},{button:{text:n}}),i((0,rh.gT)({requestId:u,action:t,articleId:f})).then(function(){s("已".concat(n))})};return c||"pending"===w?(0,m.tZ)(ud.r,{trackCardShow:!0,view:{id:r,element:"Card"},module:"Content",content:{type:lI[h],token:String(f),parent_token:String(d)},children:(0,m.BX)(i0.xu,{p:"16px",mb:"16px",bg:"GBK99A",css:function(e){return(0,G._)({},(0,lA.M)({border:"1px solid ".concat(e.colors.GBK08A),borderRadius:8}))},children:[(0,m.BX)(i0.kC,{alignItems:"center",children:[(0,m.BX)(i0.kC,{alignItems:"center",children:[(0,m.tZ)(uL.Z,{user:S,avatar:!0,avatarProps:{size:20,round:!0},css:{lineHeight:1}}),(0,m.tZ)(i0.xv,{ml:"8px",flex:1,fontSize:15,color:"GBK06A",children:(0,m.tZ)(uL.Z,{user:S,css:{".UserLink-link":(0,G._)({maxWidth:90},(0,lm.S)(1))}})})]}),(0,m.BX)(i0.kC,{ml:"8px",my:"8px",fontSize:15,lineHeight:1.4,alignItems:"center",color:"GBK02A",children:[(0,m.tZ)(i0.xv,{flexShrink:0,children:n}),(0,m.tZ)(i0.xv,{flex:1,ml:"4px",fontWeight:"bold",color:"GBL05A",css:[(0,lm.S)(1)],children:(0,m.tZ)(lv.Z,{column:l})})]})]}),(0,m.BX)(i0.kC,{p:"10px 12px",height:60,bg:"GBK10A",css:{borderRadius:4},children:[(0,m.BX)(i0.rU,{href:"https://zhuanlan.zhihu.com/p/".concat(f),flex:1,css:[(0,lm.S)(1)],children:[(0,m.tZ)(i0.xv,{fontSize:14,lineHeight:"20px",color:"GBK03A",children:_}),(0,m.tZ)(i0.xv,{mt:"4px",fontSize:12,lineHeight:"14px",color:"GBK07A",children:"".concat((0,s1.Zh)(E),"赞同 \xb7 ").concat((0,s1.Zh)(C),"评论")})]}),g&&(0,m.tZ)(i0.xu,{width:40,height:40,flexShrink:0,css:{overflow:"hidden",borderRadius:2},children:(0,m.tZ)(i0.Ee,{width:"100%",height:"100%",src:g,alt:"",css:{filter:"brightness(0.95)",objectFit:"cover"}})})]}),(0,m.BX)(i0.kC,{mt:"16px",pr:"4px",lineHeight:"21px",justifyContent:"space-between",alignItems:"center",children:[(0,m.tZ)(i0.xv,{fontSize:12,color:"GBK07A",children:(0,rw.rL)(A||I)}),c?(0,m.tZ)(i0.xv,{fontSize:15,fontWeight:"bold",color:"GBK08A",children:c}):(0,m.BX)(i0.kC,{fontSize:15,fontWeight:"bold",justifyContent:"space-between",children:[(0,m.tZ)(aC.ZP,{preset:"plain",color:"grey",css:{padding:0},onClick:function(e){return Z(e,"reject")},children:"拒绝"}),(0,m.tZ)(aC.ZP,{preset:"plain",color:"blue",css:{marginLeft:24},onClick:function(e){return Z(e,"approve")},children:"通过"})]})]})]})}):null}function lw(e){var t,n=e.isAuthor,r=e.isProfile,o=e.republishRequests,i=e.onClose,a=o||{},c=a.id,s=a.entityType,u=a.requestType,l=(0,e6.useDispatch)(),d=function(){r?l((0,rh.Jg)(c,s)):l((0,rh.$T)(c))};(0,b.useEffect)(d,[c,s,r,l]);var p=(0,e6.useSelector)(function(e){return(0,rh.bG)(e,{isAuthor:n,isProfile:r,entityType:s,requestType:u})}),f=(0,e6.useSelector)(function(e){return e.republish[s]}),h=f.isLoading,_=f.paging,g=lS[s],T=g.text,E=g.subtitle,y=g.description,C=g.zaInfo,S=C.pageShowId,I=C.listModalCardShowId,A=C.listModalClickId,w=null!==(t=null==_?void 0:_.isEnd)&&void 0!==t?t:!r;return((0,b.useEffect)(function(){aq.Z.trackPageShow({id:S})},[]),o)?(0,m.tZ)(i0.xu,{children:(0,m.tZ)(sc.Z,{size:"large",onClose:function(){d(),i()},title:"文章".concat(T,"申请"),subtitle:E,children:(0,m.tZ)(i0.xu,{my:"24px",maxHeight:460,css:{overflowY:"scroll","&::-webkit-scrollbar":{display:"none"}},children:(0,m.tZ)(sJ.ZP,{onLoad:d,isLoading:null!=h&&h,isDrained:w,getContainer:function(e){return e.parentElement},children:p.map(function(e){return(0,m.tZ)(lb,{request:e,description:y,cardShowId:I,clickId:A},e.id)})})})})}):null}function lZ(e){var t=e.id,n=e.selfRecommendedRepublishRequests,r=(0,e6.useDispatch)(),o=(0,ef._)((0,b.useState)(!1),2),i=o[0],a=o[1],c=(0,b.useMemo)(function(){return n.map(function(e){var t=e.approver,n=e.destination;return"「".concat(t.name,"」的专栏「").concat(n.title,"」")}).join("、")},[n]);return(0,m.BX)(ud.r,{view:{id:8964,element:"Text"},trackCardShow:!0,extra:{button:{text:"撤销推荐"}},children:[(0,m.BX)(i0.xv,{as:"span",children:["\xa0\xb7\xa0",(0,m.tZ)(i0.xv,{as:"span",color:"GBL01A",css:{cursor:"pointer"},onClick:function(e){e.stopPropagation(),a(!0),aq.Z.trackEvent(e.target,{id:8965,action:"Click",element:"Text"},{button:{text:"撤销推荐"}})},children:"撤销推荐"})]}),(0,m.tZ)(sc.Z,{className:"VerificationForm-allowUseCreatorModal",title:"要撤销推荐吗？",closeButton:null,maskClosable:!1,children:i&&(0,m.BX)(m.HY,{children:[(0,m.tZ)("span",{children:"当前文章被推荐到".concat(c,"，要撤销吗？")}),(0,m.BX)(sc.w,{direction:"horizontal",children:[(0,m.tZ)(aC.ZP,{onClick:function(){return a(!1)},children:"暂不撤销"}),(0,m.tZ)(aC.ZP,{preset:"primary",color:"blue",onClick:function(){aq.Z.trackEvent(null,{id:8966,action:"Cancel",element:"Button"},{button:{text:"撤销推荐"}}),Promise.all(n.map(function(e){return r((0,rh.gT)({requestId:e.id,action:"cancel",articleId:t}))})).then(function(){r((0,t1.c0)("撤销成功"))}),a(!1)},children:"撤销推荐"})]})]})})]})}var lx=n(45684),lk=n(79065),lR=n(82806),lN=n.n(lR),lO=n(37630),lP=n(45790);function lD(){var e=(0,lk._)(["编辑于",""]);return lD=function(){return e},e}function lL(){var e=(0,lk._)(["发布于",""]);return lL=function(){return e},e}var lM=function(e){var t=e.created,n=e.updated,r=e.ipInfo,o=e.extraInlineComponent,i=e.contentSourceText,a=e.isContainAiContent,c=(0,ef._)((0,cv.k)(!0),2),s=c[0],u=c[1];return(0,m.BX)("div",{role:"button",tabIndex:0,className:"ContentItem-time",onClick:u.toggle,children:[(0,m.BX)(lP.x,{children:[s&&n!==t?lN()(lD(),(0,rw.KZ)(n)):lN()(lL(),(0,rw.KZ)(t)),r,i,a&&lO.b]}),o]})},lB=n(36225),lU="SearchSpecialButton",lG=function(e){var t=e.title,n=e.className;(0,b.useEffect)(function(){aq.Z.trackCardShow(null,{id:8107},{button:{text:t}})},[t]);var r=(0,b.useCallback)(function(){aq.Z.trackEvent(null,{id:8108,action:"OpenUrl"},{button:{text:t}});var e=(0,ey.stringify)({type:"content",q:t});location.href="//www.zhihu.com/search?".concat(e)},[t]);return(0,m.tZ)(ub.ZP,{className:i$()(lU,n),children:(0,m.BX)(aC.ZP,{className:"".concat(lU,"-inner"),preset:"primary",color:"blue",onClick:r,children:["查看更多「",t,"」相关内容"]})})},lF=n(68491),lH=n(82311),lz=n(17103),lq=n(71833),lV=function(e){var t=e.stickyAfterScrollPT,n=void 0!==t&&t,r=e.scrollPaddingTop,o=void 0===r?10:r,i=e.scrollPaddingBottom,a=void 0===i?10:i,c=e.className,s=e.children,u=(0,ef._)((0,iQ.h)(),2),l=u[0],d=u[1],p=(0,b.useRef)(null),f=(0,lz.q)(l,p),h=(0,b.useRef)(null),_=(0,lq.n)(),g=(0,ef._)((0,b.useState)(o),2),T=g[0],E=g[1],y=(0,lu.M)().scrollY,C=(0,ef._)((0,b.useState)({position:"sticky",top:T}),2),S=C[0],I=C[1],A=(0,b.useRef)(S.position);return(0,b.useEffect)(function(){if(d&&_){var e=_.height;d.height+o<e?E(o):E(e-d.height-a)}},[d,_,o,a]),(0,b.useEffect)(function(){A.current=S.position},[S.position]),(0,b.useEffect)(function(){var e,t,r=p.current,i=h.current;if(r&&i)return y.onChange(function(c){if(void 0===e){e=c;return}var s=r.getBoundingClientRect();if(n){if(s.top>o){I({position:"relative"});return}var u,l,d="relative"===A.current;I({position:"sticky",top:o,overflow:"auto",maxHeight:((null==_?void 0:_.height)||window.innerHeight)-o-a}),d&&(null==p||null===(u=p.current)||void 0===u||null===(l=u.scrollTo)||void 0===l||l.call(u,{top:0,behavior:"smooth"}));return}var f=c>e,h=(c>e?"down":"up")!==t;t=f?"down":"up",e=c;var m=i.getBoundingClientRect().top-document.documentElement.getBoundingClientRect().top,g=s.bottom-window.innerHeight-a<=0,E=s.top>=o;E&&g?I({position:"sticky",top:T}):h?I({position:"relative",top:c+s.top-m}):f?g&&I({position:"sticky",top:T}):E&&I({position:"sticky",top:o})})},[y,T,o,a,n,_]),(0,m.BX)(m.HY,{children:[(0,m.tZ)("div",{ref:h}),(0,m.tZ)("div",{className:c,ref:f,style:S,children:s})]})};function lW(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0;if(!e.matches("a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]")){e.tabIndex=-1;var o=function(){e.removeAttribute("tabindex"),e.removeEventListener("blur",o)};e.addEventListener("blur",o)}e.focus({preventScroll:!0}),n||(t=e.getBoundingClientRect().top+window.pageYOffset-(null!=r?r:Math.max(window.innerHeight/10,100)),window.scrollTo({top:t,behavior:"smooth"}))}var lX=function(e){var t,n=e.selector,r=e.sidebarRoot,o=(0,b.useRef)(null),i=(t=(0,u1._)(function(){var e,t,i,a;return(0,u2.__generator)(this,function(c){switch(c.label){case 0:if(e=r.current,i=!!(t=o.current),!e)return[3,3];if(!t)return[3,2];return[4,(0,a_.zT)(t,{block:"start",behavior:"smooth"})];case 1:c.sent(),c.label=2;case 2:n?(a=e.querySelector(n))&&lW(a,i):lW(e,i),c.label=3;case 3:return[2]}})}),function(){return t.apply(this,arguments)});return(0,m.BX)(m.HY,{children:[(0,m.tZ)(tr,{ref:o,offset:-50,"aria-label":"边栏锚点","aria-keyshortcuts":"Shift+S"}),(0,m.tZ)(sn.y,{input:"shift+s",action:i})]})},lK=function(e){var t=e.children,n=e.smartStickyProps,r=void 0===n?{}:n,o=(0,F._)(e,["children","smartStickyProps"]),i=(0,b.useRef)(null);return(0,m.BX)("div",(0,er._)((0,G._)({ref:i,css:{maxWidth:296,alignSelf:"normal"}},o),{children:[(0,m.tZ)(lX,{sidebarRoot:i,selector:".Card,.jsFirstFocusable"}),(0,m.tZ)(lV,(0,er._)((0,G._)({scrollPaddingTop:D.BR+10},r),{children:t}))]}))},lj=n(68014),lY=n(57177),lQ=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.noHoverCard,r=e.onClick;return(0,m.tZ)(lj.Z,{className:"Topic",children:(0,m.tZ)(lY.Z,{noHoverCard:n||P.Z.isMobileEntry,topic:t,onClick:r})})}}]),n}(b.Component),lJ=(0,ud.a)(function(e){return{module:"TopicItem",content:{type:"Topic",token:e.item.id},trackCardShow:!0}})(lQ),l$=function(e){var t=e.topics,n=e.className,r=e.noHoverCard,o=e.onItemClick;return(0,m.tZ)("div",{className:i$()("TopicList",n),children:t.map(function(e){return(0,m.tZ)(lJ,{item:e,noHoverCard:r,onClick:o},e.id)})})},l0=n(97285),l1=n(81897),l2=n.n(l1),l3=function(){!(!navigator.cookieEnabled||l2().get("social_id"))&&(l2().get("WECHAT_AUTHORIZATION_POPUP")||(l2().set("WECHAT_AUTHORIZATION_POPUP","1",{expires:1,domain:"zhihu.com"}),window.location.replace("https://www.zhihu.com/oauth/redirect/social_info/wechat_mp?from=".concat(encodeURIComponent(location.href)))))};function l4(e){var t=e.zaShareId;return(0,cg.b)(function(){window.wx&&window.wx.ready(function(){l3(),function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4408,r=(e=l2().get("social_id"),{firstShareUid:(t=new URLSearchParams(location.search)).get("utm_oi"),shareSocialId:t.get("s_s_i"),shareRecord:t.get("s_r"),curUserSocialId:e}),o=r.firstShareUid,i=r.shareSocialId,a=r.shareRecord,c=r.curUserSocialId;c&&0!==Number(a)&&(i||o)&&aq.Z.trackEvent(null,{id:n,action:"Share"},{share:{share_uid:o,share_unionid:i,open_unionid:c}})}(t)})}),null}function l5(){var e=l2().get("social_id");return e?{s_s_i:e,s_r:1}:{s_r:0}}var l6=n(65033),l7=n(60490),l8=n(91269),l9=n(68680),de=n(1785),dt=n(59937);function dn(e){(!e||Date.now()-1e3*e>6e4)&&(0,R.v)("https://zz.bdstatic.com/linksubmit/push.js",{crossOrigin:void 0})}var dr=function(e){var t=e.router,n=e.location,r=n.query,o=r.HL,i=(0,F._)(r,["HL"]);if(o)try{var a,c=document.querySelector("#".concat(o));if(!c)return;setTimeout(function(){t.replace((0,er._)((0,G._)({},n),{query:i,hash:"#".concat(o)}))},0);var s=null===(a=c.getBoundingClientRect())||void 0===a?void 0:a.top;if(!s)return;var u=window.pageYOffset||0,l=Math.max(window.innerHeight/10,100);window.scrollTo({top:u+s-l})}catch(e){var d,p,f,h="locatePageByID";null===(d=window.webReporter)||void 0===d||d.report(h,{type:h,appName:"heifetz",error:{name:null!==(p=null==e?void 0:e.name)&&void 0!==p?p:"Unknown",message:null!==(f=null==e?void 0:e.message)&&void 0!==f?f:"Unknown"}})}},di=n(77878),da=n(22566),dc=n(78970),ds=n.p+"assets/wechat-share-image.0393e0b7.png",du=n(49048),dl=n(74723),dd=n(88257),dp=n(77683),df=n(46829),dh=n(258),d_=n(96717),dm=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"zaRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"openInApp",function(){(0,dh.Z)({trackEvent:e.zaRef.current.trackEvent,zaV3Text:"关注用户",from:"authorpage"})}),(0,ed._)((0,iD._)(e),"openLogin",function(){location.assign("https://www.zhihu.com/signin?next=".concat(encodeURIComponent(location.href)))}),(0,ed._)((0,iD._)(e),"handleFollowButtonClick",function(t){var n=e.props,r=n.followOpenInApp,o=n.author,i=n.isMobile,a=n.currentUser,c=n.onToggleFollow,s=o.isFollowing?"UnFollow":"Follow";return((0,d_.E)(t,{id:1285,action:s}),null==c||c(!o.isFollowing),r&&i)?e.openInApp():!!a||e.openLogin()}),e}return(0,U._)(n,[{key:"render",value:function(){var e=this.props,t=e.author,n=e.isAuthor,r=e.isMobile,o=e.currentUser;return(0,m.BX)(e7.ZAEnv,{content:{type:"User",token:t.urlToken,id:t.urlToken},children:[(0,m.tZ)(e7.ZARef,{ref:this.zaRef}),(0,m.BX)("div",{className:i$()("Post-Author",{"Post-Author-Mobile":r}),children:[(0,m.tZ)(dp.Z,{author:t,roundAvatar:!0,avatarSize:r?34:38,userLinkV2:!0}),!n&&(!!o||r)&&(0,m.tZ)(df.Z,{preset:"primary",type:t.type,id:t.urlToken,gender:!r&&t.gender,isFollowing:t.isFollowing,onClick:this.handleFollowButtonClick})]})]})}}]),n}(b.Component);(0,ed._)(dm,"propTypes",{author:iG().object.isRequired,postId:iG().string.isRequired,isAuthor:iG().bool,followOpenInApp:iG().bool});var dv=(0,th.compose)((0,uf.$)(),ab.Z)(dm),dg=n(75106),dT=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"state",{showAllReviewers:!1,modalShown:!1,reviewersChangeLine:!1}),(0,ed._)((0,iD._)(e),"handleListHide",function(){return e.setState({modalShown:!1})}),(0,ed._)((0,iD._)(e),"handleListShown",function(){return e.setState({modalShown:!0})}),(0,ed._)((0,iD._)(e),"handleShowAllReviewers",function(){var t=e.props.isAuthor;e.state.showAllReviewers||e.setState({showAllReviewers:!0}),t&&e.setState({showReviewComment:!0}),e.handleListShown()}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){var e=document.querySelector(".TopicList").offsetHeight;this.handleReviewersChangeLine(e>=45)}},{key:"handleReviewersChangeLine",value:function(e){this.setState({reviewersChangeLine:e})}},{key:"render",value:function(){var e=this.props,t=e.reviewers,n=e.type,r=e.isAuthor,o=this.state,i=o.showAllReviewers,a=o.reviewersChangeLine,c=o.modalShown,s=t.slice(0,i?t.length:4).map(function(e,n){var r;return n!==t.length-1&&0>e.name.indexOf("、")&&(r=(0,m.tZ)("span",{children:"、"})),(0,m.BX)("div",{className:"PostIndex-reviewers-userlink-wrapper",children:[(0,m.tZ)(uL.Z,{className:"PostIndex-reviewerLink",blank:!0,user:e},e.id),r]},n)});return(0,m.BX)("div",{className:i$()("PostIndex-reviewers",{"PostIndex-reviewers-left":a}),children:[s,!!t.length&&(0,m.tZ)(aC.ZP,{preset:"plain",className:i$()("PostIndex-showReviewerButton",(t.length>4||r)&&"is-clickable"),onClick:this.handleShowAllReviewers,children:t.length>4&&!i?"等".concat(t.length,"人亦有帮助"):"亦有帮助"}),(0,m.tZ)(tf.Z,{size:"fullPage",onClose:this.handleListHide,children:c&&(0,m.tZ)(dg.Z,{voteupCount:t.length,items:t,isDrained:!1,isFetching:!1,type:n,onLoad:function(){},text:"亦有帮助"})})]})}}]),n}(b.Component);(0,ed._)(dT,"propTypes",{reviewers:iG().array.isRequired,type:iG().string,isAuthor:iG().bool.isRequired});var dE=n(66011),dy=n(24340),dC=n(89774),dS=function(e){return(0,m.tZ)(i0.xu,(0,G._)({mx:"auto"},e))};function dI(e){var t=e.fullScreen,n=e.src,r=e.width,o=e.height,i=e.alt,a=e.useImageX,c=e.className,s=(0,uf.Z)(),u=(0,dC.Z)(),l="1"===(0,e2.c)("article_title_imagex",{mock:"1"}),d=!s&&a&&(l||u);return t?d?(0,m.tZ)(dS,{children:(0,m.tZ)(dy.Z,{ratio:3,children:(0,m.tZ)(dE.MQ,{src:n,alt:i,width:"100%",height:"100%",css:{objectFit:"cover"},layout:"fill"})})}):(0,m.tZ)(dS,{children:(0,m.tZ)(dy.Z,{ratio:3,children:(0,m.tZ)("img",{src:n,alt:i,width:"100%",height:"100%",css:{objectFit:"cover"}})})}):(0,m.tZ)(dS,{maxWidth:690,mt:[0,"1em"],className:c,children:r>0&&o>0?(0,m.tZ)(dy.Z,{ratio:r/o,children:d?(0,m.tZ)(dE.MQ,{src:n,alt:i,width:"100%",layout:"responsive"}):(0,m.tZ)(dE.G6,{src:n,alt:i,width:"100%",height:"100%"})}):d?(0,m.tZ)(dE.MQ,{src:n,layout:"raw",width:"100%",alt:i}):(0,m.tZ)(dE.G6,{src:n,alt:i,width:"100%"})})}var dA=16/9;function db(e){var t=e.src,n=e.width,r=e.height,o=e.alt,i=e.className;return n>0&&r>0?(0,m.tZ)(dy.Z,{ratio:n/r<=16/9?dA:2.5,className:i,children:(0,m.tZ)(dE.MQ,{src:t,alt:o,width:"100%",layout:"responsive",objectFit:"cover"})}):(0,m.tZ)(dE.MQ,{className:i,src:t,layout:"raw",width:"100%",alt:o})}var dw=n(21060),dZ=n(13630),dx=n(35865);function dk(e){var t=e.id,n=e.shown,r=e.onClose,o=(0,ef._)((0,b.useState)(!1),2),i=o[0],a=o[1],c=(0,ef._)((0,b.useState)(!1),2),s=c[0],u=c[1],l=(0,ef._)((0,b.useState)(""),2),d=l[0],p=l[1],f=(0,e6.useDispatch)(),h=(0,b.useRef)([]).current,_=(0,e6.useSelector)(function(e){return e.me.columnContributions.filter(function(t){var n;return"normal"===t.columnType&&(null===(n=t.author)||void 0===n?void 0:n.urlToken)===e.currentUser})})||h,g=function(){f((0,eB.Pq)()).finally(function(){0===_.length&&r()})},T=function(){p(""),r()};return((0,b.useEffect)(function(){u(0===_.length)},[_]),n)?(0,m.BX)("div",{children:[(0,m.tZ)(sc.Z,{size:"large",onClose:T,title:"申请转载到我的专栏",subtitle:"选择一个专栏，向作者发送文章转载申请",children:_.length>0&&(0,m.tZ)(ud.r,{view:{id:8929,element:"Dialog"},extra:{button:{text:"申请转载到我的专栏"}},module:"Content",card:{content:{type:"Column",token:String(d)}},trackCardShow:!0,children:(0,m.BX)("div",{children:[(0,m.tZ)(i0.xu,{maxHeight:460,css:{overflowY:"scroll","&::-webkit-scrollbar":{display:"none"}},children:_.map(function(e,t){return(0,m.BX)(i0.kC,{px:"8px",py:"16px",alignItems:"center",justifyContent:"space-between",as:"label",htmlFor:"RepublishApply-columnItem-".concat(t),css:function(e){return{borderBottom:"1px solid ".concat(e.colors.GBK10A)}},children:[(0,m.BX)(i0.xu,{flex:1,children:[(0,m.tZ)(i0.xv,{fontSize:18,fontWeight:"bold",color:"GBK02A",lineHeight:"22px",css:[(0,lm.S)(1)],children:e.title}),(0,m.BX)(i0.xv,{mt:"12px",fontSize:14,lineHeight:1,color:"GBL05A",children:[e.articlesCount||0," 篇内容 \xb7"," ",e.voteupCount||0," 赞同"]})]}),(0,m.tZ)(i0.xu,{flexShrink:0,as:"input",type:"radio",name:"RepublishApply-columnInput",id:"RepublishApply-columnItem-".concat(t),checked:e.id===d,onChange:function(){return p(e.id)}})]},e.id)})}),(0,m.tZ)(tf.w,{children:(0,m.tZ)(aC.ZP,{disabled:!d,preset:"primary",color:"blue",onClick:function(e){aq.Z.trackEvent(e.target,{id:8930,action:"Click",element:"Button"},{button:{text:"申请转载"}}),f((0,rh.gT)({action:"create",articleId:t,columnId:d})).then(function(){f((0,t1.c0)("已发送转载申请！"))}).finally(T)},children:"申请转载"})})]})})}),(0,m.tZ)(sc.Z,{onClose:r,title:"要创建专栏吗？",children:s&&(0,m.BX)("div",{children:["你还没有可以用来转载文章的专栏，要创建专栏吗？",(0,m.BX)(tf.w,{direction:"horizontal",children:[(0,m.tZ)(aC.ZP,{onClick:r,children:"取消"}),(0,m.tZ)(aC.ZP,{preset:"primary",color:"blue",onClick:function(){u(!1),a(!0)},children:"创建专栏"})]})]})}),(0,m.tZ)(dx.Z,{onClose:function(){a(!1),g()},shown:i,disableRedirect:!0})]}):null}var dR=n(54843),dN=n(75981),dO=n(66152),dP=n(79821),dD=n(68051),dL=n(8693),dM=n(19495),dB=n(42367),dU=n(63362),dG=n(24794),dF=n(69183),dH=n(11233),dz=n(26974);function dq(e){var t=e.onClick,n=(0,F._)(e,["onClick"]);return(0,m.tZ)(aC.ZP,(0,G._)({preset:"plain",onClick:t,icon:dR.h,label:"申请转载"},n))}var dV=n(882),dW=n(9896),dX=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"handleVote",function(t,n){var r=e.props,o=r.article.id;(0,r.updateArticleVote)(o,t,void 0,n)}),(0,ed._)((0,iD._)(e),"handleToggleLike",function(){var t=e.props,n=t.article,r=t.authRequired,o=t.toggleLike2020,i=t.interactMode,a=t.fancyToast,c=t.showNotification,s=n.id;r(function(){return o(s,{notification:!1}).catch(function(e){var t=(0,t1.HR)(null==e?void 0:e.payload);return"ordered"===i?a.critical(t):c(t,"red"),e})})()}),(0,ed._)((0,iD._)(e),"renderActionButtons",function(){var t,n=e.props,r=n.currentUser,o=n.isMobile,i=n.article,a=n.positionStatus,c=n.onCommentClick,s=n.onFavClick,u=n.onLikeClick,l=n.onShare,d=n.onRepublishClick,p=n.onContributeClick,f=n.interactMode,h=n.rewardInfo,_=n.justPublished,g=n.showIgnoreOptions,T=n.isInListItem,E=i.id,y=i.type,C=i.author,S=i.copyrightPermission,I=i.voteupCount,A=i.voting,b=i.title,w=i.commentCount,Z=i.adminClosedComment,x=i.isLiked,k=i.isNavigator,R=i.navigatorVote,N=i.voteNextStep,O=i.reaction,P="ordered"===f,D=O||{},L=D.relation,M=D.statistics||{},B=M.favorites,U=M.likeCount,G=(L||{}).faved,F=(0,de.Z)(r,C),H=r&&r.isOrg,z=!!(0,dH.f)(i),q=!o&&!F&&["public","need_review"].includes(S),V=(t={},(0,ed._)(t,dO.Z.Vote,{name:dO.Z.Vote,component:(0,m.tZ)(dF.Z,{type:y,count:I,onVote:e.handleVote,voting:A,isOwner:F,handleToggleGuide:u,disableAuth:o,isNavigator:k,navigatorVote:R,voteNextStep:N},dO.Z.Vote)}),(0,ed._)(t,dO.Z.Comment,{name:dO.Z.Comment,component:(0,m.tZ)(dM.Z,{className:"BottomActions-CommentBtn",onClick:c,commentClosed:Z,count:w,positionStatus:a,newInteract:P},dO.Z.Comment)}),(0,ed._)(t,dO.Z.Share,{name:dO.Z.Share,component:!o&&(0,m.tZ)(dG.Z,{id:E,type:"article",url:(0,dz.x$)(E),title:b,authorName:C&&C.name,positionStatus:a,onShare:l},dO.Z.Share)}),(0,ed._)(t,dO.Z.Like,{name:dO.Z.Like,component:!o&&(0,m.tZ)(dD.d,{className:"ContentItem-action",onClick:e.handleToggleLike,isLiked:x,newInteract:P,count:U},dO.Z.Like)}),(0,ed._)(t,dO.Z.Collect,{name:dO.Z.Collect,component:!H&&(0,m.tZ)(dU.Z,{onClick:s,label:o?"":"收藏",newInteract:P,count:B,faved:G},dO.Z.Collect)}),(0,ed._)(t,"republish",{name:"republish",component:q&&(0,m.tZ)(dq,{onClick:d})}),(0,ed._)(t,"legacyOptions",{name:"legacyOptions",component:(0,m.tZ)(dV.Z,{article:i,rewardInfo:h,justPublished:_,showIgnoreOptions:g})}),(0,ed._)(t,"settingsOrOptions",{name:"settingsOrOptions",component:(0,m.tZ)(dW.Z,{article:i,rewardInfo:h,justPublished:_,showIgnoreOptions:g})}),(0,ed._)(t,"contribute",{name:"contribute",component:F&&!o&&!z&&!T&&(0,m.tZ)(aC.ZP,{preset:"plain",onClick:p,icon:dR.h,label:"投稿"})}),(0,ed._)(t,dO.Z.AISummary,{name:dO.Z.AISummary,component:!o&&(0,m.tZ)(dN.v,{contentId:E,contentType:"article"})}),t),W=[V[dO.Z.Vote],V[dO.Z.Comment],V[dO.Z.Share],V[dO.Z.Like],V[dO.Z.Collect],V.republish,V[dO.Z.AISummary],V.legacyOptions,V.contribute],X=[V[dO.Z.Vote],V[dO.Z.Comment],V[dO.Z.Collect],V[dO.Z.Like],V[dO.Z.Share],V.republish,V[dO.Z.AISummary],V.settingsOrOptions,V.contribute];return P?X:W}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.article,n=t.id,r=t.author,o=e.checkIfCanConvertToVessay,i=e.currentUser;(0,de.Z)(i,r)&&o(n,"article")}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.interactMode,r=e.fancyRef;return(0,m.BX)(dP.Z,{css:{marginRight:"-20px",marginLeft:"-20px"},renderChildren:this.renderActionButtons,children:[t,"ordered"===n&&(null==r?void 0:r())]})}}]),n}(b.Component);(0,ed._)(dX,"propTypes",{article:iG().object.isRequired,rewardInfo:iG().shape({isRewardable:iG().bool,tagline:iG().string}),positionStatus:iG().string,onCommentClick:iG().func.isRequired,onFavClick:iG().func.isRequired,onLikeClick:iG().func,onContributeClick:iG().func,justPublished:iG().bool,isInListItem:iG().bool,interactMode:iG().oneOf(["default","ordered"])}),(0,ed._)(dX,"defaultProps",{interactMode:"default"});var dK=(0,th.compose)((0,uf.$)(),c_.Z,ui.OW,dL.Uk,dB.Vj,(0,e6.connect)(null,{updateArticleVote:tE.Pt,toggleLike2020:tE.cg,checkIfCanConvertToVessay:tT.Zq,showNotification:t1.c0}))(dX),dj=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"handleNextArticleLink",function(){Promise.resolve(aq.Z.trackEvent(e,{action:"OpenUrl",name:"下一篇"})).then(function(){location.href=(0,dz.x$)(e.props.next.id)})}),e}return(0,U._)(n,[{key:"render",value:function(){var e=this.props.next.title;return(0,m.BX)("div",{role:"button",tabIndex:0,className:"NextArticle",onClick:this.handleNextArticleLink,children:[(0,m.tZ)("span",{className:"NextArticle-Next",children:"下一篇"}),(0,m.tZ)("span",{className:"NextArticle-Title",children:e})]})}}]),n}(b.Component),dY={comment:"底部评论",collect:"收藏",up:"赞同",down:"反对",neutral:"取消赞同/反对"},dQ=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"zaRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"state",{favlistsShown:!1,republishApplyShown:!1,positionStatus:"normal"}),(0,ed._)((0,iD._)(e),"createOiaHandler",function(t){return function(n){for(var r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];var a=e.props,c=a.isMobile,s=a.shouldSpecialOia;c&&s?(0,dh.Z)({trackEvent:e.zaRef.current.trackEvent,zaV3Text:dY[t]}):null==n||n.apply(void 0,(0,g._)(o))}}),(0,ed._)((0,iD._)(e),"handleFavButtonClick",function(t){(0,d_.E)(t,1282),e.createOiaHandler("collect")(e.handleFavlistsShown)}),(0,ed._)((0,iD._)(e),"handleRepublishButtonClick",function(t){(0,d_.E)(t,8928,{button:{text:"申请转载"}}),e.props.authRequired(function(){return e.setState({republishApplyShown:!0})})()}),(0,ed._)((0,iD._)(e),"handlePositionStatusChange",function(t){e.setState({positionStatus:t})}),(0,ed._)((0,iD._)(e),"handleFavlistsShown",function(){e.props.authRequired(function(){return e.setState({favlistsShown:!0})},D.q0.favlists)()}),(0,ed._)((0,iD._)(e),"handleFavlistHide",function(){e.setState({favlistsShown:!1})}),(0,ed._)((0,iD._)(e),"handleScrollIntoComment",function(){if(e.props.isMobile){var t=document.querySelector(".Post-MobileComments");t&&t.scrollIntoView({block:"start",behavior:"smooth"});return}var n=e.state.positionStatus;if("fixed"===n)e.props.updateCommentStatus(n);else{var r=document.querySelector(".Comments-container");r&&r.scrollIntoView({block:"start",behavior:"smooth"})}}),(0,ed._)((0,iD._)(e),"showComments",function(t){(0,d_.E)(t,1281),e.createOiaHandler("comment")(e.handleScrollIntoComment)}),(0,ed._)((0,iD._)(e),"handleOiaVoteClick",function(t,n){e.createOiaHandler(n)()}),e}return(0,U._)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.favlistsShown,r=t.republishApplyShown,o=t.positionStatus,i=this.props,a=i.article,c=i.paging,s=i.rewardInfo,u=i.justPublished,l=i.onContributeClick,d=i.shouldSpecialOia,p=i.isMobile,f=i.onShare,h=i.showIgnoreOptions,_=a.id,g="fixed"===o,T={type:"Post",id:String(_),token:String(_)};return(0,m.tZ)(dw.Z,{bottom:!0,onPositionStatusChange:this.handlePositionStatusChange,children:(0,m.tZ)("div",{ref:function(t){e.actionEle=t},className:"RichContent-actions",children:(0,m.BX)(ud.r,{module:"BottomBar",card:{content:T},children:[(0,m.tZ)(e7.ZARef,{ref:this.zaRef}),(0,m.BX)(dK,{rewardInfo:s,article:a,positionStatus:o,onCommentClick:this.showComments,onFavClick:this.handleFavButtonClick,onLikeClick:p&&d?this.handleOiaVoteClick:null,onRepublishClick:this.handleRepublishButtonClick,justPublished:u,onContributeClick:l,onShare:f,showIgnoreOptions:h,children:[c.next&&!p&&g&&(0,m.tZ)(dj,{next:c.next}),(0,m.tZ)(dZ.Z,{id:_,type:"article",shown:n,onClose:this.handleFavlistHide,targetPath:".Post-Main .ContentItem-actions",fixed:g}),(0,m.tZ)(dk,{id:_,shown:r,onClose:function(){e.setState({republishApplyShown:!1})}})]})]})})})}}]),n}(b.Component);(0,ed._)(dQ,"propTypes",{article:iG().object.isRequired,paging:iG().object.isRequired,isRewardable:iG().bool,tagline:iG().string,updateCommentStatus:iG().func,justPublished:iG().bool,onContributeClick:iG().func}),(0,ed._)(dQ,"defaultProps",{paging:{}});var dJ=(0,th.compose)((0,uf.$)(),c_.Z,(0,e6.connect)(function(e){return{shouldSpecialOia:(0,eU.cq)(e)}}))(dQ),d$=n(52846),d0=n(26820);function d1(e){return e&&e.offsetTop?e.offsetTop+(e.offsetParent?d1(e.offsetParent):0):0}var d2=n(79742),d3=(0,tM.P1)([function(e){return e.post},function(e){return e.columns},function(e){return e.articleContribution.deleteContributeIdList}],function(e,t,n){return{contributions:Array.isArray(e&&e.contributions)?e.contributions.filter(function(e){var t=e.id;return!n.includes(t)}).map(function(e){var n=e.column,r=e.state,o=e.id;return{column:t[n.id],state:r,id:o}}):[]}}),d4=(0,tM.P1)([function(e){return e.articleContribution.handledContributeIdList},function(e){return e.articleContribution.contributeRequests}],function(e,t){return{contributeRequests:t.filter(function(t){var n=t.column;return!e.includes(n.id)})}}),d5=(0,tM.P1)([function(e){return e.post},function(e){return e.reward}],function(e,t){var n=e.canOpenTipjar,r=e.canTip,o=e.id,i=e.tipjarorsCount,a=t.article[o]||{},c=a.bio,s=a.income,u=a.tradeNumber,l=a.tipjarors,d=a.users,p=a.canTip,f=r,h=void 0!==n&&n;return"boolean"==typeof p&&(f=p,h=!p),{rewardInfo:{canOpenReward:h,isRewardable:f,rewardMemberCount:i,tagline:c,rewardTotalMoney:s},articleReward:{article:(0,ed._)({},o,{users:d||l,tradeNumber:u})}}}),d6=n(15219),d7=n(17255),d8=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"render",value:function(){var e=this.props,t=e.info,n=e.related,r=e.isMobile,o={info:t,related:n};return r?(0,m.tZ)(d7.Z,{data:o}):(0,m.tZ)(d6.Z,{data:o})}}]),n}(b.Component);(0,ed._)(d8,"propTypes",{info:iG().object.isRequired,related:iG().oneOfType([iG().oneOf([null]),iG().shape({pageId:iG().number.isRequired,sessionId:iG().number.isRequired,pageType:iG().string.isRequired})]),isMobile:iG().bool});var d9=(0,aw.Z)(null)(d8),pe=n(75056),pt=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"render",value:function(){var e=this.props,t=e.reason,n=e.isAuthor;return(0,m.BX)("div",{className:"PostIndex-warning",children:[t&&(0,m.tZ)("div",{className:"PostIndex-warningTitle",children:t}),(0,m.tZ)("div",{className:"PostIndex-warningContent",children:n?"建议修改期间，文章内容对其他用户不可见。修改提交后会自动进入评估状态。":"作者修改内容通过后，文章会重新显示。"}),(0,m.tZ)("a",{target:"_blank",href:"https://www.zhihu.com/question/24752645",rel:"noopener noreferrer",className:"PostIndex-warningHelp","aria-label":"帮助",children:(0,m.tZ)(pe.rk,{})})]})}}]),n}(b.Component);(0,ed._)(pt,"propTypes",{reason:iG().string.isRequired,isAuthor:iG().bool.isRequired});var pn=n(28753),pr=n(79445),po=n.n(pr),pi=n(87114),pa=n(26802),pc=n(70538),ps=n(88197),pu="Post-RichTextContainer",pl=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"state",{previewImage:null,prevImgUrls:[]}),(0,ed._)((0,iD._)(e),"oiaRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"handleClick",function(t){var n,r,o=e.props,i=o.ua,a=o.isMobile,c=e.state.prevImgUrls,s=a&&i.MQQBrowser&&(null===(n=window.browser)||void 0===n?void 0:null===(r=n.app)||void 0===r?void 0:r.openPhotoBrowser),u=t.target;"IMG"===u.tagName&&u.classList.contains("zh-lightbox-thumb")&&(s?window.browser.app.openPhotoBrowser(c,po()(c,function(e){return e===u.dataset.original}),0):e.setState({previewImage:u}))}),(0,ed._)((0,iD._)(e),"handlePreviewImageClose",function(){e.setState({previewImage:null})}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.ua,n=e.html,r=e.isMobile;t.MQQBrowser&&r&&this.setState({prevImgUrls:(0,pc.Z)(n)})}},{key:"render",value:function(){var e=this,t=this.props,n=t.html,r=t.ecommerce,o=t.id,i=t.isAuthor,a=t.shouldShowCatalog,c=t.contentNeedTruncated,s=t.authRequired,u=t.entityWords,l=t.isMobile,d=t.forceLoginWhenClickReadMore,p=t.catalog,f=t.onRef,h=this.state.previewImage,_=this;return(0,m.BX)("div",{className:pu,onClick:this.handleClick,children:[(0,m.tZ)(uT.Cl,{ref:this.oiaRef}),(0,m.BX)("div",{ref:f,css:{marginTop:l?10:16,position:"relative"},children:[(0,m.tZ)(pa.Z,{html:n,className:"Post-RichText",entityWords:u,ecommerce:r,sourceType:"article",sourceId:o,shouldShowCatalog:a,isAuthor:i,maskGradientColor:"GBK99A",isExpanded:!0,contentNeedTruncated:c,catalog:p}),c&&(0,m.tZ)(i0.kC,{height:"110px",justifyContent:"center",css:function(e){return{position:"absolute",width:"100%",bottom:"0",backgroundImage:"linear-gradient(to bottom, transparent, ".concat(e.colors.MapUIFrame99A," 48px)")}},alignItems:"flex-end",children:(0,m.BX)(e7.ZAShow,{zaModuleId:"unfold",shouldTrackClick:!0,zaType:"Button",as:aC.ZP,css:function(e){return{fontSize:"16px",color:e.colors.MapLink,marginBottom:26,letterSpacing:.4}},preset:"plain",className:"ContentItem-expandButton",onClick:(0,u1._)(function(){var e,t;return(0,u2.__generator)(this,function(n){switch(n.label){case 0:if(!d)return[3,3];if(!l)return[3,2];return null===(e=_.oiaRef.current)||void 0===e||null===(t=e.openDeepLink)||void 0===t||t.call(e),[4,(0,ps.g)(100)];case 1:n.sent(),n.label=2;case 2:s(function(){},"")(),n.label=3;case 3:return[2]}})}),children:["展开阅读全文",(0,m.tZ)(pn.f,{className:"ContentItem-arrowIcon",center:!0})]},"expand-button")})]}),(0,m.tZ)(pi.F,{img:h,onClose:function(){return e.setState({previewImage:null})}})]})}}]),n}(b.Component);(0,ed._)(pl,"propTypes",{html:iG().string.isRequired,author:iG().object});var pd=(0,th.compose)(c_.Z,(0,e6.connect)(function(e){return{ua:(0,eU.Uh)(e),isMobile:(0,eU.Hu)(e)}}))(pl),pp=n(76490),pf=function(e){var t=e.show,n=e.children,r=e.className;return(0,pp.Yz)(t,null,{from:{opacity:0},enter:{opacity:1},leave:{opacity:0}}).map(function(e){var t=e.item,o=e.key,i=e.props;return t&&(0,m.tZ)(pp.q.div,{style:i,className:r,children:n},o)})},ph=function(e){return(0,m.tZ)(sd.ZP,{children:(0,m.tZ)(pf,(0,G._)({},e))})},p_=function(e){var t=e.panels;return(0,m.tZ)(c0.Z,{className:"TopRightPanelWrapper",children:(0,m.tZ)(ph,{show:!0,children:(void 0===t?[]:t).map(function(e){var t=e.title,n=e.content,r=e.buttonGroup,o=e.key,i=void 0===o?"":o;return(0,m.BX)("div",{className:"TopRightPanel",children:[t&&(0,m.tZ)("div",{className:"TopRightPanel-title",children:t}),(0,m.tZ)("div",{className:"TopRightPanel-content",children:n}),(0,m.tZ)("div",{className:"TopRightPanel-foot",children:(0,m.tZ)("div",{className:"TopRightPanelButtonGroup",children:r})})]},i)})})})},pm=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"handleRequest",function(t,n){var r=e.props,o=r.postId;(0,r.handleContributeRequest)(o,t,n)}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.postId;(0,e.getContributeRequest)(t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.contributeRequests,r=t.author;if(0===n.length)return null;var o=n.map(function(t){var n=t.column,o=n.id,i=n.title,a=n.url;return{buttonGroup:(0,m.BX)(b.Fragment,{children:[(0,m.tZ)(aC.ZP,{color:"grey",onClick:function(){return e.handleRequest(o,!1)},children:"忽略"}),(0,m.tZ)(aC.ZP,{color:"blue",onClick:function(){return e.handleRequest(o,!0)},children:"通过"})]}),content:(0,m.BX)(b.Fragment,{children:[(0,m.tZ)(uL.Z,{user:r,avatar:!1,target:"_blank",noBadge:!0})," 申请将该文章发布到 ",(0,m.tZ)("a",{href:a,target:"_blank",rel:"noopener noreferrer",children:i}),"。"]}),title:i,key:o}});return(0,m.tZ)(p_,{panels:o})}}]),n}(b.Component);(0,ed._)(pm,"propTypes",{contributeRequests:iG().array.isRequired,postId:iG().string.isRequired,author:iG().object.isRequired});var pv=(0,th.compose)((0,e6.connect)(null,{handleContributeRequest:oq.xR,getContributeRequest:oq.o8}))(pm),pg="column:hideOpenColumnModalUntil",pT=1/0,pE=function(e){var t=O().get(pg)?pT:Date.now()+e;O().set(pg,String(t))},py=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"onDeny",function(){e.props.onClose(),pE(2592e6)}),(0,ed._)((0,iD._)(e),"onClose",function(){e.props.onClose(),pE(6048e5)}),(0,ed._)((0,iD._)(e),"onConfirm",function(){e.props.onClose(),pE(pT)}),e}return(0,U._)(n,[{key:"render",value:function(){var e=this.props.shown;return(0,m.tZ)(tf.Z,{title:"邀请你开通专栏",subtitle:"专栏旨在为有持续创作及合作写作需求的用户提供写作工具。发布到专栏，让文章被更多人看到。",onClose:this.onClose,buttonGroupOnly:!0,className:"Column-SpecialModal",children:e&&(0,m.BX)(tf.w,{direction:"vertical",children:[(0,m.tZ)(aC.ZP,{preset:"primary",color:"blue",component:"a",onClick:this.onConfirm,href:"https://www.zhihu.com/column/request",target:"_blank",children:"立即开通"}),(0,m.tZ)(aC.ZP,{onClick:this.onDeny,children:"暂不开通"})]})})}}]),n}(b.Component);(0,ed._)(py,"propTypes",{shown:iG().bool,onClose:iG().func.isRequired}),(0,ed._)(py,"checkShouldShow",function(){var e=Number(O().get(pg))||0;return Date.now()>e});var pC=n(36963),pS=n(30361),pI=n.p+"assets/liukanshan_blue@2x.187f55d4.png",pA=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"state",{folded:e.props.enabled}),e}return(0,U._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.enabled,r=t.onButtonClick,o=this.state.folded,i=(0,m.tZ)(s0.qE,{className:"UserLink-avatar",url:pI,alt:"刘看山图片",size:o?18:40});if(o)return(0,m.BX)("li",{className:"AutoInvite-folded",onClick:function(){return e.setState({folded:!1})},children:[i,(0,m.tZ)("span",{className:"AutoInvite-title",children:"委托刘看山邀请"}),(0,m.BX)("span",{className:"AutoInvite-badge",children:[(0,m.tZ)(pC.BS,{height:16,width:16}),(0,m.tZ)("span",{className:"text",children:"已开启"})]}),(0,m.tZ)(pn.f,{height:24,width:24,className:"AutoInvite-arrow"})]});var a=n?(0,m.tZ)(aC.ZP,{color:"grey",preset:"primary",className:"CancleButton",onClick:r,children:"已开启"}):(0,m.tZ)(aC.ZP,{color:"blue",preset:"primary",onClick:r,children:"开启邀请"});return(0,m.tZ)("li",{children:(0,m.tZ)(pS.ZP,{className:"Column-ColumnItem",title:"委托刘看山邀请",image:i,meta:!o&&(n?"正在为你智能邀请感兴趣的创作者":"开启后为你智能邀请感兴趣的创作者"),extra:!o&&a})})}}]),n}(b.Component);(0,ed._)(pA,"propTypes",{reason:iG().string,enabled:iG().bool,onButtonClick:iG().func.isRequired});var pb=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"render",value:function(){var e=this.props,t=e.author,n=e.reason,r=e.hasInvited,o=e.onInvite,i=r?(0,m.tZ)(aC.ZP,{color:"grey",preset:"primary",className:"CancleButton",children:"已邀请"}):(0,m.tZ)(aC.ZP,{color:"blue",onClick:function(){return o(t.id)},children:"邀请投稿"}),a=(0,m.tZ)(uL.Z,{user:t,avatar:!0,avatarProps:{size:40}}),c=(0,m.tZ)(uL.Z,{user:t});return(0,m.tZ)(pS.ZP,{className:"Column-ColumnItem",data:t,title:c,image:a,meta:n,extra:i})}}]),n}(b.Component);(0,ed._)(pb,"propTypes",{author:iG().object.isRequired,reason:iG().string,hasInvited:iG().bool,onInvite:iG().func.isRequired});var pw="column:closeInviteModalTimes",pZ=function(){return Number(O().get(pw))||0},px=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"state",{loading:!1}),(0,ed._)((0,iD._)(e),"touched",!1),(0,ed._)((0,iD._)(e),"handleInvite",function(t){aq.Z.trackEvent((0,iD._)(e),{id:1589,action:"Click",name:"邀请投稿"}),e.touched=!0;var n,r=e.props;(0,r.dispatch)((n=r.columnId,{API:{types:im.INVITE_CONTRIBUTOR,method:"PUT",endpoint:"/columns/".concat(n,"/contribution-invitees"),fetchOptions:{credentials:"include"},body:{member_hash:t}},userId:t}))}),(0,ed._)((0,iD._)(e),"toggleAutoInvite",function(){var t,n=e.props,r=n.dispatch,o=n.autoInviteEnabled,i=n.columnId;aq.Z.trackEvent((0,iD._)(e),{id:o?2605:2604}),r((t=!o,{API:{types:im.SET_AUTO_INVITE,method:"PATCH",endpoint:"/columns/".concat(i,"/recommendation-contributors"),fetchOptions:{credentials:"include"},body:{is_auto:t}},meta:t}))}),(0,ed._)((0,iD._)(e),"handleClose",function(){aq.Z.trackEvent((0,iD._)(e),{id:1593,action:"Close",name:"邀请大家来投稿"});var t=e.props,n=t.onClose;t.isOpenedByUser||e.touched||O().set(pw,String(pZ()+1)),n()}),(0,ed._)((0,iD._)(e),"handleNeverShow",function(t){aq.Z.trackEvent(t.currentTarget,{id:1594,action:"Click",name:"邀请投稿弹窗不再提示按钮"}),O().set(pw,String(1/0)),e.props.onClose()}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){this.props.shown&&this.handleModalAppear()}},{key:"componentDidUpdate",value:function(e){this.props.shown&&!e.shown&&this.handleModalAppear()}},{key:"componentWillUnmount",value:function(){this.isUnmounted=!0}},{key:"handleModalAppear",value:function(){var e=this;aq.Z.trackCardShow(this,{id:1587,name:"邀请大家来投稿"});var t=this.props,n=t.columnId,r=t.dispatch,o=t.isOpenedByUser;!this.state.loading&&n&&(this.setState({loading:!0}),r({API:{types:im.GET_RECOMMENDED_CONTRIBUTORS,endpoint:"/columns/".concat(n,"/recommendation-contributors").concat(o?"?src=user":""),fetchOptions:{credentials:"include"}}}).then(function(){e.isUnmounted||(e.setState({loading:!1}),e.touched=!1)},function(e){if(!e.payload||409!==e.payload.code)throw e}))}},{key:"renderContent",value:function(){var e=this,t=this.props,n=t.recommendedContributors,r=t.isOpenedByUser,o=t.autoInviteEnabled;return r||0!==n.length?this.state.loading?(0,m.tZ)(cX.Z,{}):(0,m.BX)(m.HY,{children:[(0,m.tZ)("ul",{className:"AutoInvite",children:(0,m.tZ)(pA,{onButtonClick:this.toggleAutoInvite,enabled:o})}),(0,m.tZ)("ul",{children:n.map(function(t){var n=t.author,r=t.reason,o=t.hasInvited;return(0,m.tZ)("li",{children:(0,m.tZ)(pb,{author:n,reason:r,hasInvited:o,onInvite:e.handleInvite})},n.id)})})]}):null}},{key:"render",value:function(){var e=this.props,t=e.shown,n=e.columnId,r=e.isOpenedByUser;if(!n)return null;var o=!r&&(0,m.BX)("p",{children:["暂时不想邀请他人投稿？",(0,m.tZ)("button",{onClick:this.handleNeverShow,children:"不再显示"})]});return(0,m.tZ)(tf.Z,{title:"想要专栏获得更多文章？邀请大家来投稿",subtitle:"为你精选优质作者，让你的专栏更受欢迎",size:"large",onClose:this.handleClose,className:"Column-RecommendationModal",footer:o,children:t&&this.renderContent()})}}]),n}(b.Component);(0,ed._)(px,"propTypes",{shown:iG().bool,onClose:iG().func.isRequired,columnId:iG().string.isRequired,recommendedContributors:iG().array.isRequired,autoInviteEnabled:iG().bool.isRequired,isOpenedByUser:iG().bool}),(0,ed._)(px,"checkShouldShow",function(){return 2>pZ()});var pk=(0,e6.connect)(function(e){var t=e.columnContribution;return{recommendedContributors:t.recommendedContributors,autoInviteEnabled:t.autoInviteEnabled}})(px),pR=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"handleColumnClick",function(t){aq.Z.trackEvent(t.currentTarget,{id:1591,name:e.props.reason||"推荐专栏的投稿"})}),e}return(0,U._)(n,[{key:"render",value:function(){var e=this.props,t=e.column,n=e.reason,r=e.contributed,o=e.onSubmit,i=t.articlesCount,a=t.followers,c=t.id,s=r?(0,m.tZ)(aC.ZP,{color:"grey",preset:"primary",className:"CancleButton",children:"已投稿"}):(0,m.tZ)(aC.ZP,{color:"blue",onClick:function(){return o(c)},children:"投稿"}),u={column:t,target:"_blank",onClick:this.handleColumnClick},l=(0,m.tZ)(lv.Z,(0,er._)((0,G._)({},u),{avatar:!0,avatarProps:{size:40}})),d=(0,m.tZ)(lv.Z,(0,er._)((0,G._)({},u),{className:"ColumnItem-Title"})),p=n||"".concat((0,s1.uf)(a)," 人关注 \xb7 ").concat((0,s1.uf)(i)," 篇文章");return(0,m.tZ)(pS.ZP,{className:"Column-ColumnItem",data:t,image:l,title:d,extra:s,meta:p})}}]),n}(b.Component);(0,ed._)(pR,"propTypes",{column:iG().object.isRequired,reason:iG().string,contributed:iG().bool,onSubmit:iG().func.isRequired});var pN=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"state",{loading:!1}),(0,ed._)((0,iD._)(e),"submit",function(t){var n=e.props;(0,n.addContributeRequest)(n.articleId,t)}),(0,ed._)((0,iD._)(e),"handleClose",function(){aq.Z.trackEvent((0,iD._)(e),{id:1592,action:"Close",name:"要将该文章投稿到专栏吗"}),e.props.onClose()}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){this.props.shown&&this.handleModalAppear()}},{key:"componentDidUpdate",value:function(e){this.props.shown&&!e.shown&&this.handleModalAppear()}},{key:"componentWillUnmount",value:function(){this.isUnmounted=!0}},{key:"handleModalAppear",value:function(){var e=this;aq.Z.trackCardShow(this,{id:1590,name:"要将该文章投稿到专栏吗"});var t=this.props,n=t.articleId,r=t.getRecommendedColumns;this.state.loading||(this.setState({loading:!0}),r(n).catch(function(){}).then(function(){e.isUnmounted||e.setState({loading:!1})}))}},{key:"renderContent",value:function(){var e=this,t=this.props,n=t.recommendedColumns,r=t.pinnedColumns,o=t.sentContributeRequestsIdList,i=t.isOpenedByUser,a=r.length>0,c=n.length>0;return i||a||c?this.state.loading?(0,m.tZ)(cX.Z,{}):a||c?(0,m.BX)(b.Fragment,{children:[a&&(0,m.tZ)("ul",{className:"PinnedColumns",children:r.map(function(t){var n=t.reason,r=t.column;return(0,m.tZ)("li",{children:(0,m.tZ)(pR,{column:r,reason:n,contributed:o.includes(r.id),onSubmit:e.submit})},r.id)})}),c&&(0,m.BX)(b.Fragment,{children:[(0,m.tZ)("h3",{className:"SectionTitle",children:"为你推荐的专栏"}),(0,m.tZ)("ul",{className:"RecommendedColumns",children:n.map(function(t){var n=t.column,r=t.reason;return(0,m.tZ)("li",{children:(0,m.tZ)(pR,{column:n,reason:r,contributed:o.includes(n.id),onSubmit:e.submit,onCancelSubmit:e.cancelSubmit})},n.id)})})]})]}):(0,m.tZ)("div",{className:"EmptyState",children:"暂时没有匹配的专栏"}):null}},{key:"render",value:function(){var e=this.props.shown;return(0,m.tZ)(tf.Z,{title:"要将该文章投稿到专栏吗？",subtitle:"让好文章被更多人看到",size:"large",onClose:this.handleClose,className:"Column-RecommendationModal",children:e&&this.renderContent()})}}]),n}(b.Component);(0,ed._)(pN,"propTypes",{shown:iG().bool,onClose:iG().func.isRequired,getRecommendedColumns:iG().func.isRequired,recommendedColumns:iG().array.isRequired,pinnedColumns:iG().array.isRequired,articleId:iG().string.isRequired,sentContributeRequestsIdList:iG().array.isRequired,isOpenedByUser:iG().bool});var pO=(0,e6.connect)(function(e){var t=e.articleContribution;return{recommendedColumns:t.recommendedColumns,pinnedColumns:t.pinnedColumns,sentContributeRequestsIdList:t.sentContributeRequestsIdList}},{getRecommendedColumns:oq.Ue,addContributeRequest:oq.zS})(pN),pP=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"isFirst",!0),(0,ed._)((0,iD._)(e),"state",{applyModalShown:!1,recommendModalShown:!1,inviteModalShown:!1,isOpenedByUser:!1}),(0,ed._)((0,iD._)(e),"handleCloseModals",function(){e.setState({applyModalShown:!1,recommendModalShown:!1,inviteModalShown:!1,isOpenedByUser:!1})}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.currentUser,r=t.justPublishedQuery,o=t.columnId;if((0,t.getShowRecommendModalHandler)(function(){return e.setState({recommendModalShown:!0,isOpenedByUser:!0})}),this.isFirst){this.isFirst=!1;return}"1"!==r||n.isOrg?"2"===r&&(o||n.isOrg?o&&pk.checkShouldShow()&&(this.timeout=setTimeout(function(){return e.setState({inviteModalShown:!0})},600)):this.timeout=setTimeout(function(){return e.setState({recommendModalShown:!0})},600)):this.checkShouldShowApplyColumnModal().then(function(t){e.isUnmounted||e.setState(t?{applyModalShown:!0}:{recommendModalShown:!0})})}},{key:"componentWillUnmount",value:function(){this.isUnmounted=!0,clearTimeout(this.timeout)}},{key:"checkShouldShowApplyColumnModal",value:function(){var e=this;return(0,u1._)(function(){return(0,u2.__generator)(this,function(t){switch(t.label){case 0:if(!py.checkShouldShow())return[2,!1];return[4,e.props.loadSwitches(["couldApplyColumn"])];case 1:return t.sent(),[2,e.props.switches.couldApplyColumn]}})})()}},{key:"render",value:function(){var e=this.state,t=e.applyModalShown,n=e.recommendModalShown,r=e.inviteModalShown,o=e.isOpenedByUser,i=this.props,a=i.articleId,c=i.columnId;return(0,m.BX)(m.HY,{children:[(0,m.tZ)(py,{shown:t,onClose:this.handleCloseModals}),(0,m.tZ)(pO,{articleId:a,shown:n,onClose:this.handleCloseModals,isOpenedByUser:o}),c&&(0,m.tZ)(pk,{shown:r,columnId:c,onClose:this.handleCloseModals})]})}}]),n}(b.Component);(0,ed._)(pP,"propTypes",{justPublishedQuery:iG().oneOf(["1","2"]),articleId:iG().string.isRequired,columnId:iG().string});var pD=(0,th.compose)(ab.Z,(0,e6.connect)(function(e){return{switches:e.switches}},{loadSwitches:ol.X2}))(pP),pL=n(22943),pM="Post-Main";function pB(){var e=(0,b.useRef)(),t=(0,ef._)((0,b.useState)(0),2),n=t[0],r=t[1];return(0,cg.b)(function(){(function(e){return pU.apply(this,arguments)})(e).then(function(e){return r(e)})}),(0,m.tZ)("div",{ref:e,css:{marginTop:n}})}function pU(){return(pU=(0,u1._)(function(e){return(0,u2.__generator)(this,function(t){switch(t.label){case 0:return[4,(0,ps.g)(500)];case 1:return t.sent(),[2,-(0,pL.Z)(function(){return function(e){var t=document.querySelector("."+pM);if(null==t?void 0:t.children){var n=document.querySelector("."+pu);if(n){for(var r=Array.from(t.children),o=r.indexOf(n),i=0;o<r.length;){var a=r[++o];if(!a)break;var c=function(e){var t=getComputedStyle(e),n=parseInt(t.marginTop);n=isNaN(n)?0:n;var r=parseInt(t.paddingTop);return{marginTop:n,paddingTop:r=isNaN(r)?0:r,hasTopValue:r+n>0}}(a);if(c.hasTopValue&&a!=e.current){i=c.marginTop+c.paddingTop;break}}return i}}}(e)},0)]}})})).apply(this,arguments)}var pG=n(11797),pF=n(97187),pH=n(82435),pz=function(e){var t=e.parent.id,n=(0,b.useRef)(),r=(0,b.useCallback)(function(){(0,dh.Z)({trackEvent:n.current.trackEvent,zaV3Text:"评论热区",from:"comment"})},[]);return(0,m.BX)(m.HY,{children:[(0,m.tZ)(e7.ZARef,{ref:n}),(0,m.tZ)(pH.ZP,{requestHost:"www.zhihu.com",commentType:"root_comment",resourceType:"article",resourceId:String(t),zaContentType:"Post",showSecondaryComment:!0,showSecondaryCommentVoteButton:!0,useHeartIcon:!0,css:{margin:0,paddingTop:"15px"},customFooter:function(){return null},openInApp:r})]})};pz.propTypes={parent:iG().object.isRequired};var pq=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"trackChangeOrder",function(e,t){(0,d_.E)(t,{id:1290,name:t.currentTarget.textContent})}),(0,ed._)((0,iD._)(e),"trackLike",function(e,t){var n=t.currentTarget.classList.contains("is-liked");(0,d_.E)(t,{id:1301,action:n?"UnUpvote":"Upvote"})}),(0,ed._)((0,iD._)(e),"trackPaginationClick",function(t,n){aq.Z.trackEvent((0,iD._)(e),{id:1300,action:t>n?"PrevPage":"NextPage"})}),(0,ed._)((0,iD._)(e),"handleCommentClose",function(){e.props.updateCommentStatus("bottom")}),e}return(0,U._)(n,[{key:"render",value:function(){var e=this.props,t=e.parent,n=e.commentPattern,r=e.byComment,o=e.onMount,i=e.onComment,a=e.isMobile;return a?(0,m.tZ)(pz,{parent:t}):(0,m.tZ)(pF.Z,{autoFocus:!1,parent:t,isMobile:a,commentPattern:n,commentPlugin:pG.Z,onOrderChange:this.trackChangeOrder,onItemLike:this.trackLike,onPaginationClick:this.trackPaginationClick,onClose:this.handleCommentClose,onComment:i,byComment:r,onMount:o,showPackupButton:!1,commentInputPosition:"top",shown:!0})}}]),n}(b.Component);(0,ed._)(pq,"propTypes",{parent:iG().object.isRequired,commentPattern:iG().string.isRequired,byComment:iG().oneOfType([iG().number,iG().string]),updateCommentStatus:iG().func.isRequired});var pV=(0,th.compose)((0,uf.$)(),(0,ud.a)({module:"CommentList"}))(pq),pW=n(42657),pX=n.p+"assets/rightArrow.344669e0.svg",pK=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.className;return(0,m.tZ)("h3",{className:i$()("BlockTitle",n),children:t})}}]),n}(b.PureComponent);(0,ed._)(pK,"propTypes",{className:iG().string});var pj=n(23593),pY=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"openApp",function(){D.dd||(0,pj.F)(e.props.postId,"view_all")}),e}return(0,U._)(n,[{key:"render",value:function(){return(0,m.tZ)("button",{onClick:this.openApp,className:"Post-Button-ViewMore",children:"查看更多"})}}]),n}(b.Component);(0,ed._)(pY,"propTypes",{postId:iG().string.isRequired});var pQ=n(75472),pJ=n.n(pQ),p$=n(88423),p0=n(93547),p1=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"oiaRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"openInApp",function(t){if(e.props.shouldSpecialOia){t.preventDefault();var n,r=e.props.article;null===(n=e.oiaRef.current)||void 0===n||n.oiaWithTrack({type:"article",id:r.id,from:"recommend"})}}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){this.RecommendItemTitleEl.offsetHeight>25&&(this.RecommendItemSummaryEl.style.display="none");var e=this.props.article;e.author||window.Raven.captureException(Error("Missing `author` in article data."),{tags:{scope:"Column"},extra:{article:e}})}},{key:"render",value:function(){var e=this,t=this.props,n=t.article,r=t.editorChoice,o=n.imageUrl,i=n.title,a=n.excerpt,c=n.author,s=(void 0===c?{}:c).name,u=void 0===s?"":s,l=n.column,d=n.url,p=o?64:d0.PY,f=l&&u.length>4?"".concat(u.slice(0,4),"..."):u,h=l?" \xb7 发表于".concat(l.title):"";return(0,m.BX)(e7.ZAShow,{extra:{configMap:{callback_from:"recommend"}},zaType:"Button",zaModuleId:"reback_poplayer_btn",content:{type:"article",id:n.id},children:[(0,m.tZ)(uT.dn,{ref:this.oiaRef}),(0,m.BX)("a",{onClick:this.openInApp,href:d,className:"MobilePostItem",children:[(0,m.BX)("div",{className:"MobilePostItem-Description",children:[(0,m.tZ)("div",{className:"MobilePostItem-Title",ref:function(t){e.RecommendItemTitleEl=t},children:i}),(0,m.tZ)("div",{className:"MobilePostItem-Summary u-ellipsis",ref:function(t){e.RecommendItemSummaryEl=t},children:(0,p0.NJ)(a,p)}),(0,m.BX)("div",{className:"MobilePostItem-Footer",children:[r&&(0,m.tZ)("span",{className:"MobilePostItem-edited",children:"编辑精选"}),f,h]})]}),o&&(0,m.tZ)("img",{src:(0,p$.imgUrl)(o,"ipico"),srcSet:"".concat((0,p$.imgUrl)(o,"250x250")," 2x, ").concat((0,p$.imgUrl)(o,"ms")," 3x"),className:"MobilePostItem-TitleImage",alt:i})]})]})}}]),n}(b.PureComponent);(0,ed._)(p1,"propTypes",{article:iG().object.isRequired,editorChoice:iG().bool.isRequired});var p2=(0,th.compose)((0,e6.connect)(function(e){return{shouldSpecialOia:(0,eU.cq)(e)}}))(p1),p3=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"componentDidMount",value:function(){var e=this.props.article;e.author||window.Raven.captureException(Error("Missing `author` in article data."),{tags:{scope:"Column"},extra:{article:e}})}},{key:"render",value:function(){var e=this.props.article,t=e.imageUrl,n=e.title,r=e.excerpt,o=e.author,i=(void 0===o?{}:o).name,a=void 0===i?"":i,c=e.column,s=e.url,u=c&&a.length>5?"".concat(a.slice(0,5),"..."):a,l="";return c&&(l=c.title.length>5?"发表于".concat(c.title.slice(0,5),"..."):"发表于".concat(c.title)),(0,m.tZ)("a",{href:s,className:"PostItem",children:(0,m.BX)("div",{children:[t&&(0,m.tZ)("img",{src:(0,p$.imgUrl)(t,"250x0"),srcSet:"".concat((0,p$.imgUrl)(t,"qhd")," 2x"),className:"PostItem-TitleImage",alt:n}),(0,m.tZ)("h1",{className:"PostItem-Title",children:n}),!t&&(0,m.tZ)("p",{className:"PostItem-Summary",children:(0,p0.NJ)(r,d0.PY)}),(0,m.BX)("div",{className:"PostItem-Footer",children:[(0,m.tZ)("span",{children:u}),(0,m.tZ)("span",{className:"PostItem-FooterTitle",children:l})]})]})})}}]),n}(b.Component);function p4(e){var t=e.editorChoice,n=e.article;return(0,uf.Z)()?(0,m.tZ)(e7.ZAEnv,{moduleId:"reback_poplayer_btn",children:(0,m.tZ)(p2,{article:n,editorChoice:t})}):(0,m.tZ)(p3,{article:n})}(0,ed._)(p3,"propTypes",{article:iG().object.isRequired}),p4.propTypes={article:iG().object.isRequired,editorChoice:iG().bool.isRequired};var p5=n(54674),p6=n(99878),p7=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"handlePagingButtonClick",function(){var t=e.props,n=t.onClick;"next"===t.direction&&aq.Z.trackEvent((0,iD._)(e),{action:"NextPage"}),n()}),e}return(0,U._)(n,[{key:"render",value:function(){var e=this.props,t=e.direction,n=e.disabled,r="previous"===t?p5.e:p6.N;return(0,m.tZ)(ud.r,{module:"Unknown",moduleName:"推荐阅读",children:(0,m.tZ)("button",{className:i$()("PagingButton","previous"===t?"PagingButton-Previous":"PagingButton-Next"),onClick:this.handlePagingButtonClick,disabled:n,children:(0,m.tZ)(r,{size:40,fill:"#d3d3d3"})})})}}]),n}(b.Component);(0,ed._)(p7,"propTypes",{direction:iG().oneOf(["previous","next"]).isRequired,onClick:iG().func.isRequired,disabled:iG().bool}),(0,ed._)(p7,"defaultProps",{direction:"next"});var p8=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"oiaRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"handleResizeChange",function(){var t=e.props.isMobile,n=document.querySelector(".ColumnPageHeader-Wrapper");!t&&e.RecommendationsEl&&n&&(e.RecommendationsEl.style.width="".concat(n.offsetWidth,"px"))}),(0,ed._)((0,iD._)(e),"handleOpenApp",function(){var t;null===(t=e.oiaRef.current)||void 0===t||t.oiaWithTrack({target:"feed/item/recommend"})}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){this.subscription=(0,us.subscribe)("resize",this.handleResizeChange)}},{key:"componentDidUpdate",value:function(){this.handleResizeChange()}},{key:"componentWillUnmount",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"render",value:function(){var e=this,t=this.props,n=t.isMobile,r=t.id,o=t.currentPageItems,i=t.shouldDisableNextPage,a=t.shouldDisablePreviousPage,c=t.nextPage,s=t.previousPage;return 0===o.length?null:(0,m.BX)("div",{role:"complementary","aria-label":"推荐阅读",className:i$()({"Recommendations-Main":!n}),ref:function(t){e.RecommendationsEl=t},children:[(0,m.tZ)(uT.dn,{ref:this.oiaRef}),(0,m.BX)(pK,{className:"Recommendations-BlockTitle",children:["推荐阅读",n&&(0,m.BX)("button",{className:"Recommendations-viewMore",onClick:this.handleOpenApp,children:["查看更多",(0,m.tZ)("img",{src:pX,alt:"rightArrow"})]})]}),(0,m.BX)("ul",{className:i$()({"Recommendations-List":!n}),children:[!n&&(0,m.tZ)(p7,{disabled:a,direction:"previous",onClick:s}),o.map(function(e){var t=e.article,n=e.editorChoice;return(0,m.tZ)(p4,{article:t,editorChoice:n},t.id)}),!n&&(0,m.tZ)(p7,{disabled:i,direction:"next",onClick:c})]}),n&&!D.dd&&(0,m.tZ)(pY,{postId:r})]})}}]),n}(b.Component);(0,ed._)(p8,"propTypes",{isMobile:iG().bool,id:iG().number,currentPageItems:iG().array,shouldDisableNextPage:iG().bool,shouldDisablePreviousPage:iG().bool,nextPage:iG().func.isRequired,previousPage:iG().func.isRequired}),(0,ed._)(p8,"defaultProps",{currentPageItems:[]});var p9=(0,th.compose)((0,e6.connect)(function(e,t){var n=t.id,r=(e.recommendation[n]||{}).data,o=(0,eU.Hu)(e);return{items:r,onlyOnePage:o,isMobile:o}},function(e,t){var n=t.id;return{fetchData:function(t){return e(function(e,r){var o=r().recommendation[n],i=o&&o.paging&&o.paging.next;return e({parentId:n,API:(0,G._)({root:P.Z.fetchRoot.zhuanlan,types:iC.GET},i?{endpoint:i}:{endpoint:"/articles/".concat(n,"/recommendation"),query:{include:tI()({data:[{article:{column:!0}}]}),limit:t,offset:0}})})})}}}),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;return function(t){var n=function(n){(0,iL._)(o,n);var r=(0,iM._)(o);function o(){var t;return(0,B._)(this,o),t=r.apply(this,arguments),(0,ed._)((0,iD._)(t),"fetchCount",0),(0,ed._)((0,iD._)(t),"state",{isFetching:!1,page:0,isExhausted:!1}),(0,ed._)((0,iD._)(t),"getCurrentPageItems",function(){var n=t.state.page;return t.props.items.slice(n*e,(n+1)*e)}),(0,ed._)((0,iD._)(t),"beforeFetch",function(){if(t.state.isExhausted)return Promise.resolve({isExhausted:!0});var n=t.props.items.length,r=t.props.onlyOnePage?n>=e:n>(t.state.page+2)*e;return r||t.fetchCount>2?Promise.resolve({isExhausted:!r}):Promise.reject(Error("not enough to fetch or fetch too many times"))}),(0,ed._)((0,iD._)(t),"fetchUntilEnough",function(){return t.beforeFetch().then(function(e){var n=e.isExhausted;return t.fetchEnds(n)},function(){return t.fetchStart().then(t.fetchUntilEnough)})}),(0,ed._)((0,iD._)(t),"fetchStart",function(){0===t.fetchCount&&t.setState({isFetching:!0}),t.fetchCount+=1;var n=t.props;return(0,n.fetchData)(e*(n.onlyOnePage?1:3))}),(0,ed._)((0,iD._)(t),"fetchEnds",function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.fetchCount=0,t.setState({isExhausted:e,isFetching:!1})}),(0,ed._)((0,iD._)(t),"isFirstPage",function(){return 0===t.state.page}),(0,ed._)((0,iD._)(t),"isLastPage",function(){var n=t.props.items.length;return 0===n||(t.state.page+1)*e>=n}),(0,ed._)((0,iD._)(t),"previousPage",function(){t.isFirstPage()||t.setState(function(e){return{page:e.page-1}})}),(0,ed._)((0,iD._)(t),"nextPage",function(){t.isLastPage()||t.setState(function(e){return{page:e.page+1}},t.fetchUntilEnough)}),t}return(0,U._)(o,[{key:"componentDidMount",value:function(){this.fetchUntilEnough()}},{key:"shouldComponentUpdate",value:function(t,n){var r=this.props.items.length<e&&t.items.length>=e,o=!pJ()(this.state,n);return r||o}},{key:"render",value:function(){var e=this.props,n=e.onlyOnePage,r=e.items,o=this.state,i=o.isFetching,a=o.isExhausted,c=0===r.length||this.isLastPage()&&(a||i);return(0,m.tZ)(t,(0,G._)({currentPageItems:this.getCurrentPageItems(),shouldDisableNextPage:c||n,shouldDisablePreviousPage:this.isFirstPage()||n,nextPage:this.nextPage,previousPage:this.previousPage},rS()(this.props,["fetchData","onlyOnePage","items"])))}}]),o}(b.Component);return(0,ed._)(n,"displayName","PageManager(".concat(t.displayName||t.name||"Component",")")),(0,ed._)(n,"propTypes",{onlyOnePage:iG().bool,fetchData:iG().func.isRequired,items:iG().array.isRequired}),(0,ed._)(n,"defaultProps",{items:[]}),n}}(d0.j),(0,uT.fM)(!0))(p8),fe=function(e){var t=e.module,n=e.content,r=e.children,o=e.index;return(0,m.tZ)(e7.ZAEnv,{content:n,moduleIndex:o,children:(0,m.tZ)(ud.r,{module:t,card:{content:n},children:r})})},ft=(0,c_.Z)(function(e){var t=e.id,n=e.type,r=e.voteupCount,o=e.query,i=e.authRequired,a=(0,dc.Z)(i,"true"===o.from_voters_page),c=a.modalShown,s=a.openVotersModal,u=a.closeVotersModal;return(0,m.BX)(m.HY,{children:[(0,m.tZ)(l_.Z,{contentType:"article",id:t,onClickVoterInfo:s}),(0,m.tZ)(l0.Z,{id:t,type:n,voteupCount:r,modalShown:c,handleListHide:u})]})}),fn=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"state",{columnHeaderShown:!1,contentDomPosition:"",commentPattern:e.getByCommentFromHash()?"fixed":"bottom",justPublishedQuery:e.getJustPublishedQuery(),shareVideoQuery:e.getShareVideoId(),shouldShowVideoDetails:!1,postMainRef:null,adTrackInfo:null,republishRequests:null,signFlowModalShown:!1,followAuthorPopupCanShow:!1,showPassModal:!1}),(0,ed._)((0,iD._)(e),"alreadyScrolled",!1),(0,ed._)((0,iD._)(e),"postMainRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"richTextRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"rewardContainerRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"readMarkRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"oiaRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"onscoll",function(){var t=e.state.contentDomPosition,n=document.querySelector(".Post-RichText"),r=d1(n),o=n?n.getBoundingClientRect().height:0;if(!t){if(!n)return;e.setState({contentDomPosition:r+o})}(document.documentElement.scrollTop||document.body.scrollTop)+window.innerHeight>r+o&&(aq.Z.trackEvent((0,iD._)(e),{action:"ScrollToBottom"}),e.scrollSubscription.unsubscribe())}),(0,ed._)((0,iD._)(e),"handleVotersButtonClick",function(){}),(0,ed._)((0,iD._)(e),"handleShowContributionModal",function(){e.showRecommendModalHandler&&e.showRecommendModalHandler()}),(0,ed._)((0,iD._)(e),"handleClickVideoMoreButton",function(){e.setState({shouldShowVideoDetails:!1})}),(0,ed._)((0,iD._)(e),"updateCommentStatus",function(t){e.state.commentPattern!==t&&("fixed"===t?e.props.trackOpenCommentAdPromotion():e.props.trackCloseCommentAdPromotion()),e.setState({commentPattern:t})}),(0,ed._)((0,iD._)(e),"onCommentMount",function(t){"#comments"!==e.props.location.hash||"bottom"!==e.state.commentPattern||e.alreadyScrolled||(e.timeoutId=setTimeout(function(){return t.scrollIntoView()},500))}),(0,ed._)((0,iD._)(e),"renderLabels",function(t){var n=e.props.post,r=n.suggestEdit.status,o=n.visibleOnlyToAuthor,i=n.annotationDetail,a=n.commercialInfo;if(t&&o)return(0,m.tZ)(lH.Z,{});var c=(null==a?void 0:a.isCommercial)?{data:a}:null;return r?null:(0,m.tZ)(lr.Z,{commercialProps:c,annotationProps:!r&&i&&{annotationDetail:i},item:n})}),(0,ed._)((0,iD._)(e),"renderSegmentInteraction",function(t){var n=e.props,r=n.post,o=r.id,i=r.allowSegmentInteraction,a=r.segmentInfos,c=r.isNormal,s=r.contentNeedTruncated,u=r.copyrightPermission,l=n.author,d=n.currentUser;return i&&!s&&(void 0===c||c)&&d?(0,m.tZ)(lF.Z,{contentType:"article",contentId:String(o),richTextRef:e.richTextRef,segmentsFromContent:a,author:l,isAuthor:t,reshipmentSettings:"reserved"===u?"disallowed":"allowed"}):null}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){var e=this;(0,uY.hx)();var t=this.props,n=t.location,r=t.router,o=t.loadVideoDetails,i=t.post,a=t.ua,c=t.getTrackUrl,s=t.loadContentRightsNotification,u=t.loadArticleRelationEndorsement,l=t.currentUser;dn(i.updated),u(i.id);var d=this.state.shareVideoQuery;i.trackUrl?this.setState({adTrackInfo:(0,pW.Z)(i,a)}):c(i.id).then(function(){e.setState({adTrackInfo:(0,pW.Z)(i,a)})}),d&&o(d).then(function(){e.setState({shouldShowVideoDetails:!0})});var p=n.query,f=p.just_published,h=p.is_recommend,_=(0,F._)(p,["just_published","is_recommend"]);(f||h)&&r.replace((0,er._)((0,G._)({},n),{query:_})),f&&s("article",i.id),this.scrollSubscription=(0,us.subscribe)("scroll",this.onscoll),l||this.setState({signFlowModalShown:!0}),this.setState({postMainRef:this.postMainRef.current}),aq.Z.trackPageShow({id:3366}),l&&(0,dt.ZP)("post",i.id,dt._x),dr({router:r,location:(0,er._)((0,G._)({},n),{query:_})}),(0,l8.ql)({type:"article",token:i.id,index:1}),(0,dl.Z)({contentToken:i.id,contentType:"article"})}},{key:"handleSignFlowModalClose",value:function(){this.setState({signFlowModalShown:!1})}},{key:"componentWillUnmount",value:function(){this.scrollSubscription&&this.scrollSubscription.unsubscribe(),clearTimeout(this.timeoutId)}},{key:"getByCommentFromHash",value:function(){var e=this.props.location.hash;return e&&iR(e)}},{key:"getJustPublishedQuery",value:function(){var e=this.props,t=e.author,n=e.location,r=e.currentUser;return(0,de.Z)(r,t)?n.query.just_published:null}},{key:"getShareVideoId",value:function(){return null}},{key:"renderPostTimeAreaExtra",value:function(){var e=this.props,t=e.post,n=e.selfRecommendedRepublishRequests,r=void 0===n?[]:n;return 0===r.length?null:(0,m.tZ)(lZ,{id:t.id,selfRecommendedRepublishRequests:r})}},{key:"render",value:function(){var e,t,n=this,r=this.props,o=r.ua,i=r.post,a=r.reward,c=r.rewardInfo,s=r.author,u=r.contributeRequests,l=r.location.query,d=r.shareVideoDetail,p=r.isRead,f=r.currentUser,h=r.readContentRightsNotification,_=r.ecommerce,g=r.shouldSpecialOia,T=r.isSearchSpecialSource,E=r.searchSpecialTitle,y=r.theme,C=r.blockStrategies,S=void 0===C?{}:C,I=S.isBlockingBindTopic,A=S.isBlockingComment,w=r.href,Z=r.trackToggleFollowAdPromotion,x=r.trackShareAdPromotion,k=r.trackPublishCommentAdPromotion,R=r.paidColumnContent;if(!i)return null;var N=i.id,O=i.imageUrl,L=i.imageWidth,M=i.imageHeight,B=i.title,U=i.isTitleImageFullScreen,F=i.content,H=i.voteupCount,z=i.reviewers,q=void 0===z?[]:z,V=i.created,W=i.updated,X=i.topics,K=i.paging,j=i.excerpt,Y=i.type,Q=i.url,J=i.commercialInfo,$=i.suggestEdit,ee=$.status,et=$.reason,en=i.creatorRightsNotification,er=i.visibleOnlyToAuthor,eo=i.paidInfo,ei=i.paidContent,ea=i.creationRelationship,ec=i.entityWords,es=i.ipInfo,eu=i.contentSourceText,el=i.contentNeedTruncated,ed=i.forceLoginWhenClickReadMore,ep=i.hasColumn,ef=i.catalog,eh=(0,de.Z)(f,s);if(!eh&&er)return(0,m.tZ)(u$,{});var e_=J||{},em=e_.isCommercial,ev=e_.plugin,eg=this.state,eT=eg.commentPattern,eE=eg.justPublishedQuery,ey=eg.shareVideoQuery,eC=eg.shouldShowVideoDetails,eS=eg.adTrackInfo,eI=eg.republishRequests,eA=eg.signFlowModalShown,eb=eg.followAuthorPopupCanShow,ew=eg.showPassModal,eZ=j.replace(/<.+?>/g,""),ex=(0,dH.f)(i),ek=JSON.stringify({userToken:f&&f.urlToken||""}),eR=JSON.stringify({authorName:s&&s.name,itemId:N,title:B,type:Y}),eN={title:d.title,thumbnail:d.coverUrl,isLens:!0,id:ey,isPlayable:!0,url:"https://www.zhihu.com/video/".concat(ey)},eO=!!(ev&&ev.download),eP="1"===P.Z.apollo.ad_in_pc_answer_article,eD=(void 0===eo?{}:eo).content,eL=(0,l9.St)(i)?eD:F,eM=(0,m.tZ)(dJ,{article:i,paging:K,rewardInfo:c,updateCommentStatus:this.updateCommentStatus,justPublished:!!eE,onContributeClick:this.handleShowContributionModal,onShare:x,showIgnoreOptions:!eh}),eB=(0,m.tZ)(dv,{postId:N,author:s,isAuthor:eh,followOpenInApp:g,onToggleFollow:Z}),eU=!ee||eh,eG=(0,uV.Z)(i,"post"),eF=null==ea?void 0:null===(e=ea.coCreation)||void 0===e?void 0:e.refBy,eH=null==ea?void 0:null===(t=ea.reference)||void 0===t?void 0:t.refBy,ez=O&&!ee&&(0,m.tZ)(dI,{src:O,width:L,height:M,alt:B,fullScreen:U,useImageX:!0,css:{marginTop:"0 !important",marginBottom:20}});return(0,m.BX)(fe,{module:"PostItem",content:{type:"Post",token:String(N),id:String(N)},index:0,children:[(0,m.tZ)(dd.Z,{pageInfo:{pageId:"10178"},pageOptions:{trackPageDisappear:!0}}),(0,m.tZ)(uq,{}),(0,m.BX)("div",{className:i$()("Post-content"),"data-zop-usertoken":ek,"data-zop":eR,children:[(0,m.tZ)(la,{entity:i}),!(0,l9.ny)(i)&&(0,m.tZ)(pD,{justPublishedQuery:eE,articleId:N,columnId:ex&&ex.id,getShowRecommendModalHandler:function(e){return n.showRecommendModalHandler=e}}),eA&&(0,m.tZ)(cM.Vy,{maskClosable:!1,showQrcodeFirst:!0,defaultType:"login",onClose:function(){n.handleSignFlowModalClose()}}),(0,m.tZ)(eJ.ql,{title:B,meta:(0,d2.r)(i)}),(0,m.tZ)(lf,{children:(0,m.tZ)(d$.Z,{articleTitle:B,columnId:ex&&ex.id,showAdblockBanner:!0,hideHeaderMenu:!0,isNewStyle:!0})}),(0,m.BX)("div",{className:"Post-Row-Content",children:[(0,m.BX)("div",{className:"Post-Row-Content-left",children:[(0,m.BX)("div",{className:"Post-Row-Content-left-article",children:[ez,(0,m.BX)("article",{className:i$()(pM,"Post-NormalMain"),ref:this.postMainRef,tabIndex:-1,children:[(0,m.tZ)(lo.Z,{type:"article",data:i}),(0,m.BX)(aA.wi,{root:this.state.postMainRef,children:[(0,m.BX)("header",{className:"Post-Header",children:[(0,m.tZ)("h1",{className:"Post-Title",children:B}),eB,!(0,l9.bP)(i)&&this.renderLabels(eh),(eF||eH)&&(0,m.tZ)(i0.xu,{my:"16px",children:(0,m.tZ)(uX.j7,{type:"article",coCreationRefBy:eF,referenceRefBy:eH})}),(0,m.tZ)(ft,{id:N,type:Y,voteupCount:H,query:l})]}),ee&&(0,m.tZ)(pt,{reason:et,isAuthor:eh}),(0,l9.bP)(i)&&(0,m.tZ)(uc.Z,{result:ei,extra:{ua:o,isDarkMode:y.isDarkMode}}),ey&&eC?(0,m.BX)(b.Fragment,{children:[(0,m.tZ)(lB.Z,{data:eN}),(0,m.tZ)("p",{className:"Post-VideoContentMore",onClick:this.handleClickVideoMoreButton,children:"点击查看全文"})]}):eU&&(0,m.tZ)(pd,{onRef:function(e){return n.richTextRef.current=e},html:eL,entityWords:ec,ecommerce:_,author:s,id:N,url:Q,title:B,isAuthor:eh,shouldShowCatalog:eG,contentNeedTruncated:el,forceLoginWhenClickReadMore:ed,catalog:ef}),this.renderSegmentInteraction(eh),el&&(0,m.tZ)(pB,{}),eU&&(0,m.tZ)(uW.Z,{content:F,type:"article",urlToken:String(N)}),(0,l9.St)(i)&&(0,m.tZ)(ua.Z,{result:ei,extra:{ua:o,theme:y}}),(0,l9.ny)(i)&&R&&(0,m.tZ)(uo.a,{data:R,css:{maxWidth:694,margin:"0 auto"},isContentPage:!0}),eO&&(0,m.tZ)(d9,{isMobile:!1,info:ev.download,related:eS}),!ee&&f&&!(0,l9.ny)(i)&&!(0,l9.St)(i)&&(0,m.tZ)(lx.Z,{imperativeRef:this.rewardContainerRef,reward:a,currentUser:f,rewardInfo:c,id:N,isAuthor:eh,author:s,ua:o,type:Y,balanceEnable:!1}),!ee&&!(0,l9.ny)(i)&&ep&&(0,m.tZ)(uK.Z,{type:"article",id:N,onFollowed:function(){n.setState({followAuthorPopupCanShow:!0})}}),!ee&&!(ey&&eC)&&(0,m.tZ)(lM,{created:V,updated:W,ipInfo:es,contentSourceText:eu,extraInlineComponent:this.renderPostTimeAreaExtra(),isContainAiContent:i.isContainAiContent}),!I&&!ee&&(X.length>0||q.length>0)&&(0,m.BX)("div",{className:"Post-topicsAndReviewer",children:[X.length>0&&(0,m.tZ)(l$,{className:i$()("Post-Topics",{"Post-TopicsReviewer":q.length>0}),topics:X,onItemClick:function(e){return(0,d_.E)(e,1295)}}),q.length>0&&(0,m.tZ)(dT,{reviewers:q,type:Y,isAuthor:eh})]}),eP&&(0,m.tZ)(uu.Z,{articleToken:N,setPromotionExtra:du.w}),!(ee&&!eh)&&eM]})]}),T&&(0,m.tZ)(lG,{className:"Post-searchSpecialButton",title:E}),!A&&!ee&&(0,m.tZ)(pV,{parent:i,byComment:this.getByCommentFromHash(),commentPattern:eT,updateCommentStatus:this.updateCommentStatus,onMount:this.onCommentMount,onComment:k})]}),(0,l9.ny)(i)&&R&&!s.isFollowing&&(0,m.tZ)(u0.Z,{paidColumnContent:R}),!ee&&!(0,l9.ny)(i)&&ep&&!s.isFollowing&&(0,m.tZ)(u0.Z,{type:"article",id:N,followAuthorPopupCanShow:eb})]}),(0,m.BX)(lK,{className:"Post-Row-Content-right",children:[(0,m.tZ)(uH,{answer:{author:s}}),(0,m.tZ)(ln,{sceneType:"article",contentType:"article",contentToken:N}),(0,m.tZ)(ul.C,{isMobile:!1,location:"new_article_right",delay:1e3,query:{article_token:N}})]})]}),(0,m.tZ)("div",{className:i$()("Post-Sub","Post-NormalSub"),children:!em&&!ee&&(0,m.tZ)(p9,{id:N})}),f&&(0,m.tZ)(pv,{postId:N,author:s,contributeRequests:u}),g&&(0,m.tZ)(lc.Z,{mainContentInPage:i,href:(0,eK.MN)({type:"article",id:N},(0,G._)({utm_content:"app_jumping",open:p?"1":"0"},(0,l9.bP)(i)&&{app_from:l.app_from||D.G5,redirect_from:encodeURIComponent(w),is_from_paid:1})),onClick:function(){var e;null===(e=n.oiaRef.current)||void 0===e||e.oiaWithTrack({type:"article",id:i.id,from:"poplayer"})}}),(0,m.tZ)(uj.Z,{notification:en,onRead:function(e){h("article",i.id,e)},onUseAdmire:function(){n.rewardContainerRef.current.activateReward()},onUseRecommend:function(){var e=n.props.postToolsRecommend;up.Z.confirm((0,m.tZ)("div",{style:{textAlign:"center"},children:"该推荐将使用本月的 1 次推荐次数。"}),{title:"确定是否推荐？"}).then(function(){return e("article",String(N))},function(){})},onOpenAdmire:function(){n.props.unlockCreatorRights("1513324000").then(function(){n.setState({showPassModal:!0})})}}),(0,m.tZ)(l7.Z,{rights:{id:"1513324000",name:"送礼物功能",url:"https://www.zhihu.com/creator/reward/community",linkType:"a"},show:ew,onClose:function(){n.setState({showPassModal:!1})}}),(0,m.BX)(sd.ZP,{children:[(0,m.tZ)(iH.l,{title:B,desc:eZ,extraQuery:l5(),imgUrl:O||ds}),(0,m.tZ)(l4,{})]}),(0,m.tZ)(lC,{entityType:"article",id:N,isAuthor:eh,onShowAllRequests:function(e){n.setState({republishRequests:e})}}),!!eI&&(0,m.tZ)(lw,{isAuthor:eh,republishRequests:eI,onClose:function(){n.setState({republishRequests:null})}})]}),(0,m.tZ)(uI.Z,{type:"article",id:N,index:0}),(0,m.tZ)(lh.Z,{type:"article",contentId:N,footerButton:"完成",contentTitle:B}),(0,m.tZ)(ug,{})]})}}]),n}(b.Component);(0,ed._)(fn,"propTypes",{post:iG().object,author:iG().object,contributions:iG().array,contributeRequests:iG().array,shareVideoDetail:iG().object,isSearchSpecialSource:iG().bool,searchSpecialTitle:iG().string,unlockCreatorRights:iG().func});var fr=(0,th.compose)((0,sj.ZP)("PostIndex-body"),(0,sY.g)({scene:sY.k.article}),c_.Z,(0,uT.fM)(!0),(0,uf.$)(),(0,e6.connect)(function(e,t){var n=t.params,r=e.entities,o=r.articles,i=r.users,a=r.columns,c=e.articleContribution,s=e.reward,u=e.video.shareVideoDetail,l=o[n.id];!(0,nS.isBrowser)()||l&&l.commercialInfo||window.Raven.captureException(Error("Missing post data in PostIndex."),{tags:{scope:"Column"},extra:{columns:a,articles:o,params:n}});var d=d3({columns:a,post:l,articleContribution:c}).contributions,p=d4({articleContribution:c}).contributeRequests,f=d5({reward:s,post:l}),h=f.articleReward,_=f.rewardInfo,m=l.author,g=(void 0===m?{}:m).urlToken,T=uS(e);return{post:l,contributions:d,contributeRequests:p,rewardInfo:_,reward:h,isSearchSpecialSource:T.isSearchSpecialSource,searchSpecialTitle:T.searchSpecialTitle,ua:(0,eU.Uh)(e),author:i[g]||l.author,shouldSpecialOia:(0,eU.cq)(e),shareVideoDetail:u,isRead:(0,rp.O8)(e,{type:"article",id:n.id}),ecommerce:(0,t_.G_)(e,{type:"article",urlToken:n.id}),selfRecommendedRepublishRequests:(0,rh.ij)(e),theme:e.env.theme,href:e.env.ctx.href}},{loadSwitches:ol.X2,loadVideoDetails:oO.hK,getTrackUrl:un.H,updateReadStatus:rp.m3,loadContentRightsNotification:nC.NC,readContentRightsNotification:nC.Uq,unlockCreatorRights:nC.g3,postToolsRecommend:nR.XX4,loadArticleRelationEndorsement:tE.iv}),(0,di.Z)({biz_tag:"Post"}),(0,ui.$_)({dataPath:"post",passThrough:function(e,t){var n=t.post;return!e.isBlockingVote&&d0.YP.includes(null==n?void 0:n.id)&&(e.isBlockingVote=!0),e}}),ui.OW,(0,l6.jM)({dataPath:"post"}),l6.LY,(0,uI._)({dataPath:"post"}),uy(function(e){if("OiaFollow.follow_click"===e.id)return["openDeeplink"]}),(0,da.U)(function(e){var t;return(0,l9.ny)(e.post)?"/api/v4/column/paid-column/card?content_type=article&content_id=".concat(null===(t=e.post)||void 0===t?void 0:t.id):null}))(fn),fo=n(20072),fi=n(58931),fa=n(76280),fc=n(16906),fs=n(10421),fu=n(67847),fl=n(16839),fd=n(99533),fp=n(62713),ff=n(62880),fh={position:"absolute",borderRadius:"13px",top:"4px",left:"27px",fontSize:"9px",padding:"0 2px",whiteSpace:"nowrap"},f_=function(e){var t=e.count,n=e.zeroCountText,r=e.renderIcon,o=e.onClick,i=e.isActive,a=e.activeCountTextColor,c=(0,ij.F)().colors;return(0,m.BX)(i0.kC,{alignItems:"center",justifyContent:"center",css:{width:"48px",height:"36px",position:"relative",color:i?c[a]:c.MapText04A},onClick:o,children:[r(),!!t&&(0,m.tZ)("div",{css:(0,er._)((0,G._)({},fh),{backgroundColor:c.MapUIFrame99B}),children:(0,s1.Zh)(t)}),!t&&n&&(0,m.tZ)("div",{css:(0,er._)((0,G._)({},fh),{color:c.MapUIFrame99B,backgroundColor:c.MapBrand}),children:n})]})},fm=function(e){var t=e.onClick;return(0,m.tZ)(i0.kC,{flex:1,height:34,px:"16px",bg:"MapUIFrame10A",alignItems:"center",css:{borderRadius:20},onClick:t,children:(0,m.tZ)(i0.xv,{fontSize:12,color:"MapText06A",children:"欢迎参与讨论"})})},fv=function(e){var t=e.voteCount,n=e.onClick,r=e.isActive;return(0,m.tZ)(f_,{onClick:n,isActive:r,activeCountTextColor:"MapBrand",count:t,zeroCountText:"赞同",renderIcon:function(){return r?(0,m.tZ)(fa.ZP,{css:function(e){return{fill:e.colors.MapBrand}}}):(0,m.tZ)(fc.Z,{})}})},fg=function(e){var t=e.onClick,n=e.isActive;return(0,m.tZ)(f_,{onClick:t,renderIcon:function(){return n?(0,m.tZ)(fs.Z,{css:function(e){return{fill:e.colors.MapText04A}}}):(0,m.tZ)(fu.Z,{})}})},fT=function(e){var t=e.collectCount,n=e.onClick,r=e.isActive;return(0,m.tZ)(f_,{onClick:n,count:t,isActive:r,activeCountTextColor:"MapFavorite",renderIcon:function(){return r?(0,m.tZ)(fl.ZP,{css:function(e){return{fill:e.colors.MapFavorite}}}):(0,m.tZ)(fd.Z,{})}})},fE=function(e){var t=e.commentCount,n=e.onClick;return(0,m.tZ)(f_,{onClick:n,count:t,renderIcon:function(){return(0,m.tZ)(fp.ZP,{})}})},fy=function(e){var t=e.type,n=e.id,r=e.voteCount,o=e.commentCount,i=e.collectCount,a=e.voting,c=e.isFavorited,s=(0,ij.F)().colors,u=(0,uT._u)(),l=(0,cL.A)(function(e){u({type:t,id:n,from:e})});return(0,m.BX)("div",{css:function(e){return{position:"fixed",bottom:0,width:"100%",backgroundColor:s.MapUIFrame99B,zIndex:100,borderTop:"1px solid ".concat(e.colors.MapUIFrame09A)}},className:"oia-action-bar",children:[(0,m.BX)("div",{css:{display:"flex",boxSizing:"border-box",padding:"6px 10px 6px 16px",alignItems:"center",justifyContent:"space-between",height:"60px"},children:[(0,m.tZ)(fm,{onClick:l.bind(null,"comment")}),(0,m.BX)("div",{css:{display:"flex",flex:1,justifyContent:"flex-end",marginRight:"6px"},children:[-1!==a&&(0,m.tZ)(fv,{voteCount:r,onClick:l.bind(null,"agree"),isActive:1===a}),1!==a&&(0,m.tZ)(fg,{onClick:l.bind(null,"disagree"),isActive:-1===a}),(0,m.tZ)(fT,{collectCount:i,onClick:l.bind(null,"authorsubscription"),isActive:!!c}),(0,m.tZ)(fE,{commentCount:o,onClick:l.bind(null,"comment")})]})]}),(0,m.tZ)(ff.dh,{})]})},fC=n(81037),fS=n(79091),fI=function(){var e=(0,uT._u)(),t=(0,b.useRef)(null),n=(0,b.useCallback)(function(){return!document.hidden&&"visible"===document.visibilityState},[]);return{handleSearch:(0,cL.A)(function(){var r=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).q,o="zhihu://search",i={utm_medium:"svipgrowth",utm_source:"MobileWeb",utm_division:"m_search_alluser",utm_id:"366140941972009"};r&&(i.q=r),Object.keys(i).length>0&&(o=(0,fS.D)(o,i)),location.href=o,t.current&&clearTimeout(t.current),t.current=setTimeout(function(){n()&&e&&e((0,G._)({target:"/search",from:"search_timeout"},Object.keys(i).length>0&&{options:i}))},2e3)}),cleanup:(0,b.useCallback)(function(){t.current&&(clearTimeout(t.current),t.current=null)},[])}},fA=n(58003),fb=n(27723),fw=n(1733);function fZ(){return(0,m.tZ)(fw.ZP,{arrowed:!1,positionStatus:"fixed",placement:"bottom-right",toggler:(0,m.tZ)(aC.ZP,{preset:"plain",title:"更多",children:(0,m.tZ)(fA.Z,{})}),css:{width:24,height:24,margin:"0 8px 0 10px"},children:(0,m.BX)(fw.sN,{onClick:function(){var e;null==window||null===(e=window.aria)||void 0===e||e.start()},css:{whiteSpace:"nowrap",paddingTop:10,paddingBottom:10},children:[(0,m.tZ)(fb.Z,{text:!0,center:!0,css:{marginRight:2}}),"关怀版"]})})}var fx=(0,c_.Z)(function(e){var t=e.type,n=e.id,r=(0,uT._u)(),o=(0,e6.useSelector)(eU.ze),i=fI().handleSearch;return o?null:(0,m.BX)(e7.ZAShow,{zaType:"Block",zaModuleId:"top_bar",children:[(0,m.BX)("div",{css:function(e){return{height:"60px",width:"100%",padding:"0 14px",position:"fixed",maxWidth:"var(--app-max-width)",boxShadow:"0px -0.5px 0px var(--MapUIFrame09A, #e8eaed) inset",display:"flex",top:0,boxSizing:" border-box",alignItems:"center",backgroundColor:e.colors.MapUIFrame99B,zIndex:100}},children:[(0,m.tZ)("img",{alt:"",css:{width:36,height:36,marginRight:"8px"},src:"https://pic1.zhimg.com/v2-45bd10426541b3d82bace746e8b5a53a.png"}),(0,m.BX)("div",{style:{flexDirection:"column",justifyContent:"center",alignItems:"flex-start",flex:1},children:[(0,m.tZ)("div",{css:function(e){return{color:e.colors.GBK03A,fontSize:"15px",fontWeight:"500",lineHeight:"18px"}},children:"知乎"}),(0,m.tZ)("div",{css:function(e){return{color:e.colors.GBK06A,fontSize:"12px",lineHeight:"18px"}},children:"有问题就会有答案"})]}),(0,m.tZ)(fC.ZP,{label:"打开App",preset:"primary",color:"blue",css:{borderRadius:"24px"},onClick:function(){null==r||r({type:t,id:n,from:"toplayer"})}}),(0,m.tZ)(e7.ZAClick,{shouldTrackShow:!0,zaType:"Button",zaAction:"OpenUrl",zaModuleId:"next_preset_button",onClick:function(){return i()},css:{marginLeft:"12px",display:"flex",alignItems:"center",width:"20px",height:"20px"},children:(0,m.tZ)(ai.ZP,{size:20})}),(0,m.tZ)(fZ,{})]}),(0,m.tZ)("div",{css:{height:"60px"}})]})}),fk=n(31011),fR=n(80550),fN=function(e){var t=e.onSuccessClick,n=(0,ef._)((0,cv.k)(!0),2),r=n[0],o=n[1],i=(0,fR.J)(600),a=(0,e0.n)(),c=um("oia_modal"),s=um("auto_pull"),u=(0,e6.useSelector)(eU.ze),l=a.BaiduApp&&a.Android,d=s&&l,p=(0,ef._)((0,cv.k)(!1),2),f=p[0],h=p[1];if((0,b.useEffect)(function(){if(d){var e=setTimeout(function(){h.on()},500);return function(){return clearTimeout(e)}}},[d,h]),!c||u)return null;var _=function(){d&&f?h.off():o.off()};return(0,m.tZ)(fk.Z,{size:"small",className:"OiaModal",onClose:_,css:{borderRadius:18,width:"288px","& .MobileModal-content":{padding:24}},closeButton:null,children:(r&&i||f)&&(0,m.BX)(e7.ZAShow,{extra:{configMap:{callback_from:"popup_frame"}},zaType:"Button",zaModuleId:"reback_poplayer_btn",children:[(0,m.tZ)(i0.kC,{fontSize:"18px",fontWeight:"bold",mb:"18px",justifyContent:"center",children:"是否在知乎 App 内阅读全文"}),(0,m.BX)(i0.kC,{justifyContent:"space-between",children:[(0,m.tZ)(fC.ZP,{color:"grey",preset:"secondary",css:{width:112,height:40,fontSize:15,borderRadius:24},onClick:_,children:"取消"}),(0,m.tZ)(fC.ZP,{color:"blue",preset:"primary",css:{width:112,height:40,fontSize:15,borderRadius:24},onClick:function(){null==t||t(),_()},children:"确认"})]})]})})};function fO(){var e=(0,e6.useSelector)(eU.ze),t=(0,uT._u)();return e?null:(0,m.tZ)(e7.ZAClick,{shouldTrackClick:!0,zaType:"Button",zaModuleId:"open_zhihu_more",children:(0,m.BX)("button",{type:"button",onClick:function(){t({target:"feed/item/recommend"})},css:{display:"flex",alignItems:"center",justifyContent:"center",gap:"4px",width:"100%",padding:"20px 0",border:"none",background:"transparent",cursor:"pointer"},children:[(0,m.tZ)("span",{css:function(e){return{fontWeight:500,fontSize:"15px",lineHeight:"normal",letterSpacing:"0.4px",color:e.colors.MapBrand}},children:"打开知乎查看更多内容"}),(0,m.tZ)(p6.N,{size:16,css:{fill:"#1772f6"}})]})})}var fP=n(6533),fD=n(29508),fL=(0,fD.H)("BizAdBanner"),fM=function(e){var t=e.type,n=e.token,r=e.className,o=(0,ef._)((0,b.useState)(function(){return(0,T.tL)()||{}}),1)[0],i=(0,e6.useSelector)(function(e){var t;return null===(t=e.env.vars)||void 0===t?void 0:t.oneID}),a=(0,e0.n)();return(0,b.useEffect)(function(){fL("MBannerAd2.data",{type:t,token:n,oneID:i,utmInfo:o})},[t,n,i,o]),(0,m.tZ)("div",{className:r,children:(0,m.tZ)(fP.ZP,{type:t,token:n,getuiInfo:i,utm_source:o.utm_source,isWechat:a.Wechat})})};function fB(e){return(0,m.tZ)(tc.SV,{replacement:null,children:(0,m.tZ)(sd.ZP,{children:(0,m.tZ)(fM,(0,G._)({},e))})})}var fU=n(73596),fG=n(38151),fF=n(49695),fH=n(76882),fz={isFollowing:!1,isFollowed:!1,isBlocking:!1,isBlocked:!1,type:null},fq=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).isFollowing;return"boolean"==typeof e};function fV(e){var t=e.author,n=e.className,r=(0,ef._)((0,b.useState)(null),2),o=r[0],i=r[1],a=(0,cy.n)(),c=(0,e6.useDispatch)(),s=fq(t)?t:o,u=(0,b.useContext)(uE).request,l=(0,cL.A)(function(){u({id:"OiaFollow.follow_click"})}),d=(0,ef._)((0,fG.Y)({once:!0}),2),p=d[0],f=d[1];return(0,b.useEffect)(function(){a&&!fq(t)&&f&&c((0,ra._u)(t.urlToken)).then(function(e){i(e.payload)})},[c,null==t?void 0:t.urlToken,t,f,a]),(0,m.BX)(m.HY,{children:[s?(0,m.tZ)(fF.z,{ref:p,size:"s",colorPreset:s.isFollowing?"grey":"secondary",label:s.isFollowing?"已关注":"关注",onClick:l,icon:s.isFollowing?null:(0,m.tZ)(fH.Z,{size:12}),className:n}):null,(0,m.tZ)("div",{ref:p,css:{position:"absolute",bottom:0,right:0,width:1,height:1}})]})}function fW(e){var t=e.author,n=(0,F._)(e,["author"]);return(0,cy.n)()?(0,m.tZ)(fV,(0,G._)({author:t},n)):(0,m.tZ)(fV,(0,G._)({author:fz},n))}function fX(e){var t=(0,uT._u)(),n=(0,cL.A)(function(){var n=e.author,r=n.id,o=n.urlToken;"0"!==r&&(null==t||t({type:"people",id:o,from:"authorpage"}))}),r=e.author,o=e.avatarSize,i=e.className,a=e.itemProp,c=e.roundAvatar,s=e.noDetail,u=e.isAuthor,l=e.followButtonAtFlexEnd;return(0,m.tZ)(e7.ZAEnv,{moduleId:"author_portrait_text_button",children:(0,m.BX)(i0.kC,{itemProp:a,itemScope:!0,itemType:"http://schema.org/Person",alignItems:"center",justifyContent:"space-between",className:i,children:[(0,m.BX)(i0.kC,{alignItems:"center",children:[(0,m.tZ)("meta",{itemProp:"name",content:r.name}),(0,m.tZ)("meta",{itemProp:"image",content:r.avatarUrl}),(0,m.tZ)("meta",{itemProp:"url",content:"https://www.zhihu.com/people/".concat(r.urlToken)}),(0,m.tZ)("meta",{itemProp:"zhihu:followerCount",content:r.followerCount}),(0,m.tZ)(s0.qE,{css:{flex:"none"},size:o,url:r.avatarUrl,round:c,alt:r.name,onClick:n}),(0,m.BX)(i0.xu,{css:{flex:1,marginLeft:8,overflow:"hidden"},children:[(0,m.tZ)(i0.xu,{fontSize:"15px",lineHeight:"22px",fontWeight:"bold",color:"MapText02A",onClick:n,children:r.name}),!s&&(0,m.tZ)(fU.Z,{css:function(e){return(0,G._)({fontSize:13,lineHeight:"19px",color:e.colors.MapText06A,whiteSpace:"unset"},(0,lm.S)(1))},user:r})]})]}),l&&!!(null==r?void 0:r.urlToken)&&!u&&(0,m.tZ)(fW,{author:r,css:{marginLeft:8}})]})})}fX.propTypes={author:iG().object.isRequired,isAuthor:iG().bool,avatarSize:iG().number,className:iG().string,itemProp:iG().string,roundAvatar:iG().bool,noDetail:iG().bool,followButtonAtFlexEnd:iG().bool},fX.defaultProps={roundAvatar:!1,itemProp:"author",avatarSize:36};var fK=n(94648),fj={load:"script-error",execute:"execute-error",init:"init-error"},fY={appId:"PYcmpWAzT46f7UD9xy6UQ2",url:"https://unpkg.zhimg.com/@cfe/assets@1.5.1/dist/third-party/gtoneid-h5-simple-min.js"},fQ=(0,fK.I)(function(){return(0,R.v)(fY.url).then(function(){var e=window.OneID;if(!e)throw ReferenceError(fj.execute,{cause:"window.OneID is not ready"});return new Promise(function(t,n){e.init({authorizedOpenid:!0,appId:fY.appId,onSuccess:function(e){t(e)},onFailure:function(e){var t="OneID init failed. cause by: "+("string"==typeof e?e:null==e?void 0:e.message);n(TypeError(fj.init,{cause:t}))}})})},function(e){var t="Load OneID-SDK is failed. cause by: "+(null==e?void 0:e.message);throw TypeError(fj.load,{cause:t})})}),fJ=(0,fD.H)("OneId"),f$=function(){var e=(0,e7.useTracker)(),t=(0,e6.useDispatch)(),n=function(e){e.then(function(e){fJ("success",e),t((0,eU.Ct)({oneID:e}))},function(e){fJ("failure",e),console.error("OneIDTracker",e);var n=((null==e?void 0:e.message)||e)===fj.init?null:void 0;t((0,eU.Ct)({oneID:n}))})},r=function(t){t.then(function(t){var n,r=t||{},o=r.oneAID,i=r.openid,a=r.openidType;e.trackShow({elementLocation:{type:"Block",moduleId:"one_id_virtual_module"}},{configMap:{one_id:null!=o?o:"unknown",openid:null!=i?i:"unknown",openid_type:null!==(n=null==a?void 0:a.toString())&&void 0!==n?n:"unknown"}})})};return(0,cg.b)(function(){var e=fQ();n(e),r(e)}),null},f0=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"trackClick",function(t){(0,d_.E)(t,{id:1299,action:"OpenUrl",name:e.props.column.title})}),e}return(0,U._)(n,[{key:"render",value:function(){var e=this.props,t=e.time,n=e.column,r=e.isPaidArticle,o=n&&!r;return(0,m.BX)("div",{className:"Post-TimeExtra",children:[(0,rw.rL)(t),o&&" \xb7 来自专栏 ",o&&(0,m.tZ)(lv.Z,{column:n,noHoverCard:!0,onClick:this.trackClick})]})}}]),n}(b.Component),f1=function(e){var t=e.module,n=e.content,r=e.children,o=e.index;return(0,m.tZ)(e7.ZAEnv,{content:n,moduleIndex:o,children:(0,m.tZ)(ud.r,{module:t,card:{content:n},children:r})})},f2=(0,c_.Z)(function(e){var t=e.id,n=e.type,r=e.voteupCount,o=e.query,i=e.authRequired,a=(0,dc.Z)(i,"true"===o.from_voters_page),c=a.modalShown,s=a.openVotersModal,u=a.closeVotersModal;return(0,m.BX)(m.HY,{children:[(0,m.tZ)(l_.Z,{contentType:"article",id:t,onClickVoterInfo:s}),(0,m.tZ)(l0.Z,{id:t,type:n,voteupCount:r,modalShown:c,handleListHide:u})]})}),f3=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"state",{columnHeaderShown:!1,contentDomPosition:"",commentPattern:e.getByCommentFromHash()?"fixed":"bottom",justPublishedQuery:e.getJustPublishedQuery(),shareVideoQuery:e.getShareVideoId(),shouldShowVideoDetails:!1,postMainRef:null,adTrackInfo:null,republishRequests:null,signFlowModalShown:!1}),(0,ed._)((0,iD._)(e),"alreadyScrolled",!1),(0,ed._)((0,iD._)(e),"postMainRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"rewardContainerRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"readMarkRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"oiaRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"onscoll",function(){var t=e.state.contentDomPosition,n=document.querySelector(".Post-RichText"),r=d1(n),o=n?n.getBoundingClientRect().height:0;if(!t){if(!n)return;e.setState({contentDomPosition:r+o})}(document.documentElement.scrollTop||document.body.scrollTop)+window.innerHeight>r+o&&(aq.Z.trackEvent((0,iD._)(e),{action:"ScrollToBottom"}),e.scrollSubscription.unsubscribe())}),(0,ed._)((0,iD._)(e),"handleVotersButtonClick",function(){var t=e.props,n=t.isMobile,r=t.post;n&&!D.dd&&(0,pj.F)(r.id,"vote_list")}),(0,ed._)((0,iD._)(e),"handleShowContributionModal",function(){e.showRecommendModalHandler&&e.showRecommendModalHandler()}),(0,ed._)((0,iD._)(e),"handleClickVideoMoreButton",function(){e.setState({shouldShowVideoDetails:!1})}),(0,ed._)((0,iD._)(e),"updateCommentStatus",function(t){e.state.commentPattern!==t&&("fixed"===t?e.props.trackOpenCommentAdPromotion():e.props.trackCloseCommentAdPromotion()),e.setState({commentPattern:t})}),(0,ed._)((0,iD._)(e),"onCommentMount",function(t){"#comments"!==e.props.location.hash||"bottom"!==e.state.commentPattern||e.alreadyScrolled||(e.timeoutId=setTimeout(function(){return t.scrollIntoView()},500))}),(0,ed._)((0,iD._)(e),"renderLabels",function(t){var n=e.props,r=n.post,o=n.isMobile,i=r.suggestEdit.status,a=r.annotationDetail,c=r.commercialInfo,s=r.visibleOnlyToAuthor;if(t&&s)return(0,m.tZ)(lH.Z,{});var u=(null==c?void 0:c.isCommercial)?{data:c}:null,l=o&&D.dd;return i||l?null:(0,m.tZ)(lr.Z,{commercialProps:u,annotationProps:!i&&a&&{annotationDetail:a},item:r})}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){var e=this;(0,uY.hx)();var t=this.props,n=t.location,r=t.router,o=t.loadVideoDetails,i=t.post,a=t.ua,c=t.getTrackUrl,s=t.updateReadStatus,u=t.loadContentRightsNotification,l=t.loadArticleRelationEndorsement,d=t.currentUser,p=t.isMobile;dn(i.updated),p||l(i.id);var f=this.state.shareVideoQuery;i.trackUrl?this.setState({adTrackInfo:(0,pW.Z)(i,a)}):c(i.id).then(function(){e.setState({adTrackInfo:(0,pW.Z)(i,a)})}),f&&o(f).then(function(){e.setState({shouldShowVideoDetails:!0})});var h=n.query,_=h.just_published,m=h.is_recommend,g=(0,F._)(h,["just_published","is_recommend"]);(_||m)&&r.replace((0,er._)((0,G._)({},n),{query:g})),_&&u("article",i.id),this.scrollSubscription=(0,us.subscribe)("scroll",this.onscoll),p&&this.readMarkRef.current&&(0,fo.y3)(this.readMarkRef.current,function(){return s({type:"article",id:i.id},!0)}),p||d||this.setState({signFlowModalShown:!0}),this.setState({postMainRef:this.postMainRef.current}),aq.Z.trackPageShow({id:3366}),d&&(0,dt.ZP)("post",i.id,dt._x),dr({router:r,location:(0,er._)((0,G._)({},n),{query:g})}),(0,l8.ql)({type:"article",token:i.id,index:1}),(0,dl.Z)({contentToken:i.id,contentType:"article"})}},{key:"handleSignFlowModalClose",value:function(){this.setState({signFlowModalShown:!1})}},{key:"componentWillUnmount",value:function(){this.scrollSubscription&&this.scrollSubscription.unsubscribe(),clearTimeout(this.timeoutId)}},{key:"getByCommentFromHash",value:function(){var e=this.props.location.hash;return e&&iR(e)}},{key:"getJustPublishedQuery",value:function(){var e=this.props,t=e.author,n=e.location,r=e.currentUser;return(0,de.Z)(r,t)?n.query.just_published:null}},{key:"getShareVideoId",value:function(){var e=this.props,t=e.location;return e.isMobile?t.query.preview_video_id:null}},{key:"renderPostTimeAreaExtra",value:function(){var e=this.props,t=e.post,n=e.selfRecommendedRepublishRequests,r=void 0===n?[]:n;return 0===r.length?null:(0,m.tZ)(lZ,{id:t.id,selfRecommendedRepublishRequests:r})}},{key:"render",value:function(){var e,t,n=this,r=this.props,o=r.ua,i=r.post,a=r.reward,c=r.rewardInfo,s=r.author,u=r.contributeRequests,l=r.location.query,d=r.shareVideoDetail,p=r.isRead,f=r.currentUser,h=r.readContentRightsNotification,_=r.ecommerce,g=r.shouldSpecialOia,T=r.isSearchSpecialSource,E=r.searchSpecialTitle,y=r.theme,C=r.isMobile,S=r.blockStrategies,I=void 0===S?{}:S,A=I.isBlockingBindTopic,w=I.isBlockingComment,Z=r.href,x=r.trackToggleFollowAdPromotion,k=r.trackShareAdPromotion,R=r.trackPublishCommentAdPromotion,N=r.paidColumnContent;if(!i)return null;var O=i.id,P=i.imageUrl,L=i.imageWidth,M=i.imageHeight,B=i.title,U=i.isTitleImageFullScreen,F=i.content,H=i.voteupCount,z=i.reviewers,q=void 0===z?[]:z,V=i.created,W=i.updated,X=i.topics,K=i.paging,j=i.excerpt,Y=i.type,Q=i.url,J=i.commercialInfo,$=i.suggestEdit,ee=$.status,et=$.reason,en=i.creatorRightsNotification,er=i.visibleOnlyToAuthor,eo=i.paidInfo,ei=i.paidContent,ea=i.commentCount,ec=i.likedCount,es=i.favlistsCount,eu=i.creationRelationship,el=i.entityWords,ed=i.ipInfo,ep=i.contentSourceText,ef=i.contentNeedTruncated,eh=i.voting,e_=i.isFavorited,em=i.forceLoginWhenClickReadMore,ev=i.hasColumn,eg=(0,de.Z)(f,s);if(!eg&&er)return(0,m.tZ)(u$,{});var eT=J||{},eE=eT.isCommercial,ey=eT.plugin,eC=this.state,eS=eC.commentPattern,eI=eC.justPublishedQuery,eA=eC.shareVideoQuery,eb=eC.shouldShowVideoDetails,ew=eC.adTrackInfo,eZ=eC.republishRequests,ex=eC.signFlowModalShown,ek=j.replace(/<.+?>/g,""),eR=(0,dH.f)(i),eN=JSON.stringify({userToken:f&&f.urlToken||""}),eO=JSON.stringify({authorName:s&&s.name,itemId:O,title:B,type:Y}),eP={title:d.title,thumbnail:d.coverUrl,isLens:!0,id:eA,isPlayable:!0,url:"https://www.zhihu.com/video/".concat(eA)},eD=!!(ey&&ey.download),eL=(void 0===eo?{}:eo).content,eM=(0,l9.St)(i)?eL:F,eB=C?(0,m.tZ)(fy,{id:O,type:"article",commentCount:ea,voteCount:H,likeCount:ec,collectCount:es,author:s,voting:eh,isFavorited:e_}):(0,m.tZ)(dJ,{article:i,paging:K,rewardInfo:c,updateCommentStatus:this.updateCommentStatus,justPublished:!!eI,onContributeClick:this.handleShowContributionModal,onShare:k}),eU=C?(0,m.tZ)(fX,{author:s,roundAvatar:!0,isAuthor:eg,css:{marginBottom:12,marginTop:16},followButtonAtFlexEnd:!0}):(0,m.tZ)(dv,{postId:O,author:s,isAuthor:eg,followOpenInApp:g,onToggleFollow:x}),eG=!ee||eg,eF=null==eu?void 0:null===(e=eu.coCreation)||void 0===e?void 0:e.refBy,eH=null==eu?void 0:null===(t=eu.reference)||void 0===t?void 0:t.refBy,ez=P&&!ee&&(C?(0,m.tZ)(db,{src:P,width:L,height:M,alt:B,css:{borderRadius:6,overflow:"hidden"}}):(0,m.tZ)(dI,{src:P,width:L,height:M,alt:B,fullScreen:!C&&U,useImageX:!0})),eq=(0,m.tZ)("h1",{css:{fontSize:20,fontWeight:"bold",marginTop:18,marginBottom:6,lineHeight:"32px"},children:B});return(0,m.BX)(f1,{module:"PostItem",content:{type:"Post",token:String(O),id:String(O)},index:0,children:[(0,m.tZ)(dd.Z,{pageInfo:{pageId:"10178"},pageOptions:{trackPageDisappear:!0}}),C&&(0,m.tZ)(fi.Z,{type:"post"}),(0,m.tZ)(uq,{}),(0,m.BX)("div",{className:i$()("Post-content",{"Post-content-mobile":C}),"data-zop-usertoken":eN,"data-zop":eO,children:[(0,m.tZ)(la,{entity:i}),!C&&!(0,l9.ny)(i)&&(0,m.tZ)(pD,{justPublishedQuery:eI,articleId:O,columnId:eR&&eR.id,getShowRecommendModalHandler:function(e){return n.showRecommendModalHandler=e}}),ex&&(0,m.tZ)(cM.Vy,{maskClosable:!1,showQrcodeFirst:!0,defaultType:"login",onClose:function(){n.handleSignFlowModalClose()}}),(0,m.tZ)(eJ.ql,{title:B,meta:(0,d2.r)(i)}),C&&(0,m.BX)(i0.xu,{css:{height:0},children:[(0,m.tZ)(fx,{type:"article",id:O}),(0,m.tZ)(uT.dn,{ref:this.oiaRef}),(0,m.tZ)(f$,{})]}),!C&&ez,(0,m.BX)("article",{className:i$()(pM,{"Post-NormalMain":!C,"Post-Main-Mobile":C}),ref:this.postMainRef,tabIndex:-1,children:[(0,m.tZ)(lo.Z,{type:"article",data:i}),(0,m.BX)(aA.wi,{root:this.state.postMainRef,children:[(0,m.BX)("header",{className:"Post-Header",children:[C?eq:(0,m.tZ)("h1",{className:"Post-Title",children:B}),!C&&eU,!(0,l9.bP)(i)&&this.renderLabels(eg),(eF||eH)&&(0,m.tZ)(i0.xu,{my:"16px",children:(0,m.tZ)(uX.j7,{type:"article",coCreationRefBy:eF,referenceRefBy:eH})}),!C&&(0,m.tZ)(f2,{id:O,type:Y,voteupCount:H,query:l})]}),ee&&(0,m.tZ)(pt,{reason:et,isAuthor:eg}),!ee&&C&&(0,m.tZ)(f0,{time:W,column:eR,isPaidArticle:(0,l9.St)(i)}),(0,l9.bP)(i)&&(0,m.tZ)(uc.Z,{result:ei,extra:{ua:o,isDarkMode:y.isDarkMode}}),C&&eU,C&&ez,eA&&eb?(0,m.BX)(b.Fragment,{children:[(0,m.tZ)(lB.Z,{data:eP}),(0,m.tZ)("p",{className:"Post-VideoContentMore",onClick:this.handleClickVideoMoreButton,children:"点击查看全文"})]}):eG&&(0,m.tZ)(pd,{html:eM,entityWords:el,ecommerce:_,author:s,id:O,url:Q,title:B,isAuthor:eg,contentNeedTruncated:ef,forceLoginWhenClickReadMore:em}),C&&!ef&&(0,m.tZ)(fO,{}),ef&&(0,m.tZ)(pB,{}),eG&&(0,m.tZ)(uW.Z,{content:F,type:"article",urlToken:String(O)}),(0,l9.St)(i)&&(0,m.tZ)(ua.Z,{result:ei,extra:{ua:o,theme:y}}),(0,l9.ny)(i)&&N&&(0,m.tZ)(uo.a,{data:N,css:{maxWidth:694,margin:"0 auto"},isContentPage:!0}),C&&(0,m.tZ)("div",{className:"Post-ReadMark",ref:this.readMarkRef}),eD&&(0,m.tZ)(d9,{isMobile:C,info:ey.download,related:ew}),!C&&!ee&&f&&!(0,l9.ny)(i)&&!(0,l9.St)(i)&&(0,m.tZ)(lx.Z,{imperativeRef:this.rewardContainerRef,reward:a,currentUser:f,rewardInfo:c,isMobile:C,id:O,isAuthor:eg,author:s,ua:o,type:Y,balanceEnable:!1}),!ee&&!(0,l9.ny)(i)&&ev&&(0,m.tZ)(uK.Z,{type:"article",id:O}),!ee&&!(eA&&eb)&&(0,m.tZ)(lM,{created:V,updated:W,ipInfo:ed,contentSourceText:ep,extraInlineComponent:this.renderPostTimeAreaExtra(),isContainAiContent:i.isContainAiContent}),!C&&!ee&&f&&!(0,l9.ny)(i)&&!(0,l9.St)(i)&&(0,m.tZ)(lx.Z,{imperativeRef:this.rewardContainerRef,reward:a,currentUser:f,rewardInfo:c,isMobile:C,id:O,isAuthor:eg,author:s,ua:o,type:Y,balanceEnable:!1}),!A&&!ee&&(C&&D.dd?null:(0,m.BX)("div",{className:"Post-topicsAndReviewer",children:[(0,m.tZ)(l$,{className:i$()("Post-Topics",{"Post-TopicsReviewer":q.length>0}),topics:X,onItemClick:function(e){return(0,d_.E)(e,1295)}}),q.length>0&&(0,m.tZ)(dT,{reviewers:q,type:Y,isAuthor:eg})]})),!C&&!(ee&&!eg)&&eB]})]}),T&&(0,m.tZ)(lG,{className:"Post-searchSpecialButton",title:E}),C&&(0,m.tZ)(fB,{token:O,type:"article",css:{padding:"0 16px"}}),(0,m.BX)("div",{className:i$()("Post-Sub",{"Post-NormalSub":!C,"Post-Sub-Mobile":C}),children:[!C&&!w&&!ee&&(0,m.tZ)(pV,{parent:i,byComment:this.getByCommentFromHash(),commentPattern:eS,updateCommentStatus:this.updateCommentStatus,onMount:this.onCommentMount,onComment:R}),!eE&&!ee&&(0,m.tZ)(p9,{id:O}),!C&&f&&(0,m.tZ)(pv,{postId:O,author:s,contributeRequests:u})]}),g&&(0,m.tZ)(lc.Z,{mainContentInPage:i,href:(0,eK.MN)({type:"article",id:O},(0,G._)({utm_content:"app_jumping",open:p?"1":"0"},(0,l9.bP)(i)&&{app_from:l.app_from||D.G5,redirect_from:encodeURIComponent(Z),is_from_paid:1})),onClick:function(){var e;null===(e=n.oiaRef.current)||void 0===e||e.oiaWithTrack({type:"article",id:i.id,from:"poplayer"})}}),C&&(0,m.tZ)(fN,{onSuccessClick:function(){var e;null===(e=n.oiaRef.current)||void 0===e||e.oiaWithTrack({type:"article",id:i.id,from:"popup_frame"})}}),C&&!(ee&&!eg)&&eB,(0,m.tZ)(uj.Z,{notification:en,onRead:function(e){h("article",i.id,e)},onUseAdmire:function(){n.rewardContainerRef.current.activateReward()},onUseRecommend:function(){var e=n.props.postToolsRecommend;up.Z.confirm((0,m.tZ)("div",{style:{textAlign:"center"},children:"该推荐将使用本月的 1 次推荐次数。"}),{title:"确定是否推荐？"}).then(function(){return e("article",String(O))},function(){})}}),(0,m.BX)(sd.ZP,{children:[(0,m.tZ)(iH.l,{title:B,desc:ek,extraQuery:l5(),imgUrl:P||ds}),(0,m.tZ)(l4,{})]}),!C&&(0,m.tZ)(lC,{entityType:"article",id:O,isAuthor:eg,onShowAllRequests:function(e){n.setState({republishRequests:e})}}),!C&&!!eZ&&(0,m.tZ)(lw,{isAuthor:eg,republishRequests:eZ,onClose:function(){n.setState({republishRequests:null})}})]}),(0,m.tZ)(uI.Z,{type:"article",id:O,index:0}),(0,m.tZ)(lh.Z,{type:"article",contentId:O,footerButton:"完成"}),(0,m.tZ)(ug,{}),C&&(0,m.tZ)(lc.x,{})]})}}]),n}(b.Component);(0,ed._)(f3,"propTypes",{post:iG().object,author:iG().object,contributions:iG().array,contributeRequests:iG().array,shareVideoDetail:iG().object,isSearchSpecialSource:iG().bool,searchSpecialTitle:iG().string});var f4=(0,th.compose)((0,sj.ZP)("WhiteBg-body PostIndex-body"),(0,sY.g)({scene:sY.k.article}),c_.Z,(0,uT.fM)(!0),(0,uf.$)(),(0,e6.connect)(function(e,t){var n=t.params,r=e.entities,o=r.articles,i=r.users,a=r.columns,c=e.articleContribution,s=e.reward,u=e.video.shareVideoDetail,l=o[n.id];!(0,nS.isBrowser)()||l&&l.commercialInfo||window.Raven.captureException(Error("Missing post data in PostIndex."),{tags:{scope:"Column"},extra:{columns:a,articles:o,params:n}});var d=d4({articleContribution:c}).contributeRequests,p=d5({reward:s,post:l}),f=p.articleReward,h=p.rewardInfo,_=l.author,m=(void 0===_?{}:_).urlToken,g=uS(e);return{post:l,contributeRequests:d,rewardInfo:h,reward:f,isSearchSpecialSource:g.isSearchSpecialSource,searchSpecialTitle:g.searchSpecialTitle,ua:(0,eU.Uh)(e),author:i[m]||l.author,shouldSpecialOia:(0,eU.cq)(e),shareVideoDetail:u,isRead:(0,rp.O8)(e,{type:"article",id:n.id}),ecommerce:(0,t_.G_)(e,{type:"article",urlToken:n.id}),selfRecommendedRepublishRequests:(0,rh.ij)(e),theme:e.env.theme,href:e.env.ctx.href}},{loadSwitches:ol.X2,loadVideoDetails:oO.hK,getTrackUrl:un.H,updateReadStatus:rp.m3,loadContentRightsNotification:nC.NC,readContentRightsNotification:nC.Uq,postToolsRecommend:nR.XX4,loadArticleRelationEndorsement:tE.iv}),(0,di.Z)({biz_tag:"Post"}),(0,ui.$_)({dataPath:"post",passThrough:function(e,t){var n=t.post;return!e.isBlockingVote&&d0.YP.includes(null==n?void 0:n.id)&&(e.isBlockingVote=!0),e}}),ui.OW,(0,l6.jM)({dataPath:"post"}),l6.LY,(0,uI._)({dataPath:"post"}),uy(function(e){if("OiaFollow.follow_click"===e.id)return["openDeeplink"]}),(0,da.U)(function(e){var t;return(0,l9.ny)(e.post)?"/api/v4/column/paid-column/card?content_type=article&content_id=".concat(null===(t=e.post)||void 0===t?void 0:t.id):null}))(f3),f5=function(e){return(0,eU.dD)()?(0,m.tZ)(f4,(0,G._)({},e)):(0,m.tZ)(fr,(0,G._)({},e))};f5.fetchData=function(e){e.ctx,e.http;var t=e.params.id,n=e.dispatch,r=e.ua,o=e.location,i=e.location.query,a=e.getState;return Promise.all([null,n((0,ur.xl)(t,{zhiPlusFlag:i.zpf})).then(function(e){if("paid"===e.payload.articleType)return r.Mobile&&ut({ua:r,env:a().env,location:o}),n((0,ur.Qo)(t))}),n((0,un.H)(t)),n((0,ur.vM)(t))])};var f6=(0,tM.P1)([function(e){return e.comments},function(e){return e.entities.comments},function(e,t){return t.target},eU.Hu],function(e,t,n,r){var o=e.pagination,i=(void 0===o?{}:o)[n]||{},a=i.isDrained,c=i.isFetching,s=i.isPrevDrained,u=i.newIds,l=i.ids,d=i.totals;return{isDrained:a,isFetching:c,isPrevDrained:s,newComments:(r?(void 0===u?[]:u).slice(0,d0.lg):void 0===l?[]:l).map(function(e){return t[e]}),totals:d}}),f7=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"handleDeleteComment",function(){var t=e.props,n=t.id,r=t.postId;e.props.deleteComment(n,"article",r)}),e}return(0,U._)(n,[{key:"render",value:function(){var e=this.props,t=e.author,n=t.member,r=t.member,o=(void 0===r?{}:r).name,i=e.isAuthor,a=e.createdTime,c=e.isArticleAuthor;return(0,m.BX)("div",{className:"PreviewAuthorInfo",children:[(0,m.tZ)(uL.Z,{className:"PreviewAuthorInfo-avatarWrapper",user:n,avatar:!0,avatarProps:{className:"AuthorInfo-avatar",size:36,round:!0}}),(0,m.BX)("div",{className:"PreviewAuthorInfo-content",children:[(0,m.BX)("div",{className:"PreviewAuthorInfo-head",children:[(0,m.tZ)("span",{className:"PreviewAuthorInfo-Author",children:o}),c&&(0,m.tZ)("span",{className:"PreviewAuthorInfo-Type",children:"(作者)"})]}),(0,m.BX)("div",{className:"PreviewAuthorInfo-detail",children:[(0,m.tZ)("span",{children:(0,rw.rL)(a)}),(i||c)&&(0,m.BX)("span",{role:"button",tabIndex:0,className:"PreviewAuthorInfo-DeleteButton",onClick:this.handleDeleteComment,children:[" ","\xb7 删除"]})]})]})]})}}]),n}(b.Component);(0,ed._)(f7,"propTypes",{author:iG().object.isRequired,createdTime:iG().number.isRequired,id:iG().number.isRequired,postId:iG().string.isRequired,isArticleAuthor:iG().bool}),(0,ed._)(f7,"defaultProps",{author:{},isArticleAuthor:!1});var f8=(0,th.compose)((0,e6.connect)(null,{deleteComment:function(e,t,n){return function(r,o){var i=o(),a={API:{types:na.DELETE,endpoint:"comments/".concat(e),method:"delete"}},c={UPDATE:{request:{},failure:{}}},s=i.entities.comments[e];s&&(c.UPDATE.request.comments=(0,ed._)({},e,{isDelete:!0}),c.UPDATE.failure.comments=(0,ed._)({},e,s));var u="".concat(t,"s"),l=(i.entities[u]||{})[n],d=!!s&&s.reviewing;return l&&!d&&(c.UPDATE.request[u]=(0,ed._)({},n,{commentCount:l.commentCount-1}),c.UPDATE.failure[u]=(0,ed._)({},n,l)),r((0,er._)((0,G._)({id:e,collapsed:s&&s.collapsed,reviewing:d,parentType:t,parentId:n},a,c),{NOTIFICATION:{key:t1.zQ,failure:t1.XR}}))}}}))(f7),f9=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"render",value:function(){var e=this.props,t=e.comment,n=t.author,r=t.content,o=t.createdTime,i=t.id,a=t.isDelete,c=e.postId,s=e.postAuthor;if(a)return null;var u=s.id===n.member.id;return(0,m.BX)("div",{className:"PreviewContent",children:[(0,m.tZ)(f8,{author:n,createdTime:o,postId:c,id:i,isArticleAuthor:u}),(0,m.tZ)(pa.Z,{html:r,className:"PreviewContent-RichText"}),(0,m.tZ)(pK,{className:"PreviewContent-Line"})]})}}]),n}(b.Component);(0,ed._)(f9,"propTypes",{comment:iG().object,postId:iG().string,postAuthor:iG().object});var he=n(69578),ht=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"state",{active:!1,disabled:!0,changeHeight:!1}),(0,ed._)((0,iD._)(e),"handleSubmit",function(){var t=e.input.toHTML({source:"PreviewComments_onSubmit"});e.addComment(t)}),(0,ed._)((0,iD._)(e),"handleBlur",function(){var t=e.state.disabled;t&&(document.querySelector(".PreviewComments-content").style.height="518px",e.setState({changeHeight:!1})),e.setState({active:!t})}),(0,ed._)((0,iD._)(e),"handleChange",function(t){e.setState({disabled:t.isEmpty})}),(0,ed._)((0,iD._)(e),"handleFocus",function(){if(!e.state.changeHeight){var t=document.querySelector(".PreviewComments-content").offsetHeight+48;document.querySelector(".PreviewComments-content").style.height="".concat(t,"px"),e.setState({changeHeight:!0})}e.setState({active:!0})}),(0,ed._)((0,iD._)(e),"addComment",function(t){var n,r=["article_review",e.props.id,t];(n=e.props).addComment.apply(n,(0,g._)(r)).then(function(){e.input.reset()})}),e}return(0,U._)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.active,r=t.disabled;return(0,m.BX)("div",{className:"PreviewComments-InputContent",children:[(0,m.tZ)(he.Z,{allowMention:!0,allowPasteRichText:!1,outputBlockType:"div",ref:function(t){e.input=t},placeholder:"写下你的评论…",onFocus:this.handleFocus,onBlur:this.handleBlur,onChange:this.handleChange,onSubmit:this.handleSubmit}),n&&(0,m.tZ)(aC.ZP,(0,er._)((0,G._)({},{preset:"primary",color:"blue",children:"评论",disabled:r}),{className:"PreviewComments-singleButton",onClick:this.handleSubmit}))]})}}]),n}(b.Component);(0,ed._)(ht,"propTypes",{id:iG().number.isRequired});var hn=(0,th.compose)((0,e6.connect)(null,{addComment:function(e,t,n,r,o){return function(i,a){var c="".concat(e,"s"),s=(a().entities[c]||{})[t]||{};if(!s.isSubmitting){var u,l,d=s.commentCount,p=nc[e]||e,f="评论发布成功！";return"commercial"===s.questionType&&"censor"===s.commentPermission&&(f=(null===(u=s.question)||void 0===u?void 0:null===(l=u.brand)||void 0===l?void 0:l.toastCommentDescription)||"评论已提交，由品牌筛选后公开"),i({parentType:e,parentId:t,id:o,API:{types:na.ADD,endpoint:"".concat(p,"s/").concat(t,"/comments"),method:"POST",fetchOptions:{zsEncrypt:!0,body:(0,ea.decamelizeKeys)({content:n,replyToId:r})}},schema:tq.l.COMMENT,UPDATE:{request:(0,ed._)({},c,(0,ed._)({},t,{commentCount:d+1,isSubmitting:!0})),success:(0,ed._)({},c,(0,ed._)({},t,{isSubmitting:!1})),failure:(0,ed._)({},c,(0,ed._)({},t,{commentCount:d,isSubmitting:!1}))},NOTIFICATION:{key:t1.zQ,success:f,failure:"评论发布失败。"},replyToId:r})}}}}))(ht),hr=n.p+"assets/comment.d46c2c85.png",ho=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"render",value:function(){return(0,m.BX)("div",{className:"PreviewComments-EmptyComment",children:[(0,m.tZ)("img",{src:hr,alt:"无草稿评论"}),(0,m.tZ)("p",{className:"PreviewComments-EmptyCommentText",children:"暂无草稿评论"})]})}}]),n}(b.PureComponent),hi=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"load",function(t){var n=e.props;(0,n.loadComments)("article_review",n.previewPost.id,{order:"normal",isPrevious:t})}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){this.load()}},{key:"render",value:function(){var e=this.props,t=e.isDrained,n=e.isFetching,r=e.isPrevDrained,o=e.comments,i=e.previewPost,a=i.id,c=i.author,s=e.className,u=e.close;return(0,m.tZ)("div",{className:i$()("PreviewComments",s),children:(0,m.BX)("div",{className:"PreviewComments-content",children:[(0,m.tZ)("p",{className:"PreviewComments-title",children:"草稿评论"}),(0,m.tZ)("p",{className:"PreviewComments-description",children:"文章发表后草稿评论仅文章作者可见"}),o.length>0?(0,m.tZ)(sJ.ZP,{className:"PreviewComments-List",isLocal:!0,isLoading:n,isPrevDrained:r,isDrained:t,onLoad:this.load,placeholder:(0,m.tZ)(sJ.i,{className:"CommentItem",small:!0}),children:o.map(function(e){return(0,m.tZ)(f9,{comment:e,postId:a,postAuthor:c},e.id)})}):(0,m.tZ)(ho,{}),(0,m.tZ)(hn,{id:a}),u]})})}}]),n}(b.Component);(0,ed._)(hi,"propTypes",{previewPost:iG().object.isRequired,post:iG().object,isDrained:iG().bool,isFetching:iG().bool,isPrevDrained:iG().bool,comments:iG().array,className:iG().string,close:iG().element}),(0,ed._)(hi,"defaultProps",{comments:[]});var ha=(0,th.compose)((0,aw.Z)(null),(0,e6.connect)(function(e,t){var n=t.post||e.previewPost,r=f6(e,{target:"article_review_".concat(n.id)});return{comments:r.newComments,previewPost:n,isDrained:r.isDrained,isFetching:r.isFetching,isPrevDrained:r.isPrevDrained}},{loadComments:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.order,o=void 0===r?"normal":r,i=n.isPrevious,a=void 0!==i&&i,c=n.byComment,s=n.status,u=void 0===s?"open":s,l=n.commentPattern,d=n.current,p=n.patternLimit,f=void 0===p?20:p,h=arguments.length>3?arguments[3]:void 0;return function(n,r){var i=r().comments,s=i.pagination,p=na.GET;"reviewing"===u&&(s=i.reviewing,p=na.GET_REVIEWING),"collapsed"===u&&(s=i.collapsed,p=na.GET_COLLAPSED),"reverse"===o&&"open"===u&&(s=i.reverse,p=na.GET_REVERSE);var _=s["".concat(e,"_").concat(t)]||{},m=_.next,g=_.previous,T=_.ids,E=(void 0===T?[]:T).length&&(a?g:m),y=0,C=ni.VZ;return"bottom"!==l||h||(y=(d-1)*f,C=f,E=!1),n({parentId:t,parentType:e,isPrevious:a,API:(0,er._)((0,G._)({types:p},E?{endpoint:E}:{endpoint:"".concat(nc[e]||e,"s/").concat(t,"/comments"),query:(0,G._)({include:"data[*].author",order:o,limit:C},"open"===u&&c?{byComment:c}:{offset:y,status:u})}),{headers:{"X-APP-VERSION":"6.42.0"}}),schema:tq.l.COMMENT_ARRAY,UPDATE:{failure:function(n){return n&&n.res&&403===n.res.status?(0,ed._)({},"".concat(e,"s"),(0,ed._)({},t,{adminClosedComment:!0})):{}}},NOTIFICATION:{key:t1.zQ,failure:function(e){return(!e||403!==e.code)&&"获取评论失败，请稍后重试"}}})}}}))(hi),hc=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"render",value:function(){var e=this.props,t=e.previewPost,n=e.location,r=e.isMobile,o=t.imageUrl,i=t.imageWidth,a=t.imageHeight,c=t.title,s=t.isTitleImageFullScreen,u=t.content,l=t.author,d=t.column,p=t.topics,f=t.created,h=t.updated,_=n.query,g=_.catalog,T=_.comment,E=!r&&(g?"1"===g:(0,uV.Z)(this.props.previewPost,"post")),y=(0,m.tZ)(dv,{author:l,isAuthor:!0});return(0,m.BX)(m.HY,{children:[!r&&(0,m.tZ)(lf,{children:(0,m.tZ)(d$.Z,{articleTitle:c,columnId:d&&d.id,hideHeaderMenu:!0,isNewStyle:!0})}),(0,m.BX)("div",{className:"PreviewPost-content",css:{overflow:"hidden"},children:[(0,m.tZ)(eJ.ql,{title:c}),o&&(0,m.tZ)(dI,{src:o,width:i,height:a,alt:c,fullScreen:s}),r&&y,(0,m.BX)("article",{className:"PreviewPost-Main",children:[(0,m.BX)("header",{children:[(0,m.tZ)("h1",{className:"PreviewPost-Title",children:c}),!r&&y]}),(0,m.tZ)(pa.Z,{html:u,className:"PreviewPost-RichText",shouldShowCatalog:E}),(0,m.tZ)(lM,{created:f,updated:h}),(0,m.tZ)(l$,{topics:p,css:{marginBottom:"-10px",padding:"16px 0",".Topic":{height:"33px",fontSize:"13px",lineHeight:"33px",overflow:"hidden",marginBottom:"10px"}}}),!r&&"0"!==T&&(0,m.tZ)(ha,{})]})]})]})}}]),n}(b.Component);(0,ed._)(hc,"fetchData",function(e){var t;return(0,e.dispatch)((t=e.params.id,{API:{root:P.Z.fetchRoot.zhuanlan,types:iy.GET,endpoint:"/articles/".concat(t,"/review"),method:"GET",fetchOptions:{credentials:"include"}},schema:tq.l.ARTICLE}))}),(0,ed._)(hc,"propTypes",{previewPost:iG().object});var hs=(0,th.compose)((0,uf.$)({includeTablet:!0}),(0,e6.connect)(function(e){return{previewPost:e.previewPost}}))(hc),hu=n(24187),hl=n(9478),hd=n.n(hl),hp=n(88329),hf=n.n(hp),hh=n(99682),h_=n(20303),hm=n(28435),hv=(0,b.createContext)({}),hg=(0,iZ.withRouter)(function(e){var t=e.to,n=e.router,r=(0,b.useContext)(hv);return r.url||(r.url=t),(0,b.useEffect)(function(){(0,ec.sD)(t)?window.location.replace(t):n.replace(t)},[n,t]),null}),hT=n(28209),hE=n(48710),hy=n(33722),hC=n(19064),hS=n(26921),hI=n(83290),hA=n(36591),hb=n(92995),hw=n(12564),hZ="postEditorV2Guide",hx=hb.Z("2021-12-04 00:00:00"),hk=function(e){var t=e.ratio,n=e.className,r=(0,F._)(e,["ratio","className"]);return(0,m.tZ)(dy.Z,{ratio:t,className:n,css:{marginBottom:"16px"},children:(0,m.tZ)(i0.Ee,(0,G._)({width:"100%",height:"100%"},r))})},hR=function(e){var t=e.imageUrl,n=e.children;return(0,m.BX)(i0.kC,{alignItems:"center",css:{marginBottom:"16px"},children:[(0,m.tZ)(i0.Ee,{src:t,alt:"1",flex:"0 0 15px",height:"15px",mr:"8px"}),(0,m.tZ)("p",{children:n})]})},hN=function(){var e=(0,ef._)((0,cv.k)(!1),2),t=e[0],n=e[1];return(0,b.useEffect)(function(){+new Date>hx||"1"===O().get(hZ)||setTimeout(function(){n.on(),O().set(hZ,"1")},5e3)},[n]),(0,m.tZ)(sc.Z,{title:"版本升级",onClose:n.off,closeButton:null,maskClosable:!1,hotKeyClosable:!1,css:{color:"inherit",width:"660px"},children:t&&(0,m.BX)(i0.xu,{color:"GBK02A",fontSize:"14px",lineHeight:"20px",children:[(0,m.BX)(i0.xu,{height:"370px",css:{overflow:"auto"},children:[(0,m.tZ)("p",{css:{marginBottom:"16px"},children:"亲爱的创作者～知乎网页版的文章编辑器迎来了期待已久的全面更新啦，在最新一版中，我们有了全新排版的创作区域：工具栏、编辑区域、发布设置。"}),(0,m.tZ)(hR,{imageUrl:"https://pic1.zhimg.com/v2-659cdb7ba796ad9164a9d3c207efa43f.png",children:"工具栏划分为：操作、文字、高级、插入、其他、帮助文档这六个部分，并新增了：图片库\xa0/\xa0图片编辑、二级标题和帮助文档。"}),(0,m.tZ)(hk,{ratio:1860/337,src:"https://pic2.zhimg.com/v2-4aeafd0f11c297240c659c9e77d0aa67.png",alt:"工具栏"}),(0,m.tZ)(hR,{imageUrl:"https://pic3.zhimg.com/v2-e2c434e38a5827bcc4a25399530d7a7f.png",children:"内容编辑区域扩大至\xa0800\xa0px，满足你的大屏创作体验。"}),(0,m.tZ)(hk,{ratio:1860/381,src:"https://pic2.zhimg.com/v2-ef52146433f6be97677f406bc4f7ea99.png",alt:"内容区"}),(0,m.tZ)(hR,{imageUrl:"https://pica.zhimg.com/v2-ddec683f2b10b1d5476a7f60f14fef0c.png",children:"发布设置集中在内容编辑区域下方，还新增了预览功能，写文、设置、预览、发布让创作变得行云流水。"}),(0,m.tZ)(hk,{ratio:4.96,src:"https://pic1.zhimg.com/v2-d195780f2be87c02ece0156da8c7d7a7.png",alt:"发布设置"}),(0,m.tZ)("p",{children:"知乎网页版文章编辑器感谢各位创作者的声音，快来体验我们共创的编辑器吧，更多功能持续更新中..."})]}),(0,m.tZ)(i0.xu,{css:{textAlign:"center"},children:(0,m.tZ)(hw.ZP,{preset:"primary",color:"blue",onClick:n.off,css:{width:"359px",margin:"25px auto 0"},children:"我知道了"})})]})})},hO=function(){return(0,m.BX)("div",{css:{paddingTop:"16px",marginBottom:-10,h2:{paddingBottom:"20px",fontWeight:"500",fontSize:"24px",textAlign:"center"},p:{textAlign:"center",fontSize:"14px"}},children:[(0,m.tZ)("h2",{children:"近 7 日发布文章数量已达上限"}),(0,m.tZ)("p",{children:"根据你的创作者等级，你在最近 7 个自然日可发布的文章数量已达上限，当前编辑将存入草稿。你还可以尝试「想法」创作，期待你的更多内容。"})]})},hP=n(55549),hD=n(78920),hL=n(48864),hM=n(65233),hB=n(37705),hU=n(50074),hG=n(84469),hF=n(7933),hH=n(84071),hz=n(23074),hq=n(36212),hV=n(99616),hW=n(41766),hX=n(64875),hK=n(20826),hj=n(27278),hY=n(72004),hQ=n(71119),hJ=n(617),h$=n(77234),h0=n(65003),h1=n(81374),h2=n(48929),h3=n(38765),h4=n(65277),h5=n(9278),h6=n(65379),h7=n(50605),h8=n(66294),h9=function(e,t,n){var r=(0,p0.Xs)(e,n);if(0===r)return{ok:!1,message:null};var o=r-t;return o>0?{ok:!1,message:"已超过 ".concat(o," 个字")}:o>=-10?{ok:!0,message:"还可以输入 ".concat(-o," 个字")}:{ok:!0,message:null}},_e=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"check","title"===e.props.type?function(e){return h9(e,100)}:function(e){return h9(e,1e5,!0)}),(0,ed._)((0,iD._)(e),"state",e.check(e.props.content)),(0,ed._)((0,iD._)(e),"compareState",function(t){var n=t.ok,r=t.message;return e.state.message!==r||e.state.ok!==n}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){this.props.onStatusChange(this.state.ok)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.onStatusChange,r=t.content;if(e.content!==r){var o=this.check(e.content);this.compareState(o)&&(n(o.ok),this.setState(o))}}},{key:"shouldComponentUpdate",value:function(e,t){return this.compareState(t)}},{key:"render",value:function(){var e=this.state,t=e.ok,n=e.message,r=i$()("WriteIndex-LengthStatus",{"WriteIndex-LengthStatus-warning":!t});return n&&(0,m.tZ)("div",{className:r,children:n})}}]),n}(b.Component);(0,ed._)(_e,"propTypes",{content:iG().string,type:iG().oneOf(["content","title"]).isRequired,onStatusChange:iG().func.isRequired});var _t=n(55542),_n={draftSave:"DraftSave",draftLoad:"DraftLoad",editableEdit:"Editable.Edit",editableInit:"Editable.Init"},_r=_n.draftSave,_o=(0,fD.H)("PostEditor"),_i=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){(0,B._)(this,n),o=t.apply(this,arguments),(0,ed._)((0,iD._)(o),"toHTMLAbortController",null),(0,ed._)((0,iD._)(o),"state",{content:o.props.content,realTimeContent:o.props.content,draftHistoryModalShown:!1,baiduFileSelectorShown:!1,showUserProfitCardSelector:!1,mcnEditingGood:null,toolbarMenuAttention:null,initialScheduledPublishAt:o.props.scheduledPublishAt,highlightData:null,currentLinkTextReplacedInfo:null}),(0,ed._)((0,iD._)(o),"getEntityId",function(){return["article",o.props.postId||"initial"].join("-")});var e,r,o,i=(0,iD._)(o);(0,ed._)((0,iD._)(o),"syncDraft",(0,h6.Z)(o.props.reporter.wrapAutoRecord(_r,(e=(0,u1._)(function(e){var t,n,r,o,a,c,s,u,l,d,p,f;return(0,u2.__generator)(this,function(h){switch(h.label){case 0:if(r=(n=i.props).updateDraft,o=n.logTime,a=n.onTyping,c=n.getEditableInstance,u=performance.now(),!(D.o8&&"function"==typeof(null==e?void 0:e.toHTMLAsync)))return[3,2];return null===(l=i.toHTMLAbortController)||void 0===l||l.abort(),i.toHTMLAbortController=new AbortController,d=i.toHTMLAbortController.signal,[4,e.toHTMLAsync({signal:d})];case 1:return s=h.sent(),_o("toHTMLAsync",performance.now()-u),[3,3];case 2:s=e.toHTML({source:"ColumnEditor_onChange"}),_o("toHTML",performance.now()-u),h.label=3;case 3:return i.setState({realTimeContent:s}),p=o("calculate"),f={content:s,table_of_contents:null===(t=c())||void 0===t?void 0:t.hasCatalog(),delta_time:p},i.ignoreNextSave?i.ignoreNextSave=!1:i.props.editorEventPublisher.fire({type:"saveDraft",context:{content:s}}),[2,r(f).finally(function(){return a(!1)})]}})}),function(t){return e.apply(this,arguments)})),h8.Ij)),(0,ed._)((0,iD._)(o),"handleChangeContent",function(e){var t=o.props,n=t.logTime;(0,t.onTyping)(!0),n("start"),o.syncDraft(e)});var a=(0,iD._)(o);return(0,ed._)((0,iD._)(o),"uploadImage",(r=(0,u1._)(function(e){var t,n,r,o;return(0,u2.__generator)(this,function(i){switch(i.label){case 0:if(n=(t=a.props).uploadImage,r=t.uploadContentImage,!hQ.U.has(e))return[3,2];return[4,fetch(e).then(function(e){return e.blob()})];case 1:return o=n.apply(void 0,[i.sent(),"default","article"]).then(function(e){return(0,h2.R)(e.payload)}),[3,3];case 2:o=r(e,"article").then(function(e){return(0,_t.s)(e,"article",a.props.postId)}),i.label=3;case 3:return[2,o.catch(function(e){var t;throw a.props.editorEventPublisher.fire({type:"post-upload",context:{type:"image",error:e,imageCount:(null===(t=a.editable.getImages())||void 0===t?void 0:t.size)||0}}),e})]}})}),function(e){return r.apply(this,arguments)})),(0,ed._)((0,iD._)(o),"uploadVideo",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.props.uploadVideo.apply(void 0,(0,g._)(t)).then(function(e){return e.payload}).catch(function(e){var t;throw o.props.editorEventPublisher.fire({type:"post-upload",context:{type:"video",error:e,videoCount:(null===(t=o.editable.getVideos())||void 0===t?void 0:t.size)||0}}),e})}),(0,ed._)((0,iD._)(o),"handleError",function(e,t){var n=o.props.showErrorMessage;(0,oV.Xc)(e,t,n)}),(0,ed._)((0,iD._)(o),"uploadImageError",function(e){var t=o.props.showErrorMessage,n=(0,_t.e)(e);if(n)return t(n)}),(0,ed._)((0,iD._)(o),"handleUploadError",function(e,t){switch(t){case"video":o.handleError("video-upload-error");break;case"image":o.handleError("image-upload-error",e)}}),(0,ed._)((0,iD._)(o),"onTransformVideoPoster",function(e){return(0,h1.K)(e,"article",o.props.postId)}),(0,ed._)((0,iD._)(o),"handleInsertZVideo",function(){var e,t;null===(t=(e=o.props).handleToggleInsertVideoState)||void 0===t||t.call(e,!0)}),(0,ed._)((0,iD._)(o),"trackUserProfitCardshow",eA()(function(){aq.Z.trackCardShow(null,{id:6096})})),(0,ed._)((0,iD._)(o),"getToolbarMenuPlugins",function(){return null}),(0,ed._)((0,iD._)(o),"setUseScheduledPublish",function(e,t){var n=o.props.onScheduledPublishAtChange;if(e){if(t)n(t);else{var r=hP.Z(new Date,30);o.setState({initialScheduledPublishAt:r}),n(r)}}else up.Z.confirm("取消后，当前设定的定时发布将不会生效，确定要取消发布吗？",{title:"取消定时发布",text:{cancel:"我再想想"}}).then(function(){n(void 0),aq.Z.trackEvent(o,{action:"Click",id:5737,name:"文章"})}).catch(function(){aq.Z.trackEvent((0,iD._)(o),{action:"Click",id:5736,name:"文章"})}),aq.Z.trackCardShow((0,iD._)(o),{id:5735,name:"文章"})}),(0,ed._)((0,iD._)(o),"handleReverted",function(e){var t=e.draft,n=t.content,r=t.title,i=o.props,a=i.logTime,c=i.updateDraft;a("start"),c({content:n,title:r,delta_time:a("calculate")}).finally(function(){return o.editable.resetWithValue(n)})}),(0,ed._)((0,iD._)(o),"handleEditGGRCard",function(e){var t=e.type,n=e.payload,r=o.state.mcnEditingGood,i=o.props.updateLinkCard;if("goodsEditor/submitNewGoodsInfo"===t){i((0,er._)((0,G._)({},r),{title:null==n?void 0:n.title})).finally(function(){o.setState({mcnEditingGood:null}),o.editable.handleCommand("edit-mcn-link-card:".concat(r.id))});return}if("goodsEditor/closeGoodsEditor"===t){o.setState({mcnEditingGood:null});return}}),(0,ed._)((0,iD._)(o),"onAfterChangeContent",function(e){(0,h0.n)(e,{offsetBottom:65,offsetTop:63})}),(0,ed._)((0,iD._)(o),"getSentences",function(){return o.props.isReediting?o.props.getInteractText("articles",o.props.postId).then(function(e){var t;return null==e?void 0:null===(t=e.payload)||void 0===t?void 0:t.data}):null}),(0,ed._)((0,iD._)(o),"handleReplaceLinkText",function(e){o.setState({currentLinkTextReplacedInfo:e})}),(0,ed._)((0,iD._)(o),"getLinkTextReplacedInfo",function(){var e=o.state.currentLinkTextReplacedInfo;return e&&o.setState({currentLinkTextReplacedInfo:null}),e}),(0,ed._)((0,iD._)(o),"getLinkAccount",function(e){return e?o.props.getAccountBinding().then(function(e){return null==e?void 0:e.payload}):o.props.accountBinding}),(0,ed._)((0,iD._)(o),"createEditorPlugins",function(){var e,t=(0,hF.Z)({type:"article",getId:function(){return o.props.postId},getDraftId:function(){return o.props.postId},draftType:"article",syncDraft:o.syncDraft,shouldShowToolbarButton:function(){return o.props.postId},getLocalDraftQueue:function(){return o.getLocalDraftQueue()}}),n=(0,hX.Z)({shouldShow:function(){return o.props.showUserProfitButton},getContentInfo:function(){return{type:"article",id:o.props.postId}}}),r=(0,hG.Z)(),i=o.props.isAIAssistantEnabled&&o.props.isAIImageEnabled,a=(0,hW.Z)({sourceType:"article",sourceId:o.props.postId,onUseAiImageFeature:i?o.props.onUseAiImageFeature:null});o.helpDocPlugin=(0,hz.Z)({getInitialOffset:o.props.getHelpDocInitialOffset,forceUpdate:o.props.forceUpdateWriteIndex});var c=(0,hV.Z)({onToggle:o.props.toggleMarkdownEnabled}),s=(0,hq.Z)({getSentences:o.getSentences}),u=(0,hH.Z)({scene:"article",contentToken:o.props.postId,traceId:o.props.traceId,getLinkTextReplacedInfo:o.getLinkTextReplacedInfo}),l=[s,t,n,r,a,o.helpDocPlugin,c,u];return o.props.isAIAssistantEnabled&&l.push((0,hU.Z)({getContentId:function(){return o.props.postId},getContentTitle:function(){return o.props.post.title},setContentTitle:function(e){var t,n;return null===(n=(t=o.props).onTitleChange)||void 0===n?void 0:n.call(t,e)},getEditableCore:function(){var e;return null===(e=o.editable)||void 0===e?void 0:e.EditableCore},uid:null===(e=o.props.currentUser)||void 0===e?void 0:e.id,contentType:"article",toggleAIAssistantPanel:function(e){var t,n;null===(n=(t=o.props).toggleAIAssistantPanel)||void 0===n||n.call(t,e)},aiAssistantRef:o.props.aiAssistantRef,getStickyInfo:function(){var e=window.innerWidth<=1500;try{var t=document.querySelector(".WriteIndex-titleInput"),n=document.querySelector(".WriteIndexMain").getBoundingClientRect(),r=t.offsetHeight+32;return{fixStyle:{zIndex:1,left:e?n.right-304+"px":n.right+10+"px",right:"unset",top:e?"63px":"73px",height:e?"calc(100vh - 63px - 52px)":"calc(100vh - 63px - 20px - 52px)"},normalStyle:{position:"absolute",top:"".concat(-(r+1)+"px"),right:e?"-326px":"-330px",left:"unset",height:e?window.innerHeight-63-52-52-10:window.innerHeight-63-52-52-20},offset:e?63:73,scrollOffset:e?63:73}}catch(t){return{fixStyle:{zIndex:1,left:"".concat(window.innerWidth-300,"px"),right:"unset",top:"73px",height:"calc(100vh - 200px)"},normalStyle:{position:"absolute",top:"-60px",right:"-330px",left:"unset",height:400},offset:50,scrollOffset:e?63:73}}}})),l}),(0,ed._)((0,iD._)(o),"editableReady",function(){o.props.reporter.reportSuccess(_n.editableInit)}),o}return(0,U._)(n,[{key:"canUseScheduledPublish",get:function(){var e=this.props,t=e.currentUser,n=e.isReediting;return t&&t.autoSendingCreations&&!n}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;if(e.content&&this.props.content!==e.content){this.setState({realTimeContent:e.content});var n=this.editable.isContentEmpty();(!this.editable||n)&&this.props.editorEventPublisher.fire({type:"loadDraftSuccess",context:{content:e.content}}),this.editable&&n?this.props.reporter.wrapAutoRecord(_n.draftLoad,function(){t.ignoreNextSave=!0,t.editable.resetWithValue(e.content)})():this.setState({content:e.content})}}},{key:"componentDidMount",value:function(){var e,t=this,n=this.props,r=n.editorEventPublisher,o=n.traceId;r.setCommonMessage({traceId:o}),(0,hY.$)(r);var i=(0,hj.W)(r,this.getEntityId,function(){return o},function(){return t.editable}).getLocalDraftQueue;this.getLocalDraftQueue=i,r.fire({type:"mount",context:{currentUserId:null===(e=this.props.currentUser)||void 0===e?void 0:e.id,href:window.location.href,browserContentScripts:(0,h4.l)(),content:this.props.content}}),this.props.reporter.reportRequest(_n.editableInit);var a=this.props,c=a.fillCurrentUserIfNeeded,s=a.getUserProfitPermission,u=a.loadCreatorRightStatus,l=c(["autoSendingCreations","mcn_user_info"]);s(),u(),Promise.resolve(l).then(function(){M.Z.getActionsByNames(["p_draft_history",t.canUseScheduledPublish&&"auto_pub_article"].filter(Boolean)).then(function(e){var n=(0,ef._)(e,1)[0];n&&(t.setState({toolbarMenuAttention:n.description}),M.Z.markAsShown(n),"auto_pub_article"===n.guide_name&&aq.Z.trackCardShow(t,{id:5738}))})}),O().set("debug","ali-oss"),window.onbeforeunload=function(){return t.syncDraft.pending()||t.props.draft&&t.props.draft.updating?"草稿尚未保存完毕，确定离开此页？":void 0},aq.Z.trackCardShow(this,{id:5729,name:"文章"}),(0,h$.a)(["t","e"])}},{key:"componentWillUnmount",value:function(){this.props.editorEventPublisher.fire({type:"unmount"}),null===(e=this.toHTMLAbortController)||void 0===e||e.abort();var e,t=this.props.editorEventPublisher;setTimeout(function(){t.unsubscribe()},4e4),this.syncDraft.cancel(),(0,h$.n)()}},{key:"render",value:function(){var e=this,t=this.props,n=t.onEditableRef,r=t.videoPoster,o=t.onLengthStatusChange,i=t.couldSuperVideoUpload,a=t.post,c=t.publishArea,s=t.handleAnyChange,u=t.showInsertableVideoUploader,l=t.handleToggleInsertVideoState,d=t.onCloseCatalog,p=t.getMarkdownEnabled,f=this.state,h=f.content,_=f.mcnEditingGood,g=f.realTimeContent,T=f.toolbarMenuAttention,E=f.initialScheduledPublishAt;return(0,m.BX)("div",{className:"PostEditor-wrapper",children:[(0,m.BX)("div",{css:{minHeight:"calc(100vh - 190px)"},children:[(0,m.BX)(uY.vB,{name:_n.editableEdit,children:[(0,m.tZ)(hL.Z,{editorFrom:"article-pc-editor",storageKey:"article-pc-editor"}),(0,m.tZ)(hB.Z,{ref:function(t){e.editable=t,n&&n(t)},large:!0,richtext:!0,spread:!0,allowLinkCard:!0,allowImageCaption:!0,allowResizeImage:!0,allowMention:!0,allowDragAndDrop:!0,allowToolbar:!0,allowToolbarSticky:!0,allowInlineCode:!0,allowUploadDocument:!0,allowVideoTitleChange:!0,allowZVideo:!0,allowReference:!0,allowTable:!0,allowHeaderThree:!1,placeholder:"请输入正文",className:"PostEditor EditorSnapshotWrapper",editingContentType:"article",toolbarMenuAttention:T,getToolbarMenuPlugins:this.getToolbarMenuPlugins,onInsertZVideo:this.handleInsertZVideo,toolbarProps:{menuCallout:null},onReady:this.editableReady,onChange:this.handleChangeContent,onAnyChange:s,onImageUpload:this.uploadImage,onVideoUpload:this.uploadVideo,defaultValue:h,poster:(void 0===r?{}:r).url,onError:this.handleError,uploadImageError:this.uploadImageError,onUploadError:this.handleUploadError,couldSuperVideoUpload:i,onMCNLinkCardEdit:function(t,n){e.setState({mcnEditingGood:n})},onReplaceLinkText:this.handleReplaceLinkText,useEditableV2:!0,createEditorPlugins:this.createEditorPlugins,allowCatalog:!0,useCatalogV2:!0,stickyOffset:92,css:{".Editable_CatalogV2":{left:-210}},useImageOperationV2:!0,catalogEnabled:(0,uV.Z)(a,"post"),maskGradientColor:"GBK99A",showToolbar:!1,useV2Feature:!0,allowImageEditor:!0,onTransformVideoPoster:this.onTransformVideoPoster,onCloseCatalog:d,onAfterChange:this.onAfterChangeContent,docPluginProps:(0,hM.Z)(this.props.creatorRightStatus,this.props.postId),getMarkdownEnabled:p,getLinkAccount:this.getLinkAccount,videoSource:"article",mentionSuggestionConfig:this.props.mentionSuggestionConfig})]}),(0,m.tZ)(_e,{content:g,type:"content",onStatusChange:o}),(0,m.tZ)(tf.Z,{className:"PostEditor-MCNEditor",title:"编辑商品",onClose:function(){e.setState({mcnEditingGood:null})},children:!!_&&(0,m.tZ)(hD.Z,{className:"PostEditor-MCNEditorIframe",src:(0,h3.l6)({title:_.title,originTitle:_.originTitle,source:_.source,sourceId:_.sourceId,productTypeName:_.productTypeName}),onMessage:this.handleEditGGRCard})}),u&&(0,m.tZ)(hJ.Z,{show:u,onClose:function(){null==l||l(!1)},onZVideoSubmit:function(t){null==l||l(!1),e.editable.handleCommand("insert-zvideo-card:".concat(JSON.stringify(t)))},onVideoSubmit:function(t){null==l||l(!1),e.editable.handleCommand("insert-video-card",t)}})]}),c&&w().cloneElement(c,{setUseScheduledPublish:this.setUseScheduledPublish,initialScheduledPublishAt:E,canUseScheduledPublish:this.canUseScheduledPublish,contentIsTooShort:9>(0,p0.Xs)(g,!0),realTimeContent:g,title:null==a?void 0:a.title})]})}}]),n}(b.Component);(0,ed._)(_i,"propTypes",{postId:iG().string,content:iG().string.isRequired,logTime:iG().func.isRequired,onEditableRef:iG().func,onTyping:iG().func.isRequired,onLengthStatusChange:iG().func.isRequired,updateDraft:iG().func.isRequired,showErrorMessage:iG().func.isRequired,onScheduledPublishAtChange:iG().func.isRequired,showInsertableVideoUploader:iG().bool,handleToggleInsertVideoState:iG().func,handleAnyChange:iG().func,onCloseCatalog:iG().func,isReediting:iG().bool.isRequired,getEditableInstance:iG().func,toggleMarkdownEnabled:iG().func,getMarkdownEnabled:iG().func,toggleAIAssistantPanel:iG().func,aiAssistantRef:iG().object,isAIAssistantEnabled:iG().bool,http:iG().func,onTitleChange:iG().func,accountBinding:iG().object,getAccountBinding:iG().func,isOffice:iG().bool});var _a=(0,th.compose)((0,e6.connect)(function(e){return{couldSuperVideoUpload:ol.yS.includes(e.currentUser),currentUser:(0,eB.ib)(e),showUserProfitButton:e.userProfit.permission.visible,creatorRightStatus:(0,nZ.Sy)(e),isOffice:(0,eU.Xj)(e)}},{uploadImage:oR.Ix,uploadContentImage:function(e,t){return function(n){return n(("string"!=typeof e?ie:o9)(oY,e,t)).then(it)}},uploadVideo:function(e){return{API:{types:oQ,endpoint:"/api/embedded_videos",root:P.Z.fetchRoot.lens,method:"POST",body:{url:e}}}},fillCurrentUserIfNeeded:eB.sF,getUserProfitPermission:oN.Yr,loadCreatorRightStatus:nZ.Xd,updateLinkCard:n0.ko,getInteractText:h7.k,getAccountBinding:ia}),hE.SS,hK.eU,uY.l0,(0,h5.Fd)({scene:h5.xK.ArticleEditor}),h4.ZP)(_i),_c=n(72280),_s=n(91708),_u=n(37127),_l=n(86385),_d=n(7464),_p=n(51455),_f=n(66268),_h=n(13905),__=n(34434),_m=n(3681),_v=n(84407),_g=n(84778),_T=iG().shape({updated:iG().number,description:iG().string,title:iG().string,url:iG().string,commentPermission:iG().string,created:iG().number,acceptSubmission:iG().boolean,intro:iG().string,imageUrl:iG().string,type:iG().string,urlToken:iG().string,id:iG().string}),_E=n(97234),_y=function(e){var t=(0,e7.useTracker)().trackEvent;return(0,m.tZ)(_E.Z,(0,er._)((0,G._)({css:function(e){return[{display:"flex",width:"150px",height:"100px",borderRadius:"4px",border:"1px dashed",borderColor:e.colors.GBL05A,alignItems:"center"}]},onClick:function(){t({eventType:"Click",action:"Upload",elementLocation:{type:"Button",text:"上传封面"}})}},e),{children:(0,m.BX)(i0.xv,{color:"GBL05A",css:{fontSize:"12px",fontWeight:500,width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,m.tZ)(av.nY,{size:14,css:{marginRight:"4px"}}),"添加文章封面"]})}))},_C=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"uploadImage",function(t){var n=t.file;if(n){var r=e.props,o=r.logTime,i=r.updateDraft,a=r.uploadCover,c=r.showNotification;o("start");var s=o("calculate");if(n.size>1048576*D.i3)return c("抱歉！请上传大小为 ".concat(D.i3,"M 以下的图片文件"),"red");a(n,"article").then(function(t){return i({titleImage:(0,h1.K)(t.url,"article",e.props.source),isTitleImageFullScreen:!1,delta_time:s})}).catch(hf())}}),(0,ed._)((0,iD._)(e),"handleRemove",function(){var t=e.props,n=t.logTime,r=t.updateDraft,o=t.removeCover;n("start"),r({titleImage:"",delta_time:n("calculate")}).then(o)}),e}return(0,U._)(n,[{key:"render",value:function(){var e=this,t=this.props.image;return(0,m.BX)("div",{children:[t&&(0,m.BX)(i0.xu,{css:{position:"relative",width:"150px",height:"100px","&:hover .WriteCoverV2-buttonGroup":{display:"flex"}},children:[(0,m.tZ)(i0.Ee,{alt:"封面图",src:t,size:"100%",css:{display:"block",borderRadius:"4px",objectFit:"cover"}}),(0,m.BX)(i0.kC,{className:"WriteCoverV2-buttonGroup",css:function(e){return{display:"none",height:"32px",position:"absolute",left:"50%",bottom:"8px",transform:"translateX(-50%)",zIndex:"1",background:e.colorMod(e.colors.GBK02B).alpha(.75),borderRadius:"4px",border:0,alignItems:"center",".Button":{color:e.colors.GBK99B,fontSize:"13px",borderRadius:"4px",height:"32px",width:"47px",display:"flex",alignItems:"center",justifyContent:"center",border:"0",padding:"0","&:active":{background:e.colors.GBK02B,opacity:"0.5"}}}},children:[(0,m.tZ)(e7.ZAClick,{as:aC.ZP,zaText:!0,zaType:"Button",zaAction:"Upload",title:"更换",onClick:function(){return e.uploadNode.click()},children:"更换"}),(0,m.tZ)(i0.xu,{height:"12px",width:"1px",bg:"GBK09A"}),(0,m.tZ)(e7.ZAClick,{as:aC.ZP,zaText:!0,zaType:"Button",zaAction:"Unknown",title:"删除",onClick:this.handleRemove,children:"删除"})]})]}),(0,m.tZ)(_y,{accept:".jpeg, .jpg, .png",customUpload:this.uploadImage,css:t&&{display:"none"},onRef:function(t){t&&(e.uploadNode=t)}}),(0,m.tZ)(i0.xv,{color:"GBK06A",mt:"8px",css:{fontSize:"13px",lineHeight:"20px"},children:"图片上传格式支持 JPEG、JPG、PNG"})]})}}]),n}(b.Component);(0,ed._)(_C,"propTypes",{image:iG().string,onRef:iG().func,logTime:iG().func.isRequired,updateDraft:iG().func}),(0,ed._)(_C,"defaultProps",{onRef:function(){}});var _S=(0,th.compose)((0,aw.Z)(null),(0,e6.connect)(null,{uploadCover:function(e,t){return e.length&&(e=e[0]),function(n){return n(ie(oj,e,t)).then(it)}},removeCover:function(){return{type:o5}},showNotification:t1.c0}))(_C),_I=n(21260),_A=n(62250),_b=n(27521),_w=n(64512);function _Z(e,t,n,r){var o,i,a,c=new _b.y;r&&c.set("publish",{traceId:r}),c.setExtraInfo("publisher","pc"),c.set("draft",{disabled:1,id:String(e),isPublished:!n}),(null===(o=t.pay_type_config)||void 0===o?void 0:o.type)&&c.set("pay_type_config",t.pay_type_config),t.publish_at&&c.set("schedule",{publishAt:t.publish_at});var s=null===(i=t.column)||void 0===i?void 0:i.id;s&&c.set("column",{column:[s]});var u=null==t?void 0:t.column_truncate_config;u&&c.set("column_truncate_config",u);var l=(0,uh.hZ)(t);return l&&c.setExtraInfo("pc_business_params",l),c.set("commentsPermission",{comment_permission:t.commentPermission}),c.set("creationStatement",{disclaimer_type:t.disclaimer_type,disclaimer_status:t.disclaimer_status}),c.set("contentsTables",{table_of_contents_enabled:t.table_of_contents_enabled}),c.set("commercialReportInfo",{isReport:(null===(a=t.commercial_report_info)||void 0===a?void 0:a.is_report)?1:0}),c.set("appreciate",{can_reward:t.canReward,tagline:t.canReward?"真诚赞赏，手留余香":""}),t.commercial_zhitask_bind_info&&c.set("commercialZhitaskBindInfo",{bindOperate:t.commercial_zhitask_bind_info.bind_operate,taskId:String(t.commercial_zhitask_bind_info.task_id),taskType:t.commercial_zhitask_bind_info.task_type}),c.set("hybridInfo",{contentSource:t.content_source}),c.set("hybrid",{html:t.content,textLength:(0,_I.V)(t.content)}),c.set("title",{title:t.title}),c.build()}var _x="PublishPost",_k="PublishPanelV2",_R=function(){requestAnimationFrame(function(){location.href="https://".concat(P.Z.wwwHost,"/draft?type=article")})},_N=function(e){requestAnimationFrame(function(){location.href=e})},_O=n(58635),_P=function(e){var t=(0,e6.useDispatch)(),n=e.updateDraft,r=e.columns,o=e.truncateRatio,i=e.payTypeConfig,a=(0,e6.useSelector)(function(e){return e.articleDraft.selectedColumn});return(0,m.tZ)(_O.Z,(0,er._)((0,G._)({},e),{selectedColumnId:a,onSelect:function(e){t(ii(e));var a=r.find(function(t){return t.id===e});n((0,G._)({column:e?[e]:[]},(0,_g.x)(a)?{pay_type_config:(null==i?void 0:i.type)?i:{type:_p.v8,price:"0"},column_truncate_config:{text:{ratio:o}}}:{column_truncate_config:{text:{ratio:null}}}))},noSelectTips:"将发布到个人主页的「文章」栏目下"}))},_D=n(86057),_L=n.n(_D),_M=n(3560),_B=function(e){var t=e.data,n=void 0===t?0:t,r=_M.Y_.ICON_DECLINE,o=_M.Y_.ICON_FLAT,i=_M.Y_.ICON_RISE,a=(0,m.tZ)(i0.Ee,{width:"18px",mr:"6px",src:o});return _L()(n)&&n.includes("%")&&(n=Number(n.replace(/%/,""))),n>0&&(a=(0,m.tZ)(i0.Ee,{width:"16px",mr:"6px",src:i})),n<0&&(a=(0,m.tZ)(i0.Ee,{width:"16px",mr:"6px",src:r})),a},_U=n(22627),_G=n(48725),_F=n(94307),_H=n(31142),_z=n(46906),_q=n(7181),_V=function(e){return(0,m.tZ)(_q.Z,(0,G._)({css:{marginLeft:"3px"},toggler:(0,m.tZ)(i0.xu,{children:(0,m.tZ)(_z.x,{center:!0,size:16,css:function(e){return{color:e.colors.GBK07A}}})}),placement:"top",toggleEvent:"hover",arrowed:!0},e))},_W=function(e){var t=e.children,n=(0,F._)(e,["children"]);return(0,m.tZ)(i0.kC,(0,er._)((0,G._)({color:"GBL05A",py:"16px",css:function(e){return{fontSize:"14px",borderBottom:"1px solid ".concat(e.colors.GBK09A)}}},n),{children:t}))},_X=function(e){var t=e.children,n=(0,F._)(e,["children"]);return(0,m.tZ)(i0.kC,(0,er._)((0,G._)({py:"15px",css:function(e){return{alignItems:"center",borderBottom:"1px solid ".concat(e.colors.GBK09A)}}},n),{children:t}))};function _K(){var e=(0,lk._)(["","回答 \xb7 ","关注"]);return _K=function(){return e},e}var _j=function(e){var t=e.list,n=e.disableShrink,r=(0,F._)(e,["list","disableShrink"]);return(0,m.tZ)(dw.Z,{offset:52,children:(0,m.tZ)(_W,(0,er._)((0,G._)({backgroundColor:"GBK99A"},r),{children:t.map(function(e,t){var r=e.width,o=e.text,i=e.css,a=e.tipText,c=void 0===a?null:a;return(0,m.BX)(i0.xv,(0,er._)((0,G._)({flexBasis:"".concat(r,"px")},n&&{flexShrink:0},i&&{css:i}),{children:[o,c&&(0,m.tZ)(_V,{children:(0,m.tZ)(i0.xu,{width:320,fontSize:"14px",px:"15px",py:"5px",color:"GBK04A",children:(0,m.tZ)(i0.xv,{children:c})})})]}),t)})}))})},_Y=function(e){var t=e.width,n=e.title,r=e.titleLink,o=e.subText,i=e.answerCount,a=e.followerCount,c=e.renderLabel,s=e.keyWords,u=e.urlToken,l=(0,F._)(e,["width","title","titleLink","subText","answerCount","followerCount","renderLabel","keyWords","urlToken"]);return(0,m.BX)(i0.xu,(0,er._)((0,G._)({flexBasis:"".concat(t,"px")},l),{children:[(0,m.tZ)(_F.pl,{href:r,zaType:"Card",target:"_blank",zaText:s?"搜索".concat(s):u?"算法":"",children:(0,m.BX)(i0.xu,{className:"Creator-QuestionShared-title",css:function(e){return(0,er._)((0,G._)({},(0,lm.S)(2)),{fontSize:"15px",color:e.colors.GBK03A,fontWeight:500,lineHeight:"21px",paddingRight:"100px"})},children:[c&&c(),n]})}),(0,m.tZ)(i0.kC,{fontSize:"14px",color:"GBL05A",mt:"8px",alignItems:"center",children:o||lN()(_K(),(0,s1.Zh)(i),(0,s1.Zh)(a))})]}))},_Q=(0,iZ.withRouter)(function(e){var t=e.width,n=e.haveAnswer,r=void 0!==n&&n,o=e.questionAnswerUrl,i=void 0===o?null:o,a=e.writeQuestionUrl,c=e.isArticleToAnswer,s=void 0!==c&&c,u=e.id,l=e.postId,d=e.text,p=e.zaInfo,f=void 0===p?{}:p,h=(0,F._)(e,["width","haveAnswer","questionAnswerUrl","writeQuestionUrl","isArticleToAnswer","id","postId","text","zaInfo"]),_=h.params,g=h.router,T=_.urlToken,E=(0,e6.useDispatch)(),y=function(e,t,n){var r="/question/".concat(e,"?").concat(t);if(n){window.location.href="https://www.zhihu.com".concat(r);return}g.push(r)};return(0,m.tZ)(i0.kC,(0,er._)((0,G._)({justifyContent:"center",flexBasis:"".concat(t,"px")},h),{children:(0,m.tZ)(e7.ZAClick,(0,er._)((0,G._)({zaType:"Button",zaText:d||!0,zaBlock:s||r?"ArticleToAnswer":"",zaAction:"OpenUrl",shouldTrackShow:!0},f),{extra:{link:{get url(){return r?i:a}}},children:s?(0,m.tZ)(aC.ZP,{preset:"primary",color:"blue",label:"编辑发布",css:{padding:"0 9px"},onClick:function(){E((0,nR.Skx)(T,u)).then(function(e){var t=(null==e?void 0:e.payload)||{},n=t.isAllowPublish,r=t.hasAnswer,o=t.hasDraft,i=t.disableReason,a=t.articleCheckResult,c=new URLSearchParams((0,G._)({attach_to_article:T||l,write:""},l&&{push_activity:0})).toString();(null==a?void 0:a.hasPublishedAnswer)?E((0,t1.c0)("一个文章只能发布一个问题~")):n?y(u,c,l):r?E((0,t1.c0)("已发布回答")):o?up.Z.confirm((0,m.tZ)("div",{css:{textAlign:"center"},children:"你在该问题下已有草稿，是否将此文章内容覆盖到草稿箱"})).then(function(){y(u,c,l)}).catch(function(){return null}):E((0,t1.c0)(i))})}}):r?(0,m.tZ)(_H.Z,{icon:_U.yP,label:"查看回答",href:i,target:"_blank",css:{padding:"0 9px"}}):(0,m.tZ)(_H.Z,{className:"QuestionItem-footer--writeAnswerButton",label:"写回答",icon:_G.E,href:a,target:"_blank"})}))}))}),_J=function(e){var t=e.zaContent,n=e.zaBlock,r=e.zaModuleId,o=e.zaModuleIndex,i=e.zaExtra,a=(0,F._)(e,["zaContent","zaBlock","zaModuleId","zaModuleIndex","zaExtra"]);return(0,m.tZ)(e7.ZAEnv,{content:t,block:n,moduleId:r,moduleIndex:o,extra:i,children:(0,m.tZ)(e7.ZAShow,(0,G._)({as:i0.xu,zaType:"Card"},a))})};function _$(){var e=(0,lk._)(["共",""]);return _$=function(){return e},e}var _0=function(e){var t=e.title;return(0,m.tZ)("div",{className:"SearchQuestion-item-title",dangerouslySetInnerHTML:{__html:t}})},_1=function(e){var t=e.item,n=e.index,r=e.isArticleToAnswer,o=e.isSearch,i=e.onChange,a=e.keyWords,c=e.urlToken,s=t||{},u=s.question,l=u.id,d=u.highlightTitle,p=u.url,f=u.haveAnswer,h=u.questionAnswerUrl,_=s.reaction,g=_.newPv,T=_.pv,E=_.followNum,y=_.answerNum,C=s.checked,S=(0,b.useMemo)(function(){return{questionAnswerUrl:h,writeQuestionUrl:(0,fS.D)(p,{write:""}),haveAnswer:f}},[f,h,p]),I=(0,b.useMemo)(function(){return{title:(0,m.tZ)(_0,{title:d}),titleLink:p,followerCount:E,answerCount:y}},[y,E,d,p]),A="".concat(c?"".concat(a?"搜索".concat(a):"算法","; 文章token: ").concat(c):"");return(0,m.tZ)(_J,{zaContent:{token:String(l),type:"Question"},zaBlock:"RecommendQuestionItem",zaText:A,children:(0,m.BX)(_X,{css:function(e){return{"& .SearchQuestion-item-title":{em:{fontStyle:"normal",color:e.colors.GRD03A}}}},children:[(0,m.tZ)(_Y,(0,G._)({width:415,keyWords:a,urlToken:c},I)),(0,m.BX)(i0.xu,{flexBasis:"130px",children:[(0,m.BX)(i0.kC,{alignItems:"center",children:[(0,m.tZ)(_B,{data:g}),(0,m.tZ)(i0.xv,{fontSize:"14px",color:"GBK03A",children:(0,s1.Zh)(g)})]}),(0,m.tZ)(i0.xv,{fontSize:"12px",color:"GBK06A",mt:"6px",children:lN()(_$(),(0,s1.Zh)(T))})]}),void 0!==o&&o?(0,m.tZ)(i0.kC,{justifyContent:"center",flexBasis:"131px",children:(0,m.tZ)(e7.ZAClick,{zaType:"Button",zaText:A,zaBlock:"ArticleToAnswer",shouldTrackShow:!0,children:(0,m.tZ)(aC.ZP,{preset:C?"primary":"secondary",color:"blue",label:C?"已选择":"选择",css:{padding:"0 15px"},onClick:function(){return i&&i(t,n)}})})}):(0,m.tZ)(_Q,(0,er._)((0,G._)({width:131},S),{isArticleToAnswer:void 0!==r&&r,id:l,postId:c,text:A}))]})})};_1.proptypes={item:iG().object,index:iG().number,isArticleToAnswer:iG().bool,isSearch:iG().bool,onChange:iG().func,keyWords:iG().string,urlToken:iG().string};var _2=function(e){var t=e.urlToken,n=e.keyWords,r=e.onChange,o=e.defaultConfig,i=(0,e6.useDispatch)(),a=(0,b.useRef)(o.nextRequest||null),c={totals:0,isEnd:!1,next:null},s=(0,ef._)((0,b.useState)(!0),2),u=s[0],l=s[1],d=(0,ef._)((0,b.useState)(!1),2),p=d[0],f=d[1],h=(0,ef._)((0,b.useState)(o.questionList||[]),2),_=h[0],T=h[1],E=(0,ef._)((0,b.useState)(c),2),y=E[0],C=E[1],S=(0,ef._)((0,b.useState)(o),2),I=S[0],A=S[1],w=y.isEnd,Z=function(){p||(f(!0),i((0,nR.sOG)(a.current||"creators/search/query",!a.current&&{query:n,no_answer:1,no_draft:1})).then(function(e){var t=e.payload,r=t.paging,o=t.data;if(C(r=r||(0,er._)((0,G._)({},c),{totals:o.length||0,isEnd:!0})),null==I?void 0:I.checkedItem){var i=(0,g._)(o);(null==I?void 0:I.keyword)===n&&(i=o.filter(function(e){var t;return(null==e?void 0:null===(t=e.question)||void 0===t?void 0:t.id)!==I.checkQuestionId})),T((0,g._)((null==r?void 0:r.isStart)?[(0,er._)((0,G._)({},I.checkedItem),{checked:!0})]:_).concat((0,g._)(i)))}else T((0,g._)((null==r?void 0:r.isStart)?[]:_).concat((0,g._)(o)));f(!1),a.current=r.next},function(e){if((null==e?void 0:e.status)===403)throw Error("请求失败，请稍后重试");throw Error("发生未知错误，请稍后重试")}).catch(function(){return f(!1)}))},x=function(){f(!0),i((0,nR.oEW)(t)).then(function(e){T(e.payload.data||[]),f(!1)}).catch(function(){return f(!1)})},k=function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(u&&(null==o?void 0:null===(e=o.questionList)||void 0===e?void 0:e.length)){T(null==o?void 0:o.questionList),l(!1);return}t?x():Z()},R=function(){a.current=null,T([]),f(!1)};(0,b.useEffect)(function(){n&&!u&&(R(),k()),!n&&u&&k(!0),l(!1)},[n]);var N=function(e,t){var o=_.map(function(e){return(0,er._)((0,G._)({},e),{checked:!1})});o[t].checked=!_[t].checked;var i="",c={};if(o[t].checked){var s,u=o[t];o.splice(t,1),o.unshift(u),i=null==e?void 0:null===(s=e.question)||void 0===s?void 0:s.id,c={questionList:o,nextRequest:a.current,keyword:n,checkQuestionId:i||"",checkedItem:e}}A(c),r&&r(i||"",c),T(o)},O=_.map(function(e,r){return(0,m.tZ)(_1,{item:e,index:r,isSearch:!0,isArticleToAnswer:!0,keyWords:n,urlToken:t,onChange:N},"".concat(e.question.id,"+").concat(r))}),P=(0,m.tZ)(hu.O,{variant:"T01",height:120});return(0,m.BX)(i0.xu,{children:[(0,m.tZ)(_4,{}),(0,m.BX)(i0.xu,{className:"Box-Wrap",css:{height:"305px",overflowY:"scroll","& .skeleton":{padding:"20px 0"}},children:[(0,m.tZ)(i0.xu,{children:n?(0,m.tZ)(sJ.ZP,{onLoad:Z,isLoading:p,placeholder:P,isDrained:w,getContainer:function(e){return e.parentElement.parentElement},children:O}):p?P:O}),!p&&!_.length&&(0,m.tZ)(cF.H.EI1,{image:"default",content:"暂无相关推荐问题，去搜索试试 ~"})]})]})};_2.proptypes={urlToken:iG().string,keyWords:iG().string,onChange:iG().func,defaultConfig:iG().object},n(36374),iG().bool,iG().func,iG().string,iG().string,iG().array;var _3=function(e){var t=e.totals,n=(0,b.useMemo)(function(){return[{width:415,text:"推荐问题 ".concat(t?(0,s1.uf)(t):"")},{width:130,text:"浏览增量"},{width:131,text:"操作",css:{textAlign:"center"}}]},[t]);return(0,m.tZ)(_j,{list:n})};_3.prototypes={totals:iG().number};var _4=_3,_5=n(79107),_6=function(e){var t=e.label,n=e.handleDeleteData;return"搜索历史"===t?(0,m.tZ)(a0,{onDelete:n,label:t}):(0,m.tZ)("div",{onMouseDown:function(e){return e.preventDefault()},role:"button",tabIndex:0,className:"Creator-SearchBar-label",children:t})},_7=function(e){var t=e.item,n=e.handleDeleteData,r=e.handleReportShow,o=t.type,i=t.data,a=t.index,c=t.rawSearchResult,s=null;switch(o){case"topSearch":s=(0,m.tZ)(a6,{index:a,query:i});break;case"history":var u=t.data;s=(0,m.tZ)(aJ,{data:u,index:a,onDelete:n,rawSearchResult:c});break;case"suggest":s=(0,m.tZ)(a4,{data:i,index:a,rawSearchResult:c});break;case"reports":s=(0,m.tZ)(a1,{handleReportShow:r})}return s||null},_8=function(e,t){return null==e?"":"object"==typeof e?e[t]||"":e},_9=function(e,t){return e.map(function(e,n){return(0,G._)({id:null==e?void 0:e.rawId,index:n,data:_8(e,"displayQuery")||_8(e,"query"),query:_8(e,"query")},t)}).filter(function(e){return!!e.data})},me={topSearch:"知乎热搜",history:"搜索历史"},mt=function(e){var t,n=e.outCss,r=e.query,o=e.placeholder,i=e.currentUserId,a=e.onFocus,c=e.onSelect,s=e.onSubmit,u=e.ignoreHotWord,l=void 0!==u&&u,d=e.customSearchStyle,p=void 0!==d&&d,f=(0,e6.useDispatch)(),h=r.q,_=(0,b.useRef)(null),T=(0,b.useRef)(null),E=(0,ef._)((0,b.useState)(null),2),y=E[0],C=E[1],S=(0,ef._)((0,b.useState)({topSearch:[],history:[],suggest:[]}),2),I=S[0],A=S[1],w=(0,ef._)((0,b.useState)(!1),2),Z=w[0],x=w[1],k=y&&!p,R=function(){return co(i)},N=function(e){return ci(R(),e)},P=function(e){var t=e.topSearchData,n=e.historyData,r=e.suggestData,o=void 0===r?[]:r;if(T.current.inputNode.value)return A((0,G._)({suggest:o},o.length>0&&{reports:[{type:"reports"}]}));var i=I.topSearch,a=I.history;return A((0,G._)({},t?{topSearch:_9(t,{type:"topSearch"})}:{topSearch:void 0===i?[]:i},n?{history:_9(n,{type:"history"})}:{history:void 0===a?[]:a}))},D=function(){var e=N(),t=cs(),n=function(t){P({topSearchData:(0,g._)(t),historyData:e})};return l?n([]):t?n(t):f({API:{endpoint:"search/top_search",types:rO.GET_TOP_SEARCH},NOTIFICATION:!1}).then(function(e){var t=(e&&e.payload&&e.payload.topSearch||{}).words,n=(void 0===t?[]:t).map(function(e){return{displayQuery:e.displayQuery,query:e.query}}).slice(0,5);return O().set(a2,{words:n,timeStamp:new Date().getTime()}),n}).then(n)},L=function(e){var t=cc(function(){return f(rB(e))}),n=N(e);t().then(function(t){P({suggestData:rA()((0,g._)(_9(n,{type:"history",rawSearchResult:e})).concat((0,g._)(_9(t,{type:"suggest",rawSearchResult:e}))),function(e,t){var n=e.data,r=t.data;return n.toLowerCase()===r.toLowerCase()})})})},M=function(){var e=T.current.inputNode.value;null==s||s(e)},B=ay()(function(e){return(C(e),e)?L(e):D()},300),U=function(e,t){e.stopPropagation(),P({historyData:ca(R(),t)})};return(0,b.useEffect)(function(){C(h)},[h]),(0,m.BX)(i0.xu,{css:n,children:[(0,m.BX)("form",{className:i$()("Creator-SearchBar-tool"),ref:_,onSubmit:function(e){return e.preventDefault()},children:[(0,m.tZ)(ak,(0,er._)((0,G._)({autoSelect:!1,ref:T,labels:me,groups:I,value:h||"",renderLabel:function(e){return(0,m.tZ)(_6,{label:e,handleDeleteData:U})},renderItem:function(e){return(0,m.tZ)(_7,{item:e,handleDeleteData:U,handleReportShow:function(){return x(!0)}})},inputProps:{type:"text",maxLength:100,grey:!0,placeholder:o,className:i$()("Creator-SearchBar-input",{"Creator-SearchBar-input-custom":l&&p}),after:(0,m.BX)(m.HY,{children:[k&&(0,m.tZ)(i0.xu,{width:"24px"}),(0,m.BX)(aC.ZP,(0,er._)((0,G._)({className:"Creator-SearchBar-searchButton",preset:"primary",color:y||p?"blue":"grey"},y&&{onClick:M}),{"aria-label":"搜索",children:[(0,m.tZ)(ai.J7,{size:18,center:!0,className:i$()("Creator-SearchBar-searchIcon",{hasValue:y})}),p&&(0,m.tZ)("span",{css:{marginLeft:"8px"},children:"搜索"})]}))]})},menuProps:{menuClassName:i$()("Creator-SearchBar-menu"),menuContainerClassName:"Creator-SearchBar-menuContainer",style:{width:null===(t=_.current)||void 0===t?void 0:t.getBoundingClientRect().width}},onFocus:function(){return(a&&a(),y)?L(y):D()},onSelect:function(e,t){null==c||c(t)}},y&&{onEnterInput:M}),{onChange:B})),k&&(0,m.tZ)(_5.C,{text:!0,css:function(e){return{color:e.colors.GBK07A,fontSize:"18px",cursor:"pointer",position:"absolute",top:"11px",right:"55px"}},onClick:function(){C(""),T.current.setState({value:""}),setTimeout(function(){T.current.inputNode.focus(),D()},50)}})]}),(0,m.tZ)(aI.y,{type:"search_suggested_word",shown:Z,onClose:function(){return x(!1)},zaEnabled:!0,List:I.suggest})]})},mn=function(e){var t=(0,e7.useTracker)().trackEvent,n=e.show,r=e.onClose,o=e.urlToken,i=e.onChange,a=((0,e6.useSelector)(eB.ib)||{}).id,c=(0,e6.useDispatch)(),s=(0,ef._)((0,b.useState)(""),2),u=s[0],l=s[1],d=(0,ef._)((0,b.useState)(!1),2),p=d[0],f=d[1],h=(0,ef._)((0,b.useState)({}),2),_=h[0],g=h[1],T=(0,ef._)((0,b.useState)({}),2),E=T[0],y=T[1],C=(0,ef._)((0,b.useState)(""),2),S=C[0],I=C[1];(0,b.useEffect)(function(){return l((null==_?void 0:_.keyword)||""),I((null==_?void 0:_.checkedQuestionId)||""),function(){(null==_?void 0:_.questionList)||I("")}},[n]);var A=function(e){t({eventType:"Click",action:"Search",block:"ArticleToAnswerSearchInput",elementLocation:{type:"Input",text:"搜索".concat(e,"; 文章token: ").concat(o)}},{link:{url:window.location.href}})},w=function(e){l(e||""),A(e||"")};return(0,m.tZ)(sc.Z,{className:"QuestionSearchModal",title:"投稿至问题",onClose:r,size:"large",css:{width:"724px","& .Modal-content":{margin:"22px 0 5px"},"& .Creator-QuestionShared-title":{paddingRight:"65px"}},children:n&&(0,m.tZ)(e7.ZAEnv,{block:"QuestionRecommendSearchModal",children:(0,m.BX)(e7.ZAShow,{zaType:"Popup",zaText:"投稿至问题弹窗展示",children:[(0,m.tZ)(i0.xu,{textAlign:"center",children:(0,m.tZ)(mt,{outCss:{width:"400px",margin:"0 auto 16px"},currentUserId:a,query:{q:u},placeholder:"请输入关键词查找问题",onSelect:function(e){return w(null==e?void 0:e.query)},onSubmit:function(e){return w(e)}})}),(0,m.BX)(i0.xv,{textAlign:"center",mb:"16px",fontWeight:"400",fontSize:"14px",color:"GBK06A",children:["最多选择 1 个，已选择 ",S?1:0," 个"]}),(0,m.tZ)(_2,{urlToken:o,keyWords:u,defaultConfig:_,onChange:function(e,t){I(e),y((0,er._)((0,G._)({},t),{checkedQuestionId:e}))}}),(0,m.tZ)(i0.xu,{textAlign:"center",children:(0,m.tZ)(e7.ZAClick,{zaType:"Button",zaText:"".concat(u?"搜索".concat(u):"算法","; 文章token: ").concat(o,"; 问题id: ").concat(S),zaBlock:"RecommendQuestionChoose",children:(0,m.tZ)(aC.ZP,{icon:p&&cV.Z,onClick:function(){if(!S){g({}),i(""),r();return}f(!0),c((0,nR.Skx)(o,S)).then(function(e){var t=(null==e?void 0:e.payload)||{},n=t.isAllowPublish,o=t.hasAnswer,a=t.hasDraft,s=t.disableReason;if(f(!1),n||a){i(S),g(E),r();return}if(o){c((0,t1.c0)("已发布回答，请换个问题哦")),g({}),i("");return}c((0,t1.c0)(s))})},disabled:p,preset:"primary",color:"blue",css:{width:"218px",marginTop:"40px"},children:"确定"})})})]})})})};mn.proptypes={show:iG().bool,onClose:iG().func,onChange:iG().func,urlToken:iG().string};var mr=function(e){var t,n,r=e.urlToken,o=e.onChange,i=e.style,a=e.disabled,c=(0,ef._)((0,b.useState)(!1),2),s=c[0],u=c[1],l=(0,ef._)((0,b.useState)("未选择"),2),d=l[0],p=l[1],f=(0,hS.Z1)();return(null==f?void 0:null===(t=f.commands)||void 0===t?void 0:null===(n=t.contribute)||void 0===n?void 0:n.instruction)?null:(0,m.BX)(i0.xu,{css:i,children:[(0,m.BX)(i0.kC,{py:"11px",children:[(0,m.tZ)(_m.gN,{name:"投稿至问题",helper:(0,m.BX)("div",{css:{p:{textIndent:0}},children:[(0,m.tZ)("p",{children:"1.含好物卡片、知+、教育 等卡片的文章不支持投稿至问题"}),(0,m.tZ)("p",{children:"2.超过发文限制的文章不支持投稿至问题"}),(0,m.tZ)("p",{children:"3.收录到付费专栏的文章不支持投稿至问题"})]})}),(0,m.tZ)(e7.ZAClick,{zaType:"Button",zaText:"投稿至问题",zaBlock:"ArticleToAnswerSelect",shouldTrackShow:!0,children:(0,m.tZ)(_m.Qr,{onClick:function(){return u(!0)},text:d,disabled:a})})]}),(0,m.tZ)(mn,{urlToken:r,onClose:function(){return u(!1)},show:s,onChange:function(e){p(e?"已选 1 个问题":"未选择"),o&&o(e)}})]})};mr.proptypes={urlToken:iG().string,onChange:iG().func,style:iG().object};var mo=(0,b.forwardRef)(function(e,t){var n=e.disclaimerInfo,r=e.articleDisclaimers,o=(0,e7.useTracker)().trackEvent,i=(0,ef._)((0,b.useState)({type:"none",description:"无声明"}),2),a=i[0],c=i[1],s=JSON.parse(JSON.stringify(r));s.push({type:"none",description:"无声明"});var u=!!n;return(0,b.useEffect)(function(){u&&c(n)},[u]),(0,b.useImperativeHandle)(t,function(){return{getReshipmentDisclaimers:function(){return a}}}),(0,m.tZ)(_m.Qr,{onChange:function(e){var t=s.find(function(t){return t.type===e});o({eventType:"Click",action:"Unknown",elementLocation:{type:"Button",text:"创作声明-".concat(t.description)}}),t&&c(t)},value:a.type,children:s.map(function(e){return(0,m.tZ)(_m.o3,{value:e.type,text:e.description},e.type)})})}),mi=(0,b.forwardRef)(function(e,t){return(0,m.BX)(i0.kC,{py:"11px",children:[(0,m.tZ)(_m.gN,{name:"创作声明",helper:(0,m.BX)(m.HY,{children:[(0,m.tZ)("p",{children:"「创作声明」是为自己创作的添加个人声明的工具。当你在创作特定内容（如内容存在虚构或剧透等情节）时，可设置创作声明，该声明将会展示在回答或文章开头。"}),(0,m.tZ)("p",{children:"创作声明表达的是创作者对内容负责的态度。知乎鼓励创作者设置创作声明，以方便知友更好地辨识和理解内容信息。你也可以在编辑内容时，关闭创作声明。"})]})}),(0,m.tZ)(i0.xu,{flex:"1",children:(0,m.tZ)(mo,(0,er._)((0,G._)({},e),{ref:t}))})]})}),ma=n(27349),mc={enter:13,space:32},ms=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){return(0,B._)(this,n),t.apply(this,arguments)}return(0,U._)(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=(0,F._)(e,["className"]);return(0,m.tZ)(aC.ZP,(0,G._)({className:i$()("Button Button--plain",t)},n))}}]),n}(b.Component);function mu(e){return(0,m.tZ)("li",(0,er._)((0,G._)({},e),{className:i$()("ColumnMenu-item",e.className)}))}var ml=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"state",{isOpen:!1,expand:!1}),(0,ed._)((0,iD._)(e),"handleMenuClick",function(t){"INPUT"!==t.target.nodeName&&e.toggle()}),(0,ed._)((0,iD._)(e),"handleMenuKeyDown",function(t){(t.keyCode===mc.enter||t.keyCode===mc.space)&&(e.toggle(),t.preventDefault())}),(0,ed._)((0,iD._)(e),"handleWrapperMouseenter",function(){e.toggle(!0)}),(0,ed._)((0,iD._)(e),"handleWrapperMouseleave",function(){e.toggle(!1)}),(0,ed._)((0,iD._)(e),"handleDocClick",function(t){!e.state.isOpen||e.wrapperNode.contains(t.target)||(e.toggle(!1),t.stopPropagation(),t.preventDefault())}),(0,ed._)((0,iD._)(e),"createButton",function(){var t=e.props,n=t.trigger,r=t.children,o=e.props.button;return o||b.Children.forEach(r,function(e){e&&e.type===ms&&(o=e)}),(0,b.cloneElement)(o,{className:i$()("MenuButton MenuButton-listen-".concat(n),o.props.className),onKeyDown:e.handleMenuKeyDown,ref:function(t){e.buttonRef=t}})}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){this.buttonNode=eQ().findDOMNode(this.buttonRef);var e=this.props,t=e.trigger,n=e.autoHide;"click"===t?(this.buttonNode.addEventListener("click",this.handleMenuClick),this.dropdownNode.addEventListener("click",this.handleMenuClick),document.addEventListener("click",this.handleDocClick,!0)):(this.wrapperNode.addEventListener("mouseenter",this.handleWrapperMouseenter),this.wrapperNode.addEventListener("mouseleave",this.handleWrapperMouseleave),n&&this.dropdownNode.addEventListener("click",this.toggle.bind(this,!1)))}},{key:"componentWillUnmount",value:function(){"click"===this.props.trigger?(this.buttonNode.removeEventListener("click",this.handleMenuClick),this.dropdownNode.removeEventListener("click",this.handleMenuClick),document.removeEventListener("click",this.handleDocClick,!0)):(this.wrapperNode.removeEventListener("mouseenter",this.handleWrapperMouseenter),this.wrapperNode.removeEventListener("mouseleave",this.handleWrapperMouseleave)),clearTimeout(this.timer)}},{key:"toggle",value:function(e){var t=this,r=e;"boolean"!=typeof e&&(r=!this.state.isOpen);var o=this.props,i=o.onOpen,a=o.onClose,c=o.delay;r?(this.setState({isOpen:r}),this.timer=setTimeout(function(){t.setState({expand:!0}),i.call(t)},c)):(this.setState({expand:!1}),this.timer=setTimeout(function(){t.setState({isOpen:r}),a.call(t)},n.TRANSITION_DELAY+c))}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.children,o=t.arrow,i=this.state,a=i.expand,c=i.isOpen;return(0,m.BX)("div",{className:i$()("ColumnMenu",a?"ColumnMenu--open":"",n),ref:function(t){return e.wrapperNode=t},children:[this.createButton(),(0,m.BX)("div",{className:"ColumnMenu-dropdown",style:{visibility:!c&&"hidden"},ref:function(t){return e.dropdownNode=t},children:[c&&(0,m.tZ)("ul",{className:"ColumnMenu-list",children:b.Children.map(r,function(e){return e?e.type===ms?null:e.type===mu?e:(0,m.tZ)(mu,{children:e}):e})}),o]})]})}}]),n}(b.Component);(0,ed._)(ml,"TRANSITION_DELAY",200),(0,ed._)(ml,"propTypes",{trigger:iG().oneOf(["click","hover"]),onOpen:iG().func,onClose:iG().func,button:iG().element,arrow:iG().element,autoHide:iG().bool,delay:iG().number}),(0,ed._)(ml,"defaultProps",{trigger:"click",onOpen:function(){},onClose:function(){},arrow:null,autoHide:!1,delay:50});var md=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"onCompositionStart",function(){e.compositing=!0}),(0,ed._)((0,iD._)(e),"onCompositionEnd",function(){e.compositing=!1,e.prevValue&&e.props.onChange(e.prevValue),e.prevValue=null}),(0,ed._)((0,iD._)(e),"handleInputChange",function(t){var n=t.target.value;e.compositing?e.prevValue=n:e.props.onChange(n)}),e}return(0,U._)(n,[{key:"componentDidMount",value:function(){document.addEventListener("compositionstart",this.onCompositionStart),document.addEventListener("compositionend",this.onCompositionEnd)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd)}},{key:"render",value:function(){var e=this.props,t=e.menuButton,n=e.placeholder,r=e.friends,o=e.onClick,i=e.className,a=e.onOpen,c=e.onClose;return(0,m.BX)(ml,{preventCloseOnTarget:!0,trigger:"click",className:i$()("ColumnSearchMenu",i),button:t,onOpen:a,onClose:c,children:[(0,m.tZ)(cd.Z,{placeholder:n,className:"ColumnSearchMenu-searchInput",targetClassName:"preventCloseOnTarget",onChange:this.handleInputChange,before:(0,m.tZ)(ai.J7,{text:!0})}),r&&r.map(function(e){return(0,m.tZ)(aC.ZP,{preset:"plain",className:"ColumnSearchMenu-selectFriendsButton preventCloseOnTarget",onClick:function(t){return o(t,e)},children:(0,m.BX)("div",{className:"ColumnSearchMenu-friends preventCloseOnTarget",children:[(0,m.tZ)("img",{src:(0,p$.imgUrl)(e.avatarUrl,"m"),className:"ColumnSearchMenu-image preventCloseOnTarget",alt:"头像"}),(0,m.tZ)("span",{className:"preventCloseOnTarget",children:e.name})]})},e.id)})]})}}]),n}(b.Component);(0,ed._)(md,"propTypes",{menuButton:iG().node.isRequired,placeholder:iG().string.isRequired,friends:iG().arrayOf(iG().shape({id:iG().string.isRequired,avatarUrl:iG().string,name:iG().string.isRequired})),onChange:iG().func.isRequired,onClick:iG().func.isRequired,className:iG().string,onOpen:iG().func,onClose:iG().func});var mp=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"state",{selectedColumn:null,isInvitedFriends:!1,selectedFriendList:[],isReviewInvite:!1}),(0,ed._)((0,iD._)(e),"onClickSelectFriends",function(t,n){t.preventDefault(),e.props.resetFriends();var r=e.state.selectedFriendList;r.some(function(e){return e.id===n.id})||e.setState({selectedFriendList:(0,g._)(r).concat([n])})}),(0,ed._)((0,iD._)(e),"createDeleteFriendHandler",function(t){return function(n){n.preventDefault(),e.setState(function(e){return{selectedFriendList:e.selectedFriendList.filter(function(e){return e.id!==t.id})}})}}),(0,ed._)((0,iD._)(e),"createSelectColumnHandler",function(t){return function(n){n.preventDefault(),e.setState({selectedColumn:t})}}),(0,ed._)((0,iD._)(e),"handleRemoveSelectedColumn",function(t){t.preventDefault(),e.setState({selectedColumn:null})}),(0,ed._)((0,iD._)(e),"handleSelectFriends",function(){e.setState(function(e){return{isInvitedFriends:!e.isInvitedFriends}})}),(0,ed._)((0,iD._)(e),"handleReviewButton",function(){var t=e.state,n=t.selectedFriendList,r=t.selectedColumn,o=r&&r.id,i=n.map(function(e){return e.urlToken});if(i.length||o){var a=e.props,c=a.postId,s=a.reviewColumn,u=a.handleOpenReviewComment;s(o,c,i).then(function(){e.setState({isReviewInvite:!0}),u()}).catch(hf())}}),(0,ed._)((0,iD._)(e),"requestMyFriends",(0,h6.Z)(function(t){(0,e.props.fetchMyFriends)(t)},d0.Ij)),e}return(0,U._)(n,[{key:"renderFriendList",value:function(){var e=this,t=this.state.selectedFriendList;return(0,m.BX)("div",{css:{display:"flex",gap:"12px",width:300,flexDirection:"row",justifyContent:"center",flexWrap:"wrap",maxHeight:"120px",overflowY:"auto"},children:[t&&t.length>0&&t.map(function(t,n){return(0,m.BX)("div",{className:"ReviewPanel-selectFriend",css:{flex:"0 0 auto",height:"36px"},children:[(0,m.tZ)(s0.qE,{url:t.avatarUrl,size:36}),(0,m.tZ)(aC.ZP,{onClick:e.createDeleteFriendHandler(t),preset:"plain",children:(0,m.tZ)(aV.HN,{})})]},n)}),(0,m.tZ)(ms,{className:"ReviewPanel-selectButton",children:(0,m.tZ)(ma.Qk,{size:40})})]})}},{key:"renderReviewerSection",value:function(){var e=this,t=this.props,n=t.friends,r=t.resetFriends,o=this.state.isInvitedFriends;return(0,m.BX)("div",{className:"ReviewPanel-section ReviewPanel-inviteColumn",children:[(0,m.BX)("div",{role:"button",tabIndex:0,className:i$()("ReviewPanel-sectionTitle","ReviewPanel-selectFriends",o&&"ReviewPanel-selectFriends-transform"),onClick:this.handleSelectFriends,children:["相互关注的知乎好友",(0,m.tZ)(pn.f,{})]}),o&&(0,m.tZ)(md,{placeholder:"搜索相互关注的好友",menuButton:this.renderFriendList(),onChange:this.requestMyFriends,onClick:this.onClickSelectFriends,onClose:r,onOpen:function(){return e.props.fetchMyFriends("")},friends:n})]})}},{key:"renderColumnSection",value:function(){var e=this,t=this.props.columns,n=this.state.selectedColumn;return(0,m.BX)("div",{className:"ReviewPanel-section ReviewPanel-inviteColumn",children:[(0,m.tZ)("div",{className:"ReviewPanel-sectionTitle",children:"你所在专栏的编辑"}),!!n&&(0,m.BX)("div",{className:"ReviewPanel-selectedColumn",children:[(0,m.tZ)(s0.qE,{url:n.imageUrl,size:36}),(0,m.tZ)(aC.ZP,{onClick:this.handleRemoveSelectedColumn,preset:"plain",children:(0,m.tZ)(aV.HN,{})})]}),!n&&(0,m.tZ)(ml,{preventCloseOnTarget:!0,trigger:"click",className:"ReviewPanel-selectColumnMenu",button:(0,m.tZ)(ms,{className:"ReviewPanel-selectButton",children:(0,m.tZ)(ma.Qk,{size:40})}),children:t&&t.map(function(t,n){return(0,m.BX)(aC.ZP,{preset:"plain",className:"preventCloseOnTarget",onClick:e.createSelectColumnHandler(t),children:[(0,m.tZ)(s0.qE,{url:t.imageUrl,size:36,className:"ReviewPanel-columnName"}),t.title]},n)})})]})}},{key:"render",value:function(){var e=this.state,t=e.selectedColumn,n=e.isReviewInvite,r=e.selectedFriendList;return(0,m.tZ)("div",{className:"ReviewPanel",children:n?(0,m.BX)("div",{className:"ReviewPanel-wrapper",children:[(0,m.tZ)("div",{className:"ReviewPanel-title",children:"邀请"}),(0,m.BX)("div",{className:"ReviewPanel-review",children:[(0,m.tZ)(pC.BS,{size:40,className:"ReviewPanel-reviewIcon"}),(0,m.tZ)("p",{children:r.length>0||t?"邀请预览已发出":"已取消预览邀请"})]})]}):(0,m.BX)("div",{className:"ReviewPanel-wrapper",children:[(0,m.tZ)("div",{className:"ReviewPanel-title",children:"邀请"}),(0,m.tZ)("div",{className:"ReviewPanel-description",children:"邀请专栏编辑或好友来预览这篇草稿，他们将可通过草稿评论给出意见。"}),this.renderColumnSection(),this.renderReviewerSection(),(0,m.tZ)("div",{className:"ReviewPanel-button preventCloseOnTarget",children:(0,m.tZ)(aC.ZP,{color:"blue",className:"preventCloseOnTarget",onClick:this.handleReviewButton,children:"确定"})})]})})}}]),n}(b.Component);(0,ed._)(mp,"propTypes",{columns:iG().arrayOf(_T),postId:iG().string.isRequired,handleOpenReviewComment:iG().func.isRequired});var mf=(0,th.compose)((0,aw.Z)(null),(0,e6.connect)(function(e){return{friends:e.columnAutocomplete.friends}},{fetchMyFriends:function(e){return{API:{types:ip.FETCH_MY_FRIENDS,endpoint:"autocomplete/friends",query:{token:e,max_matches:100,use_similar:0},root:P.Z.fetchRoot.zhuanlan}}},reviewColumn:function(e,t,n){return{API:{types:o0,endpoint:"articles/".concat(t,"/review"),root:P.Z.fetchRoot.zhuanlan,method:"POST",body:{column:e||null,users:n}}}},resetFriends:function(){return{type:ip.RESET_FRIENDS}}}))(mp);function mh(){var e=(0,lk._)(["\n                font-size: 14px;\n                color: ",";\n              "]);return mh=function(){return e},e}function m_(){var e=(0,lk._)(["\n                line-height: 40px;\n                white-space: nowrap;\n                &.MenuItem-Share {\n                  padding-left: 0;\n                  padding-right: 0;\n                }\n              "]);return m_=function(){return e},e}var mm=function(e){var t=e.draftId,n=e.getEditableInstance,r=e.handleOpenReviewComment,o=e.columns,i=e.contentIsTooShort,a=e.showErrorMessage,c=(0,F._)(e,["draftId","getEditableInstance","handleOpenReviewComment","columns","contentIsTooShort","showErrorMessage"]),s=(0,ij.F)(),u=(0,ef._)((0,cv.k)(),2),l=u[0],d=u[1],p=(0,cL.A)(function(){var e,r=null===(e=n())||void 0===e?void 0:e.hasCatalog();window.open("/p/".concat(t,"/preview?comment=0&catalog=").concat(r?1:0),"_blank")});return(0,m.BX)(m.HY,{children:[(0,m.tZ)(e4.ms,{children:function(e){var t=e.css;return(0,m.BX)(fw.ZP,{positionStatus:"fixed",toggler:(0,m.tZ)(e7.ZAClick,(0,er._)((0,G._)({as:aC.ZP,zaType:"Button",zaText:!0,color:"grey",preset:"secondary",css:{marginLeft:"24px"}},c),{children:"预览"})),onClick:function(e){if(i)return e.preventDefault(),a("正文至少输入 ".concat(9," 个字"))},arrowed:!1,reversed:!0,menuClassName:t(mh(),s.colors.GBL05A),itemClassName:t(m_()),children:[(0,m.tZ)(e7.ZAClick,{as:fw.sN,zaText:!0,zaType:"Button",zaAction:"Unknown",onClick:p,children:"电脑预览"}),(0,m.tZ)(e7.ZAClick,{as:fw.sN,zaText:!0,zaType:"Button",zaAction:"Unknown",onClick:d.on,children:"邀请预览"})]},"settings")}}),(0,m.tZ)(tf.Z,{css:{width:"auto",".Modal-inner":{overflow:"visible"},".Modal-content":{paddingBottom:"16px"}},onClose:d.off,children:l&&(0,m.tZ)(mf,{postId:t,columns:o,handleOpenReviewComment:r})})]})},mv=n(9539),mg=n(61514),mT=function(e){var t=e.scheduledPublishAt,n=e.initialScheduledPublishAt,r=e.setUseScheduledPublish,o=(0,e7.useTracker)().trackEvent,i=!!t,a=function(e){o({eventType:"Click",action:"Unknown",elementLocation:{type:"Button",text:e?"使用定时发布":"不使用定时发布"}}),r(e)};return(0,m.BX)(i0.xu,{color:"GBL05A",flex:"1",css:{fontSize:"14px"},children:[(0,m.BX)(i0.kC,{height:"38px",children:[(0,m.tZ)(_m.KT,{checked:!i,text:"不使用定时发布",onChange:function(){return a(!1)},id:"PublishPanel-scheduleLabel-0"}),(0,m.tZ)(_m.KT,{checked:i,text:"使用定时发布",onChange:function(){a(!0),requestAnimationFrame(function(){(0,a_.X5)(window,{top:document.body.scrollHeight,behavior:"smooth"})})},id:"PublishPanel-scheduleLabel-1"})]}),i&&n&&(0,m.tZ)(mg.Z,{value:t,min:n,max:mv.Z(n,7),onChange:function(e){r(!0,e)},css:function(e){return{color:e.colors.GBL05A,fontSize:"14px",marginTop:"5px",".InputButton":{height:"38px"}}}})]})},mE=function(e){return(0,m.BX)(i0.kC,{py:"11px",children:[(0,m.tZ)(_m.gN,{name:"定时发布"}),(0,m.tZ)(mT,(0,G._)({},e))]})},my=n(3426),mC=function(e){return{display:"flex",alignItems:"center",minWidth:180,height:38,border:"1px solid",borderColor:e.colors.GBK09A,background:e.colors.GBK99A,boxSizing:"border-box",borderRadius:"4px",marginRight:"20px"}},mS=function(e){return(0,m.tZ)(cd.Z,(0,G._)({placeholder:"搜索话题...","aria-label":"搜索话题",before:(0,m.tZ)(ai.J7,{text:!0,css:function(e){return{color:e.colors.GBK06A,marginRight:"6px"}}}),css:function(e){return[mC(e),{paddingRight:"0","input.Input::placeholder":{color:e.colors.GBK07A}}]}},e))},mI=function(e){return(0,m.BX)("button",(0,er._)((0,G._)({css:function(e){return[mC(e),{color:e.colors.GBK03A,justifyContent:"center"}]}},e),{children:[(0,m.tZ)(av.nY,{size:"14px",css:{marginRight:"2px"}}),"添加话题"]}))},mA=function(e){return(0,m.tZ)("button",(0,G._)({css:function(e){return{display:"flex",alignItems:"center",minWidth:"180px",boxSizing:"border-box",height:40,color:e.colors.GBK02A,fontSize:"14px",paddingLeft:"19px","&:hover":{backgroundColor:e.colors.GBK10A}}}},e))},mb=(0,b.forwardRef)(function(e,t){var n,r=e.draft,o=e.showErrorMessage,i=(0,e7.useTracker)().trackEvent,a=(0,e6.useDispatch)(),c=(0,ef._)((0,cv.k)(!1),2),s=c[0],u=c[1],l=(0,b.useRef)(null),d=(0,b.useRef)(""),p=(0,ef._)((0,b.useState)([]),2),f=p[0],h=p[1],_=(0,ef._)((0,b.useState)([]),2),T=_[0],E=_[1],y=(0,ef._)((0,fG.Y)({once:!0}),2),C=y[0],S=y[1],I=s&&f.length<3,A=(0,cL.A)(function(e){var t=e.target.value;d.current!==t&&(a(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{token:e,API:{types:ip.FETCH_TOPICS,endpoint:"autocomplete/topics",query:{token:e,max_matches:5,use_similar:0,topic_filter:1},root:P.Z.fetchRoot.zhuanlan}}}(t)).then(function(e){var t=e.payload,n=e.token;d.current===n&&E(t.data)}),d.current=t)}),w=(null===(n=r.topics)||void 0===n?void 0:n.length)>0;(0,b.useEffect)(function(){w&&h(r.topics)},[w]);var Z=(0,cL.A)(function(){var e=r.state,t=r.topics,n=r.id;if(!((null==f?void 0:f.length)>0)){if("published"===e){h(t);return}"draft"===e&&a({API:{types:o4,endpoint:"/articles/".concat(n,"/recommend_topics")}}).then(function(e){return Promise.all((e.payload.data||[]).slice(0,3).map(function(e){return a(io(n,e)).catch(hf())}))}).then(function(e){h(e.filter(Boolean).map(function(e){return e.payload}))}).catch(o)}});return(0,b.useEffect)(function(){S&&Z()},[S,Z]),(0,b.useImperativeHandle)(t,function(){return{getSelectedTopics:function(){return f}}}),(0,m.BX)(i0.xu,{color:"GBL05A",flex:"1",css:{fontSize:"14px"},ref:C,children:[(0,m.BX)(i0.kC,{children:[f.map(function(e,t){return(0,m.BX)(i0.xu,{css:mC,children:[(0,m.tZ)(i0.xv,{ml:"10px",css:(0,lm.S)(1),children:e.name}),(0,m.tZ)(_m.Tw,{onClick:function(){var t,n;a((t=r.id,n=e.id,{API:{types:o3,endpoint:"articles/".concat(t,"/topics/").concat(n),root:P.Z.fetchRoot.zhuanlan,method:"DELETE"}})).then(function(){h(function(t){return t.filter(function(t){return t.id!==e.id})})}).catch(hf())}})]},t)}),(0,m.tZ)(mS,{onChange:A,onRef:l,after:(0,m.tZ)(_m.Tw,{onClick:u.toggle}),css:!I&&{display:"none"}}),f.length+s<3&&(0,m.tZ)(mI,{onClick:function(){return!s&&u.toggle()}})]}),(0,m.tZ)(my.Z,{isOpen:I&&T.length>0,placement:"bottom",arrowed:!1,target:l.current,children:(0,m.tZ)(i0.xu,{css:function(e){return{minWidth:"180px",backgroundColor:e.colors.GBK99A,border:"1px solid",borderColor:e.colors.GBK09A,boxShadow:"0px 5px 20px rgba(26, 26, 26, 0.1)",borderRadius:"4px",padding:"8px 0"}},children:T.map(function(e){return(0,m.tZ)(mA,{onClick:function(t){if(t.preventDefault(),f.some(function(t){return t.name===e.name})){d.current="",E([]),l.current.value="";return}i({eventType:"Click",action:"Unknown",elementLocation:{type:"Button",text:"话题-".concat(e.name)}}),a(io(r.id,e)).then(function(e){var t=e.payload;t&&(d.current="",E([]),h(function(e){return(0,g._)(e).concat([t])}),l.current.value="",u.off())}).catch(hf())},children:e.name},e.id)})})})]})}),mw=(0,b.forwardRef)(function(e,t){return(0,m.BX)(i0.kC,{py:"11px",children:[(0,m.tZ)(_m.gN,{name:"文章话题",helper:(0,m.tZ)("p",{children:"绑定合适的话题，能方便分类检索，文章也更容易让读者发现。"})}),(0,m.tZ)(mb,(0,er._)((0,G._)({},e),{ref:t}))]})});function mZ(){var e=(0,lk._)(["字数：",""]);return mZ=function(){return e},e}var mx=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){(0,B._)(this,n),r=t.apply(this,arguments),(0,ed._)((0,iD._)(r),"state",{submitting:!1,truncateRatio:30,isInitialized:!1}),(0,ed._)((0,iD._)(r),"paymentTypeSettingRef",(0,b.createRef)()),(0,ed._)((0,iD._)(r),"zaRef",(0,b.createRef)()),(0,ed._)((0,iD._)(r),"updatePayTypeConfig",function(e){(0,r.props.updateDraft)({pay_type_config:e})});var e,r,o=(0,iD._)(r);(0,ed._)((0,iD._)(r),"publishArticle",(e=(0,u1._)(function(e,t,n){var r,i,a,c,s,u,l,d,p,f,h,_,m,g,T,E,y,C;return(0,u2.__generator)(this,function(S){switch(S.label){case 0:return l=(u=o.props).currentUser,d=u.draft,p=u.scheduledPublishAt,f=u.getEditableInstance,h=u.publishArticle,_=u.canReward,m=u.selectedColumnId,g=u.columns,T=(o.state||{}).checkedQuestionId,E=f(),y=T||o.isHasCard,C=!p&&T&&!o.isHasCard&&(null==e?void 0:e.columnType)!=="paid_column",[4,h(d.id,e,(0,G._)({isNew:t,traceId:o.props.traceId,hasColumn:n,hasFormula:!!(null==E?void 0:null===(r=E.hasFormula)||void 0===r?void 0:r.call(E)),isRecommend:y,reshipmentDisclaimers:o.disclaimersRef.getReshipmentDisclaimers(),scheduledPublishAt:p,hasCatalog:null==E?void 0:E.hasCatalog(),autoSendingCreations:l.autoSendingCreations,commercial_report_info:{is_report:null===(i=o.commercialReportRef)||void 0===i?void 0:i.getIsReport(),commercial_types:[]},commercial_zhitask_bind_info:(0,_f.at)(o.commercialZhitaskBindInfo),content_source:(0,_u.up)(null===(a=o.state)||void 0===a?void 0:a.contentSourceInfo),canReward:_},((0,_g.x)(g.find(function(e){return e.id===m}))||(0,l9.ny)(d))&&{pay_type_config:o.payTypeConfig,column_truncate_config:{text:{ratio:Number(o.state.truncateRatio)}}}),{content:o.props.realTimeContent,title:o.props.title,imageCount:(null===(c=null==E?void 0:E.getImages())||void 0===c?void 0:c.size)||0,videoCount:(null===(s=null==E?void 0:E.getVideos())||void 0===s?void 0:s.size)||0},{shouldPublishAnswer:C,publishAnswer:o.publishAnswer})];case 1:return S.sent(),t&&O().set("showEditorTipModal",!0),[2]}})}),function(t,n,r){return e.apply(this,arguments)}));var i=(0,iD._)(r);return(0,ed._)((0,iD._)(r),"publishAnswer",(0,u1._)(function(){var e,t;return(0,u2.__generator)(this,function(n){switch(n.label){case 0:return t=(e=i.props).draft,[4,(0,e.addAnswer)((i.state||{}).checkedQuestionId,{bizExt:{bindArticleToken:t.id},commentPermission:"all",commercialReportInfo:{isReport:!1},content:t.content,disclaimerStatus:"close",disclaimerType:"none",isReport:!1,pushActivity:!1,reshipmentSettings:"allowed",rewardSetting:{canReward:!1},tableOfContentsEnabled:!1,thankInviterStatus:"close"})];case 1:return n.sent(),[2]}})})),(0,ed._)((0,iD._)(r),"handleSubmit",function(){var e=r.props,t=e.forceUpdateDraft,n=e.showErrorMessage,o=e.scheduledPublishAt,i=e.draft,a=e.getEditableInstance,c=e.selectedColumnId,s=e.columns;r.setState({submitting:!0});var u=(0,iD._)(r);t().then((0,u1._)(function(){var e,t,r,l,d,p,f,h,_;return(0,u2.__generator)(this,function(g){switch(g.label){case 0:if(u.props.contentIsTooShort)return[2,n("正文至少输入 ".concat(9," 个字"))];if(r=null!==c?s.find(function(e){return e.id===c}):null,((0,_g.x)(r)||(0,l9.ny)(i))&&100>(0,p0.Xs)(u.props.realTimeContent,!0))return[2,n("付费专栏内容需超过 100 字")];if(o&&_c.Z(o,hP.Z(new Date,30)))return up.Z.alert((0,m.tZ)("div",{style:{textAlign:"center"},children:"只能设置 30 分钟后的定时时间"}),{title:"定时发布"}),[2];if(((0,_g.x)(r)||(null==i?void 0:null===(e=i.columnTruncateConfig)||void 0===e?void 0:null===(t=e.text)||void 0===t?void 0:t.ratio))&&(!(l=u.state.truncateRatio)||isNaN(l)||30>Number(l)||Number(l)>80))return[2,n("试看内容需要设置在30-80%之间")];if(d=a()){if((0,_g.x)(r)&&d.hasVideo(""))return[2,n("付费专栏的文章不支持添加视频")];if(d.hasVideo("upload"))return[2,n("视频上传完成后即可发布")];if(d.hasImage("upload"))return[2,n("图片上传完成后即可发布")];if(d.hasImage("error")||d.hasVideo("error")&&!d.hasVideo("error-review"))return[2,n("草稿中含有上传失败的内容，请更改后重新提交")];if(d.hasVideo("error-review")||d.hasVideo("censor"))return[2,n("视频中包含未通过审核的信息，请更改后重新提交")];if((null===(p=u.paymentTypeSettingRef.current)||void 0===p?void 0:p.validate)&&(h=(f=u.paymentTypeSettingRef.current.validate()).success,_=f.error,!h))return[2,n(_)]}if("published"!==i.state)return[3,2];return[4,u.publishArticle()];case 1:return g.sent(),[2];case 2:if("draft"!==i.state)return[3,4];return[4,u.publishArticle(r,!0,!!s.length)];case 3:g.sent(),g.label=4;case 4:return[2]}})})).finally(function(){r.setState({submitting:!1})})}),(0,ed._)((0,iD._)(r),"handleReshipmentDisclaimers",function(e){r.setState({reshipmentDisclaimers:e}),aq.Z.trackEvent((0,iD._)(r),{id:7831,action:"Click"},{button:{text:e.description}})}),(0,ed._)((0,iD._)(r),"handleSubmitContentSource",function(e){r.setState({contentSourceInfo:e})}),(0,ed._)((0,iD._)(r),"renderContribution",function(){var e=r.props,t=e.draft,n=e.scheduledPublishAt,o=e.isContributionDisabled,i=t||{},a=i.id,c=i.state;return a&&"published"!==c?(0,m.tZ)(mr,{style:{display:n||r.isHasCard?"none":"block"},urlToken:String(a),onChange:function(e){return r.setState({checkedQuestionId:e})},disabled:o}):null}),(0,ed._)((0,iD._)(r),"renderDisclaimers",function(){var e,t=r.props,n=t.articleDisclaimers,o=t.disclaimerLabel,i=t.draft.id;if(!i)return null;var a=null===(e=o["article_".concat(i)])||void 0===e?void 0:e.disclaimerInfo;return(0,m.tZ)(mi,{disclaimerInfo:a,articleDisclaimers:n,ref:function(e){return r.disclaimersRef=e}})}),(0,ed._)((0,iD._)(r),"renderTrialPercentage",function(){var e,t=r.props,n=t.selectedColumnId,o=t.columns,i=t.draft;if(((0,_g.x)(o.find(function(e){return e.id===n}))||(0,l9.ny)(i))&&(null===(e=r.payTypeConfig)||void 0===e?void 0:e.type)!==_p.v8)return(0,m.tZ)(_v.Z,{value:r.state.truncateRatio,onChange:function(e,t){r.setState({truncateRatio:e}),t&&r.props.updateDraft({column_truncate_config:{text:{ratio:Number(e)}}})}})}),(0,ed._)((0,iD._)(r),"renderScheduledPublish",function(){var e=r.props,t=e.scheduledPublishAt,n=e.initialScheduledPublishAt,o=e.setUseScheduledPublish;return(0,m.tZ)(mE,{scheduledPublishAt:t,initialScheduledPublishAt:n,setUseScheduledPublish:o})}),(0,ed._)((0,iD._)(r),"renderRewardSetting",function(){var e=r.props,t=e.draft,n=e.setCanReward,o=e.canReward,i=e.syncDraftSettings;return t.id?(0,m.tZ)(__.a9,{setCanReward:n,canReward:o,updateDraftSettings:i}):null}),(0,ed._)((0,iD._)(r),"renderCommercialSetting",function(){var e,t,n=r.props,o=n.draft,i=n.id;return(0,m.tZ)(_h.Z,{type:"article",articleId:i,taskBindProps:{commercialZhitaskBindInfo:null===(e=o.settings)||void 0===e?void 0:e.commercialZhitaskBindInfo,onChange:function(e){return r.commercialZhitaskBindInfo=e}},reportProps:{commercialReportInfo:null===(t=o.settings)||void 0===t?void 0:t.commercialReportInfo,ref:function(e){return r.commercialReportRef=e}}})}),r}return(0,U._)(n,[{key:"componentDidUpdate",value:function(){if(void 0!==this.props.draft.columnTruncateConfig&&!this.state.isInitialized){var e,t;this.setState({truncateRatio:(null===(e=this.props.draft.columnTruncateConfig)||void 0===e?void 0:null===(t=e.text)||void 0===t?void 0:t.ratio)||30,isInitialized:!0})}}},{key:"isHasCard",get:function(){var e=this.props.draft;return/data-draft-type="edu-card"|data-draft-type="mcn-link-card"|(data-draft-type="ad-link-card"(?! data-ad-id="fee_))/g.test(null==e?void 0:e.content)}},{key:"payTypeConfig",get:function(){var e=this.props.draft;return(0,ea.decamelizeKeys)(e||{}).pay_type_config||{}}},{key:"renderTopics",value:function(){var e=this,t=this.props,n=t.draft,r=t.showErrorMessage;return n.id?(0,m.tZ)(mw,{draft:n,showErrorMessage:r,ref:function(t){return e.topicsRef=t}}):null}},{key:"renderColumns",value:function(){var e=this.props,t=e.columns,n=e.updateDraft;return(0,m.tZ)(_P,{columns:t,updateDraft:n,payTypeConfig:this.payTypeConfig,truncateRatio:this.state.truncateRatio})}},{key:"renderContentSource",value:function(){if(!this.props.draft.id)return null;var e=(this.state||{}).contentSourceInfo;return(0,m.tZ)(_s.Z,{handleSubmit:this.handleSubmitContentSource,originInfo:e})}},{key:"renderPreviewButton",value:function(){var e=this.props,t=e.disabled,n=e.draft,r=e.getEditableInstance,o=e.handleOpenReviewComment,i=e.columns,a=e.contentIsTooShort,c=e.showErrorMessage;return(0,m.tZ)(mm,{draftId:n.id,disabled:t,getEditableInstance:r,columns:i,handleOpenReviewComment:o,contentIsTooShort:a,showErrorMessage:c})}},{key:"renderSubmitButton",value:function(){var e=this.props,t=e.disabled,n=e.draft,r=e.scheduledPublishAt,o=e.isReediting,i=this.state.submitting?"发布中...":r?"定时发布":"draft"!==n.state&&n.state?"更新":"发布";return(0,m.tZ)(e7.ZAClick,{as:aC.ZP,zaType:"Button",zaText:!0,zaAction:"Post",zaModuleId:"published_button",extra:{configMap:{traceId:this.props.traceId,type:"Post",publish_type:o?"oldEdit":"newPublish"}},color:"blue",preset:"primary",onClick:this.handleSubmit,disabled:t||this.state.submitting,css:{marginLeft:"16px"},children:i})}},{key:"render",value:function(){var e=this.props,t=e.renderDraftText,n=e.realTimeContent,r=e.columns,o=e.canUseScheduledPublish,i=e.draft,a=e.logTime,c=e.updateDraft,s=e.markdownEnabled,u=e.selectedColumnId,l=r.find(function(e){return e.id===u});return(0,m.BX)(e7.ZAEnv,{block:"PublishArea",children:[(0,m.tZ)(e7.ZARef,{ref:this.zaRef}),(0,m.tZ)(i0.xu,{bg:"GBK09A",css:{height:"1px"}}),(0,m.BX)(i0.xu,{css:function(e){return{background:e.colors.GBK99C}},children:[(0,m.tZ)(_m.NZ,{children:"发布设置"}),(0,m.BX)(i0.kC,{pb:"11px",children:[(0,m.tZ)(_m.gN,{name:"添加封面"}),(0,m.tZ)(i0.xu,{flex:"1",children:(0,m.tZ)(_S,{source:i.id,image:i.titleImage,logTime:a,updateDraft:c})})]}),this.renderContribution(),this.renderDisclaimers(),this.renderTopics(),(null==r?void 0:r.length)>0&&(!i.state||"draft"===i.state)&&this.renderColumns(),(0,_g.x)(l)&&(0,m.tZ)(_d.Z,{ref:this.paymentTypeSettingRef,columnId:u,contentId:i.id,contentType:"article",payTypeConfig:this.payTypeConfig,updateDraft:this.updatePayTypeConfig,wrapperClassName:"columnSettingField"}),this.renderTrialPercentage(),this.renderRewardSetting(),this.renderContentSource(),this.renderCommercialSetting(),o&&this.renderScheduledPublish(),(0,m.tZ)(i0.xu,{bg:"GBK99A",height:"20px",mx:"-20px"}),(0,m.BX)(_m.$_,{children:[(0,m.tZ)(i0.xv,{color:"GBL05A",fontSize:"14px",ml:"24px",children:lN()(mZ(),(0,p0.Xs)(n,!0))}),s&&(0,m.tZ)(_l.Z,{}),(0,m.tZ)(i0.xv,{color:"GBL05A",fontSize:"14px",ml:"auto",mr:"-10px",children:t()}),this.renderPreviewButton(),this.renderSubmitButton()]})]})]})}}]),n}(b.Component);(0,ed._)(mx,"propTypes",{columns:iG().arrayOf(_T),editable:iG().object,draft:iG().object.isRequired,disabled:iG().bool,forceUpdateDraft:iG().func.isRequired,showErrorMessage:iG().func.isRequired}),(0,ed._)(mx,"defaultProps",{columns:[]});var mk=(0,th.compose)((0,aw.Z)(null),hE.SS,(0,e6.connect)(function(e){var t=e.articleDraft,n=t.selectedColumn,r=t.articleDisclaimers,o=t.column;return{currentUser:(0,eB.ib)(e),selectedColumnId:n||(null==o?void 0:o[0]),articleDisclaimers:r,disclaimerLabel:e.label}},{selectColumn:ii,loadArticlesDisclaimers:ir,loadLabel:n$.T$,addAnswer:tT.oe}),function(e){return cz()(function(t){var n,r,o,i,a,c,s,u,l,d,p,f=(n=(0,uY.Dt)(),r=(0,ef._)((0,_w.zb)(),1)[0],o=(0,hK.m5)(),i=(0,e6.useDispatch)(),a=(0,_A.u)("article",_k),c=(0,ef._)((0,_w.zb)(),1)[0],s={publish:(0,cL.A)(function(e,t,n,r){return c.safeRecordStageStart("pre-request"),a.publish(_Z(e,t,n,r)).then(function(e){return{payload:null==e?void 0:e.publish}})}),scheduledPublish:(0,cL.A)(function(e,t,n,r){return c.safeRecordStageStart("pre-request"),a.scheduledPublish(_Z(e,t,n,r)).then(function(e){return{payload:null==e?void 0:e.publish}})})},u=function(e,t){var r;return n.stash(_x,uY.KW.success),o.fire({type:"post-publish",context:{data:{publishAt:null==t?void 0:t.publish_at,content:null==e?void 0:null===(r=e.payload)||void 0===r?void 0:r.content}}}),e},l=function(e){var t,r;throw(!e.status||e.status>=500)&&n.reportFail(_x,e),o.fire({type:"post-publish",context:{error:e}}),(null==e?void 0:null===(t=e.payload)||void 0===t?void 0:t.code)===4031?up.Z.alert((0,m.tZ)(hO,{}),{text:{ok:"我知道了"}}).then(hf()):i((0,t1.c0)(null==e?void 0:null===(r=e.payload)||void 0===r?void 0:r.message,"red")),e},p=(0,cL.A)((d=(0,u1._)(function(e,t,a,c,d){var p,f,h,_,m,g,T,E,y,C,S,I,A,b,w,Z,x;return(0,u2.__generator)(this,function(k){switch(k.label){case 0:if(p=a.isNew,f=a.traceId,h=a.hasColumn,_=a.hasFormula,m=a.isRecommend,g=a.reshipmentDisclaimers,T=a.scheduledPublishAt,E=a.hasCatalog,y=a.autoSendingCreations,C=a.column_truncate_config,S=(0,F._)(a,["isNew","traceId","hasColumn","hasFormula","isRecommend","reshipmentDisclaimers","scheduledPublishAt","hasCatalog","autoSendingCreations","column_truncate_config"]),_&&n.reportRequest("HasFormula"),I=new URLSearchParams((0,G._)({},p&&{just_published:h?2:1},m&&{is_recommend:1})).toString(),A="".concat(I?"?":"").concat(I),r.safeRecordParamCollected("query",A),b=(null==g?void 0:g.type)||"none",w=(0,G._)({column:t,column_truncate_config:C,commentPermission:p?"anyone":void 0,disclaimer_type:b,disclaimer_status:"none"===b?"close":"open",table_of_contents_enabled:E,content:(null==c?void 0:c.content)||"",title:(null==c?void 0:c.title)||""},S),r.safeRecordParamCollected(),!T)return[3,2];return r.safeRecordStageStart("publish",{type:"scheduled publish",scheduledPublishAt:T,hitContentPublish:!0}),Z=(0,er._)((0,G._)({},w),{publish_at:Math.floor(T/1e3)}),[4,s.scheduledPublish(e,Z,p,f).then(function(e){return u(e,Z)},l).then(_R).catch(function(e){r.safeReport(e,"catch in scheduledPublish")})];case 1:case 3:return k.sent(),[2];case 2:var R;if(R=(0,u1._)(function(){return(0,u2.__generator)(this,function(t){switch(t.label){case 0:return r.safeRecordStageStart("publish",{type:"publish",hitContentPublish:!0}),o.fire({type:"pre-publish",context:{content:c.content,imageCount:null==c?void 0:c.imageCount,videoCount:null==c?void 0:c.videoCount}}),[4,s.publish(e,w,p,f).then(u,l).then((0,u1._)(function(){return(0,u2.__generator)(this,function(t){switch(t.label){case 0:if(!d.shouldPublishAnswer)return[3,2];return[4,d.publishAnswer().catch(function(){return null})];case 1:t.sent(),t.label=2;case 2:return _N("/p/".concat(e).concat(A)),[2]}})})).catch(function(e){r.safeReport(e,"catch in doPublish")})];case 1:return t.sent(),[2]}})}),x=function(){return R.apply(this,arguments)},y)return r.safeRecordStageStart("pre-publish",{type:"validate scheduled publish",autoSendingCreations:y}),i({API:{root:P.Z.fetchRoot.zhuanlan,types:oK.VALIDATE_SCHEDULED_PUBLISH,endpoint:"articles/".concat(e,"/scheduled-validate"),method:"POST",body:void 0},NOTIFICATION:!1}).then(x,function(e){var t;if((null==e?void 0:e.status)===400&&(null===(t=e.payload)||void 0===t?void 0:t.message))return up.Z.confirm(e.payload.message,{title:"提醒",text:{ok:"确定发布",cancel:"我再想想"}}).then(x,function(){n.reportSuccess(_x)});r.safeReport(e,"catch in validateScheduledPublish")}),[2];return[4,x()]}})}),function(e,t,n,r,o){return d.apply(this,arguments)})),(0,b.useState)(function(){return r.wrapAutoReport(n.recordError(_x,p),{reportedBy:"auto report in publishHandler",freshReport:{type:"article",scene:_k}})})[0]);return(0,m.tZ)(e,(0,er._)((0,G._)({},t),{publishArticle:f}))},e)})(mx),mR=n(89483),mN=n(18341),mO=function(e){var t=e.editorState,n=e.onCommand,r=e.queryCommandEnable,o=e.queryCommandState,i=e.toolbarMainAreaData,a=e.toolbarMoreAreaData,c=e.toolbarFixtureAreaData,s=e.toolbarAiAssistantData,u=e.className;return(0,m.tZ)(mN.Z,{className:u,editorState:t,onCommand:n,queryCommandEnable:r,queryCommandState:o,toolbarMainAreaData:i,toolbarMoreAreaData:a,toolbarFixtureAreaData:c,toolbarAiAssistantData:s})},mP=n(62095),mD=n(1612),mL=function(e){var t=e.editorState,n=e.onCommand,r=e.queryCommandEnable,o=e.queryCommandState,i=e.showUserProfitButton,a=e.onInsertVideoClick,c=e.getMarkdownEnabled,s=(0,mP.Z)().jumpUrl,u=(0,ef._)((0,mR.ij)(),2),l=u[0],d=u[1],p=(0,b.useMemo)(function(){return(0,mD.v$)({showProfit:i,onInsertVideoClick:a,isVideoAnswer:!1,shouldAdaptNative:"1"===P.Z.apollo.editor_adapt_native,hasPhotoLibraryToolbarTooltip:l,setHasPhotoLibraryToolbarTooltip:d})},[i,a,l,d]),f=(0,b.useMemo)(function(){return(0,mD.vr)()},[]),h=(0,b.useMemo)(function(){return(0,mD.vi)({getMarkdownEnabled:c,onHandleManageEditClick:function(){return window.open(s)}})},[c,s]),_=(0,b.useMemo)(function(){return(0,mD.sP)()},[]);return(0,m.tZ)(mO,{editorState:t,onCommand:n,queryCommandEnable:r,queryCommandState:o,toolbarMainAreaData:p,toolbarMoreAreaData:h,toolbarFixtureAreaData:f,toolbarAiAssistantData:_})},mM=n(60908),mB=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"state",{titleChangeStatus:!1,textContent:e.props.title}),(0,ed._)((0,iD._)(e),"isFocused",!1),(0,ed._)((0,iD._)(e),"previousHeight",44),(0,ed._)((0,iD._)(e),"resetCompositionStatus",function(){e.resetCompositionStatus.timerId=setTimeout(function(){(0,mM.Z)()},3e4)}),(0,ed._)((0,iD._)(e),"cancelResetCompositionStatus",function(){void 0!==e.resetCompositionStatus.timerId&&(e.resetCompositionStatus.timerId=clearTimeout(e.resetCompositionStatus.timerId))}),(0,ed._)((0,iD._)(e),"onCompositionStart",function(){if(!e.isFocused){e.cancelResetCompositionStatus(),e.resetCompositionStatus();return}e.composition=!0,e.handleChangeTitle.cancel()}),(0,ed._)((0,iD._)(e),"onCompositionEnd",function(){if(!e.isFocused){e.cancelResetCompositionStatus();return}e.composition=!1,e.handleChangeTitle(e.prevValue||e.input.value),e.prevValue=null}),(0,ed._)((0,iD._)(e),"onChangeTitle",function(t){e.props.logTime("start"),e.checkHeight();var n=t.target.value;e.setState({titleChangeStatus:!0,textContent:n}),e.composition?e.prevValue=n:e.handleChangeTitle(n)}),(0,ed._)((0,iD._)(e),"handleChangeTitle",(0,h6.Z)(function(t){var n=e.props,r=n.logTime;(0,n.updateDraft)({title:t,delta_time:r("calculate")})},300)),(0,ed._)((0,iD._)(e),"handleKeyDown",function(e){13===e.keyCode&&e.preventDefault()}),e}return(0,U._)(n,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.state.titleChangeStatus,n=e.title;n&&this.props.title!==n&&(this.checkHeight(),t||(this.input.value=n,this.setState({textContent:n})))}},{key:"componentDidMount",value:function(){this.checkHeight(),document.addEventListener("compositionstart",this.onCompositionStart),document.addEventListener("compositionend",this.onCompositionEnd);var e=this.props.title;e&&(this.input.value=e,this.checkHeight())}},{key:"componentWillUnmount",value:function(){this.cancelResetCompositionStatus(),this.handleChangeTitle.cancel(),document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd)}},{key:"checkHeight",value:function(){if(this.input){this.input.style.height="1px";var e=Math.max(this.input.scrollHeight,44);this.input.style.height="".concat(e,"px"),e!==this.previousHeight&&(this.previousHeight=e,this.props.onTitleHeightChange(e))}}},{key:"render",value:function(){var e=this,t=this.props,n=t.onRef,r=t.className;return(0,m.BX)("div",{className:r,children:[(0,m.tZ)(cd.Z,{className:"WriteIndex-titleInput",multiline:!0,placeholder:"请输入标题（最多 ".concat(100," 个字）"),onChange:this.onChangeTitle,onRef:function(t){e.input=t,n(t)},onKeyDown:this.handleKeyDown,onFocus:function(){return e.isFocused=!0},onBlur:function(){return e.isFocused=!1},rows:"1"}),(0,m.tZ)(_e,{content:this.state.textContent,type:"title",onStatusChange:this.props.onLengthStatusChange})]})}}]),n}(b.Component);(0,ed._)(mB,"propTypes",{title:iG().string,logTime:iG().func.isRequired,updateDraft:iG().func.isRequired,onRef:iG().func,onTitleHeightChange:iG().func}),(0,ed._)(mB,"defaultProps",{onRef:function(){},onTitleHeightChange:function(){}});var mU=(0,aw.Z)(null)(mB),mG=function(e){(0,iL._)(n,e);var t=(0,iM._)(n);function n(){var e;return(0,B._)(this,n),e=t.apply(this,arguments),(0,ed._)((0,iD._)(e),"startCompositionTime",null),(0,ed._)((0,iD._)(e),"rootRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"toolbarWrapperRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"aiAssistantRef",(0,b.createRef)()),(0,ed._)((0,iD._)(e),"state",{showReviewComment:!1,forceCloseReview:!1,isTyping:!1,titleLengthIsOk:!1,contentLengthIsOk:!1,scheduledPublishAt:void 0,editorState:null,showInsertableVideoUploader:!1,isSmallScreen:!1,markdownEnabled:!1,canReward:null,isContributionDisabled:!1,aiAssistantOpen:!1,accountBinding:null}),(0,ed._)((0,iD._)(e),"reporter",(0,uY.ZP)("PostPage",function(){return e.props.currentUserToken})),(0,ed._)((0,iD._)(e),"checkShouldCancelScheduledPublish",function(){e.isEditBlocking&&up.Z.confirm("如果继续编辑该文章，原定时发送设置将会失效，需重新设置定时发送时间，是否继续编辑？",{title:"编辑文章",text:{ok:"继续编辑",cancel:"我再想想"}}).then(function(){var t=e.props,n=t.draft;(0,t.cancelScheduledPublish)(n.id)},function(){window.location.href="https://www.zhihu.com/draft?type=article&filter=schedule"})}),(0,ed._)((0,iD._)(e),"handleToggleInsertVideoState",function(t){e.setState({showInsertableVideoUploader:t})}),(0,ed._)((0,iD._)(e),"handleOpenReviewComment",function(){e.setState({showReviewComment:!0})}),(0,ed._)((0,iD._)(e),"handlePreviewCommentsClose",function(){e.setState({forceCloseReview:!0})}),(0,ed._)((0,iD._)(e),"handleTyping",function(t){e.setState({isTyping:t})}),(0,ed._)((0,iD._)(e),"handleAnyChange",function(t){var n=t.editorState;e.setState({editorState:n})}),(0,ed._)((0,iD._)(e),"toggleMarkdownEnabled",function(){var t=e.state.markdownEnabled;e.setState({markdownEnabled:!t}),e.props.updateMarkdownSettings({markdownEnabled:!t})}),(0,ed._)((0,iD._)(e),"setCanReward",function(t){e.setState({canReward:t})}),(0,ed._)((0,iD._)(e),"renderDraftText",function(){if(!e.props.draft)return"";var t=e.props.draft||{},n=t.updatedTime,r=t.updating,o=t.error,i=e.state.isTyping;return(0,m.tZ)(hh.Z,{updating:r||i,updateFailed:o,updatedTime:e.getTimestamp(n),handleKeyCommand:e.handleKeyCommand})}),(0,ed._)((0,iD._)(e),"renderNavbarFunctionality",function(){return null}),(0,ed._)((0,iD._)(e),"renderPublishArea",function(){var t,n=e.props,r=n.draft,o=n.myColumns,i=e.state,a=i.contentLengthIsOk,c=i.titleLengthIsOk,s=i.scheduledPublishAt,u=i.markdownEnabled,l=i.isContributionDisabled,d=i.canReward;return(0,m.tZ)(mk,{id:null===(t=e.props.params)||void 0===t?void 0:t.id,renderDraftText:e.renderDraftText,scheduledPublishAt:s,columns:o,draft:r,disabled:!(a&&c),forceUpdateDraft:e.forceUpdateDraft,showErrorMessage:e.showErrorMessage,getEditableInstance:function(){return e.editable},logTime:e.logTime,updateDraft:e.updateDraft,handleOpenReviewComment:e.handleOpenReviewComment,markdownEnabled:u,canReward:d,setCanReward:e.setCanReward,syncDraftSettings:e.syncDraftSettings,isContributionDisabled:l,isReediting:"published"===r.state})}),(0,ed._)((0,iD._)(e),"onTitleStatusChange",function(t){t!==e.state.titleLengthIsOk&&e.setState({titleLengthIsOk:t})}),(0,ed._)((0,iD._)(e),"onTitleHeightChange",function(){requestAnimationFrame(function(){if(e.aiAssistantRef.current){var t,n;null===(n=(t=e.aiAssistantRef.current).updateStickyInfo)||void 0===n||n.call(t)}})}),(0,ed._)((0,iD._)(e),"onUseAiImageFeature",function(){e.props.scheduleAIImageFeature(function(){if(e.aiAssistantRef.current){var t,n;null===(n=(t=e.aiAssistantRef.current).showAiImageFeature)||void 0===n||n.call(t)}})}),(0,ed._)((0,iD._)(e),"onContentStatusChange",function(t){t!==e.state.contentLengthIsOk&&e.setState({contentLengthIsOk:t})}),(0,ed._)((0,iD._)(e),"getTimestamp",function(e){return Math.floor((e?new Date(e):new Date).getTime()/1e3)}),(0,ed._)((0,iD._)(e),"startLoggingTime",function(){e.startCompositionTime||(e.startCompositionTime=e.getTimestamp())}),(0,ed._)((0,iD._)(e),"stopLoggingTime",function(){e.startCompositionTime=null}),(0,ed._)((0,iD._)(e),"calculateLoggingTime",function(){var t=e.props.draft,n=e.getTimestamp(t.updatedTime),r=e.getTimestamp();return!n||e.startCompositionTime-n>180?r-e.startCompositionTime:r-n}),(0,ed._)((0,iD._)(e),"showErrorMessage",function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"red",r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i="未知错误";t&&("string"==typeof t?i=t:t.payload&&t.payload.message?i=t.payload.message:t.message&&(i=t.message)),e.props.showNotification(i,n,r,o)}),(0,ed._)((0,iD._)(e),"getHelpDocInitialOffset",function(){var t=e.toolbarWrapperRef.current;if(t)return{top:t.getBoundingClientRect().bottom+20,right:0}}),(0,ed._)((0,iD._)(e),"updateDraft",function(t){if(!e.isUserBoundPhone)return e.context.handleBindPhoneModalToggle(),Promise.resolve();var n=e.props,r=n.draft,o=n.updateDraft;if(r.hasPublishingDraft)return up.Z.alert("你有一份对该文章的修改正在发布中，请等待发布完成后再次修改。"),Promise.resolve();null!=e.state.canReward&&(t=(0,er._)((0,G._)({},t),{can_reward:e.state.canReward}));var i=r.id,a=r.draftLoading,c=function(){return e.logTime("stop")},s=function(e){throw e.payload=(0,er._)((0,G._)({},e.payload),{requestParams:{id:i||"Unknown",body:t}}),e};return i||a?i?o(i,t).then(c,s):(up.Z.alert("草稿加载中，请等待加载完成后再次修改。"),Promise.resolve()):o(null,t).then(c,s)}),(0,ed._)((0,iD._)(e),"forceUpdateDraft",function(){if(!e.isUserBoundPhone)return e.context.handleBindPhoneModalToggle(),Promise.resolve();var t=e.titleNode&&e.titleNode.value,n=e.coverNode&&e.coverNode.src,r=e.editable&&e.editable.toHTML({source:"ColumnWrite_forceUpdateDraft"}),o={},i=e.props.draft;return(t&&!i.title&&(o.title=t),n&&!i.titleImage&&(o.titleImage=n),r&&!i.content&&(o.content=r),(0,h_.Z)(e.reporter,r,"",e.editable),hd()(o))?Promise.resolve():e.updateDraft(o)}),(0,ed._)((0,iD._)(e),"logTime",function(t){return e["".concat(t,"LoggingTime")]()}),(0,ed._)((0,iD._)(e),"syncDraftSettings",function(){e.logTime("start");var t=e.logTime("calculate");setTimeout(function(){var n,r={table_of_contents:null===(n=e.editable)||void 0===n?void 0:n.hasCatalog(),delta_time:t};e.updateDraft(r)},0)}),(0,ed._)((0,iD._)(e),"handleKeyCommand",function(t){if(!e.editable)return"not-handled";var n=e.editable.handleKeyCommand(t);return"toggle-catalog"===t&&(e.syncDraftSettings(),requestAnimationFrame(function(){e.forceUpdate()})),n}),(0,ed._)((0,iD._)(e),"queryCommandEnable",function(t,n){return!!e.editable&&e.editable.queryCommandEnable(t,n)}),(0,ed._)((0,iD._)(e),"queryCommandState",function(t,n){return!!e.editable&&e.editable.queryCommandState(t,n)}),(0,ed._)((0,iD._)(e),"onInsertVideoClick",function(){return e.handleToggleInsertVideoState(!0)}),(0,ed._)((0,iD._)(e),"onCloseCatalog",function(){e.editable&&(e.handleKeyCommand("toggle-catalog"),requestAnimationFrame(function(){e.forceUpdate()}))}),(0,ed._)((0,iD._)(e),"toggleAIAssistantPanel",function(t){e.props.isAIAssistantEnabled&&e.setState({aiAssistantOpen:t})}),(0,ed._)((0,iD._)(e),"handleTitleChange",function(t){e.titleNode&&(e.titleNode.value=t),e.logTime("start");var n=e.logTime("calculate");e.updateDraft({title:t,delta_time:n})}),e}return(0,U._)(n,[{key:"isEditBlocking",get:function(){var e=this.props.draft;return!!(e&&e.schedule)}},{key:"componentDidMount",value:function(){var e,t,n=this;null===(e=this.props.writeShield)||void 0===e||null===(t=e.setOnModalClose)||void 0===t||t.call(e,function(){window.location.href="https://www.zhihu.com"}),window.screen.availWidth<860&&this.setState({isSmallScreen:!0}),(0,uY.hx)(),aq.Z.setModule(this.rootRef.current,{module:"PostEditView"}),aq.Z.trackPageShow({id:3371});var r=this.props.location;r.hash&&r.hash.includes("show_doc_modal")&&setTimeout(function(){n.handleKeyCommand("insert-doc")},1e3);var o=this.props,i=o.params.id,a=o.draft,c=o.getDraft,s=o.getAccountBinding,u=o.loadArticlesDisclaimers,l=o.loadLabel,d=o.queryDefaultSettings,p=o.loadArticlesLimited,f=o.selectColumn,h=o.loadAITask;p(i).then(function(e){var t;(null==e?void 0:null===(t=e.payload)||void 0===t?void 0:t.isAbleTo)||(n.setState({isContributionDisabled:!0}),up.Z.confirm((0,m.tZ)(hO,{}),{text:{ok:"发想法",cancel:"知道了"}}).then(function(){window.location.href="https://www.zhihu.com/?writepin"},hf()))}),d().then(function(e){var t,r,o,i;n.setState((0,G._)({markdownEnabled:null==e?void 0:null===(t=e.payload)||void 0===t?void 0:null===(r=t.commonSettings)||void 0===r?void 0:r.markdownEnabled},null==n.state.canReward?{canReward:!!(null==e?void 0:null===(o=e.payload)||void 0===o?void 0:null===(i=o.settings)||void 0===i?void 0:i.canReward)}:{}))}),h("article"),s().then(function(e){n.setState({accountBinding:null==e?void 0:e.payload})}),i&&(a&&a.id===i?(null==a?void 0:a.canReward)!=null&&this.setState({canReward:!!a.canReward}):c(i).then(function(e){n.setState({canReward:!!e.payload.canReward});var t=e.payload.column;(null==t?void 0:t[0])&&f(t[0])}).then(this.checkShouldCancelScheduledPublish).catch(function(e){if(e.res){var t=e.res,r=e.payload;404===t.status?window.location.href="https://zhuanlan.zhihu.com/p/".concat(i):n.showErrorMessage(r)}}),u(i),l("article",i))}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,r=n.draft,o=n.location,i=n.router,a=n.loadArticlesDisclaimers,c=n.loadLabel;if(r&&r.id&&"/write"===o.pathname){a(r.id),c("article",r.id);var s=new URL("/p/".concat(r.id,"/edit"),window.location.origin);o.query.c_id&&(s.search=new URLSearchParams({c_id:o.query.c_id}).toString()),i.replace(s.toString());return}o.hash&&o.hash.includes("show_doc_modal")&&(!e.location.hash||!e.location.hash.includes("show_doc_modal"))&&setTimeout(function(){t.handleKeyCommand("insert-doc")},1e3)}},{key:"componentWillUnmount",value:function(){this.props.resetDraft()}},{key:"renderPageTitle",value:function(){return(0,m.tZ)("div",{className:"WriteIndex-pageTitleWrapper",children:(0,m.tZ)("div",{className:"WriteIndex-pageTitle",children:"写文章"})})}},{key:"isUserBoundPhone",get:function(){var e=this.props.currentUser,t=e.isBindPhone,n=e.isRealname;return t||n}},{key:"renderPreviewComments",value:function(){var e=this.props.draft,t=this.state,n=t.forceCloseReview,r=t.showReviewComment,o=e.id,i=e.reviewers;if(!n&&(r||(void 0===i?[]:i).length>0)&&o)return(0,m.tZ)(ha,{className:"WriteIndex-previewWrapper",post:e,close:(0,m.tZ)(aC.ZP,{className:"WriteIndex-closePreview",onClick:this.handlePreviewCommentsClose,children:(0,m.tZ)(aV.HN,{size:18})})})}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.draft,o=n.isMobile,i=n.isOrg,a=n.showUserProfitButton,c=n.isAITaskLoaded,s=n.isAIAssistantEnabled,u=n.isAIImageEnabled;if(o)return(0,m.tZ)(hg,{to:"/"});if(!r||!c)return(0,m.tZ)(cW.Z,{active:!0});var l=r.title,d=r.content,p=this.state,f=p.scheduledPublishAt,h=p.editorState,_=p.showInsertableVideoUploader,g=p.isSmallScreen,T=p.aiAssistantOpen;return(0,m.tZ)(e7.ZAEnv,{content:r.id?{type:"Post",id:String(r.id),token:String(r.id)}:void 0,children:(0,m.BX)(hE.ZP,{children:[(0,m.tZ)(dd.Z,{pageInfo:{pageId:"10167"}}),(0,m.BX)(hA.H.Provider,{value:"article-pc-editor",children:[(0,m.BX)("div",{className:"WriteIndexLayout",ref:this.rootRef,children:[(0,m.tZ)(e4.xB,{styles:{".App-main":{paddingBottom:0}}}),(0,m.tZ)(hT.Z,{}),(0,m.BX)(uY.ct.Provider,{value:this.reporter,children:[(0,m.tZ)(eJ.ql,(0,G._)({title:"写文章"},(0,hy.Oo)(hy.EE))),(0,m.tZ)(d$.Z,{title:this.renderPageTitle(),renderNavbarFunctionality:this.renderNavbarFunctionality,sticky:!1,editable:this.editable}),(0,m.BX)("div",{className:i$()("WriteIndexLayout-main WriteIndex"),css:function(e){return{marginTop:0,width:"100%",background:e.colors.GBK10A}},children:[(0,m.tZ)(dw.Z,{getStyle:function(){return{width:"100%",top:0,left:0}},children:(0,m.tZ)("div",{ref:this.toolbarWrapperRef,css:function(e){return{display:"flex",justifyContent:"center",margin:"0 auto",background:e.colors.GBK99A}},children:(0,m.tZ)(mL,{editorState:h,onCommand:this.handleKeyCommand,queryCommandEnable:this.queryCommandEnable,queryCommandState:this.queryCommandState,showUserProfitButton:a,onInsertVideoClick:this.onInsertVideoClick,draftPage:"https://www.zhihu.com/".concat(i?"organization":"creator","/manage/creation/draft?type=article"),toggleMarkdownEnabled:this.toggleMarkdownEnabled,getMarkdownEnabled:function(){return t.state.markdownEnabled}})})}),(0,m.tZ)("div",{className:i$()("WriteIndexMain",{"WriteIndexMain-aiAssistantOpen":T}),children:(0,m.BX)("div",{css:function(e){return{width:g?"694px":T&&window.innerWidth<1500?"694px":"840px",margin:"0 auto",boxSizing:"border-box",padding:"0 20px",background:e.colors.GBK99A,marginTop:"10px",position:"relative"}},children:[!h&&(0,m.tZ)("div",{css:function(e){return{background:e.colors.GBK99A,position:"absolute",left:0,top:0,width:"100%",height:"100%",padding:40,zIndex:1,boxSizing:"border-box"}},children:(0,m.tZ)(hu.O,{variant:"T01"})}),(0,m.tZ)(mU,{onRef:function(e){return t.titleNode=e},title:l,logTime:this.logTime,updateDraft:this.updateDraft,onTitleHeightChange:this.onTitleHeightChange,onLengthStatusChange:this.onTitleStatusChange,css:{overflow:"hidden"}}),!this.isEditBlocking&&(0,m.tZ)(_a,{onEditableRef:function(e){return t.editable=e},isReediting:"published"===r.state,postId:r.id||(null===(e=this.props.params)||void 0===e?void 0:e.id),post:r,content:d,isAIAssistantEnabled:s,isAIImageEnabled:u,onTyping:this.handleTyping,logTime:this.logTime,updateDraft:this.updateDraft,toggleAIAssistantPanel:this.toggleAIAssistantPanel,onLengthStatusChange:this.onContentStatusChange,showErrorMessage:this.showErrorMessage,showInsertableVideoUploader:_,handleToggleInsertVideoState:this.handleToggleInsertVideoState,scheduledPublishAt:f,onScheduledPublishAtChange:function(e){return t.setState({scheduledPublishAt:e})},handleAnyChange:this.handleAnyChange,publishArea:!!r&&this.renderPublishArea(),onCloseCatalog:this.onCloseCatalog,getEditableInstance:function(){return t.editable},getHelpDocInitialOffset:this.getHelpDocInitialOffset,forceUpdateWriteIndex:this.forceUpdate.bind(this),toggleMarkdownEnabled:this.toggleMarkdownEnabled,getMarkdownEnabled:function(){return t.state.markdownEnabled},aiAssistantRef:this.aiAssistantRef,onTitleChange:this.handleTitleChange,accountBinding:this.state.accountBinding,onUseAiImageFeature:this.onUseAiImageFeature}),this.renderPreviewComments()]})})]})]})]}),(0,m.tZ)(hN,{})]})]})})}}]),n}(b.Component);(0,ed._)(mG,"contextTypes",{handleBindPhoneModalToggle:iG().func});var mF=(0,th.compose)((0,hS.ZP)({init:!0,getScene:function(){return{type:"article"}}}),hm.g,sj.nx,iZ.withRouter,(0,e6.connect)(is,{getDraft:function(e){return{API:{types:o$,endpoint:"articles/".concat(e,"/draft"),root:P.Z.fetchRoot.zhuanlan}}},getAccountBinding:ia,resetDraft:function(){return{type:o6}},updateDraft:function(e,t){if(null===t.content)throw Error("The content of draft should not be null.");return{meta:{id:e,body:t},API:{types:oJ,endpoint:e?"articles/".concat(e,"/draft"):"articles/drafts",root:P.Z.fetchRoot.zhuanlan,method:e?"PATCH":"POST",body:t,fetchOptions:{zsAutoSignature:!1}}}},showNotification:t1.c0,cancelScheduledPublish:function(e){return{API:{root:P.Z.fetchRoot.zhuanlan,types:oK.CANCEL_SCHEDULED_PUBLISH,endpoint:"articles/".concat(e,"/scheduled-publish"),method:"DELETE"}}},loadArticlesDisclaimers:ir,loadLabel:n$.T$,queryDefaultSettings:rd.Gl,updateMarkdownSettings:rd.zp,loadArticlesLimited:function(e){return{API:{method:"GET",types:o8,endpoint:"community-prod/publish_article/is-able-to",query:{content_token:e}}}},selectColumn:ii,loadAITask:function(e){return{API:{method:"GET",types:oK.GET_AI_TASK,root:P.Z.fetchRoot.www,endpoint:"ai/task/show",query:{content_type:e}},FAILSAFE:!0,UPDATE:{failure:{aiTask:{}}}}}}),(0,hC.gF)("article"),hI.u)(mG),mH=iO(function(){return Promise.all([n.e(620),n.e(6670),n.e(5935),n.e(7593),n.e(3914)]).then(n.bind(n,94530))}),mz=iO(function(){return Promise.all([n.e(620),n.e(6670),n.e(5935),n.e(7593),n.e(3914)]).then(n.bind(n,86575))}),mq=(0,m.BX)(iZ.Route,{path:"/",component:sW,name:"Index",onEnter:function(e){if(L.jS.onEnter(e),(0,nS.isBrowser)()){var t,n=iP(e);(0,I.t0)(n),(t=window.performance)&&t.timing&&((0,H.uK)(function(e){return(0,I.pp)(e)}),(0,H.I)({report:function(e){return I.ZP.increment("".concat((0,I.j0)(),".").concat(e,".count"))}}))}},onChange:function(e,t){L.jS.onChange(e,t),(0,I.t0)(iP(t))},outsideMainWWeb:!0,children:[(0,m.tZ)(iZ.IndexRoute,{component:ue,name:"Home",showAppHeader:!0}),(0,m.tZ)(iZ.Route,{authRequired:!0,path:"drafts",getComponent:iO(function(){return n.e(7939).then(n.bind(n,61606))}),name:"Drafts"}),(0,m.tZ)(iZ.Route,{authRequired:!0,path:"write",component:mF,name:"WritePage"}),(0,m.tZ)(iZ.Route,{showAppHeader:!0,path:":id",getComponent:mH,name:"Column"}),(0,m.tZ)(iZ.Route,{authRequired:!0,path:"column/request",getComponent:iO(function(){return n.e(1011).then(n.bind(n,87300))}),name:"Request",showAppHeader:!0}),(0,m.tZ)(iZ.Route,{path:"column/p/:id",component:f5,showAppHeader:!0,name:"ColumnPost"}),(0,m.tZ)(iZ.Route,{authRequired:!0,path:"column/:id/edit",getComponent:iO(function(){return Promise.all([n.e(3103),n.e(586)]).then(n.bind(n,10026))}),name:"PaidColumnEdit",showAppHeader:!0}),(0,m.tZ)(iZ.Route,{authRequired:!0,path:"column/create",getComponent:iO(function(){return Promise.all([n.e(3103),n.e(8580)]).then(n.bind(n,59261))}),name:"PaidColumnCreate",showAppHeader:!0}),(0,m.tZ)(iZ.Route,{path:"column/:id",getComponent:mz,name:"NewColumn",showAppHeader:!0}),(0,m.tZ)(iZ.Route,{authRequired:!0,path:"column/:id/collect",getComponent:iO(function(){return n.e(9157).then(n.bind(n,5824))}),name:"ColumnCollect",showAppHeader:!1,zaPageShowId:8168}),(0,m.tZ)(iZ.Route,{path:"column/:id/about",getComponent:iO(function(){return n.e(3295).then(n.bind(n,56551))}),name:"ColumnAbout",showAppHeader:!0}),(0,m.tZ)(iZ.Route,{authRequired:!0,path:"column/:id/settings",getComponent:iO(function(){return n.e(3844).then(n.bind(n,8861))}),name:"ColumnSettingsV2"}),(0,m.tZ)(iZ.Route,{authRequired:!0,path:"p/:id/edit",component:mF,name:"EditPage"}),(0,m.tZ)(iZ.Route,{path:"p/:id",component:f5,showAppHeader:!0,name:"Post"}),(0,m.tZ)(iZ.Route,{authRequired:!0,path:"p/:id/preview",component:hs,name:"PreviewPost",showAppHeader:!0}),(0,m.tZ)(iZ.Route,{name:"ZVideoCollection",path:"zvideo/serial/collection/:id",getComponent:iO(function(){return Promise.all([n.e(620),n.e(6670),n.e(5935),n.e(7593),n.e(8106)]).then(n.bind(n,13606))}),showAppHeader:!1}),(0,m.tZ)(iZ.Redirect,{from:"/p/:id/voters",to:"/p/:id",query:{from_voters_page:!0}}),(0,m.tZ)(iZ.Redirect,{from:"/:columnId/:id",to:"/p/:id"}),ix]});function mV(){return(0,m.tZ)(iZ.Router,{history:iZ.browserHistory,children:mq})}a=(i={rootReducer:iw,renderCallback:function(e,t){var n=t.container;tf.Z.setAppElement&&tf.Z.setAppElement(n),e(mV)},routes:mq}).rootReducer,c=i.renderCallback,u=(s={routes:i.routes,createStore:(0,tp.getCreateStore)(a),onRequestRender:function(e){var t=e.store,n=e.canaryConfig,r=e.http,o=e.container,i=e.afterHydrate,a=function(e){var a="csr"===t.getState().env.mode,c=a?eY.render:eY.hydrate;a||z.Sv.mark(z.b.HydrateStart),c((0,m.tZ)(eJ.B6,{children:(0,m.tZ)(tl,{store:t,canaryConfig:n,children:(0,m.tZ)(td.q.Provider,{value:r,children:(0,m.tZ)(e,{})})})}),o),null==i||i()};new Promise(function(e){/interactive|complete/.test(document.readyState)?e():document.addEventListener("DOMContentLoaded",e)}).then(function(){return c(a,e)})}}).createStore,l=s.onRequestRender,document.addEventListener("DOMContentLoaded",function(){window.Raven||(window.Raven={captureException:eL,captureMessage:eL,captureBreadcrumb:eL});var e,t,r,o,i,a,c,s,d=JSON.parse(document.getElementById("js-initialData").textContent),p=d.initialState,f=d.subAppName,h=d.spanName,_=d.fetchHost,m=d.canaryConfig,w=(0,eU.Xj)(p),Z=p.env,N=Z.vars.passThroughHeaders,B=!!(Z.userAgent.ZhihuHybrid||Z.userAgent.Zhihu),U=B?{}:eb(),H=[(0,ej.O)(),!1,(0,E.Z)(),(0,y.Z)(),(0,C.Yq)(),function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.allowPassThroughHeaders,o=(0,F._)(n,["allowPassThroughHeaders"]);return e(t,(0,er._)((0,G._)({},o),{headers:void 0!==r&&r?(0,G._)({},N,o.headers):o.headers}))}},!B&&function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,ek._)({},(0,eR._)(n));return e(t,(0,er._)((0,G._)({},r),{headers:(0,G._)({},r.headers,U.xZst81&&{"x-zst-81":U.xZst81})}))}},eX({query:Z.ctx.query,spanName:h,isOffice:w}),eD({ua:Z.userAgent,authInfo:{id:p.currentUser},xUDId:Z.xUDId,passVars:N}),(e=Z.xTrafficFreeOrigin,function(t){return e?function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t(n,(0,er._)((0,G._)({},r),{headers:(0,er._)((0,G._)({},r.headers),{"x-traffic-free":e})}))}:t}),function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e(t,n).then(null,eS)}},(t={namespace:f,getCurrentUser:function(){return p.currentUser}},function(e){return function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e(n,r).catch(function(e){throw/--(mr|box)/.test(location.host)||/--(mr|box)/.test(n)||function(e,t){var n,r=t.url,o=t.options,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.namespace,c=void 0===a?"Unknown":a,s=i.entryName,u=void 0===s?"FetchErrorV2":s,l=i.getCurrentUser,d=o||{},p=d.method,f=void 0===p?"GET":p,h=d.headers,_=h?Object.keys(h).length:0,m=location.protocol,g=location.host,T=location.href,E=eZ({protocol:m,host:g}),y=new URL(r,T),C=em(y.pathname);if(!(y.host!==g||y.protocol!==m)){var S=[c,u,"SameOriginV1",E,f,C,"count"].join(".");I.ZP.increment({name:S,options:{version:"all"}}),401===e.status&&ex(e,void 0===l?function(){return"Unknown"}:l);return}var A="CrossOrigin",b=[c,u,A,E,f,eZ(y),"H_".concat(_),C,"count"].join(".");I.ZP.increment({name:b,options:{version:"all"}}),null===(n=window.Raven)||void 0===n||n.captureException(e,{fingerprint:["FetchError",A],level:"warning",extra:{local:location.href,remote:r,method:f,headers:h}})}(e,{url:n,options:r},t),e})}}),function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.downgradeProbe,o=(0,F._)(n,["downgradeProbe"]);if(!r)return e(t,o);var i=r.url,a=ev.instance();return e(a.prefer(t.toString(),i),o).catch(function(n){if((0,ep._)(n,eo.Z)&&n.status>=500&&n.url!==i)return eE("downgrading",eg(t.toString())),a.check(n.url),e(i,o);throw n})}},eu].filter(Boolean),q=el(H,_),V=u(p,{http:q});V.dispatch((0,eU.GM)(navigator.userAgent)),!1===O().get(D.Xq)&&V.dispatch((0,eU.JT)(!1)),"production"===Z.trafficSource&&x()(b,function(e,t){return window.Raven.captureException(e,{extra:t}),null}),S.Z.install({appName:"main"===f?"heifetz":"heifetz-".concat(f),timingSampleRate:.001});var W=(0,eB.ib)(V.getState()),X=(0,eU.Uh)(V.getState()),K=(0,eU.Hu)(V.getState());w&&!K&&(i=(o=(r=JSON.parse(document.getElementById("js-initialData").textContent).initialState).env).vars.passThroughHeaders,a=[(0,E.Z)(),(0,C.Yq)(),eD({ua:o.userAgent,authInfo:{id:r.currentUser},xUDId:o.xUDId,passVars:i}),eu],c=(0,ei.Z)(fetch,[function(e){return function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(void 0,(0,g._)(n)).then(function(e){var t=e.payload,n=void 0===t?{}:t;return n.data&&!n.paging?n.data:n})}}].concat((0,g._)(a))),window.addEventListener("message",function(e){var t=e.data,n=t.url,r=t.params;"zop"===t.source&&c(n,(0,G._)({},r)).then(function(e){window.postMessage({source:"heifetz",sign:e,err:null},window.location.origin)}).catch(function(e){window.postMessage({source:"heifetz",sign:null,err:e},window.location.origin)})},!1)),(0,eM.N4)(el([function(e){return function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(void 0,(0,g._)(n)).then(function(e){var t=e.payload,n=void 0===t?{}:t;return n.data&&!n.paging?n.data:n})}}].concat((0,g._)(H)),_)),l({store:V,http:q,container:document.getElementById("root"),canaryConfig:m,afterHydrate:function(){z.Sv.mark(z.b.HydrateEnd),en(Z,h),X.Wechat&&(I.ZP.increment("WechatSDK.config.intention.count"),(0,T.S0)().catch(function(e){throw I.ZP.increment("WechatSDK.config.fail.count"),(0,eK.DU)("initOpenInApp",e,X,w?W:{}),e})),X.JDMiniProgram&&(0,R.v)("https://beta-mini-app-static.jd.com/apps/jssdktest/js/jssdk.js"),X.MQQBrowser&&K&&(0,R.v)("https://jsapi.qq.com/get?api=app.openPhotoBrowser")}}),"Unhuman"!==h&&(0,L.Hf)(W,X).then(function(){n.e(4299).then(n.bind(n,14299)).then(function(e){(null==e?void 0:e.default)&&new e.default({performance:!0,resourceError:!1,request:!1,resourcePerformance:!0,runtimeError:!1,common:{disableLog:!1,projectId:"heifetz"}})})});var j=null===(s=Z.abV2)||void 0===s?void 0:s.config;if(null==j?void 0:j.abMap){var Y={abConfig:j,idInfo:{memberHashId:null==W?void 0:W.id}};(0,A.M)(Y)}X.ZhihuHybrid&&w&&k.Z.enableLog(),M.Z.config({userId:p.currentUser}),W&&!B&&["www.zhihu.com","zhuanlan.zhihu.com","www-zhihu-com","zhuanlan-zhihu-com"].some(function(e){return location.host.includes(e)})&&function(e){var t=P.Z.refreshValidityPeriod,n=Date.now(),r=(0,eF.LP)();if(r){var o=JSON.parse(r),i=o.token;n-o.timestamp>864e5*Number(t)&&e((0,eH.zq)((0,ez.Z)("refresh_token",{refreshToken:i})));return}(0,eG.Z)("/api/account/prod/token/refresh",{method:"POST"}).then(function(t){var n=t.refresh_token;e((0,eH.zq)((0,ez.Z)("refresh_token",{refreshToken:n})))}).catch(function(e){var t=e.error;I.ZP.increment("token.error.getRefreshToken.".concat(null==t?void 0:t.code))})}(V.dispatch)})},58931:function(e,t,n){"use strict";var r=n(7835),o=n(54231);t.Z=function(e){var t=e.type;return(0,r.b)(function(){o.ZP.increment("mobile.".concat(t,".count"))}),null}},882:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),u=n(85879),l=n(6779),d=n(68354),p=n(67814),f=n.n(p),h=n(83821),_=n(14168),m=n.n(_),g=n(87363),T=n(92258),E=n(14914),y=n(55536),C=n(63638),S=n(69725),I=n(65423),A=n(57730),b=n(1733),w=n(67516),Z=n.n(w),x=n(25452),k=n(85703),R=n(46704),N=n(6226),O=n(80692),P=n(24752),D=n(21680),L=n(66263),M=n(5469),B=n(68680),U=n(1785),G=n(85576),F=n(16850),H=n(82335),z=n(67927),q=n(39041),V=n(67036),W=n(26820),X=n(11233),K=n(26974),j=n(96717),Y=n(44765),Q=n(86538),J=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{deleteModalShown:!1,reportModalShown:!1,addAnnotationModalShown:!1,cancelAnnotationModalShown:!1,showAttention:!1,rewardModalShown:!1,showTranslateBtn:!1}),(0,a._)((0,r._)(e),"isColumnPage",function(){var t=e.props.routes;return"Column"===t[t.length-1].name}),(0,a._)((0,r._)(e),"handleDelete",function(){var t=e.props,n=t.showNotification,r=t.article,o=t.deletePost,i=t.router,a=e.isColumnPage(),c=(0,X.f)(r);o(r.id).then(function(){n("文章已删除"),a?window.location.reload():c&&c.id?i.replace("/".concat(c.id)):location.href="".concat(L.i7,"/people/").concat(r.author.urlToken,"/posts")})}),(0,a._)((0,r._)(e),"handleModalClose",function(){e.setState({deleteModalShown:!1,reportModalShown:!1,addAnnotationModalShown:!1,cancelAnnotationModalShown:!1})}),(0,a._)((0,r._)(e),"handleReportButtonClick",e.props.authRequired(function(t){(0,j.E)(t,1294),e.setState({reportModalShown:!0})},L.q0.report)),(0,a._)((0,r._)(e),"handleResetAnnotation",function(){(0,j.E)(event,1293),e.setState({cancelAnnotationModalShown:!0})}),(0,a._)((0,r._)(e),"handleAddAnnotation",function(t){(0,j.E)(t,1293),e.setState({addAnnotationModalShown:!0})}),(0,a._)((0,r._)(e),"handleMenuClick",function(t,n){var r=n.isAuthor,o=n.isMobile,i=r&&!o;if((0,j.E)(t,i?1283:1292),r){var a=e.props,c=a.getCommercialInfo,s=a.article.id;e.commercialInfoPromise_=c(s).then(function(e){return!!(e.payload&&e.payload.isAudit)},function(){return!1})}}),(0,a._)((0,r._)(e),"showEditAlert",function(){return A.Z.confirm("文章在投放中，如修改会导致广告暂停，再次审核通过后，广告才会开启。确认修改？",{title:"确认修改"})}),(0,a._)((0,r._)(e),"handleEditButtonClick",function(){var t=(0,K.b6)(e.props.article.id);(e.commercialInfoPromise_?e.commercialInfoPromise_:Promise.resolve(!1)).then(function(t){return t?e.showEditAlert():Promise.resolve()}).then(function(){return location.href=t},function(){})}),(0,a._)((0,r._)(e),"renderReportItem",function(){return(0,u.BX)(u.HY,{children:[(0,u.tZ)(C.ZAClick,{zaAction:"Report",zaType:"Button",zaModuleId:"click_report",as:b.sN,onClick:e.handleReportButtonClick,children:"举报"}),(0,u.tZ)(b.R,{})]})}),(0,a._)((0,r._)(e),"renderEnItem",function(){return(0,u.BX)(u.HY,{children:[(0,u.tZ)(C.ZAClick,{zaType:"Button",zaModuleId:"translate_btn",as:b.sN,onClick:e.handleToEnStation.bind((0,r._)(e)),children:"翻译"}),(0,u.tZ)(b.R,{})]})}),(0,a._)((0,r._)(e),"renderReportModal",function(){var t=e.props.article,n=t.type,r=t.id,o=e.state.reportModalShown;return(0,u.tZ)(P.y,{type:n,urlToken:r,isColumnArticle:e.isColumnPage(),shown:o,onClose:e.handleModalClose,zaEnabled:!0})}),(0,a._)((0,r._)(e),"renderAnnotationItem",function(){var t=e.props.article.annotationDetail;return(0,u.tZ)(b.sN,{onClick:t?e.handleResetAnnotation:e.handleAddAnnotation,children:t?"撤销标记":"标记内容"})}),(0,a._)((0,r._)(e),"renderAnnotationModal",function(){var t=e.props,n=t.addAnnotation,r=t.cancelAnnotation,o=t.showNotification,i=t.article.id,a=e.state,c=a.addAnnotationModalShown,s=a.cancelAnnotationModalShown;return(0,u.BX)(u.HY,{children:[(0,u.tZ)(S.Z,{addAnnotation:n,onClose:e.handleModalClose,shown:c,type:W.zs,urlToken:i,showNotification:o}),(0,u.tZ)(I.Z,{cancelAnnotation:r,onClose:e.handleModalClose,shown:s,type:W.zs,urlToken:i,showNotification:o})]})}),(0,a._)((0,r._)(e),"renderDeleteItem",function(){return(0,u.BX)(u.HY,{children:[(0,u.tZ)(b.sN,{onClick:function(){return e.setState({deleteModalShown:!0})},children:"删除"}),(0,u.tZ)(b.R,{})]})}),(0,a._)((0,r._)(e),"renderDeleteModal",function(){var t=e.props.isMobile,n=e.state.deleteModalShown;return(0,u.tZ)(k.Z,{isMobile:t,title:"删除文章",subtitle:"确定删除这篇文章？",shown:n,onCancel:e.handleModalClose,onSubmit:e.handleDelete})}),(0,a._)((0,r._)(e),"renderEditItem",function(){return(0,u.BX)(u.HY,{children:[(0,u.tZ)(b.sN,{onClick:e.handleEditButtonClick,children:"修改文章"}),(0,u.tZ)(b.R,{})]})}),(0,a._)((0,r._)(e),"handleReward",function(t,n){var r=e.props,o=r.article,i=r.rewardInfo;(0,r.updateArticleReward)(o.id,n?t:i.tagline,n),e.setState({rewardModalShown:!1})}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){var e=this;if(this.props.justPublished){if(Z().get("leadCommentSetting"))return;this.forceTimeId=setTimeout(function(){e.realTarget=e.target,e.setState({showAttention:!0})},250),this.animateTimeId=setTimeout(function(){e.setState({showAttention:!1}),Z().set("leadCommentSetting",!0)},3e3)}}},{key:"componentWillUnmount",value:function(){clearTimeout(this.forceTimeId),clearTimeout(this.animateTimeId)}},{key:"handleToEnStation",value:function(){var e=this.props.article.translateEnter;e&&(null==e?void 0:e.enPageUrl)&&window.open(null==e?void 0:e.enPageUrl)}},{key:"render",value:function(){var e=this,t=this.state.showAttention,n=this.props,r=n.article,o=n.rewardInfo,i=n.isMobile,a=n.currentUser,c=n.renderExtraSettings,s=n.showIgnoreOptions,p=r.author,_=r.annotationAction,m=r.commentPermission,g=r.copyrightPermission,T=r.translateEnter,E=(0,B.ny)(r),y=(0,U.Z)(a,p),C=y&&!i,S=!y&&Array.isArray(_)&&(_.indexOf(W.jB.add)>=0||_.indexOf(W.jB.cancel)>=0),I=!y,A=m&&!i&&y,w=o.isRewardable&&y,Z=!(y&&a&&"organization"===a.userType)&&y&&o.canOpenReward,k=(0,u.BX)("div",{children:[(0,u.tZ)(x.ZP,{preset:"plain",icon:C?l.T:d.AZ,label:C?"设置":""}),this.state.rewardModalShown&&(0,u.tZ)(D.Z,{isClose:!Z,submitRewardText:function(t){return e.handleReward(t,Z)},onClose:function(){return e.setState({rewardModalShown:!1})}})]});return(0,u.BX)("div",{className:"Post-ActionMenuButton",ref:function(t){e.target=t},children:[(0,u.tZ)(O.Z,{placement:"top",isOpen:t,target:this.realTarget,isFixed:!0,children:"你可以在这里设置评论权限"}),(0,u.BX)(b.ZP,{arrowed:!A,menuClassName:f()("Post-ActionMenu",{"Post-ActionMenu--withCommentSettings":A}),toggler:k,onClick:function(t){return e.handleMenuClick(t,{isAuthor:y,isMobile:i})},stickHover:!0,reversed:!0,children:[s&&(0,u.tZ)(R.Z,{content:r}),I&&this.renderReportItem(),this.state.showTranslateBtn&&T&&T.hasEn&&T.enPageUrl&&this.renderEnItem(),y&&this.renderEditItem(),y&&!E&&(0,u.BX)(u.HY,{children:[(0,u.tZ)(Q.Z,{current:g,id:r.id,onChange:this.props.updateRepublishPermission}),(0,u.tZ)(b.R,{})]}),A&&(0,u.BX)(u.HY,{children:[(0,u.tZ)(M.rt,{current:m,target:r,onChange:this.props.updateCommentPermission}),(0,u.tZ)(b.R,{})]}),(Z||w)&&(0,u.tZ)(b.sN,{onClick:function(){return e.setState({rewardModalShown:!0})},children:(Z?"开启":"关闭")+"送礼物"}),y&&this.renderDeleteItem(),y&&c&&c(),S&&this.renderAnnotationItem()]}),(0,u.BX)(h.ZP,{children:[I&&this.renderReportModal(),y&&this.renderDeleteModal(),S&&this.renderAnnotationModal(),s&&(0,u.tZ)(N.Z,{type:"article",id:r.id})]})]})}}]),n}(g.Component);(0,a._)(J,"propTypes",{article:m().object.isRequired,addAnnotation:m().func.isRequired,cancelAnnotation:m().func.isRequired,deletePost:m().func.isRequired,showNotification:m().func.isRequired,updateCommentPermission:m().func.isRequired,updateRepublishPermission:m().func.isRequired,updateArticleReward:m().func.isRequired,rewardInfo:m().shape({isRewardable:m().bool,tagline:m().string}),justPublished:m().bool}),(0,a._)(J,"defaultProps",{rewardInfo:{isRewardable:!1,tagline:""}}),t.Z=(0,y.compose)(E.withRouter,(0,F.$)(),G.Z,(0,T.connect)(null,{addAnnotation:H.u,cancelAnnotation:H.e,deletePost:Y.fR,showNotification:z.c0,updateCommentPermission:Y.R_,updateRepublishPermission:q.OO,updateArticleReward:V.i3,getCommercialInfo:Y.g1}))(J)},9896:function(e,t,n){"use strict";n.d(t,{Z:function(){return ee}});var r=n(85879),o=n(1785),i=n(85576),a=n(20857),c=n(22107),s=n(94707),u=n(87320),l=n(86325),d=n(85626),p=n(68354),f=n(83821),h=n(87363),_=n(92258),m=n(14914),g=n(55536),T=n(63638),E=n(69725),y=n(65423),C=n(1733),S=n(25452),I=n(46704),A=n(6226),b=n(24752),w=n(66263),Z=n(16850),x=n(82335),k=n(67927),R=n(26820),N=n(67814),O=n.n(N),P=(0,h.forwardRef)(function(e,t){var n=e.before,o=e.after,i=e.arrowed,a=e.className,c=e.toggler,s=e.onClick,u=e.children,l=e.stickHover,d=e.reversed,p=e.gap;return(0,r.BX)("div",{ref:t,className:O()("Post-ActionMenuButton",a),children:[n,(0,r.tZ)(C.ZP,{arrowed:i,menuClassName:O()("Post-ActionMenu",{"Post-ActionMenu--withCommentSettings":void 0!==p&&p}),toggler:c,onClick:s,stickHover:void 0!==l&&l,reversed:void 0!==d&&d,children:u}),o]})}),D=function(e){(0,l._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,c._)(this,n),e=t.apply(this,arguments),(0,u._)((0,a._)(e),"state",{reportModalShown:!1,addAnnotationModalShown:!1,cancelAnnotationModalShown:!1,showTranslateBtn:!1}),(0,u._)((0,a._)(e),"isColumnPage",function(){var t,n=e.props.routes;return(null==n?void 0:null===(t=n[n.length-1])||void 0===t?void 0:t.name)==="Column"}),(0,u._)((0,a._)(e),"handleModalClose",function(){e.setState({reportModalShown:!1,addAnnotationModalShown:!1,cancelAnnotationModalShown:!1})}),(0,u._)((0,a._)(e),"handleReportButtonClick",e.props.authRequired(function(){e.setState({reportModalShown:!0})},w.q0.report)),(0,u._)((0,a._)(e),"handleResetAnnotation",function(){e.setState({cancelAnnotationModalShown:!0})}),(0,u._)((0,a._)(e),"handleAddAnnotation",function(){e.setState({addAnnotationModalShown:!0})}),(0,u._)((0,a._)(e),"handleMenuClick",function(){}),(0,u._)((0,a._)(e),"renderReportItem",function(){return(0,r.BX)(r.HY,{children:[(0,r.tZ)(T.ZAClick,{zaAction:"Report",zaType:"Button",zaModuleId:"click_report",as:C.sN,onClick:e.handleReportButtonClick,children:"举报"}),(0,r.tZ)(C.R,{})]})}),(0,u._)((0,a._)(e),"renderEnItem",function(){return(0,r.BX)(r.HY,{children:[(0,r.tZ)(T.ZAClick,{zaType:"Button",zaModuleId:"translate_btn",as:C.sN,onClick:e.handleToEnStation.bind((0,a._)(e)),children:"翻译"}),(0,r.tZ)(C.R,{})]})}),(0,u._)((0,a._)(e),"renderReportModal",function(){var t=e.props.article,n=t.type,o=t.id,i=e.state.reportModalShown;return(0,r.tZ)(b.y,{type:n,urlToken:o,isColumnArticle:e.isColumnPage(),shown:i,onClose:e.handleModalClose,zaEnabled:!0})}),(0,u._)((0,a._)(e),"renderAnnotationItem",function(){var t=e.props.article.annotationDetail;return(0,r.tZ)(C.sN,{onClick:t?e.handleResetAnnotation:e.handleAddAnnotation,children:t?"撤销标记":"标记内容"})}),(0,u._)((0,a._)(e),"renderAnnotationModal",function(){var t=e.props,n=t.addAnnotation,o=t.cancelAnnotation,i=t.showNotification,a=t.article.id,c=e.state,s=c.addAnnotationModalShown,u=c.cancelAnnotationModalShown;return(0,r.BX)(r.HY,{children:[(0,r.tZ)(E.Z,{addAnnotation:n,onClose:e.handleModalClose,shown:s,type:R.zs,urlToken:a,showNotification:i}),(0,r.tZ)(y.Z,{cancelAnnotation:o,onClose:e.handleModalClose,shown:u,type:R.zs,urlToken:a,showNotification:i})]})}),e}return(0,s._)(n,[{key:"handleToEnStation",value:function(){var e=this.props.article.translateEnter;e&&(null==e?void 0:e.enPageUrl)&&window.open(e.enPageUrl)}},{key:"render",value:function(){var e=this.props,t=e.article,n=e.showIgnoreOptions,o=t.annotationAction,i=t.translateEnter,a=Array.isArray(o)&&(o.indexOf(R.jB.add)>=0||o.indexOf(R.jB.cancel)>=0);return(0,r.BX)(P,{arrowed:!0,toggler:(0,r.tZ)("div",{children:(0,r.tZ)(S.ZP,{preset:"plain",icon:p.AZ,label:""})}),after:(0,r.BX)(f.ZP,{children:[this.renderReportModal(),a&&this.renderAnnotationModal(),n&&(0,r.tZ)(A.Z,{type:"article",id:t.id})]}),onClick:this.handleMenuClick,stickHover:!0,reversed:!0,children:[n&&(0,r.tZ)(I.Z,{content:t}),this.renderReportItem(),this.state.showTranslateBtn&&i&&i.hasEn&&i.enPageUrl&&this.renderEnItem(),a&&this.renderAnnotationItem()]})}}]),n}(h.Component),L=(0,g.compose)(m.withRouter,(0,Z.$)(),i.Z,(0,_.connect)(null,{addAnnotation:x.u,cancelAnnotation:x.e,showNotification:k.c0}))(D),M=n(6779),B=n(57730),U=n(67516),G=n.n(U),F=n(85703),H=n(80692),z=n(21680),q=n(5469),V=n(68680),W=n(39041),X=n(67036),K=n(11233),j=n(26974),Y=n(44765),Q=n(86538),J=function(e){(0,l._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,c._)(this,n),e=t.apply(this,arguments),(0,u._)((0,a._)(e),"state",{deleteModalShown:!1,showAttention:!1,rewardModalShown:!1}),(0,u._)((0,a._)(e),"targetRef",(0,h.createRef)()),(0,u._)((0,a._)(e),"forceTimeId",void 0),(0,u._)((0,a._)(e),"animateTimeId",void 0),(0,u._)((0,a._)(e),"realTarget",void 0),(0,u._)((0,a._)(e),"commercialInfoPromise_",void 0),(0,u._)((0,a._)(e),"isColumnPage",function(){var t,n=e.props.routes;return(null==n?void 0:null===(t=n[n.length-1])||void 0===t?void 0:t.name)==="Column"}),(0,u._)((0,a._)(e),"handleDelete",function(){var t=e.props,n=t.showNotification,r=t.article,o=t.deletePost,i=t.router,a=e.isColumnPage();o(r.id).then(function(){if(n("文章已删除"),a){window.location.reload();return}var e,t=(0,K.f)(r);if(t&&t.id){i.replace("/".concat(t.id));return}location.href="".concat(w.i7,"/people/").concat(null===(e=r.author)||void 0===e?void 0:e.urlToken,"/posts")})}),(0,u._)((0,a._)(e),"handleModalClose",function(){e.setState({deleteModalShown:!1})}),(0,u._)((0,a._)(e),"handleMenuClick",function(){}),(0,u._)((0,a._)(e),"showEditAlert",function(){return B.Z.confirm("文章在投放中，如修改会导致广告暂停，再次审核通过后，广告才会开启。确认修改？",{title:"确认修改"})}),(0,u._)((0,a._)(e),"handleEditButtonClick",function(){var t=(0,j.b6)(e.props.article.id);(e.commercialInfoPromise_?e.commercialInfoPromise_:Promise.resolve(!1)).then(function(t){return t?e.showEditAlert():Promise.resolve()}).then(function(){return location.href=t},function(){})}),(0,u._)((0,a._)(e),"renderDeleteItem",function(){return(0,r.BX)(r.HY,{children:[(0,r.tZ)(C.sN,{onClick:function(){return e.setState({deleteModalShown:!0})},children:"删除"}),(0,r.tZ)(C.R,{})]})}),(0,u._)((0,a._)(e),"renderDeleteModal",function(){var t=e.props.isMobile,n=e.state.deleteModalShown;return(0,r.tZ)(F.Z,{isMobile:t,title:"删除文章",subtitle:"确定删除这篇文章？",shown:n,onCancel:e.handleModalClose,onSubmit:e.handleDelete})}),(0,u._)((0,a._)(e),"renderEditItem",function(){return(0,r.BX)(r.HY,{children:[(0,r.tZ)(C.sN,{onClick:e.handleEditButtonClick,children:"修改文章"}),(0,r.tZ)(C.R,{})]})}),(0,u._)((0,a._)(e),"handleReward",function(t,n){var r=e.props,o=r.article,i=r.rewardInfo;(0,r.updateArticleReward)(o.id,n?t:(null==i?void 0:i.tagline)||"",n),e.setState({rewardModalShown:!1})}),e}return(0,s._)(n,[{key:"componentDidMount",value:function(){var e=this;if(this.props.justPublished){if(G().get("leadCommentSetting"))return;this.forceTimeId=setTimeout(function(){e.realTarget=e.targetRef.current,e.setState({showAttention:!0})},250),this.animateTimeId=setTimeout(function(){e.setState({showAttention:!1}),G().set("leadCommentSetting",!0)},3e3)}var t=this.props,n=t.getCommercialInfo,r=t.article.id;this.commercialInfoPromise_=n(r).then(function(e){return!!(e.payload&&e.payload.isAudit)},function(){return!1})}},{key:"componentWillUnmount",value:function(){this.forceTimeId&&clearTimeout(this.forceTimeId),this.animateTimeId&&clearTimeout(this.animateTimeId)}},{key:"render",value:function(){var e=this,t=this.state,n=t.showAttention,o=t.rewardModalShown,i=this.props,a=i.article,c=i.rewardInfo,s=i.isMobile,u=i.currentUser,l=i.renderExtraSettings,d=a.commentPermission,p=a.copyrightPermission,h=(0,V.ny)(a),_=!!(d&&!s),m=null==c?void 0:c.isRewardable,g=!!((null==u?void 0:u.userType)!=="organization"&&(null==c?void 0:c.canOpenReward)),T=(0,r.BX)("div",{children:[(0,r.tZ)(S.ZP,{preset:"plain",icon:M.T,label:"设置"}),o&&(0,r.tZ)(z.Z,{isClose:!g,submitRewardText:function(t){return e.handleReward(t,g)},onClose:function(){return e.setState({rewardModalShown:!1})}})]});return(0,r.BX)(P,{ref:this.targetRef,before:(0,r.tZ)(H.Z,{placement:"top",isOpen:n,target:this.realTarget,isFixed:!0,children:"你可以在这里设置评论权限"}),after:(0,r.BX)(f.ZP,{children:[l&&l(),this.renderDeleteModal()]}),gap:_,arrowed:!_,toggler:T,onClick:this.handleMenuClick,stickHover:!0,reversed:!0,children:[this.renderEditItem(),!h&&(0,r.BX)(r.HY,{children:[(0,r.tZ)(Q.Z,{current:p,id:a.id,onChange:this.props.updateRepublishPermission}),(0,r.tZ)(C.R,{})]}),_&&(0,r.BX)(r.HY,{children:[(0,r.tZ)(q.rt,{current:d,target:a,onChange:this.props.updateCommentPermission}),(0,r.tZ)(C.R,{})]}),(g||m)&&(0,r.tZ)(C.sN,{onClick:function(){return e.setState({rewardModalShown:!0})},children:(g?"开启":"关闭")+"送礼物"}),this.renderDeleteItem()]})}}]),n}(h.Component);(0,u._)(J,"defaultProps",{rewardInfo:{isRewardable:!1,tagline:"",canOpenReward:!1}});var $=(0,g.compose)(m.withRouter,(0,Z.$)(),i.Z,(0,_.connect)(null,{deletePost:Y.fR,showNotification:k.c0,updateCommentPermission:Y.R_,updateRepublishPermission:W.OO,updateArticleReward:X.i3,getCommercialInfo:Y.g1}))(J),ee=(0,i.Z)(function(e){var t=e.article,n=e.rewardInfo,i=e.justPublished,a=e.currentUser,c=e.renderExtraSettings,s=e.showIgnoreOptions,u=t.author;return(0,o.Z)(a,u)?(0,r.tZ)($,{article:t,rewardInfo:n,justPublished:i,renderExtraSettings:c}):(0,r.tZ)(L,{article:t,showIgnoreOptions:s})})},86538:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(85879),o=n(69383),i=n(71981),a={need_review:"转载申请需要审核",public:"允许所有人转载到专栏",reserved:"不允许他人转载到专栏"};function c(e){var t=e.current,n=e.id,c=e.onChange,s=function(e){e!==t&&(o.Z.trackEvent(null,{id:8939,action:"Click",element:"Button"},{button:{text:a[e]}}),c(n,e))};return(0,r.tZ)(r.HY,{children:Object.keys(a).map(function(e){return(0,r.tZ)(i.Z,{onClick:function(){return s(e)},checked:e===t,children:a[e]},e)})})}},52846:function(e,t,n){"use strict";n.d(t,{Z:function(){return eu}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(57477),l=n(85626),d=n(85879),p=n(81037),f=n(15021),h=n(80565),_=n(70413),m=n(53910),g=n(51695),T=n(14168),E=n.n(T),y=n(87363),C=n(92258),S=n(87641),I=n(55536),A=n(63638),b=n(21060),w=n(82644),Z=n(67516),x=n.n(Z),k=n(25452),R="AdblockBanner::dismiss",N=function(e){(0,c._)(s,e);var t=(0,l._)(s);function s(){var e;return(0,o._)(this,s),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{shown:!1}),(0,a._)((0,r._)(e),"handleClose",function(){x().set(R,!0),e.setState({shown:!1})}),e}return(0,i._)(s,[{key:"componentDidMount",value:function(){var e,t;!0!==x().get(R)&&!(n.g.navigator&&/Mobile/.test(navigator.userAgent))&&((e=document.createElement("div")).className="adsbox",document.body.appendChild(e),t="none"===getComputedStyle(e).display,document.body.removeChild(e),t)&&this.setState({shown:!0})}},{key:"render",value:function(){return this.state.shown&&(0,d.BX)("div",{className:"AdblockBanner",children:[(0,d.BX)("div",{className:"AdblockBanner-inner",children:["我们检测到你可能使用了 AdBlock 或 Adblock Plus，它的部分策略可能会影响到正常功能的使用（如关注）。",(0,d.tZ)("br",{}),"你可以设定特殊规则或将知乎加入白名单，以便我们更好地提供服务。 （",(0,d.tZ)("a",{href:"//www.zhihu.com/question/54919485",target:"_blank",rel:"noreferrer",children:"为什么？"}),"）"]}),(0,d.tZ)(k.ZP,{preset:"plain",className:"AdblockBanner-close",onClick:this.handleClose,icon:w.HN})]})}}]),s}(y.Component),O=n(71728),P=n(67814),D=n.n(P),L=n(69383),M=n(93653),B=n(80714),U=n(25734),G=function(e){var t=e.color,n=e.onClick,r=e.className,o=(0,O._)(e,["color","onClick","className"]),i=(0,U.ZP)().themeTransition;return(0,d.tZ)("a",(0,u._)((0,s._)({className:D()("AppHeader-zhihuLogo",r),href:"//".concat(B.Z.wwwHost),"aria-label":"知乎",onClick:function(e){n&&n(e),L.Z.trackEvent(e.target,{action:"OpenUrl",id:2730},{button:{text:"知乎"}})}},o),{children:(0,d.tZ)(M.Z,{color:void 0===t?"primary":t,css:(0,s._)({},i("fill"))})}))},F=n(94382),H=n(26609),z=n(16028),q=n(32854),V=n(51921),W=n(59523),X=n(96717),K=n(72111),j=n(68354),Y=n(1733),Q=n(66263),J=n(50953),$=n(36374),ee=n(36591),et=function(e){var t=e.href,n=(0,O._)(e,["href"]);return(0,d.tZ)(K._o,{zaText:!0,children:(0,d.tZ)(Y.sN,(0,s._)({zaText:!0,tag:"a",href:(0,ee.Z)(t,"https://zhuanlan.zhihu.com")},n))})},en=function(){var e=(0,J.Z)(["urlToken","id"]),t=(0,$.Z)(),n=(0,d.tZ)(A.ZAClick,{as:k.ZP,zaText:"更多",zaType:"Button",zaAction:"Unknown",className:"ColumnPageHeader-MenuToggler",preset:"plain",title:"更多",children:(0,d.tZ)(j.AZ,{})});return(0,d.BX)(Y.ZP,{menuClassName:"ColumnPageHeader-Menu",positionStatus:"fixed",toggler:n,children:[(0,d.tZ)(et,{href:"//".concat(B.Z.wwwHost,"/").concat(t?"organization":"creator","/manage/creation/article"),children:"我的文章"}),(0,d.tZ)(et,{href:"//".concat(B.Z.wwwHost,"/people/").concat((null==e?void 0:e.urlToken)||(null==e?void 0:e.id),"/columns"),children:"我的专栏"}),(0,d.tZ)(et,{href:Q.vg,children:"专栏 \xb7 发现"})]})},er=n(1612),eo=n(82677).Z,ei=function(e){var t=function(t){var n=e.editable,r=e.onClose;return n&&"function"==typeof n.handleKeyCommand?(r&&r(),n.handleKeyCommand(t)||"not-handled"):"not-handled"};return(0,d.tZ)(A.ZAShow,{as:"div",css:{padding:"4px",borderRadius:"8px"},zaType:"Block",zaBlock:"EditorInsertAction_Editor",zaModuleId:"editor_insert_action",children:er.CF.map(function(e){return(0,d.tZ)(eo,{icon:e.icon,label:e.label,desc:e.desc,onClick:function(){return t(e.commandName||"")}},e.label)})})},ea="column",ec="article",es=function(e){(0,c._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{isMoreMenuOpen:!1}),(0,a._)((0,r._)(e),"moreMenuButtonRef",(0,y.createRef)()),(0,a._)((0,r._)(e),"handleWriteButtonClick",function(e){Promise.resolve((0,X.E)(e,1280)).then(function(){window.open("https://zhuanlan.zhihu.com/write","_blank")})}),(0,a._)((0,r._)(e),"handleMoreMenuOpen",function(){e.setState({isMoreMenuOpen:!0})}),(0,a._)((0,r._)(e),"handleMoreMenuClose",function(){e.setState({isMoreMenuOpen:!1})}),(0,a._)((0,r._)(e),"customPosition",function(e){return{arrowStyle:{left:0,top:0},targetContainerStyle:{left:e.left,top:e.bottom},placement:"bottom"}}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.isLogin,n=e.currentUser,r=e.getColumnContributions;t&&n&&n.urlToken&&r()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isLogin,r=t.currentUser,o=t.getColumnContributions;n&&(e.currentUser&&!e.currentUser.urlToken||!e.currentUser)&&r&&r.urlToken&&o()}},{key:"renderArticleTitle",value:function(){var e=this.props,t=e.articleTitle;return e.isNewStyle?(0,d.tZ)(S.xv,{color:"MapText02A",fontWeight:400,fontSize:"15px",pl:"20px",mr:"30px",css:(0,u._)((0,s._)({},(0,h.S)(1)),{wordWrap:"break-word",wordBreak:"break-all"}),children:t}):null}},{key:"renderTitleMeta",value:function(){var e=this.props,t=e.title,n=e.titleMeta,r=e.preset,o=e.column,i=e.isPaidColumn,a=e.isNewStyle,c=e.editable;if(t||o){var u=t||(0,d.tZ)(d.HY,{children:(0,d.BX)("div",{className:"ColumnPageHeader-TitleName",children:[(0,d.tZ)("span",{className:"ColumnPageHeader-TitleMeta",children:n||(r===ec?"首发于":i?"付费专栏":"专栏")}),(0,d.tZ)(F.Z,{column:o,noHoverCard:!0,className:"ColumnPageHeader-TitleColumn",hidePaidLabel:!0})]})});return(0,d.BX)(d.HY,{children:[(0,d.tZ)("i",{className:"ColumnPageHeader-Line"}),(0,d.BX)("div",{className:"ColumnPageHeader-Title",css:!!a&&{justifyContent:"flex-start",width:223,flex:"0 0 auto"},children:[u,c&&(0,d.BX)(d.HY,{children:[(0,d.tZ)(p.ZP,{ref:this.moreMenuButtonRef,preset:"plain",css:{height:"20px"},onClick:this.handleMoreMenuOpen,children:(0,d.tZ)(_.Z,{color:"var(--MapText06A)",size:20})}),(0,d.tZ)(f.Z,{focusScope:!0,globalClose:!0,isOpen:this.state.isMoreMenuOpen,target:this.moreMenuButtonRef.current,arrowed:!1,onOpen:this.handleMoreMenuOpen,onClose:this.handleMoreMenuClose,toggleEvent:"click",fixed:!0,customPosition:this.customPosition,children:(0,d.tZ)(ei,{editable:(0,s._)({},c),onClose:this.handleMoreMenuClose})})]})]})]})}return null}},{key:"renderButtons",value:function(){var e=this.props,t=e.renderNavbarFunctionality,n=e.isNewStyle;return t?t():n?(0,d.tZ)(z.Z,{toggler:(0,d.tZ)(k.ZP,{className:"SearchBar-askDropdownButton",preset:"primary",color:"blue",css:function(e){return{color:e.colors.MapText99B,borderRadius:"100%",width:34,height:34,display:"flex",alignItems:"center",justifyContent:"center",marginLeft:"auto"}},children:(0,d.tZ)(m.ZP,{css:{flex:"0 0 auto"},size:16})})}):(0,d.BX)(A.ZAClick,{as:k.ZP,zaType:"Button",zaText:!0,className:"ColumnPageHeader-WriteButton",color:"blue",onClick:this.handleWriteButtonClick,children:[(0,d.tZ)(g.yc,{}),"写文章"]})}},{key:"render",value:function(){var e=this,t=this.props,n=t.isLogin,r=t.showAdblockBanner,o=t.currentUser,i=t.sticky,a=t.hideHeaderMenu,c=t.isNewStyle,s=function(t){return(0,d.tZ)("div",{className:"ColumnPageHeader",css:[t&&{padding:"0 var(--app-padding)",boxShadow:"none",boxSizing:"border-box"},!!(c&&!t)&&{width:"auto",maxWidth:1138,minWidth:1e3,paddingLeft:16,paddingRight:46,margin:"0 auto",boxShadow:"none"}],children:(0,d.BX)("div",{className:"ColumnPageHeader-content",css:!!c&&{width:"auto",padding:0,justifyContent:"space-between"},children:[(0,d.BX)(S.kC,{alignItems:"center",children:[!t&&(0,d.tZ)(G,{css:{marginRight:"20px"}}),e.renderArticleTitle(),!c&&(0,d.BX)(d.HY,{children:[(0,d.tZ)("span",{css:{marginLeft:"auto"}}),e.renderTitleMeta()]})]}),(0,d.BX)(S.kC,{alignItems:"center",minWidth:296,ml:"auto",children:[c&&(0,d.tZ)(d.HY,{children:e.renderTitleMeta()}),(0,d.BX)("div",{className:"ColumnPageHeader-Button",css:!!c&&{flexShrink:0},children:[n&&!a&&(0,d.tZ)(en,{}),!o&&(0,d.tZ)(q.Z,{}),e.renderButtons()]}),!t&&(0,d.tZ)("div",{className:"ColumnPageHeader-profile",css:!!c&&{flex:"0 0 auto"},children:(0,d.tZ)(H.Z,{currentUser:o,enableGuidesForLogin:!0})})]})]})})};return(0,d.tZ)(A.ZAEnv,{block:"ColumnPageHeader",children:(0,d.BX)("div",{className:"ColumnPageHeader-Wrapper",children:[r&&(0,d.tZ)(N,{}),void 0===i||i?(0,d.tZ)(b.Z,{children:s(!0)}):s(!1)]})})}}]),n}(y.Component);(0,a._)(es,"PRESETS",{COLUMN:ea,ARTICLE:ec}),(0,a._)(es,"propTypes",{column:E().object,preset:E().oneOf([ea,ec]).isRequired,isLogin:E().bool.isRequired,showAdblockBanner:E().bool,title:E().oneOfType([E().element,E().string]),titleMeta:E().oneOfType([E().element,E().string]),renderNavbarFunctionality:E().func,editable:E().object}),(0,a._)(es,"defaultProps",{preset:ec});var eu=(0,I.compose)((0,C.connect)(function(e,t){var n=t.columnId;return{currentUser:(0,W.ib)(e),column:e.entities.columns[n],isLogin:""!==e.currentUser}},{getColumnContributions:V.Pq}))(es)},26820:function(e,t,n){"use strict";n.d(t,{Ij:function(){return i},M$:function(){return l},PY:function(){return a},YP:function(){return u},g$:function(){return p},j:function(){return s},jB:function(){return r},lg:function(){return c},ln:function(){return d},zs:function(){return o}});var r={add:"annotation",cancel:"annotation_cancel",view:"show_annotation_detail"},o=2,i=300,a=178,c=5,s=4,u=[340792848,350203097,350203137,350203161,350203194,350203244,360980862,360980655,360979559,360979454,360979327,360979218,360979086,360978949,360978717,360978426,376742720,376747534,376747608,376747691,376747887,377838652,377838776,377839115,377839161,377839236,377839329,377839762,377839827,377839991,377840112,377906867,377907004,377907128,377907233,377907323,377907486,377907592,377907807,377907929,377908171,377908294,377908397,377908510,377908600,377908691,377908791,377908856,377908946,377908990,377909025],l={all:"全部",answer:"回答",article:"文章",pin:"想法",zvideo:"视频"},d=[{key:"answer",name:l.answer},{key:"article",name:l.article},{key:"zvideo",name:l.zvideo}],p=[{key:"all",name:l.all},{key:"answer",name:l.answer},{key:"article",name:l.article},{key:"pin",name:l.pin},{key:"zvideo",name:l.zvideo}]},11233:function(e,t,n){"use strict";function r(e){if(!e||!Array.isArray(e.contributions))return null;var t=e.contributions.find(function(e){return"accepted"===e.state});return t?t.column:null}n.d(t,{f:function(){return r}})},79742:function(e,t,n){"use strict";n.d(t,{r:function(){return c},y:function(){return s}});var r=n(49899);n(30722);var o=function(e){return Object.keys(e).map(function(t){return{property:"og:".concat(t),content:e[t]}})},i=n(93547),a=n(26974),c=function(e){var t=e.imageUrl,n=e.title,a=e.url,c=e.excerpt,s=e.topics,u=(0,i.NJ)(c),l=[{name:"description",content:u}].concat((0,r._)(o({title:n,url:a,description:u,image:t,type:"article",site_name:"知乎专栏"})));if(s){var d=s.map(function(e){return e.name}).join(",");d&&l.unshift({name:"keywords",content:d})}return l},s=function(e){var t=e.title,n=e.excerpt,i=e.intro,c=e.id,s=e.imageUrl;return[{name:"description",content:i}].concat((0,r._)(o({title:t,url:"https:".concat((0,a.M9)(c)),description:n,image:s,site_name:"知乎专栏"})))}},23593:function(e,t,n){"use strict";n.d(t,{F:function(){return i},J:function(){return a}});var r=n(82452),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"?utm_medium=column&utm_content=".concat(e)},i=function(e,t){(0,r.rH)("zhihu://articles/".concat(e).concat(o(t)))},a=function(e,t){(0,r.rH)("zhihu://columns/".concat(e).concat(o(t)))}},26974:function(e,t,n){"use strict";n.d(t,{M9:function(){return a},b6:function(){return i},x$:function(){return o}});var r=n(66263),o=function(e){return"".concat(r.vg,"/p/").concat(e)},i=function(e){return"".concat(r.vg,"/p/").concat(e,"/edit")},a=function(e){return"".concat(r.i7,"/column/").concat(e)}},96717:function(e,t,n){"use strict";n.d(t,{E:function(){return a}});var r=n(55164),o=n(69383),i={1283:{id:1283,name:"设置"},1292:{id:1292,name:"MoreAction"},1293:{id:1293,name:"标记按钮"},1294:{id:1294,name:"举报"},1281:{id:1281,name:"底部bar评论"},1298:{id:1298,name:"赞赏"},1279:{id:1279,name:"关注专栏"},1280:{id:1280,name:"写文章",action:"OpenUrl"},1288:{id:1288,name:"关注专栏"},1282:{id:1288,action:"Collect"},1295:{id:1295,name:"话题",action:"OpenUrl"},1296:{id:1296,action:"OpenUrl",element:"Image"},1297:{id:1297,action:"OpenUrl",element_name:"MoreAction"},8928:{id:8928,action:"Click",element:"Text"}},a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a="number"==typeof t?i[t]:t;"object"==typeof a&&o.Z.trackEvent(e&&e.currentTarget,(0,r._)({action:"Click"},a),n)}},42657:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(42559),o=n.n(r);function i(e,t){var n=e.trackUrl,r=void 0===n?[]:n,i=e.id;if(0===r.length)return null;var a="other";t.Android?a="android":t.iOS&&(a="ios");var c=o()();return r.forEach(function(e){new Image().src=e.replace("__OS__",a).replace("__ADPLATFORM__",a).replace("__REQUESTID__",c).replace("__SESSIONID__",c).replace("__ATOKEN__",i).replace("__PAGETYPE__","article")}),{os:a,pageId:i,sessionId:c,pageType:"article"}}},96200:function(e,t,n){"use strict";n.d(t,{Z:function(){return G}});var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(65733),s=n(87363),u=n(87641),l=n(67814),d=n.n(l),p=n(66252),f=n.n(p),h=n(57266),_=n.n(h),m=n(63638),g=n(12564),T={active:function(e){return{background:e.colors.GBK10A,svg:{fill:e.colors.GBL01A},".togglerIcon":{borderLeftColor:e.colors.GBL01A},color:e.colors.GBL01A}},hover:function(e){return{background:e.colors.GBK10A,svg:{fill:e.colors.GBL01A},".togglerIcon":{borderLeftColor:e.colors.GBL01A},color:e.colors.GBL01A}},isCommandActive:function(e){return{background:"oklch(from ".concat(e.colors.MapBrand," l c h / 0.1)"),svg:{fill:e.colors.GBL01A},".togglerIcon":{borderLeftColor:e.colors.GBL01A},color:e.colors.GBL01A}}},E=(0,s.forwardRef)(function(e,t){var n=e.icon,i=e.className,c=e.label,s=e.shortcut,u=e.isActive,l=e.text,d=e.onClick,p=e.disabled,f=e.menuItemText,h=c&&c!==l&&c!==f||s;return(0,a.tZ)(m.ZAClick,(0,o._)((0,r._)({as:g.ZP,zaType:"Button",zaText:c,ref:t,preset:g.EE.Plain,className:i,disabled:p,css:function(e){return{"&.Button.Button--plain":(0,o._)((0,r._)({fontWeight:e.fontWeights.bold,color:e.colors.MapText03A,display:"flex",alignItems:"center",borderRadius:2},u&&T.isCommandActive(e)),{"&:hover":T.hover(e),"&:active":T.active(e)}),padding:2,height:24,"&:not(:disabled):hover":{backgroundColor:"oklch(from ".concat(e.colors.MapBrand," l c h / 0.1)")},"&:not(:first-of-type)":{marginLeft:12}}},"aria-label":c,"data-tooltip-position":"bottom","data-tooltip-will-hide-on-click":!0},h&&{"data-tooltip":c+(s?" ".concat("undefined"!=typeof navigator&&/Mac/i.test(navigator.userAgent)?s.replace(/\+/g,""):s.replace("⌘","Ctrl").replace("⌥","Alt").replace("⇧","Shift")):"")}),{onClick:d,children:(0,a.tZ)(n,{css:function(e){return{color:e.colors.MapText03A,width:20,height:20}},center:!0})}))}),y=function(e){var t=e.childItems,n=e.isMenuToggler,o=(0,i._)(e,["childItems","isMenuToggler"]);return n?1!==t.length?null:(0,a.tZ)(E,(0,r._)({},o,t[0])):(0,a.tZ)(E,(0,r._)({},e))},C=n(87320),S=n(49899),I=n(6153),A=n.n(I),b=n(32651),w=n.n(b),Z={TEXT_STYLE:"text_style",LIST:"list",BASIC_MEDIA:"basic_media"},x=function(e){var t=Object.values(Z).reduce(function(e,t){return(0,o._)((0,r._)({},e),(0,C._)({},t,[]))},{}),n=[],i=[],a=!0,c=!1,s=void 0;try{for(var u,l=e[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var d=u.value.toolbarV2;if(A()(d)||Array.isArray(d)){var p=A()(d)?[d]:d,f=!0,h=!1,_=void 0;try{for(var m,g=p[Symbol.iterator]();!(f=(m=g.next()).done);f=!0){var T=m.value;T.parentName?i.push(T):n.push(T)}}catch(e){h=!0,_=e}finally{try{f||null==g.return||g.return()}finally{if(h)throw _}}}}}catch(e){c=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(c)throw s}}var E=!0,y=!1,I=void 0;try{for(var b,x=(0,S._)(n).concat((0,S._)(i))[Symbol.iterator]();!(E=(b=x.next()).done);E=!0)!function(){var e=b.value,n=e.section,r=e.parentName,o=t[n];if(o){if(r){var i,a,c=o.find(function(e){return e.name===r});if(!c)return;c.childItems||(c.childItems=[]),c.childItems.includes(e)||(c.childItems.push(e),c.childItems=w()(c.childItems,function(e){return null!==(a=e.priority)&&void 0!==a?a:1/0}))}else o.push(e),o=w()(o,function(e){return null!==(i=e.priority)&&void 0!==i?i:1/0})}t[n]=o}()}catch(e){y=!0,I=e}finally{try{E||null==x.return||x.return()}finally{if(y)throw I}}return t},k=function(e){var t=e.children;return(null==t?void 0:t.length)===0?null:(0,a.tZ)(u.kC,{alignItems:"center",children:t})},R=function(e,t){var n,a=t.currentBlockType,c=t.currentStyle,s=t.onCommand,u=t.disableMap,l=t.editorState,d=e.label,p=e.text,h=e.icon,m=e.toolType,g=e.onClick,T=e.commandName,E=e.shouldActive,y=e.isMenuToggler,C=e.childItems,S=e.shouldDisabled,I=(0,i._)(e,["label","text","icon","toolType","onClick","commandName","shouldActive","isMenuToggler","childItems","shouldDisabled"]),A=null==E?void 0:E({currentStyle:c,currentBlockType:a}),b=d,w=h,Z=!1,x=p,k=C;if(y&&k.length>=1){var N=C.find(function(e){var t=e.shouldActive;return null==t?void 0:t({currentStyle:c,currentBlockType:a})});N?(b=N.label,x=N.text,w=N.icon,Z=!1,A=!0):Z=!0,k=C.map(function(e){return R(e,{currentBlockType:a,currentStyle:c,disableMap:u,onCommand:s,editorState:l})})}return _()((0,o._)((0,r._)({key:b},I),{onClick:function(e){null==g||g(e),T&&s(T)},isActive:A,disabled:null!==(n=null==S?void 0:S({editorState:l}))&&void 0!==n?n:u[m],label:b,text:x,showTogglerIcon:Z,isMenuToggler:y,childItems:k,icon:w}),function(e){return!f()(e)})},N=function(e,t){var n={inlineStyle:!1,blockType:!1,entity:!1,clearFormat:!1};return"atomic"===t&&(n.inlineStyle=!0,n.blockType=!0,n.entity=!0,n.clearFormat=!0),"code-block"===t&&(n.inlineStyle=!0,n.entity=!0),n},O=[Z.TEXT_STYLE,Z.LIST,Z.BASIC_MEDIA],P=function(e){var t=e.lineInfo,n=e.separator,o=e.toolbarInfo,i=e.onCommand,c=e.disableMap,s=e.currentStyle,l=e.currentBlockType,d=e.editorState;return(0,a.tZ)(u.kC,{css:function(e){return{fontSize:13,padding:12,backgroundColor:e.colors.MapUIFrame10A}},children:t.map(function(e,t){var p=o[e],f="text_style"===e?p.slice(0,1):"basic_media"===e?p.slice(0,2):p;return 0===f.length?null:(0,a.tZ)(a.HY,{children:(0,a.BX)(k,{children:[t>0&&f.length>0&&n,(0,a.tZ)(u.kC,{alignItems:"center",children:f.filter(function(e){var t=e.shouldShow;return(void 0===t?function(){return!0}:t)({editorState:d})}).map(function(e){var t=R(e,{onCommand:i,disableMap:c,currentStyle:s,currentBlockType:l,editorState:d}),n=t.label;return(0,a.tZ)(y,(0,r._)({},t),n)})})]},e)})})})};function D(e){var t=e.plugins,n=e.currentStyle,o=e.currentBlockType,i=e.style,c=e.className,s=e.editorState,u=N(n,o),l=x(t);return(0,a.tZ)(m.ZAEnv,{block:"Toolbar",children:(0,a.tZ)("div",{className:d()("Editable-toolbar",c),style:i,css:{position:"absolute",top:0,left:0,right:0,zIndex:1},onMouseDown:function(e){return e.preventDefault()},children:(0,a.tZ)(P,(0,r._)({editorState:s,lineInfo:O,toolbarInfo:l,disableMap:u,separator:(0,a.tZ)("span",{css:function(e){return{background:e.colors.GBK09B,height:"20px",margin:"0 12px",width:"1px"}}})},e))})})}var L=n(17103),M=n(37341),B=(0,n(23071).$)(M.default,{flushPolicy:"destroy"});function U(e){var t=e.defaultValue,n=e.setContent,o=e.onRef,c=e.maxHeight,u=e.minHeight,l=(0,i._)(e,["defaultValue","setContent","onRef","maxHeight","minHeight"]),d=(0,s.useRef)(),p=(0,L.q)(o,d);return null===t?null:(0,a.tZ)(B,(0,r._)({css:function(e){return{position:"unset",border:"0 none",minHeight:u||270,maxHeight:c||600,overflowY:"scroll",fontSize:14,color:e.colors.MapText03A,".Editable-content":{padding:12}}},defaultValue:t,placeholder:"",onChange:function(e){n(e.toHTML({source:"RichIntroEditor_onChange"}))},ref:p,getMarkdownEnabled:function(){return!1},allowMention:!1,allowHeaderThree:!1,allowToolbar:!0,useEditableV2:!0,acceptImageTypes:["image/jpeg","image/png","image/jpg"],autoFocus:!1},l))}var G=function(e){var t=e.label,n=e.defaultValue,l=e.setContent,d=e.placeholder,p=e.onImageUpload,f=e.uploadImageError,h=e.minHeight,_=e.maxHeight,m=(0,i._)(e,["label","defaultValue","setContent","placeholder","onImageUpload","uploadImageError","minHeight","maxHeight"]),g=(0,s.useRef)(null),T=(0,c.A)(function(e){return g.current?g.current.handleKeyCommand(e):"not-handled"});return(0,a.BX)(u.xu,(0,o._)((0,r._)({},m),{children:[t&&(0,a.tZ)(u.xv,{fontSize:"15px",fontWeight:"bold",mb:2,children:t}),(0,a.tZ)(u.xu,{css:function(e){return{border:"1px solid ".concat(e.colors.MapUIFrame09A),borderRadius:"3px",position:"relative",paddingTop:50,transition:"all 0.3s ease","&:hover":{borderColor:e.colors.MapBrand},"&:focus-within":{borderColor:e.colors.MapBrand,boxShadow:"0 0 0 2px rgba(24, 144, 255, 0.2)"}}},children:(0,a.tZ)(U,{onRef:g,defaultValue:void 0===n?"":n,setContent:l,onImageUpload:p,uploadImageError:f,placeholder:d,minHeight:h,maxHeight:_,customToolbar:D,handleKeyCommand:T})})]}))}},66913:function(e,t,n){"use strict";n.d(t,{$L:function(){return l},Au:function(){return c},G3:function(){return p},Kr:function(){return g},Md:function(){return u},Ub:function(){return s},Zs:function(){return T},_F:function(){return h},aM:function(){return y},ej:function(){return m},iw:function(){return _},pL:function(){return f},q6:function(){return d},sA:function(){return a},yD:function(){return E}});var r,o,i=n(87320),a="title",c="intro",s="avatar",u="price",l="expected_update_count",d="update_frequency",p="content_price",f="pay_type_config",h=(r={},(0,i._)(r,a,""),(0,i._)(r,c,""),(0,i._)(r,s,void 0),(0,i._)(r,u,""),(0,i._)(r,l,""),(0,i._)(r,d,"daily"),(0,i._)(r,p,""),r),_=[a,c,s,u,l,d,p],m={INITIAL_WITH_AVATAR:0,BEFORE:1,UPLOADING:2,SUCCESS:3,ERROR:4},g=(o={},(0,i._)(o,m.INITIAL_WITH_AVATAR,"点击更换封面"),(0,i._)(o,m.BEFORE,"上传一张专栏封面图"),(0,i._)(o,m.UPLOADING,"上传中..."),(0,i._)(o,m.SUCCESS,"上传完成，点击更换封面"),(0,i._)(o,m.ERROR,"上传失败，请重新上传"),o),T=[{label:"每天",value:"daily"},{label:"每周",value:"weekly"},{label:"每月",value:"monthly"}],E="24px",y="40px"},55542:function(e,t,n){"use strict";n.d(t,{e:function(){return c},s:function(){return a}});var r=n(66263),o=n(81374),i=n(66294);function a(e,t,n){var r=e.id,i=e.width,a=e.height,c=e.url,s=e.watermark,u=e.watermarkSrc,l=e.originalSrc;return{url:(0,o.K)(c,t,n),id:r,rawWidth:i,rawHeight:a,watermark:s,watermarkSrc:u,originalSrc:(0,o.K)(l,t,n)}}function c(e){if("object"==typeof e)return e.message;switch(e){case"type":return"格式不支持，请上传以下格式的图片：".concat(i.x7.join(", "));case"size":return"请上传不超过 ".concat(r.i3,"M 的图片");case"dimension":return"GIF 图片的长或宽低于 ".concat(i.ON,"px，无法上传");case"other":return"图片上传未完成，请稍后发布"}}},66294:function(e,t,n){"use strict";n.d(t,{Ij:function(){return i},ON:function(){return o},x7:function(){return r}});var r=[".jpg",".jpeg",".png",".gif"],o=120,i=1e3},1612:function(e,t,n){"use strict";n.d(t,{sP:function(){return Y},vr:function(){return j},v$:function(){return W},vi:function(){return X},CF:function(){return K}});var r=n(55164),o=n(85879),i=n(2347),a=n(16427),c=n(28124),s=n(25405),u=n(40933),l=n(28545),d=n(83688),p=n(26030),f=n(55041),h=n(11690),_=n(59280),m=n(47866),g=n(21706),T=n(29126),E=n(15881),y=n(2325),C=n(93975),S=n(93406),I=n(7629),A=n(80874),b=n(48936),w=n(65389),Z=n(76319),x=n(68354),k=n(75056),R=n(66744),N=n(89237),O=n(17985),P=n(56868),D=n(33773),L=n(14465),M=n(82604),B=n(11360),U=n(94009),G=n(8586),F=n(87363),H=n(87641),z=n(63638),q=n(25452),V=function(e){var t=e.getMarkdownEnabled,n=e.label,r=e.icon,i=e.text,a=e.onClick,c=(0,U._)((0,F.useState)(t()),2),s=c[0],u=c[1],l=function(){a(),u(!s)};return(0,o.BX)(z.ZAClick,{as:q.ZP,zaType:"Button",zaText:"".concat(n," ").concat(s?"关":"开"),preset:q.EE.Plain,"aria-label":n,css:function(e){return{"&.Button.Button--plain":{padding:"12px 20px",display:"flex",alignItems:"center",color:e.colors.GBK03A,width:"100%",boxSizing:"border-box",whiteSpace:"nowrap",borderRadius:"4px",position:"relative"}}},children:[(0,o.tZ)(H.xu,{onClick:l,css:{position:"absolute",left:0,top:0,width:"100%",height:"100%",zIndex:1}}),(0,o.tZ)(r,{center:!0,css:{marginRight:"4px"}}),null!=i?i:n,(0,o.tZ)(G.Z,{forceControlled:!0,checked:s,preset:"small",css:{marginLeft:37},onChange:l,onClick:function(e){return e.preventDefault()}})]})},W=function(e){var t=e.showProfit,n=e.onInsertVideoClick,o=e.isVideoAnswer,x=e.shouldAdaptNative,k=e.hasPhotoLibraryToolbarTooltip,R=e.setHasPhotoLibraryToolbarTooltip;return[{sectionName:"operation",minLength:3,priority:1,items:[{icon:i.O1,priority:2,label:"撤销",commandName:"undo",shortcut:"⌘+Z"},{icon:a.OJ,label:"重做",priority:1,commandName:"redo",shortcut:"⌘+Y"},{icon:c.Z,label:"清除格式",priority:3,commandName:"clear-format",shortcut:"⌘+\\"}]},{sectionName:"style",minLength:4,priority:2,items:[(0,r._)({icon:s.ZP,label:"标题",priority:1},x?{commandName:"toggle-block-type-header-two",shortcut:"⌘+⌥+1"}:{children:[{icon:u.ic,label:"一级标题",commandName:"toggle-block-type-header-two",shortcut:"⌘+⌥+1"},{icon:l.NC,label:"二级标题",commandName:"toggle-block-type-header-three",shortcut:"⌘+⌥+2"}]}),{icon:d.Z,label:"加粗",commandName:"toggle-inline-style-BOLD",priority:2,shortcut:"⌘+B"},!x&&{icon:p.ZP,label:"斜体",commandName:"toggle-inline-style-ITALIC",priority:3,shortcut:"⌘+I"}]},{sectionName:"blockType",minLength:6,priority:4,items:[{icon:f.Z,label:"列表",priority:1,children:[{icon:h.hS,label:"有序列表",commandName:"toggle-block-type-ordered-list-item",shortcut:"⌘+⇧+L"},{icon:_.bd,label:"无序列表",commandName:"toggle-block-type-unordered-list-item",shortcut:"⌘+L"}]},{Component:M.Z,icon:m.ZP,label:"目录",commandName:"toggle-catalog",shortcut:"⌘+⌥+J",priority:2},{icon:g.R7,label:"引用",commandName:"toggle-block-type-blockquote",shortcut:"⌘+⇧+U",priority:3},{icon:T.Z,label:"分割线",commandName:"insert-divider",shortcut:"⌘+⌥+S",priority:4},{icon:E.Z,label:"代码块",commandName:"toggle-block-type-code-block",shortcut:"⌘+⌥+C",priority:5},{icon:y.Z,label:"注释",commandName:"insert-reference",shortcut:"⌘+⌥+K",priority:6}]},{sectionName:"advanced",minLength:2,priority:3,items:[{Component:B.Z,icon:C.Z,label:"图片",commandName:"insert-image-from-library",priority:7,featureBubbleText:k?"支持上传手机相册的图片了":null,onClick:function(){R(!1)}},!o&&{label:"视频",icon:S.Z,priority:6,onClick:function(){null==n||n()}},{label:"链接",icon:I.ZP,commandName:"insert-link",priority:5,shortcut:"⌘+K"},t&&!o&&{label:"收益",icon:A.gI,commandName:"toggle-user-profit-modal",priority:4},{label:"公式",icon:b.Z,commandName:"insert-formula",priority:3,shortcut:"⌘+⌥+E"},!o&&{label:"表格",icon:w.Z,commandName:"insert-table",priority:2,shortcut:"⌘+⌥+T"},{label:"附件",icon:Z.Z,commandName:"insert-file-from-baidu-wangpan",priority:1}].filter(Boolean)}]},X=function(e){var t=e.getMarkdownEnabled,n=e.onHandleManageEditClick;return[{sectionName:"moreArea",minLength:2,priority:2,items:[{label:"更多",icon:x.B2,children:[{label:"帮助文档",icon:k.Ov,commandName:"toggle-help-document",hideMenuOnClick:!0},{label:"默认设置",icon:R.ZP,onClick:function(){return n()},hideMenuOnClick:!0},{Component:function(e){return(0,o.tZ)(V,(0,r._)({getMarkdownEnabled:t},e))},label:"Markdown 语法输入",icon:N.Z,commandName:"toggle-markdown-enabled"}]}]}]},K=[{icon:O.Z,label:"导入文档",desc:"MD/Doc",commandName:"insert-doc",zaModuleId:"editor_insert_doc",zaBlock:"EditorInsertDoc_Editor"},{icon:I.ZP,label:"导入链接",desc:"公众号",commandName:"insert-link-doc",zaModuleId:"editor_insert_link",zaBlock:"EditorInsertLink_Editor"}],j=function(){return[{sectionName:"fixArea",minLength:2,priority:2,items:[{label:"导入",icon:P.Z,children:K},{label:"草稿备份",icon:D.ZP,commandName:"toggle-draft-history-modal"}]}]},Y=function(){return[{sectionName:"aiAssistant",minLength:3,priority:1,items:[{icon:L.Z,priority:2,label:"创作助手",commandName:"ai-assistant"}]}]}},61436:function(e,t,n){"use strict";n.d(t,{Ue:function(){return f},o8:function(){return d},xR:function(){return p},zS:function(){return l}});var r=n(49899),o=n(84054),i=n.n(o),a=n(55536),c=n(4661),s=n(44765),u=(0,c.FH)("article",["ADD_CONTRIBUTE_REQUEST","DELETE_CONTRIBUTE_REQUEST","GET_CONTRIBUTE_REQUEST","HANDLE_CONTRIBUTE_REQUEST","GET_RECOMMENDED_CONTRIBUTE_COLUMNS"]),l=function(e,t){return{API:{types:u.ADD_CONTRIBUTE_REQUEST,endpoint:"/articles/".concat(e,"/contribute_requests"),method:"POST",fetchOptions:{credentials:"include"},body:{column_id:t}},columnId:t}};function d(e){return{API:{types:u.GET_CONTRIBUTE_REQUEST,endpoint:"/articles/".concat(e,"/contribute_requests"),method:"GET"}}}function p(e,t,n){return{API:{types:u.HANDLE_CONTRIBUTE_REQUEST,endpoint:"/articles/".concat(e,"/contribute/requests/").concat(t),method:"PUT",body:{accept:n}},id:t,NOTIFICATION:{success:n?"已通过投稿审核":"已忽略投稿审核"}}}var f=function(e){return{API:{types:u.GET_RECOMMENDED_CONTRIBUTE_COLUMNS,endpoint:"/articles/".concat(e,"/recommendation-contribute-columns"),fetchOptions:{credentials:"include"},query:{include:i()({data:{recommendations:[{column:{articles_count:!0,followers:!0}}]}})}}}};t.ZP=(0,a.combineReducers)({contributeRequests:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===u.GET_CONTRIBUTE_REQUEST.success?t.payload.data:e},deleteContributeIdList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===u.DELETE_CONTRIBUTE_REQUEST.success?(0,r._)(e).concat([t.id]):e},handledContributeIdList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===u.HANDLE_CONTRIBUTE_REQUEST.success?(0,r._)(e).concat([t.id]):e},recommendedColumns:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===u.GET_RECOMMENDED_CONTRIBUTE_COLUMNS.success?t.payload.data.recommendations:e},pinnedColumns:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===u.GET_RECOMMENDED_CONTRIBUTE_COLUMNS.success?t.payload.data.pinColumns:e},sentContributeRequestsIdList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(t.type===s.Hp.GET.success){var n=t.payload.contributions,o=(void 0===n?[]:n).map(function(e){return e.column.id});return(0,r._)(e).concat((0,r._)(o))}return u.ADD_CONTRIBUTE_REQUEST.success?(0,r._)(e).concat([t.columnId]):u.DELETE_CONTRIBUTE_REQUEST.success?e.filter(function(e){return e===t.columnId}):e}})},97712:function(e,t,n){"use strict";n.d(t,{Oe:function(){return d},R5:function(){return p},ZP:function(){return h}});var r=n(55164),o=n(57477),i=n(49899),a=n(80714),c=n(4661),s=(0,r._)({},(0,c.FH)("articleDrafts",["GET_DRAFTS","DELETE_DRAFT"])),u=s.GET_DRAFTS,l=s.DELETE_DRAFT;function d(){return function(e,t){var n=t().articleDrafts.items;return e({API:{types:u,endpoint:"articles/my_drafts",root:a.Z.fetchRoot.zhuanlan,query:{limit:10,offset:n.length,include:"$.data[*].schedule"}}})}}function p(e){return function(t){return t({meta:{id:e},API:{types:l,endpoint:"articles/".concat(e,"/draft"),root:a.Z.fetchRoot.zhuanlan,method:"DELETE",fetchOptions:{zsAutoSignature:!1}}})}}var f={isDrained:!1,isLoading:!1,items:[]};function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0,n=t.meta,a=t.type,c=t.payload;return a===u.request?(0,o._)((0,r._)({},e),{isLoading:!0}):a===u.success?(0,o._)((0,r._)({},e),{isDrained:c.paging.isEnd,isLoading:!1,items:(0,i._)(e.items).concat((0,i._)(c.data))}):a===l.success?(0,o._)((0,r._)({},e),{items:e.items.filter(function(e){return e.id!==n.id})}):e}},91777:function(e,t,n){"use strict";n.d(t,{H:function(){return i}});var r=n(87320),o=(0,n(4661).FH)("brand",["GET_URL"]),i=function(e){return{API:{types:o.GET_URL,endpoint:"/brand/track",method:"GET",fetchOptions:{credentials:"include",failsafe:!0,timeout:100},query:{target_url:"https://zhuanlan.zhihu.com/p/".concat(e)}},FAILSAFE:!0,UPDATE:{success:function(t){return{articles:(0,r._)({},e,{trackUrl:t.data||[]})}}}}}},83213:function(e,t,n){"use strict";n.d(t,{ZP:function(){return P},wD:function(){return S},IG:function(){return x},mB:function(){return Z},$I:function(){return I},nK:function(){return k},G1:function(){return N},XS:function(){return w},Ae:function(){return R},Fz:function(){return O},TP:function(){return b},Gw:function(){return A}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(75472),s=n.n(c),u=n(28953),l=n(84054),d=n.n(l),p=n(80714),f=n(65744),h=n(4661),_=n(89250),m=n(44765),g=n(84),T=n(74135),E=new g.fK.Union({answer:u.l.ANSWER,article:u.l.ARTICLE,pin:u.l.PIN,zvideo:u.l.ZVIDEO},function(e){var t=e.type;return(0,T.camelize)(t)}),y=new g.fK.Array(E),C=(0,h.FH)("column",["GET","UPDATE","REMOVE","GET_PINNED_ARTICLE","SET_PINNED_ARTICLE","GET_PINNED_ITEMS","TOGGLE_PINNED_ITEM","TOGGLE_SET_CONTENT_FREE","REMOVE_COLUMN_COLLECT","UNCOLLECT_ITEM","GET_ARTICLES","GET_ITEMS","REFRESH_ITEMS","REMOVE_COLUMN_ARTICLE","SET_COAUTHOR","GET_COAUTHORS","CHANGE_COAUTHOR_ROLE","REMOVE_COAUTHOR","UNSUBSCRIBE","POST_COLUMN_HAS_READ"]);d()({data:[{admin_closed_comment:!0,comment_count:!0,suggest_edit:!0,is_title_image_full_screen:!0,can_comment:!0,upvoted_followees:!0,can_open_tipjar:!0,can_tip:!0,voteup_count:!0,voting:!0,topics:!0,review_info:!0,author:{is_following:!0,is_labeled:!0,label_info:!0}}]});var S=function(e){return function(t){return t({API:{root:p.Z.fetchRoot.zhuanlan,types:C.GET,endpoint:"/columns/".concat(e),method:"GET",fetchOptions:{credentials:"include"}},schema:u.l.COLUMN})}},I=function(e){return function(t){return t({API:{types:C.GET,endpoint:"/columns/v2/".concat(e),method:"GET",fetchOptions:{credentials:"include"}},meta:{entitiesPrefilter:function(t){var n=t.columns[e];return n.realId=n.id,n.id=n.urlToken,t}},schema:u.l.COLUMN_V2,UPDATE:{success:function(e){return{users:(0,r._)({},e.author.urlToken,e.author)}}}})}},A=function(e,t){return function(n){return n({API:{root:p.Z.fetchRoot.zhuanlan,types:C.UPDATE,endpoint:"/columns/".concat(e),method:"PATCH",body:t},schema:u.l.COLUMN})}},b=function(e){return function(t){return t({API:{root:p.Z.fetchRoot.zhuanlan,types:C.UNSUBSCRIBE,endpoint:"/columns/".concat(e,"/followers"),method:"DELETE"}})}},w=function(e){return function(t){return t({API:{types:C.REMOVE,endpoint:"/columns/v3/".concat(e),method:"DELETE"},NOTIFICATION:{success:function(e){return(0,f.t)((null==e?void 0:e.message)||"专栏删除成功")},failure:function(e){(0,f.t)((null==e?void 0:e.message)||"专栏删除失败",{theme:"red"})}}})}},Z=function(e){return function(t){return t({columnId:e,API:{types:C.GET_PINNED_ITEMS,endpoint:"/columns/".concat(e,"/pinned-items/v2"),fetchOptions:{credentials:"include"}},schema:y})}},x=function(e,t){return function(n,r){var a=r(),c=(a.column[e]||a.entities.columns[e]||{}).paging,s=c?{endpoint:c.next}:{endpoint:"/columns/".concat(e,"/items"),query:(0,i._)((0,o._)({},t&&{offset:t}),{ws_qiangzhisafe:"0"})};return n({id:e,API:(0,o._)({types:C.GET_ITEMS},s),schema:y})}},k=function(e){return{API:{types:C.POST_COLUMN_HAS_READ,endpoint:"/column/feed/".concat(e,"/read"),method:"POST"},FAILSAFE:!0}},R=function(e){var t=e.columnId,n=e.contentType,r=e.contentId;return{columnId:t,contentType:n,contentId:r,API:{endpoint:"/columns/".concat(t,"/items"),types:C.REMOVE_COLUMN_COLLECT,method:"DELETE",body:{type:n,id:r}}}},N=function(e,t){return{id:e,API:(0,o._)({types:C.REFRESH_ITEMS,endpoint:"/columns/".concat(e,"/items")},t&&{offset:t}),schema:y}},O=function(e){var t=e.columnId,n=e.contentId,r=e.contentType,o=e.toPin;return{columnId:t,contentId:n,contentType:r,toPin:o,API:{types:C.TOGGLE_PINNED_ITEM,endpoint:"/columns/".concat(t,"/pinned-items"),method:o?"POST":"DELETE",body:{type:r,id:n}}}};function P(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C.GET_PINNED_ARTICLE.success:var n=e[t.columnId]||{};return(0,i._)((0,o._)({},e),(0,r._)({},t.columnId,(0,i._)((0,o._)({},n),{pinnedArticle:t.payload.id})));case C.SET_PINNED_ARTICLE.success:var c=e[t.columnId]||{};return(0,i._)((0,o._)({},e),(0,r._)({},t.columnId,(0,i._)((0,o._)({},c),{pinnedArticle:t.articleId})));case C.GET_ARTICLES.request:case C.REFRESH_ITEMS.request:case C.GET_ITEMS.request:var u=e[t.id]||{};return(0,i._)((0,o._)({},e),(0,r._)({},t.id,(0,i._)((0,o._)({},u),{isLoading:!0})));case C.GET_ARTICLES.success:var l=e[t.id]||{},d=t.payload,p=d.data,f=d.paging,h=l.articles||[];return(0,i._)((0,o._)({},e),(0,r._)({},t.id,(0,i._)((0,o._)({},l),{articlesPaging:f,articles:(0,a._)(h).concat((0,a._)(p.map(function(e){return e.id}))),isLoading:!1})));case C.GET_ARTICLES.failure:case C.GET_ITEMS.failure:var g=e[t.id]||{};return(0,i._)((0,o._)({},e),(0,r._)({},t.id,(0,i._)((0,o._)({},g),{isLoading:!1})));case C.GET_PINNED_ITEMS.success:var T=e[t.columnId]||{};return(0,i._)((0,o._)({},e),(0,r._)({},t.columnId,(0,i._)((0,o._)({},T),{pinnedItems:t.result})));case C.GET_ITEMS.success:var E=e[t.id]||{},y=t.payload,S=y.paging,I=y.needForceLogin,A=t.result,b=E.items||[];return(0,i._)((0,o._)({},e),(0,r._)({},t.id,(0,i._)((0,o._)({},E),{paging:S,needForceLogin:I,items:(0,a._)(b).concat((0,a._)(A)),isLoading:!1})));case C.REFRESH_ITEMS.success:var w=e[t.id]||{},Z=t.payload.paging,x=t.result;return(0,i._)((0,o._)({},e),(0,r._)({},t.id,(0,i._)((0,o._)({},w),{paging:Z,items:x,isLoading:!1})));case C.TOGGLE_PINNED_ITEM.success:var k=e[t.columnId]||{},R=t.columnId,N=t.contentType,O=t.contentId,P=t.toPin,D={schema:N,id:O};return(0,i._)((0,o._)({},e),(0,r._)({},R,(0,o._)({},k,P?{pinnedItems:[D].concat((0,a._)(k.pinnedItems)),items:k.items.filter(function(e){return!s()(e,D)})}:{pinnedItems:k.pinnedItems.filter(function(e){return!s()(e,D)}),items:[D].concat((0,a._)(k.items))})));case C.REMOVE_COLUMN_COLLECT.success:var L=e[t.columnId]||{},M=t.columnId,B={schema:t.contentType,id:t.contentId};return(0,i._)((0,o._)({},e),(0,r._)({},M,(0,o._)({},L,{pinnedItems:L.pinnedItems.filter(function(e){return!s()(e,B)}),items:L.items.filter(function(e){return!s()(e,B)})})));case C.REMOVE_COLUMN_ARTICLE.success:case m.Hp.DELETE.success:var U=t.columnId,G=t.articleId,F=e[U]||{},H=F.articles||[];return(0,i._)((0,o._)({},e),(0,r._)({},U,(0,i._)((0,o._)({},F),{pinnedArticle:F.pinnedArticle===G?null:F.pinnedArticle,articles:H.filter(function(e){return e!==G})})));case _.VA.LOAD_ARTICLE_RELATION_ENDORSEMENT.success:var z=t.meta,q=t.payload;return(0,i._)((0,o._)({},e),{relationEndorsement:(0,r._)({},z.id,q)});default:return e}}},24316:function(e,t,n){"use strict";n.d(t,{NG:function(){return u},ZP:function(){return l},dj:function(){return c},q0:function(){return s}});var r=n(87320),o=n(55164),i=n(57477),a=(0,n(4661).FH)("columnCollection",["TOGGLE_COLUMN_COLLECT"]),c=function(e,t){return e.columnCollection[t]},s=function(e){var t=e.type,n=e.id;return"".concat(t).concat(n)},u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(r,i){var u,l=s(t),d=null===(u=c(i(),e))||void 0===u?void 0:u[l];return r((0,o._)({meta:{columnId:e,contentKey:l,optimisticCollected:!d},API:{endpoint:"/columns/".concat(e,"/items"),types:a.TOGGLE_COLUMN_COLLECT,method:d?"DELETE":"POST",body:t}},!1===n&&{NOTIFICATION:!1}))}};function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.TOGGLE_COLUMN_COLLECT.request:case a.TOGGLE_COLUMN_COLLECT.failure:var n=t.meta,c=n.columnId,s=n.contentKey,u=n.optimisticCollected,l=e[c]||{},d=t.type===a.TOGGLE_COLUMN_COLLECT.request?u:!u;return(0,i._)((0,o._)({},e),(0,r._)({},c,(0,i._)((0,o._)({},l),(0,r._)({},s,d))));default:return e}}},35677:function(e,t,n){"use strict";n.d(t,{Qm:function(){return f},Ss:function(){return h},Ug:function(){return p},ZP:function(){return _},gV:function(){return d},uM:function(){return l}});var r=n(87320),o=n(55164),i=n(57477),a=n(80714),c=n(65744),s=n(4661),u=(0,o._)({},(0,s.FH)("paidColumn",["CREATE","UPDATE","GET_CREATED_RIGHTS","GET_EDIT_DETAIL"]),(0,s.co)("paidColumn",["CLEAR_EDIT_DETAIL"])),l=function(e){return function(t){return t({API:{root:a.Z.fetchRoot.www,types:u.CREATE,endpoint:"/api/v4/paid_columns/request",method:"POST",body:e},NOTIFICATION:{failure:function(e){return(0,c.t)((null==e?void 0:e.message)||"专栏创建失败",{theme:"red"}),!1}}})}},d=function(e,t){return function(n){return n({API:{root:a.Z.fetchRoot.zhuanlan,types:u.CREATE,endpoint:"/columns/".concat(e),method:"PATCH",body:t},NOTIFICATION:{success:"专栏修改成功",failure:function(e){return(0,c.t)((null==e?void 0:e.message)||"专栏修改失败",{theme:"red"}),!1}}})}},p=function(){return{API:{root:a.Z.fetchRoot.www,types:u.GET_CREATED_RIGHTS,endpoint:"/api/v4/column/paid-column/creator",method:"GET"}}},f=function(e){return{API:{types:u.GET_EDIT_DETAIL,endpoint:"/column/paid-column/detail/".concat(e),method:"GET"},id:e}},h=function(e){return{type:u.CLEAR_EDIT_DETAIL,id:e}};function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{entities:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.GET_CREATED_RIGHTS.success:return(0,i._)((0,o._)({},e),{createRights:t.payload});case u.GET_EDIT_DETAIL.success:return(0,i._)((0,o._)({},e),{entities:(0,i._)((0,o._)({},e.entities),(0,r._)({},t.id,t.payload.data))});case u.CLEAR_EDIT_DETAIL:return(0,i._)((0,o._)({},e),{entities:(0,i._)((0,o._)({},e.entities),(0,r._)({},t.id,void 0))});default:return e}}},44765:function(e,t,n){"use strict";n.d(t,{Hp:function(){return h},Qo:function(){return y},R_:function(){return T},fR:function(){return g},g1:function(){return E},vM:function(){return _},xl:function(){return m}});var r=n(87320),o=n(55164),i=n(57477),a=n(94009),c=n(74135),s=n(28953),u=n(84054),l=n.n(u),d=n(74351),p=n(80714),f=n(4785),h=(0,n(4661).FH)("article",["GET","DELETE","UPDATE_COMMENT_PERMISSION","GET_COMMERCIAL_INFO","TOGGLE_LIKE","LOAD_MARKET_ARTICLE_PAID_CONTENT","LOAD_POST_SEARCH_ENTITY"]),_=function(e){return function(t){return t({API:{endpoint:"v3/entity_word",query:{type:"article",token:e},types:h.LOAD_POST_SEARCH_ENTITY},FAILSAFE:!0,UPDATE:{success:function(t){return{articles:(0,r._)({},e,{entityWords:(null==t?void 0:t.searchWords)||[]})}},failure:function(t){return(0,d.isBrowser)()?window.Raven.captureException(t,{logger:"searchEntityError",extra:{id:e,type:"article"}}):(null==t?void 0:t.name)!=="FetchError"&&console.error("searchEntityError",t,{id:e,type:"article"}),{}}}})}},m=function(e,t){var n=t.zhiPlusFlag;return function(t){var c=(0,a._)(/^\d+/.exec(String(e))||["0"],1)[0];if("0"===c){var u=Error();throw u.status=404,u}if(String(e)!==c){var l=Error();throw l.status=302,l.redirect="/p/".concat(c),l}return t({API:{root:p.Z.fetchRoot.zhuanlan,types:h.GET,endpoint:"/articles/".concat(c),method:"GET",fetchOptions:{credentials:"include",ssrPassThroughHeaders:["x-bdzh-t"]},query:(0,i._)((0,o._)({},n&&{zhiPlusFlag:decodeURIComponent(n)}),{ws_qiangzhisafe:"0"})},UPDATE:{success:function(e){var t=e.author,n=e.contributions,o={};return(void 0===n?[]:n).forEach(function(e){var t=e.column;o[t.id]=t}),{users:t.urlToken?(0,r._)({},t.urlToken,t):{},columns:o}}},schema:s.l.ARTICLE})}},g=function(e,t){return{articleId:e,columnId:t,API:{types:h.DELETE,endpoint:"/articles/".concat(e),method:"DELETE",fetchOptions:{credentials:"include"}},schema:s.l.ARTICLE}};function T(e,t){return function(n,o){var i=o().entities.articles[e];return n({API:{types:h.UPDATE_COMMENT_PERMISSION,endpoint:"/articles/".concat(e,"/comment_permission"),method:"PUT",body:(0,f.z)((0,c.decamelizeKeys)({commentPermission:t}))},UPDATE:{request:{articles:(0,r._)({},e,{commentPermission:t})},failure:{articles:(0,r._)({},e,i)}}})}}var E=function(e){return function(t){return t({API:{root:p.Z.fetchRoot.zhuanlan,types:h.GET_COMMERCIAL_INFO,endpoint:"/articles/".concat(e,"/commercial"),method:"GET",fetchOptions:{credentials:"include"}},UPDATE:{success:function(t){return{articles:(0,r._)({},e,{commercialInfo:t.data||{}})}}}})}};function y(e){return{API:{endpoint:"/kmqa/articles/".concat(e,"/paid_content"),query:{include:l()({media_card:!0,btn_info:!0,goods_card:!0,za_info:!0,video_extra:!0})},types:h.LOAD_MARKET_ARTICLE_PAID_CONTENT},FAILSAFE:!0,UPDATE:{success:function(t){return{articles:(0,r._)({},e,{paidContent:t})}}}}}},45870:function(e,t,n){"use strict";n.d(t,{Cl:function(){return A},_u:function(){return C},dn:function(){return S},e2:function(){return I},fM:function(){return b}});var r=n(55164),o=n(57477),i=n(85879),a=n(82452),c=n(13649),s=n(65733),u=n(84871),l=n.n(u),d=n(87363),p=n(92258),f=n(63638),h=n(57138),_=n(89774),m=n(95167),g=n(7407),T=n(88257),E=(0,d.createContext)({oiaWithTrack:w,openDeepLink:w}),y=function(e){var t=e.children,n=e.isAnswerPage,u=e.callbackSource,l=(0,d.useRef)(null),p=(0,f.useGetPageInfoRef)(),m={},g=(0,_.Z)(),y=(0,c.n)(),C=(0,s.A)(function(e){var t,n,i,c=e.type,s=e.id,d=e.from,f=e.target,_=e.options,T=e.zaProps,E=void 0===T?{}:T,y=E.zaV3Text,C=E.configMaps,S=(0,h.MN)(f||{type:c,id:s},(0,o._)((0,r._)({},_),{callback_source:u,page_id:(null===(t=p.current)||void 0===t?void 0:null===(n=t.value)||void 0===n?void 0:n.pageId)||"null",ab_group:Object.keys(m).map(function(e){return"".concat(e,"__").concat(m[e])}).join(".")}));null===(i=l.current)||void 0===i||i.trackEvent({eventType:"Click",action:"OpenUrl",elementLocation:(0,r._)({type:"Button",moduleId:"reback_poplayer_btn"},y&&{text:y})},{configMap:(0,r._)({callback_from:d},C),link:{url:S}}),g&&Z()&&alert("接下来跳转的 oiaUrl 地址是"+S),(0,a.rH)(S)}),S=(0,s.A)(function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.pathname,o=void 0===r?location.pathname:r;if("undefined"!=typeof window){var i=(null===(e=p.current)||void 0===e?void 0:null===(t=e.value)||void 0===t?void 0:t.pageId)||"null",c=new URLSearchParams({page_id:i,callback_source:u}).toString(),s="zhihu:/".concat((0,h.Qu)(o),"?").concat(c);g&&Z()&&alert("接下来跳转的 deeplinkScheme 地址是"+s),(0,a.Hu)(s).catch(function(e){(0,h.DU)("openDeepLink",e,y)})}}),I=(0,d.useMemo)(function(){return{oiaWithTrack:C,openDeepLink:S}},[C,S]);return(0,i.BX)(E.Provider,{value:I,children:[n&&(0,i.tZ)(T.Z,{pageInfo:{pageId:"11189"}}),(0,i.tZ)(f.ZARef,{ref:l}),t]})},C=function(){return(0,d.useContext)(E).oiaWithTrack},S=(0,d.forwardRef)(function(e,t){var n=C();return(0,d.useImperativeHandle)(t,function(){return{oiaWithTrack:n}}),null}),I=function(){return(0,d.useContext)(E).openDeepLink},A=(0,d.forwardRef)(function(e,t){var n=I();return(0,d.useImperativeHandle)(t,function(){return{openDeepLink:n}},[n]),null}),b=function(e){return function(t){return l()(function(n){var a,c=(0,p.useSelector)(g.cM),s=(0,m.r)(c);return e?(0,i.tZ)(y,{callbackSource:s,isAnswerPage:null===(a=n.params)||void 0===a?void 0:a.answerId,children:(0,i.tZ)(t,(0,o._)((0,r._)({},n),{callbackSource:s}))}):(0,i.tZ)(t,(0,o._)((0,r._)({},n),{callbackSource:s}))},t)}};function w(){}function Z(){return"undefined"!=typeof window&&localStorage.getItem("dbg")}},14236:function(e,t,n){"use strict";n.d(t,{KQ:function(){return h},mz:function(){return _},tL:function(){return f}});var r=n(55164),o=n(94009),i=n(85879),a=n(51770),c=n(7835),s=n(32883),u=n(37234),l=n(87363),d=n(87641),p=(0,u.H)(function(e){return(0,s.X)(function(){return(0,a.dJ)("https://api.zhihu.com/image_viewer/extra",{method:"POST",body:{images:e.join(",")},disableCamelizeKeys:!0}).then(function(e){return e.ai_flag})},{retries:3,delay:500})},{getCacheKey:String}),f=function(e){var t=e.anchor;return(0,i.tZ)(d.kC,{alignItems:"center",justifyContent:"center",color:"MapText99B",css:(0,r._)({position:"absolute",top:12,right:12,fontSize:10,lineHeight:1.4,gap:"2px",padding:"3px 4px",borderRadius:4,background:"rgba(25, 27, 31, 0.20)"},t&&{"@supports (position-anchor: auto)":{positionAnchor:t,top:"calc(anchor(top) + 10px)",right:"calc(anchor(end) + 10px)"}}),children:"该内容由AI生成"})},h=function(e){var t=(0,o._)((0,l.useState)({}),2),n=t[0],r=t[1];return(0,c.b)(function(){p(e).then(r)}),n},_=function(e){var t=e.id,n=e.enabled;return h([t])[t]&&(void 0===n||n)?(0,i.tZ)(f,{}):null}},94681:function(e,t,n){"use strict";n.d(t,{Z:function(){return R}});var r=n(15030),o=n(55164),i=n(57477),a=n(94009),c=n(85879),s=n(29229),u=n(49274),l=n(26649),d=n(87641),p=n(17002),f=n(74351),h=n(80714),_=n(39315),m=n(99281),g=n(87363),T=n(63638),E=function(e){var t=(0,s._)(function(){return Promise.all([n.e(5518),n.e(3775),n.e(9547),n.e(2876)]).then(n.bind(n,63666))});return t?(0,c.tZ)(t,(0,o._)({},e)):null},y=n(71728),C=n(65733),S=n(93563),I=n(82644),A=function(e){var t=e.icon,n=e.zaModuleId,r=e.isDisabled,a=(0,y._)(e,["icon","zaModuleId","isDisabled"]);return t?(0,c.tZ)(T.ZAClick,(0,i._)((0,o._)({zaType:"Button",zaModuleId:n,as:d.kC},a),{children:(0,c.tZ)(t,{size:18,fill:"var(--MapText02A)",style:{opacity:r?.4:1,cursor:r?"not-allowed":"pointer"}})})):null},b=function(e){var t=e.title,n=e.onClose,r=e.sessionId,o=(0,C.A)(function(){window.open("https://zhida.zhihu.com/search/".concat(r),"_blank")});return(0,c.BX)(d.kC,{justifyContent:"space-between",alignItems:"center",px:"20px",pt:"20px",pb:"16px",children:[(0,c.tZ)(A,{icon:S.Z,onClick:o,isDisabled:!r,"aria-label":"新标签页打开","data-tooltip":"新标签页打开","data-tooltip-position":"top",zaModuleId:"panel_enter_zhida_page"}),!!t&&(0,c.tZ)(d.xv,{fontSize:"14px",fontWeight:"500",lineHeight:"20px",color:"var(--MapText02A)",style:{flex:1,textAlign:"center"},children:t}),(0,c.tZ)(A,{icon:I.ZP,onClick:n,"aria-label":"关闭","data-tooltip":"关闭","data-tooltip-position":"top",zaModuleId:"ai_explain_panel_close"})]})},w=function(e){var t,n,r=e.onClose,o=e.query,i=e.zhidaSource,s=e.title,u=e.matchOrder,l=e.contentId,p=e.contentType,f=e.showContentCard,h=e.zdToken,_=e.panelKey,m=e.comp,y=(0,a._)((0,g.useState)(""),2),C=y[0],S=y[1],I=(0,T.useGetPageInfoRef)(),A=null==I?void 0:null===(t=I.current)||void 0===t?void 0:null===(n=t.value)||void 0===n?void 0:n.pageId;return(0,c.tZ)(T.ZAEnv,{content:{type:"article"===p?"Post":"Answer",token:String(l),id:String(l)},extra:{configMap:{open_type:i,zhida_session_id:String(C)}},children:(0,c.BX)(T.ZAShow,{zaType:"Block",zaModuleId:"ai_explain_panel",style:{height:"100%"},children:[(0,c.tZ)(b,{title:void 0===s?"知乎直答":s,onClose:r,sessionId:C}),(0,c.tZ)(d.xu,{style:{height:"calc(100% - 56px)"},children:(0,c.tZ)(E,{Comp:m,derivedProps:{key:_||"".concat(i,"-").concat(o,"-").concat(l,"-").concat(p,"-").concat(u),contentId:l,contentType:p,matchOrder:u,query:o,zhidaSource:i,showContentCard:f,zdToken:h,zaPageId:A,onSessionChange:function(e){S(e)}}})})]})})},Z=n(41471),x=n(91726);(0,f.isBrowser)()&&((0,l.S1)({name:"AIPanelFederation",remotes:[{name:"ModuleFederation",entry:location.origin+"/appview/rn/ModuleFederation.js",alias:"amadeus_rn"}]}),(0,_.I)("proxyUrl",h.Z.proxyUrl));var k=function(e){var t=e.children;return(0,c.tZ)(p.Z,{transitionName:"AIPanel",timeout:0,children:(0,c.tZ)(d.xu,{style:{position:"fixed",bottom:12,right:12,width:445,height:603,background:"var(--GBK99A)",borderRadius:8,boxShadow:"0px 0px 24px 0px rgba(0, 0, 0, 0.08)",zIndex:202},children:t})})},R=function(){var e=(0,a._)((0,m.j1)(Z.J8),1)[0],t=(0,x.K)(),n=(0,s._)(function(){return(0,l.y0)("amadeus_rn/zhidaPanel").catch(function(){return Error()})},t);return e.open&&e.props&&t?(0,r._)(n,Error)?(0,c.BX)(k,{children:[(0,c.tZ)(b,{title:"AI 解释",onClose:Z.k6}),(0,c.tZ)(u.H.EI1,{image:"default",content:"似乎出了点问题"})]}):(0,c.tZ)(k,{children:n?(0,c.tZ)(w,(0,i._)((0,o._)({},e.props),{panelKey:e.key,onClose:Z.k6,comp:n})):(0,c.tZ)(d.kC,{width:"100%",height:"100%",justifyContent:"center",alignItems:"center",children:(0,c.tZ)(d.Ee,{src:"https://picx.zhimg.com/v2-0edce9249d888a1952bc6e97b11b1964.gif",style:{width:16,height:16}})})}):null}},41805:function(e,t,n){"use strict";n.d(t,{QM:function(){return r.Z},Y$:function(){return a}}),n(94681);var r=n(62639),o=n(74351),i=n(41471),a=function(e){if(!(0,o.isBrowser)())return function(){};var t="ai-panel-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9));return(0,i.Y$)(e,t),i.k6}},41471:function(e,t,n){"use strict";n.d(t,{J8:function(){return r},Y$:function(){return o},k6:function(){return i}});var r=(0,n(99281).n2)({open:!1,props:null}),o=function(e,t){r.current={open:!0,props:e,key:t}},i=function(){r.current={open:!1,props:null,key:void 0}}},91726:function(e,t,n){"use strict";n.d(t,{K:function(){return o}});var r=n(92718),o=function(){return"1"===(0,r.Z)("ws_PC_AI_Panel",{mock:"1"})}},75981:function(e,t,n){"use strict";n.d(t,{v:function(){return h}});var r=n(94009),o=n(85879),i=n(81037),a=n(69118),c=n(65733),s=n(91850),u=n(85761),l=n(63638),d=n(85576),p=n(41805),f=n(91726),h=(0,d.Z)(function(e){var t=e.className,n=e.contentId,d=e.contentType,h=e.authRequired,_=(0,f.K)(),m=(0,c.A)(h(function(){(0,p.Y$)({query:"这篇内容讲了什么？",contentId:n,contentType:d,zhidaSource:"one_tap_summary",showContentCard:!0})})),g=(0,r._)((0,s.k)(!1),2),T=g[0],E=g[1];return _?(0,o.tZ)(l.ZAClick,{as:i.ZP,onMouseEnter:E.on,onMouseLeave:E.off,zaText:"AI 一键总结",zaType:"Button",preset:a.EE.Plain,zaModuleId:"bar_ai_summary_button",shouldTrackShow:!0,zaBlock:"AI 总结",onClick:m,className:t,"data-tooltip":"解释这篇内容","data-tooltip-position":"top",color:"grey",icon:T?u.Z:p.QM}):null})},66152:function(e,t){"use strict";var n,r;(r=n||(n={})).Vote="vote",r.Comment="comment",r.Like="like",r.Favlist="favlist",r.Collect="collect",r.Thank="thank",r.Share="share",r.Unknown="unknown",r.AISummary="ai-summary",t.Z=n},87749:function(e,t,n){"use strict";function r(e){return e.componentList.filter(Boolean).filter(function(e){return!!e.component}).map(function(e){return e.component})}n.d(t,{Z:function(){return r}})},20057:function(e,t,n){"use strict";n.d(t,{Z:function(){return c},m:function(){return s}});var r=n(49899),o=n(66152),i=n(87749),a=new Map([[o.Z.Vote,"isBlockingVote"],[o.Z.Comment,"isBlockingComment"],[o.Z.Like,"isBlockingLike"],[o.Z.Favlist,"isBlockingCollect"],[o.Z.Collect,"isBlockingCollect"],[o.Z.Thank,"isBlockingLike"],[o.Z.Share,"isBlockingShare"]]);function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.Z;return function(){for(var n=arguments.length,o=Array(n),i=0;i<n;i++)o[i]=arguments[i];var a=e.length>0?e.reduce(function(e,t){return[t.apply(void 0,(0,r._)(e))]},(0,r._)(o)):(0,r._)(o);return t.apply(void 0,(0,r._)(a))}}var s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return{componentList:t.componentList.map(function(t){var n=t.name,r=t.component,o=a.get(n);return o&&e[o]?{name:n,component:null}:{name:n,component:r}})}}}},79821:function(e,t,n){"use strict";var r=n(49899),o=n(85879),i=n(30037),a=n(23579),c=n(87363),s=n(66152),u=n(20057),l=n(30361),d=function(e){return{componentList:e.componentList.map(function(e,t){var n=e.name,r=e.component;return(0,c.isValidElement)(r)?{name:n,component:(0,c.cloneElement)(r,{key:r.key||n===s.Z.Unknown?n+t:n})}:{name:n,component:r}})}};t.Z=function(e){var t=e.className,n=e.renderChildren,c=e.middlewares,p=e.dangerouslyRenderActionButtons,f=e.children,h=(0,i.qC)().blockStrategies,_=(0,u.Z)([(0,u.m)(h),d].concat((0,r._)(void 0===c?[]:c)),p);return(0,o.BX)(l.eX,{className:t,css:function(e){return{display:"flex",alignItems:"center",padding:"10px 16px",margin:"0 -16px -10px",color:e.colors.GBK04A,background:e.colors.GBK99A,clear:"both","&.is-fixed":{margin:0,boxShadow:"0 -1px 3px ".concat((0,a.a)(e.colors.GBK02A).alpha(.1))},"& > *":{flexShrink:0},"& > .AnnotationTag":{whiteSpace:"nowrap"}}},children:[_({componentList:(null==n?void 0:n(s.Z))||[]}),f]})}},68051:function(e,t,n){"use strict";n.d(t,{d:function(){return h}});var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(65733),s=n(71783),u=n(87363),l=n(63638),d=n(30722),p=n(25452),f=(0,n(85576).Z)(function(e){var t=e.isLiked,n=e.onClick,l=e.showIcon,f=e.authRequired,h=(e.currentUser,e.isLogin,e.label),_=void 0===h?"喜欢":h,m=e.count,g=void 0===m?void 0:m,T=e.newInteract,E=(0,i._)(e,["isLiked","onClick","showIcon","authRequired","currentUser","isLogin","label","count","newInteract"]),y=t?"取消".concat(_):_,C=(0,u.useMemo)(function(){if(!T)return{colorful:!1,labelText:y};var e=g>0,t=e?(0,d.Zh)(g):"",n=e?t:y;return{colorful:e,labelText:n}},[T,g,y]),S=C.colorful,I=C.labelText,A=S&&t,b=(0,c.A)(function(){return f(function(){return n(!t)})()});return(0,a.tZ)(p.ZP,(0,o._)((0,r._)({preset:"plain",onClick:b,icon:void 0===l||l?s.ZP:null,"aria-live":"polite","aria-label":y},E),{label:I,css:{"& .Button-zi":A?{fill:"var(--MapPositiveLike)"}:void 0}}))}),h=function(e){var t=e.isLiked,n=e.onClick,o=e.moduleId,c=(0,i._)(e,["isLiked","onClick","moduleId"]);return(0,a.tZ)(l.ZAClick,(0,r._)({zaType:"Button",zaAction:t?"UnLike":"Like",zaModuleId:o||"content_card_like_unlike_button",onClick:n,isLiked:t,as:f},c))};t.Z=h},8693:function(e,t,n){"use strict";n.d(t,{Uk:function(){return p}});var r=n(55164),o=n(57477),i=n(85879),a=n(84871),c=n.n(a),s=n(87363),u=n(66152),l=n(92718),d=n(16850);function p(e){var t=(0,s.forwardRef)(function(t,n){var a="1"===(0,l.Z)("wm_pc_interact",{mock:"1"}),c=(0,d.Z)();return(0,i.tZ)(e,(0,o._)((0,r._)({},t),{interactMode:!c&&a?"ordered":"default",ref:n}))});return t.displayName="withNewInteract(".concat(e.displayName||e.name||"Component",")"),c()(t,e)}[u.Z.Vote,u.Z.Comment,u.Z.Collect,u.Z.Like,u.Z.Share,"republish","options","annotation","settings","contribute"].map(function(e,t){return[e,t]})},11264:function(e,t,n){"use strict";n.d(t,{_:function(){return E}});var r=n(55164),o=n(57477),i=n(85879),a=n(13649),c=n(65733),s=n(84871),u=n.n(s),l=n(87363),d=n(92258),p=n(76661),f=n(65033),h=n(91269),_=n(22712),m=n(70400),g=n(83821),T=function(e){var t=e.type,n=e.id,r=e.index,o=(0,d.useSelector)(function(e){var r,o;return null===(r=e.adPromotion)||void 0===r?void 0:null===(o=r[t])||void 0===o?void 0:o[n]}),c=(0,f.zc)(),s=(0,a.n)();return(0,l.useEffect)(function(){c&&t&&n&&(0,h.nX)("".concat(t,"-").concat(n,"-").concat(r),c)},[c,t,n,r]),c?(0,i.tZ)(p.Z,{userAgent:s,action:o,data:c}):null},E=function(e){var t=e.dataPath;return function(e){return u()(function(n){var a,s=null!==(a=n[t])&&void 0!==a?a:{},u=s.type,l=s.id,p=(0,d.useDispatch)(),h=(0,f.zc)(),m=(0,c.A)(function(e){h&&u&&l&&p((0,_.Cz)({type:u,id:l,currentAction:e}))}),g=(0,c.A)(function(){return m(_.SE.comments.show)}),T=(0,c.A)(function(){return m(_.SE.comments.close)}),E=(0,c.A)(function(){return m(_.SE.comments.publish)}),y=(0,c.A)(function(e){return m(e?_.SE.follow:_.SE.revertFollow)}),C=(0,c.A)(function(){return m(_.SE.shareClick)});return(0,i.tZ)(e,(0,o._)((0,r._)({},n),{trackOpenCommentAdPromotion:g,trackCloseCommentAdPromotion:T,trackToggleFollowAdPromotion:y,trackShareAdPromotion:C,trackPublishCommentAdPromotion:E}))},e)}};t.Z=function(e){return(0,i.tZ)(m.SV,{replacement:null,children:(0,i.tZ)(g.ZP,{children:(0,i.tZ)(T,(0,r._)({},e))})})}},48864:function(e,t,n){"use strict";n.d(t,{Z:function(){return x}});var r=n(55164),o=n(57477),i=n(94009),a=n(85879),c=n(65733),s=n(82644),u=n(87363),l=n(87641),d=n(63638),p=n(67516),f=n.n(p),h=n(22107),_=n(94707),m=n(86325),g=n(71728),T=n(85626),E=n(67814),y=n.n(E),C=function(e){(0,m._)(n,e);var t=(0,T._)(n);function n(){return(0,h._)(this,n),t.apply(this,arguments)}return(0,_._)(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=(0,g._)(e,["className"]);return(0,a.tZ)("textarea",(0,o._)((0,r._)({},n),{className:y()(t,"TextArea")}))}}]),n}(u.Component),S=n(81956),I=n(17721),A={timer:"showEvaluatePanelTimer",hasShown:"isShowEvaluatePanel"},b=function(e){return(0,a.tZ)(d.ZAClick,(0,o._)((0,r._)({as:"button",zaType:"Button",zaText:"关闭nps",css:{position:"absolute",top:"11px",right:"11px"}},e),{children:(0,a.tZ)(s.HN,{width:"16",height:"16"})}))},w=function(e){return(0,a.tZ)(l.xu,{css:{textAlign:"right"},children:(0,a.tZ)(d.ZAClick,(0,o._)((0,r._)({as:"button",zaType:"Button",zaText:"提交nps",css:function(e){return{color:e.colors.GBL01A,fontSize:"12px"}}},e),{children:"确认提交"}))})},Z=function(e){return(0,a.tZ)(d.ZAClick,(0,r._)({as:"button",zaType:"Button",css:function(e){return{width:"25px",display:"inline-block",textAlign:"center",lineHeight:"25px",background:e.colors.GBK10A,borderRadius:"2px",color:e.colors.GBK06A,marginRight:"2px",cursor:"pointer","&:hover":{background:e.colors.GBK09A}}}},e))};function x(e){var t=e.editorFrom,n=e.storageKey,r=void 0===n?"":n,o=(0,i._)((0,u.useState)(""),2),s=o[0],p=o[1],h=(0,i._)((0,u.useState)("10"),2),_=h[0],m=h[1],g=(0,i._)((0,u.useState)(""),2),T=g[0],E=g[1],y=(0,u.useRef)(),x=(0,I.Z)(),k=(0,S.Z)(),R=(0,c.A)(function(e){k("https://api.zhihu.com/slytherin/fallback/".concat(t),{method:"POST",body:{score:e,content:T}})});return((0,u.useEffect)(function(){var e=new Date().getTime()>f().get(A.timer+r);if(f().get(A.hasShown+r)&&!e){p("");return}p(""),setTimeout(function(){p("0"),f().set(A.hasShown+r,"1"),f().set(A.timer+r,new Date().getTime()+5184e6),y.current=setTimeout(function(){p("")},6e4)},6e5)},[r]),""===s)?null:(0,a.tZ)(d.ZAEnv,{block:"editorEvaluatePanel",children:(0,a.tZ)(d.ZAShow,{zaText:"nps展示",zaType:"Block",children:(0,a.BX)(l.xu,{css:function(e){return{width:"310px",position:"fixed",bottom:"72px",right:"110px",background:e.colors.GBK99A,padding:"20px",boxShadow:"0px 1px 3px rgba(26, 26, 26, 0.1)",zIndex:"101"}},children:[(0,a.tZ)(b,{onClick:function(){p("")}}),"0"===s&&(0,a.BX)(l.xu,{children:[(0,a.tZ)(l.xu,{css:function(e){return{fontSize:"14px",color:e.colors.GBK02A}},children:"亲爱的创作者，感谢您对知乎内容的贡献"}),(0,a.tZ)(l.xu,{css:function(e){return{fontSize:"13px",color:e.colors.GBK06A,marginTop:"10px",marginBottom:"20px"}},children:"请选择您对编辑器的满意度，以帮助我们更好的服务于您的创作体验"}),(0,a.tZ)(l.xu,{className:"evaluate-box",children:[1,2,3,4,5,6,7,8,9,10].map(function(e,t){return(0,a.tZ)(Z,{zaText:"打分-".concat(e),onClick:function(){clearTimeout(y.current),e<=6?p("1"):e>6&&(p(""),x({text:"感谢您的反馈",delay:2e3}),R(e)),m(e)},children:e},t)})}),(0,a.BX)(l.kC,{justifyContent:"space-between",css:function(e){return{color:e.colors.GBK03A,marginTop:"15px",fontSize:"11px",lineHeight:"12px"}},children:[(0,a.tZ)("span",{role:"img","aria-label":"不满意",children:"不满意\uD83D\uDC4E"}),(0,a.tZ)("span",{role:"img","aria-label":"满意",children:"满意\uD83D\uDC4D"})]})]}),"1"===s&&(0,a.BX)(l.xu,{children:[(0,a.tZ)(l.xu,{css:function(e){return{fontSize:"14px",color:e.colors.GBK02A,marginBottom:"10px"}},children:"请写下您的意见或建议"}),(0,a.tZ)(l.xu,{children:(0,a.tZ)(C,{className:"Appeal-TextArea",rows:7,placeholder:"请写下您的建议...",css:{width:"270px",height:"85px"},value:T,onChange:function(e){E(e.target.value)}})}),(0,a.tZ)(l.xu,{css:{textAlign:"right"},children:(0,a.tZ)(w,{onClick:function(){p(""),R(_),x({text:"感谢您的反馈",delay:1e3})}})})]})]})})})}},65233:function(e,t,n){"use strict";var r=n(80714),o=n(6148);t.Z=function(e,t){var n=(0,o.dj)(r.Z.apollo.file_upload_size_limit)||{},i=n.creatorRight||30,a=n.default||30;return(null==e?void 0:e.length)&&e.filter(Boolean).find(function(e){return"8713324000"===String(e.id)&&"pass"===e.status})?{fileSizeLimit:1048576*i,contentToken:t}:{fileSizeLimit:1048576*a,contentToken:t}}},75334:function(e,t,n){"use strict";n.d(t,{j:function(){return h}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(85626),l=n(85879),d=n(87363),p=n(84871),f=n.n(p),h=(0,d.createContext)({updateFormData:function(){},formData:{}});t.Z=function(e){var t=function(t){(0,c._)(d,t);var n=(0,u._)(d);function d(){var e;return(0,o._)(this,d),e=n.apply(this,arguments),(0,a._)((0,r._)(e),"state",{}),(0,a._)((0,r._)(e),"answerFormDataProps",{updateFormData:function(t){return e.setState(t)},getFormData:function(){return e.state}}),e}return(0,i._)(d,[{key:"render",value:function(){return(0,l.tZ)(h.Provider,{value:(0,s._)({},this.answerFormDataProps),children:(0,l.tZ)(e,(0,s._)({},this.props,this.answerFormDataProps))})}}]),d}(d.Component);return f()(t,e)}},64074:function(e,t,n){"use strict";n.d(t,{Z:function(){return _}});var r=n(55164),o=n(57477),i=n(94009),a=n(85879),c=n(92258),s=n(63638),u=n(83770),l=n(97476),d=n(258),p=n(80714),f=n(58909),h=n(7407),_=function(e){var t=(0,c.useSelector)(h.cM),n=t.sogouInput,_=t.oppoSearch,m=t.huaweiSearch,g=(0,c.useSelector)(f.ib),T=(0,s.useTracker)().trackEvent,E=(0,i._)(_?["slogan","highlight"]:["searchBox","default"],2),y=E[0],C=E[1];return!n&&(0,a.tZ)(u.Z,(0,o._)((0,r._)({allowSignUp:p.Z.allowSignUp,currentUser:g,handleAriaClick:l.Gb},e),{searchHeaderPreset:y,oiaButtonPreset:C,showOpenAppButton:!0,handleOpenAppClick:m?function(){return location.href="https://onelink.zhihu.com/onelink?id=711"}:function(){return(0,d.Z)({trackEvent:T,zaV3Text:"顶部打开App按钮",noEnteringSignin:!!g})}}))}},24340:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(87363),s=n(87641),u=function(e){var t=10*e;return(t-t%5)/10};t.Z=(0,c.forwardRef)(function(e,t){var n=e.ratio,c=void 0===n?1:n,l=e.children,d=(0,i._)(e,["ratio","children"]);return(0,a.tZ)(s.xu,(0,o._)((0,r._)({css:{position:"relative",paddingBottom:"".concat(u(1/c*100),"%"),height:"0",borderRadius:"inherit"}},d),{ref:t,children:(0,a.tZ)("div",{css:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",borderRadius:"inherit"},children:l})}))})},37705:function(e,t,n){"use strict";var r=n(55164),o=n(85879),i=n(64099),a=n(87363),c=n(50373),s=n(80714),u=n(23071),l=n(89774),d=n(36374);function p(){return Promise.resolve().then(n.bind(n,37341))}var f=(0,a.forwardRef)(function(e,t){var n=(0,d.Z)(),i=(0,l.Z)();return(0,o.tZ)(c.Z,(0,r._)({ref:t,getComponent:p,newLinkCard:!0,isOrg:n,allowDisplayMath:i||"1"===s.Z.apollo.allowDisplayMath,shouldAdaptNative:"1"===s.Z.apollo.editor_adapt_native,autoRotateImage:"1"===s.Z.apollo.editor_auto_rotate},e))}),h=(0,u.$)(f,{flushPolicy:"destroy"});t.Z=(0,i.$f)(h)},77683:function(e,t,n){"use strict";n.d(t,{Z:function(){return et}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(57477),l=n(85626),d=n(85879),p=n(82452),f=n(80565),h=n(67814),_=n.n(h),m=n(71549),g=n.n(m),T=n(14168),E=n.n(T),y=n(87363),C=n(92258),S=n(14914),I=n(55536),A=n(69383),b=n(63638),w=n(80714),Z=n(66263),x=n(30256),k=n(7407),R=n(57138),N=n(73596),O=n(85661),P=n(78),D=n(94226),L=n(58909),M=n(67516),B=n.n(M),U=n(31142),G=(0,C.connect)(function(e){var t;return{vipInfo:null===(t=(0,L.ib)(e))||void 0===t?void 0:t.vipInfo}})(function(e){var t=e.widget,n=e.className,r=e.vipInfo,o=t.id,i=t.url;return(0,d.tZ)(U.Z,{className:n,onClick:function(){var e;(null==r?void 0:null===(e=r.widget)||void 0===e?void 0:e.id)!=="".concat(o)&&(B().set("widgetId",o),B().set("widgetUrl",i))},preset:"link",a:!0,to:"https://".concat(w.Z.wwwHost,"/settings/stickers"),children:(0,d.tZ)("img",{src:i,style:{width:"100%"},alt:""})})}),F=n(94009),H=n(38151),z=n(53910),q=n(46829),V=n(50953),W=n(84210),X={isFollowing:!1,isFollowed:!1,isBlocking:!1,isBlocked:!1,type:null},K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.isFollowing,n=e.isFollowed,r=e.isBlocking;return"boolean"==typeof t&&"boolean"==typeof n&&"boolean"==typeof r},j=function(e){var t=e.urlToken,n=e.user,r=e.onToggleFollow,o=e.buttonStyle,i=(0,C.useDispatch)(),a=(0,V.n)(),c=a?n:X,u=(0,F._)((0,H.Y)({once:!0,rootMargin:"".concat(500,"px")}),2),l=u[0],p=u[1];(0,y.useEffect)(function(){if(!a)return function(){};!K(n)&&p&&i((0,W._u)(t))},[i,t,n,p,a]);var f=(null==c?void 0:c.isBlocking)||(null==c?void 0:c.isBlocked),h=(0,b.useShow)({elementLocation:{block:{blockText:"详情页关注"},type:"Button",moduleId:"follow_button",content:{type:"User",token:null==c?void 0:c.id,id:null==c?void 0:c.id}}});return(0,d.BX)(d.HY,{children:[c&&!f&&(0,d.tZ)(b.ZAEnv,{content:{type:"User",token:c.id,id:c.id},moduleId:"follow_button",block:"详情页关注",children:(0,d.BX)(q.Z,{onRef:h,css:(0,s._)({minWidth:74,padding:0,userSelect:"none"},o),getButtonPresetAndColor:function(e){return e.isFollowing?{preset:"secondary",color:"grey"}:{preset:"secondary",color:"blue"}},canShowMutualFollowStatus:!0,id:t,type:c.type,isFollowing:c.isFollowing,isFollowed:c.isFollowed,onToggleFollow:r,children:[(0,d.tZ)(z.ZP,{text:!0,center:!0})," 关注"]})}),(0,d.tZ)("div",{ref:l,css:{position:"absolute",bottom:0,right:0,width:1,height:1}})]})};function Y(e){var t=e.urlToken,n=e.onToggleFollow,r=e.buttonStyle,o=(0,C.useSelector)(function(e){return e.entities.users[t]});return(0,L.xw)(o)?null:(0,d.tZ)(j,{urlToken:t,user:o,onToggleFollow:n,buttonStyle:r})}var Q=n(87641),J=n(24405),$=function(e){var t=e.text,n=(0,J.F)();return(0,d.tZ)(Q.xu,{css:{color:n.colors.GBK04A,fontSize:14,lineHeight:1.6,fontWeight:"normal"},children:t})},ee=function(e){(0,c._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleClick",function(t){var n=e.props,r=n.zaId,o=n.zaExtra,i=n.zaInfo,a=n.author,c=a.urlToken,s=a.id,u=n.isSpecialQuestionOrAnswer,l=n.preventOpenUrl,d=n.isMobile,f=n.trackEvent;if(l){t.preventDefault();return}if(r&&A.Z.trackEvent(null,{id:r,action:"OpenUrl",element_name:"User"},o),i&&f({eventType:"Click",action:"OpenUrl",elementLocation:g()({type:"Card",content:{type:"User",id:s}},i.elementLocation)},g()({link:{url:t.target.href}},i.extra)),!d){if(u){location.href="zhihu://people/".concat(c,"?utm_app_name=zhihu_check"),t.preventDefault(),t.stopPropagation();return}w.Z.isMobileEntry&&e.props.isHuman&&e.props.shouldOia&&(t.preventDefault(),Z.dd&&w.Z.isMobileEntry||(0,p.rH)((0,R.MN)({type:"people",id:c},{utm_content:"user_link"})))}}),(0,a._)((0,r._)(e),"renderDetail",function(t){var n=e.props,r=n.extra,o=n.children,i=n.author,a=n.noHeadline,c=n.coCreationAuthorDescriptionText,l=n.followButtonAtFlexEnd;return c?(0,d.tZ)("div",{className:"AuthorInfo-badge",children:(0,d.tZ)($,{text:c})}):t&&r||(0,d.tZ)("div",{className:"AuthorInfo-badge",children:o||(0,d.tZ)(N.Z,{className:"AuthorInfo-badgeText",css:l&&{"&.AuthorInfo-badgeText":(0,u._)((0,s._)({},(0,f.S)(1)),{width:490,whiteSpace:"unset"})},user:i,noHeadline:a})})}),e}return(0,i._)(n,[{key:"render",value:function(){var e,t="plain"===this.props.preset,n=this.props,r=n.author,o=n.noLink,i=n.avatarSize,a=void 0===i?t?24:38:i,c=n.className,u=n.extra,l=n.itemProp,p=n.roundAvatar,f=n.isMobile,h=n.target,m=n.noDetail,g=n.overrideDetail,T=n.noHoverCard,E=n.router,y=n.noBadge,C=n.noVipBadge,S=n.showVipIcon,I=n.followButtonAtFlexEnd,A=n.onToggleFollow,Z=n.suffix,x=null==r?void 0:null===(e=r.vipInfo)||void 0===e?void 0:e.widget,k=E.getCurrentLocation().pathname,R=-1!==k.indexOf("people")&&3===k.split("/").length,N=this.renderDetail(t),L=this.props.userLinkV2;return(0,d.tZ)("div",{className:_()("AuthorInfo",c,{"AuthorInfo--plain":t}),itemProp:l,itemScope:!0,itemType:"http://schema.org/Person",children:(0,d.BX)(b.ZAEnv,{moduleId:"author_portrait_text_button",children:[(0,d.BX)("div",{className:_()("AuthorInfo",{"AuthorInfo--mobile":w.Z.isMobileEntry}),children:[(0,d.tZ)("meta",{itemProp:"name",content:r.name}),(0,d.tZ)("meta",{itemProp:"image",content:r.avatarUrl}),(0,d.tZ)("meta",{itemProp:"url",content:"https://www.zhihu.com/people/".concat(r.urlToken)}),(0,d.tZ)("meta",{itemProp:"zhihu:followerCount",content:r.followerCount}),L&&(0,d.BX)(d.HY,{children:[(0,d.tZ)(D.Z,(0,s._)({onClick:this.handleClick,noHoverCard:w.Z.isMobileEntry||f||T,noLink:o,user:r,className:"AuthorInfo-avatarWrapper",avatarProps:{className:"AuthorInfo-avatar",size:a,round:p}},h&&{target:h})),(0,d.BX)("div",{className:"AuthorInfo-content",children:[(0,d.BX)("div",{className:"AuthorInfo-head",children:[(0,d.tZ)(P.Z,(0,s._)({noHoverCard:w.Z.isMobileEntry||f||T,onClick:this.handleClick,noLink:o,user:r,noBadge:y,noVipBadge:C,showVipIcon:S,className:"AuthorInfo-name"},h&&{target:h})),!t&&u]}),!m&&(0,d.tZ)("div",{className:"AuthorInfo-detail",children:g||N})]})]}),!L&&(0,d.BX)(d.HY,{children:[(0,d.tZ)(O.Z,(0,s._)({onClick:this.handleClick,noHoverCard:w.Z.isMobileEntry||f||T,noLink:o,className:"AuthorInfo-avatarWrapper",user:r,avatar:!0,avatarProps:{className:"AuthorInfo-avatar",size:a,round:p}},h&&{target:h})),(0,d.BX)("div",{className:"AuthorInfo-content",children:[(0,d.BX)("div",{className:"AuthorInfo-head",children:[(0,d.tZ)(O.Z,(0,s._)({noHoverCard:w.Z.isMobileEntry||f||T,onClick:this.handleClick,className:"AuthorInfo-name",noLink:o,user:r},h&&{target:h})),!t&&u]}),!m&&(0,d.tZ)("div",{className:"AuthorInfo-detail",children:g||N})]})]})]}),R&&x&&x.id&&(0,d.tZ)(G,{className:"AuthorInfo-Widget",widget:x}),Z,!!r.urlToken&&I&&(0,d.tZ)(Y,{urlToken:r.urlToken,onToggleFollow:A})]})})}}]),n}(y.Component);(0,a._)(ee,"propTypes",{author:E().object.isRequired,noLink:E().bool,avatarSize:E().number,preset:E().oneOf(["plain","default"]),className:E().string,itemProp:E().string,roundAvatar:E().bool,isMobile:E().bool,noDetail:E().bool,relatedTo:E().string,zaId:E().number,zaExtra:E().object,zaInfo:E().object,noHoverCard:E().bool,noHeadline:E().bool,preventOpenUrl:E().bool,noBadge:E().bool,noVipBadge:E().bool,showVipIcon:E().bool,coCreationAuthorDescriptionText:E().oneOf(["视频作者","图文作者"])}),(0,a._)(ee,"defaultProps",{noLink:!1,roundAvatar:!1,itemProp:"author",noHoverCard:!1,noHeadline:!1,preventOpenUrl:!1,coCreationAuthorDescriptionText:null});var et=(0,I.compose)(S.withRouter,x.Z,(0,C.connect)(function(e,t){var n=t.relatedTo,r=t.params,o=["question","answer"].includes(n),i=(0,k.Hu)(e,{includeTablet:!0});return{isHuman:(0,k.H8)(e),shouldOia:(0,k.XE)(e)&&o,isMobile:i,isSpecialQuestionOrAnswer:(0,k.hV)(e,{type:o&&n,id:o?"question"===n?null==r?void 0:r.id:null==r?void 0:r.answerId:""}),followButtonAtFlexEnd:!i&&o}}))(ee)},58718:function(e,t,n){"use strict";n.d(t,{Z:function(){return I}});var r=n(85879),o=(n(55698),n(67814)),i=n.n(o),a=n(14168),c=n.n(a);n(87038),c().string,c().string,c().string;var s=n(20857),u=n(22107),l=n(94707),d=n(87320),p=n(86325),f=n(55164),h=n(57477),_=n(85626),m=n(99178),g=n(6907),T=n(87363),E=n(1733),y=n(9887),C=function(e){var t=e.name;return(0,r.tZ)("div",{className:"AutoComplete-DefaultItem",css:{lineHeight:"40px"},children:t})};C.propTypes={name:c().string},C.defaultProps={name:""};var S=function(e){(0,p._)(n,e);var t=(0,_._)(n);function n(e){(0,u._)(this,n),r=t.call(this,e),(0,d._)((0,s._)(r),"handleOpen",function(){var e=r.props,t=e.onChange,n=e.onOpen,o=r.state,i=o.value,a=o.menuOpened;r.isEmpty()||a||!r.menu||(r.menu.popover.open(),r.setState({selectedIndex:r.getDefaultSelectIndex(),menuOpened:!0},function(){"function"==typeof n&&n(),t(i)}))}),(0,d._)((0,s._)(r),"handleClose",function(e,t,n){if(r.state.menuOpened){var o,i=r.state.value,a=r.props,c=a.items,s=a.groups,u=a.getText,l=a.onSelect,d=a.onClose,p=a.onEnterInput;t=t||r.state.selectedIndex,e&&(r.openAvailable=!1,-1===t?p():(c?o=c[t]:s[n||r.state.selectedGroupKey]&&(o=s[n||r.state.selectedGroupKey][t]),o&&l(i=u(o),o))),r.menu&&r.menu.popover.close(),r.setState({value:i,menuOpened:!1,selectedIndex:r.getDefaultSelectIndex()},function(){"function"==typeof d&&d()})}}),(0,d._)((0,s._)(r),"handleChange",function(e){var t=e.target.value,n=r.props,o=n.onChange,i=n.inputProps.onChange;r.openAvailable=!0,r.setState({value:t}),i&&i(t),o(t)}),(0,d._)((0,s._)(r),"handleFocus",function(e){var t=r.props.onFocus;r.openAvailable=!0,r.handleOpen(),t&&t(e)}),(0,d._)((0,s._)(r),"handleBlur",function(e){var t=r.props.onBlur;r.openAvailable=!1,r.handleClose(),"function"==typeof t&&t(e)}),(0,d._)((0,s._)(r),"handleKeyDown",function(e){var t=e.keyCode;13!==t||r.isCompositing||(r.isAbleEnterToSearch=!0),(38===t||40===t)&&e.preventDefault();var n=r.props.inputProps;n&&n.onKeyDown&&n.onKeyDown(e)}),(0,d._)((0,s._)(r),"handleKeyUp",function(e){var t=r.props,n=t.items,o=t.groups,i=t.onEnterInput,a=e.keyCode;if(!r.isAbleEnterToSearch&&13===a){r.isAbleEnterToSearch=!0;return}if(13===a||27===a){if(r.state.menuOpened)r.openAvailable=!1,r.handleClose(13===a);else if(13===a){i();return}}else 38===a?n?r.setState(function(e){var t=e.selectedIndex;return{selectedIndex:t<=0?n.length-1:t-1}}):r.groupKeyArray&&r.groupKeyArray.length&&r.setState(function(e){var t=e.selectedIndex,n=e.selectedGroupKey,i=t-1,a=n;if(i<0){var c=r.groupKeyArray.indexOf(n),s=0===c?r.groupKeyArray.length-1:c-1;i=o[a=r.groupKeyArray[s]].length-1}return{selectedIndex:i,selectedGroupKey:a}}):40===a&&(n?r.setState(function(e){var t=e.selectedIndex;return{selectedIndex:t===n.length-1?0:t+1}}):r.groupKeyArray&&r.groupKeyArray.length&&r.setState(function(e){var t=e.selectedIndex,n=e.selectedGroupKey,i=t+1,a=n;if(i===o[n].length){var c=r.groupKeyArray.indexOf(n),s=c===r.groupKeyArray.length-1?0:c+1;a=r.groupKeyArray[s],i=0}return{selectedIndex:i,selectedGroupKey:a}}))}),(0,d._)((0,s._)(r),"handleCompositionStart",function(){r.isCompositing=!0,r.isAbleEnterToSearch=!1}),(0,d._)((0,s._)(r),"handleCompositionEnd",function(){r.isCompositing=!1});var r,o=r.props,i=o.value,a=o.items,c=o.groups;return r.state={id:null,value:i,selectedIndex:r.getDefaultSelectIndex(),selectedGroupKey:null,menuOpened:!1},r.openAvailable=!1,r.isCompositing=!1,r.isAbleEnterToSearch=!0,r.previous={items:a,groups:c},r}return(0,l._)(n,[{key:"componentDidMount",value:function(){this.setState({id:(0,g.E)("AutoComplete")}),this.checkMenuStatus()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props.value,n=e.value,r=e.items,o=e.groups;t!==n&&this.setState({value:n}),o&&(this.groupKeyArray=Object.keys(o).filter(function(e){return o[e].length>0}),this.groupKeyArray.length&&this.setState({selectedIndex:this.getDefaultSelectIndex(),selectedGroupKey:this.groupKeyArray[0]})),this.isEmpty(e)||(this.previous={items:r,groups:o})}},{key:"componentDidUpdate",value:function(){this.checkMenuStatus()}},{key:"getDefaultSelectIndex",value:function(){return this.props.autoSelect?0:-1}},{key:"checkMenuStatus",value:function(){var e=this.state.menuOpened,t=this.isEmpty();t||e||!this.openAvailable?t&&e&&this.handleClose():this.handleOpen()}},{key:"isEmpty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=e.items,n=e.groups,r=e.isItemDisabled,o="function"==typeof r&&t?t.filter(function(e){return!r(e)}):t;return(!o||0===o.length)&&(!n||!Object.values(n).some(function(e){return e.length>0}))}},{key:"renderItems",value:function(e){var t=this,n=this.props,o=n.renderItem,i=n.isItemDisabled,a=this.state,c=a.id,s=a.selectedIndex;return e.map(function(e,n){return(0,r.tZ)(E.sN,{id:"".concat(c,"-").concat(n),tag:"div",disabled:i(e),hovered:n===s,onMouseEnter:function(){t.setState({selectedIndex:n})},onClick:function(){return t.handleClose(!0,n)},onMouseDown:function(e){return e.preventDefault()},role:"option",children:o(e)},n)})}},{key:"renderGroupItems",value:function(e,t){var n=this,o=this.props,i=o.renderItem,a=o.isItemDisabled,c=this.state,s=c.id,u=c.selectedIndex,l=c.selectedGroupKey;return e.map(function(e,o){return(0,r.tZ)(E.sN,{id:"".concat(s,"-").concat(t,"-").concat(o),tag:"div",disabled:a(e),hovered:o===u&&t===l,onMouseEnter:function(){n.setState({selectedIndex:o,selectedGroupKey:t})},onClick:function(){return n.handleClose(!0,o,t)},onMouseDown:function(e){return e.preventDefault()},role:"option",children:i(e)},o)})}},{key:"renderGroups",value:function(){var e=this,t=this.props,n=t.labels,o=t.groups,i=t.renderLabel;return Object.keys(o).filter(function(e){return o[e].length>0}).map(function(t,a){return(0,r.BX)("div",{className:"AutoComplete-group",children:[n[t]&&i("".concat(n[t])),e.renderGroupItems(o[t],t)]},a)})}},{key:"renderInner",value:function(){var e=this.props,t=e.items,n=e.groups,o=this.isEmpty(),i=o?this.previous.items:t,a=o?this.previous.groups:n;return(0,r.BX)(r.HY,{children:[i&&this.renderItems(i),a&&this.renderGroups(a)]})}},{key:"renderInfiLoading",value:function(){var e=this.props.infiLoaderProps;return(0,r.tZ)(m.ZP,(0,h._)((0,f._)({},e),{children:this.renderInner()}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.inputProps,o=t.menuProps,a=t.infiLoaderProps,c=t.className,s=t.onRef,u=t.autoFocus,l=this.state,d=l.id,p=l.value,_=l.selectedIndex,m=l.selectedGroupKey,g=(0,r.tZ)(y.Z,(0,h._)((0,f._)({},n),{value:p,onRef:function(t){e.inputNode=t,s&&s(t)},onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onChange:this.handleChange,onFocus:this.handleFocus,onBlur:this.handleBlur,onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,autoComplete:"off",autoFocus:u,role:"combobox","aria-expanded":!1,"aria-autocomplete":"list","aria-activedescendant":"".concat(d).concat(m?"-".concat(m):"","-").concat(_)}));return(0,r.tZ)("div",{className:c,children:(0,r.tZ)(E.ZP,(0,h._)((0,f._)({},o),{menuClassName:i()("AutoComplete-menu",o.menuClassName),menuContainerClassName:o.menuContainerClassName,preventCloseOnTarget:void 0===o.preventCloseOnTarget||o.preventCloseOnTarget,toggler:g,placement:"bottom-left",arrowed:!1,ref:function(t){e.menu=t},toggleEvent:"keyup",ariaProps:{role:"listbox"},noLayer:!0,children:a?this.renderInfiLoading():this.renderInner()}))})}}]),n}(T.Component);S.defaultProps={renderItem:function(e){return(0,r.tZ)(C,(0,f._)({},e))},renderLabel:function(e){return(0,r.tZ)("span",{children:e})},getText:function(e){return e.name},value:"",autoFocus:!1,autoSelect:!0,onEnterInput:function(){},isItemDisabled:function(){return!1},inputProps:{},menuProps:{},onChange:function(){},onSelect:function(){}},S.propTypes={autoFocus:c().bool,autoSelect:c().bool,onRef:c().func,items:c().array,labels:c().object,groups:c().object,onChange:c().func,onSelect:c().func,onOpen:c().func,onClose:c().func,onFocus:c().func,onBlur:c().func,onEnterInput:c().func,inputProps:c().object,menuProps:c().object,isItemDisabled:c().func,renderItem:c().func,renderLabel:c().func,getText:c().func,value:c().string};var I=S},27258:function(e,t,n){"use strict";n.d(t,{Z:function(){return T}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),u=n(85879),l=n(14168),d=n.n(l),p=n(87363),f=n(25452),h=n(66263),_=n(15408),m=function(e){var t=e.children,n=e.showPrivacyPage,r=e.authWrapperClassName,o=e.authChild,i=p.Children.only(t),a=o?p.Children.only(o):i;return n?(0,u.tZ)(_.Z,{wrapperClassName:r,loginButton:a}):i},g=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),(e=t.call(this)).state={expanded:!1},e.onExpand=e.handleExpand.bind((0,r._)(e)),e}return(0,i._)(n,[{key:"handleExpand",value:function(){this.setState({expanded:!0})}},{key:"render",value:function(){var e=this.props,t=e.topics,n=e.user,r=e.ellipsisLength,o=e.expandable,i=e.privacyEnabled,a=e.showPrivacyPage,c=this.state.expanded,s="等 ".concat(t.length," 个"),l=t;return(c||(l=t.slice(0,r)),0===t.length)?null:(0,u.BX)("span",{children:[l.map(function(e,t){return(0,u.BX)("span",{children:[(0,u.tZ)(m,{showPrivacyPage:i&&a,authWrapperClassName:"ProfileMainPrivacy-authWrapper",authChild:(0,u.tZ)("span",{className:"ProfileMainPrivacy-pointerWrapper",children:e.name}),children:(0,u.tZ)("a",{href:"".concat(h.rX,"/").concat(n.isOrg?"org":"people","/").concat(n.urlToken,"/creations/").concat(e.id),children:e.name})}),t<l.length-1?"、":" "]},t)}),!c&&t.length>r&&(o?(0,u.tZ)(f.ZP,{preset:"plain",onClick:this.onExpand,children:s}):s),"话题"]})}}]),n}(p.Component);(0,a._)(g,"propTypes",{topics:d().array.isRequired,user:d().object,ellipsisLength:d().number,expandable:d().bool,noHoverCard:d().bool,privacyEnabled:d().bool,showPrivacyPage:d().bool}),(0,a._)(g,"defaultProps",{ellipsisLength:3,expandable:!0,noHoverCard:!1});var T=g},25452:function(e,t,n){"use strict";n.d(t,{rp:function(){return a},EE:function(){return i},ZP:function(){return y}});var r,o,i,a,c,s=n(87320),u=n(55164),l=n(57477),d=n(71728),p=n(85879),f=n(65733),h=n(17103),_=n(67814),m=n.n(_),g=n(87363),T=n.n(g),E={Button:"FEfUrdfMIKpQDJDqkjte",grey:"ZdfrHW7Ef5ZjwFiiBJuS",blue:"JmYzaky7MEPMFcJDLNMG",green:"_uLbatyxkRXPgimqvo45",red:"izzcAj8OQYu6ydgaw42c",primary:"epMJl0lFQuYbC7jrwr_o",secondary:"E211w_M7Hzs0GMB7BEyA",plain:"fEPKGkUK5jyc4fUuT0QP",link:"yXNqP8Bkgas9d_XumHbv",spread:"GMKy5J1UWc7y8NF_V8YA",withIcon:"B46v1Ak6Gj5sL2JTS4PY",iconOnly:"hIwDV_tcL6XN1HprrnAq",withLabel:"RuuQ6TOh2cRzJr6WlyQp",icon:"t2ntD6J1DemdOdvh5FB4"};(r=i||(i={})).Primary="primary",r.Secondary="secondary",r.Outline="outline",r.Plain="plain",r.Link="link",(o=a||(a={})).Grey="grey",o.Blue="blue",o.Green="green",o.Red="red",(c||(c={})).Spread="spread";var y=T().forwardRef(function(e,t){var n,r=e.children,o=e.className,a=e.color,c=e.icon,_=e.label,g=e.size,T=e.onRef,y=e.onClick,C=e.preset,S=void 0===C?i.Outline:C,I=e.component,A=void 0===I?"button":I,b=e.type,w=e.disabled,Z=(0,d._)(e,["children","className","color","icon","label","size","onRef","onClick","preset","component","type","disabled"]),x=(0,f.A)(function(e){e.currentTarget.disabled||w||!y||y(e)}),k=m()("Button",o,E.Button,(n={},(0,s._)(n,"Button--".concat(S),!!S&&S!==i.Outline),(0,s._)(n,"Button--".concat(a),!!a&&S!==i.Link),(0,s._)(n,"Button--".concat(g),!!g),(0,s._)(n,"Button--withIcon",!!c),(0,s._)(n,"Button--withLabel",!!_),(0,s._)(n,"Button--iconOnly",c&&!_),(0,s._)(n,E["".concat(S)],!!S&&S!==i.Outline),(0,s._)(n,E["".concat(a)],!!a&&S!==i.Link),(0,s._)(n,E["".concat(g)],!!g),(0,s._)(n,E.withIcon,!!c),(0,s._)(n,E.withLabel,!!_),(0,s._)(n,E.iconOnly,c&&!_),n));return(0,p.BX)(A,(0,l._)((0,u._)({},Z),{type:void 0===b?"button":b,disabled:w,ref:(0,h.q)(t,T),className:k,onClick:x,children:[c&&(0,p.tZ)(c,{center:!0,text:!!_||S===i.Plain||S===i.Link,className:m()("Button-zi",E.icon)}),_,r]}))})},8858:function(e,t){"use strict";t.Z=function(e,t){if(!e||!(t=t||e.type))return!1;if("answer"===t||"post"===t||"article"===t){var n,r;return null===(n=e.settings)||void 0===n?void 0:null===(r=n.tableOfContents)||void 0===r?void 0:r.enabled}return!1}},65153:function(e,t,n){"use strict";n.d(t,{Z:function(){return tu}});var r,o,i=n(22107),a=n(94707),c=n(87320),s=n(86325),u=n(85626),l=n(85879),d=n(62618),p=n(81037),f=n(82644),h=n(14168),_=n.n(h),m=n(87363),g=n.n(m),T=n(92258),E=n(73086),y=n(55164),C=n(57477),S=n(65733),I=n(7835),A=n(54231),b=n(84871),w=n.n(b),Z=n(67927),x=n(94009),k=n(58909),R=n(60683),N=n(9813),O=["risk_tip","Web 端暂不支持查看该消息，请在新版 App 中查看"],P=function(e){var t,n=e.content,r=(void 0===n?{}:n).text,o=void 0===r?"":r,i=e.content,a=void 0===i?{}:i,c=e.meta,s=(void 0===c?{}:c).content_type,u=e.extra,l=(void 0===u?{}:u).message_type;if("contentplugin"!==s)return e;var d=null==a?void 0:null===(t=a.plugin)||void 0===t?void 0:t.plugin_type,p=Object.prototype.hasOwnProperty.call(R.AX,d),f=p?R.wF.plugin:R.wF.text,h=(0,x._)(p?[l,o]:O,2),_=h[0],m=h[1];return(0,N.Uy)(e,function(e){e.meta.content_type=f,e.extra.message_type=_,e.content.text=m})},D=n(17518),L=n(30994),M=null,B=function(e){var t=e.id,n=e.onMessage;return M?Promise.resolve(M):(0,D.Z)([{name:"zhihu/message/v1/im/user/".concat(t,"/"),onMessage:n,parser:function(e){var t=JSON.parse(e.toString());L.Z.info("MQTT Raw Message",{message:t});var n=P(t);return L.Z.info("MQTT Processed Message",{original:t,processed:n}),n}}]).then(function(e){return M=e})},U=function(e){var t;return(null==e?void 0:null===(t=e.meta)||void 0===t?void 0:t.content_type)===R.wF.title},G=(0,m.createContext)(null),F=function(e){var t=e.children,n=(0,T.useSelector)(k.ib),r=(0,x._)((0,m.useState)(null),2),o=r[0],i=r[1],a=(0,T.useDispatch)(),c=(0,S.A)(function(e){if(L.Z.info("MQTT Message Received",{message:e}),U(e)){L.Z.info("MQTT Message Filtered",{message:e});return}L.Z.info("MQTT Message Dispatching",{message:e,currentUserId:n.id}),a((0,E.wh)(e,n.id))});return(0,m.useEffect)(function(){(null==n?void 0:n.id)&&(null==n?void 0:n.userType)!=="guest"&&!o&&B({id:n.id,onMessage:c}).then(function(e){i(e)})},[n,c,o]),(0,m.useEffect)(function(){},[o]),(0,l.tZ)(G.Provider,{value:o,children:t})},H=function(){var e=(0,m.useContext)(G),t=(0,x._)((0,m.useState)("connect"),2),n=t[0],r=t[1];return(0,m.useEffect)(function(){if(null==e?void 0:e.client){var t=["close","connect","end","reconnect"].map(function(e){return{ev:e,handler:function(){return r(e)}}});return t.forEach(function(t){e.client.on(t.ev,t.handler)}),function(){try{var n,r="function"==typeof e.client.off?"off":"removeListener";if(!e.client[r])return;t.forEach(function(t){e.client[r](t.ev,t.handler)})}catch(e){null===(n=window.Raven)||void 0===n||n.captureException(e)}}}},[e,r]),n},z=(r=function(e){var t=e.children,n=e.entryName,r=void 0===n?"":n,o=(0,T.useDispatch)(),i=H(),a=(0,m.useRef)(3),c=(0,S.A)(function(){"hidden"===document.visibilityState||a.current<=0||(a.current--,o((0,Z.c0)("私信连接已断开，请刷新页面","red")),A.ZP.increment("ChatMQTT.".concat(r,".notify.default.default.count")))});return(0,m.useEffect)(function(){if("end"===i)return c(),document.addEventListener("visibilitychange",c),function(){document.removeEventListener("visibilitychange",c)}},[i,c]),(0,m.useEffect)(function(){switch(i){case"end":A.ZP.increment("ChatMQTT.".concat(r,".end.default.default.count"));break;case"close":A.ZP.increment("ChatMQTT.".concat(r,".close.default.default.count"))}},[i,r]),(0,I.b)(function(){A.ZP.increment("ChatMQTT.".concat(r,".start.default.default.count"))}),t},o=(0,m.forwardRef)(function(e,t){return(0,l.tZ)(F,{children:(0,l.tZ)(r,(0,C._)((0,y._)({},e),{ref:t}))})}),w()(o,r)),q=n(20857),V=n(49899),W=n(96652),X=n(14914),K=n(24752),j=n(66980),Y=Object.assign,Q=function(e){return g().createElement(j.Z,Y({width:"200",height:"88",fill:"none",viewBox:"0 0 200 88"},e),g().createElement("path",{fill:"#E3EAF1",d:"M90.78 11.188H52.292v66.743h9.43l1.259 8.04 12.754-8.04H90.78V11.189zM74.51 69.597l-7.488 4.713-.734-4.713h-5.389V19.47h21.186v50.126H74.51zM45.189 41.222H31.193c0-1.473.105-2.98.123-4.557V19.477H47.27v-4.054a4.224 4.224 0 0 0-1.262-2.99 4.307 4.307 0 0 0-3.024-1.238H18.072c.088-.277.175-.555.262-.797C19.192 7.834 21.938.002 21.938.002a13.32 13.32 0 0 0-7.54 2.183c-1.784 1.248-2.851 2.131-4.286 6.082-1.662 4.54-3.114 8.923-4.094 11.54C4.514 23.981.875 31.328.875 31.328a18.295 18.295 0 0 0 7.872-1.906c3.5-1.854 5.249-4.696 6.421-9.01l.28-.936h7.295v17.188c0 1.56-.14 3.067-.227 4.557H9.64a8.404 8.404 0 0 0-5.914 2.426 8.242 8.242 0 0 0-2.449 5.856h20.399a55.358 55.358 0 0 1-2.432 11.401 52.49 52.49 0 0 1-9.412 16.478A103.517 103.517 0 0 1 0 86.687s9.78 3.674 16.952-2.98c4.34-4.037 8.223-11.92 10.095-17.898a87.786 87.786 0 0 0 3.499-16.34h18.65v-4.28a3.918 3.918 0 0 0-1.169-2.81 4.022 4.022 0 0 0-2.838-1.157z"}),g().createElement("path",{fill:"#E3EAF1",d:"m35.222 58.361-7.226 4.661 15.746 23.305a21.572 21.572 0 0 0 2.099-6.931 9.843 9.843 0 0 0-.875-6.775l-9.744-14.26zm125.555-14.01v-29.23a7322.86 7322.86 0 0 0 29.496-1.507l2.659-.156c1.207-1.248 2.764-7.485 2.152-9.443-.228-.78-.665-2.08-1.995-1.733a103.979 103.979 0 0 1-13.366 2.27c-8.642 1.005-12.403 1.265-24.387 2.131-20.994 1.525-39.713 2.253-39.713 2.253a7.857 7.857 0 0 0 .64 3.114 7.923 7.923 0 0 0 1.823 2.617 8.012 8.012 0 0 0 2.713 1.697 8.085 8.085 0 0 0 3.169.507c7.12-.294 17.494-.78 28.114-1.282v28.762h-39.941c0 2.197.881 4.303 2.449 5.857a8.406 8.406 0 0 0 5.914 2.425h31.578v22.11c0 2.772-1.452 3.725-3.849 3.794h-12.247a12.979 12.979 0 0 0 2.613 4.826 13.117 13.117 0 0 0 4.385 3.335 19.423 19.423 0 0 0 8.468.866c4.251-.208 9.272-2.581 9.272-11.158V52.633h35.252c1.067 0 2.091-.42 2.845-1.167A3.965 3.965 0 0 0 200 48.648v-4.297h-39.223z"}),g().createElement("path",{fill:"#E3EAF1",d:"M133.169 24.611a7.192 7.192 0 0 0-2.065-1.914 7.273 7.273 0 0 0-5.476-.882 7.26 7.26 0 0 0-2.571 1.167l-1.172.85 13.296 18.279 6.998-5.06-9.01-12.44zm46.048-.617L169.455 36.8l6.997 5.198 14.119-18.522-1.172-.867a7.294 7.294 0 0 0-8.066-.49 7.196 7.196 0 0 0-2.116 1.876z"}))},J=n(6366),$=n(67814),ee=n.n($),et=function(e){(0,s._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),(0,c._)((0,q._)(e),"state",{isAlertShow:!0}),(0,c._)((0,q._)(e),"handleCloseAlert",function(){e.setState({isAlertShow:!1})}),e}return(0,a._)(n,[{key:"render",value:function(){var e=this.props,t=e.message,n=e.className;return this.state.isAlertShow?(0,l.BX)("div",{className:ee()("AbnormalAlert",n),children:[(0,l.tZ)("span",{className:"AbnormalAlert-message",dangerouslySetInnerHTML:{__html:t}}),(0,l.tZ)(f.HN,{className:"AbnormalAlert-icon",onClick:this.handleCloseAlert})]}):null}}]),n}(m.Component);(0,c._)(et,"propsTypes",{message:_().object,className:_().string});var en=n(6907),er=n(55536),eo=n(69383),ei=n(57730),ea=n(33961),ec=n(88423),es=n(9887),eu=n(66263),el=(0,T.connect)(null,{sendMessage:E.bG})((0,m.memo)(function(e){var t=e.sender,n=e.receiver,r=e.location,o=e.sendMessage,i=(0,m.useMemo)(function(){return{message:{id:"",contentType:"",userType:"receiver"},sender:t,receiver:n,sendMessage:o,location:r,pluginContent:""}},[t,n,r,o]);return(0,l.tZ)(W.Oc,{slotKey:"InputBoxPlugin.zhiplus",props:i})})),ed=n(84267),ep=n(25452),ef=function(e){var t=e.handleSendTextMessage,n=e.inputValue,r=H();return(0,l.BX)("div",{className:"InputBox-footer",children:[(0,l.tZ)("div",{className:"InputBox-footerDesc",css:function(e){return{color:"connect"===r?e.colors.GBK07A:e.colors.GBL07A}},children:"按 Enter 键发送"}),(0,l.tZ)(ep.ZP,{preset:"primary",color:"blue",className:"InputBox-sendBtn",onClick:t,disabled:!n.trim(),children:"发送"})]})},eh=n(83537),e_=n(77440),em=function(e){var t=(0,x._)((0,m.useState)(!1),2),n=t[0],r=t[1];return n?null:(0,l.tZ)(ev,(0,C._)((0,y._)({},e),{dispose:function(){return r(!0)}}))},ev=function(e){var t=e.endSignal,n=void 0!==t&&t,r=e.dispose,o=(0,x._)((0,m.useState)(0),2),i=o[0],a=o[1];(0,m.useEffect)(function(){a(Date.now())},[]);var c=(0,S.A)(function(e){var t=e-i;t>0&&t<=6e4&&((0,e_.Ef)(null,{id:9980,action:"StatusReport"}),null==r||r())});return(0,m.useEffect)(function(){n&&c(Date.now())},[c,n]),(0,eh.K)(r,6e4),null};em.propTypes={endSignal:_().bool};var eg=n(97234),eT=n(30283),eE=function(e){(0,s._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),(0,c._)((0,q._)(e),"checkSize",function(t){var n=e.props.showNotification;if(t.size>1048576*eu.i3)return n("请上传小于 ".concat(eu.i3,"M 的图片。"),"red"),!1}),(0,c._)((0,q._)(e),"sendImage",function(t){var n=t.file;(0,e.props.handleSendImage)(n),e.uploadInput.value=""}),e}return(0,a._)(n,[{key:"render",value:function(){var e=this,t=this.props.className;return(0,l.tZ)(eg.Z,{accept:"image/png,image/jpeg",onRef:function(t){e.uploadInput=t},customUpload:this.sendImage,beforeUpload:this.checkSize,multiple:!0,children:(0,l.tZ)(eT.e,{className:t})})}}]),n}(m.Component);(0,c._)(eE,"propTypes",{senderId:_().string,className:_().string,handleSendImage:_().func});var ey=(0,T.connect)(null,{showNotification:Z.c0})(eE),eC=n(69274),eS=n(62039),eI=(0,T.connect)(function(e){return{hasData:e.emoticons.emoticonGroupList.length>0}}),eA=n(51070),eb=n.n(eA),ew=n(29229),eZ=n(63638),ex=n(3028),ek=n(36173),eR=n(68455);function eN(e){var t,n,r,o,i,a,c=e.className,s=e.emoticonGroupList,u=e.curEmoticonGroupId,d=e.onGroupSelected,p=e.vipEnabled,f=(0,m.useRef)(),h=(0,eR.yN)(p,s),_=(n=(t=(0,x._)((0,m.useState)({left:null,x:null}),2))[0],r=t[1],i=(o=(0,x._)((0,m.useState)(!1),2))[0],a=o[1],{onMouseDown:(0,S.A)(function(e){var t;a(!0),r({left:null===(t=f.current)||void 0===t?void 0:t.scrollLeft,x:e.clientX}),e.preventDefault()}),onMouseMove:(0,S.A)(function(e){if(i){var t=e.clientX-n.x;f.current&&(f.current.scrollLeft=n.left-t)}}),onMouseUp:(0,S.A)(function(){i&&a(!1)})});return(0,l.tZ)("div",{className:ee()("EmoticonsFooter",c),children:(0,l.tZ)("ul",(0,C._)((0,y._)({className:"EmoticonsFooter-items",ref:f},_),{children:h.map(function(e){return(0,l.tZ)("li",{className:ee()("EmoticonsFooter-item",{"EmoticonsFooter-item--selected":u===e.id}),onClick:function(){d(e.id)},children:(0,l.tZ)("img",{alt:"",src:e.iconUrl,className:"EmoticonsFooter-itemIcon"})},e.id)})}))})}var eO=n(57665);function eP(e){var t=e.item,n=e.type,r=e.onSelectEmoticon,o=t.title,i=t.staticImageUrl,a=t.dynamicImageUrl,c=function(e){a&&(e.target.src=a)},s=function(e){a&&(e.target.src=i)},u=function(){r(t,n)};return(0,l.BX)(eZ.ZAClick,{zaType:"Button",zaText:o,zaEventType:"Click",zaBlock:"vip"===n?"VipEmoticon":"Emoticon",as:"li",className:ee()("EmoticonPanel-item",{"EmoticonPanel-item--big":"emoji"!==n}),onClick:u,onKeyPress:function(e){" "===e.key&&u()},tabIndex:0,children:[(0,l.tZ)("img",{src:i,title:"emoji"===n?o:"",className:ee()({"EmoticonPanel-itemImg--small":"emoji"===n,"EmoticonPanel-itemImg--big":"emoji"!==n}),onMouseOver:c,onMouseOut:s,onFocus:c,onBlur:s,alt:o}),"emoji"!==n&&(0,l.tZ)("span",{className:"EmoticonPanel-itemTitle",children:o})]})}function eD(e){var t=e.type,n=e.data,r=void 0===n?[]:n,o=e.onSelectEmoticon;return 0===r.length?(0,l.tZ)(eO.Z,{className:"EmoticonPanel-spinner"}):(0,l.tZ)("ul",{className:"EmoticonPanel",children:r.map(function(e){return(0,l.tZ)(eP,{item:e,type:t,onSelectEmoticon:o},e.id)})})}eD.propTypes={type:_().string.isRequired,data:_().array.isRequired,onSelectEmoticon:_().func.isRequired};var eL=function(e){(0,s._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),(0,c._)((0,q._)(e),"getCurEmoticonGroupPanleData",function(){var t=e.props,n=t.curEmoticonGroupId;return t.emoticonPanelList.filter(function(e){return e.groupId===n})}),e}return(0,a._)(n,[{key:"render",value:function(){var e=this.props,t=e.changeSelectedEmoticonPanel,n=e.curEmoticonPanelId,r=e.className,o=this.getCurEmoticonGroupPanleData();return o.length<=1?null:(0,l.tZ)("ul",{className:ee()("EmoticonPagination",r),children:o.map(function(e){return(0,l.tZ)("li",{className:ee()("EmoticonPagination-bullet",{"EmoticonPagination-bullet--active":e.id===n}),onClick:function(){t(e.id)}},e.id)})})}}]),n}(m.Component);(0,c._)(eL,"propsTypes",{className:_().string});var eM=(0,T.connect)(function(e){var t=e.emoticons;return{curEmoticonGroupId:t.curEmoticonGroupId,emoticonPanelList:t.emoticonPanelList,curEmoticonPanelId:t.curEmoticonPanelId}},{changeSelectedEmoticonPanel:eS.Jb})(eL),eB=n(99878);function eU(e){var t=e.show,n=e.onClick,r=(0,S.A)(function(){null==n||n()});return t&&(0,l.BX)(eZ.ZAClick,{zaType:"Button",zaEventType:"Click",zaAction:"OpenUrl",zaBlock:"VipBrand",extra:{link:{url:eu.pL}},css:function(e){return(0,c._)({backgroundColor:e.colorMod(e.colors.GYL08A).alpha(.25),color:e.colors.GYL12A,display:"flex",alignItems:"center",justifyContent:"center",height:"25px",fontSize:"12px",lineHeight:"17px",userSelect:"none"},"&:hover",{cursor:"pointer"})},onClick:r,children:["开通会员解锁全部会员表情 ",(0,l.tZ)(eB.N,{})]})}var eG={containerClass:"Emoticons-panelContainer",ContainerEl:"ul",threshold:10},eF=function(e){(0,s._)(n,e);var t=(0,u._)(n);function n(e){var r;return(0,i._)(this,n),r=t.call(this,e),(0,c._)((0,q._)(r),"state",{showVipStickerModal:!1}),(0,c._)((0,q._)(r),"setShowVipStickerModal",function(e){r.setState({showVipStickerModal:e})}),(0,c._)((0,q._)(r),"handleGetSwiperInstance",function(e){r.mousetrap=new(eb()),r.swiperInstance=e,r.mousetrap.bind("left",function(){e.slidePrev()}),r.mousetrap.bind("right",function(){e.slideNext()})}),(0,c._)((0,q._)(r),"handleEmoticonGroupSelected",function(e){var t=r.props,n=t.getEmoticonsDetail,o=t.emoticonGroupDetail,i=t.changeSelectedEmoticonGroup,a=t.changeSelectedEmoticonPanel;o[e]||n(e),i(e),a("".concat(e,"-0"))}),(0,c._)((0,q._)(r),"handleSlideChange",function(){var e=r.props,t=e.emoticonPanelList,n=e.getEmoticonsDetail,o=e.changeSelectedEmoticonPanel,i=e.changeSelectedEmoticonGroup;if(r.swiperInstance){var a=t[r.swiperInstance.activeIndex];o(a.id),i(a.groupId),0===a.data.length&&n(a.groupId)}}),(0,c._)((0,q._)(r),"handleRequestVip",function(){r.setShowVipStickerModal(!0)}),(0,c._)((0,q._)(r),"handleSelectEmoticon",function(e,t){var n=r.props,o=n.onSelectEmoticon,i=n.isVip;"vip"!==t||i?o(e,t):r.handleRequestVip()}),r.swiperInstance=(0,m.createRef)(),r}return(0,a._)(n,[{key:"componentWillUnmount",value:function(){var e=this.props,t=e.changeSelectedEmoticonGroup,n=e.changeSelectedEmoticonPanel,r=e.emoticonPanelList;t(r[0].groupId),n(r[0].id),this.mousetrap.reset()}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.emoticonGroupList,o=t.curEmoticonGroupId,i=t.emoticonPanelList,a=t.curEmoticonPanelId,c=t.isVip,s=t.vipEnabled,u=void 0!==s&&s,d=t.Swiper,p=t.noBorder,f=this.state.showVipStickerModal,h=this.setShowVipStickerModal,_=(0,eR.yN)(u,i);return(0,l.tZ)(eZ.ZAEnv,{block:"EmoticonsCard",children:(0,l.BX)("div",{className:ee()("Emoticons",{"Emoticons--bordered":!(void 0!==p&&p)},n),children:[d?(0,l.tZ)(d,(0,C._)((0,y._)({},eG),{activeSlideKey:a,getSwiper:this.handleGetSwiperInstance,on:{slideChange:this.handleSlideChange},children:_.map(function(t){return(0,l.tZ)("li",{className:"Emoticons-panels-item",children:(0,l.tZ)(eD,{type:t.type,data:t.data,onSelectEmoticon:e.handleSelectEmoticon})},t.id)})})):(0,l.tZ)("div",{css:{height:183}}),(0,l.tZ)(eM,{className:"Emoticons-Pagination"}),(0,l.tZ)(eU,{show:u&&!c,onClick:this.handleRequestVip}),(0,l.tZ)(eN,{emoticonGroupList:void 0===r?[]:r,curEmoticonGroupId:o,onGroupSelected:this.handleEmoticonGroupSelected,vipEnabled:u}),(0,l.tZ)(ek.Z,{show:f,setShow:h,type:ek.W.comment_sticker})]})})}}]),n}(m.Component);(0,c._)(eF,"propTypes",{className:_().string,onSelectEmoticon:_().func});var eH=(0,er.compose)((0,T.connect)(function(e){var t=e.emoticons,n=t.emoticonGroupList,r=t.curEmoticonGroupId,o=t.emoticonGroupDetail,i=t.emoticonPanelList;return{emoticonGroupList:n,curEmoticonGroupId:r,emoticonGroupDetail:o,emoticonPanelList:void 0===i?[]:i,curEmoticonPanelId:t.curEmoticonPanelId,isVip:(0,k.cE)(e)}},{getEmoticonsDetail:eS.aV,changeSelectedEmoticonGroup:eS.XO,changeSelectedEmoticonPanel:eS.Jb}),(0,ex.Z)(null),function(e){return function(t){var r=(0,ew._)(function(){return Promise.all([n.e(5518),n.e(3775)]).then(n.t.bind(n,46552,23))});return(0,l.tZ)(e,(0,C._)((0,y._)({},t),{Swiper:r}))}})(eF),ez=function(e){(0,s._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),(0,c._)((0,q._)(e),"state",{isEmoticonsHidden:!0}),(0,c._)((0,q._)(e),"toggleEmoticonPanel",function(){e.setState({isEmoticonsHidden:!e.state.isEmoticonsHidden})}),(0,c._)((0,q._)(e),"handleSelectEmoticon",function(t,n){var r=e.props,o=r.insertEmoji,i=r.handleSendEmoticon;"emoji"===n?o(t.placeholder):i(t),e.toggleEmoticonPanel()}),e}return(0,a._)(n,[{key:"render",value:function(){var e=this.props.className,t=this.state.isEmoticonsHidden;return(0,l.BX)("div",{className:"EmoticonTool",children:[!t&&(0,l.tZ)("div",{className:"EmoticonTool--mask",onClick:this.toggleEmoticonPanel}),!t&&(0,l.tZ)(eH,{className:"EmoticonTool-panel",onSelectEmoticon:this.handleSelectEmoticon}),(0,l.tZ)(eC.t,{className:ee()("EmoticonTool-icon",e),onClick:this.toggleEmoticonPanel})]})}}]),n}(m.Component);(0,c._)(ez,"propTypes",{senderId:_().string,className:_().string});var eq=(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.alwaysShow,n=void 0!==t&&t;return function(e){return eI(w()(function(t){var r=t.hasData,o=(0,x._)((0,m.useState)(!1),2),i=o[0],a=o[1],c=(0,T.useDispatch)();return(0,m.useEffect)(function(){if(r){a(!0);return}c((0,eS.P0)()).then(function(e){var t=e.payload.data[0].id;c((0,eS.aV)(t)),a(!0)}).catch(function(){a(!0)})},[c,r]),(!i||!n)&&(0,l.tZ)(e,(0,y._)({},t))},e))}})()(ez),eV=n(65084),eW=n(19860),eX=n(9478),eK=n.n(eX),ej=n(88329),eY=n.n(ej),eQ=n(99447),eJ=n(31467),e$=Object.assign,e0=function(e){return g().createElement(j.Z,e$({width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},e),g().createElement("path",{fill:"#fff",d:"M0 0h24v24H0z",opacity:".01"}),g().createElement("path",{fill:"#646464",fillRule:"evenodd",d:"M3.004 18.5a2.285 2.285 0 0 0 2.285 2.284h13.736a2.285 2.285 0 0 0 2.285-2.285v-3.732a.763.763 0 0 0-.759-.846h-.01a1.526 1.526 0 0 1 .01-3.053.763.763 0 0 0 .759-.847V6.29a2.285 2.285 0 0 0-2.285-2.285H5.289A2.285 2.285 0 0 0 3.004 6.29v3.732a.763.763 0 0 0 .759.846h.015a1.526 1.526 0 0 1-.015 3.053.763.763 0 0 0-.759.846v3.732ZM17.5 12.394c0 1.423.975 2.62 2.293 2.957v3.147a.768.768 0 0 1-.767.768H5.289a.768.768 0 0 1-.767-.768v-3.147a3.054 3.054 0 0 0 0-5.915V6.29c0-.424.343-.768.767-.768h13.736c.424 0 .767.344.767.768v3.147a3.054 3.054 0 0 0-2.293 2.958Zm-3.807 0a1.535 1.535 0 1 1-3.07 0 1.535 1.535 0 0 1 3.07 0Zm1.517 0a3.052 3.052 0 1 1-6.104 0 3.052 3.052 0 0 1 6.104 0Z",clipRule:"evenodd"}))},e1=Object.assign,e2=function(e){return g().createElement(j.Z,e1({width:"24",height:"24",fill:"none",viewBox:"0 0 26 26"},e),g().createElement("path",{fill:"#fff",d:"M0 0h24v24H0z",opacity:".01"}),g().createElement("path",{fill:"#646464",fillRule:"evenodd",d:"M16.875 7.149c.182 1.255-.302 3.01-1.436 5.369-.328.6-.62 1.479-.597 1.768.013.169.08.316.215.448l3.042-3.042a1.626 1.626 0 0 1 2.228-.068l.747.742c.611.612.634 1.59.068 2.228l-1.483 1.487c.455.17 1 .51 1.314.982.315.471.532 1.493.532 3.177 0 .663-.532 1.273-1.236 1.273l-6.062-.015c-.25.193-.528.346-.826.453l-2.161.652a.85.85 0 0 1-.844-.212c-.203-.203-.318-.5-.2-.896-.003.003-6.924.018-6.924.018A1.247 1.247 0 0 1 2 20.259l.013-1.49c-.013-.77.13-1.155.314-1.435.181-.274.443-.54.63-.73l.014-.013c.445-.452 1.444-.737 2.777-.98 2.487-.454 2.875-.819 2.915-1.325.01-.131-.162-.851-.548-1.606-1.255-2.444-1.705-3.934-1.49-5.502C6.944 4.827 8.662 3 11.752 3c3.09 0 4.776 1.77 5.122 4.149Zm.65 6.886-5.272 5.282c-.271.332-.678 1.873-.678 1.873s1.582-.41 1.92-.721l5.235-5.229-1.205-1.205ZM8.11 7.382C8.391 5.7 9.513 4.506 11.754 4.5c2.241-.005 3.397 1.221 3.635 2.863.129.883-.288 2.394-1.285 4.469-.439.8-.81 1.918-.758 2.57a2.12 2.12 0 0 0 .649 1.393l-2.577 2.582c-.557.62-.79 1.614-.79 1.614l-7.125.02.012-1.334c0-.408.08-.634.36-.873.233-.2.552-.34.877-.439.451-.11.918-.208 1.372-.303 1.016-.214 1.972-.415 2.563-.706.866-.426 1.378-1.061 1.472-1.954.075-.707-.72-2.44-.72-2.44S7.85 8.956 8.111 7.382Zm10.34 9.91-2.713 2.71 4.26.008s-.056-1.624-.213-2.012c-.082-.155-.275-.458-1.335-.707Zm.575-4.752a.375.375 0 0 1 .489.036l.71.717a.376.376 0 0 1-.036.489l-.574.574-1.206-1.206.617-.61Z",clipRule:"evenodd"}))},e3=function(e){var t=e.cardList,n=e.onSend,r=e.onClose,o=e.isEvent,i=o?eW.Z:eV.Z;return(0,l.tZ)(eJ.Z,{title:o?"活动":"优惠券",onClose:r,className:"EcomCardTool-Modal",children:(0,l.tZ)("ul",{className:"EcomCardTool-Modal--list",children:t.map(function(e,t){return(0,l.tZ)("li",{className:"EcomCardTool-Modal--cardItem",children:(0,l.tZ)(i,{result:e,extra:{},onClick:function(){return n((0,C._)((0,y._)({},e),{cardType:o?1:2}))}})},e.token||t)})})})};e3.propTypes={onClose:_().func.isRequired,cardList:_().array,onSend:_().func};var e4=function(e){var t=e.senderId,n=e.className,r=e.isEvent,o=e.onHandleFirstInterActive,i=(0,T.useSelector)(function(e){return e.env.theme}),a=(0,T.useDispatch)(),c=(0,x._)((0,m.useState)(!1),2),s=c[0],u=c[1],d=(0,x._)((0,m.useState)([]),2),p=d[0],f=d[1],h=(0,S.A)(function(){a((0,E.ii)({senderId:t})).then(function(e){var t;return f(null===(t=e.payload)||void 0===t?void 0:t.data)})}),_=(0,S.A)(function(){var e=function(e){var t=!eK()(e)&&e.map(function(e){return(0,C._)((0,y._)({},e),{className:(null==e?void 0:e.template.id)===1?"KfeCollection-MessageCouponCard-orangeCoupon--".concat(i):"KfeCollection-MessageCouponCard-blueCoupon--".concat(i),description:e.intro})})||[];f((0,V._)(t))};a((0,E.sT)()).then(function(t){var n;return e(null===(n=t.payload)||void 0===n?void 0:n.data)})});(0,m.useEffect)(function(){r&&h()},[r,h]),(0,m.useEffect)(function(){r||_()},[r,_]);var g=r?e2:e0,I=function(e){var n=e.token,r=e.cardType;if(o(),1!==r)return a((0,E.Vq)({contentType:R.wF.ecomcard,id:n,data:{receiverId:t,cardType:r}}));var i=(0,en.E)("TempEventCard_");return a((0,E.Ok)(t,i,r)),a((0,E.Vq)({contentType:R.wF.ecomcard,token:n,data:{receiverId:t,cardType:r},tempMessageId:i}))},A=function(e){var t=e.token,n=e.cardType,r=e.id;I({token:t||r,cardType:n}).then(function(){u(!1)}).catch(eY())};return(0,l.tZ)(eZ.ZAEnv,{block:"EcomMessageEcomCardTool",content:{type:"Message"},children:(0,l.tZ)(eQ.r,{trackCardShow:!0,view:{id:r?9975:9976,url:"fakeurl://dialogue/user.*"},children:(0,l.BX)("div",{className:"EcomCardTool",children:[(0,l.tZ)(eZ.ZAShow,{shouldTrackClick:!0,zaText:r?"留资卡片":"优惠券卡片",zaType:"Button",zaEventType:"Click",children:(0,l.tZ)(g,{className:ee()("EcomCardTool-icon",n),width:22,height:22,onClick:function(e){if(!s&&eK()(p)){a((0,Z.c0)("请先去 ecom.zhihu.com 配置","red"));return}u(!s),(0,e_.Ef)(e,{id:r?9978:9979,action:"Click"})}})}),s&&(0,l.tZ)(e3,{isEvent:r,cardList:p,onSend:function(e){return A(e)},onClose:function(){return u(!1)}})]})})})};e4.propTypes={senderId:_().string,className:_().string,isEvent:_().bool,onHandleFirstInterActive:_().func};var e5=function(e){(0,s._)(n,e);var t=(0,u._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return(0,a._)(n,[{key:"render",value:function(){var e=this.props,t=e.senderId,n=e.insertEmoji,r=e.handleSendImage,o=e.handleSendEmoticon,i=e.onHandleFirstInterActive,a=e.isEcomMerchant;return(0,l.BX)("ul",{className:"ToolBar",children:[(0,l.tZ)("li",{className:"ToolBar-item",children:(0,l.tZ)(eq,{className:"ToolBar-Icon",senderId:t,insertEmoji:n,handleSendEmoticon:o})}),(0,l.tZ)("li",{className:"ToolBar-item",children:(0,l.tZ)(ey,{className:"ToolBar-Icon",senderId:t,handleSendImage:r})}),a&&(0,l.BX)(l.HY,{children:[(0,l.tZ)("li",{className:"ToolBar-item",children:(0,l.tZ)(e4,{isEvent:!0,className:"ToolBar-Icon",senderId:t,onHandleFirstInterActive:i},"event")},"event"),(0,l.tZ)("li",{className:"ToolBar-item",children:(0,l.tZ)(e4,{isEvent:!1,className:"ToolBar-Icon",senderId:t,onHandleFirstInterActive:i},"coupon")},"coupon")]})]})}}]),n}(m.Component);(0,c._)(e5,"propTypes",{senderId:_().string,insertEmoji:_().func,handleSendImage:_().func,handleSendEmoticon:_().func,onHandleFirstInterActive:_().func});var e6=(0,T.connect)(function(e){return{isEcomMerchant:(e.chat.chats||{}).isEcomMerchant}})(e5),e7=function(e){(0,s._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),(0,c._)((0,q._)(e),"state",{cursorPosition:0,firstInteractive:!1}),(0,c._)((0,q._)(e),"inputRef",(0,m.createRef)()),(0,c._)((0,q._)(e),"countDownTimer",null),(0,c._)((0,q._)(e),"handleSetFirsetInteractive",function(){e.setState({firstInteractive:!0})}),(0,c._)((0,q._)(e),"checkSize",function(t){var n=e.props.showNotification;return!(t.size>1048576*eu.i3)||(n("请上传小于 ".concat(eu.i3,"M 的图片。"),"red"),!1)}),(0,c._)((0,q._)(e),"handleKeyDown",function(t){var n=e.props,r=n.inputMessage,o=n.senderId,i=n.inputValue;13===t.keyCode&&(t.ctrlKey||t.metaKey)?r({senderId:o,inputValue:"".concat(i,"\n")}):13!==t.keyCode||t.shiftKey||e.handleSendTextMessage(t)}),(0,c._)((0,q._)(e),"handleSendImage",function(t){if(t&&e.checkSize(t)){var n,r=e.props,o=r.uploadImage,i=r.sendMessage,a=r.senderId,c=r.addTempImageMessage,s=r.setImageSendFailure,u=(0,en.E)("TempImage_");L.Z.info("开始上传图片 [1/6: 文件校验→预处理→临时消息→上传→发送→完成]",{tempMessageId:u,fileSize:t.size}),e.handleSetFirsetInteractive(),(0,ea.Z)(t).then(function(e){L.Z.info("2️⃣ 图片预处理完成",{tempMessageId:u,processedSize:e.size});var n=URL.createObjectURL(e);(0,ec.loadImage)(n).then(function(r){var l=r.height,d=r.width;L.Z.info("3️⃣ 创建临时消息",{tempMessageId:u,dimensions:{width:d,height:l}}),c(a,n,u,l,d);var p=Date.now();o(e).then(function(e){var t=Date.now()-p;return L.Z.info("9️⃣ 图片上传成功",{tempMessageId:u,imageUrl:e.payload.src,uploadTime:t}),i({contentType:R.wF.image,receiverId:a,data:{image:{height:e.payload.dataRawheight,width:e.payload.dataRawwidth,url:e.payload.src}},tempMessageId:u}).then(function(t){var n,r;return L.Z.info("图片消息发送成功",{tempMessageId:u,finalMessageId:null==t?void 0:null===(n=t.payload)||void 0===n?void 0:null===(r=n.info)||void 0===r?void 0:r.id,imageUrl:e.payload.src}),t}).catch(function(t){throw L.Z.info("图片消息发送失败",{tempMessageId:u,imageUrl:e.payload.src,error:t.message||"Unknown error"}),t})}).catch(function(e){var n=Date.now()-p;L.Z.info("图片上传失败",{tempMessageId:u,uploadTime:n,error:e.message||"Unknown error",fileSize:t.size}),s({tempMessageId:u,receiverId:a,file:t})})})}),null===(n=e.inputRef.current)||void 0===n||n.focus()}}),(0,c._)((0,q._)(e),"handleSendEmoticon",function(t){var n,r=t.id,o=t.dynamicImageUrl,i=t.staticImageUrl,a=t.title,c=e.props,s=c.senderId,u=c.sendMessage;e.handleSetFirsetInteractive(),u({contentType:"sticker",receiverId:s,data:{sticker:{sticker_id:r,url:o||i,title:a}}}),eo.Z.trackEvent(null,{id:3640,action:"Click",name:a}),null===(n=e.inputRef.current)||void 0===n||n.focus()}),(0,c._)((0,q._)(e),"handleSendTextMessage",function(t){var n=e.props,r=n.senderId,o=n.sendMessage,i=n.inputValue,a=n.location.query,c=a.source_type,s=a.source_id;if(i.length>1e4){ei.Z.alert("发送文字不得超过 1 万字，请重新编辑后再次发送",{title:"发送失败"});return}i.trim()&&(e.handleSetFirsetInteractive(),t.preventDefault(),o({contentType:R.wF.text,receiverId:r,data:{text:i},sourceType:c,sourceId:s}),eo.Z.trackEvent(null,{id:5309,action:"Click"}))}),(0,c._)((0,q._)(e),"insertEmoji",function(t){var n,r=e.props,o=r.inputMessage,i=r.senderId,a=r.inputValue,c=e.state.cursorPosition,s=[a.slice(0,c),t,a.slice(c)].join("");e.setState({cursorPosition:c+t.length}),o({senderId:i,inputValue:s}),eo.Z.trackEvent(null,{id:3641,action:"Click",name:t.slice(1,t.length-1)}),null===(n=e.inputRef.current)||void 0===n||n.focus()}),(0,c._)((0,q._)(e),"handleBlur",function(t){e.setState({cursorPosition:t.target.selectionStart})}),(0,c._)((0,q._)(e),"handleInputMessage",function(t){var n=e.props;(0,n.inputMessage)({senderId:n.senderId,inputValue:t.target.value})}),(0,c._)((0,q._)(e),"handleInputRef",function(t){e.inputRef.current=t}),e}return(0,a._)(n,[{key:"componentDidMount",value:function(){this.inputRef.current&&(this.inputRef.current.focus(),this.inputRef.current.addEventListener("keydown",this.handleKeyDown))}},{key:"componentWillUnmount",value:function(){this.inputRef.current&&this.inputRef.current.removeEventListener("keydown",this.handleKeyDown)}},{key:"render",value:function(){var e=this.props,t=e.inputValue,n=e.senderId,r=e.sender;if(null==r?void 0:r.isForbidden){var o=r.feedbacker;return(0,l.tZ)("div",{className:"InputBox",css:{justifyContent:"flex-end"},children:(0,l.tZ)("div",{className:"InputBox-footer",children:(0,l.BX)("div",{className:"InputBox-footerDesc",css:{textAlign:"center",paddingRight:0},children:["要反馈",(0,l.tZ)(X.Link,{to:"/messages/".concat(o.token),css:function(e){return{color:e.colors.GBK06A,fontWeight:"bold",paddingLeft:"4px"}},children:"@".concat(o.name)})]})})})}return(0,l.BX)("div",{className:"InputBox",children:[(0,l.tZ)(el,{sender:r,receiver:this.props.receiver,location:this.props.location}),(0,l.tZ)(em,{endSignal:this.state.firstInteractive}),(0,l.tZ)(e6,{senderId:n,insertEmoji:this.insertEmoji,handleSendImage:this.handleSendImage,handleSendEmoticon:this.handleSendEmoticon,onHandleFirstInterActive:this.handleSetFirsetInteractive}),(0,l.tZ)(es.Z,{multiline:!0,spread:!0,value:t,className:"InputBox-input",onRef:this.handleInputRef,onChange:this.handleInputMessage,onBlur:this.handleBlur}),(0,l.tZ)(ef,{handleSendTextMessage:this.handleSendTextMessage,inputValue:t})]})}}]),n}(m.Component),e8=(0,er.compose)(X.withRouter,(0,T.connect)(function(e,t){var n=t.senderId,r=(e.chat.chats[n]||{}).inputValue;return{inputValue:void 0===r?"":r}},{sendMessage:E.bG,inputMessage:E.N1,uploadImage:ed.Z,addTempImageMessage:E.vn,setImageSendFailure:E.Hf,showNotification:Z.c0}))(e7),e9=n(96268),te=n(57029),tt=n(89854),tn=n(87641);function tr(e){var t=e.onClose,n=e.onReport;return(0,l.BX)(tn.kC,{css:{position:"relative"},justifyContent:"center",p:10,height:169,children:[(0,l.tZ)(tn.xu,{css:function(e){return{position:"absolute",top:0,margin:"0 20px",borderTop:"1px solid ".concat(e.colors.GBK09A)}}}),(0,l.tZ)(ep.ZP,{preset:"plain",css:{position:"absolute",right:"20px",top:"20px"},onClick:t,children:(0,l.tZ)(f.ZP,{})}),(0,l.BX)(ep.ZP,{preset:"plain",flexDirection:"column",onClick:n,css:function(e){return{color:e.colors.GBK03A}},children:[(0,l.tZ)(tn.kC,{justifyContent:"center",alignItems:"center",width:50,height:50,mb:"7px",css:{background:"#FFFFFF",boxShadow:"0px 0px 8px rgba(0, 0, 0, 0.08)",borderRadius:"135px"},children:(0,l.tZ)(tt.Z,{})}),(0,l.tZ)(tn.kC,{justifyContent:"center",children:"举报"})]})]})}var to=n(80087),ti=[{slotKey:"MessageBubblePlugin.ZHI_PLUS_MSG_GROUP_PLUGIN_FORM",component:function(e){return(0,l.tZ)(to.bV,(0,y._)({},e))}},{slotKey:"InputBoxPlugin.zhiplus",component:function(e){return(0,l.tZ)(to.d1,(0,y._)({},e))}},{slotKey:"MessageBubblePlugin.ZHI_PLUS_MSG_GROUP_PLUGIN_WX",component:function(e){return(0,l.tZ)(to.QN,(0,y._)({},e))}},{slotKey:"MessageBubblePlugin.ZHI_PLUS_MSG_GROUP_QA",component:function(e){return(0,l.tZ)(to.Ip,(0,y._)({},e))}},{slotKey:"MessageBubblePlugin.ZHI_PLUS_MSG_GROUP_PLUGIN_CALL",component:function(e){return(0,l.tZ)(to.ex,(0,y._)({},e))}}],ta=function(e){(0,s._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),(0,c._)((0,q._)(e),"state",{isReportModalShow:!1,selectedMessages:[],multiSelectMode:!1}),(0,c._)((0,q._)(e),"slotConfig",{slots:ti,onError:function(e){console.error(e)}}),(0,c._)((0,q._)(e),"toggleReportModal",function(){e.setState(function(e){return{isReportModalShow:!e.isReportModalShow,selectedMessages:!e.multiSelectMode&&e.isReportModalShow?[]:e.selectedMessages}})}),(0,c._)((0,q._)(e),"enterMultiSelectMode",function(){e.setState({multiSelectMode:!0})}),(0,c._)((0,q._)(e),"leaveMultiSelectMode",function(){e.setState({multiSelectMode:!1,selectedMessages:[]})}),(0,c._)((0,q._)(e),"toggleSelectMessage",function(t,n){var r=e.props.showNotification;if(t&&e.state.selectedMessages.length>=20){r("最多选择20条信息");return}e.setState(function(e){return{selectedMessages:t?(0,V._)(e.selectedMessages).concat([n]):e.selectedMessages.filter(function(e){var t=e.id;return n.id!==t})}})}),(0,c._)((0,q._)(e),"onReport",function(){0!==e.state.selectedMessages.length&&e.toggleReportModal()}),e}return(0,a._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.senderId,n=e.getEcomProfile;(0,e.getAccountInfo)(),t&&n(t)}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.senderId,r=e.sender,o=e.location,i=e.warning,a=i.status,c=i.message,s=this.state,u=s.isReportModalShow,d=s.selectedMessages,p=s.multiSelectMode,f=r||{},h=f.name,_=f.vipInfo,m=f.kvipInfo,g=d.map(function(e){var t=e.type,n=e.id,r=e.associateId;return"risk_tip"===t||"tip"===t?r:n}),T=((void 0===_?{}:_)||{}).vipIcon,E=((void 0===m?{}:m)||{}).vipIcon;if(!n)return(0,l.tZ)("div",{className:"ChatBox-empty",children:(0,l.tZ)(Q,{className:"ChatBox-emptyImage"})});var y=(0,l.BX)(te.e5,{className:t,children:[a&&(0,l.tZ)(et,{message:c,className:"ChatBox-alert"}),u&&(0,l.tZ)(K.y,{type:"message",urlTokens:g,shown:!0,onClose:this.toggleReportModal}),(0,l.BX)(te.Ng,{children:[(0,l.tZ)("span",{children:void 0===h?"":h}),T&&(0,l.tZ)("img",{src:T.url,className:"ChatBox-titleVipIcon",alt:""}),E&&(0,l.tZ)("img",{src:E.url,className:"ChatBox-titleVipIcon",alt:""})]}),(0,l.tZ)(te.En,{children:(0,l.tZ)(e9.Z,{senderId:n,multiSelectMode:p,selectedMessages:d,onMultiSelectClick:this.enterMultiSelectMode,toggleSelectMessage:this.toggleSelectMessage,toggleReportModal:this.toggleReportModal,location:o})}),p&&(0,l.tZ)(tr,{onClose:this.leaveMultiSelectMode,onReport:this.onReport}),!p&&(0,l.tZ)(e8,{senderId:n,sender:r,location:o,receiver:this.props.receiver})]});return(0,l.tZ)(W.hw,{config:this.slotConfig,children:y})}}]),n}(m.Component);(0,c._)(ta,"propTypes",{senderId:_().string,className:_().string});var tc=(0,X.withRouter)((0,T.connect)(function(e,t){var n=t.senderId,r=e.chat.chats[n]||{},o=r.receiver,i=r.sender,a=r.warning;return{receiver:void 0===o?{}:o,sender:void 0===i?{}:i,warning:void 0===a?{}:a}},{getAccountInfo:J.fn,getEcomProfile:E.tw,showNotification:Z.c0})(ta)),ts=function(e){(0,s._)(n,e);var t=(0,u._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return(0,a._)(n,[{key:"componentDidUpdate",value:function(){var e=this.props,t=e.isModalShow,n=e.memberHashId,r=e.resetHistoryMessages;!t&&n&&r({senderId:n})}},{key:"render",value:function(){var e=this.props,t=e.memberHashId,n=e.isModalShow,r=e.handleCloseModal;return(0,l.tZ)(d.Z,{className:"ChatBoxModal",spread:!0,onClose:r,styles:{content:{padding:"0px"},inner:{overflow:"visible"},root:{width:718}},closeButton:(0,l.tZ)(p.ZP,{preset:"plain",className:"ChatBoxModal-closeButton",onClick:r,"aria-label":"关闭",children:(0,l.tZ)(f.ZP,{className:"ChatBoxModal-closeIcon"})}),children:n&&(0,l.tZ)(z,{senderId:t,entryName:"ChatBoxModal",children:(0,l.tZ)(tc,{type:"default",senderId:t,className:"Chat-ChatBox"},t)})})}}]),n}(m.Component);(0,c._)(ts,"propTypes",{memberHashId:_().string,handleCloseModal:_().func,isModalShow:_().bool});var tu=(0,T.connect)(null,{resetHistoryMessages:E.$x})(ts)},57029:function(e,t,n){"use strict";n.d(t,{En:function(){return d},Ng:function(){return l},XP:function(){return f},eS:function(){return p},e5:function(){return u}});var r=n(85879),o=n(87641),i=n(87363),a=n(44169),c=(0,i.memo)(function(e){var t=e.time;if(!t)return null;var n=new Date(t);return(0,r.tZ)("time",{dateTime:n.toISOString(),children:new Date().getTime()-Number(n)<864e5?(0,a.Jd)(n):(0,a.ht)(n)})}),s=n(60051),u=function(e){var t=e.className,n=e.children;return(0,r.tZ)(o.kC,{className:t,sx:{position:"relative",minWidth:"710px",minHeight:"600px",flexDirection:"column"},children:n})},l=function(e){var t=e.children;return(0,r.tZ)(o.kC,{as:"header",fontSize:"15px",lineHeight:"20px",height:"50px",m:"0 14px",pb:"9px",pt:"21px",alignItems:"center",justifyContent:"center",fontWeight:"bold",sx:{borderBottom:"1px solid",borderColor:"GBK09A"},children:t})},d=function(e){var t=e.children;return(0,r.tZ)(o.xu,{flex:"auto",height:"362px",children:t})},p=function(e){var t=e.time;return(0,r.tZ)(o.xu,{pt:"15px",textAlign:"center",fontSize:"12px",lineHeight:"20px",color:"GBK06A",children:(0,r.tZ)(c,{time:t})})};function f(e){var t=e.className,n=e.message,i=e.isReceiver,a=e.user,c=e.renderAvatar,u=void 0===c?function(e){return(0,r.tZ)(s.Z,{linkProps:{},user:e||{},size:40})}:c,l=e.renderMessage;return(0,r.BX)(o.kC,{className:t,m:"20px",alignItems:"flex-start",flexDirection:i?"row-reverse":"initial",children:[(0,r.tZ)(o.kC,{alignItems:"center",children:null==u?void 0:u(a)}),(0,r.tZ)(o.kC,{m:"0 10px",alignItems:"center",flexDirection:i?"row-reverse":"initial",children:(null==l?void 0:l(n))||null})]})}},96268:function(e,t,n){"use strict";n.d(t,{Z:function(){return eG}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),u=n(85879),l=n(70877),d=n(99178),p=n(14168),f=n.n(p),h=n(87363),_=n(92258),m=n(14914),g=n(55536),T=n(19235),E=n(73086),y=n(91486),C=n(64011),S=n(87641),I=n(63638),A=n(57730),b=n(70400),w=n(57665),Z=n(60051),x=n(31467),k=n(25452),R=n(67927),N=n(84210),O=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),(e=t.call(this)).handleShieldUser=e.handleShieldUser.bind((0,r._)(e)),e}return(0,i._)(n,[{key:"handleShieldUser",value:function(){var e=this.props,t=e.dispatch,n=e.user.urlToken,r=e.onClose;t((0,N.cR)(n,!0)).then(function(){return t((0,R.c0)("屏蔽成功"))}),r()}},{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.shown,r=e.user;return(0,u.tZ)(x.Z,{onClose:t,title:"确定要屏蔽".concat(r.name,"？"),children:n&&(0,u.BX)("div",{children:["屏蔽后，已有关注关系将被解除，对方不能再关注你、向你发私信、查看个人主页动态、评论你的实名回答、使用「@」提及你、邀请你回答问题等。但仍可以查看你的公开信息。",(0,u.BX)(x.w,{direction:"horizontal",children:[(0,u.tZ)(k.ZP,{onClick:t,color:"grey",children:"取消"}),(0,u.tZ)(k.ZP,{preset:"primary",color:"blue",onClick:this.handleShieldUser,children:"确定"})]})]})})}}]),n}(h.Component),P=(0,_.connect)()(O),D=n(68354),L=n(3426),M=n(67814),B=n.n(M),U=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.showReport,n=e.className,r=e.onReportClick,o=e.onMessageDelete,i=e.onMultiSelectClick;return(0,u.BX)("ul",{className:B()("ActionMenu",n),children:[(0,u.tZ)("li",{className:"ActionMenu-item",onClick:o,children:"删除"}),t&&(0,u.tZ)("li",{className:"ActionMenu-item",onClick:r,children:"举报"}),t&&(0,u.tZ)("li",{className:"ActionMenu-item",onClick:i,children:"多选"})]})}}]),n}(h.Component);(0,a._)(U,"propsTypes",{className:f().string,showReport:f().bool,onMessageDelete:f().func.isRequired,onReportClick:f().func.isRequired,onMultiSelectClick:f().func.isRequired});var G=(0,h.forwardRef)(function(e,t){var n=e.isOpen,r=e.onToggleMenu,o=e.onDeleteClick,i=e.onReportClick,a=e.onMultiSelectClick,c=e.showReport;(0,h.useEffect)(function(){if(n)return window.addEventListener("wheel",r),function(){window.removeEventListener("wheel",r)}},[n,r]);var s=(0,h.useCallback)(function(e){e.stopPropagation(),r()},[r]);return(0,u.BX)(u.HY,{children:[(0,u.tZ)("button",{type:"button",onClick:s,"aria-label":"更多",ref:t,className:"Chat-ActionMenuPopover-Button",children:(0,u.tZ)(D.AZ,{className:"Message-status--more"})}),(0,u.tZ)(L.Z,{isOpen:n,fixed:!0,arrowed:!0,target:null==t?void 0:t.current,children:(0,u.tZ)(U,{onMessageDelete:o,onReportClick:i,onMultiSelectClick:a,showReport:c})})]})}),F=n(60683),H=n(30994),z=n(84267),q=n(55164),V=n(57477),W=n(94009),X=n(74135),K=n(19860),j=n(89578),Y=n(98606),Q=n(65733),J=n(53967),$=n.n(J),ee=n(69383),et=function(e){var t=e.message,n=(0,h.useRef)(),r=(0,W._)((0,h.useState)(!1),2),o=r[0],i=r[1];return(0,u.tZ)(S.xv,{ref:n,color:o?"inherit":"primary",css:{cursor:o?"text":"pointer"},onClick:function(){o||(i(!0),ee.Z.trackEvent(n.current,{action:"Click",id:6880}))},dangerouslySetInnerHTML:{__html:o?t.richText||t.text:t.extraContent}})},en=(0,h.memo)(function(e){var t=e.message,n=e.senderId,r=e.sendMessage,o=function(e){var t,n,r=null===(t=e.match(/"zhihu:\/\/popup_container.*?"/))||void 0===t?void 0:t[0];if(r)return function(e,t){var n,r,o=null===(n=decodeURIComponent(null===(r=null==t?void 0:t.split("url="))||void 0===r?void 0:r[1]))||void 0===n?void 0:n.slice(0,-1);if(!$()(o))return e;var i=new URL(o);if("/appview/help_center/answer_pop"===i.pathname){var a='"'.concat(window.location.origin,"/help-center/faqId/-2?").concat(i.search,'"');return e.replace(t,a)}return e.replace(t,i.href)}(e,r);var o=null===(n=e.match(/"zhihu:\/\/community\/short_pin_editor.*?"/))||void 0===n?void 0:n[0];if(o)return function(e,t){var n,r,o=(null===(n=decodeURIComponent(null===(r=null==t?void 0:t.split("?"))||void 0===r?void 0:r[1]))||void 0===n?void 0:n.slice(0,-1)).match(/tab=pin(&amp;|&)pinId=([^"&]+)/);if(o){var i=o[2],a='"'.concat(window.location.origin,"/upload-video?id=").concat(i,'"');return e.replace(t,a)}return e}(e,o)}(t.richText)||t.text,i=(0,I.useTracker)(),a=(0,Q.A)(function(e){var t=e.target.closest("a");if(t&&t.href){var o=t.href;i.trackEvent({action:"OpenUrl",eventType:"Click",elementLocation:{type:"Text",moduleId:"private_message_link",text:t.textContent}},{link:{url:o}});var a=new URLSearchParams(o.split("?")[1]).get("message"),c=o.match(/www.zhihu.com\/inbox\/([\d\w]+)/);(null==c?void 0:c[1])&&n===c[1]&&(e.preventDefault(),r({contentType:F.wF.text,receiverId:n,data:{text:a}}))}});return(0,u.tZ)(I.ZAShow,{zaType:"Block",zaModuleId:"private_message_block",className:B()("TextMessage",{"TextMessage-sender":"sender"===t.userType,"TextMessage-receiver":"receiver"===t.userType}),children:t.unfriendly&&"sender"===t.userType?(0,u.tZ)(et,{message:t}):(0,u.tZ)(S.xv,{onClick:a,dangerouslySetInnerHTML:{__html:o}})})}),er=function(e){var t,n=e.data,r=void 0===n?{}:n,o=e.title;return{cardData:(0,V._)((0,q._)({},r),{name:r.name||o,coverPath:r.cover}),sendModalData:(0,V._)((0,q._)({},r),{name:r.name||o,submitText:null==r?void 0:null===(t=r.formFields)||void 0===t?void 0:t.submitText})}},eo=function(e){var t=e.senderId,n=e.message,r=e.isEcomMerchant,o=(0,_.useDispatch)(),i=(0,_.useSelector)(function(e){var t;return null===(t=e.account.accountInfo)||void 0===t?void 0:t.phoneNo}),a=(0,W._)((0,h.useState)({}),2),c=a[0],s=a[1],l=(0,W._)((0,h.useState)(!1),2),d=l[0],p=l[1],f=function(e){var t=e.info;if(r&&"receiver"===n.userType){o((0,R.c0)("商家不能参与自己发起的活动哦"));return}s((0,q._)({},t)),p(!0)},m=(0,h.useMemo)(function(){return(0,X.camelizeKeys)(n)},[n]),g=m.ecomCard,T=void 0===g?{}:g,y=(0,h.useMemo)(function(){return er(T)},[T]),C=function(){p(!1)},S=function(e){var n=e.cardType,r=e.modalData;if(1===n){var i=r.token,a=r.phone;o((0,E.RW)({contentType:"ecomcard",token:i,data:{receiverId:t,phone:a}})).then(function(){C()}).catch(Y.Z)}};return(0,u.BX)(u.HY,{children:[1===T.cardType&&(0,u.tZ)(K.Z,{result:(0,V._)((0,q._)({},y.cardData),{id:m.id}),extra:{},isInMessage:!0,hasClickZA:!r||r&&"sender"===n.userType,onClick:function(){return f({type:"event",info:y.sendModalData,camelMessage:m})}}),2===T.cardType&&(0,u.tZ)(en,{message:(0,V._)((0,q._)({},n),{text:"web 上暂不支持优惠券消息，请至 app 查看"})}),d&&(0,u.tZ)(j.Z,{eventData:c,extra:{originPhone:i},onSubmit:function(e){return S({cardType:1,modalData:e})},onClose:C})]})},ei=n(99447),ea=function(e){return new RegExp(/https:\/\/www.zhihu.com\/inbox\/+[\s\S]*?is_ecom=1/).test(e)},ec=function(e){var t=e.senderId,n=e.message,r=e.isEcomMerchant,o=void 0!==r&&r,i=(0,_.useDispatch)(),c=(0,I.useTracker)().trackEvent,s=(0,W._)((0,h.useState)(""),2),l=s[0],d=s[1],p=(0,Q.A)(function(e){if(!e)return"";var t=new DOMParser().parseFromString(e,"text/html"),n=t.querySelectorAll("a");if(!n.length)return"";n.forEach(function(e){ea(e.href)&&e.setAttribute("data-za-not-track-link",!0)}),d(t.querySelector("body").innerHTML)});(0,h.useEffect)(function(){p(n.richText||n.text)},[p,n]);var f=function(e){var r,o=n.id,c=n.contentType;i((0,E.bG)({contentType:c,receiverId:t,data:(r={},(0,a._)(r,c,n[c]),(0,a._)(r,"text",e.target.text||"问题等待配置"),r),tempMessageId:o}))},m=(0,Q.A)(function(e){var t=e.target,r=t.tagName,a=t.href;if("A"===r){if(a&&!ea(a))return;if(e.stopPropagation(),e.preventDefault(),o&&"receiver"===n.userType){i((0,R.c0)("您不可以点击自己的卡片哦"));return}ee.Z.trackEvent(e.target,{id:9969,action:"Click",name:"欢迎语卡片"},{module:[{card:{content:{type:"Message",id:String(n.id)}}}]}),c({block:"EcomWelcome",action:"Unknown",eventType:"Click",elementLocation:{type:"Text",content:{type:"Message",id:n.id}}}),f(e)}});return(0,u.tZ)("div",{className:B()("TextMessage","EcomWelcomeTextMessage",{"TextMessage-sender":"sender"===n.userType,"TextMessage-receiver":"receiver"===n.userType}),children:(0,u.tZ)(I.ZAEnv,{block:"MessageEcomWelcomeCard",content:{type:"Message",id:n.id},children:(0,u.tZ)(I.ZAShow,{zaType:"Card",zaAction:"Unknown",zaText:"交付欢迎语卡片",zaEventType:"Unknown",onClick:m,children:(0,u.tZ)(ei.r,{trackCardShow:!0,view:{id:9968,name:"欢迎语卡片"},extra:{module:[{card:{content:{id:String(n.id)}}}]},children:(0,u.tZ)(S.xv,{dangerouslySetInnerHTML:{__html:l}})})})})})},es=n(81037),eu=n(81956),el=function(e){var t=e.message,n=t.csevaluationCard,r=void 0===n?{}:n,o=r.material,i=r.isChecked,a=r.title,c=r.subTitle,s=t.id,l=(0,W._)((0,h.useState)(void 0!==i&&i),2),d=l[0],p=l[1],f=(0,W._)((0,h.useState)(void 0===o?[]:o),2),_=f[0],m=f[1],g=(0,W._)((0,h.useState)([]),2),T=g[0],E=g[1],y=(0,eu.Z)(),C=d?"感谢您的评价":a,I=d?"我们已收到您的评价，感谢您的意见":c,A=(0,h.useMemo)(function(){return d?T.filter(function(e){return e.isChecked}):T},[d,T]),b=(0,h.useMemo)(function(){return d?_.filter(function(e){return e.isChecked}):_},[d,_]),w=(0,h.useMemo)(function(){return _.findIndex(function(e){return e.isChecked})},[_]),Z=w>=0&&!d;return(0,h.useEffect)(function(){var e;E((null===(e=_.find(function(e){return e.isChecked}))||void 0===e?void 0:e.labels)||[])},[_]),(0,u.BX)(S.xu,{textAlign:"center",width:252,children:[(0,u.tZ)(S.xv,{fontSize:"17px",fontWeight:"bold",color:"GBK02A",children:C}),(0,u.tZ)(S.xv,{fontSize:"14px",color:"GBK06A",mt:"12px",children:I}),(0,u.tZ)(S.kC,{justifyContent:d?"center":"space-between",mt:20,children:b.map(function(e,t){return(0,u.BX)(S.kC,{css:{cursor:"pointer"},justifyContent:"center",alignItems:"center",flexDirection:"column",children:[(0,u.tZ)(S.Ee,{alt:"表情".concat(t),onClick:function(){d||m(function(e){return e.map(function(e,n){return(0,V._)((0,q._)({},e),{isChecked:n===t})})})},size:44,src:e.isChecked?e.selectedIcon:e.disableIcon}),(0,u.tZ)(S.xv,{mt:"12px",color:"GBK06A",fontSize:"14px",children:e.title})]},t)})}),!!A.length&&(0,u.tZ)(S.kC,{justifyContent:"space-between",mt:"22px",css:{flexWrap:"wrap"},children:null==A?void 0:A.map(function(e,t){return(0,u.tZ)(es.ZP,{onClick:function(){d||E(function(e){return e.map(function(e,n){return(0,V._)((0,q._)({},e),{isChecked:n===t^e.isChecked})})})},css:{width:"124px",height:"32px",marginBottom:"4px"},preset:"secondary",color:e.isChecked?"blue":"grey",size:"small",children:e.name},t)})}),Z&&(0,u.tZ)(es.ZP,{preset:"primary",color:"blue",size:"spread",css:{marginTop:"11px"},onClick:function(){var e=T.filter(function(e){return e.isChecked}).map(function(e){return e.id});y("/api/v4/messages/".concat(s,"/evaluation"),{method:"post",body:{selected_material:w,selected_labels:e}}).then(function(){p(!0)})},children:"提交"})]})},ed=function(e){var t=e.message,n=e.senderId;return(0,u.tZ)(S.kC,{justifyContent:"center",alignItems:"center",maxWidth:400,children:(0,u.tZ)(S.xu,{bg:"GBK10A",p:"24px 62px",css:{borderRadius:"8px"},children:(0,u.tZ)(el,{message:void 0===t?{}:t,senderId:n})})})},ep=n(36100),ef=n(26124),eh=n(4991),e_=n(74024),em=function(e){var t=e.csKnowledgeInfo,n=e.id,r=(0,eu.Z)(),o=(0,W._)((0,h.useState)(t.solveStatus||0),2),i=o[0],a=o[1],c=function(e){r("/api/v4/messages/".concat(n,"/evaluation"),{method:"post",body:{selected_material:e,scene:"cs_knowledge"}}).then(function(){})},s=function(e){return{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:e.colors.GBK10A,display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer"}},l=function(){i||(a(1),c(1))},d=function(){i||(a(2),c(2))};return(0,u.tZ)("div",{css:function(e){return{svg:{width:"12px",height:"12px",color:e.colors.MapText06A}}},children:1===i?(0,u.tZ)("div",{css:function(e){return(0,V._)((0,q._)({},s(e)),{svg:{color:e.colors.MapBrand}})},children:(0,u.tZ)(ep.Z,{})}):2===i?(0,u.tZ)("div",{css:function(e){return(0,q._)({},s(e))},children:(0,u.tZ)(ef.Z,{})}):(0,u.BX)(I.ZAShow,{zaType:"Button",zaModuleId:"message_machine_ans_vote_btn",css:function(e){return{"> div":s(e)}},view:{elementLocation:{content:{type:"Message",id:n}}},children:[(0,u.tZ)(I.ZAClick,{zaModuleId:"message_machine_ans_vote_btn",zaType:"Button",zaAction:"Upvote",css:{marginBottom:"4px"},onClick:function(){l()},view:{elementLocation:{content:{type:"Message",id:n}}},children:(0,u.tZ)(eh.Z,{})}),(0,u.tZ)(I.ZAClick,{zaModuleId:"message_machine_ans_vote_btn",zaType:"Button",zaAction:"Downvote",onClick:function(){d()},view:{elementLocation:{content:{type:"Message",id:n}}},children:(0,u.tZ)(e_.Z,{})})]})})},ev=n(79852),eg=n(5543),eT=function(e){var t=e.image,n=(0,W._)((0,h.useState)(null),2),r=n[0],o=n[1],i=t.url||"",a=(0,h.useCallback)(function(){var e=t||{width:0,height:0},n=e.width,r=e.height,o=r/n;return r>F.g1||n>F.g1?o>1?{height:"".concat(F.g1,"px"),minWidth:"".concat(F.WG,"px")}:o<1?{width:"".concat(F.g1,"px"),minHeight:"".concat(F.WG,"px"),height:F.g1*o}:{height:"".concat(F.g1,"px"),width:"".concat(F.g1,"px")}:{maxWidth:"".concat(F.g1,"px"),maxHeight:"".concat(F.g1,"px"),width:n,height:r}},[t]),c=(0,h.useCallback)(function(e){return e.startsWith("blob")},[]),s=(0,h.useCallback)(function(e){c(i)||o(e.target)},[i,c]),l=(0,h.useCallback)(function(){o(null)},[]);return(0,u.BX)(u.HY,{children:[(0,u.tZ)(eg.pt,{alt:"",scene:"message",className:B()("ImageMessage",{"ImageMessage--temp":c(i)}),src:i,onClick:s,style:a()}),(0,u.tZ)(ev.Z,{img:r,onClose:l})]})},eE=n(57029),ey=n(96652),eC=n(44812),eS=(0,h.memo)(function(e){var t=e.item,n=e.onListItemClick;return(0,u.tZ)(I.ZAClick,{as:S.xv,zaType:"Text",zaBlock:"CardListItem",onClick:function(){n(t)},color:"GBL07A",py:"12px",pr:14,pl:12,fontSize:14,sx:function(e){return{"&:last-child":{borderRadius:" 0px 0px 8px 8px"},"&:not(:last-child)":{boxShadow:"inset 0px -0.5px 0px ".concat(e.colors.GBK09B)},"&:hover":{backgroundColor:e.colors.GBK09A,cursor:"pointer"}}},children:t})}),eI=function(e){var t=e.card,n=e.replySource,r=e.onListItemClick,o=t.title,i=t.refresh,a=t.list,c=t.pageSize,s=(0,W._)((0,h.useState)(0),2),l=s[0],d=s[1],p=(0,h.useMemo)(function(){return a.slice(l,l+c)},[a,l,c]),f=(0,h.useCallback)(function(){d(l+c>=a.length?0:l+c)},[l,c,a.length]);return(0,u.tZ)(I.ZAEnv,{block:"CardMessage",extra:{configMap:{replySource:"".concat(n)}},children:(0,u.BX)(I.ZAShow,{zaType:"Block",as:S.xu,className:"CardMessage",bg:"GBK10A",css:function(e){return{position:"relative",width:"388px",borderRadius:"8px",marginRight:"8px",marginLeft:"8px",fontSize:"14px",lineHeight:1,"&::before":{content:'""',position:"absolute",width:"8px",height:"8px",left:"-4px",top:"14px",background:e.colors.GBK10A,transform:"rotate(45deg)"}}},children:[o&&(0,u.BX)(S.kC,{py:15,pr:14,pl:12,alignItems:"center",justifyContent:"space-between",sx:function(e){return{boxShadow:"inset 0px -0.5px 0px ".concat(e.colors.GBK09B)}},children:[(0,u.tZ)(S.xv,{color:"GBK03A",fontSize:1,fontWeight:500,children:o}),i&&(0,u.BX)(S.xv,{onClick:f,color:"GBL05A",fontWeight:500,sx:function(e){return{"&:hover":{color:e.colors.GBL07A,cursor:"pointer"}}},children:[(0,u.tZ)(eC.Z,{css:{verticalAlign:"middle"},size:18}),(0,u.tZ)("span",{css:{verticalAlign:"middle",marginLeft:"4px"},children:"换一批"})]})]}),(0,u.tZ)(S.xu,{children:p.map(function(e){return(0,u.tZ)(eS,{item:e,onListItemClick:r},e)})})]})})},eA=(0,h.memo)(function(e){var t=e.item,n=e.onListItemClick;return(0,u.BX)(I.ZAClick,{as:S.kC,zaType:"Text",zaBlock:"IconItem",alignItems:"center",justifyContent:"center",sx:function(e){return{width:"calc(25% - 9px)",height:"70px",backgroundColor:e.colors.GBK10A,borderRadius:"8px",flexFlow:"column wrap","&:hover":{backgroundColor:e.colors.GBK09A,cursor:"pointer"},"&:nth-child(n+5)":{marginTop:"12px"}}},onClick:function(){n(t.title)},children:[(0,u.tZ)(S.Ee,{src:t.icon,width:20,height:20}),(0,u.tZ)(S.xv,{color:"GBK04A",fontSize:13,width:"100%",textAlign:"center",mt:"7px",children:t.title})]})}),eb=function(e){var t=e.icons,n=e.onListItemClick;return(0,u.tZ)(I.ZAEnv,{block:"IconListMessage",children:(0,u.tZ)(I.ZAShow,{zaType:"Block",as:S.kC,className:"IconListMessage",sx:{maxWidth:"388px",flexFlow:"row wrap",justifyContent:"space-between",margin:(null==t?void 0:t.length)?"16px 8px 0 8px":"0"},children:null==t?void 0:t.map(function(e){return(0,u.tZ)(eA,{item:e,onListItemClick:n},e.title)})})})},ew=(0,h.memo)(function(e){var t=e.message,n=e.senderId,r=e.sendMessage,o=e.sender,i=e.receiver,a=e.location,c=t.plugin,s=c.pluginContent,l=c.pluginType,d=(0,X.camelizeKeys)(JSON.parse(s)),p=d.card,f=d.tabs,_=d.replySource;(0,h.useEffect)(function(){H.Z.info("PluginMessage Mount",{messageId:t.id,pluginType:l,hasCard:!!p,hasTabs:!!f,pluginContent:s})},[t.id,l,p,f,s]);var m=(0,h.useCallback)(function(e){r({contentType:F.wF.text,receiverId:n,replySource:_,data:{text:e}})},[n,r,_]),g=(0,h.useMemo)(function(){return{message:t,sender:o,receiver:i,sendMessage:r,location:a,pluginContent:s}},[t,o,i,r,a,s]);return l===F.AX.GUESS_YOU_WANT_ASK?(0,u.tZ)(I.ZAEnv,{block:"PluginMessage",children:(0,u.BX)(S.xu,{className:"PluginMessage",children:[(0,u.tZ)(eI,{card:p,replySource:_,onListItemClick:m}),(0,u.tZ)(eb,{icons:f,onListItemClick:m})]})}):(0,u.tZ)(ey.Oc,{slotKey:"MessageBubblePlugin.".concat(l),props:g})}),eZ=n(36892),ex="3d198a56310c02c4a83efb9f4a4c027e",ek=["https://www.zhihu.com/staffService/"+ex],eR=(0,h.createContext)({showModal:!1,setShowModal:function(){return null}});function eN(e){var t=e.item,n=e.selected,r=e.onClick,o=(0,Q.A)(function(){return r(t)});return(0,u.tZ)(k.ZP,{label:t.name,color:n?k.rp.Blue:k.rp.Grey,preset:k.EE.Secondary,css:{marginRight:"8px"},onClick:o},t.id)}function eO(e){var t=e.senderId,n=e.showModal,r=e.onClose,o=(0,W._)((0,h.useState)([]),2),i=o[0],a=o[1],c=(0,W._)((0,h.useState)(null),2),s=c[0],l=c[1],d=(0,_.useDispatch)(),p=(0,eu.Z)();(0,h.useEffect)(function(){n&&p("/api/v4/customer_service/question_tag",{ignoreCode:!0}).then(function(e){var t;a((null===(t=e.payload)||void 0===t?void 0:t.data)||[])}).catch(function(){return null})},[n,p]);var f=(0,Q.A)((0,eZ.N)(function(e){p("/api/v4/customer_service/choose_question_tag",{method:"POST",body:{adminId:ex,tagId:e.id},ignoreCode:!0}).catch(function(){return null}),d((0,E.bG)({contentType:F.wF.text,receiverId:t,data:{text:e.name}})),r(),l(null)},300)),m=(0,Q.A)(function(e){l(e.id),f(e)});return(0,u.tZ)(x.Z,{css:{width:"694px",".Modal-content":{padding:"0 0 55px 0",marginTop:0}},onClose:r,children:n&&(0,u.BX)(u.HY,{children:[(0,u.tZ)("div",{css:function(e){return{padding:"12px 0 10px 20px",fontSize:"20px",lineHeight:"28px",borderBottom:"1px solid "+e.colors.GBK09A,color:e.colors.GBK02A}},children:"选个问题类型，小管家为你解答"}),i.map(function(e){return(0,u.BX)(h.Fragment,{children:[(0,u.tZ)("div",{css:function(e){return{marginTop:"20px",paddingLeft:"20px",fontSize:"15px",lineHeight:"18px",color:e.colors.GBK03A}},children:e.categoryName}),(0,u.tZ)("div",{css:{marginTop:"16px",paddingLeft:"20px"},children:e.items.map(function(e){return(0,u.tZ)(eN,{item:e,selected:s===e.id,onClick:m},e.id)})})]},e.categoryId)})]})})}var eP=function(e){var t=e.message,n=e.onRequestReport,r=e.onRequestBlock,o=(0,h.useRef)(),i=(0,h.useContext)(eR),a=i.showModal,c=i.setShowModal;return(0,u.tZ)(S.xv,{ref:o,m:"20px auto",p:"10px 12px",bg:"GBK10A",color:"GBK07A",maxWidth:388,minHeight:40,fontSize:12,sx:{lineHeight:"20px",borderRadius:"8px",a:{color:"primary"}},dangerouslySetInnerHTML:{__html:(0,h.useMemo)(function(){return t.text.replace("https://www.zhihu.com/report?report_location=1","#report").replace("http://www.zhihu.com/defriend","#block")},[t.text])},onClick:function(e){var t=e.target.href;t&&((e.preventDefault(),n&&t.endsWith("#report"))?(n(),ee.Z.trackEvent(o.current,{action:"Click",id:6882})):r&&t.endsWith("#block")?(r(),ee.Z.trackEvent(o.current,{action:"Click",id:6883})):ek.includes(t)?a||c(!0):t.includes("/consult/sendCard")||t.includes("/consult/me/settings")?A.Z.alert("PC 端暂不支持该操作，请打开 App 操作"):window.open(t,"_blank"))}})},eD=n(88423),eL=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props.sticker.url;return(0,u.tZ)("img",{className:"StickerMessage",src:(0,eD.imgUrl)(e,"xl"),alt:""})}}]),n}(h.Component);(0,a._)(eL,"propTypes",{sticker:f().shape({id:f().string,url:f().string})});var eM=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"ref",(0,h.createRef)()),(0,a._)((0,r._)(e),"state",{isMoreActionMenuShow:!1,isShieldUserModalShown:!1}),(0,a._)((0,r._)(e),"handleDocClick",function(t){!e.state.isMoreActionMenuShow||!e.ref.current||e.ref.current.contains(t.target)||(t.stopPropagation(),t.preventDefault(),e.setState({isMoreActionMenuShow:!1}))}),(0,a._)((0,r._)(e),"toggleMoreActionMenu",function(){e.setState({isMoreActionMenuShow:!e.state.isMoreActionMenuShow})}),(0,a._)((0,r._)(e),"handleMessageDelete",function(){var t=e.props,n=t.deleteMessage,r=t.message.id,o=t.sender.id;A.Z.confirm((0,u.tZ)("div",{style:{textAlign:"center"},children:"是否删除该条消息"}),{title:"删除消息"}).then(function(){return n(r,o)},function(){})}),(0,a._)((0,r._)(e),"handleReSendMessage",function(){var t=e.props,n=t.deleteLocalMessage,r=t.sender.id,o=t.sendMessage,i=t.message,c=i.id,s=i.contentType;if(H.Z.info("开始重试消息",{messageId:c,contentType:s,receiverId:r}),s!==F.wF.ecomcard){if(s!==F.wF.image)H.Z.info("重试文本消息",{messageId:c}),n(c,r),o({contentType:s,receiverId:r,data:(0,a._)({},s,i[s]),tempMessageId:c});else{var u=i.image.url;if(u.startsWith("blob")){var l=i.file,d=e.props,p=d.uploadImage,f=d.setImageSendFailure;H.Z.info("重新上传图片",{tempMessageId:c,fileSize:l.size,retryType:"with_file"});var h=Date.now();p(l).then(function(e){var t=Date.now()-h;return H.Z.info("重试上传成功",{tempMessageId:c,imageUrl:e.payload.src,retryTime:t}),o({contentType:F.wF.image,receiverId:r,data:{image:{height:e.payload.dataRawheight,width:e.payload.dataRawwidth,url:e.payload.src}},tempMessageId:c}).then(function(t){var n,r;return H.Z.info("重试消息发送成功",{tempMessageId:c,finalMessageId:null==t?void 0:null===(n=t.payload)||void 0===n?void 0:null===(r=n.info)||void 0===r?void 0:r.id,imageUrl:e.payload.src}),t}).catch(function(t){throw H.Z.info("重试消息发送失败",{tempMessageId:c,imageUrl:e.payload.src,error:t.message||"Unknown error"}),t})}).then(function(){URL.revokeObjectURL(u)}).catch(function(e){var t=Date.now()-h;H.Z.info("重试上传失败",{tempMessageId:c,retryTime:t,error:e.message||"Unknown error"}),f({tempMessageId:c,receiverId:r,file:l})})}else H.Z.info("重试已上传图片消息",{messageId:c,imageUrl:u,retryType:"with_existing_url"}),o({contentType:s,receiverId:r,data:(0,a._)({},s,i[s]),tempMessageId:c})}}}),(0,a._)((0,r._)(e),"handleReSendIconClick",function(){A.Z.confirm(null,{title:"是否重新发送消息"}).then(function(){e.handleReSendMessage()},function(){})}),(0,a._)((0,r._)(e),"renderMessage",function(t){var n=e.props,r=n.sender.id,o=n.isEcomMerchant,i=n.sendMessage,a=t.isEcomWelcomeCard;return t.contentType===F.wF.text?a?(0,u.tZ)(ec,{senderId:r,message:t,isEcomMerchant:o}):(0,u.tZ)(en,{message:t,senderId:r,sendMessage:i}):t.contentType===F.wF.image?(0,u.tZ)(eT,{image:t.image}):t.contentType===F.wF.sticker?(0,u.tZ)(eL,{sticker:t.sticker}):t.contentType===F.wF.ecomcard?(0,u.tZ)(eo,{senderId:r,message:t,isEcomMerchant:o}):t.contentType===F.wF.plugin?(0,u.tZ)(b.SV,{replacement:(0,u.tZ)(S.xu,{children:"无法识别的消息"}),children:(0,u.tZ)(ew,{senderId:r,message:t,sendMessage:i,sender:e.props.sender,receiver:e.props.receiver,location:e.props.location})}):t.contentType===F.wF.csevaluationcard?(0,u.tZ)(ed,{message:t,senderId:r}):"web 上暂不支持此类消息，请至 app 查看"}),(0,a._)((0,r._)(e),"handleReportClick",function(){var t=e.props,n=t.toggleSelectMessage,r=t.toggleReportModal;n(!0,t.message),r()}),(0,a._)((0,r._)(e),"renderMessageStatus",function(t){var n=e.props.onMultiSelectClick;if(t===F.Gs.success){var r=e.state.isMoreActionMenuShow,o="receiver"===e.props.message.userType;return(0,u.tZ)("div",{className:"Message-status--wrapper",children:(0,u.tZ)(G,{ref:e.ref,isOpen:r,onToggleMenu:e.toggleMoreActionMenu,onDeleteClick:e.handleMessageDelete,onReportClick:e.handleReportClick,onMultiSelectClick:n,showReport:!o})})}return t===F.Gs.loading?(0,u.tZ)(w.Z,{className:"Message-status--loading"}):t===F.Gs.failure?(0,u.tZ)(C.G,{className:"Message-status--failure",onClick:e.handleReSendIconClick}):null}),(0,a._)((0,r._)(e),"selectStateChange",function(t){var n=e.props,r=n.toggleSelectMessage,o=n.message;r(t.currentTarget.checked,o)}),(0,a._)((0,r._)(e),"renderMessageByType",function(){var t=e.props,n=t.message,r=t.receiver,o=t.multiSelectMode,i=t.isMessageSelected,a=t.sender,c=t.hideMessageStatus,s=n.userType,l=n.id,d=n.status,p=n.contentType,f=n.extraInfo,h=(void 0===f?{}:f).csKnowledgeInfo,_=void 0===h?null:h;if(F.wF.csevaluationcard===p)return(0,u.tZ)(S.kC,{width:"100%",justifyContent:"center",children:e.renderMessage(n)});var m="receiver"===s,g=m?r:a,T=!m&&o;return(0,u.tZ)(eE.XP,{className:"Message",message:n,isReceiver:m,renderAvatar:function(){return(0,u.BX)(u.HY,{children:[T&&(0,u.tZ)(y.C,{css:{borderRadius:"50%",marginRight:22},checked:i,onChange:e.selectStateChange}),(0,u.tZ)(Z.Z,{user:g,size:40})]})},renderMessage:function(){return(0,u.BX)(u.HY,{children:[e.renderMessage(n),!c&&!_&&(0,u.tZ)("div",{className:"Message-status",children:e.renderMessageStatus(d)}),_&&(0,u.tZ)("div",{css:{alignSelf:"flex-end"},children:(0,u.tZ)(em,{csKnowledgeInfo:_,id:l})})]})}})}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleDocClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleDocClick)}},{key:"render",value:function(){var e=this,t=this.props,n=t.message,r=t.sender,o=n.type,i=n.showTime,a=n.createdTime,c=this.state.isShieldUserModalShown,s=(0,u.tZ)(u.HY,{children:i&&(0,u.tZ)(eE.eS,{time:a})});return"risk_tip"===o||"tip"===o?(0,u.BX)(u.HY,{children:[s,c&&(0,u.tZ)(P,{shown:c,onClose:function(){return e.setState({isShieldUserModalShown:!1})},user:r}),(0,u.tZ)(eP,{message:n,onRequestReport:this.handleReportClick,onRequestBlock:function(){e.setState({isShieldUserModalShown:!0})}})]}):(0,u.tZ)(I.ZAEnv,{block:"Message",content:{type:"Message",id:String(n.id)},children:(0,u.BX)("div",{className:"Message-wrapper",children:[s,this.renderMessageByType()]})})}}]),n}(h.Component);(0,a._)(eM,"propsTypes",{message:f().object,sender:f().object,receiver:f().object});var eB=(0,_.connect)(null,{deleteMessage:E.$Z,deleteLocalMessage:E.Rn,sendMessage:E.bG,setImageSendFailure:E.Hf,uploadImage:z.Z})(eM),eU=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{showQuestionTagModal:!1}),(0,a._)((0,r._)(e),"scrollToBottom",function(){e.messageBoxEle&&(e.messageBoxEle.scrollTop=e.messageBoxEle.scrollHeight)}),(0,a._)((0,r._)(e),"handleGetHistoryMessage",function(t){var n=e.props,r=n.isLoading,o=n.getHistoryMessages,i=n.senderId,a=n.isEnd;!t||r||a||o({senderId:i})}),(0,a._)((0,r._)(e),"setShowQuestionTagModal",function(t){return e.setState({showQuestionTagModal:t})}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.getHistoryMessages,n=e.senderId,r=e.messages,o=e.setMessageRead,i=e.sender,a=e.location.query;0!==r.length&&(void 0===i?{}:i).id?this.scrollToBottom():t({senderId:n,clientScene:a.client_scene,messageBizName:a.message_biz_name,messageBizExtInfo:a.message_biz_ext_info}).catch(function(){location.href="//www.zhihu.com/messages"}),o(n)}},{key:"componentDidUpdate",value:function(e){var t=e.messages,n=void 0===t?[]:t,r=this.props,o=r.messages,i=r.setMessageRead,a=r.senderId,c=n[n.length-1]||{},s=o[o.length-1]||{};c.id!==s.id&&(this.scrollToBottom(),"sender"===s.userType&&i(a));var u=e.sender,l=(void 0===u?{}:u).id,d=this.props.sender;(void 0===d?{}:d).id!==l&&this.scrollToBottom()}},{key:"render",value:function(){var e=this,t=this.props,n=t.messages,r=t.receiver,o=t.sender,i=void 0===o?{}:o,a=t.senderId,c=t.isLoading,s=t.isEcomMerchant,p=t.multiSelectMode,f=t.selectedMessages,h=t.onMultiSelectClick,_=t.toggleSelectMessage,m=t.toggleReportModal,g=t.hideMessageStatus,T=this.state.showQuestionTagModal;return i.id?(0,u.BX)(eR.Provider,{value:{showModal:T,setShowModal:this.setShowQuestionTagModal},children:[(0,u.tZ)(d.ZP,{isLoading:c,onLoad:this.handleGetHistoryMessage,placeholder:(0,u.tZ)(l.Z,{className:"MessagesBox-loading"}),isPrevDrained:!1,isDrained:!0,getContainer:function(e){return e},className:"MessagesBox",onRef:function(t){e.messageBoxEle=t},children:n.map(function(t){return(0,u.tZ)("div",{children:(0,u.tZ)(eB,{message:t,receiver:r,sender:i,isEcomMerchant:s,multiSelectMode:p,isMessageSelected:f.find(function(e){return e.id===t.id}),toggleSelectMessage:_,onMultiSelectClick:h,toggleReportModal:m,hideMessageStatus:g,location:e.props.location})},t.tempMessageId||t.id)})}),(0,u.tZ)(eO,{showModal:T,onClose:function(){return e.setShowQuestionTagModal(!1)},senderId:a})]}):(0,u.tZ)(l.Z,{className:"MessagesBox-loading"})}}]),n}(h.Component);(0,a._)(eU,"PropsTypes",{senderId:f().string});var eG=(0,g.compose)(m.withRouter,(0,_.connect)(function(e,t){var n=t.senderId,r=e.chat.chats[n]||{},o=r.receiver,i=r.sender,a=r.messages,c=r.isLoading,s=r.isEnd;return{receiver:void 0===o?{}:o,sender:void 0===i?{}:i,messages:void 0===a?[]:a,isLoading:void 0!==c&&c,isEnd:void 0===s||s,isEcomMerchant:(e.chat.chats||{}).isEcomMerchant}},{getHistoryMessages:E.fb,setMessageRead:E.BI}),(0,T.Z)())(eU)},60683:function(e,t,n){"use strict";n.d(t,{AX:function(){return c},Gs:function(){return i},HG:function(){return a},WG:function(){return p},X:function(){return l},YX:function(){return s},g1:function(){return d},wF:function(){return u}});var r=n(55164),o=n(94009),i={success:"success",failure:"failure",loading:"loading"},a={0:"text",1:"image",2:"sticker",5:"csevaluationcard",6:"ecomcard",7:"plugin"},c=(0,r._)({GUESS_YOU_WANT_ASK:"GUESS_YOU_WANT_ASK"},{ZHI_PLUS_MSG_GROUP_PLUGIN_FORM:"ZHI_PLUS_MSG_GROUP_PLUGIN_FORM",ZHI_PLUS_MSG_GROUP_PLUGIN_WX:"ZHI_PLUS_MSG_GROUP_PLUGIN_WX",ZHI_PLUS_MSG_GROUP_QA:"ZHI_PLUS_MSG_GROUP_QA",ZHI_PLUS_MSG_GROUP_PLUGIN_CAL:"ZHI_PLUS_MSG_GROUP_PLUGIN_CALL"}),s=Object.entries(a).reduce(function(e,t){var n=(0,o._)(t,2),r=n[0];return e[n[1]]=Number(r),e},{}),u={text:"text",image:"image",sticker:"sticker",ecomcard:"ecomcard",plugin:"plugin",csevaluationcard:"csevaluationcard",title:"title"},l=3e5,d=320,p=20},30994:function(e,t,n){"use strict";n(49899);var r=new Proxy({},{get:function(){return function(){}}});t.Z=r},84267:function(e,t,n){"use strict";var r=n(42308),o=n(30994);t.Z=function(e){return o.Z.info("5️⃣ 调用上传服务",{uploadId:"message",blobSize:e.size}),(0,r.Ix)(e,"message","message")}},84344:function(e,t,n){"use strict";var r=n(87363),o=n(14168),i=n.n(o),a=n(92258),c=n(31252);function s(e){var t=e.content,n=e.type,o=e.urlToken,i=(0,a.useDispatch)(),s=(0,r.useCallback)(function(){i((0,c.Ll)({content:t,type:n,urlToken:o}))},[i,t,n,o]),u=(0,a.useSelector)(function(e){return(0,c.G_)(e,{type:n,urlToken:o})});return(0,r.useEffect)(function(){u||s()},[u,s]),null}s.propTypes={content:i().string.isRequired,type:i().oneOf(["answer","article"]).isRequired,urlToken:i().string.isRequired},t.Z=s},50436:function(e,t,n){"use strict";function r(e){var t,n,r,o;return!!(null==e?void 0:null===(t=e.coCreation)||void 0===t?void 0:null===(n=t.refTo)||void 0===n?void 0:null===(r=n.contents)||void 0===r?void 0:null===(o=r[0])||void 0===o?void 0:o.type)}function o(e){var t,n,o,i;return!r(e)&&!!(null==e?void 0:null===(t=e.reference)||void 0===t?void 0:null===(n=t.refTo)||void 0===n?void 0:null===(o=n.contents)||void 0===o?void 0:null===(i=o[0])||void 0===i?void 0:i.type)}function i(e){var t,n,r,o=null==e?void 0:null===(t=e.coCreation)||void 0===t?void 0:null===(n=t.refTo)||void 0===n?void 0:null===(r=n.contents)||void 0===r?void 0:r[0];return o?"answer"===o.type?o.answer:"article"===o.type?o.article:null:null}function a(e){var t,n,r,o=null==e?void 0:null===(t=e.reference)||void 0===t?void 0:null===(n=t.refTo)||void 0===n?void 0:null===(r=n.contents)||void 0===r?void 0:r[0];return o?"answer"===o.type?o.answer:"article"===o.type?o.article:null:null}function c(e,t){var n=t.contentAuthor;return n&&e.id!==(null==n?void 0:n.id)?n:e}function s(e){var t,n;return r(e)&&null!==(n=null===(t=i(e))||void 0===t?void 0:t.author)&&void 0!==n?n:null}n.d(t,{AQ:function(){return c},Ey:function(){return i},Gz:function(){return o},HE:function(){return r},YJ:function(){return s},y5:function(){return a}})},61255:function(e,t,n){"use strict";n.d(t,{ZY:function(){return Y},xJ:function(){return l},j7:function(){return H},_N:function(){return M},HE:function(){return r.HE},SF:function(){return V}});var r=n(50436),o=n(55164),i=n(57477),a=n(85879),c=n(87641),s=n(24405),u=n(23579),l=function(e){var t=(0,s.F)();return(0,a.tZ)(c.kC,(0,i._)((0,o._)({width:"58px",height:"20px",bg:(0,u.a)(t.colors.GYL01A).alpha(.08),color:t.colors.GYL01A,alignItems:"center",justifyContent:"center",css:{fontWeight:"normal",fontSize:12,borderRadius:4,overflow:"hidden"}},e),{children:"联合创作"}))},d=n(99878),p=n(63638),f=n(65733),h=n(87363),_=n.n(h),m=n(66980),g=Object.assign,T=function(e){return _().createElement(m.Z,g({width:"20",height:"20",fill:"none",viewBox:"0 0 20 20"},e),_().createElement("path",{fill:"url(#id-1711650925-a)",fillRule:"evenodd",d:"M2.8 2a.8.8 0 0 0-.8.8v11.4a.8.8 0 0 0 .8.8h11.4a.8.8 0 0 0 .8-.8V2.8a.8.8 0 0 0-.8-.8H2.8Zm1.051 1.25a.6.6 0 0 0-.6.6v9.3a.6.6 0 0 0 .6.6h9.3a.6.6 0 0 0 .6-.6v-9.3a.6.6 0 0 0-.6-.6h-9.3Z",clipRule:"evenodd"}),_().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M2.8 2a.8.8 0 0 0-.8.8v11.4a.8.8 0 0 0 .8.8h11.4a.8.8 0 0 0 .8-.8V2.8a.8.8 0 0 0-.8-.8H2.8Zm1.051 1.25a.6.6 0 0 0-.6.6v9.3a.6.6 0 0 0 .6.6h9.3a.6.6 0 0 0 .6-.6v-9.3a.6.6 0 0 0-.6-.6h-9.3Z",clipRule:"evenodd"}),_().createElement("rect",{width:"13",height:"13",x:"4.5",y:"4.5",fill:"url(#id-1711650925-b)",rx:".8"}),_().createElement("rect",{width:"13",height:"13",x:"4.5",y:"4.5",fill:"#06F",rx:".8"}),_().createElement("path",{fill:"#fff",stroke:"#fff",d:"M8.962 11.153h.725V13.5H8.3v-2.754c0-.66.293-1.181.7-1.567.064-.06.129-.116.196-.168a2.654 2.654 0 0 0-.205.227c-.295.369-.53.864-.53 1.415v.5h.5ZM12.974 11.153h.726V13.5h-1.387v-2.754c0-.66.293-1.181.7-1.567.063-.06.129-.116.195-.168a2.657 2.657 0 0 0-.204.227c-.295.369-.53.864-.53 1.415v.5h.5Z"}),_().createElement("defs",null,_().createElement("linearGradient",{id:"id-1711650925-a",x1:"15",x2:"2",y1:"2",y2:"15",gradientUnits:"userSpaceOnUse"},_().createElement("stop",{stopColor:"#06F"}),_().createElement("stop",{offset:"1",stopColor:"#00D1FF"})),_().createElement("linearGradient",{id:"id-1711650925-b",x1:"17.5",x2:"4.5",y1:"4.5",y2:"17.5",gradientUnits:"userSpaceOnUse"},_().createElement("stop",{stopColor:"#06F"}),_().createElement("stop",{offset:"1",stopColor:"#00D1FF"}))))},E=n(66263);function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,n=e.title,r=e.question,o=(void 0===r?{}:r).title,i=e.url,s=e.id,u=(0,f.A)(function(){window.open(i)});return(0,a.tZ)(p.ZAEnv,{content:{type:E.LA[t],token:String(s)},children:(0,a.BX)(p.ZAClick,{shouldTrackShow:!0,zaText:"zvideo_origin_content",zaType:"Card",zaAction:"OpenUrl",extra:{link:{url:i}},as:c.kC,bg:"GBK10A",padding:"12px 10px 12px 18px",justifyContent:"space-between",onClick:u,css:{cursor:"pointer"},children:[(0,a.BX)(c.kC,{children:[(0,a.tZ)(T,{css:{marginRight:"6.5px"}}),(0,a.tZ)(c.xv,{color:"GBK06A",fontSize:"14px",lineHeight:"19.6px",children:"answer"===t?"原回答：".concat(o):"原文章：".concat(n)})]}),(0,a.tZ)(d.N,{size:20,css:function(e){return{flexShrink:"0",fill:e.colors.GBK06A}}})]})})}var C=n(94009),S=n(55698),I=n(82452),A=n(80565),b=n(24187),w=n(92258),Z=n(31467),x=n(30722),k=n(80714),R=n(28814),N=n(41492),O=n(46829),P=function(e){var t=e.author,n=t.author,r=t.identity,o=t.id,i=(0,w.useSelector)(function(e){return(0,R.np)(e,{urlToken:n})}),s=i||{},u=s.avatarUrl,l=s.isFollowing,d=s.name,f=(0,h.useRef)(),_=(0,h.useCallback)(function(){return window.open("https://www.zhihu.com/people/".concat(n))},[n]),m=(0,h.useCallback)(function(){return f.current.trackEvent({eventType:"Click",elementLocation:{type:"Button",text:l?"取消关注":"关注"},action:l?"UnFollow":"Follow"}),!0},[l]);return i?(0,a.BX)(p.ZAEnv,{content:{type:"User",token:n,id:o},children:[(0,a.tZ)(p.ZARef,{ref:f}),(0,a.BX)(c.kC,{mt:"16px",css:{"& + &":{marginTop:"24px"}},alignItems:"center",children:[(0,a.tZ)(S.qE,{url:u,size:38,css:{cursor:"pointer"},onClick:_}),(0,a.BX)(c.xu,{ml:"14px",flex:"1",children:[(0,a.tZ)(c.xu,{color:"GBK03A",fontSize:"15px",lineHeight:"17px",fontWeight:"bold",onClick:_,css:[(0,A.S)(1),{cursor:"pointer"}],children:d}),(0,a.tZ)(c.xu,{color:"GBK04A",fontSize:"14px",lineHeight:"16px",mt:"3px",children:r})]}),(0,a.tZ)(O.Z,{useCustomZa:!0,preset:"primary",type:"people",id:n,isFollowing:l,onClick:m,css:{padding:"0 14px",minWidth:"0px"}})]})]}):null},D=function(e){var t,n,r,o,i,s=e.item,u=e.index;if("ANSWER"===s.type)r="Answer",o=(i=s.answer).question.title;else{if("ARTICLE"!==s.type)return null;r="Post",o=(i=s.article).title}var l=i.id,d=i.thumbnailInfo,f=i.url,h=i.voteupCount,_=i.commentCount,m=null==d?void 0:null===(t=d.thumbnails)||void 0===t?void 0:null===(n=t[0])||void 0===n?void 0:n.url,g="".concat((0,x.Zh)(h),"赞同 \xb7 ").concat((0,x.Zh)(_),"评论");return(0,a.tZ)(p.ZAEnv,{content:{type:r,id:String(l)},children:(0,a.BX)(p.ZAClick,{as:"a",view:{elementLocation:{card:{index:u}}},zaType:"Card",zaAction:"OpenUrl",zaText:"视频引用的原文",extra:{link:{url:f}},href:f,target:"_blank",css:function(e){return{marginTop:"16px",display:"flex",alignItems:"center",height:"84px",borderRadius:"8px",padding:"0 12px",backgroundColor:e.colors.GBK10A}},children:[m&&(0,a.tZ)(c.Ee,{src:m,width:"60px",height:"60px",mr:"12px",css:{borderRadius:"6px"}}),(0,a.BX)(c.xu,{flex:"1",children:[(0,a.tZ)(c.xu,{fontWeight:"bold",fontSize:"15px",css:(0,A.S)(1),children:o}),(0,a.tZ)(c.xu,{color:"GBK06A",fontSize:"13px",children:g})]})]})})},L=function(e){var t,n,r=e.id,o=e.subAuthor,i=e.before,s=e.after,u=e.content,l=u||{},f=l.type,_=l.id,m=E.LA[f],g=(0,w.useDispatch)(),y=(0,w.useSelector)(function(e){return e.zvideos.creationReferences[r]}),x=(0,C._)((0,h.useState)(!1),2),R=x[0],O=x[1],L=(0,h.useCallback)(function(){k.Z.isMobileEntry?(0,I.rH)("zhihu://zvideo/".concat(r)):(O(!0),g((0,N.jl)(r)))},[g,r]);return o?(0,a.BX)(a.HY,{children:[(0,a.tZ)(p.ZAEnv,{block:"CreationReferencesBar",content:u?{type:m,token:String(_)}:{},children:(0,a.BX)(p.ZAShow,{zaText:!0,shouldTrackClick:!0,zaType:"Card",as:c.kC,onClick:L,justifyContent:"space-between",alignItems:"center",pl:"16px",pr:"10px",py:"12px",color:"GBK06A",bg:"GBK10A",fontSize:"14px",lineHeight:"20px",css:{whiteSpace:"pre-wrap",cursor:"pointer"},children:[(0,a.BX)(c.kC,{children:[(0,a.tZ)(T,{css:{marginRight:"6.5px"}}),(0,a.tZ)(c.xu,{flexShrink:"0",children:i}),(0,a.BX)(c.kC,{alignItems:"center",mx:"6px",children:[(0,a.tZ)(S.qE,{url:o.avatarUrl,round:!0,size:18,css:function(e){return{border:"1px solid ".concat(e.colors.GBK99A)}}}),(0,a.tZ)(c.xu,{flex:"1",ml:"6px",css:(0,A.S)(1),children:o.name})]}),(0,a.tZ)(c.xu,{flexShrink:"0",children:s})]}),(0,a.tZ)(d.N,{size:20,css:{flexShrink:"0"}})]})}),!k.Z.isMobileEntry&&(0,a.tZ)(Z.Z,{onClose:function(){return O(!1)},title:"引用详情",children:R&&(y?(0,a.BX)(p.ZAEnv,{block:"CreationReferencesModal",children:[(0,a.tZ)(c.xu,{fontSize:"15px",fontWeight:"bold",children:"作者"}),null===(t=y.authors)||void 0===t?void 0:t.map(function(e){return(0,a.tZ)(P,{author:e},e.author)}),(0,a.tZ)(c.xu,{my:"24px",css:function(e){return{borderTop:"1px solid ".concat(e.colors.GBK10A)}}}),(0,a.tZ)(c.xu,{fontSize:"15px",fontWeight:"bold",children:"视频引用的原文"}),null===(n=y.originalContent)||void 0===n?void 0:n.map(function(e,t){return(0,a.tZ)(D,{item:e,index:t},t)})]}):(0,a.BX)(a.HY,{children:[(0,a.tZ)(b.O,{variant:"P01"}),(0,a.tZ)(b.O,{variant:"T02"})]}))})]}):null},M=function(e){var t=e.id,n=e.creationRelationship;if(!n)return null;if((0,r.HE)(n)){var i,c=(0,r.Ey)(n);return(null!==(i=null==c?void 0:c.author)&&void 0!==i?i:null)&&(0,a.tZ)(y,(0,o._)({},c))}if(!(0,r.Gz)(n))return null;var s,u=(0,r.y5)(n),l=null!==(s=null==u?void 0:u.author)&&void 0!==s?s:null,d=(null==u?void 0:u.type)==="answer"?"回答":"文章";return l&&(0,a.tZ)(L,{id:t,subAuthor:l,before:"本视频引用",after:"的".concat(d,"进行创作"),content:u})},B=n(29229),U=n(70400),G=function(e){var t=e.zvideo,n=t.id,r=t.imageUrl,o=t.author,i=t.video,a=t.playCount,c=t.voteupCount,s=e.stats,u=s.memberCount,l=s.count;return{zvideoId:n,thumbnail:r,duration:i.duration,avatarUrl:o.avatarUrl,userName:o.name,memberCount:u,videoCount:l,playCount:a,voteupCount:c}};function F(e){var t=e.coCreationRefBy,r=e.referenceRefBy,o=e.type,i=!!t,c=!i&&!!r,s=(0,B._)(function(){return n.e(7970).then(n.bind(n,34178))});if(i){if(!s)return(0,a.tZ)("div",{css:{height:82}});var u=G(t),l=u.zvideoId,d=u.thumbnail,p=u.duration,f=u.avatarUrl,h=u.userName,_=u.memberCount,m=u.videoCount,g=u.playCount,T=u.voteupCount;return(0,a.tZ)(s.CoCreationCard,{zaContentId:l,thumbnail:d,duration:p,avatarUrl:f,userName:h,isMultiMember:_>1,videoCount:m,playCount:g,voteupCount:T,linkToNativePage:!1,linkUrl:"https://www.zhihu.com/zvideo/".concat(l),showSingleVideoUI:!0})}if(c){if(!s)return(0,a.tZ)("div",{css:{height:44}});var E=G(r),y=E.zvideoId,C=E.avatarUrl,S=E.userName,I=E.memberCount;return(0,a.tZ)(s.ReferenceCard,{type:o,zaContentId:y,avatarUrl:C,userName:S,isMultiMember:I>1,linkToNativePage:!1,linkUrl:"https://www.zhihu.com/zvideo/".concat(y),showSingleVideoUI:!0})}return null}function H(e){return(0,a.tZ)(U.SV,{replacement:null,children:(0,a.tZ)(F,(0,o._)({},e))})}var z=n(77683),q=function(e){var t,n=e.mainAuthor,r=e.subAuthor,s="plain"===(t=e.preset)||"special-plain"===t;return(0,a.BX)(c.kC,{mt:"10px",children:[(0,a.tZ)(z.Z,(0,i._)((0,o._)({},s&&{preset:"plain"}),{author:n,coCreationAuthorDescriptionText:"视频作者",userLinkV2:!0,noBadge:!0,noVipBadge:!0,showVipIcon:!1,css:{marginRight:s?16:30}})),(0,a.tZ)(z.Z,(0,i._)((0,o._)({},s&&{preset:"plain"}),{author:r,coCreationAuthorDescriptionText:"图文作者",userLinkV2:!0,noBadge:!0,noVipBadge:!0,showVipIcon:!1}))]})};function V(e,t,n,o){var i=(0,r.AQ)(t,n),c=(0,r.YJ)(n);return o&&(0,a.tZ)(q,{preset:e,mainAuthor:i,subAuthor:c},"coCreateAuthors")}var W=n(9338),X=n(30971),K=n(57730),j=(0,n(4661).FH)("coCreation",["CANCEL"]);function Y(e){var t,n=e.contentType,r=e.contentId,o=(0,w.useDispatch)(),i=(t=(0,W._)(function(){return(0,X.__generator)(this,function(e){switch(e.label){case 0:return[4,K.Z.confirm("",{title:"你确定要取消联合创作吗？",text:{ok:"同意"}})];case 1:return e.sent(),[4,o({API:{types:j.CANCEL,endpoint:"creation-relationship/cancel",method:"PUT",body:{content_type:n,content_id:String(r)}}})];case 2:return e.sent(),window.location.reload(),[2]}})}),function(){return t.apply(this,arguments)});return(0,a.tZ)(p.ZAClick,{zaType:"Button",zaText:!0,zaBlock:"CancelCoCreation",onClick:i,children:"取消联合创作"})}},94382:function(e,t,n){"use strict";n.d(t,{Z:function(){return k}});var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(55698),s=n(72111),u=n(67814),l=n.n(u),d=n(92769),p=n.n(d),f=n(87641),h=n(78580),_=n(66263),m=n(7407),g=n(77236),T=n(65733),E=n(33773),y=n(87363),C=n(92258),S=n(69383),I=n(44169),A=n(91770),b=n(84778),w=n(10886),Z=n(31142);function x(e){var t=e.toggler,n=e.id,c=(0,i._)(e,["toggler","id"]),s=(0,C.useDispatch)(),u=(0,C.useSelector)(function(e){return e.entities.columns[n]}),l=!!(0,C.useSelector)(function(e){return e.loading.local})["column/".concat(n)],d=(0,y.useRef)(),p=function(){if(d.current&&u){var e;S.Z.setModule(d.current,{module:"ColumnItem"},{card:{content:{type:"Column",token:u.id,item_num:u.articlesCount,follower_num:u.followers,publish_timestamp:1e3*u.updated,author_member_hash_id:null===(e=u.author)||void 0===e?void 0:e.id}}}),S.Z.trackCardShow(d.current)}},m=(0,T.A)(function(){s((0,w.ly)(n)),p()}),x=u||{},k=x.title,R=x.excerpt,N=x.itemsCount,O=x.voteupCount,P=x.lastArticle,D=x.articlesCount,L=x.followers,M=P||{},B=M.title,U=M.created,G="".concat(_.i7,"/column/").concat(n);return(0,a.BX)(g.Z,(0,o._)((0,r._)({toggler:t,preventCloseOnTarget:!0,isLoading:l,onOpen:m,size:"large"},c),{ref:d,children:[(0,a.tZ)(g.O,{title:(0,b.x)(u)?(0,a.BX)(f.kC,{alignItems:"center",children:[(0,a.tZ)(h.Z,{}),(0,a.tZ)("a",{target:"_black",href:G,children:k})]}):(0,a.tZ)("a",{target:"_black",href:G,children:k})}),(0,a.tZ)("p",{css:{wordBreak:"break-all"},children:R}),P&&(0,a.BX)("div",{children:[(0,a.tZ)(E.ZP,{text:!0,center:!0})," 最后更新",(0,a.tZ)("span",{className:"HoverCard-separate",children:" | "}),B,(0,a.BX)("span",{children:["（",(0,I.rL)(U),"）"]})]}),(0,a.tZ)("div",{children:(0,a.BX)(A.Z,{children:[(0,a.tZ)(A.Z.Item,{tag:Z.Z,preset:"plain",a:!0,to:G,name:N>=0?"内容":"文章",value:null!=N?N:D}),(0,a.tZ)(A.Z.Item,{tag:Z.Z,preset:"plain",a:!0,to:G,name:O>=0?"赞同":"关注",value:null!=O?O:L})]})})]}))}function k(e){var t,n=e.column,u=e.avatar,d=e.avatarProps,g=e.noHoverCard,T=e.style,E=e.className,y=e.children,S=e.useCustomZa,I=e.hidePaidLabel,A=(0,i._)(e,["column","avatar","avatarProps","noHoverCard","style","className","children","useCustomZa","hidePaidLabel"]),w=(0,C.useSelector)(function(e){return(0,m.Hu)(e,{includeTablet:!0})}),Z=n.id,k=n.imageUrl,R=n.title;return(t=void 0!==u&&u?(0,a.tZ)(c.qE,(0,r._)({url:k,alt:R},d)):(0,b.x)(n)&&!I?(0,a.BX)(f.kC,{alignItems:"center",children:[(0,a.tZ)(h.Z,{}),(0,a.tZ)(f.xv,{flex:1,children:y||R})]}):y||R,(void 0===g?w:g)||(t=(0,a.tZ)(x,{toggler:t,id:Z})),w&&_.dd)?t:S?(0,a.tZ)("a",(0,o._)((0,r._)({style:T,className:l()("ColumnLink",E),href:"".concat(_.i7,"/column/").concat(Z)},p()(A,["dispatch"])),{children:t})):(0,a.tZ)(s._o,{zaAction:"OpenUrl",zaEventType:"Click",zaType:"Text",children:(0,a.tZ)("a",(0,o._)((0,r._)({style:T,className:l()("ColumnLink",E),href:"".concat(_.i7,"/column/").concat(Z)},p()(A,["dispatch"])),{children:t}))})}},58308:function(e,t,n){"use strict";n.d(t,{ZP:function(){return U}});var r=n(55164),o=n(57477),i=n(71728),a=n(94009),c=n(85879),s=n(8586),u=n(65733),l=n(94295),d=n.n(l),p=n(87363),f=n(39658),h=n(92258),_=n(87641),m=n(63638),g=n(31467),T=n(96200),E=n(83213),y=n(25452),C=n(9887),S=n(93547),I=n(32380),A=n(96955),b=n(10886),w=n(58909),Z=n(9338),x=n(30971),k=n(24405),R=n(70691),N=n(97234),O=n(66913),P=n(42308),D=n(38469),L=function(e){var t=e.value,n=e.setValue,o=(0,i._)(e,["value","setValue"]),a=(0,I.Z)(),s=a.handleUploadImage,u=a.handleUploadImageError;return(0,c.tZ)(T.Z,(0,r._)({defaultValue:t,setContent:function(e){n(e)},minHeight:200,maxHeight:200,onImageUpload:s,uploadImageError:u},o))},M=function(e){var t=e.required,n=e.getErrorText,o=e.initialValue,s=e.isModal,u=e.isRich,l=(0,i._)(e,["required","getErrorText","initialValue","isModal","isRich"]),d=(0,a._)((0,p.useState)(null!=o?o:""),2),f=d[0],h=d[1],m=n(f),g=!!(!m&&(!t||f)),T=(0,p.useMemo)(function(){return(0,c.BX)(_.kC,{mx:s?"0":"24px",flexDirection:"column",children:[u&&s?(0,c.tZ)(L,{value:f,setValue:h}):(0,c.tZ)(C.Z,(0,r._)({css:{width:"100%"},value:f,onChange:function(e){return h(e.target.value)}},l)),(0,c.tZ)(_.xv,{pt:"8px",pb:"9px",minHeight:"30px",color:"GRD03A",fontSize:"13px",lineHeight:1,textAlign:"end",children:m})]})},[s,f,l,m,u]);return[f,g,T]},B=function(e,t){return function(n){var r=(0,S.Xs)(n,t)-e;return r>0?"超出 ".concat(r," 个字"):(0,S.Vq)(n)?"不能包含 emoji":/^\s+$/.test(n)?"不能为纯空白字符":""}},U=function(e){var t,n,i,l,T,C,S,I,L,U,G,F,H,z=e.done,q=e.editing,V=e.columnId,W=e.isModal,X=void 0===W||W,K=e.disableRedirect,j=(0,h.useDispatch)(),Y=(0,A.Z)(),Q=(0,h.useSelector)(function(e){return e.entities.columns[V]}),J=(0,h.useSelector)(w.ib).hasApplyingColumn,$=(0,a._)(M({name:"专栏名称",required:!0,getErrorText:B(20),placeholder:"请输入专栏名称",initialValue:null==Q?void 0:Q.title,isModal:X}),3),ee=$[0],et=$[1],en=$[2],er=(0,a._)(M({name:"一句话介绍",required:!1,getErrorText:B(1e3,!0),placeholder:"请输入一句话介绍",multiline:!0,rows:4,initialValue:null==Q?void 0:Q.intro,isModal:X,isRich:!0}),3),eo=er[0],ei=er[1],ea=er[2],ec=(0,a._)((n=(t={name:"",initialValue:null==Q?void 0:Q.imageUrl,isModal:X}).initialValue,i=t.isModal,T=(l=(0,a._)((0,p.useState)(n?{template:n}:{}),2))[0],C=l[1],S=(0,h.useDispatch)(),L=(I=(0,a._)((0,p.useState)((null==T?void 0:T.template)?O.ej.SUCCESS:O.ej.BEFORE),2))[0],U=I[1],G=(0,k.F)().colors,F=(0,Z._)(function(e){var t,n;return(0,x.__generator)(this,function(r){switch(r.label){case 0:return t=e.file,[4,S((0,P.Ix)(t))];case 1:return n=r.sent().payload,U(O.ej.UPLOADING),[2,n]}})}),H=(0,c.tZ)("div",{css:{width:"150px",margin:i?0:"0 24px"},children:(0,c.BX)(N.Z,{accept:"image/*",onSuccess:function(e){var t=e.remoteInfo;C({template:t.src,id:t.hash}),U(O.ej.SUCCESS)},customUpload:function(e){return F.apply(this,arguments)},onError:function(e){e.file&&U(O.ej.ERROR)},children:[(null==T?void 0:T.template)?(0,c.tZ)(D.Z,{css:{backgroundImage:"url(".concat(T.template,")"),backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"}}):(0,c.tZ)(D.Z,{children:(0,c.tZ)(R.Z,{color:G.MapText07A})}),(0,c.tZ)("span",{css:{lineHeight:"20px",fontSize:"12px",color:G.MapText06A},children:O.Kr[L]})]})}),[T,H]),2),es=ec[0],eu=ec[1],el=(0,a._)((0,p.useState)(null==Q?void 0:Q.acceptSubmission),2),ed=el[0],ep=el[1],ef=(0,u.A)(function(e){e.preventDefault(),j((0,E.Gw)(V,(0,o._)((0,r._)({},Q),{intro:eo,title:ee,avatar:es,acceptSubmission:ed}))).then(function(){Y.alert("修改成功！该改动将在一个工作日内审核后生效。").then(z)})});return((0,p.useEffect)(function(){j((0,w.sF)(["hasApplyingColumn"]))},[j]),(0,p.useEffect)(function(){J&&Y.alert("你的专栏创建正在受理中。同时只能创建一个专栏。",{title:"你有正在创建的专栏",ok:"知道了"}).then(function(){z&&z()})},[z,J,Y]),J)?null:(0,c.BX)("div",{children:[!X&&(0,c.tZ)(f.ql,{title:q?"修改专栏介绍":"新建专栏"}),(0,c.tZ)(_.kC,{fontSize:"24px",justifyContent:"center",mt:"40px",mb:"32px",fontWeight:"bold",children:q?"修改专栏介绍":"新建专栏"}),en,ea,eu,q&&(0,c.BX)(_.kC,{justifyContent:"space-between","align-items":"center",mt:"24px",fontSize:14,color:"GBL05A",children:["接受他人自荐内容",(0,c.tZ)(s.Z,{checked:ed,onChange:function(e){ep(e.target.checked)}})]}),(0,c.BX)(g.w,{direction:"horizontal",css:{marginTop:q?32:48},children:[X&&(0,c.tZ)(y.ZP,{color:y.EE.Primary,onClick:function(){return z&&z()},children:"取消"}),(0,c.tZ)(m.ZAClick,{as:y.ZP,zaType:"Button",zaModuleId:"add_new_column_btn",type:"submit",preset:y.rp.Blue,color:y.EE.Primary,disabled:!et||!ei,onClick:q?ef:function(e){var t;e.preventDefault(),j((0,b.PG)((0,r._)({title:ee,intro:eo,intro_type:X?"rich":"plain"},(null==es?void 0:es.template)&&{images:[""===(t=es.template)?t:d()(new URL(t).pathname.split("/"))]}))).then(function(e){var t=e.res;t.payload.manualCensor?Y.alert("已收到您的申请，知乎会在 3 个工作日内处理并通过私信反馈结果。",{title:"正在审核",ok:"完成"}).then(function(){z&&z()}):(K||(location.href="https://www.zhihu.com/column/".concat(t.payload.id)),z&&z(!0))}).catch(function(e){Y.alert(e.payload.message,{title:"出错了",ok:"知道了"}).then(function(){z&&z()})})},children:q?"保存":"新建专栏"})]})]})}},35865:function(e,t,n){"use strict";var r=n(85879),o=n(74128),i=n(58308);t.Z=function(e){var t=e.onClose,n=e.shown,a=e.editing,c=e.columnId,s=e.disableRedirect;return(0,r.tZ)(o.Z,{onClose:t,size:"large",css:{".Modal-content":{margin:0}},children:n&&(0,r.tZ)(i.ZP,{isModal:!0,editing:void 0!==a&&a,columnId:c,done:t,disableRedirect:s})})}},38469:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(85879),o=n(24405),i=n(87363),a=n.n(i);function c(e){var t=e.children,n=e.className,i=(0,o.F)().colors;return(0,r.tZ)("div",{css:{width:"84px",height:"84px",borderRadius:"12px",backgroundColor:i.MapUIFrame10A,display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"4px"},className:void 0===n?"":n,children:a().Children.map(t,function(e){return e})})}},58635:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(71728),a=n(94009),c=n(85879),s=n(80565),u=n(91850),l=n(7835),d=n(65733),p=n(87363),f=n(92258),h=n(14914),_=n(87641),m=n(63638),g=n(78580),T=n(3681),E=n(50953),y=n(51921),C=function(e){return(null==e?void 0:e.columnType)==="paid_column"},S=function(e){var t=e.columns,n=e.selectedColumnId,o=e.onSelect,i=e.noSelectTips,d=e.radioSize,p=void 0===d?20:d,f=(0,m.useTracker)().trackEvent,h=(0,a._)((0,u.k)(function(){return!!n}),2),E=h[0],y=h[1],S=t[0].id,I=function(e){f({eventType:"Click",action:"Unknown",elementLocation:{type:"Button",text:null!==e?"专栏收录-".concat(t.find(function(t){return t.id===e}).title):"不发布到专栏"}}),o(e)};return(0,l.b)(function(){n&&o(n)},[n]),(0,c.BX)(_.xu,{color:"GBL05A",flex:"1",css:{fontSize:"14px"},className:"ColumnSetting-ColumnSelector",children:[(0,c.BX)(_.kC,{height:"38px",children:[(0,c.tZ)(T.KT,{checked:E,text:"发布到专栏",size:p,onChange:function(){y.on(),I(S)},id:"PublishPanel-columnLabel-1"}),(0,c.tZ)(T.KT,{checked:!E,text:"不发布到专栏",size:p,onChange:function(){y.off(),I(null)},id:"PublishPanel-columnLabel-0"})]}),E?(0,c.tZ)(T.Qr,{placement:"bottom-left",useDefaultPosition:!0,onChange:I,value:n,css:{marginTop:"5px"},children:t.map(function(e){return(0,c.tZ)(T.o3,{value:e.id,text:(0,c.BX)(_.kC,{alignItems:"center",css:{"&+svg":{flex:"0 0 auto"}},children:[(0,c.tZ)(_.xv,{css:(0,r._)({},(0,s.S)(1)),children:e.title}),C(e)&&(0,c.tZ)(g.Z,{css:{marginLeft:"4px",flex:"0 0 auto"}})]}),className:"ColumnSetting-ColumnSelector-Option"},e.id)})}):(0,c.tZ)(_.xv,{color:"GBK06A",mt:"5px",css:{fontSize:"13px",lineHeight:"18px"},children:i})]})},I=function(e){var t=e.column,n=e.onSelect;return(0,l.b)(function(){n(t.id)}),(0,c.BX)(_.kC,{alignItems:"center",css:function(e){return{color:e.colors.GBK02A,fontSize:"14px"}},className:"ColumnSetting-MatchedColumn",children:[t.title,C(t)&&(0,c.tZ)(g.Z,{css:{marginLeft:"4px"}})]})};t.Z=(0,h.withRouter)(function(e){var t,n=e.columns,s=e.location,u=e.radioSize,h=e.onSelect,m=(0,i._)(e,["columns","location","radioSize","onSelect"]),g=(0,a._)((0,p.useState)(null),2),C=g[0],A=g[1],b=n||C,w=(0,f.useDispatch)(),Z=s.query.c_id,x=null==b?void 0:null===(t=b.find)||void 0===t?void 0:t.call(b,function(e){return e.id===Z}),k=(0,E.Z)(["urlToken"]);(0,l.b)(function(){n||w((0,y.Pq)(null==k?void 0:k.urlToken)).then(function(e){var t,n;A(null==e?void 0:null===(t=e.payload)||void 0===t?void 0:null===(n=t.data)||void 0===n?void 0:n.map(function(e){return e.column}))})});var R=(0,d.A)(function(e){var t;h&&h(e,null==b?void 0:null===(t=b.find)||void 0===t?void 0:t.call(b,function(t){return t.id===e}))});return(null==b?void 0:b.length)?(0,c.BX)(_.kC,(0,o._)((0,r._)({py:"11px"},m),{children:[(0,c.tZ)(T.gN,{name:"专栏收录",className:"ColumnSetting-Field"}),x?(0,c.tZ)(I,{column:x,onSelect:R}):(0,c.tZ)(S,(0,r._)({radioSize:u,columns:b,onSelect:R},m))]})):null})},19495:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(15030),u=n(55164),l=n(79065),d=n(85626),p=n(85879),f=n(73108),h=n(82806),_=n.n(h),m=n(14168),g=n.n(m),T=n(87363),E=n(69383),y=n(63638),C=n(30722),S=n(25452),I=n(97727),A=n(80714);function b(){var e=(0,l._)(["","",""]);return b=function(){return e},e}function w(){var e=(0,l._)(["","条",""]);return w=function(){return e},e}var Z="评论",x={collapse:"收起".concat(Z),expand:"展开".concat(Z),add:"添加".concat(Z)},k=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"buttonRef",(0,T.createRef)()),(0,a._)((0,r._)(e),"handleClick",function(t){var n=e.props,r=n.zaInfos,o=r.toggleComment,i=r.getCommentAction,a=n.positionStatus,c=n.onClick,l=n.commentsShown;if(E.Z.trackEvent(e.buttonRef.current,(0,u._)({action:i?i(!l):"Comment",element:"Button",is_intent:!0},o&&{id:o})),c){var d="fixed"===a||A.Z.isMobileEntry?"fixed":"bottom",p={commentsShown:!e.props.commentsShown,commentsAutoFocus:!(0,s._)(t,KeyboardEvent),commentPattern:d};(0,s._)(t,KeyboardEvent)&&"bottom"===d&&e.buttonRef.current.focus(),c(t,p)}}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){this.props.onInstance(this)}},{key:"componentWillUnmount",value:function(){this.props.onInstance(null)}},{key:"buttonText",get:function(){var e=this.props,t=e.count,n=e.commentsShown,r=e.commentClosed,o=e.newInteract;if(n)return x.collapse;var i=t&&!r,a=(0,C.Zh)(t);return A.Z.isMobileEntry?_()(b(),Z,i?a.trim():""):i?o?a:_()(w(),a,Z):x.add}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.commentsShown,r=this.buttonText,o=n?x.collapse:x.expand;return(0,p.BX)(p.HY,{children:[(0,p.tZ)(I.bY,{input:"c",action:this.handleClick}),(0,p.tZ)(y.ZAClick,{as:S.ZP,zaAction:n?"Collapse":"Expand",zaText:o,zaBlock:o,zaModuleId:"comment_area_expand_collapse_button",zaType:"Button",onRef:this.buttonRef,preset:"plain",className:t,onClick:this.handleClick,icon:f.b,label:r})]})}}]),n}(T.Component);(0,a._)(k,"propTypes",{commentsShown:g().bool,count:g().number,zaInfos:g().shape({id:g().number,getCommentAction:g().func}),onInstance:g().func,newInteract:g().bool}),(0,a._)(k,"defaultProps",{zaInfos:{},onInstance:function(){return null}}),t.Z=k},11797:function(e,t,n){"use strict";var r=n(55164),o=n(85879),i=n(29229);t.Z=function(e){var t=(0,i._)(function(){return n.e(6815).then(n.bind(n,29246)).then(function(e){return e.default})});return t?(0,o.tZ)(t,(0,r._)({},e)):null}},97187:function(e,t,n){"use strict";n.d(t,{Z:function(){return et}});var r,o=n(85879),i=n(65733),a=n(45564),c=n(87363),s=n.n(c),u=n(92258),l=n(63638),d=n(37719),p=n(258),f=n(50953),h=n(7407),_=n(55164),m=n(29229),g=function(e,t){var n=(0,c.useRef)(!!e);return n.current!==t&&!!e===t&&(n.current=!!e),n.current},T=function(e){var t=g(e.shown,!0),r=(0,m._)(function(){return Promise.all([n.e(2090),n.e(6248),n.e(1608),n.e(8324)]).then(n.bind(n,53486))},t);return r?(0,o.tZ)(r,(0,_._)({},e)):null},E=n(57477),y=n(94009),C=n(72111),S=n(80565),I=n(7835),A=n(95951),b=n(17103),w=n(71783),Z=n(87641),x=n(30722),k=n(13554),R=n(80714),N=n(93547),O=n(60051),P=n(66980),D=Object.assign,L=function(e){return s().createElement(P.Z,D({width:"36",height:"18",fill:"none",viewBox:"0 0 36 18"},e),s().createElement("path",{fill:"#F90",d:"M35.737 2.234A2 2 0 0 0 33.751 0H9a9 9 0 0 0 0 18h16.88a9 9 0 0 0 8.938-7.948l.92-7.818Z"}),s().createElement("path",{fill:"#FF501A",d:"M33.753 2.22A2 2 0 0 0 31.765 0H9a9 9 0 0 0 0 18h14.945a9 9 0 0 0 8.945-8.006l.863-7.773Z"}))},M=function(){var e=(0,l.useTracker)();return(0,I.b)(function(){return function(){e.trackEvent({action:"ModuleDisappear",elementLocation:{type:"Block",moduleId:"hot_comments"}})}}),null},B=(0,c.forwardRef)(function(e,t){return(0,o.BX)(Z.xv,(0,E._)((0,_._)({ref:t,as:"span",color:"MapText99B",fontWeight:"bold",fontSize:"12px",width:"36px",height:"18px",ml:"6px",px:"6px"},e),{sx:(0,_._)({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative"},e.sx),children:["​",(0,o.tZ)(L,{css:{position:"absolute",inset:0}}),(0,o.tZ)(Z.xv,{as:"span",css:{position:"relative",whiteSpace:"nowrap"},children:"热评"})]}))}),U=(0,c.memo)(function(e){var t,n,r=e.data,i=e.selfId,a=e.onRequestMore,s=e.onRequestToggleLike,u=r[0],d=u.author,p=u.content,f=u.likeCount,h=(0,c.useMemo)(function(){return(0,k.k)((0,N.Vt)(p))},[p]),_=!(i&&i===(null===(t=u.author)||void 0===t?void 0:t.id))&&u.canLike,m=(0,y._)((0,c.useState)(!1),2),g=m[0],T=m[1],E=(0,y._)((0,c.useState)(!1),2),I=E[0],P=E[1],D=(0,y._)((0,c.useState)(null),2),L=D[0],U=D[1],G=(0,y._)((0,c.useState)(null),2),F=G[0],H=G[1],z=(0,y._)((0,c.useState)(null),2),q=z[0],V=z[1],W=(0,y._)((0,A.h)(),2),X=W[0],K=W[1],j=(0,b.q)(X,U);(0,c.useEffect)(function(){L&&T(L.scrollHeight>L.clientHeight+1)},[L,K]),(0,c.useEffect)(function(){var e,t;F&&q&&P((e=F.getBoundingClientRect(),t=q.getBoundingClientRect(),Math.max(e.left,t.left)<Math.min(e.right,t.right)&&Math.max(e.top,t.top)<Math.min(e.bottom,t.bottom)))},[F,q,K]);var Y=(0,o.tZ)(Z.xu,{size:24,mt:"-".concat(1,"px"),css:{borderRadius:2,overflow:"hidden",flex:"0 0 auto"},children:(0,o.tZ)(O.Z,{user:d,size:24,noBadge:!0,borderRadius:"inherit",linkProps:{target:"_blank"},onClick:function(e){e.stopPropagation()}})}),Q=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,o.BX)(Z.xu,{ref:V,as:"span",bg:"unset",css:[{alignItems:"center",flex:"0 0 auto",position:"relative",lineHeight:"".concat(22,"px")},e?{display:"inline",visibility:"hidden"}:{display:"inline-flex",marginLeft:"auto",marginTop:"-".concat(22,"px")}],children:["​",(0,o.tZ)(Z.xu,{as:"span",css:function(t){return{position:"absolute",left:-21.5,width:22.5,height:e?1:22,background:"linear-gradient(to left, ".concat(t.colors.MapUIFrame99A,", ").concat(t.colorMod(t.colors.MapUIFrame99A).alpha(0),")")}}}),(0,o.BX)(Z.xu,{pl:"10px",display:"inline-flex",alignItems:"center",justifyContent:"center",bg:"MapUIFrame99A",css:{gap:12},children:[(0,o.tZ)(B,{sx:{opacity:g||I?1:0}}),(0,o.BX)(l.ZAClick,{zaType:"Button",zaAction:u.liked?"UnUpvote":"Upvote",zaModuleId:"content_hot_comment_like_unlike",as:Z.zx,onClick:function(e){e.preventDefault(),e.stopPropagation(),null==s||s(u)},bg:"unset",p:0,disabled:!_,css:{display:"flex",alignItems:"center",gap:4,opacity:_?1:.5,cursor:_?"pointer":"default",fontWeight:"normal",fontVariantNumeric:"tabular-nums"},color:u.liked?"MapPositiveLike":"MapInfoSub",children:[(0,o.tZ)(w.ZP,{size:16}),(0,o.tZ)(Z.xv,{as:"span",fontSize:"14px",lineHeight:"20px",children:(0,x.Zh)(f)})]})]})]});return e?(0,o.BX)(Z.xu,{as:"span",ref:H,bg:"unset",css:{display:"inline-flex",alignItems:"center",position:"relative",zIndex:1,left:-1,width:1,height:"".concat(22,"px")},children:["​",(0,o.tZ)(B,{sx:{position:"absolute",left:0,lineHeight:"".concat(22,"px"),opacity:I?0:1}})]}):(0,o.tZ)(o.HY,{children:t})},J=(0,o.BX)(Z.kC,{css:{flexDirection:"column",justifyContent:"center",flex:"1 0 0"},children:[(0,o.tZ)(Z.xu,{children:(0,o.BX)(Z.xu,{ref:j,color:"GBK03A",bg:"unset",p:0,css:[{flex:"1 1 auto",fontSize:15,lineHeight:"".concat(22,"px"),cursor:"pointer",fontWeight:"normal",textAlign:"left"},(0,S.S)(2)],children:[(0,o.tZ)(C.pl,{target:"_blank",href:"https://".concat(R.Z.wwwHost,"/people/").concat(null===(n=u.author)||void 0===n?void 0:n.urlToken),mr:"10px",fontWeight:"bold",color:"inherit",onClick:function(e){e.stopPropagation()},css:{textDecoration:"none"},children:(null==d?void 0:d.name)||""}),(0,o.tZ)(Z.xv,{as:"span",dangerouslySetInnerHTML:{__html:h}}),Q(!0)]})}),Q(!1)]},p),$=(0,o.BX)(l.ZAClick,{shouldTrackShow:!0,zaType:"Block",zaModuleId:"hot_comments",as:Z.xu,mt:"12px",mb:"4px",bg:"MapUIFrame99A",css:{border:"1px solid var(--MapUIFrame10A)",borderRadius:4,cursor:"pointer",outline:"none"},tabIndex:0,onClick:function(){null==a||a(u)},children:[!1,(0,o.tZ)(M,{}),(0,o.tZ)(Z.kC,{p:"16px 20px",css:{flexDirection:"column",gap:12,alignItems:"center",justifyContent:"center",overflow:"hidden",borderRadius:"inherit"},children:(0,o.BX)(Z.kC,{css:{gap:10,alignItems:"flex-start",width:"100%"},children:[Y,J]})})]});return(0,o.tZ)(l.ZAEnv,{content:{type:"Comment",token:u.id},children:$})}),G=n(45804),F=n(99281),H=n(87441),z=n(51770),q="https://www.zhihu.com",V=n(9338),W=n(30971),X=n(9813),K=n(60713),j=function(e,t){return(0,K.Z)([e,t])},Y=(0,F.n2)({}),Q=function(e){Y.current=(0,X.Uy)(Y.current,e)},J=(r=(0,V._)(function(e,t){var n,r;return(0,W.__generator)(this,function(o){switch(o.label){case 0:return[4,(0,z.dJ)("".concat(q,"/api/v4/comment_v5/").concat(e,"s/").concat(t,"/hot_comment"),{method:"GET"})];case 1:if(!(null==(r=o.sent())?void 0:null===(n=r.data)||void 0===n?void 0:n.length))return[2];return Q(function(n){n[j(e,t)]=r.data.filter(function(e){return e.hot})}),[2]}})}),function(e,t){return r.apply(this,arguments)}),$=function(e){var t=e.entryType,n=e.entryId,r=e.isExpanded,o=(0,G.g)(),i=o.enableHotComment,a=o.hotCommentDisplayStrategy,s=!!i&&!!a&&({"always:load-from-parent":!1,"always:load-from-external":"always:load-from-external"===a,"when-expanded:load-from-external":"when-expanded:load-from-external"===a&&r})[a];return(0,c.useEffect)(function(){s&&t&&n&&J(t,n)},[t,n,s]),null},ee=function(e,t,n,r){var o=(0,u.useDispatch)(),a=(0,G.g)(),c=j(e,String(t)),s=(0,F.aO)(Y,function(e){return e[c]});return{hotComment:a.enableHotComment&&a.hotCommentDisplayStrategy?({"always:load-from-parent":r,"always:load-from-external":s,"when-expanded:load-from-external":n?s:void 0})[a.hotCommentDisplayStrategy]:null,notifyReactionChange:(0,i.A)(function(n){"answer"===e&&o((0,H.OW)(t,function(e){if(null==e?void 0:e.hotComment){var t=!0,r=!1,o=void 0;try{for(var i,a=e.hotComment[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var c=i.value;c.id===n.id&&(c.hot=n.hot,c.liked=n.liked,c.likeCount=n.likeCount)}}catch(e){r=!0,o=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw o}}}})),Q(function(e){var t=e[c];if(t){var r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;u.id===n.id&&(u.hot=n.hot,u.liked=n.liked,u.likeCount=n.likeCount)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}})}),notifyDelete:(0,i.A)(function(n){"answer"===e&&o((0,H.OW)(t,function(e){(null==e?void 0:e.hotComment)&&(e.hotComment=[])})),Q(function(e){e[c]&&(e[c]=[])})}),notifyToggleLike:(0,i.A)(function(n){var r,i=!n.liked;r=n.id,(0,z.dJ)("".concat(q,"/api/v4/comments/").concat(r,"/like"),{method:i?"POST":"DELETE"}),"answer"===e&&o((0,H.OW)(t,function(e){if(null==e?void 0:e.hotComment){var t=!0,r=!1,o=void 0;try{for(var a,c=e.hotComment[Symbol.iterator]();!(t=(a=c.next()).done);t=!0){var s=a.value;s.id===n.id&&(s.liked=i,s.likeCount+=i?1:-1)}}catch(e){r=!0,o=e}finally{try{t||null==c.return||c.return()}finally{if(r)throw o}}}})),Q(function(r){var o=r[j(e,t)];if(o){var a=!0,c=!1,s=void 0;try{for(var u,l=o[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var d=u.value;d.id===n.id&&(d.liked=i,d.likeCount+=i?1:-1)}}catch(e){c=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(c)throw s}}}})})}},et=(0,c.memo)(function(e){var t,n=e.showPackupButton,r=void 0===n||n,s=e.commentPattern,_=void 0===s?"fixed":s,m=e.className,g=e.shown,E=e.parent,y=e.isSelf,C=e.byComment,S=e.targetLink,I=e.segment,A=e.commentPlugin,b=e.onComment,w=e.onDeleteComment,Z=e.onMount,x=e.onHotCommentRequestMore,k=e.onClose,R=e.currentUser,N=e.contentExpanded,O=(0,f.Z)(["id"]),P=(0,u.useSelector)(h.cM),D=(0,i.A)(function(e){return P.oppoSearch&&!d.X.has(e)}),L=E.id,M=E.type,B=E.author,G=(0,c.useRef)(null),F=(0,c.useRef)(0),H=(0,a.D)(g);(0,c.useEffect)(function(){"bottom"===_&&g&&!H&&(F.current=window.pageYOffset)},[g,H,_]);var z=(0,i.A)(function(){k&&k(),"bottom"===_&&window.scrollTo(0,F.current)}),q=(0,i.A)(function(e){var t;null!=D&&D(e)||(0,p.Z)({trackEvent:null===(t=G.current)||void 0===t?void 0:t.trackEvent,zaV3Text:"评论弹层",noEnteringSignin:!!R,from:e})}),V=ee(M,String(L),N,E.hotComment),W=V.hotComment,X=V.notifyReactionChange,K=V.notifyDelete,j=V.notifyToggleLike,Y=(0,i.A)(function(e){X(e)}),Q=(0,i.A)(function(e,t){null==w||w(e,t),K(e)});return(0,o.BX)(o.HY,{children:[W&&(null==W?void 0:W.length)>0&&(null===(t=W[0])||void 0===t?void 0:t.hot)&&(!g&&"bottom"===_||"fixed"===_)?(0,o.tZ)(U,{selfId:null==O?void 0:O.id,entryType:M,entryId:String(L),data:W,onRequestMore:x,onRequestToggleLike:j}):null,(0,o.tZ)($,{entryType:M,entryId:String(L),isExpanded:null!=N&&N}),(0,o.tZ)(l.ZARef,{ref:G}),(0,o.tZ)(T,{shown:g,className:m,resourceId:String(L),resourceType:M,isSelf:y,author:B,segment:I,commentPattern:_,hideFoldButton:!r,hideBottomEditorShadow:!r,byComment:C,targetLink:S,commentPlugin:A,onMount:Z,onClose:z,onComment:b,onDeleteComment:Q,onCommentReaction:Y,openInApp:q})]})})},85703:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),u=n(85879),l=n(67814),d=n.n(l),p=n(87363),f=n(74128),h=n(25452),_=n(80714),m=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleSubmit",function(){var t=e.props,n=t.onSubmit,r=t.onCancel,o=t.needCancel;(void 0===o||o)&&r(),n()}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.subtitle,r=e.shown,o=e.onCancel,i=e.className,a=e.isMobile,c=e.confirmText,s=e.cancelText,l=e.showButtonHorizontal,p=e.showConfirmButtonRight,m=(0,u.tZ)(h.ZP,{preset:"primary",color:"blue",onClick:this.handleSubmit,children:c||"确认"},"confirm"),g=(0,u.tZ)(h.ZP,{onClick:o,children:s||"取消"},"cancel"),T=_.Z.isMobileEntry||a||p?[g,m]:[m,g];return(0,u.tZ)(f.Z,{wrapperClassName:"ConfirmModal-wrapper",className:d()("ConfirmModal",i),title:t,size:_.Z.isMobileEntry||a?"small":"default",subtitle:n,onClose:o,closeButton:!1,buttonGroupOnly:!0,children:r&&(0,u.tZ)(f.w,{direction:_.Z.isMobileEntry||a||l?"horizontal":"vertical",children:T})})}}]),n}(p.Component);t.Z=m},5975:function(e,t,n){"use strict";n.d(t,{Z:function(){return T}});var r=n(94009),o=n(85879),i=n(79461),a=n(7835),c=n(87363),s=n(92258),u=n(87641),l=n(63638),d=n(23593),p=n(25452),f=n(50953),h=n(81956),_=n(11556),m=n(7407),g=function(e){var t=e.id,n=e.followed,i=e.onFollowed,a=(0,r._)((0,c.useState)(n),2),s=a[0],u=a[1],f=(0,r._)((0,c.useState)(!1),2),_=f[0],g=f[1],T=(0,h.Z)(),E=(0,m.dD)(),y=function(){(0,d.J)(t,"follow_column")};return(0,o.tZ)(l.ZAClick,{zaModuleId:"follow_button",zaAction:s?"UnFollow":"Follow",as:p.ZP,zaType:"Button",zaText:!0,preset:p.EE.Primary,color:s?"grey":"blue",onClick:function(){if(E)return y();_||(g(!0),T("/api/v4/columns/".concat(t,"/").concat(s?"unfollow":"follow"),{method:"PUT"}).then(function(){u(!s),!s&&i&&i()}).finally(function(){g(!1)}))},css:{minWidth:88,height:34},children:s?"取消订阅":"订阅"})};function T(e){var t=e.type,n=e.id,r=e.onFollowed,c=(0,s.useDispatch)(),d=(0,s.useSelector)(function(e){return e.contentColumnCard["".concat(t,"-").concat(n)]})||{};(0,a.b)(function(){c((0,_.O)(t,n))});var p=(0,f.Z)(["id"]);if(!d.id)return null;var h=d.isFollowing,m=d.author,T=d.id,E=(null==m?void 0:m.id)===(null==p?void 0:p.id);return(0,o.tZ)(u.xu,{mt:"20px",children:(0,o.tZ)(l.ZAEnv,{extra:{configMap:{column_token:T}},children:(0,o.tZ)(i.Z,{column:d,zaModuleId:"column_card",rightActionButton:!E&&(0,o.tZ)(g,{followed:h,id:T,onFollowed:r})})})})}},30361:function(e,t,n){"use strict";n.d(t,{eX:function(){return b},qb:function(){return w}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(57477),l=n(71728),d=n(85626),p=n(85879),f=n(72111),h=n(67814),_=n.n(h),m=n(92769),g=n.n(m),T=n(87363),E=n(63638),y=n(20072),C=n(97727),S=n(45842),I=n(59937);function A(e){var t=e.onRef,n=e.listClassName,r=e.itemClassName,o=e.className,i=e.children,a=(0,l._)(e,["onRef","listClassName","itemClassName","className","children"]);return(0,p.tZ)("div",(0,u._)((0,s._)({ref:t,className:_()(n,o)},a),{children:T.Children.map(i,function(e){return"string"==typeof e?(0,p.tZ)("span",{className:r,children:e}):e?(0,T.cloneElement)(e,{className:_()(r,e.props.className)}):e})}))}var b=function(e){return(0,p.tZ)(A,(0,s._)({listClassName:"ContentItem-actions",itemClassName:"ContentItem-action"},e))},w=function(e){return(0,p.tZ)(A,(0,s._)({listClassName:"ContentItem-status",itemClassName:"ContentItem-statusItem"},e))},Z=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"onRef",function(t){e.domNode=t,e.props.onRef&&e.props.onRef(t)}),(0,a._)((0,r._)(e),"onAccessContent",function(t,n){n===document.activeElement&&window.open(e.props.link)}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){var e=this;(0,y.y3)(this.domNode,function(){var t=e.props,n=t.data,r=void 0===n?{}:n,o=r.type,i=r.id,a=t.lastreadTouchable;t.currentUser&&a&&o&&i&&(0,I.ZP)("article"===o?"post":o,i,I.Qm)})}},{key:"render",value:function(){var e,t=g()(this.props,["noTrackCardShow","lastreadTouchable","data","onRef","dispatch","currentUser","isLogin"]),n=t.className,r=t.title,o=t.meta,i=t.children,a=t.extra,c=t.image,d=t.link,h=(0,l._)(t,["className","title","meta","children","extra","image","link"]),m=(0,p.BX)(p.HY,{children:[r&&(0,p.tZ)(E.ZAEnv,{block:"卡片标题跳转",children:(0,p.tZ)("h2",{className:"ContentItem-title",children:(null===(e=r.props)||void 0===e?void 0:e.href)?(0,p.tZ)(f._o,{zaAction:"OpenUrl",zaEventType:"Click",zaText:"标题跳转",zaType:"Text",zaModuleId:"card_title_text",children:r}):(0,p.tZ)("span",{children:r})})}),!(!o||Array.isArray(o)&&!o.some(Boolean))&&(0,p.tZ)("div",{className:"ContentItem-meta",children:o})]});return(0,p.BX)("div",(0,u._)((0,s._)({ref:this.onRef,className:_()("ContentItem",n)},h),{children:[d&&(0,p.tZ)(C.bY,{input:"enter",action:this.onAccessContent}),c||a?(0,p.BX)("div",{className:"ContentItem-main",children:[c&&(0,p.tZ)("div",{className:"ContentItem-image",children:c}),(0,p.tZ)("div",{className:"ContentItem-head",children:m}),a&&(0,p.tZ)("div",{className:"ContentItem-extra",children:a})]}):m,i]}))}}]),n}(T.Component);t.ZP=(0,S.Z)(Z)},91708:function(e,t,n){"use strict";n.d(t,{b:function(){return b},Z:function(){return w}});var r=n(94009),o=n(85879),i=n(81037),a=n(91850),c=n(58723),s=n(94172),u=n(87363),l=n(87641),d=n(3681),p=n(55164),f=n(7835),h=n(65733),_=n(92258),m=n(31467),g=n(71728),T=function(e){var t=e.color,n=(0,g._)(e,["color"]);return(0,o.tZ)(l.xu,(0,p._)({sx:{borderBottom:"1px solid",borderColor:void 0===t?"GBK09A":t}},n))},E=n(11345),y=n(62009),C={channel:void 0,bySelf:void 0,byAi:void 0,createAt:null,province:void 0,city:void 0},S={bySelfOption:""},I=function(e){var t=e.onClose,n=e.open,a=e.handleSubmit,c=e.originInfo,s=e.options,d=(0,_.useDispatch)(),g=(0,r._)((0,u.useState)(c||C),2),I=g[0],A=g[1],b=(0,r._)((0,u.useState)(S),2),w=b[0],Z=b[1],x=(0,u.useMemo)(function(){return void 0!==I.channel||I.bySelf||I.byAi},[I]);(0,f.b)(function(){d((0,E.z)())});var k=(0,h.A)(function(e){A((0,p._)({},I,e))}),R=(0,h.A)(function(){var e=I.bySelf,t=I.createAt,n=I.province,r=I.city;return!e||t&&n&&r?(Z(S),!0):(Z({bySelfOption:"*当前填写有误，请修改后重试"}),!1)}),N=(0,h.A)(function(){R()&&(a(I),null==t||t())}),O=(0,h.A)(function(){null==t||t(),A(c||C),Z(S)});return(0,o.tZ)(m.Z,{onClose:O,title:"添加内容来源",subtitle:"根据自媒体投稿规范，发布新闻类的内容需要明确标注信息来源，请确认当前内容是否已正确添加",css:{"& .Modal-content":{padding:"0 24px 18px"}},children:n&&(0,o.BX)(l.kC,{height:"330px",flexDirection:"column",justifyContent:"space-between",children:[(0,o.tZ)(l.xu,{children:(s||y.lw).map(function(e){var t=y.gL[e];return t?(0,o.BX)(l.xu,{children:[(0,o.tZ)(t,{conentSource:I,changeConentSource:k,error:w[e]}),(0,o.tZ)(T,{})]},e):null})}),(0,o.BX)(l.xu,{children:[(0,o.BX)(l.kC,{justifyContent:"space-between",children:[(0,o.tZ)(i.ZP,{css:{padding:0,width:"48%",fontSize:"14px"},label:"取消添加",onClick:O,preset:"outline"}),(0,o.tZ)(i.ZP,{css:{padding:0,width:"48%",fontSize:"14px"},color:"blue",label:"确认添加",disabled:!x,onClick:N,preset:"primary"})]}),(0,o.tZ)(l.kC,{justifyContent:"center",mt:"14px",color:"GBL05A",fontSize:"14px",children:"添加的内容来源将会在此条内容详情页展示"})]})]})})},A=n(37127),b=(0,u.memo)(function(e){var t=e.handleSubmit,n=e.originInfo,d=e.options,p=(0,r._)((0,a.k)(!1),2),f=p[0],h=p[1],_=(0,u.useMemo)(function(){return(0,A.Gk)(n)},[n]);return(0,o.BX)(l.xu,{flex:"1",children:[_?(0,o.BX)(l.kC,{alignItems:"center",height:"100%",color:"MapInfoSub",fontSize:"14px",children:[_,(0,o.tZ)(i.ZP,{icon:c.Z,label:"修改",preset:"plain",color:"blue",css:{marginLeft:"12px"},onClick:h.on})]}):(0,o.BX)(l.kC,{alignItems:"center",py:"6px",color:"MapInfoSub",px:"8px",css:function(e){return{borderRadius:"4px",maxWidth:"530px",border:"1px solid ".concat(e.colors.MapUIFrame10A)}},children:[(0,o.tZ)(l.xv,{fontSize:"12px",lineHeight:"17px",children:"根据自媒体投稿规范，发布新闻类的内容需要明确标注信息来源，请确认当前内容是否已正确添加"}),(0,o.tZ)(i.ZP,{icon:s.Z,css:function(e){return{marginLeft:"8px",padding:0,width:"110px",fontSize:"12px",border:"none",color:"inherit",borderRadius:"4px","&:hover":{background:e.colors.GBK09A}}},label:"添加来源",onClick:h.on,preset:"outline"})]}),(0,o.tZ)(I,{onClose:h.off,open:f,handleSubmit:t,originInfo:n,options:d})]})}),w=function(e){var t=e.handleSubmit,n=e.originInfo;return(0,o.BX)(l.kC,{py:"11px",children:[(0,o.tZ)(d.gN,{name:"内容来源"}),(0,o.tZ)(b,{handleSubmit:t,originInfo:n,options:["contentOriginOption","bySelfOption"]})]})}},62009:function(e,t,n){"use strict";n.d(t,{lw:function(){return A},gL:function(){return b},Co:function(){return w}});var r=n(55164),o=n(94009),i=n(79065),a=n(85879),c=n(41402),s=n(66345),u=n(32293),l=n(73376),d=n.n(l),p=n(87363),f=n(92258),h=n(87641),_=n(91846),m=n(3681),g=n(77880),T=n(31318);function E(){var e=(0,i._)(["\n                        max-height: 300px;\n                      "]);return E=function(){return e},e}function y(){var e=(0,i._)(["\n                        max-height: 300px;\n                      "]);return y=function(){return e},e}var C=function(e){var t=e.placeholder,n=e.required;return(0,a.BX)(a.HY,{children:[t,n?(0,a.tZ)(h.xv,{color:"GRD03A",ml:"5px",children:"*"}):null]})},S=function(e){var t=e.children,n=e.className;return(0,a.tZ)(h.kC,{color:"GBK02A",fontSize:"14px",py:"10px",alignItems:"center",justifyContent:"space-between",className:n,children:t})},I=function(e){var t=e.conentSource,n=e.changeConentSource;return(0,a.BX)(S,{children:[(0,a.tZ)(m.gN,{name:"图片/视频为自行拍摄",props:{css:{width:"auto",whiteSpace:"nowrap",opacity:t.byAi?.4:1}}}),(0,a.tZ)(_.Z,{disabled:!!t.byAi,onChange:function(e){n((0,r._)({bySelf:e.target.checked},e.target.checked?{}:{createAt:void 0,province:void 0,city:void 0}))},checked:t.bySelf})]})},A=["contentOriginOption","bySelfOption","byAiOption"],b={contentOriginOption:function(e){var t=e.conentSource,n=e.changeConentSource;return(0,a.BX)(S,{children:[(0,a.tZ)(m.gN,{name:"内容信息来源",props:{css:{width:"auto",whiteSpace:"nowrap"}}}),(0,a.tZ)(g.Z,{text:t.channel?w[t.channel]:"选择具体的信息来源",onChange:function(e){return n({channel:e})},value:t.channel,css:{width:"170px","& .InputButton":{width:"170px",justifyContent:"space-between"}},children:Object.keys(w).map(function(e){return(0,a.tZ)(g.W,{css:{width:"170px"},value:e,text:w[e]},e)})})]})},bySelfOption:function(e){var t=e.conentSource,n=e.changeConentSource,r=e.error,i=(0,f.useSelector)(function(e){var t,n;return null===(t=e.common)||void 0===t?void 0:null===(n=t.cities)||void 0===n?void 0:n.cityData})||[],l=i.find(function(e){var n;return e.id===(null===(n=t.province)||void 0===n?void 0:n.id)}),_=(0,o._)((0,p.useState)((null==l?void 0:l.cities)||[]),2),m=_[0],A=_[1];return(0,a.BX)(a.HY,{children:[(0,a.tZ)(I,{conentSource:t,changeConentSource:n}),t.bySelf&&(0,a.BX)(a.HY,{children:[(0,a.BX)(S,{css:{paddingTop:0},children:[(0,a.tZ)(T.Z,{placeholder:(0,a.tZ)(C,{placeholder:"选择拍摄时间",required:!0}),css:{"& .DatePicker-Button":{padding:"4px 10px",svg:{width:"1.2em"}}},value:t.createAt&&(0,u.Z)(1e3*t.createAt),onChange:function(e){return n({createAt:d()(e).unix()})},disabledDate:function(e){return s.Z(e,(0,u.Z)(Date.now()))}}),(0,a.tZ)(h.kC,{flex:"1",children:(0,a.tZ)(c.ms,{children:function(e){var r,o=e.css;return(0,a.BX)(a.HY,{children:[(0,a.tZ)(g.Z,{text:t.province?t.province.name||(null==l?void 0:l.province):(0,a.tZ)(C,{placeholder:"省份",required:!0}),onChange:function(e){A(e.cities),n({province:{id:e.id,name:e.province},city:void 0})},value:t.province,css:{marginLeft:"10px",whiteSpace:"nowrap",".InputLike":{maxWidth:"98px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},listClassName:o(E()),children:i.map(function(e){return(0,a.tZ)(g.W,{value:e,text:e.province},e.id)})}),(0,a.tZ)(g.Z,{text:t.city?t.city.name||(null===(r=null==m?void 0:m.find(function(e){return e.id===t.city.id}))||void 0===r?void 0:r.name):(0,a.tZ)(C,{placeholder:"城市",required:!0}),onChange:function(e){return n({city:{id:e.id,name:e.name}})},value:t.city,css:{maxWidth:"98px",".InputLike":{maxWidth:"98px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},marginLeft:"4px",whiteSpace:"nowrap"},listClassName:o(y()),children:m.map(function(e){return(0,a.tZ)(g.W,{value:e,text:e.name},e.id)})})]})}})})]}),r&&(0,a.tZ)(h.kC,{color:"GRD03A",fontSize:"14px",mb:"10px",children:r})]})]})},byAiOption:function(e){var t=e.conentSource,n=e.changeConentSource;return(0,a.BX)(S,{children:[(0,a.tZ)(m.gN,{name:"图片/视频由 AI 生成",props:{css:{width:"auto",whiteSpace:"nowrap",opacity:t.bySelf?.4:1}}}),(0,a.tZ)(_.Z,{disabled:!!t.bySelf,onChange:function(e){return n({byAi:e.target.checked})},checked:t.byAi})]})}},w={officialWebsite:"官方网站",newsReport:"新闻报道",TVMedia:"电视媒体",printMedia:"纸质媒体"}},37127:function(e,t,n){"use strict";n.d(t,{Gk:function(){return s},up:function(){return c}});var r=n(55164),o=n(78160);n(9478);var i=n(62009),a={bySelf:1,byAi:2},c=function(e){if(e&&0!==Object.keys(e).length){var t=e.channel,n=e.bySelf,o=e.createAt,i=e.province,c=e.city,s=e.byAi;return(0,r._)({channel:t},n&&{method:a.bySelf,created_at:o,location:{province:i.id,city:c.id}},s&&{method:a.byAi})}},s=function(e){var t=e||{},n=t.channel,r=t.bySelf,a=t.byAi,c=t.createAt,s=t.city;if(void 0===n&&void 0===r&&void 0===a)return"";var u=n?"来源于".concat(i.Co[n]," "):"",l=r&&(c||(null==s?void 0:s.name))?"拍摄于".concat(c?(0,o.Z)(1e3*c,"yyyy-MM-dd"):""," ").concat((null==s?void 0:s.name)||""):"",d=a?"图片 / 视频由 AI 生成":"";return"".concat(u).concat(u&&(l||d)?" ":"").concat(l||d)}},24246:function(e,t,n){"use strict";n.d(t,{ZP:function(){return y},iC:function(){return g}});var r=n(20857),o=n(22107),i=n(94707),a=n(86325),c=n(85626),s=n(85879),u=n(14168),l=n.n(u),d=n(87363),p=n(92258),f=n(55536),h=n(62317),_=n(58909),m=n(26802);function g(e,t,n){var r=function(e){var t=e.id,n=e.reshipmentSettings,r=e.relationship,o=void 0===r?{}:r,i=e.isCurrentUser,a=o.isAuthor,c=o.isAuthorized;if(i||a)return{canCopy:!0,message:null};switch(n){case"disallowed":return{canCopy:!1,message:{type:"link",href:"https://www.zhihu.com/term/zhihu-terms#sec-licence-6",text:"禁止转载"}};case"need_payment":if(c)return{canCopy:!0,message:"已获授权，复制成功"};return{canCopy:!1,message:{type:"link",href:"https://www.zhihu.com/copyright/apply?answer=".concat(t),text:"申请转载"}};default:return{canCopy:!0,message:null}}}(t);return r.canCopy&&function(e,t,n){var r=(t.relationship||{}).isAuthor;if(window.getSelection){var o=window.getSelection(),i=o&&o.rangeCount>0?o.getRangeAt(0):null;if(i){var a,c,s,u,l=i.toString().trim(),d=((a=document.createElement("div")).appendChild(i.cloneContents()),a.outerHTML);if(!l||l.length<128||t.isCurrentUser||r){e||null==n||n(l);return}var p="";"article"===t.type?p="https://zhuanlan.zhihu.com/p/".concat(t.id):"answer"===t.type&&(p="https://www.zhihu.com/question/".concat(t.questionId,"/answer/").concat(t.id));var f=l.length>=512,h=(c=T(p,t.author.name,f).join("<br />"),s=f?c+d:d+c,"<div>".concat(s,"</div>")),_=(u=T(p,t.author.name,f).join("\n"),f?u+l:l+u);if(!e){null==n||n(_);return}var m=e.nativeEvent.clipboardData;if("object"==typeof m&&(m.setData("text/html",'<meta charset="utf-8">'+h),m.setData("text/plain",_),m.getData("text/plain")&&m.getData("text/plain").length>0)){e.preventDefault();return}if(o){var g=document.createElement("div");g.innerHTML=h;var E=g.firstChild;E.style.position="fixed",E.style.left="-9999px",document.body.appendChild(E),o.selectAllChildren(E),setTimeout(function(){document.body.removeChild(E),o.removeAllRanges(),o.addRange(i)},200)}}}}(e,t,n),r}function T(e,t,n){var r=["作者：".concat(t),"链接：".concat(e),"来源：知乎","著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"],o=["",""];return n?r.concat(o):o.concat(r)}var E=function(e){(0,a._)(n,e);var t=(0,c._)(n);function n(){var e;return(0,o._)(this,n),(e=t.call(this)).state={tipShown:!1,tipContent:"",tipX:0,tipY:0,tipPosition:"bottom"},e.handleMouseDown=e.handleMouseDown.bind((0,r._)(e)),e.handleCopy=e.handleCopy.bind((0,r._)(e)),e.handleTipClose=e.handleTipClose.bind((0,r._)(e)),e.rightClickX=-1,e.rightClickY=-1,e}return(0,i._)(n,[{key:"getRange",value:function(e){if(e&&e.rangeCount>0)return e.getRangeAt(0)}},{key:"randomRange",value:function(e,t){return Math.floor(Math.random()*(t-e)+e)}},{key:"showTip",value:function(e,t){if(window.getSelection){var n,r=window.getSelection(),o=this.getRange(r),i=o.toString().trim(),a=this.randomRange(44,66);if(!(i.length<=a)){e.preventDefault(),e.stopPropagation();var c=o.getBoundingClientRect(),s=window.pageYOffset,u=this.rightClickX,l=this.rightClickY,d="bottom";if(-1!==l)n=l+3;else{var p=this.props.viewPort,f=c.top+s,h=c.bottom+s,_=s+p.top+52,m=s+p.bottom-52;h<_?n=_-52:h<m?n=h:(d="top",n=f>_&&f<m?f:m+52)}var g=-1!==u?u+3:c.left+(c.right-c.left)/2-12;this.setState({tipShown:!0,tipContent:t,tipX:g,tipY:n,tipPosition:d}),this.rightClickX=-1,this.rightClickY=-1}}}},{key:"handleTipClose",value:function(){this.setState({tipShown:!1})}},{key:"handleCopy",value:function(e){var t=this.props,n=t.data,r=n.author,o=n.type,i=n.id,a=n.question,c=n.reshipmentSettings,u=n.relationship,l=t.isCurrentUser,d=g(e,{id:i,type:o,author:r,questionId:null==a?void 0:a.id,reshipmentSettings:c,relationship:u,isCurrentUser:l});if(d.message){var p="link"===d.message.type?(0,s.tZ)("a",{href:d.message.href,children:d.message.text}):d.message;this.showTip(e,p)}}},{key:"handleMouseDown",value:function(e){3===e.nativeEvent.which&&(this.rightClickX=e.pageX,this.rightClickY=e.pageY)}},{key:"render",value:function(){var e=this.props,t=e.onRef,n=e.data,r=e.tag,o=e.html,i=e.children,a=e.onClick,c=e.className,u=e.itemProp,l=e.style,d=e.prefix,p=e.ecommerce,f=e.shouldShowCatalog,_=e.shouldCatalogCollapse,g=e.richContentKey,T=e.isCurrentUser,E=e.isNovel,y=e.isExpanded,C=e.entityWords,S=e.isVideoAnswer,I=e.catalog,A=this.state,b=A.tipShown,w=A.tipContent,Z=A.tipX,x=A.tipY,k=A.tipPosition;return(0,s.BX)("div",{ref:t,onClick:a,className:c,style:l,children:[d,(0,s.tZ)(m.Z,{entityWords:C,richContentKey:g,sourceId:n.id,sourceType:n.type,paidInfo:n.paidInfo,itemProp:u,tag:r,html:o,onCopy:this.handleCopy,onMouseDown:this.handleMouseDown,className:"CopyrightRichText-richText",ecommerce:p,shouldShowCatalog:f,useCatalogV2:!0,isAuthor:T,isNovel:E,isExpanded:y,shouldCatalogCollapse:_,isVideoAnswer:S,catalog:I}),i,(0,s.tZ)(h.Z,{shown:b,timeout:1e4,hideOnClick:!0,onClose:this.handleTipClose,x:Z,y:x,position:k,content:w,className:"CopyrightRichText-tooltip"})]})}}]),n}(d.Component);E.propTypes={onRef:l().func,viewPort:l().object};var y=(0,f.compose)((0,p.connect)(function(e,t){return{isCurrentUser:(0,_.pG)(e,t.data.author)}}))(E)},26299:function(e,t,n){"use strict";n.d(t,{zV:function(){return E},sJ:function(){return k},ZP:function(){return y}});var r=n(94009),o=n(85879),i=n(16836),a=n(38151),c=n(43897),s=n(55164),u=n(57477),l=n(71728),d=n(81037),p=n(19818),f=n(67814),h=n.n(f),_=n(14168),m=n.n(_),g=function(e){var t=e.visible,n=e.children;return(0,o.tZ)("div",{className:h()("CornerAnimayedFlex",{"CornerAnimayedFlex--hidden":!t}),children:n})};g.defaultProps={visible:!0};var T=function(e){var t=e.className,n=e.visible,r=e.tooltip,i=e.children,a=(0,l._)(e,["className","visible","tooltip","children"]);return(0,o.tZ)(g,{visible:n,children:(0,o.tZ)(d.ZP,(0,u._)((0,s._)({},a),{"data-tooltip":r,"data-tooltip-position":"left","data-tooltip-will-hide-on-click":!0,className:h()(t,"CornerButton"),"aria-label":r,preset:"plain",css:function(e){return(0,u._)((0,s._)({display:"flex",alignItems:"center",justifyContent:"center",background:e.colors.GBK99A,borderRadius:"4px",width:"40px",height:"40px",color:e.colors.GBL05A},(0,p.d)(e)),{"&:hover":{background:e.colors.GBK08A}})},children:i}))})};T.propTypes={className:m().string,tooltip:m().string.isRequired,visible:m().bool,children:m().node};var E=function(e){var t=e.className,n=e.onClick,s=e.threshold,u=(0,r._)((0,a.Y)(),3),l=u[0],d=u[1],p=u[2];return(0,o.BX)(o.HY,{children:[(0,o.tZ)(T,{visible:!d&&!!p,className:t,tooltip:"回到顶部",onClick:function(e){n&&n(e),e.defaultPrevented||window.scrollTo({top:0,behavior:"smooth"})},children:(0,o.tZ)(c.z,{"aria-hidden":!0})}),(0,o.tZ)(i.Z,{children:(0,o.tZ)("div",{ref:l,css:{position:"absolute",top:0,height:void 0===s?1200:s}})})]})},y=function(e){var t=e.className,n=e.children;return(0,o.tZ)("div",{className:h()("CornerButtons",t),children:n})},C=n(22107),S=n(94707),I=n(87320),A=n(86325),b=n(85626),w=n(87363),Z=n(73480),x=function(e){(0,A._)(n,e);var t=(0,b._)(n);function n(){return(0,C._)(this,n),t.apply(this,arguments)}return(0,S._)(n,[{key:"navigationToZhiyisheng",value:function(){location.href="https://www.zhihu.com/messages/3d198a56310c02c4a83efb9f4a4c027e?message=".concat(encodeURIComponent("您好，我遇到的问题的场景是：\n具体功能是：\n具体反馈是："))}},{key:"render",value:function(){var e=this.props.className;return(0,o.tZ)(T,{className:e,tooltip:"建议反馈",onClick:this.navigationToZhiyisheng,children:(0,o.tZ)(Z.a,{"aria-label":"建议反馈"})})}}]),n}(w.Component);(0,I._)(x,"propTypes",{className:m().string});var k=x},25773:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(57477),l=n(71728),d=n(85626),p=n(85879),f=n(67814),h=n.n(f),_=n(92769),m=n.n(_),g=n(14168),T=n.n(g),E=n(87363),y=n(25452),C=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(e){var i;return(0,o._)(this,n),i=t.call(this,e),(0,a._)((0,r._)(i),"clearTimer",function(){i.timer&&window.clearInterval(i.timer)}),(0,a._)((0,r._)(i),"handleClick",function(e){i.state.isCounting||i.startTiming(e)}),i.state={countDownTime:e.countDownTime,isCounting:!1},i.isInitialState=!0,i}return(0,i._)(n,[{key:"componentDidMount",value:function(){this.props.startAtOnce&&this.startTiming()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.interceptTime,r=t.reStartTime,o=e.interceptTime,i=e.reStartTime;n!==o&&this.resetTiming(),r!==i&&(this.resetTiming(),this.startTiming())}},{key:"componentWillUnmount",value:function(){this.clearTimer()}},{key:"resetTiming",value:function(){this.clearTimer(),this.setState({countDownTime:this.props.countDownTime,isCounting:!1})}},{key:"startTiming",value:function(e){var t=this,n=this.props,r=n.event,o=n.countDownEndEvent,i=null,a=function(){t.isInitialState=!1,t.setState({isCounting:!0}),t.timer=setInterval(function(){var e=t.state.countDownTime;e<=0?(o&&o(),t.resetTiming()):t.setState({countDownTime:e-1})},1e3)};"function"==typeof r&&(i=r(e,a)),!1!==i&&a()}},{key:"renderText",value:function(){var e=this.props,t=e.initialText,n=e.resetText,r=e.countingText,o=this.state,i=o.countDownTime;return o.isCounting?r({count:i}):this.isInitialState?t:n||t}},{key:"render",value:function(){var e=m()(this.props,["initialText","resetText","countingText","startAtOnce","countDownTime","event","interceptTime","countDownEndEvent","reStartTime"]),t=e.className,n=e.disabled,r=(0,l._)(e,["className","disabled"]),o=this.state.isCounting;return(0,p.tZ)(y.ZP,(0,u._)((0,s._)({className:h()("CountingDownButton",t,{"is-counting":o})},r),{onClick:this.handleClick,disabled:n||o,children:this.renderText()}))}}]),n}(E.Component);(0,a._)(C,"propTypes",{countDownTime:T().number,startAtOnce:T().bool,initialText:T().string.isRequired,resetText:T().string,countingText:T().func.isRequired,event:T().func,countDownEndEvent:T().func,interceptTime:T().number,reStartTime:T().number}),(0,a._)(C,"defaultProps",{countDownTime:60,startAtOnce:!1,interceptTime:-1,reStartTime:-1}),t.Z=C},99365:function(e,t,n){"use strict";n.d(t,{Z:function(){return g}});var r=n(94009),o=n(85879),i=n(67814),a=n.n(i),c=n(87363),s=n(69383),u=n(31467),l=n(25452),d=n(4757),p=n(31142),f=n(30170),h=n.p+"assets/liukanshan_coin.32323a56.svg",_=n(93029),m={answerAdmireCouldOpen:{image:h,title:"开启「送礼物」",content:'恭喜你获得「送礼物」权益，开启后可以接受用户的付费支持，同时代表默认接受<a href="https://www.zhihu.com/terms/tipjar" target="_blank">《知乎赞赏功能使用协议》</a>',buttonText:"立即开启",detailViewName:"admire",cardShowId:4922,buttonClickId:4924,readAlwaysId:4926,readNextId:4928},answerAdmireCouldUse:{image:h,title:"使用「赞赏」权益",content:"你可以为这篇内容开启「赞赏」。「赞赏」开启后，读者将可以付费支持你的创作。",buttonText:"开启赞赏",detailViewName:"admire",cardShowId:4923,buttonClickId:4925,readAlwaysId:4927,readNextId:4929},recommendationCouldOpen:{image:_,title:"开启「内容自荐」权益",content:"你已经获得了「内容自荐」权益，优质内容通过自荐后可以展示给更多人。快去开启权益吧。",buttonText:"立即开启",buttonLink:"https://www.zhihu.com/creator/recommend",detailViewName:"recommend",cardShowId:4922,buttonClickId:4924,readAlwaysId:4926,readNextId:4928},recommendationCouldUse:{image:_,title:"使用「内容自荐」权益",content:"你可以使用「内容自荐」权益，让更多人看到这篇内容。快去使用权益吧。",buttonText:"立即自荐",detailViewName:"recommend",cardShowId:4923,buttonClickId:4925,readAlwaysId:4927,readNextId:4929}},g=function(e){var t=e.notification,n=void 0===t?{}:t,i=e.className,h=e.onRead,_=e.onUseAdmire,g=e.onUseRecommend,T=e.onOpenAdmire,E=(0,r._)((0,d.Ue)(),2),y=E[0],C=E[1],S=Object.keys(n).find(function(e){return n[e]}),I=m[S]||{},A=I.title,b=I.image,w=I.content,Z=I.buttonText,x=I.buttonLink,k=I.detailViewName,R=I.cardShowId,N=I.buttonClickId,O=I.readAlwaysId,P=I.readNextId;return((0,c.useEffect)(function(){S&&C()},[S]),(0,c.useEffect)(function(){S&&s.Z.trackCardShow(null,{id:R,name:k})},[S,R,k]),y)?(0,o.tZ)(u.Z,{className:a()("CreatorRightsNotification",i),onClose:function(){h("next"),s.Z.trackEvent(null,{id:P,name:k})},children:S&&(0,o.BX)(c.Fragment,{children:[(0,o.tZ)("img",{className:"CreatorRightsNotification-background",src:f,alt:"blue background"}),(0,o.tZ)("img",{className:"CreatorRightsNotification-liukanshan",src:b,alt:"liukanshan image"}),(0,o.tZ)("div",{className:"CreatorRightsNotification-title",children:A}),(0,o.tZ)("div",{className:"CreatorRightsNotification-content",dangerouslySetInnerHTML:{__html:w}}),(0,o.BX)(u.w,{className:"CreatorRightsNotification-buttonGroup",children:[x?(0,o.tZ)(p.Z,{className:"CreatorRightsNotification-button",preset:"primary",color:"blue",to:x,target:"_blank",onClick:function(){h("current"),s.Z.trackEvent(null,{id:N,name:k})},children:Z}):(0,o.tZ)(l.ZP,{className:"CreatorRightsNotification-button",preset:"primary",color:"blue",onClick:function(){h("current"),s.Z.trackEvent(null,{id:N,name:k}),"answerAdmireCouldUse"===S&&_(),"recommendationCouldUse"===S&&g(),"answerAdmireCouldOpen"===S&&(null==T||T())},children:Z}),(0,o.tZ)(l.ZP,{className:"CreatorRightsNotification-dismiss",preset:"plain",color:"grey",onClick:function(){h("always"),s.Z.trackEvent(null,{id:O,name:k})},children:"不再提醒"})]})]})}):null}},4757:function(e,t,n){"use strict";n.d(t,{Ue:function(){return p}});var r=n(94009),o=n(85879),i=n(65733),a=n(88329),c=n.n(a),s=n(14168),u=n.n(s),l=n(87363),d=(0,l.createContext)([!0,c(),c()]);d.displayName="DisplayPriorityContext";var p=function(){return(0,l.useContext)(d)},f=function(e){var t=e.children,n=e.readyStatus,r=e.shownStatus,a=e.index,c=e.setReadyStatusList,s=e.once,u=(0,l.useRef)(n);(0,l.useEffect)(function(){u.current=n},[n]);var p=(0,i.A)(function(){s&&"pending"!==u.current||c(function(e){return e.map(function(e,t){return t===a?"resolved":e})})}),f=(0,i.A)(function(){s&&"pending"!==u.current||c(function(e){return e.map(function(e,t){return t===a?"rejected":e})})}),h=(0,l.useMemo)(function(){return[r,p,f]},[r,p,f]);return(0,o.tZ)(d.Provider,{value:h,children:t})};f.propTypes={children:u().node,readyStatus:u().string,shownStatus:u().bool,index:u().number,setReadyStatusList:u().func,once:u().bool};var h=function(e){var t=e.children,n=e.once,i=void 0===n||n,a=(0,r._)((0,l.useState)(function(){return l.Children.map(t,function(e){return e?"pending":"rejected"})}),2),c=a[0],s=a[1],u=(0,l.useMemo)(function(){var e=!1;return c.map(function(t){return!e&&"rejected"!==t&&(e=!0,"pending"!==t)})},[c]);return(0,o.tZ)(o.HY,{children:l.Children.map(t,function(e,t){return(0,o.tZ)(f,{readyStatus:c[t],shownStatus:u[t],index:t,setReadyStatusList:s,once:i,children:e},t)})})};h.propTypes={children:u().node,once:u().bool},t.ZP=h},99682:function(e,t,n){"use strict";n.d(t,{Z:function(){return T}});var r=n(94009),o=n(79065),i=n(85879),a=n(24405),c=n(7835),s=n(41402),u=n(7551),l=n(97490),d=n(46730),p=n(87363),f=n(87641),h=n(63638),_=n(44169),m=n(7181);function g(){var e=(0,o._)(["\n            line-height: 27px;\n            background: ",";\n            color: #fff;\n            font-size: 13px;\n            padding: 0 8px;\n            font-weight: 400;\n            border-radius: 4px;\n          "]);return g=function(){return e},e}function T(e){var t=e.handleKeyCommand,n=e.updating,o=e.updateFailed,T=e.updatedTime,E=(0,a.F)(),y=(0,r._)((0,p.useState)(0),2)[1],C=n?u.Z:o?l.Z:d.Z,S=n?"草稿保存中":"".concat((0,_.rL)(T)," \xb7 草稿"),I=o?"网络环境差，已自动保存本地草稿":"编辑内容将自动保存云端草稿";(0,c.b)(function(){var e=setInterval(function(){return y(Date.now())},6e4);return function(){return e&&clearInterval(e)}});var A=(0,i.BX)(h.ZAClick,{as:f.kC,zaText:"草稿状态",zaType:"Button",alignItems:"center",p:"8px 10px",fontSize:13,css:{cursor:"pointer",borderRadius:"4px","&:hover":{background:"#F5F7FA"}},onClick:function(){n||t("toggle-draft-history-modal")},children:[S,(0,i.tZ)(C,{size:"16px",css:{color:n?"inherit":"#67C23A",marginLeft:"4px"}})]});return n?A:(0,i.tZ)(s.ms,{children:function(e){var t=e.css;return(0,i.tZ)(m.Z,{className:"DraftStatusTip",targetClassName:t(g(),E.colorMod("#191B1F").alpha(.8)),toggler:A,placement:"top",toggleEvent:"hover",children:I})}})}},58216:function(e,t,n){"use strict";n.d(t,{uF:function(){return d}});var r=n(87320),o=n(55164),i=n(57477),a=n(94009),c=n(49899),s=n(85879);n(84871);var u=n(87363),l=(0,u.createContext)(null),d=function(){return(0,u.useContext)(l)};t.ZP=function(e){var t=e.children,n=(0,a._)((0,u.useState)(function(){return{}}),2),d=n[0],p=n[1],f=(0,u.useMemo)(function(){return{action:Object.keys(d).reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t,(0,c._)(d[t]).join(",")))},{}),addAction:function(e,t){d[e]||(d[e]=new Set);var n=d[e];n.has(t)||(n.add(t),p(function(t){return(0,i._)((0,o._)({},t),(0,r._)({},e,n))}))}}},[d,p]);return(0,s.tZ)(l.Provider,{value:f,children:t})}},50074:function(e,t,n){"use strict";n.d(t,{Z:function(){return nI}});var r,o,i,a,c,s,u,l=n(15030),d=n(55164),p=n(94009),f=n(85879),h=n(65733),_=n(87363),m=n(80230),g=function(e){return Array.from(e)},T=function(e,t){var n=g(e);return t>=n.length?e.length:t<=0?0:n.slice(0,t).join("").length},E=function(e,t,n){return g(e).slice(t,n).join("")},y=function(e,t){if(!t||!e||0===e.length)return[];var n=t.getCurrentContent().getBlocksAsArray(),r=[],o=new Map,i=new Map,a=!0,c=!1,s=void 0;try{for(var u,l=e[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var d=u.value;if(d&&d.source){var p=d.source;o.set(p,(o.get(p)||0)+1)}}}catch(e){c=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(c)throw s}}var f=!0,h=!1,_=void 0;try{for(var g,E=e[Symbol.iterator]();!(f=(g=E.next()).done);f=!0)!function(){var e=g.value;if(e&&e.id&&e.source){var t=e.source,a=e.edits,c=e.id,s=i.get(t)||0,u=o.get(t)||0;if(!(s>=u)){var l=0,d=!1,p=!0,f=!1,h=void 0;try{for(var _,E=n[Symbol.iterator]();!(p=(_=E.next()).done);p=!0){var y=function(){var e=_.value;if(d)return"break";for(var n=e.getKey(),o=e.getText(),u=0;u<o.length;){var p=function(){var e=o.indexOf(t,u);if(-1===e)return"break";if(l<s)return l++,u=e+1,"continue";var p=!0,f=!1,h=void 0;try{for(var _,g=a[Symbol.iterator]();!(p=(_=g.next()).done);p=!0)!function(){var a=_.value;if("number"==typeof(null==a?void 0:a.pos)&&!(a.pos<0)&&"string"==typeof(null==a?void 0:a.src)){var u=a.pos,l=T(t,u),p=e+l;if("INSERT"===a.type){var f=0;u>0&&(f=T(t,u-1)),p=e+f}var h=p+(a.src.length||1);if(p<=o.length&&h<=o.length){var g=m.SelectionState.createEmpty(n).merge({anchorOffset:p,focusOffset:h});if(r.some(function(e){return e.highlightSelection.equals(g)}))return;r.push({id:c,edit:a,blockKey:n,highlightSelection:g}),i.set(t,s+1),d=!0}}}()}catch(e){f=!0,h=e}finally{try{p||null==g.return||g.return()}finally{if(f)throw h}}if(d)return"break";u=e+1}();if("break"===p)break}}();if("break"===y)break}}catch(e){f=!0,h=e}finally{try{p||null==E.return||E.return()}finally{if(f)throw h}}}}}()}catch(e){h=!0,_=e}finally{try{f||null==E.return||E.return()}finally{if(h)throw _}}return r},C=function(e,t){if(!t||!e||!e.source||!e.occurrence||e.occurrence<=0)return null;var n=t.getCurrentContent().getBlocksAsArray(),r=e.source,o=e.edits,i=e.occurrence-1,a=0,c=!0,s=!1,u=void 0;try{for(var l,d=n[Symbol.iterator]();!(c=(l=d.next()).done);c=!0)for(var p=l.value,f=p.getKey(),h=p.getText(),_=0;_<h.length;){var g=h.indexOf(r,_);if(-1===g)break;if(a===i){var E=[],y=!0,C=!1,S=void 0;try{for(var I,A=o[Symbol.iterator]();!(y=(I=A.next()).done);y=!0){var b=I.value;if("number"==typeof(null==b?void 0:b.pos)&&!(b.pos<0)&&"string"==typeof(null==b?void 0:b.src)){var w=b.pos,Z=T(r,w),x=g+Z;if("INSERT"===b.type){var k=0;w>0&&(k=T(r,w-1)),x=g+k}var R=x+(b.src.length||1);if(x<=h.length&&R<=h.length&&x>=0){var N=m.SelectionState.createEmpty(f).merge({anchorOffset:x,focusOffset:R});E.push({edit:b,highlightSelection:N,blockKey:f})}}}}catch(e){C=!0,S=e}finally{try{y||null==A.return||A.return()}finally{if(C)throw S}}if(E.length>1)return E;if(1===E.length)return E[0];var O=m.SelectionState.createEmpty(f).merge({anchorOffset:g,focusOffset:g+r.length});return{edit:o[0]||null,highlightSelection:O}}a++,_=g+1}}catch(e){s=!0,u=e}finally{try{c||null==d.return||d.return()}finally{if(s)throw u}}return null},S=function(e,t){for(var n=e.highlightSelection,r=n.getAnchorKey(),o=t.getBlockForKey(r),i=n.getStartOffset(),a=n.getEndOffset(),c=i;c<a;c++)if(o.getInlineStyleAt(c).has("HIGHLIGHT_UNDERLINE"))return!0;return!1},I=function(e){var t=e.toJSON();return t.anchorKey+t.focusKey+t.anchorOffset},A=n(49899),b=function(e,t){var n=Math.max(0,Math.min(t,e.getLength()-1));return{inlineStyle:e.getInlineStyleAt(n),entityKey:e.getEntityAt(n)}},w=function(e,t,n,r){var o=n.getStartOffset(),i=o<r.getLength()?b(r,o):b(r,r.getLength()-1),a=i.inlineStyle,c=i.entityKey;return m.Modifier.replaceText(t,n,e.tgt||"",a,c)},Z=function(e,t,n,r){var o=n.getFocusOffset(),i=n.merge({anchorOffset:o,focusOffset:o}),a=o>0&&o<=r.getLength()?b(r,o-1):0===o&&r.getLength()>0?b(r,0):b(r,Math.max(0,r.getLength()-1)),c=a.inlineStyle,s=a.entityKey;return m.Modifier.insertText(t,i,e.tgt||"",c,s)},x=function(e,t){var n=t,r=t.getCurrentContent(),o=(0,A._)(e).sort(function(e,t){var n=e.highlightSelection.getStartKey(),r=t.highlightSelection.getStartKey(),o=e.highlightSelection.getStartOffset(),i=t.highlightSelection.getStartOffset();return n===r?i-o:o-i}),i=!0,a=!1,c=void 0;try{for(var s,u=o[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l,d=s.value,p=d.edit,f=d.highlightSelection,h=f.getStartKey(),_=r.getBlockForKey(h);switch(p.type){case"REPLACE":r=w(p,r,f,_);break;case"INSERT":r=Z(p,r,f,_);break;case"DELETE":l=r,r=m.Modifier.removeRange(l,f)}n=m.EditorState.push(n,r)}}catch(e){a=!0,c=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw c}}return n},k=n(57477),R=n(42559),N=n.n(R),O=function(e){if(e.payload.data.correction.totalSuggestions>0){var t=e.payload.data.correction.list.map(function(e){return(0,k._)((0,d._)({},e),{id:N()()})});e.payload.data.correction.list=t}return e.payload.data},P=function(e,t,n){var r=e.getCurrentContent();return r=m.Modifier.applyInlineStyle(r,t,n),m.EditorState.set(e,{currentContent:r})},D=function(e,t,n){var r=e.getCurrentContent();return r=m.Modifier.removeInlineStyle(r,t,n),m.EditorState.set(e,{currentContent:r})},L=function(e,t){if(!t.isCollapsed())return null;var n=t.getAnchorKey(),r=t.getAnchorOffset(),o=e.getBlockForKey(n);if(!o||r<=0||!o.getInlineStyleAt(r-1).has("HIGHLIGHT_UNDERLINE"))return null;for(var i=r-1,a=r;i>0&&o.getInlineStyleAt(i-1).has("HIGHLIGHT_UNDERLINE");)i--;for(var c=o.getLength();a<c&&o.getInlineStyleAt(a).has("HIGHLIGHT_UNDERLINE");)a++;return new m.SelectionState({anchorKey:n,anchorOffset:i,focusKey:n,focusOffset:a})},M=function(e,t,n){var r=e.getCurrentContent(),o=e.getUndoStack(),i=e.getRedoStack(),a=r.getSelectionBefore(),c=r.getSelectionAfter();if(0===t.length)return e;var s=t.reduce(function(e,t){var n=t.highlightSelection;return(0,l._)(n,m.SelectionState)?m.Modifier.applyInlineStyle(e,n,"HIGHLIGHT_UNDERLINE"):e},r);s=s.merge({selectionBefore:a,selectionAfter:c});var u=m.EditorState.set(e,{currentContent:s,undoStack:o,redoStack:i});if(n&&t&&t.length>0){var d=t.find(function(e){return(0,l._)(e.highlightSelection,m.SelectionState)});if(d){var p=d.highlightSelection;if((0,l._)(p,m.SelectionState)){var f=p.merge({focusOffset:p.getAnchorOffset(),hasFocus:!0});u=m.EditorState.forceSelection(u,f)}}}return u},B=function(e){var t=e.getCurrentContent(),n=t.getBlockMap();if(n.isEmpty())return e;var r=t.getSelectionBefore(),o=t.getSelectionAfter(),i=e.getSelection(),a=t,c=n.first().getKey(),s=n.last().getKey(),u=n.last().getLength(),l=new m.SelectionState({anchorKey:c,anchorOffset:0,focusKey:s,focusOffset:u});return a=m.Modifier.removeInlineStyle(a,l,"HIGHLIGHT_ERROR_BACKGROUND"),a=m.Modifier.removeInlineStyle(a,l,"HIGHLIGHT_UNDERLINE"),a=(a=m.Modifier.removeInlineStyle(a,l,"HIGHLIGHT_LAYOUT")).merge({selectionBefore:r,selectionAfter:o}),m.EditorState.set(e,{currentContent:a,selection:i})},U=function(e,t){var n=e.getStartKey(),r=e.getEndKey(),o=t.getStartKey(),i=t.getEndKey();return n===o&&r===i&&(t.hasEdgeWithin(n,e.getStartOffset(),e.getStartOffset())||t.hasEdgeWithin(r,e.getEndOffset(),e.getEndOffset())||e.hasEdgeWithin(o,t.getStartOffset(),t.getStartOffset())||e.hasEdgeWithin(i,t.getEndOffset(),t.getEndOffset()))},G=function(e,t,n){if(e){var r=new m.SelectionState({anchorKey:e.focusKey,anchorOffset:e.focusOffset,focusKey:e.focusKey,focusOffset:e.focusOffset,hasFocus:!0});n(m.EditorState.forceSelection(t,r))}},F=n(87641),H=n(63638),z=n(21060),q=n(93547),V=function(e,t){var n=(0,_.useMemo)(function(){return e()},[e]),r=(0,p._)((0,_.useState)(n),2),o=r[0],i=r[1],a=(0,p._)((0,_.useState)("normal"),2),c=a[0],s=a[1],u=(0,p._)((0,_.useState)(""),2),l=u[0],d=u[1],f=(0,_.useRef)("normal"),m=(0,_.useRef)(null),g=o.offset,T=o.fixStyle,E=o.scrollOffset,y=o.normalStyle,C=o.getContainerHeight,S=(0,h.A)(function(){"fixed"!==c&&i(e())});return(0,_.useEffect)(function(){i(e())},[e]),(0,_.useEffect)(function(){var e=parseInt(y.height)||0,t=function(){if("normal"===c){var t,n=Math.min(window.scrollY,E);d("".concat(e+n,"px"))}window.scrollY>E&&"fixed"===c&&(null===(t=m.current)||void 0===t||t.updateHeight())};if(t(),"normal"===c){var n=null,r=function(){n||(n=requestAnimationFrame(function(){t(),n=null}))};return window.addEventListener("scroll",r,{passive:!0}),function(){window.removeEventListener("scroll",r),n&&cancelAnimationFrame(n)}}},[c,y,E]),(0,_.useEffect)(function(){var t,n=function(){requestAnimationFrame(function(){setTimeout(function(){i(e())},100)})},r=function(){clearTimeout(t),t=setTimeout(function(){requestAnimationFrame(n)},100)};return window.addEventListener("resize",r),function(){window.removeEventListener("resize",r),clearTimeout(t)}},[e]),{stickyInfo:o,stickyStatus:c,dynamicHeight:l,stickyRef:m,offset:g,fixStyle:T,normalStyle:y,handlePositionStatusChange:function(e){if("fixed"===f.current&&"absolute"===e){var n=C();t&&n+"px"!==l&&d(n+"px")}s(e),f.current=e},updateStickyInfo:S}},W=n(81956),X=n(61878),K=n(67700),j=n(25405),Y=n(40811),Q=n(93975),J=n(25308),$=n(9338),ee=n(71728),et=n(30971),en=n(81037),er=n(24405),eo=n(85761);function ei(e){var t=e.children;return(0,f.tZ)(F.xv,{px:"8px",fontSize:12,lineHeight:"19px",fontWeight:"bold",color:"MapText03A",children:t})}function ea(e){var t=e.children,n=e.count,r=(0,ee._)(e,["children","count"]);return(0,f.BX)(F.kC,(0,k._)((0,d._)({as:"span",justifyContent:"space-between",alignItems:"center",fontSize:12,lineHeight:"16px",color:"MapText03A",fontWeight:"bold"},r),{children:[t,void 0!==n&&(0,f.tZ)(F.xv,{as:"span",ml:"4px",p:"0 4px",height:16,lineHeight:"16px",fontSize:11,fontWeight:"bold",textAlign:"center",color:"MapUIAccentC",css:function(e){return{display:"inline-block",backgroundColor:e.colorMod(e.colors.MapUIAccentC).alpha(.1),borderRadius:"50%"}},children:n})]}))}var ec={DEFAULT:"default",PENDING:"pending",ADOPTED:"adopted"},es={pending:"采纳中",adopted:"已采纳",default:"采纳"},eu=function(e){var t,n=e.item,r=e.onAdopt,o=e.index,i=(0,p._)((0,_.useState)(ec.DEFAULT),2),a=i[0],c=i[1],s=(0,_.useRef)(null),u=(0,er.F)().colors,l=(t=(0,$._)(function(){var e;return(0,et.__generator)(this,function(t){switch(t.label){case 0:if(a!==ec.DEFAULT)return[2];c(ec.PENDING),t.label=1;case 1:if(t.trys.push([1,6,,7]),!((e=r(n.text))&&"function"==typeof e.then))return[3,3];return[4,e];case 2:return t.sent(),[3,5];case 3:return[4,new Promise(function(e){return setTimeout(e,1e3)})];case 4:t.sent(),t.label=5;case 5:return c(ec.ADOPTED),s.current=setTimeout(function(){c(ec.DEFAULT)},3e3),[3,7];case 6:return t.sent(),c(ec.DEFAULT),[3,7];case 7:return[2]}})}),function(){return t.apply(this,arguments)}),d=a!==ec.DEFAULT;return(0,_.useEffect)(function(){return function(){s.current&&clearTimeout(s.current)}},[]),(0,f.BX)(F.kC,{alignItems:"flex-start",css:{borderRadius:4,padding:"6px 8px",gap:4,"&:hover":{backgroundColor:u.MapUIFrame10A}},children:[(0,f.tZ)(F.xv,{flex:1,alignItems:"flex-start",children:n.text}),(0,f.tZ)(H.ZAClick,{shouldTrackShow:!0,zaModuleId:"ai_creation_title_adopt",zaModuleIndex:o,zaType:"Button",extra:{configMap:{ai_create_suggestion_id:String(n.id),ai_create_suggestion_type:"ai_title"}},as:en.ZP,preset:"plain",color:"blue",disabled:d,css:{minWidth:36,flexShrink:0,fontSize:"12px",whiteSpace:"nowrap",opacity:d?.6:1,cursor:d?"not-allowed":"pointer"},onClick:l,children:es[a]})]})};function el(e){var t=e.title,n=e.items,r=void 0===n?[]:n,o=e.emptyText,i=(0,ee._)(e,["title","items","emptyText"]);return(0,f.BX)(F.xu,{fontSize:12,color:"MapText03A",children:[(0,f.tZ)(ea,{css:{padding:"0 8px",marginBottom:8},children:(0,f.BX)(F.kC,{alignItems:"center",children:[(0,f.tZ)(eo.Z,{size:16,css:{marginRight:4}}),t]})}),r.length>0?r.map(function(e,t){return(0,f.tZ)(eu,(0,d._)({item:e,index:t},i),t)}):(0,f.tZ)(ei,{children:void 0===o?"暂无可用内容":o})]})}var ed=function(e,t,n,r,o){(0,_.useEffect)(function(){"loading"===e&&0!==t.length&&t.every(function(e){return"success"===n[e.id]||"error"===n[e.id]})&&(r("success"),o([]))},[n,e,t,r,o])},ep=(0,_.createContext)(null),ef=function(){var e=(0,_.useContext)(ep);if(!e)throw Error("useDetectionPanelContext must be used within a DetectionPanelProvider");return e},eh=n(87320),e_=function(e){var t,n,r=e.currentEditorState,o=e.setEditorState,i=e.setCorrectionsResultState,a=e.setNeedDelayRender,c=(0,_.useRef)([]),s=(0,_.useRef)(!1),u=(0,_.useRef)(r),l=(0,_.useRef)(null);(0,_.useEffect)(function(){u.current=r},[r]);var p=(0,h.A)((t=(0,$._)(function(e){var t,n;return(0,et.__generator)(this,function(r){switch(r.label){case 0:if(s.current||0===c.current.length)return[2];s.current=!0,t=c.current.shift(),r.label=1;case 1:var f,h;return r.trys.push([1,,3,4]),[4,(f=t,h=u.current,new Promise(function(t){try{var n=!1,r=[];if(e){var o=y([f],h);if(o&&o.length>0){var i=!0,a=!1,c=void 0;try{for(var s,u=o[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;n=!0,r.push(l)}}catch(e){a=!0,c=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw c}}}}else{var d=C(f,h);if(d){var p=h.getCurrentContent();if(Array.isArray(d)){var _=!0,m=!1,g=void 0;try{for(var T,E=d[Symbol.iterator]();!(_=(T=E.next()).done);_=!0){var I=T.value;S(I,p)&&(n=!0,r.push(I))}}catch(e){m=!0,g=e}finally{try{_||null==E.return||E.return()}finally{if(m)throw g}}}else S(d,p)&&(n=!0,r.push(d))}}if(0===r.length||!n){t(null);return}var A=x(r,h);t(A)}catch(e){t(null)}}))];case 2:return n=r.sent(),a(!0),n&&o(n),i(function(e){return(0,k._)((0,d._)({},e),(0,eh._)({},t.id,n?"success":"error"))}),[3,4];case 3:return s.current=!1,c.current.length>0&&(l.current=setTimeout((0,$._)(function(){return(0,et.__generator)(this,function(t){switch(t.label){case 0:return[4,p(e)];case 1:return t.sent(),[2]}})}),0)),[7];case 4:return[2]}})}),function(e){return t.apply(this,arguments)}));return(0,_.useEffect)(function(){return function(){l.current&&clearTimeout(l.current)}},[]),{applyCorrections:(0,h.A)((n=(0,$._)(function(e,t){return(0,et.__generator)(this,function(n){switch(n.label){case 0:return i(function(t){return(0,k._)((0,d._)({},t),(0,eh._)({},e.id,"loading"))}),c.current.push(e),[4,p(t)];case 1:return n.sent(),[2]}})}),function(e,t){return n.apply(this,arguments)}))}},em=function(e,t,n,r){(0,_.useEffect)(function(){var o,i=null==e?void 0:null===(o=e.correction)||void 0===o?void 0:o.list;if(!i){n([]);return}var a=new Map,c=i.map(function(e,t){var n=(a.get(e.source)||0)+1;return a.set(e.source,n),(0,k._)((0,d._)({},e),{occurrence:n,originalIndex:t})});if(!r){n(c);return}var s=new Map(c.map(function(e){return[e.id,e]}));n(function(e){if(e.length>0&&i.length>0&&!i.some(function(t){return e.some(function(e){return e.id===t.id})}))return c;var r=[],o=new Map(s);return e.forEach(function(e){var i=s.get(e.id);if(i)r.push(i),o.delete(e.id);else if("success"===t[e.id]||"error"===t[e.id]||"ignored"===t[e.id]){var a=setTimeout(function(){n(function(t){return t.filter(function(t){return t.id!==e.id})}),clearTimeout(a)},3e3);r.push(e)}else r.push(e)}),o.forEach(function(e){r.push(e)}),r.sort(function(e,t){return(void 0!==e.originalIndex?e.originalIndex:1/0)-(void 0!==t.originalIndex?t.originalIndex:1/0)})})},[e,t,n,r])},ev=function(e){var t,n=e.currentEditorState,r=e.setEditorState,o=e.setCorrectionsResultState,i=e.setNeedDelayRender,a=(0,_.useRef)(n);(0,_.useEffect)(function(){a.current=n},[n]);var c=ef().setDetectionStatus;return{handleIgnore:(0,h.A)((t=(0,$._)(function(e){var t;return(0,et.__generator)(this,function(n){switch(n.label){case 0:o(function(t){return(0,k._)((0,d._)({},t),(0,eh._)({},e.id,"loading"))}),c(e6.APPLYING),n.label=1;case 1:var s;return n.trys.push([1,3,,4]),i(!0),[4,(s=a.current,new Promise(function(t,n){try{var r=C(e,s),o=Array.isArray(r)?r:[r];if(o&&o.length>0&&o[0]){var i=s.getCurrentContent(),a=!0,c=!1,u=void 0;try{for(var l,d=o[Symbol.iterator]();!(a=(l=d.next()).done);a=!0){var p=l.value,f=new m.SelectionState({anchorKey:p.highlightSelection.anchorKey,anchorOffset:p.highlightSelection.anchorOffset,focusKey:p.highlightSelection.focusKey,focusOffset:p.highlightSelection.focusOffset});i=m.Modifier.removeInlineStyle(i,f,"HIGHLIGHT_ERROR_BACKGROUND"),i=m.Modifier.removeInlineStyle(i,f,"HIGHLIGHT_UNDERLINE"),i=m.Modifier.removeInlineStyle(i,f,"HIGHLIGHT_LAYOUT")}}catch(e){c=!0,u=e}finally{try{a||null==d.return||d.return()}finally{if(c)throw u}}t(m.EditorState.set(s,{currentContent:i}))}else n()}catch(e){n()}}))];case 2:return(t=n.sent())&&r(t),o(function(n){return(0,k._)((0,d._)({},n),(0,eh._)({},e.id,t?"ignored":"ignored-error"))}),c(e6.DEFAULT),[3,4];case 3:return n.sent(),o(function(t){return(0,k._)((0,d._)({},t),(0,eh._)({},e.id,"ignored-error"))}),c(e6.DEFAULT),[3,4];case 4:return[2]}})}),function(e){return t.apply(this,arguments)}))}},eg=n(38020),eT={backgroundColor:"rgba(0, 202, 166, 0.2)"},eE={backgroundColor:"rgba(217, 83, 80, 0.2)",textDecoration:"line-through"},ey=function(e){var t=e.source,n=e.edits;if(!n||0===n.length)return(0,f.tZ)("span",{children:t});var r=(0,A._)(n).sort(function(e,t){return e.pos-t.pos}),o=g(t).length,i=[],a=0;return r.length>0&&r[0].pos>35&&(a=Math.max(0,r[0].pos-5))>0&&i.push((0,f.tZ)("span",{children:"..."},"ellipsis-start")),r.forEach(function(e){switch(e.pos>a&&(i.push((0,f.tZ)("span",{children:E(t,a,e.pos)},"text-".concat(a))),a=e.pos),e.type){case"REPLACE":e.src&&i.push((0,f.tZ)("span",{css:eE,children:e.src},"delete-".concat(e.pos))),e.tgt&&i.push((0,f.tZ)("span",{css:eT,children:e.tgt},"insert-".concat(e.pos,"-replace"))),a+=e.src?g(e.src).length:0;break;case"INSERT":if(e.tgt&&i.push((0,f.tZ)("span",{style:eT,children:e.tgt},"insert-".concat(e.pos,"-insert"))),a<o){var n;i.push((0,f.tZ)("span",{children:(n=a,g(t)[n]||"")},"char-".concat(a))),a+=1}break;case"DELETE":e.src&&i.push((0,f.tZ)("span",{css:eE,children:e.src},"delete-".concat(e.pos))),a+=e.src?g(e.src).length:0;break;default:a=e.pos+(e.src?g(e.src).length:0)}}),a<o&&i.push((0,f.tZ)("span",{children:E(t,a,o)},"text-final")),(0,f.tZ)("span",{css:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis"},children:i})},eC=function(e){var t=e.applyingAll,n=e.status,r=(0,er.F)().colors;return"success"===n?(0,f.tZ)("span",{css:{color:r.MapUIAccentC},children:"已优化"}):(null==n?void 0:n.includes("error"))?(0,f.tZ)("span",{css:{color:r.MapCriticalTip},children:"失败"}):"ignored"===n?(0,f.tZ)("span",{css:{color:r.MapUISecondary},children:"已忽略"}):"loading"===t||"loading"===n?(0,f.tZ)(F.xv,{css:{position:"relative"},children:(0,f.tZ)(eg.Z,{css:{width:12,"& .path":{stroke:r.MapInfoSub}}})}):(0,f.tZ)(H.ZAShow,{as:"span",zaType:"Button",zaText:!0,zaModuleId:"ai_creation_assistant_panel_modify",children:"采纳"})},eS=function(e){var t=e.item,n=e.index,r=e.currentEditorState,o=e.applyCorrections,i=e.handleIgnoreCorrection,a=e.correctionsResultState,c=e.applyingAll,s=e.isActive,u=e.setEditorState,l=e.setHighlightId,d=(0,H.useTracker)().trackEvent,m=(0,p._)((0,_.useState)(!1),2),g=m[0],T=m[1],E=(0,er.F)().colors,y=(0,h.A)(function(e){var t=C(e,r);if(t){var n=Array.isArray(t)&&t.length>0?t[0]:t;n&&(G(n.highlightSelection,r,u),l(e.id))}}),S=(0,h.A)(function(e,t){a[e.id]||(d({eventType:"Click",elementLocation:{type:"Button",moduleId:"ai_creation_assistant_panel_modify"}}),o(e,t))});return(0,f.BX)(F.kC,{p:"6px 8px",alignItems:"flex-start",justifyContent:"space-between",css:{borderRadius:4,backgroundColor:s?E.MapUIFrame10A:"transparent","&::before":{content:"'•'",marginRight:4,color:E.MapUIAccentC},"&:hover":{backgroundColor:E.MapUIFrame10A}},children:[(0,f.BX)(F.kC,{width:230,flex:1,alignItems:"flex-start",justifyContent:"space-between",onMouseEnter:function(){return T(!0)},onMouseLeave:function(){return T(!1)},children:[(0,f.tZ)(F.kC,{flex:1,onClick:function(){return y(t,n)},children:(0,f.tZ)(ey,{source:t.source,edits:t.edits})}),(0,f.tZ)(en.ZP,{preset:"plain",color:"grey",css:{fontSize:"12px",whiteSpace:"nowrap",visibility:g?"visible":"hidden",marginRight:"8px",flexShrink:0},onClick:function(){a[t.id]||(d({eventType:"Click",elementLocation:{type:"Button",moduleId:"ai_creation_contentcheck_ignore"}}),i(t))},children:"忽略"})]}),(0,f.tZ)(en.ZP,{preset:"plain",color:"grey",css:{fontSize:"12px",whiteSpace:"nowrap",flexShrink:0},onClick:function(){return S(t,!1)},children:(0,f.tZ)(eC,{applyingAll:c,status:a[t.id]})})]})},eI=n(7835),eA=function(e){var t=e.children,n=e.shouldFadeOut,r=void 0!==n&&n,o=e.delay,i=void 0===o?1700:o,a=e.fadeOutDuration,c=void 0===a?300:a,s=e.className,u=e.style,l=void 0===u?{}:u,h=(0,ee._)(e,["children","shouldFadeOut","delay","fadeOutDuration","className","style"]),m=(0,p._)((0,_.useState)(!0),2),g=m[0],T=m[1],E=(0,p._)((0,_.useState)(function(){return g&&r}),2),y=E[0],C=E[1];return(0,eI.b)(function(){T(!1)}),(0,_.useEffect)(function(){if(r){if(g){C(!0);return}var e=setTimeout(function(){C(!0)},i+c);return function(){return clearTimeout(e)}}},[r,g,i,c]),(0,f.tZ)(F.kC,(0,k._)((0,d._)({className:s,css:(0,d._)((0,k._)((0,d._)({},l),{boxSizing:"border-box",overflow:"hidden",transition:r&&!g?"transform ".concat(c,"ms ease-out, opacity ").concat(c,"ms ease-out"):"none"}),r&&(0,d._)({transform:"translateX(100%)",opacity:0,pointerEvents:"none"},!g&&{transitionDelay:"".concat(i,"ms")}),y&&{height:0,marginTop:0,marginBottom:0,paddingTop:0,paddingBottom:0,transition:"height 0.2s ease-out, margin 0.2s ease-out, padding 0.2s ease-out"})},h),{children:t}))},eb=function(e){var t=e.applyingAll,n=e.handleClick;return"loading"===t?(0,f.tZ)(F.xv,{css:{position:"relative"},children:(0,f.tZ)(eg.Z,{css:function(e){return{width:12,"& .path":{stroke:e.colors.MapInfoSub}}}})}):(0,f.tZ)(H.ZAClick,{shouldTrackShow:!0,as:en.ZP,zaType:"Button",zaModuleId:"ai_creation_contentcheck_adopt",preset:"plain",css:{marginLeft:"8px",fontSize:"12px",fontWeight:"bold"},onClick:n,children:(0,f.tZ)(F.xv,{as:"span",color:"MapBrand",children:"全部采纳"})})},ew=function(e){var t=e.currentEditorState,n=e.corrections,r=e.correctionTotalSuggestions,o=e.applyCorrections,i=e.handleIgnoreCorrection,a=e.correctionsResultState,c=e.handleApplyAllCorrections,s=e.applyingAll,u=e.setEditorState,l=e.activeId,d=e.setHighlightId,p=(0,_.useMemo)(function(){return n.filter(function(e){return!a[e.id]}).length},[n,a]);return 0===n.length?(0,f.tZ)(ei,{children:"\uD83D\uDC4F 暂无优化建议，请继续创作吧"}):0===p?(0,f.tZ)(ei,{children:"\uD83D\uDC4F 已完成全部修改"}):(0,f.BX)(H.ZAShow,{as:F.xu,zaType:"Block",zaModuleId:"ai_creation_assistant_panel_content_correction",fontSize:12,color:"MapText03A",extra:{configMap:{ai_creation_assistant_recommendation_num:String(r||0)}},children:[(0,f.BX)(F.kC,{justifyContent:"space-between",alignItems:"center",px:"8px",mb:"8px",children:[(0,f.tZ)(ea,{count:p,children:(0,f.BX)(F.kC,{alignItems:"center",children:[(0,f.tZ)(eo.Z,{size:16,css:{marginRight:4}}),"发现以下优化建议"]})}),(0,f.tZ)(eb,{applyingAll:s,handleClick:c})]}),(0,f.tZ)("div",{children:n.map(function(e,n){return(0,f.tZ)(eA,{shouldFadeOut:!!a[e.id],style:{gap:4,cursor:"pointer",borderRadius:"4px"},children:(0,f.tZ)(eS,{item:e,index:n,currentEditorState:t,applyCorrections:o,handleIgnoreCorrection:i,correctionsResultState:a,applyingAll:s,setEditorState:u,isActive:l===e.id,setHighlightId:d})},"correction-".concat(e.id))})})]})},eZ=n(65995),ex=n.n(eZ),ek=["iPhone","email","iOS","macOS","tvOS","watchOS","Android","Windows","Linux","Unix","FreeBSD","Debian","Python","Go","Golang","Ruby","Rust","Java","JavaScript","PHP","SQL","Scala","Kotlin","ECMAScript","CSS","HTML","TypeScript","C","C++","Django","Tornado","Flask","Node.js","webpack","MySQL","NoSQL","PostgreSQL","Redis","MongoDB","HBase","Elasticsearch","HDFS","Cassandra","Hive","MapReduce","Spark","Kudu","Tez","Druid","Impala","NGINX","Kafka","Prometheus","Graphite","HAProxy","Kibana","Filebeat","Grafana","HTTP","HTTPS","M3U8","ts","MP4","Jenkins","GitHub","GitLab","Docker","Kubernetes","OpenStack"],eR=function(e){return e.replace(/[.*+?^${}()|[\\\]\\]/g,"\\\\$&")},eN=function(e){return ek.some(function(t){var n=eR(t),r=RegExp("\\b".concat(n,"\\b"),"gi"),o=e.matchAll(r),i=!0,a=!1,c=void 0;try{for(var s,u=o[Symbol.iterator]();!(i=(s=u.next()).done);i=!0)if(s.value[0]!==t)return!0}catch(e){a=!0,c=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw c}}return!1})},eO=function(e){var t=e.getCurrentContent().getBlocksAsArray(),n=[],r=new Set,o=!0,i=!1,a=void 0;try{for(var c,s=t[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value.getText();if((/([\u4e00-\u9fa5][a-zA-Z\d])|([a-zA-Z\d][\u4e00-\u9fa5])/g.test(u)||/%[\u4e00-\u9fa5]/g.test(u))&&r.add("insertSpace"),eN(u)&&r.add("convertCase"),/"[^"]*"|'[^']*'/g.test(u)&&r.add("replaceQuotationMark"),3===r.size)break}}catch(e){i=!0,a=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw a}}return r.has("insertSpace")&&n.push({type:"insertSpace",checked:!0,resolved:!1}),r.has("convertCase")&&n.push({type:"convertCase",checked:!0,resolved:!1}),r.has("replaceQuotationMark")&&n.push({type:"replaceQuotationMark",checked:!0,resolved:!1}),n},eP=function(e,t,n,r){for(var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=e.getBlockForKey(t),a=n,c=n+o;a>0;)if(i.getEntityAt(a-1)===r)a--;else break;for(;c<i.getLength();)if(i.getEntityAt(c)===r)c++;else break;return{entityStart:a,entityEnd:c}},eD=function(e,t,n,r){var o=e.getBlockForKey(t),i=e.getSelectionAfter().merge({anchorKey:t,anchorOffset:n,focusKey:t,focusOffset:n}),a=n>0?o.getInlineStyleAt(n-1):o.getInlineStyleAt(0),c=m.Modifier.insertText(e,i," ",a);if(r){var s=eP(c,t,n,r,1),u=s.entityStart,l=s.entityEnd,d=c.getSelectionAfter().merge({anchorKey:t,anchorOffset:u,focusKey:t,focusOffset:l});c=m.Modifier.applyEntity(c,d,r)}return c},eL=function(e,t,n,r,o,i,a){var c=e.getSelectionAfter().merge({anchorKey:t,anchorOffset:n,focusKey:t,focusOffset:r}),s=m.Modifier.replaceText(e,c,o,i);if(a){var u=eP(s,t,n,a,o.length),l=u.entityStart,d=u.entityEnd,p=s.getSelectionAfter().merge({anchorKey:t,anchorOffset:l,focusKey:t,focusOffset:d});s=m.Modifier.applyEntity(s,p,a)}return s},eM=function(e,t){for(var n,r,o,i=e,a=t.getText(),c=t.getKey(),s=!1,u=/([\u4e00-\u9fa5])([a-zA-Z\d])/g,l=/([a-zA-Z\d])([\u4e00-\u9fa5])/g,d=/(%)([\u4e00-\u9fa5])/g,p=[];null!==(n=u.exec(a));)p.push(n.index+1);for(;null!==(r=l.exec(a));)p.push(r.index+1);for(;null!==(o=d.exec(a));)p.push(o.index+1);for(var f=(0,A._)(new Set(p)).sort(function(e,t){return e-t}),h=f.length-1;h>=0;h--){var _=f[h],m=i.getBlockForKey(c),g=m.getEntityAt(_),T=_>0?m.getEntityAt(_-1):null,E=g||T;i=eD(i,c,_,E),s=!0}return{content:i,hasChanges:s}},eB=function(e,t){var n=e,r=t.getText(),o=t.getKey(),i=!1,a=!0,c=!1,s=void 0;try{for(var u,l=ek[Symbol.iterator]();!(a=(u=l.next()).done);a=!0)for(var d=u.value,p=eR(d),f=RegExp("\\b"+p+"\\b","gi"),h=void 0,_=0;null!==(h=f.exec(r));)if(h[0]!==d){var m=h.index+_,g=m+h[0].length,T=n.getBlockForKey(o),E=T.getInlineStyleAt(m),y=T.getEntityAt(m);n=eL(n,o,m,g,d,E,y),i=!0;var C=d.length-h[0].length;_+=C}}catch(e){c=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(c)throw s}}return{content:n,hasChanges:i}},eU=function(e,t){for(var n=e,r=t.getText(),o=t.getKey(),i=!1,a=!1,c=!1,s=0,u=0;u<r.length;u++){var l=r[u],d=null;if('"'===l?(d=a?"」":"「",a=!a):"'"===l&&(d=c?"』":"『",c=!c),d){var p=u+s,f=n.getBlockForKey(o),h=f.getEntityAt(p),_=f.getInlineStyleAt(p);n=eL(n,o,p,p+1,d,_,h),i=!0,s+=d.length-1}}return{content:n,hasChanges:i}},eG=function(e,t){var n=e,r=e.getBlocksAsArray(),o=!1;return r.forEach(function(e){var r;"insertSpace"===t?r=eM(n,e):"convertCase"===t?r=eB(n,e):"replaceQuotationMark"===t&&(r=eU(n,e)),r&&(n=r.content,o=o||r.hasChanges)}),{content:n,hasChanges:o}},eF=function(e,t){var n=e.getCurrentContent(),r={},o=!1;if(Object.keys(t).forEach(function(e){r[e]=!1}),t.insertSpace){var i=eG(n,"insertSpace");n=i.content,r.insertSpace=i.hasChanges,o=o||i.hasChanges}if(t.convertCase){var a=eG(n,"convertCase");n=a.content,r.convertCase=a.hasChanges,o=o||a.hasChanges}if(t.replaceQuotationMark){var c=eG(n,"replaceQuotationMark");n=c.content,r.replaceQuotationMark=c.hasChanges,o=o||c.hasChanges}return o?{editorState:m.EditorState.push(e,n,"apply-entity"),formatResult:r}:null},eH=function(e){var t,n=e.setDetectionResult,r=e.currentEditorState,o=e.setEditorState,i=e.isApplyingFormatRef,a=e.formatApplyingStatus,c=e.formatSuggestions,s=(0,p._)((0,_.useState)(null),2),u=s[0],l=s[1],f=(0,_.useRef)(!0);return(0,_.useEffect)(function(){return function(){f.current=!1,l(null)}},[]),{formatApplyResults:u,handleApplyAllFormat:(t=(0,$._)(function(){var e,t,s,u;return(0,et.__generator)(this,function(p){return"default"!==a||(e={},c.forEach(function(t){t.checked&&!t.resolved&&(e[t.type]=!0)}),(t=eF(r,e))?(o(t.editorState),l(t.formatResult||{})):l({}),s=0,u=c.map(function(e){return e.checked&&(s+=1),(0,k._)((0,d._)({},e),{resolved:!!e.checked||e.resolved})}),s>0&&(i.current=!0,n(u)),setTimeout(function(){l(null),s>0&&(i.current=!1)},3e3)),[2]})}),function(){return t.apply(this,arguments)})}},ez=n(36963),eq=n(44909),eV=n(67814),eW=n.n(eV),eX=function(e){var t=e.className,n=e.id,r=e.name,o=e.checked,i=e.onChange,a=e.text,c=e.resolved,s=(0,p._)((0,_.useState)(!1),2),u=s[0],l=s[1],d=o?ez.ZP:eq.Z;return(0,f.BX)("label",{className:eW()("Checkbox",t,{"Checkbox--focused":u}),css:[{cursor:"pointer",display:"flex",justifyContent:"flex-start"},u&&{outline:"none",transition:"box-shadow 0.3s"}],children:[o&&!c?(0,f.tZ)(d,{size:16,className:"Checkbox-iconOn",css:function(e){return{color:e.colors.GBL01A}}}):(0,f.tZ)(d,{size:16,className:"Checkbox-iconOff",css:function(e){return{color:e.colors.GBK06A}}}),(0,f.tZ)("input",{className:"Checkbox-input",id:n,name:r,type:"checkbox",checked:o,onFocus:function(){return l(!0)},onBlur:function(){return l(!1)},onChange:i,css:{appearance:"none",clip:"rect(0, 0, 0, 0)",pointerEvents:"none",position:"absolute"}}),a&&(0,f.tZ)("span",{className:"Checkbox-text",css:function(e){return{minWidth:0,marginLeft:4,flex:1,color:o?e.colors.MapText03A:e.colors.MapText06A}},children:a})]})},eK=function(e){var t=e.item,n=e.handleSelect,r=e.formatApplyResults,o=void 0===r?{}:r,i=t.type,a=t.checked,c=t.resolved,s=(0,er.F)().colors;return(0,f.BX)(f.HY,{children:[(0,f.tZ)(eX,{css:{marginRight:4,width:a&&(null==o?void 0:o[i])===!0?"214px":"auto"},disabled:c,checked:a,shape:"circle",text:e8[i],onChange:function(e){c||n(e,i)},resolved:c}),a&&!c&&o&&(!0===o[i]?(0,f.tZ)("span",{css:{color:s.MapUIAccentC,fontSize:"12px",whiteSpace:"nowrap"},children:"已优化"}):(0,f.tZ)("span",{css:{color:s.MapCriticalTip,fontSize:"12px",whiteSpace:"nowrap"},children:"失败"}))]})},ej=function(e){var t=e.item,n=e.index,r=t.resolved;return(0,f.tZ)(eA,{shouldFadeOut:r,delay:500,css:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingLeft:8},children:(0,f.tZ)(eK,(0,d._)({},e))},"format"+n)},eY=function(e){var t=e.formatSuggestions,n=e.handleApplyAllFormat,r=e.handleSelect,o=e.formatApplyResults,i=e.formatApplyingStatus,a=(0,_.useRef)(null),c=(0,er.F)().colors,s=(0,_.useMemo)(function(){return{checkedCount:t.filter(function(e){var t=e.checked,n=e.resolved;return t&&!n}).length,remainedCount:t.filter(function(e){return!e.resolved}).length,hasFormatSuggestions:t.length>0}},[t]),u=s.checkedCount,l=s.remainedCount,d=s.hasFormatSuggestions;return d?l?(0,f.BX)(F.xu,{fontSize:12,color:"MapText03A",children:[(0,f.BX)(F.kC,{justifyContent:"space-between",alignItems:"center",px:"8px",mb:"8px",children:[(0,f.tZ)(ea,{count:u,children:(0,f.BX)(F.kC,{alignItems:"center",children:[(0,f.tZ)(eo.Z,{size:16,css:{marginRight:4}}),"发现以下优化建议"]})}),"loading"!==i&&d&&(0,f.BX)(en.ZP,{preset:"plain",ref:a,disabled:0===u,onClick:n,css:{marginLeft:"8px",fontSize:"12px",fontWeight:"500"},children:["default"===i&&(0,f.tZ)(H.ZAShow,{as:"span",zaType:"Button",zaText:!0,css:{color:u>0?c.MapBrand:c.MapText06A},zaModuleId:"ai_creation_intellige_typeset_all_apply",children:"一键应用"}),"success"===i&&u>0&&(0,f.tZ)("span",{css:{color:c.MapUIAccentC},children:"已完成"})]}),"loading"===i&&(0,f.tZ)(F.xv,{css:{position:"relative"},children:(0,f.tZ)(eg.Z,{css:{width:12,"& .path":{stroke:c.MapInfoSub}}})})]}),t.map(function(e,t){return(0,f.tZ)(ej,{item:e,index:t,handleSelect:r,formatApplyResults:o},t)})]}):(0,f.tZ)(ei,{children:"\uD83D\uDC4F 已完成全部修改"}):(0,f.tZ)(ei,{children:"\uD83D\uDC4F 暂无排版建议，请继续创作吧"})},eQ=function(e){var t=e.editorState,n=e.setEditorState,r=e.shouldReset,o=(0,p._)((0,_.useState)(!1),2),i=o[0],a=o[1],c=ef().setDetectionStatus;return(0,_.useEffect)(function(){r&&a(!1)},[r]),{isPreambleInserted:i,insertPreamble:function(e){if(!i&&e){c(e6.APPLYING);var r=t.getCurrentContent(),o=r.getFirstBlock().getKey(),s=t.getSelection().merge({anchorKey:o,anchorOffset:0,focusKey:o,focusOffset:0,isBackward:!1}),u=m.Modifier.splitBlock(r,s),l=u.getFirstBlock().getKey(),d=new m.SelectionState({anchorKey:l,anchorOffset:0,focusKey:l,focusOffset:0});u=m.Modifier.insertText(u,d,e),u=m.Modifier.setBlockType(u,d,"blockquote");var p=m.EditorState.push(t,u,"insert-fragment"),f=new m.SelectionState({anchorKey:l,anchorOffset:0,focusKey:l,focusOffset:0,hasFocus:!0});n(p=m.EditorState.forceSelection(p,f)),a(!0),c(e6.DEFAULT)}}}},eJ=function(e){var t=e.item,n=e.editorState,r=e.setEditorState,o=e.index,i=(0,p._)((0,_.useState)("default"),2),a=i[0],c=i[1],s=(0,_.useRef)(null),u=(0,er.F)().colors,l=ef().detectionStatus,d=eQ({editorState:n,setEditorState:r,shouldReset:"default"===a}),m=d.isPreambleInserted,g=d.insertPreamble,T=(0,h.A)(function(){"default"===a&&l!==e6.DETECTING&&l!==e6.APPLYING&&(c("pending"),g(t.text))});(0,_.useEffect)(function(){m&&(c("adopted"),s.current=setTimeout(function(){c("default")},3e3))},[m]);var E="default"!==a;return(0,_.useEffect)(function(){return function(){s.current&&clearTimeout(s.current)}},[]),(0,f.tZ)(F.kC,{id:t.id,alignItems:"flex-start",css:{padding:"6px 8px",marginBottom:2,gap:4,borderRadius:4,"&:hover":{backgroundColor:u.MapUIFrame10A}},children:(0,f.BX)(F.kC,{pl:"8px",alignItems:"flex-start",justifyContent:"space-between",css:{borderLeft:"3px solid ".concat(u.MapUIFrame09A)},children:[(0,f.tZ)(F.kC,{alignItems:"flex-start",children:t.text}),(0,f.tZ)(H.ZAClick,{shouldTrackShow:!0,zaType:"Button",zaModuleId:"ai_creation_assistant_insert_text",zaModuleIndex:o,extra:{configMap:{ai_create_suggestion_id:String(t.id),ai_create_suggestion_type:"introduction"}},as:en.ZP,preset:"plain",color:"blue",disabled:E,css:{minWidth:36,flexShrink:0,fontSize:"12px",whiteSpace:"nowrap",opacity:E?.6:1,cursor:E?"not-allowed":"pointer"},onClick:T,children:function(){switch(a){case"pending":return"采纳中";case"adopted":return"已采纳";default:return"采纳"}}()})]})})},e$={icon:(0,f.tZ)(X.Z,{size:16,css:function(e){return{fill:e.colors.MapBrand}}}),title:"内容检测",description:"识别错别字，提供用词优化建议",businessType:1,detectingText:"正在检测中...",component:function(e){var t,n,r=e.currentEditorState,o=e.result,i=e.setEditorState,a=e.activeId,c=e.setHighlightId,s=e.onStateUpdate,u=ef().detectionStatus,l=(0,p._)((0,_.useState)(o.displayedCorrections||[]),2),d=l[0],h=l[1],m=(0,p._)((0,_.useState)(o.correctionsResultState||{}),2),g=m[0],T=m[1],E=(0,p._)((0,_.useState)(o.needDelayRender||!1),2),y=E[0],C=E[1],S=(0,p._)((0,_.useState)("default"),2),I=S[0],A=S[1],b=(0,p._)((0,_.useState)([]),2),w=b[0],Z=b[1];(0,_.useEffect)(function(){s(o.detectId,{displayedCorrections:d,correctionsResultState:g,needDelayRender:y})},[g,d,y,s,o.detectId]),em(o,g,h,y);var x=e_({currentEditorState:r,setEditorState:i,setCorrectionsResultState:T,setNeedDelayRender:C}).applyCorrections,k=ev({currentEditorState:r,setEditorState:i,setCorrectionsResultState:T,setNeedDelayRender:C}).handleIgnore;ed(I,w,g,A,Z);var R=(t=(0,$._)(function(e){return(0,et.__generator)(this,function(t){switch(t.label){case 0:if(u===e6.APPLYING||u===e6.DETECTING)return[2];return C(!0),[4,k(e)];case 1:return t.sent(),[2]}})}),function(e){return t.apply(this,arguments)});return(0,f.tZ)(ew,{currentEditorState:r,corrections:d,correctionTotalSuggestions:null===(n=o.correction)||void 0===n?void 0:n.totalSuggestions,applyCorrections:x,handleIgnoreCorrection:R,correctionsResultState:g,handleApplyAllCorrections:function(){if((null==o?void 0:null===(t=o.correction)||void 0===t?void 0:null===(n=t.list)||void 0===n?void 0:n.length)&&"default"===I){A("loading");var e,t,n,r=o.correction.list.filter(function(e){return!g[e.id]});if(0===r.length){A("success");return}Z(r),r.forEach((e=(0,$._)(function(e){return(0,et.__generator)(this,function(t){switch(t.label){case 0:return[4,x(e,!0)];case 1:return t.sent(),[2]}})}),function(t){return e.apply(this,arguments)}))}},applyingAll:I,setEditorState:i,activeId:a,setHighlightId:c})},contentLengthSensitive:!0},e0={icon:(0,f.tZ)(K.Z,{size:16,css:function(e){return{fill:e.colors.MapUIAccentC}}}),title:"智能排版",description:"自动修正空格、标点及英文大小写",businessType:0,detectingText:"正在检测中...",component:function(e){var t=e.currentEditorState,n=e.result,r=e.setEditorState,o=e.onStateUpdate,i=e.isApplyingFormatRef,a=e.setDetectionResults,c=ef(),s=c.detectionStatus,u=c.setDetectionStatus,l=(0,H.useTracker)().trackEvent,m=(0,p._)((0,_.useState)("default"),2),g=m[0],T=m[1],E=(0,p._)((0,_.useState)(n.formatSuggestions),2),y=E[0],C=E[1],S=(0,_.useRef)(ex()(function(e){C(e)},300)).current,I=(0,_.useMemo)(function(){return y.reduce(function(e,t){return t.checked?e.checkedItemsCount++:!t.resolved&&e.remainingCount++,e},{checkedItemsCount:0,remainingCount:0})},[y]),b=I.checkedItemsCount,w=I.remainingCount;(0,_.useEffect)(function(){o(n.detectId,{formatApplyingStatus:g})},[g,o,n.detectId]);var Z=eH({setDetectionResult:(0,h.A)(function(e){C(e),a(function(t){var r=t.findIndex(function(e){return e.detectId===n.detectId});if(-1===r)return t;var o=(0,A._)(t);return o[r]=(0,k._)((0,d._)({},o[r]),{formatSuggestions:e}),o})}),currentEditorState:t,setEditorState:r,formatSuggestions:y,isApplyingFormatRef:i,formatApplyingStatus:g}),x=Z.formatApplyResults,R=Z.handleApplyAllFormat,N=(0,h.A)(function(e,t){var n=e.target.checked;S(function(e){var r=(0,A._)(e),o=r.findIndex(function(e){return e.type===t});return o>-1&&(r[o]=(0,k._)((0,d._)({},r[o]),{checked:n})),r}),n&&"success"===g&&T("default")}),O=(0,h.A)((0,$._)(function(){return(0,et.__generator)(this,function(e){switch(e.label){case 0:if("loading"===g||s===e6.APPLYING||s===s.DETECTING||!b)return[2];l({eventType:"Click",elementLocation:{type:"Button",moduleId:"ai_creation_intellige_typeset_all_apply"}}),e.label=1;case 1:return e.trys.push([1,3,,4]),T("loading"),u(e6.APPLYING),[4,R()];case 2:return e.sent(),w>0?T("default"):T("success"),u(e6.DEFAULT),[3,4];case 3:return e.sent(),T("default"),u(e6.DEFAULT),[3,4];case 4:return[2]}})}));return(0,f.tZ)(eY,{formatSuggestions:y,handleApplyAllFormat:O,handleSelect:N,formatApplyResults:x,formatApplyingStatus:g})},contentLengthSensitive:!0},e1={icon:(0,f.tZ)(j.ZP,{size:16,css:function(e){return{fill:e.colors.MapUIAccentA}}}),title:"智能标题",description:"提供更多标题灵感，内容更出彩",businessType:3,detectingText:"正在总结标题中...",component:function(e){var t=e.result,n=e.setContentTitle,r=t.aiTitles.list||[],o=(0,h.A)(function(e){n(e)});return(0,f.tZ)(el,{title:"已经基于原文为你生成标题",items:r,emptyText:"暂无可用标题",onAdopt:o})},contentLengthSensitive:!0},e2={icon:(0,f.tZ)(Y.Z,{size:16,css:function(e){return{fill:e.colors.MapFavorite}}}),title:"提取导语",description:"理清全文思路，轻松创作导语",businessType:2,detectingText:"正在提取导语中...",component:function(e){var t=e.result,n=e.editorState,r=e.setEditorState,o=e.setContentTitle,i=t.introductions.list||[];return(0,f.BX)(F.xu,{fontSize:12,color:"MapText03A",children:[(0,f.tZ)(ea,{css:{padding:"0 8px",marginBottom:8},children:(0,f.BX)(F.kC,{alignItems:"center",children:[(0,f.tZ)(eo.Z,{size:16,css:{marginRight:4}}),"为你提取导语"]})}),i.length>0?i.map(function(e,t){return(0,f.tZ)(eJ,{item:e,index:t,editorState:n,setEditorState:r,setContentTitle:o},t)}):(0,f.tZ)(F.xv,{color:"MapText06A",children:"暂无可用导语"})]})},contentLengthSensitive:!0},e3={icon:(0,f.tZ)(Q.Z,{size:16,css:function(e){return{fill:e.colors.MapEvent}}}),title:"AI 配图",description:"输入你的图片灵感",businessType:4,detectingText:"图片生成中...",contentLengthSensitive:!1},e4={answer:[e$,e0,e2,e3,{icon:(0,f.tZ)(J.Z,{size:16,css:function(e){return{fill:e.colors.MapText06A}}}),title:"更多功能",description:"持续更新中，敬请期待！"}],article:[e$,e0,e1,e2,e3]},e5={0:e0,1:e$,2:e2,3:e1,4:e3},e6={DEFAULT:"default",NOT_ALLOWED:"not_allowed",ALLOWED:"allowed",DETECTING:"detecting",COMPLETED:"completed",ERROR:"error",APPLYING:"applying",PREPARING:"preparing",PROCESSING:"processing",TERMINATED:"terminated"},e7={GENERATING:"generating",SUCCESS:"success",FAILED:"failed"},e8={insertSpace:"在中英文、汉字与数字间插入空格",convertCase:"常用英文大小写书写规范",replaceQuotationMark:"使用直角引号「」替换双引号（\"\"）、『』替换单引号（''）"},e9=[{text:"纪实",id:"realistic",image:"https://pic1.zhimg.com/v2-001104ca9432b39e073fc7bcca514552.png",isDefault:!0},{text:"水彩",id:"watercolor",image:"https://pic1.zhimg.com/v2-001104ca9432b39e073fc7bcca514552.png",isDefault:!1},{text:"油画",id:"oil_painting",image:"https://pic1.zhimg.com/v2-f9cc81b2d375731c326e476aaabbda2e.png",isDefault:!1},{id:"wallpaper",text:"壁纸",image:"https://pic1.zhimg.com/v2-f9cc81b2d375731c326e476aaabbda2e.png",isDefault:!1},{text:"插画",id:"illustration",image:"https://picx.zhimg.com/v2-0fb663cc3338091f7a6ef6931563220b.png",isDefault:!1}],te=[{id:"16:9",text:"16:9",width:21,height:12,previewWidth:1280,previewHeight:720},{id:"4:3",text:"4:3",width:21,height:16,previewWidth:1152,previewHeight:864},{id:"3:4",text:"3:4",width:16,height:21,previewWidth:864,previewHeight:1152},{id:"1:1",text:"1:1",width:16,height:16,previewWidth:1024,previewHeight:1024,isDefault:!0}],tt="global::aiAssistantImageStyles",tn=n(92258),tr=n(67927),to=n(9813),ti=n(99281),ta=(0,ti.n2)({remainingCount:0}),tc=function(){return(0,ti.aO)(ta)},ts=function(){return(0,ti.Bn)(ta,to.ZP)},tu=function(e){var t=e.aiImageLicenseState,n=e.setDetectionResults,r=e.detectionStatus,o=(0,p._)((0,_.useState)(!1),2),i=o[0],a=o[1],c=(0,tn.useDispatch)(),s=tc().remainingCount,u=(0,h.A)(function(){if(r===e6.DETECTING||r===e6.PROCESSING){c((0,tr.c0)("有在进行中的任务，请稍后重试","red"));return}if("loaded"===t.termLoadingState){if(t.hasPermission){if(0===s){c((0,tr.c0)("今日次数已用完","red"));return}n(function(e){return(0,A._)(e).concat([{businessType:4,status:"preparing"}])})}else a(!0)}else"error"===t.termLoadingState&&c((0,tr.c0)("获取协议同意状态失败，请重试","red"))}),l=(0,h.A)(function(){a(!1),u()});return{showAiImageTerm:i,showAiImageInput:u,handleAiImageTermAgree:l,handleAiImageTermClose:(0,h.A)(function(){a(!1)})}},tl=n(67516),td=n.n(tl),tp=n(19064),tf=(0,ti.n2)({hasPermission:!1,termLoadingState:"loading"}),th=function(){return(0,ti.aO)(tf)},t_=function(){return(0,ti.Bn)(tf,to.ZP)},tm=function(){var e=(0,W.Z)(),t=t_(),n=ts(),r=(0,tp.p3)().isAIImageEnabled,o=(0,h.A)(function(){if(!r){t(function(e){e.termLoadingState="loaded"});return}e("/ai/task/terms?business_type=4").then(function(e){var r=e.payload.data,o=r.hasPermission,i=r.remainingTimes,a=r.styles;t(function(e){e.hasPermission=o,e.termLoadingState="loaded"}),void 0!==i&&n(function(e){e.remainingCount=i}),a&&a.length>0&&td().set(tt,a)}).catch(function(){t(function(e){e.termLoadingState="error"})})});(0,eI.b)(function(){o()})},tv="/ai/task",tg=(r=(0,$._)(function(e,t,n,r){return(0,et.__generator)(this,function(o){switch(o.label){case 0:return[4,e("".concat(tv,"/submit"),{method:"POST",body:{subject_info:t,task_info:n},signal:r})];case 1:return[2,o.sent()]}})}),function(e,t,n,o){return r.apply(this,arguments)}),tT=(o=(0,$._)(function(e,t,n){var r,o,i;return(0,et.__generator)(this,function(a){switch(a.label){case 0:return r=t.content_id,o=t.content_type,i=t.business_type,[4,e("".concat(tv,"/permission?content_id=").concat(r,"&content_type=").concat(o,"&business_type=").concat(i),{method:"GET",signal:n})];case 1:return[2,a.sent()]}})}),function(e,t,n){return o.apply(this,arguments)}),tE=(i=(0,$._)(function(e,t,n){var r,o,i,a,c,s;return(0,et.__generator)(this,function(u){switch(u.label){case 0:r=30,o=0,u.label=1;case 1:if(!(o<r))return[3,7];u.label=2;case 2:return u.trys.push([2,5,,6]),o++,[4,e("".concat(tv,"/result?task_id=").concat(t),{method:"GET",signal:n})];case 3:if((null==(c=u.sent())?void 0:null===(i=c.payload)||void 0===i?void 0:null===(a=i.data)||void 0===a?void 0:a.taskStatus)!=="TaskStatusProcessing")return[2,c];return[4,new Promise(function(e){return setTimeout(e,1e3)})];case 4:return u.sent(),[3,6];case 5:throw s=u.sent(),Error("Polling failed: ".concat(s.message));case 6:return[3,1];case 7:throw Error("Task polling exceeded maximum attempts (".concat(r,"). Task may still be processing."))}})}),function(e,t,n){return i.apply(this,arguments)}),ty=(a=(0,$._)(function(e,t,n){var r,o,i,a,c,s,u,l,d,p,f,h,_,m,g;return(0,et.__generator)(this,function(T){switch(T.label){case 0:r=n.onProgress,o=n.signal,i=2e3,a=6e4,c=Date.now(),T.label=1;case 1:if(Date.now()-c>a){var E;throw(E=Error("请求超时，请重试")).name="TimeoutError",E}if(null==o?void 0:o.aborted)throw Error("Task cancelled");T.label=2;case 2:return T.trys.push([2,5,,6]),[4,e("".concat(tv,"/result?task_id=").concat(t,"&business_type=4"),{method:"GET",signal:o})];case 3:if(l=(u=(s=T.sent()).payload.data).taskStatus,p=(d=u.aiImage||{}).images,f=d.totalCount,h=d.successCount,_=d.failedCount,m=d.remainingTimes,r&&r({images:p,status:l,totalCount:f,successCount:h,failedCount:_,remainingTimes:m}),["success","failed","partial_success"].includes(l))return[2,s.payload.data];return[4,new Promise(function(e){return setTimeout(e,i)})];case 4:return T.sent(),[3,6];case 5:if(g=T.sent(),null==o?void 0:o.aborted)throw Error("Task cancelled");throw g;case 6:return[3,1];case 7:return[2]}})}),function(e,t,n){return a.apply(this,arguments)}),tC=function(e){var t=e.businessType,n=e.taskStatus,r=void 0===n?"TaskStatusFailed":n,o=e.errorMessage,i=e.resultData,a=void 0===i?null:i,c={businessType:t,detectId:"".concat(Date.now(),"_").concat(t),displayedCorrections:[],correctionsResultState:{},needDelayRender:!1,taskStatus:r};return"TaskStatusSuccess"===r&&a?(0,d._)({},a,c):(0,k._)((0,d._)({},c),{errorMessage:void 0===o?null:o})},tS=n(12627),tI=(c=(0,$._)(function(e,t,n,r){var o,i,a;return(0,et.__generator)(this,function(c){switch(c.label){case 0:return[4,tT(e,(0,d._)({},t,n),r)];case 1:return[2,!!(null==(a=c.sent())?void 0:null===(o=a.payload)||void 0===o?void 0:null===(i=o.data)||void 0===i?void 0:i.aiTaskPermission)]}})}),function(e,t,n,r){return c.apply(this,arguments)}),tA=(s=(0,$._)(function(e,t,n,r,o,i){var a,c,s;return(0,et.__generator)(this,function(u){switch(u.label){case 0:return c=i(),s=(0,tS.ME)({source:"AIAssistantPanel_generatePreamble",editorKey:null==c?void 0:null===(a=c.getEditorKey)||void 0===a?void 0:a.call(c)})(t,{outputBlockType:"p",middlewares:(null==c?void 0:c.draft2htmlMiddlwares)||[]}),[4,tg(e,(0,k._)((0,d._)({},n),{original_content:s}),r,o)];case 1:return[4,tE(e,u.sent().payload.data.taskId,o)];case 2:return[2,u.sent()]}})}),function(e,t,n,r,o,i){return s.apply(this,arguments)}),tb=function(e){var t,n=e.currentEditorState,r=e.contentId,o=e.contentType,i=e.getEditableCore,a=e.setDetectionResults,c=e.setCurrentFeatureType,s=e.setDetectionStatus,u=e.abortControllerRef,l=e.http,d=(0,_.useRef)(!0);(0,_.useEffect)(function(){return function(){d.current=!1,u.current&&(u.current.abort(),u.current=null)}},[u]);var p=(0,h.A)(function(e,t){d.current&&(a(function(t){return(0,A._)(t).concat([e])}),c(-1),s(t))}),f=(0,h.A)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"似乎出了点问题，请稍后重试";d.current&&p(tC({businessType:e,taskStatus:"TaskStatusFailed",errorMessage:t}),e6.ERROR)});return(0,h.A)((t=(0,$._)(function(e){var t,a,c,s,h;return(0,et.__generator)(this,function(_){switch(_.label){case 0:u.current&&u.current.abort(),t=new AbortController,u.current=t,a={content_id:r,content_type:o},c={business_type:e},_.label=1;case 1:return _.trys.push([1,4,5,6]),[4,tI(l,a,c,t.signal)];case 2:if(!_.sent())return s=2===e?"导语":"标题",f(e,"本篇".concat(s,"次数已用完，试试采纳之前的").concat(s,"结果吧")),[2];return[4,tA(l,n.getCurrentContent(),a,c,t.signal,i)];case 3:if(h=_.sent(),t.signal.aborted||!d.current)return[2];return"TaskStatusSuccess"===h.payload.data.taskStatus?p(tC({businessType:e,taskStatus:"TaskStatusSuccess",resultData:h.payload.data}),e6.COMPLETED):"TaskStatusFailed"===h.payload.data.taskStatus&&f(e),[3,6];case 4:if("AbortError"===_.sent().name||t.signal.aborted)return[2];return f(e),[3,6];case 5:return u.current===t&&(u.current=null),[7];case 6:return[2]}})}),function(e){return t.apply(this,arguments)}))},tw=function(e,t,n,r,o,i){var a=(0,_.useRef)(e),c=(0,_.useRef)(null),s=(0,_.useMemo)(function(){var t,n=null==e?void 0:e.getCurrentContent();return(null===(t=null==n?void 0:n.getPlainText())||void 0===t?void 0:t.length)===0},[e]),u=(0,_.useMemo)(function(){var t,n=null==e?void 0:e.getCurrentContent(),r=null==a?void 0:null===(t=a.current)||void 0===t?void 0:t.getCurrentContent();return(null==n?void 0:n.getPlainText())!==(null==r?void 0:r.getPlainText())},[e]),l=(0,_.useMemo)(function(){if(!t||0===t.length)return null;var e=[],n=0,r=t.filter(function(e){var t,n;return(null===(t=e.correction)||void 0===t?void 0:null===(n=t.list)||void 0===n?void 0:n.length)>0});return 0===r.length?null:(r.forEach(function(t){var r=t.correction.list.filter(function(e){return!t.correctionsResultState[e.id]}).map(function(e){return(0,k._)((0,d._)({},e),{id:"".concat(e.id,"_").concat(t.detectId),originalId:e.id,sourceDetectId:t.detectId,sourceFeature:t.featureName})});e.push.apply(e,(0,A._)(r)),n+=t.correction.totalSuggestions}),{totalSuggestions:n,list:e})},[t]);(0,_.useEffect)(function(){if(e&&!s&&l&&(null==l?void 0:l.totalSuggestions)!==0&&(r||u)){c.current&&clearTimeout(c.current);var t=y(l.list,e);if(null==t?void 0:t.length){var d=M(e,t,r);c.current=setTimeout(function(){n(d)},0);var p=new Map;t.forEach(function(e){if(e.id&&e.highlightSelection){var t=I(e.highlightSelection);p.set(t,e.id)}}),i(p),o(!1),a.current=e}}},[e,l,n,s,u,r,o,i]),(0,_.useEffect)(function(){return function(){c.current&&clearTimeout(c.current)}},[])},tZ=function(e){var t=e.currentEditorState,n=e.contentId,r=e.contentType,o=e.http,i=e.setDetectionStatus,a=e.setDetectionResults,c=e.setCurrentFeatureType,s=e.abortControllerRef,u=e.setHighlightTrigger,l=e.getContentTitle,d=e.getEditableCore,p=e.setEditorState,f=(0,h.A)(function(e,t){a(function(t){return(0,A._)(t).concat([e])}),c(-1),i(t)});return(0,h.A)((0,$._)(function(){var e,i,a,c,h,_,m,g,T,E,y,C=arguments;return(0,et.__generator)(this,function(S){switch(S.label){case 0:p(i=1===(e=(C.length>0&&void 0!==C[0]?C[0]:{}).businessType)?B(t):t),s.current&&s.current.abort(),a=new AbortController,s.current=a,c=i.getCurrentContent(),h=d(),_=(_=(0,tS.ME)({source:"AIAssistantPanel_contentDetection",editorKey:null==h?void 0:h.getEditorKey()})(c,{outputBlockType:"p",middlewares:(null==h?void 0:h.draft2htmlMiddlwares)||[]})).replace(/  +/g,function(e){return"&nbsp;".repeat(e.length)}),S.label=1;case 1:if(S.trys.push([1,4,5,6]),0===e)return m=eO(i),(g={}).formatSuggestions=m,f(tC({businessType:e,taskStatus:"TaskStatusSuccess",resultData:g}),e6.COMPLETED),[2];return[4,tg(o,{content_id:n,content_type:r,original_content:_,content_title:l()},{business_type:e},a.signal)];case 2:if(T=S.sent(),a.signal.aborted)return[2];return[4,tE(o,T.payload.data.taskId,a.signal)];case 3:if(E=S.sent()){if("TaskStatusFailed"===E.payload.data.taskStatus)return f(tC({businessType:e,taskStatus:"TaskStatusFailed"}),e6.ERROR),[2];f(tC({businessType:e,taskStatus:"TaskStatusSuccess",resultData:y=O(E)}),e6.COMPLETED),y.correction.totalSuggestions>0&&u(!0)}return[3,6];case 4:if("AbortError"===S.sent().name||a.signal.aborted)return[2];return f(tC({businessType:e,taskStatus:"TaskStatusFailed"}),e6.ERROR),[3,6];case 5:return s.current===a&&(s.current=null),[7];case 6:return[2]}})}))},tx=n(65003),tk=function(e){var t=(0,h.A)(function(e,t){return!!e&&!!t&&["displayedCorrections","correctionsResultState","needDelayRender","formatApplyingStatus","internalCheckedState"].every(function(n){var r=e[n],o=t[n];if(r===o)return!0;if("needDelayRender"===n)return!!r==!!o;if("formatApplyingStatus"===n)return String(r)===String(o);if("displayedCorrections"===n)return!!(Array.isArray(r)&&Array.isArray(o))&&r.length===o.length&&r.every(function(e,t){var n=o[t];return e.id===n.id&&e.occurrence===n.occurrence&&e.originalIndex===n.originalIndex});if("correctionsResultState"===n||"internalCheckedState"===n){if("object"!=typeof r||"object"!=typeof o)return!1;var i=Object.keys(r||{}),a=Object.keys(o||{});return i.length===a.length&&i.every(function(e){return r[e]===o[e]})}return!1})});return{updateDetectionResult:(0,h.A)(function(n,r){e(function(e){var o=e.findIndex(function(e){return e.detectId===n});if(-1===o)return e;var i=e[o];if(t(i,r))return e;var a=(0,A._)(e);return a[o]=(0,d._)({},i,r),a})}),removeDetectionResult:(0,h.A)(function(t){e(function(e){return e.filter(function(e){return e.detectId!==t})})}),clearDetectionResults:(0,h.A)(function(){e([])})}},tR=n(17347),tN=n(9539),tO=(u=null,function(){return u||(u=new tR.h5("aiAssistantResults")),u}),tP=function(){var e,t,n;return{saveDetectionData:(0,_.useCallback)((e=(0,$._)(function(e,t){var n;return(0,et.__generator)(this,function(r){switch(r.label){case 0:if(!e)return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),n=(0,tN.Z)(Date.now(),7),[4,tO().set(e,t,n)];case 2:return r.sent(),[3,4];case 3:return console.error("保存检测数据失败:",r.sent()),[3,4];case 4:return[2]}})}),function(t,n){return e.apply(this,arguments)}),[]),loadDetectionData:(0,_.useCallback)((t=(0,$._)(function(e){return(0,et.__generator)(this,function(t){switch(t.label){case 0:if(!e)return[2,null];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,tO().get(e)];case 2:return[2,t.sent()];case 3:return console.error("加载检测数据失败:",t.sent()),[2,null];case 4:return[2]}})}),function(e){return t.apply(this,arguments)}),[]),clearStorage:(0,_.useCallback)((n=(0,$._)(function(e){return(0,et.__generator)(this,function(t){switch(t.label){case 0:if(!e)return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,tO().del(e)];case 2:return t.sent(),[2,!0];case 3:return t.sent(),[2,!1];case 4:return[2]}})}),function(e){return n.apply(this,arguments)}),[])}},tD=function(e){var t=e.detectionStatus,n=e.setDetectionStatus,r=e.setContentLength,o=e.setCurrentEditorState;return(0,h.A)(function(e,i){if(o(e),i.contentChanged){var a=i.contentLength;if(r(a),0===a){n(e6.DEFAULT);return}if(a>=1&&a<300){n(e6.NOT_ALLOWED);return}t!==e6.DETECTING&&t!==e6.COMPLETED&&n(e6.ALLOWED)}})},tL=function(e,t,n,r){var o=tP().loadDetectionData;(0,_.useEffect)(function(){if(e){var t;(t=(0,$._)(function(){var t;return(0,et.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,o(e)];case 1:return(t=n.sent())&&t.detectionResults&&Array.isArray(t.detectionResults)&&r(t.detectionResults.filter(function(e){return 4!==e.businessType||["completed","success","partial_success"].includes(e.status)})),[3,3];case 2:return console.error("初始化缓存数据失败:",n.sent()),[3,3];case 3:return[2]}})}),function(){return t.apply(this,arguments)})()}},[e,t,n,r,o])},tM=n(82644),tB=n(61533),tU=n(91486),tG=n(58245),tF=n(91850),tH=n(74963),tz=n(80714),tq=function(e){var t,n=e.mode,r=e.onAgree,o=(0,tn.useDispatch)(),i=(0,p._)((0,tF.k)(),2),a=i[0],c=i[1],s=t_(),u=ts(),l=(0,W.Z)(),h=(t=(0,$._)(function(){var e,t,n;return(0,et.__generator)(this,function(i){switch(i.label){case 0:if(!a)return o((0,tr.c0)("请先同意使用条款","red")),[2];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,l("/ai/task/terms",{method:"POST",body:JSON.stringify({business_type:4}),headers:{"Content-Type":"application/json"}})];case 2:return t=(e=i.sent().payload.data).hasPermission,n=e.remainingTimes,s(function(e){e.hasPermission=t}),void 0!==n&&u(function(e){e.remainingCount=n}),null==r||r(),[3,4];case 3:return i.sent(),o((0,tr.c0)("出错了，请稍后再试","red")),[3,4];case 4:return[2]}})}),function(){return t.apply(this,arguments)});return(0,f.BX)(H.ZAShow,{zaType:"Block",zaModuleId:"ai_image_authorization",as:F.xu,css:{position:"relative",backgroundColor:"white",borderRadius:"8px",boxShadow:"0 2px 16px rgba(0, 0, 0, 0.15)",width:"746px",height:"agree"===n?"664px":"614px",display:"flex",flexDirection:"column"},children:[(0,f.BX)(F.kC,{flexDirection:"column",p:"20px",css:{flex:1,overflow:"hidden",gap:"20px"},children:[(0,f.tZ)(F.xv,{as:"h1",fontSize:19,lineHeight:"26px",fontWeight:"bold",color:"MapText03A",textAlign:"center",m:0,children:"知乎 AI 配图功能使用条款"}),(0,f.tZ)(F.xu,{flex:1,color:"MapText03A",fontSize:13,lineHeight:"24px",css:{overflow:"auto",h1:{fontSize:"13px",fontWeight:"bold",margin:"16px 0 8px"},h2:{fontSize:"13px",fontWeight:"bold",margin:"16px 0 8px"},p:{margin:"0 0 8px"},"p:last-child":{marginBottom:0}},children:(0,f.tZ)(tH.Z,{text:"### AI 配图功能使用条款\n\n为使用知乎平台 AI 配图功能（以下简称「AI 配图」），你应当阅读并遵守《知乎平台 AI 配图功能使用条款》（以下简称「本条款」），本条款为[《知乎协议》](https://www.zhihu.com/term/zhihu-terms)的特别功能服务条款。\n\n#### 一、术语含义\n\n如无特别说明，下列术语在本协议中的含义为：\n\n1.1 知乎平台 AI 配图：指北京智者天下科技有限公司通过知乎平台向知乎用户提供的根据用户输入信息生成图片的功能。简称为「AI 配图功能」、「AI 配图」或者「本功能」。\n\n1.2 知乎平台 AI 配图功能生成图片：指在知乎平台 AI 配图功能中生成的单张或多张图片。简称为「生成图片」。\n\n1.3 知乎平台 AI 配图功能用户：指搜索、查看、使用知乎平台 AI 配图功能生成图片的知乎用户。视情况简称为「你」、「您」、「AI 配图用户」或者「知乎用户」。\n\n1.4 第三方生成技术服务：指由北京火山引擎科技有限公司提供的 Doubao Seedream 3.0 大模型（备案号：Beijing-FuLuGua-20231205）。\n\n#### 二、关于 AI 配图功能\n\n2.1 AI 配图功能是知乎以第三方生成技术服务为技术基础开发的向知乎用户提供的 AI 图片生成功能。本服务使用的模型算法机制情况如下：算法名称：豆包企业版大模型算法，备案编号：网信算备 110108823483901230065 号。\n\n2.2 你可以登录知乎，在编辑器「图片-上传图片-AI 配图」、「创作助手-AI 配图」功能下使用 AI 配图功能，或其它以「AI 配图」为标识的本功能入口，你可输入文字描述、关键词或参考图片以获取 AI 生成的图片。**通过此功能生成的图片仅限于在知乎平台场景内使用**。\n\n2.3 知乎有权决定可以开通 AI 配图功能的知乎用户的范围和条件等。\n\n2.4 **知乎非常重视 AI 生成图片的质量，将努力采取合理的安全措施以符合法律法规。如果你发现本功能输出的内容或返回的处理结果不合理、有瑕疵或其他问题，欢迎你随时向我们提出反馈。**\n\n#### 三、使用提示\n\n3.1 本功能需要你注册、登录知乎后使用。\n\n3.2 本功能涉及生成式人工智能能力，请科学理性使用。当使用时，请监护人合理引导和约束未成年人用户的使用，避免其过度依赖或者沉迷本功能。\n\n3.3 **受限于现有行业普遍的技术水平，我们无法保证本功能百分百准确可靠、无错误、无中断、不存在故障或者不符合内容主题；无法保障生成图片的准确性、完整性、时效性。你须对基于本功能生成输出的生成图片自行加以判断，并承担因使用内容引起的风险。我们会尽可能督促第三方生成技术服务提供方为你提供稳定优质的技术服务。**\n\n3.4 **生成图片仅供参考，不代表知乎的态度、观点或立场。**\n\n3.5 对于第三方生成技术服务，我们竭力保障与第三方合作的稳定性，但我们无法完全保证第三方能够长期持续稳定的在本功能项下向你提供某些特定技术/服务，当我们与第三方调整合作方式，或与第三方合作终止时，你可能无法继续以原有方式使用或继续使用该等第三方服务，届时，我们会尽量协调第三方为你提供解决方案。\n\n3.6 为提升用户体验，我们会自主更新本功能。同时，我们可能根据运营情况，对本功能的收费模式、收费标准、方式进行修改和变更，我们也可能会对由目前为免费使用的服务开始收费。\n\n#### 四、知乎的权利和义务\n\n4.1 知乎在现有技术水平下，最大限度维护本功能的正常运行，并努力提升和改进技术，保障你的产品和服务使用体验。\n\n4.2 **对于你在 AI 配图使用中的违法不当行为，或任何知乎认为应当终止服务的情况，知乎有权实施屏蔽相关信息、终止提供服务等处理措施，并将相关情况及时通知于你或通告有关部门。**\n\n4.3 知乎重视个人信息的安全，我们采取业内标准做法来保护你的个人信息，防止其遭到未经授权的访问、披露、使用、修改、损坏或丢失。详见[《个人信息保护指引》](https://www.zhihu.com/term/privacy)。\n\n4.4 **你理解并同意，为保障良好的用户体验，知乎会在收到图片版权方或知乎用户的投诉通知后，要求投诉方如实填写投诉内容、侵权类型和具体原因、投诉理由，并提供权利证明文件、相关机构颁发的合法证书、授权文件等。知乎会核实投诉是否成立，如投诉成立，知乎将对涉嫌违规的生成图片或包含生成图片的作品采取删除、屏蔽、断开链接等必要措施。**\n\n4.5 **你理解并同意，如你使用 AI 配图与其他第三方产生争议或法律纠纷，你需自行承担由此导致的法律责任，知乎无权也无依据参与你与第三方的争议解决。**\n\n#### 五、AI 配图用户的权利和义务\n\n5.1 你的行为应当符合[《知乎协议》](https://www.zhihu.com/term/zhihu-terms)和[《知乎社区规范》](https://zhuanlan.zhihu.com/p/506696688)中对于用户行为规范的相关约定。\n\n5.2 你应当在合法合规的前提下使用 AI 配图，不得将 AI 配图用于违反法律法规、政策及违背公序良俗、社会公德或干扰知乎平台正常运营和侵犯其他用户或第三方合法权益的目的。\n\n5.3 **你知悉并同意，AI 配图的生成图片由第三方生成技术服务提供方生成，知乎并非 AI 配图的权利方，你使用本功能并不代表知乎认可或担保你所使用的生成图片符合法律规定或不侵犯第三方的合法权利。**\n\n5.4 **你知悉并同意，知乎在收到图片版权方（或预训练图片数据权益方）或知乎用户投诉生成图片的通知后，如通过核实认为你使用的生成图片违反法律规定或侵犯第三方合法权利的，知乎将删除涉嫌违规的生成图片或删除包含生成图片的作品，并将处理结果向你通知。尽管如此，你对生成图片的使用在极端情况下仍有可能被图片版权方主张侵权并且最终侵权成立，对此你应当充分的知悉并同意。**\n\n5.5 你不得利用或针对本功能从事诈骗、欺诈、误导或欺骗性活动，包括但不限于假冒或将 AI 生成的图片标识为非 AI 生成、网络钓鱼，或从事其他任何违法违规活动。\n\n#### 六、关于生成图片的知识产权等权利\n\n6.1 你应保证你在使用本功能过程中自行提供、上传和处理的任何输入内容及该等行为本身知识产权等权利归属你或已获得权利人合法授权。你进一步保证，前述内容不存在任何权属争议，不得侵犯任何人的合法权益（包括但不限于知识产权、名誉权、姓名权、肖像权、隐私权、商业秘密等），否则由此产生的纠纷或风险由你自行承担。\n\n6.2 除非双方另有约定、我们另有权利保留声明、第三方生成技术服务提供方进行权利限制或法律法规另有规定的，你享有在使用本服务过程中基于创意智力投入而生成图片的知识产权。同时，你应对于生成图片的使用行为独立承担责任。\n\n#### 七、关于生成图片标识\n\n7.1 **我们将根据法律法规要求，对生成图片添加相应的人工智能生成合成内容标识，包括在生成图片适当位置添加的、可被用户明显感知的显式标识（如文字「AI 生图」），以及采取技术措施在生成图片文件数据中添加的、不易被用户明显感知的隐式标识（以下统称「AI 标识」）。你应仔细阅读并理解相关法律法规关于 AI 标识管理的要求，不得利用本功能制作、发布、传播虚假、不实、侵权等违反法律法规的信息。**\n\n7.2 **你知悉并同意，你不得以任何方式删除、篡改、伪造、隐匿或通过其他方式规避本功能默认添加的 AI 标识。对标识的任何形式的破坏，可能导致你承担相应的法律责任。**\n\n7.3 **若你依据我们提供的功能或另行申请获得移除显式标识的生成图片，你在发布、传播该生成图片时应以显著方式予以标识或提示该内容为人工智能生成合成内容。**\n\n#### 八、其他\n\n8.1 **本条款内容同时包括知乎的各项制度规范、其它本条款附件中的协议或规则、知乎可能不断发布的关于 AI 配图的其他相关协议、规则等内容。上述内容一经正式发布，即为本条款不可分割的组成部分，你同样应当遵守。上述内容与本条款存在冲突的，以本条款为准。一经注册或使用本条款下任何服务，即视为你已阅读并同意接受本条款及上述内容的约束。知乎有权在必要时单方修改本条款或上述内容，相关内容变更后，如果你继续使用 AI 配图，即视为你已接受修改后的相关内容。如果你不接受修改后的相关内容，应当停止使用相关功能。**\n\n8.2 **本条款签订地为中华人民共和国北京市海淀区。**\n\n8.3 **本条款的成立、生效、履行、解释及纠纷解决，适用中华人民共和国大陆地区法律（不包括冲突法）。**\n\n8.4 **若你和知乎之间发生任何纠纷或争议，首先应友好协商解决；协商不成功的，双方均同意将纠纷或争议提交本条款签订地有管辖权的人民法院解决。**\n\n8.5 本条款所有条款的标题仅为阅读方便，本身并无实际涵义，不能作为本条款涵义解释的依据。（完）\n"})})]}),"agree"===n&&(0,f.BX)(F.kC,{p:"13px 20px",bg:"MapUIFrame99A",justifyContent:"space-between",alignItems:"center",css:function(e){return(0,d._)({},(0,tG.M)({borderTop:"1px solid ".concat(e.colors.GBK09A)}))},children:[(0,f.BX)(F.kC,{fontSize:13,p:1,alignItems:"center",css:{gap:"4px"},children:[(0,f.BX)(F.kC,{as:"label",alignItems:"center",lineHeight:"19px",css:{gap:"4px",cursor:"pointer"},children:[(0,f.tZ)(tU.C,{shape:"circle",size:16,checked:a,onChange:function(){c.toggle()}}),(0,f.tZ)(F.xv,{color:"MapText03A",css:{whiteSpace:"nowrap"},children:"我已阅读并同意遵守"})]}),(0,f.tZ)(F.rU,{fontWeight:"bold",color:"MapLink",target:"_blank",href:"//".concat(tz.Z.wwwHost,"/term/ai-images"),css:{textDecoration:"none",whiteSpace:"nowrap","&:hover":{textDecoration:"underline"}},children:"《知乎 AI 配图功能使用条款》"})]}),(0,f.tZ)(H.ZAClick,{zaType:"Button",zaModuleId:"ai_image_agree_authorize",zaText:!0,as:en.ZP,preset:"primary",color:"blue",onClick:function(){h()},css:{fontSize:"14px",fontWeight:"bold",borderRadius:"3px",opacity:a?1:.4},children:"同意并继续"})]})]})};function tV(e){var t=e.handleAiImageTermClose,n=e.handleAiImageTermAgree,r=e.mode;return(0,tB.createPortal)((0,f.tZ)(F.kC,{justifyContent:"center",alignItems:"center",p:"20px",onClick:t,css:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:204,backgroundColor:"rgba(0, 0, 0, 0.5)"},children:(0,f.BX)(F.xu,{onClick:function(e){return e.stopPropagation()},css:{position:"relative"},children:[(0,f.tZ)(tq,{mode:void 0===r?"agree":r,onAgree:n}),(0,f.tZ)(F.kC,{as:"button",onClick:t,alignItems:"center",justifyContent:"center",p:0,color:"MapText99B",bg:"transparent",width:24,height:24,css:{position:"absolute",top:"20px",right:"-44px",border:"none",cursor:"pointer","&:hover":{opacity:.8}},children:(0,f.tZ)(tM.ZP,{size:24})})]})}),document.body)}function tW(){return(0,_.useMemo)(function(){try{var e=td().get(tt);if(e)return e.map(function(e){return{id:e.styleKey,text:e.styleName,image:e.thumbnailUrls[0]||"",isDefault:e.isDefault}})}catch(e){}return e9},[])}var tX=n(65871);function tK(e){var t=e.text,n=e.width,r=e.height;return(0,f.BX)(F.kC,{width:void 0===n?118:n,height:void 0===r?118:r,flexShrink:0,bg:"MapUIFrame10A",flexDirection:"column",justifyContent:"center",alignItems:"center",color:"MapUIFrame07A",css:{borderRadius:6,overflow:"hidden",pointerEvents:"none"},children:[(0,f.tZ)(tX.Z,{size:18}),(0,f.tZ)(F.xv,{fontSize:11,lineHeight:"16px",mt:1,children:void 0===t?"生成失败":t})]})}var tj=n(96366),tY=n(94172),tQ=n(99445),tJ=n(8282),t$={justifyContent:"center",alignItems:"center",color:"MapText99B",fontSize:11,lineHeight:"16px",fontWeight:"bold",css:function(e){return{whiteSpace:"nowrap",position:"absolute",bottom:8,left:"50%",transform:"translateX(-50%)",backgroundColor:e.colorMod(e.colors.MapUIFrame01A).alpha(.7),borderRadius:12,padding:"2px 8px",gap:2,cursor:"pointer"}}};function t0(e){var t=e.src,n=e.width,r=e.height,o=e.currentEditorState,i=e.setEditorState,a=e.images,c=e.index,s=e.data,u=(0,er.F)(),l=(0,p._)((0,_.useState)(!1),2),m=l[0],g=l[1],T=(0,p._)((0,_.useState)(!1),2),E=T[0],y=T[1],C=(0,p._)((0,_.useState)(null),2),S=C[0],I=C[1],A=(0,p._)((0,_.useState)("loading"),2),b=A[0],w=A[1],Z=(0,_.useRef)(null),x=(0,h.A)(function(e){if(e.stopPropagation(),o){var n=(0,tQ.Z)(o,"image","IMMUTABLE",{upload:{value:t},size:"normal"});null==i||i(n),y(!0),setTimeout(function(){y(!1)},3e3)}}),R=(0,h.A)(function(){Z.current&&I(Z.current)}),N=(0,h.A)(function(){I(null),Z.current&&(Z.current.style.visibility="visible")}),O="loaded"===b;return"failed"===b?(0,f.tZ)(tK,{text:"加载失败"}):(0,f.BX)(f.HY,{children:[(0,f.BX)(F.xu,(0,k._)((0,d._)({flexShrink:0,css:(0,d._)({position:"relative",width:void 0===n?118:n,height:void 0===r?118:r,borderRadius:6,overflow:"hidden"},O&&{cursor:"pointer","&:hover":{outline:"2px solid rgba(25, 103, 210, 1)"}})},O&&{onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)},onClick:R}),{children:[(0,f.tZ)("img",{ref:Z,src:t,alt:"",css:{width:"100%",height:"100%",objectFit:"cover",display:"block"},onLoad:function(){return w("loaded")},onError:function(){return w("failed")}}),"loading"===b&&(0,f.tZ)(F.xu,{css:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:u.colors.MapUIFrame10A,pointerEvents:"none"}}),O&&E&&(0,f.BX)(F.kC,(0,k._)((0,d._)({},t$),{children:[(0,f.tZ)(tj.Z,{size:12}),(0,f.tZ)(F.xv,{children:"已插入"})]})),O&&m&&!E&&(0,f.BX)(H.ZAClick,(0,k._)((0,d._)({as:F.kC,zaType:"Button",zaModuleId:"editor_ai_image_insert"},t$),{onClick:x,children:[(0,f.tZ)(tY.Z,{size:12}),(0,f.tZ)(F.xv,{children:"插入正文"})]}))]})),O&&S&&a&&s&&(0,f.tZ)(tJ.Z,{img:S,data:s,index:void 0===c?0:c,images:a,onClose:N,disableAILabel:!0})]})}var t1=function(e){var t=e.children;return(0,f.tZ)(F.xu,{px:"4px",py:"1px",fontSize:10,lineHeight:"14px",fontWeight:"bold",color:"MapText06A",css:function(e){return(0,d._)({},(0,tG.M)({borderRadius:8,border:"1px solid ".concat(e.colorMod(e.colors.MapText06A).alpha(.3))}))},children:t})};function t2(e){var t=e.images,n=e.totalCount,r=e.imageHeight,o=e.styleText,i=e.imageRatio,a=e.currentEditorState,c=e.setEditorState,s=e.status,u=e.isTimeout,l=(0,_.useMemo)(function(){if(!t||0===t.length)return{notFailedImagesCount:0,hasSuccessImages:!1};var e=!1,n=0;return t.forEach(function(t){t.status===e7.SUCCESS&&(e=!0),t.status!==e7.FAILED&&n++}),{notFailedImagesCount:n,hasSuccessImages:e}},[t]),d=l.notFailedImagesCount,p=l.hasSuccessImages,h=s===e6.PROCESSING||(u?p:d>0),m=(0,_.useMemo)(function(){var e=t.filter(function(e){return e.status===e7.SUCCESS}),n=function(e){var t=te.find(function(t){return t.id===e});if(!t){console.warn("[imageSize] 无效的图片比例: ".concat(e,", 已降级为默认值 1:1"));var n=te.find(function(e){return"isDefault"in e&&e.isDefault});return{width:n.previewWidth,height:n.previewHeight}}return{width:t.previewWidth,height:t.previewHeight}}(i||te[0].id),r=e.map(function(e){return{url:e.url,width:n.width,height:n.height}}),o=new Map(r.map(function(e,t){return[e.url,t]}));return{successImages:r,urlToIndexMap:o}},[t,i]),g=m.successImages,T=m.urlToIndexMap;return h?(0,f.BX)(f.HY,{children:[(0,f.tZ)(F.kC,{flexWrap:"wrap",mt:"12px",css:{gap:"6px"},children:Array.from({length:n},function(e,t){return t}).map(function(e){var n=t[e]||{};if(n.status===e7.SUCCESS){var o,i=null!==(o=T.get(n.url))&&void 0!==o?o:0,s=g[i];return(0,f.tZ)(t0,{src:n.url,width:118,height:r,currentEditorState:a,setEditorState:c,images:g,index:i,data:s},n.imageId)}return n.status===e7.FAILED?(0,f.tZ)(tK,{width:118,height:r},e):(0,f.tZ)(F.xu,{width:118,height:r,bg:"MapUIFrame10A",css:{borderRadius:"6px"}},e)})}),(0,f.BX)(F.kC,{mt:"8px",css:{gap:"6px"},children:[o&&(0,f.tZ)(t1,{children:o}),i&&(0,f.tZ)(t1,{children:i})]})]}):null}var t3=n(51695),t4=n(7562),t5=n(15021);function t6(e){var t=e.children,n=e.content,r=e.placement;return(0,f.tZ)(t5.Z,{placement:void 0===r?"top":r,toggleEvent:"hover",focusScope:!1,toggler:t,children:(0,f.tZ)(F.xu,{p:"8px 12px",fontSize:14,color:"MapText02A",css:{whiteSpace:"nowrap"},children:n})})}var t7=function(e){var t=e.onClick,n=e.children;return(0,f.tZ)(F.kC,{p:"4px",bg:"MapUIFrame10A",alignItems:"center",justifyContent:"center",as:"button",onClick:t,css:{borderRadius:"4px",border:"none",cursor:"pointer","&:hover":{opacity:.8}},children:n})};function t8(e){var t=e.status,n=e.onEdit,r=e.onRegenerate,o=e.title,i=(0,er.F)(),a=tc().remainingCount,c=(0,tn.useDispatch)(),s=(0,h.A)(function(e){return function(){if(0===a){c((0,tr.c0)("今日次数已用完","red"));return}e()}}),u=s(n),l=s(r);return(0,f.BX)(F.kC,{justifyContent:"space-between",alignItems:"center",children:[(0,f.tZ)(F.xv,{css:{fontSize:12,lineHeight:"22px",fontWeight:"bold",color:i.colors.MapText03A},children:void 0===o?"":o}),(0,f.tZ)(F.kC,{children:"processing"===t?(0,f.tZ)(F.xu,{pr:"5px",css:{position:"relative"},children:(0,f.tZ)(eg.Z,{css:{width:12,"& .path":{stroke:i.colors.MapInfoSub}}})}):(0,f.BX)(f.HY,{children:[(0,f.tZ)(F.xu,{mr:"8px",children:(0,f.tZ)(t6,{content:"重新编辑",children:(0,f.tZ)(H.ZAClick,{as:t7,zaType:"Button",zaModuleId:"editor_ai_image_reedit",onClick:u,children:(0,f.tZ)(t3.ZP,{size:14,css:{fill:i.colors.MapText03A}})})})}),(0,f.tZ)(t6,{content:"再次生成（今日剩余 ".concat(a," 次）"),children:(0,f.tZ)(H.ZAClick,{as:t7,zaType:"Button",zaModuleId:"editor_ai_image_regenerate",onClick:l,children:(0,f.tZ)(t4.Z,{size:14,css:{fill:i.colors.MapText03A}})})})]})})]})}var t9=function(e,t){if(!t)return e;var n=t.match(/^(\d+):(\d+)$/);if(!n)return e;var r=(0,p._)(n,3),o=r[1];return Math.round(e*parseInt(r[2])/parseInt(o))},ne=function(e){var t=tW();return(0,_.useMemo)(function(){var n=t.find(function(t){return t.id===e});return(null==n?void 0:n.text)||""},[e,t])},nt=function(e){var t=e.status,n=e.totalCount,r=e.failedCount,o=e.errorMessage,i={processing:"图片生成中…",completed:"已为你生成：",error:"生成失败，请重试"},a=(0,_.useMemo)(function(){return r>0&&r===n?o||i.error:""},[o,i.error,r,n]);return o||a||i[t]};function nn(e){var t,n,r,o=e.result,i=e.onEdit,a=e.onRegenerate,c=e.currentEditorState,s=e.setEditorState,u=o.status,l=o.generationParams,d=o.images,p=o.totalCount,h=void 0===p?4:p,m=o.failedCount,g=o.errorMessage,T=o.isTimeout,E=l||{},y=E.prompt,C=E.imageStyle,S=E.imageRatio,I=ne(C),A=t9(118,S),b=(t="processing",n=(0,_.useRef)(null),r=(0,_.useRef)(null),(0,_.useEffect)(function(){return u===t&&(r.current&&cancelAnimationFrame(r.current),r.current=requestAnimationFrame(function(){var e;null===(e=n.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})})),function(){r.current&&cancelAnimationFrame(r.current)}},[u,t]),n),w=nt({status:u,totalCount:h,failedCount:void 0===m?0:m,errorMessage:g});return(0,f.BX)(F.xu,{mt:"8px",css:function(e){return{border:"0.5px solid ".concat(e.colors.MapUIFrame09A),borderRadius:"12px",padding:"15px 12px"}},children:[(0,f.BX)(F.kC,{flexDirection:"column",children:[(0,f.tZ)(t8,{status:u,onEdit:function(){return null==i?void 0:i({prompt:y,imageStyle:C,imageRatio:S})},onRegenerate:function(){return null==a?void 0:a({prompt:y,imageStyle:C,imageRatio:S})},title:w}),(0,f.tZ)(F.xv,{mt:"8px",fontSize:12,lineHeight:"16px",color:"MapText04A",css:{wordBreak:"break-all"},children:y}),(0,f.tZ)(t2,{images:void 0===d?[]:d,totalCount:h,imageHeight:A,styleText:I,imageRatio:S,currentEditorState:c,setEditorState:s,status:u,isTimeout:void 0!==T&&T})]}),(0,f.tZ)(F.xu,{ref:b})]})}var nr=n(28753),no=n(1733);function ni(e){var t=e.width,n=e.height;return(0,f.tZ)(F.xu,{css:function(e){return{width:t,height:n,border:"1px solid ".concat(e.colors.MapUIFrame01A),borderRadius:"3px",flexShrink:0}}})}function na(e){var t=e.title,n=e.selectedOption,r=e.hoveredOption,o=e.onSelect,i=e.onHover,a=e.onLeave,c=e.options,s=e.extra,u=(0,er.F)();return(0,f.tZ)(no.ZP,{hideOnScroll:!0,positionStatus:"fixed",toggler:(0,f.BX)(F.kC,{justifyContent:"center",alignItems:"center",height:24,lineHeight:"24px",px:"6px",fontSize:11,as:"span",css:function(e){return{background:e.colorMod(e.colors.MapBrand).alpha(.08),color:e.colors.MapBrand,cursor:"pointer",borderRadius:"24px",display:"inline-flex",whiteSpace:"nowrap"}},role:"button",tabIndex:0,"aria-label":t,children:[n.text,(0,f.tZ)(nr.Z,{size:12,css:{marginLeft:2}})]}),boundary:{padding:16},children:c.map(function(e){return(0,f.tZ)(no.sN,{onClick:function(){o(e)},onMouseEnter:function(){return i(e.id)},onMouseLeave:function(){return a(null)},css:function(t){return{backgroundColor:r===e.id?t.colors.MapUIFrame10C:"transparent",cursor:"pointer",transition:"background-color 0.2s ease",padding:"12px 16px","&:hover":{backgroundColor:t.colors.MapUIFrame10C}}},children:(0,f.BX)(F.kC,{alignItems:"center",css:{gap:6},children:[s(e),(0,f.tZ)(F.xv,{css:{fontSize:12,color:u.colors.MapText02A},children:e.text})]})},e.id)})})}var nc=function(e){var t=tW(),n=(0,_.useMemo)(function(){return t.find(function(e){return e.isDefault})||t[0]},[t]),r=(0,_.useMemo)(function(){if(null==e?void 0:e.imageStyle){var r=t.find(function(t){return t.id===e.imageStyle});if(r)return r}return n},[null==e?void 0:e.imageStyle,t,n]);return{availableStyleOptions:t,initialStyle:r}},ns=function(){return(0,f.BX)(F.xv,{css:function(e){return{fontSize:10,lineHeight:"14px",color:e.colors.MapCriticalTip,textAlign:"right"}},children:["字数已超出 ",150]})};function nu(e){var t=e.status,n=e.onSubmit,r=e.initialParams,o=(0,er.F)(),i=(0,_.useRef)(null),a=t===e6.TERMINATED,c=(0,p._)((0,_.useState)((null==r?void 0:r.prompt)||""),2),s=c[0],u=c[1],l=tc().remainingCount,d=nc(r),h=d.availableStyleOptions,m=d.initialStyle,g=(0,tn.useDispatch)(),T=(0,_.useMemo)(function(){if(null==r?void 0:r.imageRatio){var e=te.find(function(e){return e.id===r.imageRatio});if(e)return e}return te[3]},[null==r?void 0:r.imageRatio]),E=(0,p._)((0,_.useState)(m),2),y=E[0],C=E[1],S=(0,p._)((0,_.useState)(T),2),I=S[0],A=S[1],b=(0,p._)((0,_.useState)(null),2),w=b[0],Z=b[1],x=(0,p._)((0,_.useState)(null),2),k=x[0],R=x[1],N=s.length>150,O=0===s.trim().length||a||N;return(0,eI.b)(function(){var e=setTimeout(function(){var e;null===(e=i.current)||void 0===e||e.focus()},2e3);return function(){return clearTimeout(e)}}),(0,f.BX)(F.kC,{mt:"8px",flexDirection:"column",p:"10px",css:{border:"1.5px solid ".concat(o.colors.MapBrand),borderRadius:"12px",opacity:a?.5:1,pointerEvents:a?"none":"auto",gap:"10px"},children:[(0,f.tZ)(F.xu,{ref:i,as:"textarea",placeholder:"请描述你想要配图的内容",disabled:a,value:s,maxLength:150,onChange:function(e){u(e.target.value)},css:{width:"100%",minHeight:54,fontSize:12,lineHeight:"16px",padding:0,border:"none",background:"transparent",resize:"none",overflow:"hidden",fieldSizing:"content",height:"auto","&::placeholder":{color:o.colors.MapText06A},"&:focus":{outline:"none"}}}),N&&(0,f.tZ)(ns,{}),(0,f.BX)(F.kC,{justifyContent:"space-between",alignItems:"center",children:[(0,f.BX)(F.kC,{css:{gap:6},children:[(0,f.tZ)(na,{title:"选择风格",selectedOption:y,hoveredOption:w,onSelect:function(e){C(e)},onHover:Z,onLeave:Z,options:h,extra:function(e){return(0,f.tZ)(F.xu,{css:{width:40,height:40,borderRadius:"3px",background:"url('".concat(e.image,"') center / cover no-repeat"),flexShrink:0}})}}),(0,f.tZ)(na,{title:"选择比例",selectedOption:I,hoveredOption:k,onSelect:function(e){A(e)},onHover:R,onLeave:R,options:te,extra:function(e){return(0,f.tZ)(ni,{width:e.width,height:e.height})}})]}),(0,f.tZ)(t5.Z,{placement:"bottom",toggleEvent:"hover",focusScope:!1,toggler:(0,f.tZ)(H.ZAClick,{shouldTrackShow:!0,zaType:"Button",zaText:!0,zaModuleId:"editor_ai_generated_image",as:F.xu,onClick:function(){if(0!==s.trim().length&&!a){if(0===l){g((0,tr.c0)("今日次数已用完","red"));return}n({prompt:s.trim(),imageStyle:y.id,imageRatio:I.id})}},css:{backgroundColor:o.colors.MapBrand,border:"1px solid ".concat(o.colors.MapBrand),borderRadius:"4px",padding:"4px 12px",cursor:O?"not-allowed":"pointer",opacity:O?.5:1,pointerEvents:O?"none":"auto"},children:(0,f.tZ)(F.xv,{css:{fontSize:12,lineHeight:"16px",color:o.colors.MapUIFrame99A,whiteSpace:"nowrap"},children:"生成图片"})}),children:null!==l&&(0,f.BX)(F.xu,{css:{fontSize:14,lineHeight:"normal",color:o.colors.MapText02A,padding:"8px 12px",whiteSpace:"nowrap"},children:["今日剩余 ",l," 次"]})})]})]})}function nl(e){var t=e.result,n=e.onAiImageSubmit,r=e.onEdit,o=e.onRegenerate,i=e.currentEditorState,a=e.setEditorState,c=t.status,s=t.generationParams;return c===e6.PREPARING||c===e6.TERMINATED?(0,f.tZ)(nu,{status:c,onSubmit:n,initialParams:s}):(0,f.tZ)(nn,{result:t,currentEditorState:i,setEditorState:a,onEdit:r,onRegenerate:o})}function nd(e){var t=e.result,n=e.currentEditorState,r=e.setEditorState,o=e.activeId,i=e.setHighlightId,a=e.onStateUpdate,c=e.displayedFormat,s=e.isApplyingFormatRef,u=e.setDisplayedFormat,l=e.setDetectionResults,p=e.editorState,h=e.setContentTitle,_=t.businessType,m=t.status,g=t.taskStatus,T=t.errorMessage,E=t.isRegenerated;if(-1===_)return null;var y=e5[_].component;return(0,f.BX)(F.xu,{p:"16px 16px 8px",children:[!E&&(0,f.tZ)(F.xv,{p:"12px",fontSize:13,lineHeight:"19px",fontWeight:"bold",color:"MapText03A",bg:"MapUIFrame10A",width:"fit-content",css:{borderRadius:12},children:e5[_].title}),4===_?(0,f.tZ)(nl,(0,d._)({},e)):(0,f.BX)(F.xu,{mt:"8px",p:"12px 4px",css:function(e){return(0,d._)({},(0,tG.M)({border:"1px solid ".concat(e.colors.MapUIFrame09A),borderRadius:24}))},children:[m===e6.DETECTING&&(0,f.BX)(F.kC,{justifyContent:"space-between",alignItems:"center",px:"8px",children:[(0,f.tZ)(F.xv,{fontSize:12,lineHeight:"19px",fontWeight:"bold",color:"MapText03A",children:e5[_].detectingText}),(0,f.tZ)(F.xv,{css:{position:"relative"},children:(0,f.tZ)(eg.Z,{css:function(e){return{width:12,"& .path":{stroke:e.colors.MapInfoSub}}}})})]}),"TaskStatusSuccess"===g&&(0,f.tZ)(y,{result:t,currentEditorState:n,setEditorState:r,activeId:o,setHighlightId:i,onStateUpdate:a,displayedFormat:c,isApplyingFormatRef:s,setDisplayedFormat:u,setDetectionResults:l,editorState:p,setContentTitle:h}),"TaskStatusFailed"===g&&(0,f.tZ)(ei,{children:void 0===T?"似乎出了点问题，请稍后重试":T})]})]})}function np(e){var t=e.detectionResults,n=e.detectionStatus,r=e.currentFeatureType,o=(0,ee._)(e,["detectionResults","detectionStatus","currentFeatureType"]);return(0,f.BX)(f.HY,{children:[t.length>0&&t.map(function(e,t){return(0,f.tZ)(nd,(0,d._)({result:e},o),t)}),n===e6.DETECTING&&4!==r&&(0,f.tZ)(nd,{result:{businessType:r,status:e6.DETECTING}})]})}var nf=n(20991),nh=n(24486),n_=n(23141),nm=n(7753),nv=n(62317),ng=function(e){var t=e.handleClose,n=e.handleClear,r=e.detectionResults,o=!r||0===r.length;return(0,f.BX)(F.kC,{justifyContent:"space-between",alignItems:"center",py:"14px",children:[(0,f.tZ)(F.xv,{fontSize:15,fontWeight:"bold",color:"MapText02A",children:"创作助手"}),(0,f.BX)(F.kC,{alignItems:"center",gap:"16px",children:[(0,f.tZ)(t6,{content:"清空历史内容",children:(0,f.tZ)(H.ZAClick,{as:"button",zaType:"Button",zaModuleId:"ai_creation_assistant_clear_btn",onClick:n,"aria-label":"清空检测列表",disabled:o,css:{background:"none",border:"none",cursor:o?"not-allowed":"pointer",padding:4,opacity:o?.6:1},children:(0,f.tZ)(nf.Z,{size:12})})}),(0,f.tZ)(H.ZAClick,{as:"button",zaType:"Button",zaModuleId:"ai_creation_assistant_close_btn",onClick:t,"aria-label":"关闭创作助手",css:{background:"none",border:"none",cursor:"pointer",padding:4},children:(0,f.tZ)(nh.ZP,{size:12})})]})]})};function nT(e){var t,n,r,o,i,a,c,s,u,l,m,g,T,E,y,C,S,I,A,b,w,Z,x,R,N,O,P,D,L,M=e.contentType,B=e.handleEntryClick,U=e.contentLength,G=e.detectionStatus,z=e.handleClose,q=e.handleClear,V=e.detectionResults,W=(n=(t={detectionStatus:G,contentLength:void 0===U?0:U}).detectionStatus,r=t.contentLength,i=(o=(0,p._)((0,_.useState)(!0),2))[0],a=o[1],s=(c=(0,p._)((0,_.useState)(!1),2))[0],u=c[1],m=(l=(0,p._)((0,_.useState)({x:0,y:0}),2))[0],g=l[1],E=(T=(0,p._)((0,_.useState)(""),2))[0],y=T[1],S=!(C=n===e6.DETECTING)&&r>=300,I=function(e){var t=!1===e.contentLengthSensitive?C?"有正在进行中的任务，请稍后再试":"":C?"有正在进行中的任务，请稍后再试":0===r?"请输入内容，满 ".concat(300," 字后可解锁功能"):r<300?"请继续创作，当前字数 ".concat(r,"/").concat(300):"";return i?t:t||e.description},A=(0,h.A)(function(e,t){var n=e.currentTarget.getBoundingClientRect(),r=n.top,o=n.left,i=n.right;y(t),u(!0),g({x:Math.round((o+i)/2+window.scrollX),y:Math.round(r+window.scrollY)})}),b=(0,h.A)(function(e,t){i||A(e,t)}),w=(0,h.A)(function(e,t){if(!1!==t.contentLengthSensitive||r>=300){var n=I(t);n&&A(e,n)}}),Z=(0,h.A)(function(){u(!1)}),{isInit:i,setIsInit:a,getItemProps:(0,h.A)(function(e){return{isInteractive:!1===e.contentLengthSensitive?!C:S,onMouseEnter:function(t){return w(t,e)},onMouseLeave:Z}}),tooltipProps:{visible:s,text:E,position:m},handleMoreMouseEnter:b}),X=W.isInit,K=W.setIsInit,j=W.getItemProps,Y=W.tooltipProps,Q=W.handleMoreMouseEnter,J=(0,tp.p3)().isAIImageEnabled,$=(0,H.useTracker)().trackEvent,ee=(0,h.A)(function(e){$({elementLocation:{type:"Button",module_id:"ai_creation_module",text:e},eventType:"Click"})}),et=(x=th(),N=(R=(0,p._)((0,_.useState)(!1),2))[0],O=R[1],P="loaded"===x.termLoadingState&&x.hasPermission,D=(0,h.A)(function(){O(!0)}),L=(0,h.A)(function(){O(!1)}),{showTermIcon:P,showTerm:D,termModal:N?(0,f.tZ)(tV,{handleAiImageTermClose:L,handleAiImageTermAgree:L,mode:"view"}):null}),en=et.showTermIcon,er=et.showTerm,eo=et.termModal;return(0,f.BX)(F.xu,{px:"16px",pb:"20px",bg:"MapUIFrame99A",css:function(e){return(0,k._)((0,d._)({top:0},(0,tG.M)({borderBottom:"1px solid ".concat(e.colors.MapUIFrame09A)})),{position:"sticky",zIndex:1})},children:[(0,f.tZ)(ng,{handleClose:z,handleClear:q,detectionResults:V}),(0,f.BX)(F.xv,{pb:"12px",mb:"2px",fontSize:12,lineHeight:"16px",color:"MapText03A",css:function(e){return(0,d._)({},(0,tG.M)({borderBottom:"1px solid ".concat(e.colors.MapUIFrame09A)}))},children:["Hello，欢迎使用知乎创作助手，你可选择以下功能辅助创作更优质的内容",en&&(0,f.tZ)(n_.Z,{text:!0,center:!0,css:function(e){return{marginLeft:2,fill:e.colors.MapText07A,cursor:"pointer"}},onClick:er})]}),(0,f.tZ)(F.kC,{justifyContent:"space-between",flexWrap:"wrap",mt:"20px",css:{gap:12},children:e4[M].map(function(e){if(4===e.businessType&&!J)return null;var t=j(e),n="更多功能"===e.title;return(0,f.BX)(F.xu,{bg:"MapUIFrame10A",p:"12px",mb:0,css:function(){return{borderRadius:"12px",boxSizing:"border-box",width:"calc(50% - 6px)",cursor:n?"default":t.isInteractive?"pointer":"not-allowed",opacity:t.isInteractive?1:.7}},onClick:function(){t.isInteractive&&!n&&(K(!1),ee(e.title),B({businessType:e.businessType}))},onMouseEnter:n?function(t){return Q(t,e.description)}:t.onMouseEnter,onMouseLeave:t.onMouseLeave,children:[(0,f.BX)(F.kC,{alignItems:"center",justifyContent:"space-between",children:[(0,f.BX)(F.kC,{as:"span",alignItems:"center",children:[e.icon,(0,f.tZ)(F.xv,{as:"span",fontSize:13,fontWeight:"bold",ml:"2px",color:"MapText02A",children:e.title})]}),"更多功能"!==e.title&&(0,f.tZ)(nm.ZP,{size:12,css:function(e){return{fill:e.colors.GBK06A}}})]}),X&&(0,f.tZ)(F.xv,{as:"p",fontSize:12,color:"MapInfoSub",children:e.description})]},e.title)})}),Y.text&&(0,f.tZ)(nv.Z,{shown:Y.visible,position:"top",x:Y.position.x,y:Y.position.y,content:Y.text,css:{zIndex:2}}),eo]})}function nE(e){var t=e.detectionResults,n=void 0===t?[]:t,r=e.detectionStatus,o=(0,_.useRef)(),i=(0,_.useRef)({resultsLength:0,status:null}),a=(0,_.useRef)(null),c=function(){a.current&&cancelAnimationFrame(a.current),a.current=requestAnimationFrame(function(){o.current&&o.current.scrollIntoView({behavior:"smooth",block:"end"})})};return(0,_.useEffect)(function(){var e=n.length;(e>i.current.resultsLength||r&&r!==e6.APPLYING&&r!==i.current.status)&&(i.current={resultsLength:e,status:r},c())},[n.length,r]),(0,_.useEffect)(function(){return function(){a.current&&cancelAnimationFrame(a.current)}},[]),(0,f.tZ)(F.xu,{ref:o,css:{width:"100%",height:"40px"}})}var ny=(0,_.forwardRef)(function(e,t){var n,r,o,i,a,c,s,u,m,g,T,E,y,C,S,I,b,w,Z,x,R,N,O,P,D,L,M,B,U,G,F=e.uid,H=e.contentId,z=e.contentType,V=e.editorState,X=e.setEditorState,K=e.storeHighlightIdMap,j=e.getContentTitle,Y=e.setContentTitle,Q=e.getEditableCore,J=e.handleClose,ee=(0,p._)((0,_.useState)(e6.DEFAULT),2),en=ee[0],er=ee[1],eo=(0,p._)((0,_.useState)(-1),2),ei=eo[0],ea=eo[1],ec=(0,p._)((0,_.useState)(0),2),es=ec[0],eu=ec[1],el=(0,p._)((0,_.useState)([]),2),ed=el[0],ef=el[1],eh=(0,p._)((0,_.useState)(V),2),e_=eh[0],em=eh[1],ev=(0,p._)((0,_.useState)(!1),2),eg=ev[0],eT=ev[1],eE=(0,p._)((0,_.useState)(null),2),ey=eE[0],eC=eE[1],eS=(0,p._)((0,_.useState)(null),2),eI=eS[0],eA=eS[1],eb=(0,p._)((0,_.useState)(null),2),ew=eb[0],eZ=eb[1],ex=(0,_.useRef)(!1),ek=(0,_.useRef)(null),eR=(0,W.Z)(),eN=th();tm();var eO=tu({aiImageLicenseState:eN,setDetectionResults:ef,detectionStatus:en}),eP=eO.showAiImageTerm,eD=eO.showAiImageInput,eL=eO.handleAiImageTermAgree,eM=eO.handleAiImageTermClose,eB=(r=(n={detectionStatus:en,setDetectionStatus:er,detectionResults:ed,setDetectionResults:ef,contentType:z,contentId:H,abortControllerRef:ek}).detectionStatus,o=n.setDetectionStatus,i=n.detectionResults,a=n.setDetectionResults,c=n.contentType,s=n.contentId,u=n.abortControllerRef,m=(0,W.Z)(),g=(0,tn.useDispatch)(),T=ts(),E=(0,h.A)(function(){if(i.length>0){var e=i[i.length-1];4===e.businessType&&e.status===e6.PREPARING&&a(function(t){var n=(0,A._)(t);return n[n.length-1]=(0,k._)((0,d._)({},e),{status:e6.TERMINATED}),n})}}),C=(0,h.A)((y=(0,$._)(function(e){var t,n,r,i,p,f,h,_,g,E;return(0,et.__generator)(this,function(y){switch(y.label){case 0:t=e.prompt,n=e.imageStyle,r=e.imageRatio,i=e.resultIndex,u.current&&u.current.abort(),p=new AbortController,u.current=p,y.label=1;case 1:return y.trys.push([1,4,5,6]),[4,tg(m,{content_id:s,content_type:c},{business_type:4,prompt:t,style:n,ratio:r},p.signal)];case 2:if(f=y.sent(),p.signal.aborted)return[2];return h=f.payload.data.taskId,a(function(e){var t=(0,A._)(e);return t[i]=(0,k._)((0,d._)({},t[i]),{taskId:h}),t}),[4,ty(m,h,{onProgress:function(e){var t=e.images,n=e.status,r=e.remainingTimes,o=e.totalCount,c=e.successCount,s=e.failedCount;a(function(e){var r=(0,A._)(e);return r[i]=(0,k._)((0,d._)({},r[i]),{images:(null==t?void 0:t.map(function(e){return{imageId:e.imageId,status:e.status,url:e.url,errorMessage:e.errMsg}}))||[],status:"processing"===n?e6.PROCESSING:e6.COMPLETED,taskStatus:"processing"===n?"TaskStatusProcessing":"success"===n||"partial_success"===n?"TaskStatusSuccess":"TaskStatusFailed",totalCount:o,successCount:c,failedCount:s}),r}),"number"==typeof r&&T(function(e){e.remainingCount=r})},signal:p.signal})];case 3:if(y.sent(),p.signal.aborted)return[2];return o(e6.COMPLETED),[3,6];case 4:if(_=y.sent(),(0,l._)(_,Error)&&"AbortError"===_.name||p.signal.aborted)return[2];return o(e6.COMPLETED),g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"操作失败，请重试";return(0,l._)(e,Error)?"TimeoutError"===e.name?e.message:"payload"in e?e.payload.message:e.message||t:t}(_,"图片生成失败，请重试"),E=(0,l._)(_,Error)&&"TimeoutError"===_.name,a(function(e){var t=(0,A._)(e);return t[i]=(0,k._)((0,d._)({},t[i]),{status:e6.ERROR,taskStatus:"TaskStatusFailed",errorMessage:g,isTimeout:E}),t}),[3,6];case 5:return u.current===p&&(u.current=null),[7];case 6:return[2]}})}),function(e){return y.apply(this,arguments)})),I=(0,h.A)((S=(0,$._)(function(e){var t,n,r,c;return(0,et.__generator)(this,function(s){switch(s.label){case 0:return t=e.prompt,n=e.imageStyle,r=e.imageRatio,c=i.length-1,o(e6.DETECTING),a(function(e){var o=(0,A._)(e);return o[c]=(0,k._)((0,d._)({},o[c]),{status:e6.PROCESSING,taskId:null,images:[],generationParams:{prompt:t,imageStyle:n,imageRatio:r},timestamp:Date.now()}),o}),[4,C({prompt:t,imageStyle:n,imageRatio:r,resultIndex:c})];case 1:return s.sent(),[2]}})}),function(e){return S.apply(this,arguments)})),b=(0,h.A)(function(e){var t=e.prompt,n=e.imageStyle,o=e.imageRatio;if(r===e6.DETECTING){g((0,tr.c0)("有正在进行中的任务，请稍后重试","red"));return}E(),a(function(e){return(0,A._)(e).concat([{businessType:4,status:e6.PREPARING,generationParams:{prompt:t,imageStyle:n,imageRatio:o},isRegenerated:!0,timestamp:Date.now()}])})}),Z=(0,h.A)((w=(0,$._)(function(e){var t,n,c,s;return(0,et.__generator)(this,function(u){switch(u.label){case 0:if(t=e.prompt,n=e.imageStyle,c=e.imageRatio,r===e6.DETECTING)return g((0,tr.c0)("有正在进行中的任务，请稍后重试","red")),[2];return E(),s=i.length,o(e6.DETECTING),a(function(e){return(0,A._)(e).concat([{businessType:4,status:e6.PROCESSING,taskId:null,images:[],generationParams:{prompt:t,imageStyle:n,imageRatio:c},timestamp:Date.now(),isRegenerated:!0}])}),[4,C({prompt:t,imageStyle:n,imageRatio:c,resultIndex:s})];case 1:return u.sent(),[2]}})}),function(e){return w.apply(this,arguments)})),{terminatePendingAiImageTask:E,handleAiImageSubmit:I,handleAiImageEdit:b,handleAiImageRegenerate:Z}),eU=eB.terminatePendingAiImageTask,eG=eB.handleAiImageSubmit,eF=eB.handleAiImageEdit,eH=eB.handleAiImageRegenerate,ez=(0,_.useMemo)(function(){return F&&H?"".concat("global::aiAssistantCorrectionResult","_").concat(F,"_").concat(H):null},[F,H]);tL(ez,er,eT,ef);var eq=tP(),eV=eq.saveDetectionData,eW=eq.clearStorage;R=(x={cacheKey:ez,saveDetectionData:eV,detectionResults:ed,highlightId:ew,currentEditorState:e_,setHighlightId:eZ,highlightTrigger:eg,contentLength:es,setContentLength:eu,abortControllerRef:ek}).cacheKey,N=x.saveDetectionData,O=x.detectionResults,P=x.highlightId,D=x.currentEditorState,L=x.setHighlightId,M=x.highlightTrigger,B=x.contentLength,U=x.setContentLength,G=x.abortControllerRef,(0,_.useEffect)(function(){R&&N(R,{detectionResults:O})},[R,O,N]),(0,_.useEffect)(function(){if(P){(0,tx.n)(D,{centerInView:!0,behavior:"smooth"}),L(null);return}},[M,D,P,L]),(0,_.useEffect)(function(){if(D&&!B){var e=D.getCurrentContent();U((0,q.Xs)(e.getPlainText(),!1))}},[D,B,U]),(0,_.useEffect)(function(){return function(){G.current&&(G.current.abort(),G.current=null)}},[G]),tw(e_,ed,X,eg,eT,K);var eX=tD({detectionStatus:en,setDetectionStatus:er,setContentLength:eu,setCurrentEditorState:em}),eK=tk(ef),ej=eK.updateDetectionResult,eY=eK.clearDetectionResults,eQ=tb({currentEditorState:e_,contentId:H,contentType:z,getEditableCore:Q,setDetectionResults:ef,setCurrentFeatureType:ea,setDetectionStatus:er,abortControllerRef:ek,http:eR}),eJ=tZ({currentEditorState:e_,contentId:H,contentType:z,http:eR,setDetectionStatus:er,setCurrentFeatureType:ea,setDetectionResults:ef,abortControllerRef:ek,setHighlightTrigger:eT,getContentTitle:j,getEditableCore:Q,setEditorState:X}),e$=(0,h.A)(function(){ek.current&&(ek.current.abort(),ek.current=null),er(e6.DEFAULT),ef([]),ea(-1),eT(!1),ex.current=!1,eC(null),eA(null),eZ(null),X(V),eu(0),K(new Map),eY(),eW()}),e0=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};eX(e,t),t&&(eu(t.contentLength),eA(t.highlightPanelId))},e1=(0,h.A)(function(){eU(),ea(4),eD()});(0,_.useImperativeHandle)(t,function(){return{handleContentUpdate:e0,showAiImageFeature:e1}});var e2=(0,h.A)(function(e){var t=e.businessType;if(eU(),ea(t),4===t){eD();return}if(er(e6.DETECTING),2===t||3===t){eQ(t);return}eJ({businessType:t})}),e3=(0,_.useMemo)(function(){return{currentEditorState:e_,detectionStatus:en,editorState:V,setDetectionStatus:er,setEditorState:X}},[e_,en,V,er,X]);return(0,f.BX)(ep.Provider,{value:e3,children:[eP&&(0,f.tZ)(tV,{handleAiImageTermAgree:eL,handleAiImageTermClose:eM}),(0,f.tZ)(nT,{contentType:z,handleEntryClick:e2,contentLength:es,detectionStatus:en,handleClose:J,handleClear:e$,detectionResults:ed}),(0,f.tZ)(np,{detectionResults:ed,detectionStatus:en,currentFeatureType:ei,currentEditorState:e_,editorState:V,setEditorState:X,activeId:eI,setHighlightId:eZ,onStateUpdate:ej,displayedFormat:ey,isApplyingFormatRef:ex,setDisplayedFormat:eC,setDetectionResults:ef,setContentTitle:Y,getContentTitle:j,onAiImageSubmit:eG,onEdit:eF,onRegenerate:eH}),(0,f.tZ)(nE,{detectionResults:ed,detectionStatus:en})]})}),nC=(0,_.forwardRef)(function(e,t){var n=e.handleClose,r=e.uid,o=e.contentId,i=e.contentType,a=e.setEditorState,c=e.setHighlightLayout,s=e.storeHighlightIdMap,u=e.getContentTitle,l=e.setContentTitle,m=e.useMediumEditor,g=e.getEditableCore,T=e.getStickyInfo,E=e.getContainer,y=(0,_.useRef)(null),C=(0,p._)((0,_.useState)(e.editorState),2),S=C[0],I=C[1],A=V(T,m),b=A.stickyStatus,w=A.dynamicHeight,Z=A.stickyRef,x=A.offset,R=A.fixStyle,N=A.normalStyle,O=A.handlePositionStatusChange,P=A.updateStickyInfo,D=(0,h.A)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&y.current&&g){I(e);var n=e.getCurrentContent(),r=(0,q.Xs)(n.getPlainText(),!1);y.current.handleContentUpdate(e,(0,k._)((0,d._)({},t),{contentLength:r}))}}),L=(0,h.A)(function(){var e,t;null===(e=y.current)||void 0===e||null===(t=e.showAiImageFeature)||void 0===t||t.call(e)});return(0,_.useImperativeHandle)(t,function(){return{handleEditorChange:D,updateStickyInfo:P,showAiImageFeature:L}},[D,P,L]),(0,f.tZ)(H.ZAEnv,{content:{token:o,type:"article"===i?"Post":"Question"},children:(0,f.tZ)(z.Z,{offset:x,onPositionStatusChange:O,getStyle:function(){return"fixed"===b?R:{}},ref:Z,container:E,children:(0,f.tZ)(H.ZAShow,{as:F.xu,zaType:"Block",className:"AIAssistantPanelV2-container",bg:"GBK99A",height:"100vh",css:function(e){return(0,d._)({position:"absolute",width:305,right:-330,top:-78,borderRadius:2,boxShadow:"0px 1px 3px 0px ".concat(e.colorMod(e.colors.GBK02A).alpha(.1))},"fixed"===b?{}:(0,k._)((0,d._)({},N),{height:w||N.height,overflow:"hidden",willChange:"auto"}))},zaModuleId:"ai_creation_assistant_panel",children:(0,f.tZ)("div",{css:{position:"relative",height:"100%",overflowY:"auto","::-webkit-scrollbar":{display:"none"}},children:(0,f.tZ)(ny,{ref:y,editorState:S,uid:r,contentId:o,contentType:i,setEditorState:a,setHighlightLayout:c,storeHighlightIdMap:s,getContentTitle:u,setContentTitle:l,getEditableCore:g,handleClose:n})})})})})}),nS=(0,_.forwardRef)(function(e,t){var n=e.store,r=e.getContentId,o=e.uid,i=e.toggleAIAssistantPanel,a=e.contentType,c=e.useMediumEditor,s=e.offset,u=e.containerClassName,d=e.fixedPosition,m=e.scrollThreshold,g=e.getContentTitle,T=e.setContentTitle,E=e.getEditableCore,y=e.getContainer,C=e.getStickyInfo,S=(0,p._)((0,_.useState)(!0),2),I=S[0],A=S[1],b=(0,_.useRef)(null),w=n.getEditorState(),Z=r(),x=(0,h.A)(function(){A(!0),i(!0)}),k=(0,h.A)(function(){var e=n.getEditorState();if(e){var t=B(e);n.setEditorState(t),n.resetHighlightState()}A(!1),i(!1)});(0,_.useEffect)(function(){A(!0),i(!0)},[i]);var R=(0,h.A)(function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null===(t=b.current)||void 0===t||t.handleEditorChange(e,n)}),N=(0,h.A)(function(e){e&&(0,l._)(e,Map)&&(n.highlightIdMap=e)}),O=(0,h.A)(function(){var e,t;null===(e=b.current)||void 0===e||null===(t=e.updateStickyInfo)||void 0===t||t.call(e)}),D=(0,h.A)(function(){var e,t;null===(e=b.current)||void 0===e||null===(t=e.showAiImageFeature)||void 0===t||t.call(e)});(0,_.useImperativeHandle)(t,function(){return{handleOpen:x,handleClose:k,triggerPanelEditorChange:R,getShown:function(){return I},updateStickyInfo:O,showAiImageFeature:D}},[x,k,R,I,O,D]);var L=function(e){e&&n.setEditorState&&n.setEditorState(e)};return I&&(0,f.tZ)(nC,{ref:b,editorState:w,contentId:Z,uid:o,useMediumEditor:c,contentType:a,handleClose:k,setHighlightLayout:function(e,t){if(e&&t){var r=P(e,t,"HIGHLIGHT_LAYOUT");return G(t,r,L),n.currentLayoutHighlightBackgroundRange=t,r}},setEditorState:L,containerClassName:u,offset:s,fixedPosition:d,scrollThreshold:m,storeHighlightIdMap:N,getEditableCore:E,getContentTitle:g,setContentTitle:T,getContainer:y,getStickyInfo:C})}),nI=function(e){var t={};t.aiModalRef=e.aiAssistantRef||(0,_.createRef)(null),t.currentErrorHighlightBackgroundRange=null,t.currentLayoutHighlightBackgroundRange=null,t.previousEditorState=null,t.highlightIdMap=new Map,t.resetHighlightState=function(){t.currentErrorHighlightBackgroundRange=null,t.currentLayoutHighlightBackgroundRange=null,t.highlightIdMap.clear()};var n=function(e,n,r,o,i,a){if(!o)return e;var c=n.getBlockForKey(o.getAnchorKey());if(!c)return e;var s=c.getInlineStyleAt(o.getStartOffset());if(s&&s.has(i)&&!U(r,o)){var u=D(e,o,i);return t[a]=null,u}return e};return{initialize:function(e){Object.assign(t,e),t.previousEditorState=t.getEditorState?t.getEditorState():null},handleCommand:function(e){return(null==e?void 0:e.startsWith("ai-assistant"))?(t.aiModalRef.current.getShown()?t.aiModalRef.current.handleClose():t.aiModalRef.current.handleOpen(),"handled"):"not-handled"},components:[(0,f.tZ)(nS,(0,d._)({store:t,ref:t.aiModalRef},e),"ai_assistant")],toolbar:{section:"menu",onClick:function(){},shouldShow:!0},customStyleMap:{HIGHLIGHT_UNDERLINE:{textDecoration:"#D95350 wavy 1px underline",textUnderlineOffset:"4px"},HIGHLIGHT_ERROR_BACKGROUND:{backgroundColor:"rgba(217, 83, 80, 0.3)"},HIGHLIGHT_LAYOUT:{backgroundColor:"rgba(23, 114, 246, 0.3)"}},onChange:function(e){if(!(null===(r=t.aiModalRef)||void 0===r?void 0:r.current)||!t.aiModalRef.current.getShown())return e;var r,o=e,i=e.getCurrentContent(),a=e.getSelection(),c=t.previousEditorState,s=null,u=!1;try{if(c){var l=c.getCurrentContent();u=i.getPlainText()!==l.getPlainText();var d=t.highlightIdMap.size>0;u&&d&&(o=B(e),t.resetHighlightState())}if(u||(o=n(o,i,a,t.currentErrorHighlightBackgroundRange,"HIGHLIGHT_ERROR_BACKGROUND","currentErrorHighlightBackgroundRange"),o=n(o,i,a,t.currentLayoutHighlightBackgroundRange,"HIGHLIGHT_LAYOUT","currentLayoutHighlightBackgroundRange")),a.getHasFocus()&&a.isCollapsed()){var p=L(o.getCurrentContent(),a);if(p){o=P(o,p,"HIGHLIGHT_ERROR_BACKGROUND"),t.currentErrorHighlightBackgroundRange=p;var f=I(p);t.highlightIdMap.has(f)&&(s=t.highlightIdMap.get(f))}}return t.previousEditorState!==o&&(t.previousEditorState=o),t.aiModalRef.current.triggerPanelEditorChange(o,{highlightPanelId:s,contentChanged:u}),o}catch(t){return e}}}}},84469:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var r=n(94009),o=n(85879),i=n(87363),a=n(11809),c=n(20944),s=n(22701),u=n(57730),l=n(19760),d=n(59013),p=n(31467),f=n(78920),h=function(e){var t=e.shown,n=e.onClose,r=e.onSubmit,a=(0,i.useCallback)(function(e){var t=e.type,o=e.payload;if("browser/closeCurrentPage"===t){n();return}if("editor/submitAttachment"===t){r(o.files);return}},[r,n]);return(0,o.tZ)(p.Z,{className:"BaiduFileSelector",size:"large",onClose:n,children:t&&(0,o.tZ)("div",{className:"BaiduFileSelector-content",children:(0,o.tZ)(f.Z,{className:"BaiduFileSelector-iframe",src:"https://www.zhihu.com/appview/editor/attachment/baidu",onMessage:a})})})},_=(0,i.forwardRef)(function(e,t){var n=(0,r._)((0,i.useState)(!1),2),a=n[0],c=n[1];return(0,i.useImperativeHandle)(t,function(){return{setBaiduFileSelectorShown:c}},[]),(0,o.tZ)(h,{shown:a,onClose:function(){return c(!1)},onSubmit:function(t){c(!1),e.onSubmit(t)}})}),m=function(){var e={},t=function(t){e.getEditorRef().props.handleCommand("insert-file-link-card:".concat(JSON.stringify(t)))},n=function(){return(0,d.Z)(e.getEditorState()).filter(function(e){return"file-link-card"===e.getType()})},r=function(){if(n().size>=10){u.Z.alert(null,{title:"一篇内容最多可添加 ".concat(10," 个附件")});return}e.containerRef.current.setBaiduFileSelectorShown(!0)};return e.containerRef=(0,i.createRef)(),{initialize:function(t){Object.assign(e,t)},components:(0,o.tZ)(_,{handleSubmit:t,ref:e.containerRef,onSubmit:t}),handleCommand:function(e){return"insert-file-from-baidu-wangpan"===e?(r(),"handled"):"not-handled"},toolbar:{section:a.Z.CUSTOM_MAIN,label:"上传附件",icon:l._,toolType:s._W.ENTITY,onClick:function(){if(n().size>=10){u.Z.alert(null,{title:"一篇内容最多可添加 ".concat(10," 个附件")});return}e.containerRef.current.setBaiduFileSelectorShown(!0)},priority:2},toolbarV2:{section:c.Z.BUSINESS_MEDIA,label:"上传附件",text:"网盘",icon:l._,toolType:s._W.ENTITY,onClick:function(){r()},priority:2}}}},7933:function(e,t,n){"use strict";n.d(t,{Z:function(){return Q}});var r=n(94009),o=n(85879),i=n(65733),a=n(33773),c=n(87363),s=n.n(c),u=n(69383),l=n(20857),d=n(22107),p=n(94707),f=n(87320),h=n(86325),_=n(85626),m=n(14168),g=n.n(m),T=n(31467),E=n(9338),y=n(55164),C=n(57477),S=n(30971),I=n(92258),A=n(74065),b=n(70877),w=n(99178),Z=n(97490),x=n(46730),k=n(67814),R=n.n(k),N=n(78160),O=n(87641),P=n(25452),D=n(66263),L=n(69578),M=function(){return null},B=function(e,t){var n=e.html,r=e.className;return(0,o.tZ)("div",{onClick:function(e){return e.preventDefault()},css:{".ImageDelete-button":{display:"none"}},children:(0,o.tZ)(L.Z,{readOnly:!0,allowImageCaption:!1,className:R()("PreviewEditableInstance",r),css:{border:"none"},ref:t,hideImageToolbar:!0,allowLinkCard:!0,allowMention:!0,allowReference:!0,allowZVideo:!0,allowTable:!0,useCatalogV2:!0,allowHeaderThree:!1,allowToolbarSticky:!0,toolbarStickyOffset:D.BR,onInsertZVideo:M,getToolbarSidePlugins:M,getToolbarMenuPlugins:M,getEditorBeforePlugins:M,createEditorPlugins:M,minRows:6,defaultValue:n,onReady:M,onChange:M,onAfterChange:M,onFocus:M,onSelectText:M,onSubmit:M,onError:M,onLoadStart:M,onLoadEnd:M,onUploadStart:M,onUploadEnd:M,onUploadError:M,onBeforeVideoUpload:M,editingContentType:e.draftType,onMCNLinkCardEdit:M,useV2Feature:!0,useEditableV2:!0,useImageOperationV2:!0,onAnyChange:M})})};B.propTypes={html:g().string};var U=(0,c.forwardRef)(B),G=n(66980),F=Object.assign,H=function(e){return s().createElement(G.Z,F({width:"150",height:"120",viewBox:"0 0 150 120"},e),s().createElement("path",{fill:"#EBEEF5",d:"M102 30.998A2.996 2.996 0 0 0 98.998 28H50.002A2.996 2.996 0 0 0 47 30.998v58.147l.193-.125c1.453-.939 3.473-.94 4.927 0l2.537 1.64 2.536-1.64c1.453-.939 3.473-.94 4.927 0l2.537 1.64 2.536-1.64c1.453-.939 3.473-.94 4.927 0l2.537 1.64 2.536-1.64c1.453-.939 3.473-.94 4.927 0l2.537 1.64 2.536-1.64c1.453-.939 3.473-.94 4.927 0l2.537 1.64 2.536-1.64c1.413-.913 3.363-.94 4.807-.075V30.998zm-1.508 60.542c-.464-.3-1.209-.298-1.67 0l-4.165 2.692-4.165-2.692c-.464-.3-1.209-.298-1.67 0l-4.165 2.692-4.165-2.692c-.464-.3-1.209-.298-1.67 0l-4.165 2.692-4.165-2.692c-.464-.3-1.209-.298-1.67 0l-4.165 2.692-4.165-2.692c-.464-.3-1.209-.298-1.67 0l-4.165 2.692-4.165-2.692c-.464-.3-1.209-.298-1.67 0l-4.316 2.79A1.997 1.997 0 0 1 44 93V30.997A5.996 5.996 0 0 1 50.002 25h48.996A5.996 5.996 0 0 1 105 30.998V93a2 2 0 0 1-.396 1.2l-4.112-2.66z"}),s().createElement("path",{fill:"#F7F8FA",d:"M55 38.999c0-.552.439-.999.999-.999H75c.552 0 .999.439.999.999V58a.993.993 0 0 1-.999.999H56a.993.993 0 0 1-.999-.999V39zm25 .501c0-.828.675-1.5 1.498-1.5h11.004c.827 0 1.498.666 1.498 1.5 0 .828-.675 1.5-1.498 1.5H81.498A1.495 1.495 0 0 1 80 39.5zm0 9c0-.828.675-1.5 1.498-1.5h11.004c.827 0 1.498.666 1.498 1.5 0 .828-.675 1.5-1.498 1.5H81.498A1.495 1.495 0 0 1 80 48.5zm0 9c0-.828.675-1.5 1.498-1.5h11.004c.827 0 1.498.666 1.498 1.5 0 .828-.675 1.5-1.498 1.5H81.498A1.495 1.495 0 0 1 80 57.5zm-25 9c0-.828.677-1.5 1.505-1.5h35.99a1.499 1.499 0 1 1 0 3h-35.99A1.499 1.499 0 0 1 55 66.5zm0 9c0-.828.665-1.5 1.505-1.5h24.99a1.499 1.499 0 1 1 0 3h-24.99A1.499 1.499 0 0 1 55 75.5z"}))},z={current:"当前草稿",published:"发布过的版本",LOCAL:"本地历史备份",LATEST_LOCAL:"本地最新备份"},q={0:"自动备份",1:"网页端",2:"手机端"},V=function(e){var t=e.version,n=e.iconIsAfterText;if(!(null==t?void 0:t.versionType))return null;var r=z[t.versionType]||q[t.draftFrom]||"自动备份",i=t.isLocal?Z.Z:x.Z;return(0,o.BX)(O.xv,{display:"inline-flex",alignItems:"center",children:[n||(0,o.tZ)(i,{size:"16px",css:{marginRight:"4px",color:"#67C23A"}}),r,n&&(0,o.tZ)(i,{size:"16px",css:{marginLeft:"4px",color:"#67C23A"}})]})},W=function(e){(0,h._)(n,e);var t=(0,_._)(n);function n(){var e;return(0,d._)(this,n),e=t.apply(this,arguments),(0,f._)((0,l._)(e),"formatDate",function(e){return e?N.Z("current"===e.versionType?1e3*e.updatedAt:1e3*e.createdAt,"yyyy-MM-dd HH:mm"):null}),(0,f._)((0,l._)(e),"handleDraftClick",function(e){e.preventDefault()}),(0,f._)((0,l._)(e),"renderSideTab",function(t,n){var r=e.props,i=r.currentVersion,a=r.onSelect;return(0,o.BX)("a",{href:"#",className:R()("DraftHistory-version",{"DraftHistory-version--selected":i&&t.versionType===i.versionType&&t.id===i.id}),onClick:function(e){e.preventDefault(),a(t)},children:[(0,o.tZ)("div",{className:"DraftHistory-versionDate",children:e.formatDate(t)}),(0,o.tZ)("div",{className:"DraftHistory-versionType",children:(0,o.tZ)(V,{version:t})})]},n)}),e}return(0,p._)(n,[{key:"renderCurrentDraft",value:function(){var e=this.props,t=e.currentDraft,n=e.onRevert,r=e.currentVersion,i=t.isFetching,a=t.data;return(0,o.BX)("div",{className:"DraftHistory-main",children:[i&&(0,o.tZ)(b.Z,{className:"DraftHistory-loading"}),!i&&a&&(0,o.BX)(c.Fragment,{children:[a.draft.title&&(0,o.tZ)("div",{className:"DraftHistory-draftTitle",children:a.draft.title}),(0,o.tZ)("div",{className:"DraftHistory-draft",children:(0,o.tZ)(U,{draftType:this.props.draftType,html:a.draft.content},String([null==r?void 0:r.id,null==r?void 0:r.versionType]))}),(0,o.BX)("div",{className:"DraftHistory-actions",children:[(0,o.BX)("div",{className:"DraftHistory-meta",children:[this.formatDate(r)," \xb7"," ",(0,o.tZ)(V,{version:r,iconIsAfterText:!0})]}),(0,o.tZ)(P.ZP,{className:"DraftHistory-revert",disabled:"current"===a.versionType,onClick:function(){return n(a)},children:"恢复此版本"})]})]})]})}},{key:"render",value:function(){var e=this.props,t=e.history,n=e.currentDraft,r=e.getHistory,i=e.localDraftHistory;return t?t.isFetching&&!t.items?(0,o.tZ)("div",{className:"DraftHistory",children:(0,o.tZ)(b.Z,{className:"DraftHistory-loading"})}):(0,o.BX)("div",{className:"DraftHistory",children:[(0,o.BX)("div",{className:"DraftHistory-side",children:[(0,o.tZ)("div",{className:"DraftHistory-title",children:"草稿备份"}),(0,o.BX)(w.ZP,{className:"DraftHistory-history",getContainer:function(e){return e},isLoading:t.isFetching,isDrained:t.isDrained,onLoad:r,children:[(null==i?void 0:i.length)>0&&(0,o.tZ)("div",{className:"DraftHistory-LocalSideTabWrapper",children:i.map(this.renderSideTab)}),(0,o.tZ)("div",{children:t.items&&t.items.map(this.renderSideTab)})]})]}),t.items&&!t.items.length&&(0,o.tZ)("div",{className:"DraftHistory-main",children:(0,o.BX)("div",{className:"DraftHistory-empty",children:[(0,o.tZ)(H,{className:"DraftHistory-emptyIcon"}),(0,o.tZ)("div",{className:"DraftHistory-emptyText",children:"还没有云端草稿备份"})]})}),n&&this.renderCurrentDraft()]}):null}}]),n}(c.Component);(0,f._)(W,"propTypes",{history:g().object,currentVersion:g().object,currentDraft:g().object,onSelect:g().func,onRevert:g().func});var X=function(e){(0,h._)(n,e);var t=(0,_._)(n);function n(){var e;return(0,d._)(this,n),e=t.apply(this,arguments),(0,f._)((0,l._)(e),"state",{currentVersion:null}),(0,f._)((0,l._)(e),"getHistory",function(){var t=e.props,n=t.type,r=t.id;(0,t.getHistory)(n,r)}),(0,f._)((0,l._)(e),"handleSelect",function(t){e.setState({currentVersion:t})}),(0,f._)((0,l._)(e),"handleRevert",function(t){var n=e.props,r=n.revert,o=n.onReverted;if(t.isLocal){o&&o(t);return}r(t.versionType,t.id).then(function(){o&&o(t)})}),e}return(0,p._)(n,[{key:"getLocalDraftHistory",value:function(){var e=this;return(0,E._)(function(){var t,n,r;return(0,S.__generator)(this,function(o){switch(o.label){case 0:if(!(t=e.props.getLocalDraftQueue()))return[2];return[4,t.takeLast(2)];case 1:return n=o.sent(),r=function(e,t){return{versionType:t>0?"LOCAL":"LATEST_LOCAL",createdAt:e.__created/1e3,id:e.traceId,textLength:e.textCount,content:e.content,isLocal:!0}},e.setState((0,y._)({localDraftHistory:(n||[]).map(r)},"local"===e.props.initialType&&(null==n?void 0:n.length)>0?{currentVersion:r(n[0])}:{})),[2]}})})()}},{key:"componentDidMount",value:function(){var e=this.props,t=e.type,n=e.id;(0,e.getHistory)(t,n),this.getLocalDraftHistory()}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,r=n.drafts,o=n.getDraft,i=this.state.currentVersion,a=t.currentVersion;!i||i.isLocal||a&&a.versionType===i.versionType&&a.id===i.id||r["".concat(i.versionType,"_").concat(i.id)]||o(i.versionType,i.id)}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.type,n=e.id;(0,e.reset)(t,n)}},{key:"render",value:function(){var e=this.props,t=e.history,n=e.drafts,r=this.state,i=r.currentVersion,a=r.localDraftHistory;return(0,o.tZ)(W,{history:t,currentVersion:i,currentDraft:(null==i?void 0:i.isLocal)?{data:(0,C._)((0,y._)({},i),{draft:{content:i.content}})}:i?n["".concat(i.versionType,"_").concat(i.id)]:null,getHistory:this.getHistory,onSelect:this.handleSelect,onRevert:this.handleRevert,draftType:this.props.draftType,localDraftHistory:a})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return"remote"===e.initialType&&e.history&&e.history.items&&e.history.items.length&&!t.currentVersion?{currentVersion:e.history.items[0]}:null}}]),n}(c.Component);(0,f._)(X,"propTypes",{type:g().string.isRequired,id:g().number.isRequired,onReverted:g().func});var K=(0,I.connect)(function(e,t){var n=t.type,r=t.id;return{history:e.draftHistory.history["".concat(n,"_").concat(r)],drafts:e.draftHistory.drafts}},{getHistory:A.s1,getDraft:A.eJ,revert:A.CU,reset:A.mc})(X),j=function(e){(0,h._)(n,e);var t=(0,_._)(n);function n(){var e;return(0,d._)(this,n),e=t.apply(this,arguments),(0,f._)((0,l._)(e),"handleReverted",function(t){var n=e.props,r=n.onClose,o=n.onReverted;o&&o(t),r&&r()}),(0,f._)((0,l._)(e),"handleClose",function(){var t=e.props.onClose;t&&t()}),e}return(0,p._)(n,[{key:"render",value:function(){var e=this.props,t=e.shown,n=e.type,r=e.id,i=e.draftId,a=e.draftType,c=e.getLocalDraftQueue,s=e.initialType;return(0,o.tZ)(T.Z,{className:"DraftHistoryModal",size:"fullPage",onClose:this.handleClose,children:t&&(0,o.tZ)(K,{initialType:s,type:n,id:r,draftId:i,draftType:a,onReverted:this.handleReverted,getLocalDraftQueue:c})})}}]),n}(c.Component);(0,f._)(j,"propTypes",{shown:g().bool.isRequired,onClose:g().func,type:g().string.isRequired,id:g().number.isRequired,onReverted:g().func}),(0,f._)(j,"defaultProps",{shown:!0});var Y=(0,c.forwardRef)(function(e,t){var n,a,s=e.type,u=e.id,l=e.getId,d=e.handleReverted,p=e.draftId,f=e.draftType,h=e.getDraftId,_=e.getLocalDraftQueue,m=(0,r._)((0,c.useState)(!1),2),g=m[0],T=m[1],E=(0,c.useRef)("remote"),y=(0,i.A)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"remote";E.current=e,T(!0)}),C=(0,i.A)(function(){return T(!1)});return(0,c.useImperativeHandle)(t,function(){return{handleOpen:y,handleClose:C}},[y,C]),(0,o.tZ)(j,{shown:g,onClose:function(){return T(!1)},initialType:E.current,type:s,id:null!==(n=null==l?void 0:l())&&void 0!==n?n:u,draftId:null!==(a=null==h?void 0:h())&&void 0!==a?a:p,draftType:f,onReverted:d,getLocalDraftQueue:_})}),Q=function(e){var t=e.type,n=e.id,r=e.syncDraft,i=e.getId,s=e.getDraftId,l=e.draftId,d=e.draftType,p=e.shouldShowToolbarButton,f=e.getLocalDraftQueue,h={};return h.draftModalRef=(0,c.createRef)(null),{initialize:function(e){Object.assign(h,e)},handleCommand:function(e){return(null==e?void 0:e.startsWith("toggle-draft-history-modal"))?(h.draftModalRef.current.handleOpen(e.split(":")[1]),"handled"):"not-handled"},components:[(0,o.tZ)(Y,{type:t,id:n,getId:i,draftId:l,getDraftId:s,draftType:d,ref:h.draftModalRef,handleReverted:function(e){h.getEditorRef().props.resetWithValue(e.draft.content)},getLocalDraftQueue:f},"draft_history_modal")],toolbar:{section:"menu",label:"草稿备份",icon:a.x8,onClick:function(){r.flush(),h.draftModalRef.current.handleOpen(),u.Z.trackEvent(null,{id:5013,action:"Click",name:"草稿备份入口"})},shouldShow:void 0===p?function(){return!0}:p}}}},84071:function(e,t,n){"use strict";n.d(t,{Z:function(){return $}});var r,o,i,a,c=n(9338),s=n(55164),u=n(57477),l=n(30971),d=n(85879),p=n(78160),f=n(80230),h=n(42559),_=n.n(h),m=n(38455),g=n(94009),T=n(65733),E=n(87363),y=n(87641),C=n(12564),S=n(19319),I=n(36963),A=n(63722),b=n(39358),w=function(e){var t=e.isPositive,n=e.onFeedback,r=e.onUndo,o=e.onConfirm,i=(0,g._)((0,E.useState)(!1),2),a=i[0],c=i[1];return(0,d.BX)(y.kC,{justifyContent:"space-between",alignItems:"center",children:[(0,d.BX)(y.kC,{alignItems:"center",children:[(0,d.tZ)(I.ZP,{size:16,fill:"var(--GBL01A)"}),(0,d.tZ)("span",{css:{marginLeft:"4px",color:"var(--MapText03A)"},children:"解析完成，请检查格式"})]}),(0,d.BX)(y.kC,{alignItems:"center",css:{fontSize:"12px",color:"var(--MapText06A)"},children:[(0,d.tZ)("span",{children:!0===t||!1===t?"非常感谢你的反馈 ~ ":"解析结果是否满意？"}),(0,d.tZ)(C.ZP,{preset:C.EE.Plain,onClick:function(){return n(!0)},css:{margin:"0 12px"},"aria-label":"反馈满意",children:(0,d.tZ)(A.Z,{size:16,fill:!0===t?"var(--MapBrand)":"var(--MapText07A)"})}),(0,d.tZ)(C.ZP,{preset:C.EE.Plain,onClick:function(){return n(!1)},"aria-label":"反馈不满意",children:(0,d.tZ)(b.Z,{size:16,fill:!1===t?"var(--MapCriticalTip)":"var(--MapText07A)"})}),(0,d.tZ)("span",{css:{width:"1px",height:"12px",margin:"0 20px",backgroundColor:"var(--MapText07A)"}}),(0,d.BX)(y.kC,{css:{fontWeight:500},children:[(0,d.tZ)(C.ZP,{preset:C.EE.Plain,color:C.rp.Grey,onClick:function(){a||(c(!0),r())},disabled:a,children:"撤销"}),(0,d.tZ)(C.ZP,{preset:C.EE.Link,css:{color:"var(--GBL01A)",marginLeft:"20px"},onClick:o,children:"确认"})]})]})]})},Z=n(65871),x=function(e){var t=e.onCancel,n=e.onRetry;return(0,d.BX)(y.kC,{alignItems:"center",justifyContent:"space-between",children:[(0,d.BX)(y.kC,{alignItems:"center",css:{gap:"4px"},children:[(0,d.tZ)(Z.Z,{size:16,css:{color:"var(--MapCriticalTip)"}}),(0,d.tZ)(y.xv,{children:"似乎出了点问题，请重试"})]}),(0,d.BX)(y.kC,{children:[(0,d.tZ)(C.ZP,{preset:C.EE.Plain,color:C.rp.Grey,css:{fontWeight:500},onClick:t,children:"取消"}),(0,d.tZ)(C.ZP,{preset:C.EE.Link,css:{color:"var(--GBL01A)",marginLeft:"20px",fontWeight:500},onClick:n,children:"重试"})]})]})},k=n(83921),R=function(e){var t=e.formatType,n=e.setFormatType,r=e.onConfirm;return(0,d.BX)("div",{css:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,d.BX)(y.kC,{children:[(0,d.tZ)("span",{children:"识别到特殊格式，请确认是否将"}),(0,d.BX)(C.ZP,{preset:C.EE.Link,onClick:function(){"markdown"===t?n("html"):n("markdown")},"aria-label":"切换格式",css:{cursor:"pointer",color:"var(--GBL01A)",display:"flex",alignItems:"center"},children:[(0,d.tZ)(y.xv,{fontWeight:"bold",css:{marginLeft:"4px"},children:"markdown"===t?"Markdown":"富文本"}),(0,d.tZ)(k.ZP,{size:16,css:{marginRight:"4px",color:"var(--GBL01A)"}})]}),(0,d.tZ)("span",{children:"解析为正确格式"})]}),(0,d.tZ)(C.ZP,{preset:C.EE.Link,css:{color:"var(--GBL01A)",fontWeight:500},onClick:r,children:"确认并解析"})]})},N=n(79065),O=n(41402),P=n(80685);function D(){var e=(0,N._)(["\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n"]);return D=function(){return e},e}var L=(0,O.F4)(D()),M=function(e){var t=e.formatType,n=e.onCancel;return(0,d.BX)(y.kC,{alignItems:"center",justifyContent:"space-between",children:[(0,d.BX)(y.kC,{alignItems:"center",children:[(0,d.tZ)(P.Z,{width:16,height:16,css:{animation:"".concat(L," 1s linear infinite")}}),(0,d.tZ)(y.xv,{fontWeight:"bold",css:{color:"var(--GBL01A)",margin:"0 4px"},children:"markdown"===t?"Markdown":"富文本"}),(0,d.tZ)(y.xv,{children:"解析中，请稍候..."})]}),(0,d.tZ)(C.ZP,{preset:C.EE.Plain,color:C.rp.Grey,onClick:n,css:{fontWeight:500},children:"取消"})]})},B=function(e){var t,n=e.initState,r=e.initFormatType,o=e.scene,i=e.contentToken,a=e.taskId,s=e.traceId,u=e.text,p=e.onClose,f=e.onUpload,h=e.onUndo,_=e.onParse,m=e.onFeedbackSubmit,I=e.onNotificationStateChange,A=(0,g._)((0,E.useState)(n||"initial"),2),b=A[0],Z=A[1],k=(0,g._)((0,E.useState)(r),2),N=k[0],O=k[1],P=(0,g._)((0,E.useState)(),2),D=P[0],L=P[1],B=(0,E.useRef)(null),U=(0,T.A)(I),G=(t=(0,c._)(function(){var e,t;return(0,l.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),Z("parsing"),e=new AbortController,B.current=e,[4,_({formatType:N,taskId:a,traceId:s,text:u,scene:o,contentToken:i},e)];case 1:if(!n.sent())return Z("failed"),[2];return Z("completed"),[3,4];case 2:if((null==(t=n.sent())?void 0:t.name)==="AbortError")return[2];return Z("failed"),[3,4];case 3:return B.current=null,[7];case 4:return[2]}})}),function(){return t.apply(this,arguments)});(0,E.useEffect)(function(){U(b)},[b,U]),(0,E.useEffect)(function(){return function(){B.current&&B.current.abort()}},[]);var F=function(e){L(!!e),null==m||m({taskId:a,feedback:e?"good":"bad",scene:o,contentToken:i,traceId:s})},H=function(){null==m||m({taskId:a,feedback:"bad",scene:o,contentToken:i,traceId:s}),p()},z=function(){switch(b){case"parsing":return{text:(0,d.tZ)(M,{formatType:N,onCancel:function(){B.current&&B.current.abort(),p()}})};case"completed":return{delay:5e3,text:(0,d.tZ)(w,{isPositive:D,onFeedback:F,onUndo:h,onConfirm:p})};case"failed":return{delay:5e3,text:(0,d.tZ)(x,{onCancel:H,onRetry:function(){G()}})};case"upload":return{delay:5e3,text:(0,d.BX)(y.kC,{alignItems:"center",justifyContent:"space-between",children:[(0,d.tZ)(y.kC,{alignItems:"center",children:(0,d.tZ)(y.xv,{children:"暂不支持直接识别 Markdown 语法，建议使用文档导入上传"})}),(0,d.tZ)(C.ZP,{preset:C.EE.Link,css:{color:"var(--GBL01A)"},onClick:f,children:"文档导入"})]})};default:return{delay:1e4,text:(0,d.tZ)(R,{formatType:N,setFormatType:O,onConfirm:function(){G()}})}}}(),q=z.text,V=z.delay;return(0,d.tZ)(S.Z,{delay:V,css:{top:"128px",width:"650px",animation:"initial"!==b?"none":""},notification:{text:q}},b)},U=n(10822),G=n(94629),F=n(82371),H=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;return setTimeout(function(){e.abort(new U.W)},t),e.signal},z=(r=(0,c._)(function(e){return(0,l.__generator)(this,function(t){switch(t.label){case 0:return[4,(0,F.d)("/editor/paste/suggestion",{method:"POST",body:e})];case 1:return[2,t.sent()||{}]}})}),function(e){return r.apply(this,arguments)}),q=(o=(0,c._)(function(e,t){var n,r,o,i,a;return(0,l.__generator)(this,function(c){switch(c.label){case 0:n=(0,p.Z)(new Date,"yyyy-MM-dd HH:mm:ss"),r=H(new AbortController),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,(0,F.d)("/editor/paste/type",{method:"POST",body:e,signal:r})];case 2:return[2,c.sent()];case 3:throw o=c.sent(),i=(0,G.o)(o)||"unknown",a=o.message,"FetchError"!==i&&z({task_id:e.task_id,feedback:"bad",scene:e.scene,content_token:e.content_token,source:"error_feedback",error_info:JSON.stringify({name:i,message:a}),timestamp:JSON.stringify({paste_timestamp:t,fetch_type_timestamp:n,fetch_suggestion_timestamp:(0,p.Z)(new Date,"yyyy-MM-dd HH:mm:ss")})}),o;case 4:return[2]}})}),function(e,t){return o.apply(this,arguments)}),V=(i=(0,c._)(function(e,t){var n;return(0,l.__generator)(this,function(r){switch(r.label){case 0:return n=H(t||new AbortController),[4,(0,F.d)("/editor/paste/parse",{method:"POST",body:e,signal:n})];case 1:return[2,r.sent()]}})}),function(e,t){return i.apply(this,arguments)}),W=n(12627),X=n(99264),K=function(e,t,n){var r=(null==n?void 0:n.props)||{},o=r.html2draftMiddlewares,i=r.draft2htmlMiddlwares;if("html"===e){var a=(0,X.VW)({source:"FormatEditor_PasteHtml",editorKey:null==n?void 0:n._editorKey});return(0,W.ME)({source:"FormatEditor_PasteHtml",editorKey:null==n?void 0:n._editorKey})(a(t,{fromClipboard:!0,disableImage:!1,middlewares:o||[]}),{outputBlockType:"p",middlewares:i||[]})}return t},j=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3?arguments[3]:void 0;try{var o,i,a=e.getEditorRef(),c=e.getEditorState();if(!n||!c||!t)return;var s=((null==a?void 0:a.props)||{}).html2draftMiddlewares,u=(0,X.VW)({source:"FormatEditor_ReplacePastedRangeWithHtml",editorKey:null==a?void 0:a._editorKey})(n,{fromClipboard:!0,disableImage:!1,middlewares:s||[]});if(!u||!u.getBlockMap||0===u.getBlockMap().size)return;var l=r;if(!l){var d=c.getSelection();if(!d)return;l=f.SelectionState.createEmpty(d.getStartKey()).merge({anchorKey:d.getStartKey(),anchorOffset:d.getStartOffset(),focusKey:d.getEndKey(),focusOffset:d.getEndOffset(),isBackward:!1})}var p=c.getCurrentContent();if(!p)return;var h=u.getBlockMap(),_=p.getBlockForKey(l.getAnchorKey()),m=l.getFocusKey()!==_.getKey()||0===l.getAnchorOffset()&&l.getFocusOffset()===_.getLength(),g=f.Modifier.replaceWithFragment(p,l,h),T=h.first(),E=1===h.size&&m&&T&&T.getType()!==_.getType()&&T?(o=l,i=T.getType(),f.Modifier.setBlockType(g,f.SelectionState.createEmpty(o.getAnchorKey()).merge({anchorOffset:0,focusOffset:g.getBlockForKey(o.getAnchorKey()).getLength()}),i)):g,y=f.EditorState.push(c,E,"insert-fragment");t(y)}catch(e){console.error(e)}},Y=(a=(0,c._)(function(e,t,n,r){var o,i,a,c,s,u,d,p,f,h;return(0,l.__generator)(this,function(l){switch(l.label){case 0:if(i=n.formatType,a=n.text,c=n.scene,s=n.contentToken,u=n.taskId,d=n.setEditorState,p=n.traceId,"html"!==i&&"markdown"!==i)return[2,null];return f=K(i,a,e.getEditorRef()),[4,V({task_id:u,content:a,content_type:i,html:f,scene:c,content_token:s,trace_id:p},r)];case 1:return h=l.sent(),j(e,d,"html"===i?f:(null==h?void 0:null===(o=h.data)||void 0===o?void 0:o.parsedContent)||"",t),[2,h||null]}})}),function(e,t,n,r){return a.apply(this,arguments)}),Q=function(e,t){var n=e.getEditorState().getSelection();if(!t)return null;var r=t.getStartKey(),o=t.getStartOffset(),i=n.getAnchorKey(),a=n.getAnchorOffset();return f.SelectionState.createEmpty(r).merge({anchorKey:r,anchorOffset:o,focusKey:i,focusOffset:a,isBackward:!1})},J=function(e,t,n,r){t.currentNotificationState="initial",r((0,s._)({initState:"initial"},e));var o,i=n.getEditorState();i&&(t.lastContentState=i.getCurrentContent());var a=(null===(o=e.editorState)||void 0===o?void 0:o.getSelection())||null;setTimeout(function(){t.pastedSelection=Q(n,a)},0)},$=function(e){var t,n=e.traceId,r=e.contentToken,o=e.scene,i=e.getLinkTextReplacedInfo,a={},h={pastedSelection:null,currentNotificationState:null,lastContentState:null,closeNotification:function(){}},g=function(){if(h.closeNotification){var e;null===(e=h.closeNotification)||void 0===e||e.call(h),h.closeNotification=function(){},h.currentNotificationState=null,h.lastContentState=null,h.pastedSelection=null}},T=function(e){g();var t=e.contentType,n=void 0===t?"markdown":t,r=e.initState,o=e.taskId,i=e.traceId,p=e.text,_=e.html,T=e.scene,E=e.contentToken,y=e.setEditorState;(0,m.Z)(function(e){var t;return h.closeNotification=e,(0,d.tZ)(B,{initState:r||"initial",initFormatType:n,taskId:o,traceId:i,text:p,html:_,scene:T,contentToken:E,onClose:g,onUpload:function(){a.getEditorRef().props.handleKeyCommand("insert-doc"),g()},onUndo:function(){if(a.getEditorState().getUndoStack().size>0){var e=f.EditorState.undo(a.getEditorState());a.setEditorState(e)}},onParse:(t=(0,c._)(function(e,t){return(0,l.__generator)(this,function(n){switch(n.label){case 0:return[4,Y(a,h.pastedSelection,(0,u._)((0,s._)({},e),{setEditorState:y}),t)];case 1:return[2,!!n.sent()]}})}),function(e,n){return t.apply(this,arguments)}),onNotificationStateChange:function(e){h.currentNotificationState=e},onFeedbackSubmit:function(e){z({task_id:e.taskId,feedback:e.feedback,scene:e.scene,content_token:e.contentToken,trace_id:e.traceId,source:"user_feedback"})}},"notificationFormat")})};return{initialize:function(e){Object.assign(a,e)},handlePastedText:(t=(0,c._)(function(e,t,i,c){var s,u,d,f,m;return(0,l.__generator)(this,function(l){switch(l.label){case 0:if(s=c.setEditorState,""===e.trim())return[2,"not-handled"];u=_()(),d=(0,p.Z)(new Date,"yyyy-MM-dd HH:mm:ss"),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,q({task_id:u,content:e.substring(0,1e3),scene:o,content_token:r,trace_id:n},d)];case 2:if(!(f=l.sent())||!f.data||!f.data.contentType||"text"===f.data.contentType)return[2,"not-handled"];if(!f.data.ab)return T({initState:"upload",taskId:u,text:e,html:t,scene:o,contentToken:r,traceId:n}),z({task_id:u,feedback:"bad",scene:o,content_token:r,trace_id:n,source:"ab_feedback"}),[2,"handled"];if("html"===(m=f.data.contentType)||"markdown"===m)return J({contentType:m,taskId:u,text:e,html:t,scene:o,contentToken:r,editorState:i,setEditorState:s,traceId:n},h,a,T),[2,"handled"];return[3,4];case 3:return l.sent(),[2,"not-handled"];case 4:return[2,"not-handled"]}})}),function(e,n,r,o){return t.apply(this,arguments)}),onChange:function(e){var t=e.getCurrentContent(),n=i(),r=!!(null==n?void 0:n.replaced);if("initial"===h.currentNotificationState){if(h.lastContentState){if(!t.equals(h.lastContentState)&&!r)return g(),e}else h.lastContentState=t}return h.lastContentState=t,e}}}},23074:function(e,t,n){"use strict";n.d(t,{Z:function(){return X}});var r=n(94009),o=n(85879),i=n(87363),a=n(91850),c=n(55164),s=n(71728),u=n(87641),l=n(24486),d=n(63638),p=n(29229),f=n(13649),h=n(83688),_=n(25405),m=n(40933),g=n(28545),T=n(11690),E=n(59280),y=n(21706),C=n(15881),S=n(2347),I=n(16427),A=n(28124),b=n(7629),w=n(47866),Z=n(2325),x=n(29126),k=n(65389),R=n(48936),N=n(80714),O=function(e){var t=e.name,n=e.isFirst;return(0,o.BX)(o.HY,{children:[!n&&(0,o.tZ)(u.xv,{color:"GBK06A",fontSize:"12px",mx:"4px",children:"+"}),(0,o.tZ)(u.kC,{px:"4px",css:function(e){return[{minWidth:"24px",borderRadius:"2px",height:"24px",lineHeight:"26px",background:e.colors.GBK10C,textAlign:"center",color:e.colors.GBK05A,fontSize:"14px",alignItems:"center",justifyContent:"center"},n&&{marginLeft:"auto"}]},children:t})]})},P=function(e){var t=e.label,n=e.Icon,r=e.shortcut;return(0,o.BX)(u.kC,{alignItems:"center",css:{"&+&":{marginTop:"20px"}},children:[(0,o.tZ)(n,{size:20,css:function(e){return{color:e.colors.GBK03A}}}),(0,o.tZ)(u.xv,{ml:"8px",color:"GBK03A",fontSize:"14px",children:t}),r.split("+").map(function(e,t){return(0,o.tZ)(O,{name:e,isFirst:!t},t)})]})},D=n(26030),L=n(19012),M=n(73927),B=n(93975),U=n(68796),G=n(62095),F=function(e){var t=e.name,n=e.describe,r=e.isFirst;return(0,o.BX)(u.xu,{css:function(e){return{color:e.colors.GBK03A,paddingTop:r?"0":"20px"}},fontSize:14,fontWeight:400,children:[(0,o.tZ)(u.xv,{css:function(e){return{color:e.colors.GBK02A}},mb:"8px",fontWeight:500,children:t}),n.map(function(e){return"string"==typeof e?(0,o.tZ)(u.xv,{lineHeight:"20px",children:e}):(0,o.tZ)(o.HY,{children:e})})]})},H=[{name:"快捷键",component:function(e){var t,n=e.activeTabName,r=(0,f.n)().isAppleDevice;return(0,o.tZ)(d.ZAShow,{zaType:"Text",zaText:n,as:u.xu,py:"20px",css:function(e){return{background:e.colors.GBK99A}},children:(t="1"===N.Z.apollo.editor_adapt_native,[{icon:h.Z,label:"粗体",shortcut:"⌘+B",shortcutWin:"Ctrl+B"},{icon:t?_.ZP:m.ZP,label:t?"标题":"一级标题",shortcut:"⌘+⌥+1",shortcutWin:"Ctrl+Alt+1"},!t&&{icon:g.ZP,label:"二级标题",shortcut:"⌘+⌥+2",shortcutWin:"Ctrl+Alt+2"},{icon:T.ZP,label:"有序列表",shortcut:"⌘+⇧+L",shortcutWin:"Ctrl+Shift+L"},{icon:E.ZP,label:"无序列表",shortcut:"⌘+L",shortcutWin:"Ctrl+L"},{icon:y.ZP,label:"引用块",shortcut:"⌘+⇧+U",shortcutWin:"Ctrl+Shift+U"},{icon:C.Z,label:"代码块",shortcut:"⌘+⌥+C",shortcutWin:"Ctrl+Alt+C"},{icon:S.ZP,label:"撤销",shortcut:"⌘+Z",shortcutWin:"Ctrl+Z"},{icon:I.ZP,label:"重做",shortcut:"⌘+Y",shortcutWin:"Ctrl+Y"},{icon:A.Z,label:"清除格式",shortcut:"⌘+\\",shortcutWin:"Ctrl+\\"},{label:"插入链接",icon:b.ZP,shortcut:"⌘+K",shortcutWin:"Ctrl+K"},{icon:w.ZP,label:"目录",shortcut:"⌘+⌥+J",shortcutWin:"Ctrl+Alt+J"},{icon:Z.Z,label:"插入注释",shortcut:"⌘+⌥+K",shortcutWin:"Ctrl+Alt+K"},{icon:x.Z,label:"插入分割线",shortcut:"⌘+⌥+S",shortcutWin:"Ctrl+Alt+S"},{label:"插入表格",icon:k.Z,shortcut:"⌘+⌥+T",shortcutWin:"Ctrl+Alt+T"},{label:"插入公式",icon:R.Z,shortcut:"⌘+⌥+E",shortcutWin:"Ctrl+Alt+E"}].filter(Boolean)).map(function(e,t){var n=e.label,i=e.icon,a=e.shortcut,c=e.shortcutWin;return(0,o.tZ)(P,{label:n,Icon:i,shortcut:r?a:c},"ShortcutDoc"+t)})})}},{name:"Markdown",component:function(e){var t,n=e.activeTabName,r=(0,G.Z)().jumpUrl;return(0,o.BX)(d.ZAShow,{zaType:"Text",zaText:n,as:u.xu,py:"20px",css:function(e){return{background:e.colors.GBK99A}},children:[(0,o.BX)(u.xu,{fontSize:12,css:function(e){return{color:e.colors.GBK06A,margin:"-10px 0 20px 0"}},children:[(0,o.tZ)(u.xv,{children:"在工具栏-更多中设置为 Markdown 模式后，才会自动识别后续输入内容，转化为对应格式；"}),(0,o.BX)(u.xv,{children:["如你希望每篇内容均为此格式，可在",(0,o.tZ)(u.rU,{css:{cursor:"pointer",textDecoration:"underline",margin:"0 5px"},onClick:function(){return window.open(r)},children:"默认设置"}),"中修改默认编辑器偏好"]})]}),[{icon:(t="1"===N.Z.apollo.editor_adapt_native)?_.ZP:m.ZP,label:t?"标题":"一级标题",shortcut:"#+空格"},!t&&{icon:g.ZP,label:"二级标题",shortcut:"##+空格"},{icon:T.ZP,label:"有序列表",shortcut:"1+.+空格"},{icon:E.ZP,label:"无序列表",shortcut:"*+空格"},{icon:h.Z,label:"粗体",shortcut:"**文字**"},!t&&{icon:D.ZP,label:"斜体",shortcut:"*文字*"},!t&&{icon:L.Z,label:"倾斜加粗",shortcut:"***文字***"},{icon:M.Z,label:"行内代码",shortcut:"`文字`"},{icon:C.Z,label:"代码块",shortcut:"```+回车"},{icon:y.ZP,label:"引用块",shortcut:">+空格"},{icon:x.Z,label:"分割线",shortcut:"---+回车"},{icon:B.Z,label:"插入图片",shortcut:"![描述](链接)+空格"},{icon:U.Z,label:"LaTeX 语法",shortcut:"$$文字$$+空格"},{icon:b.ZP,label:"插入链接",shortcut:"[标题](链接)+空格"}].filter(Boolean).map(function(e,t){var n=e.label,r=e.icon,i=e.shortcut;return(0,o.tZ)(P,{label:n,Icon:r,shortcut:i},"MarkdownDoc"+t)})]})}},{name:"功能说明",component:function(e){var t,n=e.activeTabName;return(0,o.tZ)(d.ZAShow,{zaType:"Text",zaText:n,as:u.xu,py:"20px",css:function(e){return{background:e.colors.GBK99A}},children:(t="1"===N.Z.apollo.editor_adapt_native,[{tabName:"目录",describe:["选中工具栏的目录功能后，在编辑器中添加标题，左侧自动识别标题生成目录；",(0,o.BX)(o.HY,{children:[(0,o.tZ)(u.xv,{my:"8px",children:"若不想添加此标题至目录中，可将鼠标悬浮在目录区域的对应标题上，点击「删除」按钮即可移除；"}),(0,o.tZ)(u.Ee,{my:"8px",src:t?"https://pic1.zhimg.com/v2-3fe6c6228a545148c1fe24c4f84208f6.png":"https://pic1.zhimg.com/v2-3173fb93f4c628ebc8245a2ae2ecea1d.png?source=6a64a727"}),(0,o.tZ)(u.xv,{my:"8px",children:"若想重新添加标题至目录中，可以在正文中选中此标题，并在目录区域找到对应标题，点击「固定」按钮即可重新添加。"}),(0,o.tZ)(u.Ee,{my:"8px",src:t?"https://picx.zhimg.com/v2-17b7a5f82f5dfb856ce853188233d7cd.png":"https://pic2.zhimg.com/v2-1cabcd37bc16361cf95f172fc3ef86f0.png?source=6a64a727"})]})]},{tabName:"代码",describe:[t?"点击工具栏中的代码块图标后，编辑器内生成代码卡片。":"点击工具栏中的代码块图标后，编辑器内生成代码卡片，右上方选择语法，可在代码块中展示语法高亮。"]},{tabName:"公式",describe:["点击工具栏中的公式图标后，在公式编辑器输入 LaTeX 语法，下方为预览区。",(0,o.BX)(o.HY,{children:["您可在",(0,o.tZ)(u.rU,{css:function(e){return{color:e.colors.GBL01A}},target:"_blank",href:"https://math.meta.stackexchange.com/questions/5020/mathjax-basic-tutorial-and-quick-reference",children:"LaTeX基础教程"}),"中参考更多语法"]})]},{tabName:"注释",describe:["点击工具栏中的注释图标，在注释编辑弹框中输入注释文本及链接后，文本对应的注释会出现在文末。"]},{tabName:"草稿备份",describe:["点击工具栏中的草稿备份后，可在自动保存的草稿版本中查看历史草稿，点击恢复此版本可还原历史草稿。"]},{tabName:"文档导入",describe:["点击工具栏中的文档图标，导入 .docx/.md 文档后，编辑器会自动解析内容并展示在编辑器中。若粘贴图片失败，建议使用文档导入功能。"]}].filter(Boolean)).map(function(e,t){var n=e.tabName,r=e.describe;return(0,o.tZ)(F,{name:n,describe:r,isFirst:!t},"FunctionDoc"+t)})})}}],z=function(e){var t=e.children,n=e.className;return(0,o.tZ)("h1",{css:function(e){return{background:e.colors.GBK99A,color:e.colors.GBK02A,lineHeight:"31px",fontSize:"22px",fontWeight:"600"}},className:n,children:t})},q=function(e){var t=e.active,n=(0,s._)(e,["active"]);return(0,o.tZ)(d.ZAClick,(0,c._)({zaType:"Button",zaText:!0,as:"button",css:function(e){return[{display:"inline-block",width:"88px",borderRadius:"999px",height:"26px",lineHeight:"26px",background:t?e.colorMod(e.colors.primary).alpha(.1):e.colors.GBK10C,textAlign:"center",cursor:"pointer",color:t?e.colors.primary:e.colors.GBK06A,fontSize:"13px",marginRight:"7px",marginBottom:"14px"},t&&{fontWeight:"500"}]}},n))};function V(e){var t=e.className,a=e.onClose,c=e.getInitialOffset,s=e.getShouldHide,f=(0,r._)((0,i.useState)(0),2),h=f[0],_=f[1],m=H[h].component,g=(0,p._)(function(){return Promise.all([n.e(5423),n.e(2607),n.e(2174),n.e(5052)]).then(n.bind(n,99063))});return g?(0,o.tZ)(d.ZAEnv,{block:"EditorHelpDoc",children:(0,o.BX)(g,{className:t,getInitialOffset:c,getShouldHide:s,children:[(0,o.tZ)(d.ZAShow,{zaType:"Popup",zaText:"帮助文档"}),(0,o.BX)(u.kC,{bg:"GBK99A",pl:"16px",sx:{borderBottom:"1px solid",borderColor:"GBK09A",height:"52px",alignItems:"center"},children:[(0,o.tZ)(z,{css:{fontSize:"18px",lineHeight:"24px"},children:"帮助文档"}),(0,o.tZ)(u.xv,{color:"GBK06A",fontSize:"12px",lineHeight:"17px",fontWeight:"400",ml:"8px",mt:"4px",children:"支持拖拽和调整高度"}),(0,o.tZ)(d.ZAClick,{zaType:"Button",zaAction:"Unknown",zaText:"关闭帮助文档",as:l.eb,css:{marginLeft:"auto",padding:"16px",cursor:"pointer"},onClick:a})]}),(0,o.BX)(u.xu,{ml:"16px",mr:"9px",pt:"14px",children:[H.map(function(e,t){return(0,o.tZ)(q,{active:h===t,onClick:function(){h!==t&&_(t)},children:e.name},t)}),(0,o.tZ)(u.xu,{mr:"7px",sx:{height:"2px",borderBottom:"1px solid",borderColor:"GBK09A",alignItems:"center"}})]}),(0,o.tZ)(u.xu,{px:"16px",css:{height:"calc(100% - 112px)",overflow:"auto"},children:m&&(0,o.tZ)(m,{activeTabName:H[h].name})})]})}):null}var W=(0,i.forwardRef)(function(e,t){var n=e.getInitialOffset,c=e.getShouldHide,s=e.forceUpdate,u=(0,r._)((0,a.k)(!1),2),l=u[0],d=u[1];return(0,i.useImperativeHandle)(t,function(){return{toggle:d.toggle,getShown:function(){return l}}},[d,l]),l&&(0,o.tZ)(V,{onClose:function(){d.toggle(),s&&requestAnimationFrame(function(){s()})},getInitialOffset:n,getShouldHide:c})}),X=function(e){var t=e.getInitialOffset,n=e.getShouldHide,r=e.forceUpdate,a={};return a.helpDocRef=(0,i.createRef)(null),{initialize:function(e){Object.assign(a,e)},handleCommand:function(e){return"toggle-help-document"===e?(a.helpDocRef.current.toggle(),r&&requestAnimationFrame(function(){r()}),"handled"):"not-handled"},queryCommandState:function(e){if("toggle-help-document"===e){var t;return!!(null===(t=a.helpDocRef.current)||void 0===t?void 0:t.getShown())}},components:[(0,o.tZ)(W,{getInitialOffset:t,getShouldHide:n,ref:a.helpDocRef,forceUpdate:r},"EditorHelpDocContainer")]}}},36212:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(80230),o=function(e,t){var n=e.store,o=e.getSentences;return Promise.resolve(null==o?void 0:o()).then(function(e){if(null==e?void 0:e.length){var o=n.getEditorState(),i=o.getCurrentContent(),a=i.getBlockMap();e.filter(function(e){var t;return(null==e?void 0:null===(t=e.position)||void 0===t?void 0:t.start)&&e.position.end}).forEach(function(e){var c=e.position,s=c.start,u=s.paragraphId,l=s.offset,d=c.end,p=d.paragraphId,f=d.offset,h=null,_=null,m=f,g=a.skipUntil(function(e){var t,n=null===(t=e.getData())||void 0===t?void 0:t.get("pid"),r=e.getKey();return n===u&&(h=r,!0)}).takeUntil(function(e){if(_)return!0;var t,n=null===(t=e.getData())||void 0===t?void 0:t.get("pid"),r=e.getKey();return n===p&&(_=r,m=Math.min(e.getLength(),f)),!1});if(!h||!_){console.error("句子互动：无法找到对应的互动句子，startPid：".concat(u,"，startKey：").concat(h,"，endPid：").concat(p,"，endKey：").concat(_));return}var T=r.SelectionState.createEmpty(h).merge({anchorOffset:l,focusKey:_,focusOffset:m});i=r.Modifier.applyInlineStyle(i,T,"INTERACT"),o=r.EditorState.set(o,{currentContent:i}),n.setEditorState(o),t(g)})}})};function i(e){var t=e.getSentences,n={},r=new Set,i=!1,a=!1;return{initialize:function(e){Object.assign(n,e),o({store:n,getSentences:t},function(e){(null==e?void 0:e.size)&&e.forEach(function(e){var t=e.getKey();r.add(t)})})},customStyleMap:{INTERACT:{borderBottom:"1px dashed #BFBFBF"}},onChange:function(e){if(!r.size)return e;var t=!1,n=e.getCurrentContent(),o=e.getSelection(),c=o.getHasFocus()&&a;if(a=o.getHasFocus(),c){var s=n.getBlockMap(),u=o.getStartKey(),l=o.getEndKey(),d=!1;s.skipUntil(function(e){return e.getKey()===u}).takeUntil(function(e){return!!d||(e.getKey()===l&&(d=!0),!1)}).toArray().forEach(function(e,n){t||e.findStyleRanges(function(e){return e.hasStyle("INTERACT")},function(r,i){if(n>0){t=!0;return}t=o.hasEdgeWithin(e.getKey(),0,i)})})}return t!==i&&(i=t),e}}}},99616:function(e,t){"use strict";t.Z=function(e){var t=e.onToggle;return{handleCommand:function(e){return"toggle-markdown-enabled"===e?(t(),"handled"):"not-handled"}}}},41766:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(55164),o=n(57477),i=n(85879),a=n(93975),c=n(87363),s=n.n(c),u=n(11809),l=n(20944),d=n(99445),p=n(18960),f=n(62263),h=function(e){var t=e.sourceType,n=e.sourceId,c=e.contentId,h=e.onUseAiImageFeature,_=s().createRef(null),m={},g=!1,T=null,E=function(e){g=!0,T=m.getEditorState(),e(),m.setEditorState(T),g=!1},y=function(e,t,n){g?T=(0,d.Z)(T,"image","IMMUTABLE",(0,o._)((0,r._)({},t?null==e?void 0:e.value:{upload:e}),{size:"normal"}),void 0,{isBatched:!0,isLastOneOfBatch:n}):m.setEditorState((0,d.Z)(m.getEditorState(),"image","IMMUTABLE",{upload:e,size:"normal"}))};return{initialize:function(e){Object.assign(m,e)},components:[(0,i.tZ)(p.Z,{ref:_,sourceType:t,sourceId:n,contentId:c,insertImage:function(e,t){var n=t.isRequest;E(function(){for(var t=0;t<e.length;t++){var r=t===e.length-1;y({value:e[t]},n,r)}})},tabs:[f.gn.LOCAL,f.gn.PHOTO_LIBRARY,f.gn.EMOTICON,f.gn.PRIVATE,f.gn.LATEST],onUseAiImageFeature:h},"material_library")],handleCommand:function(e){if("insert-image-from-library"===e){var t;return null===(t=_.current)||void 0===t||t.toggleShown(),"handled"}return"not-handled"},toolbar:{label:"插入图片",section:u.Z.BASIC_MEDIA,text:"图片",icon:a.y,priority:2,onClick:function(){var e;null===(e=_.current)||void 0===e||e.toggleShown()}},toolbarV2:[{label:"插入图片",section:l.Z.BASIC_MEDIA,text:"图片",icon:a.y,priority:2,onClick:function(){var e;null===(e=_.current)||void 0===e||e.toggleShown()}}]}}},64875:function(e,t,n){"use strict";n.d(t,{Z:function(){return C}});var r=n(94009),o=n(85879),i=n(55283),a=n(80874),c=n(87363),s=n(92258),u=n(69383),l=n(78920),d=n(57730),p=n(22701),f=n(11809),h=n(20944),_=n(59013),m=n(31467),g=n(38765),T=n(96354),E={Ecommerce:"1",Hotel:"2",Tickets:"3",Advertising:"4",Store:"5",RedPacket:"6",Vop:"7",Kepler:"8",SelfPurchase:"9",SelfPublishedBooks:"10",Education:"11"},y=(0,c.forwardRef)(function(e,t){var n=e.getStore,a=e.getContentInfo,u=(0,r._)((0,c.useState)(!1),2),p=u[0],f=u[1],h=(0,s.useSelector)(function(e){return e.userProfit}).linkCardLimit,y=a(),C=y.id,S=y.type;(0,c.useImperativeHandle)(t,function(){return{setShowUserProfitCardSelector:f}},[]);var I=(0,s.useDispatch)();(0,c.useEffect)(function(){I((0,T.nh)())},[I]);var A=function(){return(0,_.Z)(n().getEditorState()).filter(function(e){return"ad-link-card"===e.getType()})};return(0,o.tZ)(o.HY,{children:(0,o.tZ)(m.Z,{className:"UserProfitCardSelector",size:"large",onClose:function(){f(!1)},children:p&&(0,o.tZ)("div",{className:"UserProfitCardSelector-content",children:(0,o.tZ)(l.Z,{className:"UserProfitCardSelector-iframe",src:(0,g.NY)({contentId:C,contentType:S}),onMessage:function(e){var t=n().getEditorRef();if((null==e?void 0:e.type)==="ProfitCardSelector/submitProfitCardInfo"&&(null==e?void 0:e.payload)){var r=e.payload,o=r.type,a=r.id,c=r.url,s=r.preventClose,u=r.goods;if(s||f(!1),"inserLinkCard"===o&&t.props.handleCommand("insert-link-card:".concat(c)),"insertMCNLinkCard"===o){var l=!!u&&(u.productType.toString()===E.RedPacket||u.productType.toString()===E.Advertising);if(Array.from(n().getProps().root.querySelectorAll('[data-draft-type="mcn-link-card"]')).filter(function(e){return e.getAttribute("data-mcn-product-type")!==E.Advertising&&e.getAttribute("data-mcn-product-type")!==E.RedPacket}).length>=h&&!l&&0!==h){d.Z.alert(null,{title:"一篇内容最多可添加 ".concat(h," 个商品")});return}t.props.handleCommand("insert-mcn-link-card:".concat(a))}if("insertEduCard"===o){if((0,_.Z)(n().getEditorState()).filter(function(e){return e.getType()===i.o6.TYPE}).size>=i.o6.EDU_CARD_LIMIT){d.Z.alert(null,{title:"一篇内容最多可添加 ".concat(i.o6.EDU_CARD_LIMIT," 个教育卡片")});return}t.props.handleCommand("".concat(i.o6.WebInsertCommand).concat(a))}if("insertAdLinkCard"===o){if(a.startsWith("ZhiTask_")&&A().filter(function(e){return e.getData().id.startsWith("ZhiTask_")}).size>=5){d.Z.alert("一篇内容最多可添加 ".concat(5," 个「知+自选」卡片"));return}if(a.startsWith("fee_")&&A().filter(function(e){return e.getData().id.startsWith("fee_")}).size>=1){d.Z.alert("一篇内容最多可添加 ".concat(1," 个「付费回答」卡片"));return}t.props.handleCommand("insert-ad-link-card:".concat(a))}}}})})})})}),C=function(e){var t=e.shouldDisabled,n=e.shouldShow,r=void 0===n?function(){return!0}:n,i=e.getContentInfo,s={};return s.containerRef=(0,c.createRef)(),{initialize:function(e){Object.assign(s,e)},handleCommand:function(e){return"toggle-user-profit-modal"===e?(s.containerRef.current.setShowUserProfitCardSelector(!0),"handled"):"not-handled"},toolbar:{label:"用户收益",icon:a.Fo,shouldShow:r,shouldDisabled:function(){return null!=t&&!!t()||null},section:f.Z.CUSTOM_MAIN,toolType:p._W.ENTITY,onClick:function(){s.containerRef.current.setShowUserProfitCardSelector(!0),u.Z.trackEvent(null,{id:6097,action:"Click"})},priority:1},toolbarV2:{label:"收益",text:"收益",icon:a.Fo,shouldShow:r,shouldDisabled:function(){return!!t()||null},section:h.Z.BUSINESS_MEDIA,toolType:p._W.ENTITY,onClick:function(){s.containerRef.current.setShowUserProfitCardSelector(!0),u.Z.trackEvent(null,{id:6097,action:"Click"})},priority:1},components:(0,o.tZ)(y,{ref:s.containerRef,getStore:function(){return s},getContentInfo:void 0===i?function(){}:i})}}},60908:function(e,t){"use strict";t.Z=function(){var e=document.createEvent("HTMLEvents");e.initEvent("compositionend",!0,!1),document.querySelector(".public-DraftEditor-content").dispatchEvent(e)}},48933:function(e,t,n){"use strict";n.d(t,{Dt:function(){return N},KW:function(){return b},ct:function(){return R},hx:function(){return x},l0:function(){return O},vB:function(){return P}});var r=n(22107),o=n(94707),i=n(86325),a=n(15030),c=n(55164),s=n(49899),u=n(85626),l=n(85879),d=n(62082),p=n(54231),f=n(84871),h=n.n(f),_=n(12592),m=n.n(_),g=n(88329),T=n.n(g),E=n(87363),y=n(67516),C=n.n(y),S=n(80714),I=n(35102),A=n(65277),b={success:"success",fail:"fail",request:"request"},w="EDITABLE_STATSC",Z=function(e){var t=e.name,n=e.message;return"ResponseError"===t?"".concat(t,"_").concat(e.status||0):(t||"Unknown")+((0,I.hu)(n)?"_FetchError":"")};function x(){var e=C().get(w);e&&(e.forEach(function(e){p.ZP.increment(e)}),C().delete(w))}var k={get pageName(){return"UnknownPage"},reportRequest:T(),reportSuccess:T(),reportFail:T(),recordError:function(e){return e},wrapAutoRecord:function(e){return e}},R=(0,E.createContext)(k),N=function(){return(0,E.useContext)(R)},O=function(e){return h()(function(t){var n=N();return(0,l.tZ)(e,(0,c._)({reporter:n},t))},e)},P=O(function(e){(0,i._)(n,e);var t=(0,u._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"componentDidCatch",value:function(e,t){var n=this.props,r=n.reporter,o=n.name;throw r&&r.reportFail(o,e,{extra:{errorInfo:t}},!0),e}},{key:"render",value:function(){return this.props.children}}]),n}(E.Component));t.ZP=function(e,t){var n=function(t,n){p.ZP.increment("".concat(e,".").concat(t,".").concat(n,".count"))},r=function(t,n){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,a._)(n,Error)&&(null===(r=window.Raven)||void 0===r||r.captureException(n,(0,c._)({tags:{scope:"".concat(e,":").concat(t)}},o)))},o=function(e){return n(e,b.request)},i=function(e){return n(e,b.success)},u=function(n,o,i,c){if((0,a._)(o,Error)){var s=Z(o);if(p.ZP.increment([e,n,b.fail,s,"count"].join(".")),r(n,o,i),!c){var u,l,f={type:"EditorActionError-"+n,appName:"heifetz",spanName:e,currentUser:(null==t?void 0:t())||"Unknown",release:S.Z.release,isBadBrowserPlugin:null!==(l=(0,A.Yz)())&&void 0!==l?l:"Unknown",error:{name:s,message:o.message,payload:o.payload||"Unknown",stack:o.stack}};(0,d.zB)(f),null===(u=window.webReporter)||void 0===u||u.report("heifetz_editor_error",f)}}},l=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.intent,a=void 0===r||r,c=n.success,l=void 0===c||c;return function(){for(var n=arguments.length,r=Array(n),c=0;c<n;c++)r[c]=arguments[c];try{a&&o(e);var d=function(){return l?i(e):void 0},p=t.apply(void 0,(0,s._)(r));if(m()(p))return p.then(function(e){return d(),e},function(t){if((null==t?void 0:t.name)!=="AbortError")throw u(e,t),t});return d(),p}catch(t){throw u(e,t),t}}};return{get pageName(){return e},reportRequest:o,reportSuccess:i,reportFail:u,wrapAutoRecord:l,recordError:function(e,t){return l(e,t,{success:!1})},stash:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];if(n.length){var o=C().get(w)||[];o.push("".concat(e,".").concat(n.join("."),".count")),C().set(w,o)}}}}},20826:function(e,t,n){"use strict";n.d(t,{eU:function(){return T},m5:function(){return E}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(57477),l=n(94009),d=n(85626),p=n(85879),f=n(84871),h=n.n(f),_=n(87363),m=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"commonMessage",{}),e}return(0,i._)(n,[{key:"setCommonMessage",value:function(e){this.commonMessage=e}},{key:"fire",value:function(e){var t;(null===(t=this.observers)||void 0===t?void 0:t.length)&&this.next((0,u._)((0,s._)({},e,this.commonMessage),{_t:Date.now()}))}}]),n}(n(87608).xQ),g=(0,_.createContext)(new m),T=function(e){return h()(function(t){var n=(0,l._)((0,_.useState)(function(){return new m}),1)[0];return(0,p.tZ)(g.Provider,{value:n,children:(0,p.tZ)(e,(0,u._)((0,s._)({},t),{editorEventPublisher:n}))})},e)},E=function(){return(0,_.useContext)(g)}},89137:function(e,t,n){"use strict";var r=n(57973),o=["src","data-caption","data-size","data-rawwidth","data-rawheight","data-watermark","data-original-src","data-watermark-src","data-private-watermark-src"];t.Z=function(e){var t=document.querySelector(e||'.EditorSnapshotWrapper .public-DraftEditor-content>div[data-contents="true"]');if(!t)return{html:"",text:""};var n=(0,r.Z)(t.innerHTML),i=n.body,a=Array.from(i.querySelectorAll(".Editable-video")),c=!0,s=!1,u=void 0;try{for(var l,d=a[Symbol.iterator]();!(c=(l=d.next()).done);c=!0){var p,f=l.value,h=n.createElement("a");h.classList.add("video-link"),h.setAttribute("href",f.dataset.url),h.setAttribute("data-src",f.dataset.src),h.setAttribute("data-name",f.dataset.name),h.setAttribute("data-poster",f.dataset.poster),h.setAttribute("data-video-id",f.dataset.videoId),h.setAttribute("data-lens-id",f.dataset.lensId),h.setAttribute("data-video-playable",f.dataset.videoPlayable),f.dataset.lensCensorFailItems&&h.setAttribute("data-lens-censor-fail-items",f.dataset.lensCensorFailItems),null===(p=f.parentNode)||void 0===p||p.replaceChild(h,f)}}catch(e){s=!0,u=e}finally{try{c||null==d.return||d.return()}finally{if(s)throw u}}var _=Array.from(i.querySelectorAll(".ztext-math")),m=!0,g=!1,T=void 0;try{for(var E,y=_[Symbol.iterator]();!(m=(E=y.next()).done);m=!0){var C,S=E.value,I=n.createElement("img"),A=S.dataset,b=A.tex,w=A.eeimg;b&&(I.setAttribute("alt",b),I.setAttribute("eeimg","2"===w?"2":"1"),I.setAttribute("loading","lazy"),I.setAttribute("src","https://www.zhihu.com/equation?tex=".concat(encodeURIComponent(b))),null===(C=S.parentNode)||void 0===C||C.replaceChild(I,S))}}catch(e){g=!0,T=e}finally{try{m||null==y.return||y.return()}finally{if(g)throw T}}var Z=Array.from(i.querySelectorAll('sup[data-draft-type="reference"]')),x=!0,k=!1,R=void 0;try{for(var N,O=Z[Symbol.iterator]();!(x=(N=O.next()).done);x=!0){var P=N.value,D=P.dataset.numero;P.textContent="[".concat(D,"]")}}catch(e){k=!0,R=e}finally{try{x||null==O.return||O.return()}finally{if(k)throw R}}var L=Array.from(i.querySelectorAll('[data-draft-type="link-card"]')),M=!0,B=!1,U=void 0;try{for(var G,F=L[Symbol.iterator]();!(M=(G=F.next()).done);M=!0){var H,z,q=G.value;q.textContent=q.dataset.text||q.querySelector(".LinkCard-title").textContent||"",null===(H=q.parentNode)||void 0===H||null===(z=H.parentNode)||void 0===z||z.replaceChild(q,q.parentNode)}}catch(e){B=!0,U=e}finally{try{M||null==F.return||F.return()}finally{if(B)throw U}}var V=Array.from(i.querySelectorAll(".Image-captionContainer")),W=!0,X=!1,K=void 0;try{for(var j,Y=V[Symbol.iterator]();!(W=(j=Y.next()).done);W=!0)!function(){var e=j.value,t=e.querySelector(".Image");if(t){if("IMG"!==t.tagName.toUpperCase()){var r,i,a=n.createElement("img");a.setAttribute("loading","lazy"),o.forEach(function(e){a.setAttribute(e,t.getAttribute(e))}),t=a}var c=e.textContent;t.setAttribute("data-caption",c),null===(r=e.parentNode)||void 0===r||null===(i=r.parentNode)||void 0===i||i.replaceChild(t,e.parentNode)}}()}catch(e){X=!0,K=e}finally{try{W||null==Y.return||Y.return()}finally{if(X)throw K}}var Q=Array.from(i.querySelectorAll(".TableToolbar-container")),J=!0,$=!1,ee=void 0;try{for(var et,en=Q[Symbol.iterator]();!(J=(et=en.next()).done);J=!0){var er=et.value,eo=er.querySelector("table.Table"),ei=Array.from(eo.querySelectorAll("th,td")),ea=!0,ec=!1,es=void 0;try{for(var eu,el,ed,ep=ei[Symbol.iterator]();!(ea=(ed=ep.next()).done);ea=!0){var ef=ed.value;ef.textContent=ef.textContent}}catch(e){ec=!0,es=e}finally{try{ea||null==ep.return||ep.return()}finally{if(ec)throw es}}null===(eu=er.parentNode)||void 0===eu||null===(el=eu.parentNode)||void 0===el||el.replaceChild(eo,er.parentNode)}}catch(e){$=!0,ee=e}finally{try{J||null==en.return||en.return()}finally{if($)throw ee}}var eh=i.innerHTML,e_=Array.from(i.querySelectorAll('[contenteditable="false"]')),em=!0,ev=!1,eg=void 0;try{for(var eT,eE=e_[Symbol.iterator]();!(em=(eT=eE.next()).done);em=!0)eT.value.remove()}catch(e){ev=!0,eg=e}finally{try{em||null==eE.return||eE.return()}finally{if(ev)throw eg}}return{html:eh,text:i.textContent.replace(/\n/g,"")}}},27278:function(e,t,n){"use strict";n.d(t,{W:function(){return A}});var r=n(9338),o=n(30971),i=n(85879),a=n(87641),c=n(6735),s=n(19319),u=n(38455),l=n(25452),d=n(93547),p=n(22107),f=n(94707),h=n(87320),_=n(55164),m=n(57477),g=n(47654),T=function(e,t){var n=new Date(e);return n.setDate(n.getDate()+t),n},E=function(){function e(t,n){(0,p._)(this,e),(0,h._)(this,"$db",void 0),(0,h._)(this,"$clearing",void 0),(0,h._)(this,"name",void 0),(0,h._)(this,"options",void 0),this.name=t,this.options=(0,_._)({dbName:"LocalDraftQueue",storeName:"data",daysToExpire:30},n);var r=this.options,o=r.dbName,i=r.storeName,a=r.keyPath;this.$db=(0,g.X3)(o,1,{upgrade:function(e){var t=e.createObjectStore(i,{keyPath:a||["__created","__name"]});t.createIndex("__name","__name"),t.createIndex("__expires","__expires")}}),this.$clearing=this.clearExpired()}return(0,f._)(e,[{key:"push",value:function(e){var t=this;return(0,r._)(function(){var n,r;return(0,o.__generator)(this,function(o){switch(o.label){case 0:return[4,t.$db];case 1:return n=o.sent(),r=new Date,[4,n.put(t.options.storeName,(0,m._)((0,_._)({},e),{__name:t.name,__created:r,__expires:T(r,t.options.daysToExpire)}))];case 2:return o.sent(),[2]}})})()}},{key:"take",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=this;return(0,r._)(function(){var n;return(0,o.__generator)(this,function(r){switch(r.label){case 0:return[4,t.$clearing];case 1:return r.sent(),n=[],[4,t.eachIndexCursor("__name","readonly",IDBKeyRange.only(t.name),function(e){n.push(e.value)},{count:e})];case 2:return r.sent(),[2,n]}})})()}},{key:"takeLast",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=this;return(0,r._)(function(){var n;return(0,o.__generator)(this,function(r){switch(r.label){case 0:return[4,t.$clearing];case 1:return r.sent(),n=[],[4,t.eachIndexCursor("__name","readonly",IDBKeyRange.only(t.name),function(e){n.push(e.value)},{count:e,dir:"prev"})];case 2:return r.sent(),[2,n]}})})()}},{key:"clear",value:function(){var e=this;return(0,r._)(function(){return(0,o.__generator)(this,function(t){switch(t.label){case 0:return[4,e.eachIndexCursor("__name","readwrite",IDBKeyRange.only(e.name),function(e){return e.delete()})];case 1:return t.sent(),[2]}})})()}},{key:"clearExpired",value:function(){var e=this;return(0,r._)(function(){return(0,o.__generator)(this,function(t){switch(t.label){case 0:return[4,e.eachIndexCursor("__expires","readwrite",IDBKeyRange.upperBound(new Date),function(e){return e.delete()})];case 1:return t.sent(),[2]}})})()}},{key:"eachIndexCursor",value:function(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},c=a.count,s=void 0===c?1/0:c,u=a.dir,l=this;return(0,r._)(function(){var r,a;return(0,o.__generator)(this,function(o){switch(o.label){case 0:return[4,l.$db];case 1:return[4,(r=o.sent().transaction(l.options.storeName,t)).objectStore(l.options.storeName).index(e).openCursor(n,u)];case 2:a=o.sent(),o.label=3;case 3:if(!(a&&s>0))return[3,6];return[4,null==i?void 0:i(a)];case 4:return o.sent(),[4,a.continue()];case 5:return a=o.sent(),s--,[3,3];case 6:return[4,r.done];case 7:return o.sent(),[2]}})})()}}]),e}(),y=n(89137),C=n(20303),S=function(e){(0,u.Z)(function(t){return(0,i.tZ)(s.Z,{css:{top:"126px"},delay:5e3,notification:{text:(0,i.tZ)(a.xv,{css:{display:"flex",alignItems:"center"},children:"已加载最新云端草稿，检测到内容差异，可在草稿备份中查看本地备份"}),key:"notificationInteractTexts",timeStamp:new Date().getDate()},actions:(0,i.tZ)(l.ZP,{preset:l.EE.Link,color:l.rp.Blue,onClick:function(){var n;t(),null===(n=e())||void 0===n||n.handleKeyCommand("toggle-draft-history-modal:local")},children:"查看"})})})},I=function(e){var t=null,n=function(){var n=e();return n?t?(t.name=n,t):t=new E(n,{keyPath:["traceId"],dbName:"LocalDraftQueue-withTraceId",daysToExpire:90}):null};return n(),n},A=function(e,t,n,i){var a,s=I(t),u=function(e){var r=t(),o=n();if(r&&o&&e){var i=s();i&&i.push({traceId:o,content:e,textCount:(0,d.Vt)(e).length})}};return e.pipe((0,c.h)(function(e){return!!["loadDraftSuccess","saveDraft","pre-publish"].includes(null==e?void 0:e.type)&&null!=e&&!!e.context.content})).subscribe((a=(0,r._)(function(e){var t;return(0,o.__generator)(this,function(n){return"loadDraftSuccess"===e.type?(setTimeout(function(){var t;null===(t=s())||void 0===t||t.takeLast(1).then(function(t){if(null==t?void 0:t.length){var n=(0,d.Vt)(e.context.content||"").length;t[0].textCount-n>50&&S(i)}})},300),[2]):((t=i())&&(0,C.U)(t,(0,y.Z)().html).then(function(e){u(e)}),[2])})}),function(e){return a.apply(this,arguments)})),{getLocalDraftQueue:s}}},20303:function(e,t,n){"use strict";n.d(t,{U:function(){return h}});var r,o,i=n(9338),a=n(30971),c=n(12627),s=n(66263),u=n(93547),l=n(65277),d=n(29508),p=n(89137),f=(0,d.H)("draft"),h=(r=(0,i._)(function(e,t){var n,r,o,i,u,l,d,p;return(0,a.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),n=s.o8?e.getCreateContentAsync():e.getCreateContent(),r=e.EditableCore.html2draftMiddlewares,o=e.EditableCore.draft2htmlMiddlwares,i=performance.now(),[4,n(t,r)];case 1:return u=a.sent(),f("fixContentWithSnapshot/createContent",performance.now()-i),l=performance.now(),[4,(0,c.dv)({contentState:u,outputBlockType:"p",middlewares:o})];case 2:return d=a.sent(),f("fixContentWithSnapshot/draft2htmlAsync",performance.now()-l),[2,d];case 3:return p=a.sent(),[2,"".concat(p.name," - ").concat(p.message)];case 4:return[2]}})}),function(e,t){return r.apply(this,arguments)}),_=(o=(0,i._)(function(e,t,n,r){var o,i,c,s,d,f,_,m,g,T,E,y;return(0,a.__generator)(this,function(a){switch(a.label){case 0:if(o=(0,u.Vt)(t),c=(i=(0,p.Z)(n&&"".concat(n," .public-DraftEditor-content"))).html,s=i.text,d=o.length,!((_=(f=s.length)-d)>50))return[3,2];return m=Error("partial draft content lost - diff: ".concat(_)),[4,h(r,c)];case 1:g=a.sent(),y=f-(E=(T=(0,u.Vt)(g)).length),m.payload={diff:_,fixedDiff:y,textLength:d,snapshotTextLength:f,fixedTextLength:E,browserContentScripts:(0,l.l)(),text:o,snapshotText:s,fixedText:T,fixedHtml:g,html:t,snapshotHtml:c},e.reportFail("DraftPartialLost",m),a.label=2;case 2:return[2]}})}),function(e,t,n,r){return o.apply(this,arguments)});t.Z=_},72004:function(e,t,n){"use strict";n.d(t,{$:function(){return A}});var r=n(55164),o=n(57477),i=n(62082),a=n(94508),c=n(69436),s=n(25490),u=n(94404),l=n(87608),d=n(6735),p=n(93132),f=n(68521),h=n(96688),_=n(27663),m=n(90824),g=n(89137),T=n(93547),E=n(65277),y=n(64512),C=function(e){var t=(0,T.Vt)(e),n=(0,g.Z)().text;return{contentLength:t.length,snapshotContentLength:n.length,diffLength:n.length-t.length}},S=i.zB,I=function(e,t){},A=function(e){var t=(0,a.x)([e.pipe((0,d.h)(function(e){return["unmount","post-publish"].includes(e.type)})),(0,c.F)(3e5),(0,s.R)(window,"visibilitychange").pipe((0,d.h)(function(){return"hidden"===document.visibilityState}))],u.z).pipe((0,p.J)()),n=new l.xQ;n.pipe((0,f.b)(function(e){I("message",e)}),(0,h.f)(t)).subscribe(function(e){if(0!==e.length){I("report",e);var t,n={type:"pcEditorPublishEvent",appName:"heifetz",spanName:"editor",payload:e,error:{name:"Not a Error",message:"Must have error field to report"}};null==window||null===(t=window.webReporter)||void 0===t||t.report("pc_editor_publish_event",(0,y.Ss)(n)),S(n)}});var i=null;e.pipe((0,d.h)(function(e){return["mount","loadDraftSuccess","post-upload","pre-publish","post-publish","unmount"].includes(e.type)}),(0,_.U)(function(e){if("mount"===e.type||"loadDraftSuccess"===e.type||"pre-publish"===e.type){var t=(0,o._)((0,r._)({},e),{context:(0,o._)((0,r._)({},C(e.context.content||""),e.context),{content:void 0})});return"pre-publish"===e.type&&(t.context.browserContentScripts=(0,E.l)(),i=(0,r._)({},t.context,e.context)),t}if("post-publish"===e.type){if(i){var n=null===(a=e.context)||void 0===a?void 0:null===(c=a.data)||void 0===c?void 0:c.content;if(n){var a,c,s,u=(0,T.Vt)(n),l=Math.max(i.diffLength,i.snapshotContentLength-u.length);return(0,o._)((0,r._)({},e),{context:(0,r._)((0,o._)((0,r._)({},null===(s=e.context)||void 0===s?void 0:s.data),{content:void 0,preContentLength:i.contentLength,postContentLength:u.length,snapshotContentLength:i.snapshotContentLength}),l>50?{postContent:n,snapshotContent:i.content,isBigDiff:!0}:{})})}i=null}return(0,o._)((0,r._)({},e),{context:(0,r._)({},e.context)})}return e})).subscribe(n),e.pipe((0,d.h)(function(e){return"saveDraft"===e.type}),(0,m.e)(6e4),(0,_.U)(function(e){return(0,o._)((0,r._)({},e),{context:C(e.context.content)})})).subscribe(n)}},68455:function(e,t,n){"use strict";n.d(t,{GM:function(){return m},Uh:function(){return p},Wb:function(){return d},Wf:function(){return h},yN:function(){return g},yz:function(){return _}});var r,o=n(49899),i=n(41807),a=n.n(i),c=n(67516),s=n.n(c),u="EMOTICON_EMOJI",l=s().get(u);function d(){return!!r}function p(e){l=e,s().set(u,e)}function f(e){var t=function(){if(r)return r;var e=_();return e?(r={},e.forEach(function(e){r[e.placeholder]=e.staticImageUrl}),r):{}}()[e];return t?'<img data-zhihu-emoticon="'.concat(e,'" src="').concat(t,'" alt="').concat(e,'" />'):e}function h(e){return e?e.replace(/\[.{1,8}?\]/g,f):""}function _(){return l&&(l=s().get(u)),l}function m(e,t){return t.map(function(t){var n=t.id,r=t.type,i=e[n],c="emoji"===r?45:8;return i?a()(i.stickers,c).map(function(e,t){return{groupId:n,id:"".concat(n,"-").concat(t),data:e,type:r}}):a()((0,o._)(Array(t.stickerCount)),c).map(function(e,t){return{groupId:n,id:"".concat(n,"-").concat(t),data:[],type:r}})}).flat()}function g(e,t){return e?t:t.filter(function(e){return"vip"!==e.type})}},19235:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(55164),o=n(94009),i=n(85879),a=n(84871),c=n.n(a),s=n(74135),u=n(68455),l=n(49899),d=n(82435);function p(e){return e.reduce(function(e,t){var n;return(0,l._)(e).concat((0,l._)(null!==(n=t.stickers)&&void 0!==n?n:[]))},[])}var f=n(87363),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.alwaysShow,n=void 0!==t&&t;return function(e){return c()(function(t){var a=(0,o._)((0,f.useState)(!1),2),c=a[0],l=a[1];return(0,f.useEffect)(function(){if((0,u.Wb)()){l(!0);return}(window.zh_emoticon?Promise.resolve(p(window.zh_emoticon)):(0,d.OK)().then(function(){return window.zh_emoticon?p(window.zh_emoticon):[]})).then(function(e){(0,u.Uh)((0,s.camelizeKeys)(e)),l(!0)}).catch(function(){l(!0)})},[]),(c||n)&&(0,i.tZ)(e,(0,r._)({},t))},e)}}},55:function(e,t,n){"use strict";n.d(t,{Z:function(){return G}});var r=n(9338),o=n(94009),i=n(30971),a=n(85879),c=n(95951),s=n(65733),u=n(68159),l=n(87363),d=n.n(l),p=n(80714),f=n(81956),h=n(29229),_=n(63638),m={width:null},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"px";if(m.width)return t?"".concat(m.width/1920*e).concat(t," "):m.width/1920*e},T=function(e){var t=e.src;return(0,a.tZ)("div",{css:{margin:"auto 0",width:g(240),height:g(240),borderRadius:g(240),position:"absolute",left:"50%",transform:"translate(-50%,0)",backgroundColor:"#eee",fontSize:0},children:t&&(0,a.tZ)("img",{width:"100%",css:{borderRadius:g(240)},src:t,alt:"头像"})})},E=n(55164),y=n(71728),C=n(87641),S=n(4667),I=n.n(S)()(function(){return new Promise(function(e){return requestAnimationFrame(function(){return setTimeout(e)})})}),A=function(){var e=(0,o._)((0,l.useState)(!1),2),t=e[0],n=e[1];return(0,l.useEffect)(function(){I().then(function(){return n(!0)})},[]),t},b=(0,l.forwardRef)(function(e,t){var r=e.renderer,o=void 0===r?"svg":r,i=e.loop,c=void 0===i||i,s=e.autoplay,u=void 0===s||s,d=e.data,p=e.src,f=(0,y._)(e,["renderer","loop","autoplay","data","src"]),_=(0,l.useRef)(),m=(0,h._)(function(){return n.e(6018).then(n.t.bind(n,83476,23))},A());return(0,l.useImperativeHandle)(t,function(){return{get lottie(){return m}}}),(0,l.useEffect)(function(){m&&m.loadAnimation({container:_.current,renderer:o,loop:c,autoplay:u,animationData:d,path:p})},[m]),(0,a.tZ)(C.xu,(0,E._)({ref:_},f))}),w=function(e){var t=e.showKanShan,n=e.src;return(0,a.tZ)("div",{css:{position:"absolute",top:g(-120),left:g(100),backgroundColor:"#000",width:g(300),height:g(250),overflow:"hidden"},children:n&&(0,a.tZ)(b,{loop:!1,autoPlay:!0,src:n,css:{position:"absolute",top:g(-80),left:g(-250),opacity:t?1:0,width:g(600),height:g(600)}})})},Z=n(66980),x=Object.assign,k=function(e){return d().createElement(Z.Z,x({width:"318",height:"28",fill:"none",viewBox:"0 0 318 28"},e),d().createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M290.976 20.112a.862.862 0 0 0 .61.253l9.471-.043a26.203 26.203 0 0 1-9.802 3.972 1.172 1.172 0 0 0-.536.62c-.098.264-.097.555.004.82a1.337 1.337 0 0 0 1.612.417 25.695 25.695 0 0 0 10.435-5.268v5.599a1.077 1.077 0 0 0 1.079 1.079 1.079 1.079 0 0 0 1.08-1.08v-5.757a24.248 24.248 0 0 0 10.434 5.268 1.21 1.21 0 0 0 1.512-.432c.144-.72-.044-1.223-.547-1.439a27.624 27.624 0 0 1-9.687-3.756h9.471a.976.976 0 0 0 .979-.864c0-.576-.331-.864-.979-.864h-11.183v-1.611a1.078 1.078 0 0 0-1.08-1.08 1.079 1.079 0 0 0-1.079 1.08v1.611h-11.184a.863.863 0 0 0-.61 1.475Zm.144-10.414a.891.891 0 0 0 .567.217l5.901.044c-.193.238-.384.436-.574.634-.234.244-.468.487-.707.805-.432.576-.331.993.317 1.281l5.268 1.295a54.534 54.534 0 0 1-9.572 1.44.78.78 0 0 0-.701.71c-.01.121.008.242.054.355a1.062 1.062 0 0 0 1.18.762 54.98 54.98 0 0 0 12.104-2.475c4.011 1.142 6.847 1.967 8.507 2.475a1.222 1.222 0 0 0 1.439-.546.936.936 0 0 0 .08-.576.916.916 0 0 0-.613-.706c-1.007-.215-2.691-.618-5.066-1.194-.849-.216-1.497-.389-1.929-.533a10.786 10.786 0 0 0 3.656-3.77h4.851c.561-.072.964-.173.964-.749 0-.576-.331-.863-.964-.863h-14.293c.192-.27.409-.52.648-.749.288-.36.504-.619.648-.763a.74.74 0 0 0 .117-.712.741.741 0 0 0-.549-.468 1.44 1.44 0 0 0-1.612.432c-.278.466-.606.9-.979 1.295-.36.432-.604.749-.748.965h-7.427a.937.937 0 0 0-.863.863.888.888 0 0 0 .296.53Zm22.257-2.575c.058.504.418.864 1.065.864.705 0 1.037-.288 1.022-.749V4.763a1.194 1.194 0 0 0-1.194-1.18h-8.924a12 12 0 0 0-.763-2.375c-.187-.504-.647-.648-1.439-.648a1.05 1.05 0 0 0-.864 1.18 2.564 2.564 0 0 0 .216.648c.174.387.318.786.432 1.195h-9.514c-.863 0-1.295.388-1.295 1.18v2.36c.067.5.427.787 1.079.864a.963.963 0 0 0 .965-.864V5.684a.46.46 0 0 1 .532-.533h18.25c.288 0 .432.173.432.533v1.44Zm-11.327 5.268-2.878-.748h.057c-.36-.072-.59-.173-.245-.533a20.893 20.893 0 0 0 1.065-1.195h8.463a8.272 8.272 0 0 1-3.871 3.124l-2.591-.648ZM136.762 5.913c.178.16.41.247.649.246l12.061-.043a.92.92 0 0 0 .849-.864.965.965 0 0 0-.849-.964h-4.635v-.23a.558.558 0 0 0 .059-.11 1.08 1.08 0 0 0 .041-.123.797.797 0 0 0 .016-.084 9.725 9.725 0 0 1-.432-1.828 3.386 3.386 0 0 0-.216-.648 1.124 1.124 0 0 0-1.295-.647.88.88 0 0 0-.759.711.879.879 0 0 0 .01.368c.023.07.049.154.079.252.049.164.107.368.176.612l.062.216c.077.487.187.968.331 1.439v.115h-5.498a1.004 1.004 0 0 0-.964.964.96.96 0 0 0 .315.618Zm.132 17.768c.084.095.187.17.301.224h-.014a.944.944 0 0 0 1.079-.125.947.947 0 0 0 .23-.306 35.592 35.592 0 0 0 2.145-4.635c.144-.432-.029-.82-.533-1.18-.647-.072-1.036.144-1.18.648-.144.33-.36.791-.648 1.439a62.54 62.54 0 0 1-1.511 2.878.947.947 0 0 0-.097.57.931.931 0 0 0 .228.488Zm1.725-7.975c.221.224.521.352.836.355l3.137-.043v7.096c0 1.08-.504 1.511-1.439 1.511h-1.439c-.576 0-.864.317-.864.964a1.183 1.183 0 0 0 1.108 1.008 7.872 7.872 0 0 0 1.713-.101c2.015 0 2.951-1.036 2.807-3.123V16.06h3.008a1.195 1.195 0 0 0 1.18-1.194V9.815a1.186 1.186 0 0 0-.729-1.09 1.177 1.177 0 0 0-.451-.09h-8.031a1.238 1.238 0 0 0-1.181 1.28v4.952c0 .314.124.616.345.84Zm1.598-1.933v-2.879h-.014a.482.482 0 0 1 .133-.414.472.472 0 0 1 .414-.133h5.484a.488.488 0 0 1 .28.048l.028.015a.498.498 0 0 1 .241.39.48.48 0 0 1-.002.095v2.878a.49.49 0 0 1-.304.5l-.015.006-.012.004a.49.49 0 0 1-.216.022h-5.484a.473.473 0 0 1-.511-.318.474.474 0 0 1-.022-.214Zm8.234 7.959a.877.877 0 0 0 .258-.086h-.014a1.036 1.036 0 0 0 .446-1.137c-.144-.331-.389-.792-.748-1.44l-.864-1.295a1.021 1.021 0 0 0-1.295-.317.808.808 0 0 0-.44.45.813.813 0 0 0 .008.63c.288.49.863 1.396 1.727 2.677a.856.856 0 0 0 .735.527.831.831 0 0 0 .187-.01Zm1.371-11.808a.98.98 0 0 0 .614.323l2.274.014c-.076 6.237-1.727 11.15-4.951 14.738a1.207 1.207 0 0 0 .202 1.44 1.193 1.193 0 0 0 1.439-.216c3.234-3.877 4.994-9.221 5.282-16.034h.864a.858.858 0 0 0-.064.146l-.006.02-.016.054a.943.943 0 0 0-.029.212v12.694c0 1.986.906 2.879 2.691 2.879h.979c1.857.1 2.907-.864 3.109-2.879a6.564 6.564 0 0 1 .115-.964c.121-.859.193-1.724.216-2.59a1.034 1.034 0 0 0-.749-1.181.675.675 0 0 0-.863.648c-.015.433-.053.866-.115 1.295a20.009 20.009 0 0 1-.216 2.044c-.087 1.209-.59 1.713-1.44 1.713h-.547c-.791.13-1.18-.375-1.18-1.44V10.463l-.1-.216h4.087a.978.978 0 0 0 0-1.943h-6.678c0-.72.029-1.857.115-3.44V1.625a1.083 1.083 0 0 0-1.08-.964 1.022 1.022 0 0 0-.978.964c0 1.285-.028 2.51-.054 3.674-.024 1.053-.047 2.055-.047 3.005h-2.26a.98.98 0 0 0-.614 1.62Zm7.293-5.391c1.065.935 1.755 1.554 2.043 1.842h-.014c.576.36 1.022.417 1.454.029.431-.389.46-.864.1-1.44a16.122 16.122 0 0 1-1.281-1.065c-.647-.503-1.079-.834-1.295-.978-.619-.36-1.094-.36-1.439 0a.748.748 0 0 0-.246.237.739.739 0 0 0 .131.943 3.539 3.539 0 0 0 .547.432ZM1.629 5.295c0 .648.288.965.85.965l6.462.043a38.14 38.14 0 0 1-7.643 8.938 1.353 1.353 0 0 0-.216 1.612.95.95 0 0 0 .66.482l.018.003a.948.948 0 0 0 .834-.27 33.572 33.572 0 0 0 3.555-3.44v12.48a1.151 1.151 0 0 0 1.18 1.079 1.108 1.108 0 0 0 1.08-1.08V20.94h13.226v1.828c.072 1.296-.561 1.9-1.929 1.828h-3.022c-.49 0-.749.288-.749.864.077.652.51 1.012 1.296 1.08h3.152c2.447 0 3.584-1.109 3.454-3.34V10.722a1.295 1.295 0 0 0-1.295-1.296H9.588a118.968 118.968 0 0 0 1.943-3.123h14.623a.965.965 0 0 0 0-1.929H12.597c.445-.673.807-1.398 1.079-2.159a1.137 1.137 0 0 0-.648-1.439 1.252 1.252 0 0 0-1.612.964l-1.295 2.591H2.478c-.561 0-.849.317-.849.964Zm6.78 8.924v-2.476a.475.475 0 0 1 .532-.532h12.162a.474.474 0 0 1 .331.08l.01.006.007.006.01.008a.496.496 0 0 1 .039.035.475.475 0 0 1 .135.397v2.476H8.408Zm0 4.85v-3.008h13.226v3.008H8.408Zm32.966 7.851c.201.201.471.317.755.324a1.109 1.109 0 0 0 1.08-1.08V7.34a.951.951 0 0 0-1.08-1.08 1.109 1.109 0 0 0-1.079 1.08v18.826c.007.284.123.554.324.755Zm4.992-20.744c.148-.047.284-.127.398-.233h-.029a.993.993 0 0 0 .058-1.511 37.095 37.095 0 0 0-2.792-2.879 1.166 1.166 0 0 0-1.613-.216.993.993 0 0 0-.114 1.44c.523.434 1.004.916 1.439 1.439.508.476.989.98 1.439 1.511a1.05 1.05 0 0 0 1.214.45Zm1.83 13.43.075.005.025.001a1.174 1.174 0 0 0 .18-.01l8.334.072a1.324 1.324 0 0 0 1.44-1.281v-8.046a1.224 1.224 0 0 0-1.44-1.44h-8.333c-.85 0-1.281.505-1.281 1.44v7.974a1.135 1.135 0 0 0 1 1.284Zm7.73 6.583c.236.197.533.306.84.307h.044c1.828 0 3.08-.043 3.757-.086 2.648-.072 3.914-1.396 3.77-3.973V3.928a1.44 1.44 0 0 0-1.439-1.44H49.341a1.022 1.022 0 0 0-.964.98 1.05 1.05 0 0 0 .964 1.065h12.162c.432 0 .648.187.648.546v16.898c.072 1.64-.72 2.36-2.36 2.36h-3.455c-.72.067-1.007.427-.863 1.08.056.302.217.575.453.772Zm.193-9.063c0 .36-.216.547-.647.547h-5.758c-.431 0-.647-.187-.647-.547v-5.584a.763.763 0 0 1 .648-.648h5.757a.763.763 0 0 1 .647.648v5.584Zm22.755-1.713a.892.892 0 0 1-.748-.863c.072-.576.317-.864.748-.864h10.766c.504 0 .749.288.749.864a.892.892 0 0 1-.749.863h-3.555v2.879h3.224c.504 0 .763.288.763.85 0 .56-.26.69-.763.762h-3.224v3.656a11.3 11.3 0 0 0 4.088.647c4.02.144 8.338.144 12.953 0 .777 0 1.18.317 1.18.965a.992.992 0 0 1-.217.586 1.022 1.022 0 0 1-.963.378h-5.383c-3.526.072-6.102.072-7.757 0-4.443-.144-7.322-1.468-8.636-3.972a16.162 16.162 0 0 1-1.44 3.972.874.874 0 0 1-.936.472.879.879 0 0 1-.344-.14.979.979 0 0 1-.331-1.296 15.544 15.544 0 0 0 1.727-7.643.936.936 0 0 1 .863-.863c.648 0 .965.287.965.863a9.196 9.196 0 0 1-.115 1.08c.017.362-.017.726-.101 1.08a9.267 9.267 0 0 0 2.519 3.022v-7.312l-5.283.014Zm2.26-3.871c-.864 0-1.295-.403-1.295-1.195V3.251c0-.791.431-1.194 1.295-1.194h6.678a1.236 1.236 0 0 1 1.281 1.194v7.096c0 .792-.417 1.195-1.28 1.195h-6.679Zm.533-7.326v1.828h5.498V4.216c0-.36-.144-.533-.432-.533h-4.419c-.432 0-.647.173-.647.533Zm5.066 5.757c.288 0 .432-.187.432-.547V7.497h-5.498v1.929c0 .36.215.547.647.547h4.419Zm5.052 13.241a.99.99 0 0 1-1.428-.335.994.994 0 0 1 .463-1.392 7.34 7.34 0 0 0 5.268-8.175v-2.59c0-.576.331-.864.979-.864.648 0 .921.36.864.863v2.591a19.18 19.18 0 0 1-.332 3.757l2.879 2.26c1.079.863 1.871 1.438 2.375 1.827a.89.89 0 0 1 .348 1.105.9.9 0 0 1-.247.334c-.36.432-.821.461-1.44.101-.356-.207-.693-.543-1.121-.969-.315-.314-.68-.677-1.138-1.075-1.08-.935-1.871-1.568-2.375-1.928a10.306 10.306 0 0 1-5.095 4.548v-.058Zm-.502-19.369a.763.763 0 0 1-.678-.867.935.935 0 0 1 .863-.864h11.629a.878.878 0 0 1 0 1.728h-5.282l-.431 3.108h4.044a1.167 1.167 0 0 1 .251.02l.024.005a1.156 1.156 0 0 1 .861.779c.05.159.065.327.044.492v8.635c0 .576-.317.864-.964.864a.765.765 0 0 1-.864-.864V9.138a.46.46 0 0 0-.532-.532h-6.146c-.432 0-.633.172-.633.532v7.815a.863.863 0 1 1-1.727 0V8.246c0-.792.431-1.195 1.295-1.195h2.26l.532-3.109-4.36-.1a.762.762 0 0 1-.186.003Zm85.487 8.459a1.226 1.226 0 0 1-.678.022 1.24 1.24 0 0 1-.772-.583c-.287-.56-.1-1.108.547-1.612a29.074 29.074 0 0 0 10.651-8.074 2.69 2.69 0 0 1 1.612-.964 2.117 2.117 0 0 1 1.612.964 24.714 24.714 0 0 0 10.55 7.758 1.048 1.048 0 0 1 .46.218 1.034 1.034 0 0 1 .188 1.394 1.339 1.339 0 0 1-1.728.431A30.56 30.56 0 0 1 188.462 3.9c-.216-.216-.403-.216-.547 0a34.166 34.166 0 0 1-10.866 8.276 1.264 1.264 0 0 1-.278.129Zm-.039 5.628a1.078 1.078 0 0 1-.979-1.08 1.021 1.021 0 0 1 .979-.963h22.697a1.064 1.064 0 0 1 1.08.964 1.11 1.11 0 0 1-1.08 1.08h-12.162a71.474 71.474 0 0 1-5.397 5.612.292.292 0 0 0-.086.202s0 .1.216.1c3.655-.143 7.527-.32 11.615-.532a30.668 30.668 0 0 0-2.26-2.26 1.065 1.065 0 0 1 0-1.439 1.268 1.268 0 0 1 1.626.1l1.713 1.728c1.25 1.198 2.199 2.17 2.884 2.872.261.268.484.496.671.683a.957.957 0 0 1 .206.344.994.994 0 0 1-.307 1.096 1.122 1.122 0 0 1-1.626-.101 6.447 6.447 0 0 1-.532-.648l-.648-.648c-.648 0-1.684 0-3.123.216-5.095.216-8.996.389-11.731.547-.935 0-1.54-.187-1.827-.763a1.811 1.811 0 0 1 .647-1.928 34.96 34.96 0 0 0 5.052-5.283l-7.628.101Zm5.052-5.599a1.051 1.051 0 0 1-.965-1.065 1.022 1.022 0 0 1 .965-.978h12.594a1.024 1.024 0 0 1 .964.978 1.054 1.054 0 0 1-.964 1.065h-12.594Zm32.499-7.038c0 .648.288.965.849.965l6.549.043a37.813 37.813 0 0 1-7.643 8.938 1.353 1.353 0 0 0-.216 1.612.955.955 0 0 0 1.08.415.95.95 0 0 0 .36-.2 33.584 33.584 0 0 0 3.555-3.44v12.48a1.15 1.15 0 0 0 1.18 1.079 1.107 1.107 0 0 0 1.079-1.08V20.94h13.242v1.828c.057 1.296-.504 1.9-1.943 1.828h-3.009c-.503 0-.762.288-.762.864.067.652.499 1.012 1.295 1.08h3.224c2.447 0 3.584-1.109 3.454-3.34V10.722a1.294 1.294 0 0 0-1.295-1.296h-13.097a118.765 118.765 0 0 0 1.942-3.123h14.696a.962.962 0 0 0 .964-.964.964.964 0 0 0-.964-.965H225.25a10.08 10.08 0 0 0 1.08-2.159 1.138 1.138 0 0 0-.648-1.439 1.252 1.252 0 0 0-1.612.964l-1.295 2.591h-7.643c-.561 0-.849.317-.849.964Zm6.779 8.924v-2.476h-.058a.484.484 0 0 1 .151-.425.481.481 0 0 1 .206-.11l.016-.003a.51.51 0 0 1 .132-.008.46.46 0 0 1 .085.014h12.162a.489.489 0 0 1 .547.532v2.476h-13.241Zm0 4.85v-3.008h13.241v3.008h-13.241Zm32.599-2.26c-.863.145-1.439 0-1.626-.532a1.22 1.22 0 0 1 .763-1.44 26.994 26.994 0 0 0 10.651-6.03 1.175 1.175 0 0 1 .316-.216 2.166 2.166 0 0 1 1.627-.748c.489 0 1.108.288 1.827 1.065a24.738 24.738 0 0 0 10.335 5.498 1.146 1.146 0 0 1 .682.662 1.157 1.157 0 0 1-.049.95c-.144.504-.677.69-1.612.532a35.98 35.98 0 0 1-10.867-6.232.518.518 0 0 0-.748 0 35.353 35.353 0 0 1-5.464 3.838.868.868 0 0 1 .254-.038h10.866a.864.864 0 0 1 0 1.727H259.75a.865.865 0 0 1-.574-1.509 35.332 35.332 0 0 1-5.515 2.474Zm-1.079-7.642a1.037 1.037 0 0 1 0-1.511 18.427 18.427 0 0 0 4.519-6.347 1.183 1.183 0 0 1 1.512-.533c.561.144.748.533.532 1.18a8.214 8.214 0 0 1-.748 1.44h6.664a.961.961 0 0 1 .863.964.94.94 0 0 1-.863.863h-7.744a20.168 20.168 0 0 1-3.238 3.872 1.44 1.44 0 0 1-1.526.072h.029Zm5.383 16.681c-.864 0-1.339-.46-1.439-1.439v-4.85a1.302 1.302 0 0 1 .376-1.063 1.309 1.309 0 0 1 1.063-.377h14.637a1.342 1.342 0 0 1 1.215.91c.058.17.08.35.066.53v4.85a1.316 1.316 0 0 1-.566 1.205 1.327 1.327 0 0 1-.715.234h-14.637Zm3.224-16.364a1.037 1.037 0 0 1-1.439-.216 10.083 10.083 0 0 1-1.44-1.929c-.359-.504-.331-.892.101-1.18a1.108 1.108 0 0 1 1.439.1c.395.453.756.934 1.08 1.44.094.152.2.296.316.432a1.126 1.126 0 0 1-.057 1.353Zm10.075 14.536a.5.5 0 0 0 .343-.086.48.48 0 0 0 .204-.446v-2.879a.497.497 0 0 0-.14-.407.486.486 0 0 0-.407-.14h-11.831c-.432 0-.648.188-.648.547v2.879c0 .345.216.532.648.532h11.831Zm-5.167-16.364a1.092 1.092 0 0 1-.115-1.44 15.455 15.455 0 0 0 3.022-4.85 1.14 1.14 0 0 1 1.439-.648.936.936 0 0 1 .533 1.296 7.425 7.425 0 0 1-.748 1.44h7.326a1.009 1.009 0 0 1 .964.963.981.981 0 0 1-.964.864h-8.291c-.1.184-.211.361-.331.533l-1.18 1.51a1.28 1.28 0 0 1-1.612.332h-.043Zm7.743 1.943a1.02 1.02 0 0 1-1.439-.331 81.324 81.324 0 0 1-.222-.284l-.006-.007c-.282-.36-.741-.95-1.384-1.753a.905.905 0 0 1 .216-1.18 1.121 1.121 0 0 1 1.439.115l.439.54c.619.761 1.032 1.268 1.173 1.504a1.05 1.05 0 0 1-.173 1.396h-.043Z",clipRule:"evenodd"}))},R=function(e){var t=e.showSlogn;return(0,a.tZ)(k,{css:{position:"absolute",left:"50%",bottom:"8%",transform:"translate(-50%,0%)",opacity:t?1:0,transition:"opacity 0.3s linear",width:"30%"}})},N=Object.assign,O=function(e){return d().createElement(Z.Z,N({fill:"none",viewBox:"0 0 40 40"},e),d().createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M18.194 28.016a9.844 9.844 0 1 1 0-19.688 9.844 9.844 0 0 1 0 19.688Zm10.362-1.813a13.069 13.069 0 1 0-2.317 2.331l6.045 6.045a1.684 1.684 0 0 0 2.317-2.331l-6.045-6.045Z",clipRule:"evenodd"}))},P=Object.assign,D=function(e){return d().createElement(Z.Z,P({fill:"none",viewBox:"0 0 124 64"},e),d().createElement("path",{fill:"#fff",d:"M0 6a6 6 0 0 1 6-6h117v64H6a6 6 0 0 1-6-6V6Z"}),d().createElement("path",{fill:"#0767FB",fillRule:"evenodd",d:"M35.274 31.36h5.729A1.642 1.642 0 0 1 42.629 33v1.813h-7.657a37.718 37.718 0 0 1-1.44 6.794 19.258 19.258 0 0 1-4.159 7.412 7.082 7.082 0 0 1-6.966 1.238 41.498 41.498 0 0 0 4.016-3.872 21.589 21.589 0 0 0 3.872-6.836 23.184 23.184 0 0 0 1.021-4.736h-8.39a3.44 3.44 0 0 1 3.44-3.44h5.281c.058-.623.087-1.256.087-1.9v-7.196h-2.98c-.115.144-.115.274-.115.389a5.413 5.413 0 0 1-2.62 3.756 7.542 7.542 0 0 1-3.266.778s1.51-3.052 2.13-4.779l.059-.172c.378-1.106.968-2.831 1.61-4.635a4.174 4.174 0 0 1 1.77-2.519 5.455 5.455 0 0 1 3.11-.92s-1.094 3.252-1.44 4.317l-.033.073a.628.628 0 0 0-.082.258h10.19a1.77 1.77 0 0 1 1.77 1.756v1.684h-6.563v9.096Zm8.694-12.48H59.8l.043 27.707h-6.189l-5.282 3.368-.518-3.368h-3.886V18.88Zm6.045 26.224 3.094-1.957h3.109V22.321h-8.708v20.826h2.202l.303 1.957ZM88.6 32.712V20.58l12.133-.633h1.094c.679-1.193.99-2.56.892-3.93l-.001-.002c-.101-.317-.274-.86-.819-.732a41.76 41.76 0 0 1-5.498.936c-3.364.407-4.925.52-9.248.832l-.827.06c-8.636.634-16.336.936-16.336.936a3.282 3.282 0 0 0 3.44 3.296c2.878-.115 7.196-.317 11.514-.533v11.903H68.579a3.44 3.44 0 0 0 3.44 3.44h12.954v9.197c0 1.152-.59 1.54-1.57 1.569h-5.037a5.412 5.412 0 0 0 2.879 3.397c1.12.374 2.31.497 3.483.36 1.756-.087 3.814-1.08 3.814-4.635v-9.888h14.508a1.638 1.638 0 0 0 1.52-1.023c.082-.2.123-.415.121-.632v-1.785H88.6Zm-12.207-9.054c.333.206.622.475.85.793l3.7 5.181-2.879 2.087-5.47-7.585.49-.36a2.979 2.979 0 0 1 3.31-.116Zm19.792.548-4.016 5.31 2.879 2.16 5.757-7.7-.49-.36a2.941 2.941 0 0 0-2.203-.575 2.95 2.95 0 0 0-1.956 1.165h.029ZM33.92 40.398l3.023-1.929 3.972 5.93c.45.863.577 1.858.36 2.807a9.04 9.04 0 0 1-.863 2.878l-6.492-9.686Z",clipRule:"evenodd"}))},L=Object.assign,M=function(e){return d().createElement(Z.Z,L({width:"31",height:"17",fill:"none",viewBox:"0 0 31 17"},e),d().createElement("path",{fill:"#fff",d:"M2.928 14.638 0 0h31L5.962 15.933a2 2 0 0 1-3.034-1.295Z"}))},B=function(e){var t=e.currentUser;return(0,a.BX)("div",{css:{display:"flex",alignItems:"center",border:"".concat(g(3)," solid #fff"),backgroundColor:"#fff",position:"relative",height:g(70),boxSizing:"border-box",borderRadius:g(3),width:g(400)},children:[(0,a.tZ)(M,{css:{position:"absolute",bottom:parseInt(g(-18)),right:g(30),width:g(31),height:g(17.5)}}),(0,a.tZ)(D,{css:{width:g(123),height:"100%"}}),(0,a.BX)("div",{css:{backgroundColor:"#000",display:"inline-flex",alignItems:"center",position:"relative",height:"100%",paddingRight:g(10),paddingLeft:g(20),borderTopRightRadius:g(3),borderBottomRightRadius:g(3),flex:1},children:[(0,a.tZ)("span",{css:{fontSize:g(34),color:"#fff",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:g(180),WebkitLineClamp:1},children:t.name}),(0,a.tZ)(O,{css:{position:"absolute",right:g(10),width:g(40),height:g(40)}})]})]})},U=function(e){var t=e.setShowEndVideo,r=e.handleOpacityChange,i=e.subscribeEvent,c=e.hasEndVideo,d=e.currentUser,p=e.itemType,f=e.itemId,m=(0,o._)((0,l.useState)(!1),2),E=m[0],y=m[1],C=(0,o._)((0,l.useState)(!1),2),S=C[0],I=C[1],A=(0,o._)((0,l.useState)(!1),2),b=A[0],Z=A[1],x=(0,o._)((0,l.useState)(!1),2),k=x[0],N=x[1],O=(0,l.useRef)(!1),P=(0,l.useRef)(!1),D=(0,l.useRef)([]),L=(0,l.useRef)(new Audio),M=(0,h._)(function(){return n.e(6018).then(n.t.bind(n,83476,23))}),U=(0,s.A)(function(e){if(e){var t=D.current.findIndex(function(t){return t[e]});D.current[t]&&clearTimeout(D.current[t][e]),D.current.splice(t,1)}else D.current.forEach(function(e){"object"==typeof e?clearTimeout(Object.values(e)[0]):clearTimeout(e)}),D.current=[]}),G=(0,s.A)(function(){t(!1),I(!1),N(!1),Z(!1)}),F=(0,s.A)(function(){I(!0),D.current.push({author:setTimeout(function(){N(!0),D.current.push({content:setTimeout(function(){y(!0),Z(!0),L.current.play()},200)})})}),D.current.push({exit:setTimeout(function(){r({value:0}),D.current.push({destroy:setTimeout(function(){G(),U()},500)})},2300)})});(0,l.useEffect)(function(){P.current&&!O.current&&c&&(U("timeout"),F()),c&&P.current&&!O.current&&(U("timeout"),F());var e=function(){if(t(!0),r({value:1,time:0}),P.current=!0,!1===c){G();return}O.current?G():c?F():D.current.push({timeout:setTimeout(function(){O.current=!0,I(!1),t(!1)},3e3)})};if(i){var n=i(u.FP.ENDED,e).unsubscribe;return function(){n(e),U()}}},[c,i]);var H={type:p?p.charAt(0).toUpperCase()+p.slice(1):""};return"answer"===p?H.token=f:H.id=f,(0,l.useEffect)(function(){L.current.src="https://zhstatic.zhihu.com/heifetz_static/1632738186715.wav"},[]),S&&M&&(0,a.tZ)(_.ZAEnv,{content:H,children:(0,a.BX)(_.ZAShow,{zaType:"Video",zaBlock:"EndVideo",children:[(0,a.BX)("div",{css:{position:"absolute",left:"50%",top:g(250),transform:"translate(-50%,0)",textAlign:"center",opacity:k?1:0,transition:"opacity 0.2s linear"},children:[(0,a.BX)("div",{css:{position:"relative",height:g(250),width:g(300),margin:"0 auto ".concat(g(53))},children:[E&&(0,a.tZ)(w,{src:"https://zhstatic.zhihu.com/heifetz_static/kanshan.json",showKanShan:E}),(0,a.tZ)(T,{src:d.avatarUrl})]}),(0,a.tZ)(B,{currentUser:d})]}),(0,a.tZ)(R,{showSlogn:b})]})})},G=function(e){var t=e.id,n=e.itemId,d=e.itemType,h=(0,l.useRef)((0,u.Wn)(t,"*",!0)).current.subscribeMessage,_=(0,o._)((0,l.useState)(!1),2),T=_[0],E=_[1],y=(0,o._)((0,l.useState)({value:1,time:.5}),2),C=y[0],S=y[1],I=(0,o._)((0,l.useState)(null),2),A=I[0],b=I[1],w=(0,o._)((0,l.useState)({}),2),Z=w[0],x=w[1],k=(0,l.useRef)(!0),R=(0,o._)((0,l.useState)(!1),2),N=R[0],O=R[1],P=(0,f.Z)(),D=(0,l.useRef)(),L=(0,o._)((0,c.h)(0),2),M=L[0],B=L[1],G=(0,s.A)(function(e){var t=e.value,n=e.time;S({value:t,time:void 0===n?.5:n})}),F=(0,s.A)(function(){var e;P("".concat(p.Z.fetchRoot.www,"/api/v4/video/tail?object_id=").concat(n,"&object_type=").concat(d),{headers:{"X-Referer":document.referrer,"Content-Type":"application/json","X-App-Za.OS":"webplayer"},credentials:"include"}).then((e=(0,r._)(function(e){var t;return(0,i.__generator)(this,function(n){switch(n.label){case 0:if(!(t=e.payload).displayAnimation)return[3,5];n.label=1;case 1:var r;return n.trys.push([1,3,,4]),[4,(r=t.author.avatarUrl,new Promise(function(e,t){var n=new Image;n.onload=e,n.onerror=t,n.src=r}))];case 2:return n.sent(),b(!0),x({name:t.author.name,avatarUrl:t.author.avatarUrl}),[3,4];case 3:return n.sent(),b(!1),[3,4];case 4:return[3,6];case 5:b(!1),n.label=6;case 6:return[2]}})}),function(t){return e.apply(this,arguments)})).catch(function(){b(!1)})}),H=(0,s.A)(function(){k.current&&(O(!0),k.current=!1)});return(0,l.useEffect)(function(){if(n&&d&&N&&P&&F(),h){var e=h(u.FP.PLAY,H).unsubscribe;return function(){e(H)}}},[F,N,P,h]),(0,l.useEffect)(function(){if(D.current&&(m.width=D.current.clientWidth,M(D.current)),h){var e=function(){setTimeout(function(){m.width=D.current.clientWidth})},t=[h(u.FP.ENTER_FULLSCREEN,e).unsubscribe,h(u.FP.EXIT_FULLSCREEN,e).unsubscribe,h(u.FP.ENTER_PAGE_FULLSCREEN,e).unsubscribe,h(u.FP.EXIT_PAGE_FULLSCREEN,e).unsubscribe];return function(){t.forEach(function(e){return e()})}}},[D.current,h]),(0,l.useEffect)(function(){B&&(m.width=B&&B.width)},[B]),(0,a.tZ)("div",{ref:D,children:(0,a.tZ)("div",{css:{position:"absolute",height:"100%",width:g(1920),left:0,top:0,backgroundColor:"black",visibility:T?"visible":"hidden"},children:(0,a.tZ)("div",{css:{position:"absolute",top:"50%",left:0,transform:"translateY(-50%)",opacity:C.value,transition:"opacity ".concat(C.time,"s linear"),backgroundColor:"black",height:9*g(1920,null)/16,width:"100%"},children:D.current&&(0,a.tZ)(U,{itemId:n,itemType:d,currentUser:Z,hasEndVideo:A,handleOpacityChange:G,subscribeEvent:h,setShowEndVideo:E})})})})}},28435:function(e,t,n){"use strict";n.d(t,{g:function(){return E}});var r=n(22107),o=n(94707),i=n(86325),a=n(55164),c=n(85626),s=n(85879),u=n(62082),l=n(54231),d=n(84871),p=n.n(d),f=n(87363),h=n(92258),_=n(65277),m=n(80714),g=function(e){(0,i._)(n,e);var t=(0,c._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"componentDidCatch",value:function(e,t){var n,r,o,i,a,c=null!==(r=(0,l.j0)())&&void 0!==r?r:"Unknown",s=null!==(o=null==e?void 0:e.name)&&void 0!==o?o:"Unknown",d=null!==(i=this.props.currentUser)&&void 0!==i?i:"Unknown",p=m.Z.release;(0,u.Tb)(e,{logger:"EditorErrorReport",fingerprint:["editor-fail"],extra:{passWhitelistUrlsTest:!0,pageName:c,currentUser:d}});var f={type:"EditorRenderError",appName:"heifetz",spanName:c,currentUser:d,release:p,isBadBrowserPlugin:null!==(a=(0,_.Yz)())&&void 0!==a?a:"Unknown",error:{name:s,message:e.message,stack:e.stack,payload:e.payload||"Unknown",componentStack:t.componentStack}};throw(0,u.zB)(f),null===(n=window.webReporter)||void 0===n||n.report("heifetz_editor_error",f),e}},{key:"render",value:function(){return this.props.children}}]),n}(f.Component),T=(0,h.connect)(function(e){return{currentUser:e.currentUser}})(g),E=function(e){var t=function(t){(0,i._)(u,t);var n=(0,c._)(u);function u(){return(0,r._)(this,u),n.apply(this,arguments)}return(0,o._)(u,[{key:"render",value:function(){return(0,s.tZ)(T,{children:(0,s.tZ)(e,(0,a._)({},this.props))})}}]),u}(f.Component);return p()(t,e)}},38267:function(e,t,n){"use strict";var r=n(85879),o=n(39658),i=n(92258),a=n(26299),c=n(31142);t.Z=function(e){var t=e.subtitle,n=e.errorImage,s=e.buttonText,u=e.to,l=(0,i.useSelector)(function(e){return e.env.ctx.query.error_title})||e.title;return(0,r.BX)("div",{className:"ErrorPage",children:[(0,r.tZ)(o.ql,{title:l}),(0,r.BX)("div",{className:"ErrorPage-container",children:[(0,r.BX)("div",{className:"ErrorPage-text",children:[(0,r.tZ)("h1",{className:"ErrorPage-title",children:l}),(0,r.tZ)("p",{className:"ErrorPage-subtitle",children:t}),(0,r.tZ)(c.Z,{a:!0,preset:"primary",color:"blue",className:"ErrorPage-primaryButton",to:void 0===u?"https://www.zhihu.com":u,children:void 0===s?"去往首页":s})]}),(0,r.tZ)("div",{className:"ErrorPage-errorImageContainer",children:(0,r.tZ)("img",{className:"ErrorPage-errorImage",src:void 0===n?"//zhstatic.zhihu.com/assets/error/liukanshan_wire.svg":n,alt:"page error"})})]}),(0,r.tZ)(a.ZP,{children:(0,r.tZ)(a.sJ,{})})]})}},70400:function(e,t,n){"use strict";n.d(t,{SV:function(){return S},mf:function(){return I.Z},ds:function(){return P},Ko:function(){return y}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(57477),l=n(71728),d=n(97614),p=n(85626),f=n(85879),h=n(62082),_=n(54231),m=n(87363),g=n(80714),T=n(14914),E=function(e){(0,c._)(n,e);var t=(0,p._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.message,n=e.location.pathname;return(0,f.tZ)("div",{className:"UnknownError",children:t||(0,f.BX)("div",{children:["遇到不可预料的问题，请检查「网络连接」或",(0,f.tZ)("a",{href:n,children:"刷新重试"}),"。"]})})}}]),n}(m.Component),y=(0,T.withRouter)(E),C=function(e,t){var n,r,o,i,a,c,s,u=t.name,l=t.errorInfo;return{type:u,appName:"heifetz",pageName:null!==(n=(0,_.j0)())&&void 0!==n?n:"Unknown",errorName:null!==(r=null==e?void 0:e.name)&&void 0!==r?r:"Unknown",release:g.Z.release,error:{name:null!==(o=null==e?void 0:e.name)&&void 0!==o?o:"Unknown",message:null!==(i=null==e?void 0:e.message)&&void 0!==i?i:"Unknown",stack:null!==(a=null==e?void 0:e.stack)&&void 0!==a?a:"Unknown",payload:null!==(c=null==e?void 0:e.payload)&&void 0!==c?c:"Unknown",componentStack:null!==(s=null==l?void 0:l.componentStack)&&void 0!==s?s:"Unknown"}}},S=function(e){(0,c._)(n,e);var t=(0,p._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{hasError:!1}),e}return(0,i._)(n,[{key:"componentDidCatch",value:function(e,t){var n,r=this.props,o=r.target,i=r.config;if(console.error("Einsturz[EB]",o,e,t),void 0!==window.Raven&&window.Raven.captureException(e,{logger:"ErrorBoundary",fingerprint:["ErrorBoundary"],extra:(0,s._)({info:t},o&&{target:o})}),i){var a=i.name,c=i.presets,u=void 0===c?[]:c,l=C(e,{name:a,errorInfo:t});u.includes("sc-report")&&(0,h.zB)(l),u.includes("web-report")&&(null===(n=window.webReporter)||void 0===n||n.report(a,l))}}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.replacement,r=e.message,o=(0,l._)(e,["children","replacement","message"]);if(this.state.hasError){var i=void 0===n?"undefined":(0,d._)(n);return"undefined"===i?(0,f.tZ)(y,{message:r||"遇到不可预料的问题"}):"function"===i?n((0,u._)((0,s._)({},o),{children:t})):n}return t}}],[{key:"getDerivedStateFromError",value:function(){return{hasError:!0}}}]),n}(m.Component),I=n(38267),A=n.p+"assets/liukanshan_wire.dc5adecf.svg",b=n(92258),w=n(94009),Z=n(76867),x=n.p+"assets/liukanshan_desert.ecf3c388.svg",k=function(e){if("en"===e)return{targetUrl:"https://en.zhihu.com"};var t=/^\/question\/(\d+)\/answer\/(\d+)/.exec(e);return t&&t[1]&&t[2]?{destination:"回答所在的问题页",targetUrl:"/question/".concat(t[1])}:{destination:"知乎首页",targetUrl:"https://www.zhihu.com"}};function R(e){var t=e.seconds,n=e.source,r=e.title,o=(0,w._)((0,m.useState)(void 0===t?5:t),2),i=o[0],a=o[1],c=k(n),s=c.targetUrl,u=c.destination;return((0,Z.Y)(function(){a(i-1)},0===i?null:1e3),(0,m.useEffect)(function(){0===i&&(location.href=s)},[i,s]),"en"===n)?(0,f.tZ)(I.Z,{title:r,subtitle:"Auto-redirecting in ".concat(i," seconds"),errorImage:x,buttonText:"Home",to:"https://en.zhihu.com"}):(0,f.tZ)(I.Z,{title:r,subtitle:"".concat(i," 秒后自动跳转至").concat(u),errorImage:x})}var N=n.p+"assets/liukanshan_delete.5086fe3e.png",O=n.p+"assets/liukanshan_delivery.a6651701.svg",P=function(){return(0,f.tZ)(I.Z,{title:"出了一点问题",subtitle:"我们正在解决",errorImage:O})};n(84871),n.p,n(44812),n(25452),m.Component;var D=n(58909),L=n(7407),M=[{name:"BadRequestErrorPage",path:"/400",component:function(){return(0,f.tZ)(I.Z,{title:"请求错误",subtitle:"无法访问当前页面",errorImage:A})}},{name:"UnauthorizedErrorPage",path:"/401",component:function(){return(0,f.tZ)(I.Z,{title:"未认证",subtitle:"无法访问当前页面",errorImage:A})}},{name:"ForbiddenErrorPage",path:"/403",component:function(){return(0,f.tZ)(I.Z,{title:"没有权限",subtitle:"无法访问当前页面",errorImage:A})}},{name:"NotFoundErrorPage",path:"/404",component:function(){var e=(0,b.useSelector)(function(e){return e.env.ctx.query}),t=e.redirect,n=e.error_title,r=e.error_from;return t?(0,f.tZ)(R,{source:r,seconds:5,title:n}):(0,f.tZ)(I.Z,{title:"404",subtitle:"你似乎来到了没有知识存在的荒原",errorImage:A})},revalidate:864e5,getStaticPath:function(e){var t,n=e.data,r="NotFoundErrorPageCacheKey",o=null==n?void 0:n.initialState;o&&(r+=((0,L.Hu)(o)?"_mobile":"_pc")+((0,D.dd)(o)?"_login":"_notLogin"));var i=/error_title=([^&]+)/.exec(null==n?void 0:null===(t=n.ctx)||void 0===t?void 0:t.originalUrl);return i&&i[1]&&(r+="data-".concat(i[1])),r}},{name:"GoneErrorPage",path:"/410",component:function(){return(0,f.tZ)(I.Z,{title:"该内容已删除",subtitle:"你似乎来到了没有知识存在的荒原",errorImage:N})},revalidate:864e5,getStaticPath:function(e){var t=e.data,n="GoneErrorPageCacheKey",r=null==t?void 0:t.initialState;return r&&(n+=((0,L.Hu)(r)?"_mobile":"_pc")+((0,D.dd)(r)?"_login":"_notLogin")),n}}];T.Route,M.map(function(e){return(0,f.tZ)(T.Route,{revalidate:e.revalidate,getStaticPath:e.getStaticPath,name:e.name,path:e.path,component:e.component},e.path)})},42367:function(e,t,n){"use strict";n.d(t,{lY:function(){return X},ZP:function(){return F},Wq:function(){return K},Vj:function(){return j}});var r,o,i=n(15030),a=n(55164),c=n(57477),s=n(71728),u=n(94009),l=n(79065),d=n(85879),p=n(16836),f=n(91850),h=n(83537),_=n(65733),m=n(70511),g=n(87363),T=n(32210),E=n(66263),y=n(44909),C=n(65871),S=n(87641);function I(){var e=(0,l._)(["\n  display: flex;\n  align-items: center;\n  min-width: ","px;\n  max-width: ","px;\n  height: ","px;\n  padding: 0 ","px;\n  overflow-y: hidden;\n  font-size: 13px;\n  font-weight: var(--zFontWeightBold);\n  border-radius: 2px;\n  /* box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15); */\n\n  ","\n"]);return I=function(){return e},e}function A(){var e=(0,l._)(["\n  display: flex;\n  align-items: center;\n"]);return A=function(){return e},e}function b(){var e=(0,l._)(["\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n"]);return b=function(){return e},e}function w(){var e=(0,l._)(["\n  display: flex;\n  align-items: center;\n"]);return w=function(){return e},e}var Z={width:260,maxWidth:640,height:40,padding:20},x=m.default.div(I(),Z.width,Z.maxWidth,Z.height,Z.padding,function(e){return"normal"===e.variant?"\n    background: linear-gradient(0deg, rgba(23, 114, 246, 0.08), rgba(23, 114, 246, 0.08));\n    color: var(--MapBrand);\n  ":"\n    background: linear-gradient(0deg, rgba(217, 83, 80, 0.08), rgba(217, 83, 80, 0.08));\n    color: var(--MapCriticalTip);\n  "}),k=m.default.div(A()),R=m.default.div(b()),N=m.default.div(w()),O=function(e){var t=e.variant,n=e.icon,r=e.children;return(0,d.tZ)(x,{variant:void 0===t?"normal":t,children:(0,d.BX)(R,{css:{justifyContent:"center"},children:[n,(0,d.tZ)(S.kC,{display:"inline-flex",ml:"4px",height:"22px",alignItems:"center",children:r})]})})},P=function(e){var t=e.children,n=e.className;return(0,d.tZ)(O,{variant:"normal",className:n,icon:(0,d.tZ)(y.Z,{size:16,fill:"var(--MapBrand)",center:!0,text:!0}),children:t})},D=function(e){var t=e.children,n=e.className;return(0,d.tZ)(O,{variant:"critical",className:n,icon:(0,d.tZ)(C.Z,{size:16,fill:"var(--MapCriticalTip)",center:!0,text:!0}),children:t})},L=function(e){var t=e.preset,n=void 0===t?void 0:t,r=e.variant,o=void 0===r?"normal":r,i=e.leftSlot,a=e.children,c=e.rightSlot,s=e.className;return("boolean"==typeof n?n:!!(!i&&!c&&a))?"normal"===o?(0,d.tZ)(P,{className:s,children:a}):(0,d.tZ)(D,{className:s,children:a}):(0,d.BX)(x,{variant:o,className:s,children:[i&&(0,d.tZ)(k,{children:i}),(0,d.tZ)(R,{children:a}),c&&(0,d.tZ)(N,{children:c})]})};function M(){var e=(0,l._)(["\n  background: var(--MapUIFrame99C);\n  position: ",";\n  z-index: 90; // 要低于 AppHeader 的 z-index\n  top: ",";\n  left: ",";\n"]);return M=function(){return e},e}var B={top:"20%",left:"50%",transform:"translate(-50%, -50%)"},U=m.default.div(M(),function(e){return e.fixed?"fixed":"absolute"},function(e){return"number"==typeof e.top?"".concat(e.top,"px"):null!==(r=e.top)&&void 0!==r?r:B.top},function(e){return"number"==typeof e.left?"".concat(e.left,"px"):null!==(o=e.left)&&void 0!==o?o:B.left}),G=function(e,t,n){var r=e.getBoundingClientRect(),o=Math.ceil("below"===n?r.top+r.height+Z.padding:r.top-Z.padding);return{top:t?o:o+window.scrollY,left:r.left+r.width/2,direction:n,transform:"translate(-50%, -50%)"}},F=function(e){var t=e.getTarget,n=e.fixed,r=void 0!==n&&n,o=e.top,l=e.duration,m=void 0===l?3e3:l,y=e.onClose,C=e.children,S=(0,s._)(e,["getTarget","fixed","top","duration","onClose","children"]),I=(0,u._)((0,f.k)(),2),A=I[0],b=I[1];(0,h.K)(function(){b.off(),null==y||y()},A&&m>0?m:null);var w=(0,u._)((0,g.useState)(B),2),x=w[0],k=w[1],R=(0,g.useRef)(B),N=(0,g.useRef)(),O=function(e){N.current||(N.current=e.getBoundingClientRect().top<1.5*E.BR+Z.height?"below":"above")},P=(0,_.A)(function(){var e=null==t?void 0:t();if(!(0,i._)(e,HTMLElement)){b.on();return}O(e);var n=G(e,r,N.current),o=R.current,a=o.top,c=o.left,s=n.top,u=n.left;(a!==s||c!==u)&&(R.current=n,k(n)),b.on()});if((0,g.useEffect)(function(){if(!A){N.current=void 0;return}var e=(0,T.subscribe)("resize",P);return function(){e.unsubscribe()}},[A,P]),(0,g.useEffect)(function(){if(P(),r){var e=setTimeout(P,400),t=(0,T.subscribe)("scroll",P,{throttleRate:0,eventOptions:{capture:!0}});return function(){t.unsubscribe(),clearTimeout(e)}}},[A,r,P]),!A)return null;var D=x.top,M=x.left,F=(0,s._)(x,["top","left"]);return(0,d.tZ)(p.Z,{children:(0,d.tZ)(U,{fixed:r,top:void 0!==o?o:D,left:M,css:F,children:(0,d.tZ)(L,(0,c._)((0,a._)({},S),{children:C}))})})},H=n(17103),z=n(83821),q=n(89146),V=function(e,t){if(!e||!(null==t?void 0:t.length))return null;var n=(0,u._)(t.split(" "),2),r=n[0],o=n[1];if("parent"===r)return e.parentElement;var a=e.closest(r);return(0,i._)(a,HTMLElement)?o?a.querySelector(o):a:null},W=(0,g.forwardRef)(function(e,t){var n=e.targetPath,r=void 0===n?"parent":n,o=e.fixed,i=e.duration,u=e.onClose,l=e.leftSlot,p=e.rightSlot,f=e.children,h=(0,s._)(e,["targetPath","fixed","duration","onClose","leftSlot","rightSlot","children"]),_=(0,g.useRef)(null);return(0,d.BX)(d.HY,{children:[(0,d.tZ)("span",{ref:(0,H.q)(t,_),css:{display:"none"}}),!1,(!!(l||p)||!!f)&&(0,d.tZ)(F,(0,c._)((0,a._)({},h),{fixed:o,getTarget:function(){return V(_.current,r)},duration:i,onClose:u,leftSlot:l,rightSlot:p,children:f}))]})}),X=(0,z.F3)(W),K=function(){var e=(0,u._)((0,g.useState)(null),2),t=e[0],n=e[1],r=(0,_.A)(function(e){n({children:e,variant:"normal"})}),o=(0,_.A)(function(e){n({children:e,variant:"critical"})}),i=(0,g.useCallback)(function(){if(!(null==t?void 0:t.children))return null;var e=t.children,r=(0,s._)(t,["children"]);return(0,d.tZ)(W,(0,c._)((0,a._)({},r),{onClose:function(){return n(null)},children:e}))},[t]);return(0,g.useMemo)(function(){return[{normal:r,critical:o},i]},[r,o,i])},j=(0,q.Z)("withFancyToast",function(e){return function(t){var n=(0,u._)(K(),2),r=n[0],o=n[1],i=(0,c._)((0,a._)({},t),{fancyToast:r,fancyRef:o});return(0,d.tZ)(e,(0,a._)({},i))}})},63362:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(85879),o=n(16839),i=n(87363),a=n(63638),c=n(30722),s=n(25452),u=n(97727),l=function(e){var t=e.className,n=e.onClick,l=e.label,d=void 0===l?"收藏":l,p=e.onRef,f=e.disabled,h=e.showIcon,_=e.count,m=void 0===_?void 0:_,g=e.faved,T=void 0===g?void 0:g,E=e.newInteract,y=T?"已".concat(d):d,C=(0,i.useMemo)(function(){if(!E)return{colorful:!1,labelText:d};var e=m>0,t=e?(0,c.Zh)(m):"",n=e?t:d;return{colorful:e,labelText:n}},[E,m,d]),S=C.colorful,I=C.labelText;return(0,r.BX)(r.HY,{children:[(0,r.tZ)(u.bY,{input:"f",action:n}),(0,r.tZ)(a.ZAClick,{as:s.ZP,zaText:"收藏",zaType:"Button",zaModuleId:"pop_up_panel_collect_button",zaBlock:"收藏",onRef:p,className:t,preset:"plain",onClick:n,icon:void 0===h||h?o.mH:null,label:I,"aria-label":y,disabled:f,css:{"& .Button-zi":S&&T?{fill:"var(--MapFavorite)"}:void 0}})]})}},13630:function(e,t,n){"use strict";n.d(t,{Z:function(){return z}});var r=n(9338),o=n(87320),i=n(55164),a=n(57477),c=n(94009),s=n(30971),u=n(85879),l=n(91850),d=n(83537),p=n(65733),f=n(87363),h=n(92258),_=n(20857),m=n(22107),g=n(94707),T=n(86325),E=n(71728),y=n(49899),C=n(85626),S=n(55536),I=n(31824),A=n(50373),b=n(85576),w=n(35528),Z=function(){return n.e(9165).then(n.bind(n,29165)).then(function(e){return e.FavlistsModal})},x={ids:[],isFetching:!1,isDrained:!1},k=(0,I.P1)(function(e){return e.favlists[e.currentUser]||x},function(e){return e.entities.favlists},function(e,t){var n=e.ids,r=(0,E._)(e,["ids"]);return(0,a._)((0,i._)({},r),{items:n.map(function(e){return t[e]})})}),R=function(e){(0,T._)(n,e);var t=(0,C._)(n);function n(){var e;return(0,m._)(this,n),e=t.apply(this,arguments),(0,o._)((0,_._)(e),"onFavlistAdd",function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=e.props,i=o.type,a=o.id;return o.onFavlistAdd.apply(void 0,(0,y._)(n).concat([{type:i,id:a}]))}),(0,o._)((0,_._)(e),"onLoad",function(){var t=e.props,n=t.onLoad,r=t.type,c=t.id,s=t.onUpdateReaction;return n(r,c).then(function(e){s({contentType:r,contentId:c,relations:e.payload.data.reduce(function(e,t){return(0,a._)((0,i._)({},e),(0,o._)({},t.id,t.isFavorited))},{})})})}),e}return(0,g._)(n,[{key:"render",value:function(){var e=this.props,t=e.currentUser,n=e.authRequired,r=(0,E._)(e,["currentUser","authRequired"]);return(0,u.tZ)(A.Z,(0,a._)((0,i._)({getComponent:Z},r),{authRequired:n,isUserActive:!!(null==t?void 0:t.isActive),onLoad:this.onLoad,onFavlistAdd:this.onFavlistAdd}))}}]),n}(f.Component),N=(0,S.compose)(b.Z,(0,h.connect)(function(e,t){var n=t.id,r=t.type,o=e.favlists.relations,i=e.currentUser,a=k(e);return{isFetching:a.isFetching,isDrained:a.isDrained,items:a.items,relations:o["".concat(r,"_").concat(n)],zaEnabled:!0,urlToken:i}},function(e,t){return{onUpdateFav:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e(w.NK.apply(void 0,(0,y._)(n)))},onFavlistAdd:t.onFavlistAdd||function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e(w.Vf.apply(void 0,(0,y._)(n)))},onLoad:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e(w.n2.apply(void 0,(0,y._)(n)))},onUpdateReaction:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e(w.k1.apply(void 0,(0,y._)(n)))}}}))(R),O=n(83821),P=n(80714),D=n(82371),L=n(16947),M=n(63638),B=n(42367),U={color:"var(--MapBrand)",fontSize:"13px",lineHeight:"22px",fontWeight:"var(--zFontWeightBold)"},G=function(e){var t=e.onClick,n=e.targetPath,r=e.fixed;return(0,u.tZ)(B.lY,{duration:-1,fixed:r,targetPath:void 0===n?"parent":n,leftSlot:(0,u.tZ)("span",{css:U,children:"收藏成功"}),rightSlot:(0,u.BX)(M.ZAClick,{as:"button",zaText:"选择收藏夹",zaType:"Button",zaModuleId:"change_favlist_button",css:U,onClick:t,children:["选择收藏夹",(0,u.tZ)(L.Z,{size:16,text:!0,center:!0,color:"var(--MapBrand)"})]})})},F=function(e){var t,n=e.id,_=e.type,m=e.onClose,g=e.shown,T=e.targetPath,E=e.fixed,y=(0,h.useDispatch)(),C=(0,c._)((0,l.k)(!1),2),S=C[0],I=C[1],A=(0,c._)((0,l.k)(!1),2),b=A[0],Z=A[1];(0,d.K)(function(){null==m||m(),I.off()},S?5e3:null);var x=(0,p.A)(function(e,t){return y((0,w.Hz)(e,t)).then(function(n){y((0,w.k1)({contentType:e,contentId:t,relations:n.payload.data.reduce(function(e,t){return(0,a._)((0,i._)({},e),(0,o._)({},t.id,t.isFavorited))},{})}))})}),k=(0,p.A)((t=(0,r._)(function(e,t){var n,r;return(0,s.__generator)(this,function(o){switch(o.label){case 0:n=function(){null==m||m(),I.off(),Z.on(),x(e,t)},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,(0,D.d)("https://".concat(P.Z.wwwHost,"/api/v4/collections/contents/").concat(e,"/").concat(t),{method:"POST"})];case 2:if(null==(r=o.sent())?void 0:r.success)return y((0,w.wU)({contentType:e,contentId:t,collected:!0})),I.on(),x(e,t),[2];return[2,n()];case 3:return o.sent(),[2,n()];case 4:return[2]}})}),function(e,n){return t.apply(this,arguments)}));return(0,f.useEffect)(function(){g&&_&&n&&k(_,n)},[g,n,_,k]),(0,u.BX)(u.HY,{children:[(0,u.tZ)(H,{id:n,type:_,shown:S,onClose:m,onOpenFavlists:Z.on,toastShownSwitch:I,targetPath:T,fixed:E}),(0,u.tZ)(N,{id:n,type:_,shown:b,onClose:Z.off,zaEnabled:!0})]})},H=function(e){var t=e.onClose,n=e.shown,r=e.onOpenFavlists,o=e.toastShownSwitch,i=e.targetPath,a=e.fixed,c=(0,p.A)(function(){null==t||t(),o.off(),null==r||r()});return n?(0,u.tZ)(G,{onClick:c,targetPath:i,fixed:a}):null};function z(e){return(0,u.tZ)(O.ZP,{children:(0,u.tZ)(F,(0,i._)({},e))})}},46829:function(e,t,n){"use strict";n.d(t,{Z:function(){return H}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(57477),l=n(85626),d=n(85879),p=n(53910),f=n(67814),h=n.n(f),_=n(12592),m=n.n(_),g=n(14168),T=n.n(g),E=n(87363),y=n(92258),C=n(55536),S=n(69383),I=n(63638),A=n(4534),b=n(25452),w=n(80714),Z=n(66263),x=n(85576),k=n(10886),R=n(7407),N=n(35528),O=n(40195),P=n(67036),D=n(87964),L=n(76741),M=n(28814),B=n(84871),U=n.n(B),G={default:"default",primary:"primary"},F=function(e){(0,c._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"zaRef",(0,E.createRef)()),(0,a._)((0,r._)(e),"state",{hovered:!1,isFetching:!1}),(0,a._)((0,r._)(e),"handleMouseEnter",function(){e.setState({hovered:!0})}),(0,a._)((0,r._)(e),"handleMouseLeave",function(){e.setState({hovered:!1})}),(0,a._)((0,r._)(e),"toggleFollow",function(t){var n=e.props,r=n.isFollowing,o=n.type,i=n.id,a=n.zaId,c=n.useCustomZa,u=n.onFollowButtonClick,l=n.onToggleFollow,d=!r;if(!c){S.Z.trackEvent(t.target,(0,s._)({action:d?"Follow":"UnFollow",element:"Button",element_name:Z.ur[o]},a&&{id:a}));var p=d?"关注":"取消关注";e.zaRef.current.trackEvent({action:d?"Follow":"UnFollow",eventType:"Click",elementLocation:{type:"Button",text:p},block:p})}null==l||l(d);var f="toggleFollow".concat(o.slice(0,1).toUpperCase()).concat(o.slice(1)),h=e.props[f](i,d);m()(h)&&(e.setState({isFetching:!0}),h.then(function(){e.setState({isFetching:!1}),u&&u()}).catch(function(){return e.setState({isFetching:!1})}))}),(0,a._)((0,r._)(e),"handleToggleFollow",function(t){var n=e.props,r=n.authRequired,o=n.globalAuthRequired,i=n.ua;if(r){r(e.toggleFollow,Z.q0.follow,!0)(t);return}i.Zhihu?e.toggleFollow(t):o(e.toggleFollow,Z.q0.follow)(t)}),(0,a._)((0,r._)(e),"handleClick",function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n||e.setState({hovered:!1});var r=e.props.onClick;(!r||r(t))&&(e.handleToggleFollow(t),t.stopPropagation())}),(0,a._)((0,r._)(e),"getButtonPresetAndColor",function(e,t){var n=e.isFollowing,r=e.preset,o=e.getButtonPresetAndColor;return o&&"function"==typeof o?o(e,t):n?{preset:"primary",color:"grey"}:{preset:r,color:"blue"}}),(0,a._)((0,r._)(e),"getButtonInner",function(e,t){var n=e.isFollowing,r=e.canShowMutualFollowStatus,o=e.isFollowed,i=e.children,a=e.type,c=e.gender,s=e.entityHidden,u=e.getButtonInner;if(u&&"function"==typeof u)return u(e,t);var l=t.hovered,f="column"===a?"订阅":"关注";return n?{inner:l?"取消".concat(f):r&&o?"互相".concat(f):"已".concat(f)}:i?{inner:i}:"people"===a||"rewardPeople"===a?{inner:[(0,d.tZ)(p.nY,{className:"FollowButton-icon",text:!0,center:!0},"icon"),"".concat(f).concat("number"==typeof c&&-1!==c?Z.K_[c]:"")]}:{inner:"".concat(f).concat(s?"":A.iB[a])}}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.onRef,r=t.className,o=t.isMobile,i=t.disabled,a=t.disabledHovered,c=this.getButtonPresetAndColor(this.props,this.state),l=c.preset,p=c.color,f=this.getButtonInner(this.props,this.state).inner,_=this.state.isFetching;return(0,d.tZ)(I.ZAEnv,{moduleId:"follow_button",children:(0,d.BX)(I.ZAShow,(0,u._)((0,s._)({as:b.ZP,zaType:"Button",zaBlock:"关注",zaText:!0,onRef:n,preset:l,color:p,onClick:function(t){return e.handleClick(t,a)},className:h()("FollowButton",r)},!w.Z.isMobileEntry&&!o&&!a&&{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave}),{disabled:i||_,children:[(0,d.tZ)(I.ZARef,{ref:this.zaRef}),f]}))})}}]),n}(E.Component);(0,a._)(F,"propTypes",{preset:T().oneOf(Object.values(G)),type:T().oneOf(A.eX).isRequired,id:T().oneOfType([T().number,T().string]).isRequired,zaId:T().number,useCustomZa:T().bool}),(0,a._)(F,"defaultTypes",{preset:G.default}),(0,a._)(F,"PRESETS",G);var H=(0,C.compose)(function(e){return U()(function(t){var n=t.type,r=void 0===n?"":n,o=t.id,i=void 0===o?"":o;return r&&"people"===r||"rewardPeople"===r?(0,d.tZ)(I.ZAEnv,{content:{type:"User",token:i,id:i},children:(0,d.tZ)(e,(0,s._)({},t))}):(0,d.tZ)(e,(0,s._)({},t))},e)},(0,x.M)("globalAuthRequired"),(0,y.connect)(function(e){return{ua:e.env.userAgent,isMobile:(0,R.Hu)(e,{includeTablet:!0})}},{toggleFollowQuestion:O.XX,toggleFollowCollection:N.I3,toggleFollowColumn:k.As,toggleFollowRoundtable:D.OQ,toggleFollowTopic:L.KS,toggleFollowPeople:M.KX,toggleFollowRewardPeople:P.Ad}))(F)},97419:function(e,t,n){"use strict";n.d(t,{Z:function(){return P}});var r=n(55164),o=n(71728),i=n(85879),a=n(92258),c=n(57477),s=n(94009),u=n(55698),l=n(58245),d=n(65733),p=n(53910),f=n(82644),h=n(87363),_=n(87641),m=n(63638),g=n(46829),T=function(e){var t=e.ref,n=e.horizontalPadding,r=void 0===n?20:n,o=(0,s._)((0,h.useState)({left:0,right:0}),2),i=o[0],a=o[1];return(0,h.useEffect)(function(){var e=function(){if(t.current){var e=t.current.getBoundingClientRect();a({left:e.left+r,right:window.innerWidth-e.right+r})}};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}},[r,t]),i},E=function(e,t){var n=t.left,o=t.right,i=t.isClosing,a=t.isOffscreen,s=(0,c._)((0,r._)({boxShadow:"0 5px 20px ".concat(e.colorMod(e.colors.MapText02A).alpha(.1))},(0,l.M)({borderRadius:8,border:"1px solid ".concat(e.colors.GBK08A)})),{position:"fixed",left:n,right:o,zIndex:a?-999:2,transition:"all 300ms ease-in-out"});return a?(0,c._)((0,r._)({},s),{top:1e4,opacity:0,visibility:"hidden",pointerEvents:"none",userSelect:"none"}):(0,c._)((0,r._)({},s),{bottom:40,opacity:i?0:1,transform:i?"translateY(20px)":"translateY(0)",animation:i?"none":"popupAppear 300ms ease-out","@keyframes popupAppear":{"0%":{opacity:0,transform:"translateY(20px)"},"100%":{opacity:1,transform:"translateY(0)"}}})};function y(e){var t=e.author,n=e.shouldShow,r=e.columnToken,o=e.horizontalPadding,c=(0,s._)((0,h.useState)(!1),2),l=c[0],y=c[1],C=(0,s._)((0,h.useState)(!1),2),S=C[0],I=C[1],A=(0,s._)((0,h.useState)(!1),2),b=A[0],w=A[1],Z=(0,h.useRef)(null),x=(0,h.useRef)(),k=(0,a.useSelector)(function(e){return e.entities.users[null==t?void 0:t.urlToken]}),R=T({ref:x,horizontalPadding:o}),N=R.left,O=R.right,P=(0,m.useTracker)().trackEvent,D=(0,h.useCallback)(function(e){I(!0),Z.current&&clearTimeout(Z.current),Z.current=setTimeout(function(){w(!0),I(!1),e&&e()},300)},[]);(0,h.useEffect)(function(){return function(){Z.current&&clearTimeout(Z.current)}},[]),(0,h.useEffect)(function(){N&&!l&&n&&y(!0)},[N,l,n]),(0,h.useEffect)(function(){if(l&&!S&&!b){var e=setTimeout(function(){D()},5e3);return function(){return clearTimeout(e)}}},[l,S,b,D]);var L=(0,d.A)(function(){P({eventType:"Click",action:"Follow",elementLocation:{type:"Button",moduleId:"subscribe_attention_guide",content:{type:"User",token:null==t?void 0:t.urlToken,id:null==t?void 0:t.id}}},{configMap:{column_token:r}}),D()});return(null==k?void 0:k.isFollowing)?null:n&&l?(0,i.BX)(i.HY,{children:[(0,i.tZ)("div",{ref:x,css:{width:"100%"}}),(0,i.tZ)(m.ZAEnv,{content:{type:"User",id:null==t?void 0:t.id,token:null==t?void 0:t.urlToken},moduleId:"subscribe_attention_guide",extra:{configMap:{column_token:r}},children:(0,i.BX)(m.ZAShow,{zaType:"Popup",as:_.kC,alignItems:"center",justifyContent:"space-between",p:"16px 20px",bg:"MapUIFrame99A",minWidth:500,css:function(e){return E(e,{left:N,right:O,isClosing:S,isOffscreen:b})},children:[(0,i.BX)(_.kC,{alignItems:"center",children:[(0,i.tZ)(u.qE,{size:54,url:t.avatarUrl,alt:""}),(0,i.BX)(_.xu,{ml:"10px",children:[(0,i.tZ)(_.xv,{fontSize:"16px",fontWeight:"bold",color:"MapText02A",mb:1,children:t.name}),(0,i.tZ)(_.xv,{fontSize:"14px",color:"MapText04A",children:"关注作者，更多优质专栏等你发现"})]})]}),(0,i.BX)(_.kC,{alignItems:"center",children:[(0,i.BX)(g.Z,{useCustomZa:!0,type:t.type||"people",id:t.urlToken||t.id,isFollowing:t.isFollowing,onToggleFollow:L,css:function(e){return{width:80,minWidth:80,padding:0,color:e.colors.GBK99A,backgroundColor:e.colors.MapBrand,whiteSpace:"nowrap","&:hover":{backgroundColor:e.colors.MapBrand}}},children:[(0,i.tZ)(p.ZP,{text:!0,center:!0,css:{width:16,height:16,marginRight:4}}),"关注"]}),(0,i.tZ)(f.ZP,{size:18,css:function(e){return{marginLeft:18,fill:e.colors.MapText07A,cursor:"pointer"}},onClick:D})]})]})})]}):(0,i.tZ)("div",{ref:x,css:{width:"100%"}})}var C=n(9338),S=n(30971),I=n(17347),A=n(9539),b=n(4667),w=n.n(b)()(function(){return new I.h5("FollowColumnAuthorPopup")});function Z(e){var t,n,r=e.id,o=e.shouldCheckLimit,i=(0,s._)((0,h.useState)(!1),2),a=i[0],c=i[1],u=(0,d.A)((t=(0,C._)(function(e){var t;return(0,S.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,w().entries()];case 1:if((t=n.sent()).some(function(t){var n=(0,s._)(t,1);return(0,s._)(n[0],1)[0]===e}))return[2,!1];return[2,t.length<3];case 2:return n.sent(),[2,!1];case 3:return[2]}})}),function(e){return t.apply(this,arguments)})),l=(0,d.A)((n=(0,C._)(function(e){return(0,S.__generator)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,w().set([e],{timestamp:Date.now()},(0,A.Z)(Date.now(),1))];case 1:return t.sent(),[3,3];case 2:return console.error("记录弹窗展示失败:",t.sent()),[3,3];case 3:return[2]}})}),function(e){return n.apply(this,arguments)}));return(0,h.useEffect)(function(){var e;(e=(0,C._)(function(){return(0,S.__generator)(this,function(e){switch(e.label){case 0:if(!(r&&o))return[3,3];return[4,u(r)];case 1:if(!e.sent())return[3,3];return[4,l(r)];case 2:e.sent(),c(!0),e.label=3;case 3:return[2]}})}),function(){return e.apply(this,arguments)})()},[u,r,o,l]),a}function x(){var e=(0,s._)((0,h.useState)(!1),2),t=e[0],n=e[1],r=(0,h.useRef)(!1),o=(0,d.A)((0,C._)(function(){var e,t;return(0,S.__generator)(this,function(o){return r.current||(r.current=!0,(e="1"===new URLSearchParams(window.location.search).get("follow_author_popup"))&&(t=window.location.pathname+window.location.search.replace(/[?&]follow_author_popup=1/,"").replace(/^\?&/,"?").replace(/\?$/,""),window.history.replaceState({},document.title,t)),e&&n(!0)),[2]})}));return(0,h.useEffect)(function(){o()},[o]),t}function k(e){var t=e.paidColumnContent,n=(0,o._)(e,["paidColumnContent"]),a=t||{},c=a.author,s=void 0===c?{}:c,u=a.column,l=x(),d=Z({id:null==u?void 0:u.id,shouldCheckLimit:l});return s&&u&&u.id?(0,i.tZ)(y,(0,r._)({shouldShow:d,author:s,columnToken:u.id},n)):null}function R(e){var t=e.type,n=e.id,c=e.followAuthorPopupCanShow,s=(0,o._)(e,["type","id","followAuthorPopupCanShow"]),u=(0,a.useSelector)(function(e){return e.contentColumnCard["".concat(t,"-").concat(n)]})||{},l=u.author,d=void 0===l?{}:l,p=u.urlToken,f=Z({id:null==u?void 0:u.urlToken,shouldCheckLimit:c});return d&&p?(0,i.tZ)(y,(0,r._)({shouldShow:c&&f,author:d,columnToken:p},s)):null}function N(e){var t=e.columnToken,n=e.author,r=Z({id:t,shouldCheckLimit:x()});return n&&t?(0,i.tZ)(y,{shouldShow:r,author:n,columnToken:t}):null}function O(e){var t=e.columnToken,n=e.author,r=e.followAuthorPopupCanShow,o=Z({id:t,shouldCheckLimit:r});return n&&t?(0,i.tZ)(y,{shouldShow:r&&o,author:n,columnToken:t}):null}function P(e){var t=e.paidColumnContent,n=e.type,o=e.id,a=e.isPaidColumn;return t?(0,i.tZ)(k,(0,r._)({},e)):n&&o?(0,i.tZ)(R,(0,r._)({},e)):a?(0,i.tZ)(N,(0,r._)({},e)):(0,i.tZ)(O,(0,r._)({},e))}},74914:function(e,t,n){"use strict";var r=n(22107),o=n(94707),i=n(86325),a=n(85626),c=n(85879),s=function(e){(0,i._)(n,e);var t=(0,a._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"render",value:function(){var e=this.props,t=e.isFollowed,n=e.isFollowing;return t?(0,c.tZ)("span",{className:"FollowStatus",children:n?"相互关注":"关注了你"}):null}}]),n}(n(87363).Component);t.Z=s},87843:function(e,t,n){"use strict";n.d(t,{$:function(){return w},Z:function(){return x}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(57477),l=n(71728),d=n(49899),p=n(85626),f=n(85879),h=n(14168),_=n.n(h),m=n(87363),g=n(61533),T=n(92258),E=n(12592),y=n.n(E),C=n(92769),S=n.n(C);function I(e,t){return t?e.trim():e}var A={useTrim:!0},b={required:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=(arguments.length>1&&arguments[1],(arguments.length>2&&void 0!==arguments[2]?arguments[2]:A).useTrim);return""!==I(e,t)},maxLength:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:A).useTrim;return I(e,n).length<=t},minLength:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:A).useTrim;return I(e,n).length>=t},pattern:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:A).useTrim;return t.test(I(e,n))}};function w(){return function(e){var t,n,r,o;return t=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=o[e];return"function"==typeof i?i.apply(void 0,(0,d._)(n)):void 0},n=e.contextTypes,r=e.defaultProps,o=Object.assign({},e.prototype),Object.assign(e.prototype,{UNSAFE_componentWillMount:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=this.context.form;return o&&(o.attachToForm(this),this.setState({_value:"",_validations:[]})),t.apply(void 0,["componentWillMount"].concat((0,d._)(n)))},componentWillUnmount:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=this.context.form;return o&&o.detachFromForm(this),t.apply(void 0,["componentWillUnmount"].concat((0,d._)(n)))},getValue:function(){var e=(this.state||{})._value;return null==e?"":e},setValue:function(e,t){this.setState({_value:e},function(){"function"==typeof t&&t()})},getValidationMessage:function(){var e=this.getValidationMessages();return e&&e[0]},getValidationClassName:function(){var e=(this.state||{})._validations;return e&&e[0]&&e[0].className},getValidationMessages:function(){var e=(this.state||{})._validations;return null==e?void 0:e.map(function(e){var t=e.message;return t?"string"==typeof t?t:t.message||"未知错误":""})},setValidations:function(e){var t=this;this.setState({_validations:e},function(){return t.forceUpdate()})},clearValidations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=(this.state||{})._validations;n&&n.length>0&&this.setState((0,u._)((0,s._)({},e),{_validations:[]}),t)},addValidation:function(e){this.setState(function(t){var n=t._validations;return{_validations:[e].concat((0,d._)(n||[]))}})},addManualValidation:function(e){this.addValidation({type:"manual",message:e})},validate:function(){this.context.form.validate(this)}}),Object.assign(e,{contextTypes:(0,u._)((0,s._)({},n),{form:_().object}),defaultProps:(0,u._)((0,s._)({},r),{validations:[]})}),e}}var Z=function(e){(0,c._)(n,e);var t=(0,p._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{isValid:!0}),(0,a._)((0,r._)(e),"inputs",[]),(0,a._)((0,r._)(e),"attachToForm",function(t){var n=t.props.name;if(!n||e.inputs.includes(n))throw Error("form input must specify a unqie name, but current is ".concat(n));e.inputs.push(t)}),(0,a._)((0,r._)(e),"detachFromForm",function(t){var n=e.inputs.indexOf(t);-1!==n&&(e.inputs=(0,d._)(e.inputs.slice(0,n)).concat((0,d._)(e.inputs.slice(n+1))))}),(0,a._)((0,r._)(e),"validate",function(e){var t=e.state._value,n=e.props.validations,r=[],o=[];return n?(!Array.isArray(n)&&n.type&&(n=[n]),n.forEach(function(e){var n=e.type,i=e.value,a=e.options,c=b[n];if(!c)throw Error("no ".concat(n," rules, please define it at Form.validateRules"));var s=c(t,i,a);y()(s)?o=(0,d._)(o).concat([s.then(function(){},function(){r.push(e)})]):s||(r=(0,d._)(r).concat([e]))}),Promise.all(o).then(function(){return e.setValidations(r),r})):r}),(0,a._)((0,r._)(e),"handleSubmit",function(t){t.preventDefault();var n=e.props,r=n.onPreSubmit,o=n.onSubmit,i=n.isWechat;if(r(),i){new Promise(function(t){var n=e.inputs.find(function(e){return"username"===e.props.name});n&&!n.state._value&&(0,g.findDOMNode)(n.inputEl).value&&n.handleChange({target:{value:(0,g.findDOMNode)(n.inputEl).value}});var r=e.inputs.find(function(e){return"password"===e.props.name});r&&!r.state._value&&n&&(0,g.findDOMNode)(n.inputEl).value&&r.handleChange({target:{value:(0,g.findDOMNode)(r.inputEl).value}}),t()}).then(function(){e.validateAll().then(function(t){t&&o(e.inputs.reduce(function(e,t){return(0,u._)((0,s._)({},e),(0,a._)({},t.props.name,t.state._value))},{}))})});return}e.validateAll().then(function(t){t&&o(e.inputs.reduce(function(e,t){return(0,u._)((0,s._)({},e),(0,a._)({},t.props.name,t.state._value))},{}))})}),e}return(0,i._)(n,[{key:"getChildContext",value:function(){return{form:{attachToForm:this.attachToForm,detachFromForm:this.detachFromForm,getValue:this.getValue,setValue:this.setValue,validate:this.validate}}}},{key:"componentDidMount",value:function(){}},{key:"validateAll",value:function(){var e=this,t=this.props,n=t.onValid,r=t.onInvalid,o=[],i=[];return this.inputs.forEach(function(t){var n=e.validate(t);y()(n)?i=(0,d._)(i).concat([n.then(function(e){o=(0,d._)(o).concat((0,d._)(e))})]):n&&(o=(0,d._)(o).concat((0,d._)(n)))}),Promise.all(i).then(function(){var t=0===o.length;return e.setState({isValid:t},function(){t?n():r(o.map(function(e){return e.message}))}),t})}},{key:"render",value:function(){var e=S()(this.props,["onValid","onInvalid","onSubmit","onPreSubmit","isWechat","dispatch"]),t=e.children,n=e.onRef,r=(0,l._)(e,["children","onRef"]);return(0,f.tZ)("form",(0,u._)((0,s._)({noValidate:!0,onSubmit:this.handleSubmit,ref:n},r),{children:t}))}}]),n}(m.Component);(0,a._)(Z,"childContextTypes",{form:_().object}),(0,a._)(Z,"propTypes",{onValid:_().func,onInvalid:_().func,onSubmit:_().func,onPreSubmit:_().func}),(0,a._)(Z,"validateRules",b),(0,a._)(Z,"defaultProps",{onValid:function(){},onInvalid:function(){},onSubmit:function(){},onPreSubmit:function(){}});var x=(0,T.connect)(function(e){return{isWechat:e.env.userAgent.Wechat}})(Z)},75616:function(e,t,n){"use strict";n.d(t,{ZP:function(){return m},pZ:function(){return _.pZ}});var r=n(55164),o=n(94009),i=n(85879),a=n(7835),c=n(14914),s=n(55536),u=n(91986),l=n(80714);n(1641);var d=n(68320);n(15336);var p=n(85576),f=n(99281),h=n(84954),_=n(53171),m=(0,s.compose)(c.withRouter,p.Z,h.ru)(function(e){var t=e.location,n=e.authRequired,c=e.realNameRequired,s=t.query,p=(0,o._)((0,f.j1)(_.dv),1)[0],h=(0,o._)((0,f.j1)(_.Uq),1)[0];return(0,a.b)(function(){_.uL.checkOpenWritePinModal=function(e){n(function(){return c(function(){e()})()})()}}),(0,a.b)(function(){if(window.location.origin==="https://".concat(l.Z.wwwHost)){if("writepin"in s){setTimeout(_.pZ,1e3);return}if("ask"in s){setTimeout(_.Nb,1e3);return}}}),(0,i.BX)(i.HY,{children:[p.open&&(0,i.tZ)(d.Z,{show:!0,onClose:_.HU,selectShown:!0,children:(0,i.tZ)("div",{style:{display:"none"}})}),h.open&&(0,i.tZ)(u.D3,(0,r._)({show:h.open,onClose:_.i_},h.props))]})})},53171:function(e,t,n){"use strict";n.d(t,{HU:function(){return c},Nb:function(){return a},Uq:function(){return i},dv:function(){return o},i_:function(){return l},pZ:function(){return u},uL:function(){return s}});var r=n(99281),o=(0,r.n2)({open:!1}),i=(0,r.n2)({open:!1,props:null}),a=function(){o.current={open:!0}},c=function(){o.current={open:!1}},s={checkOpenWritePinModal:function(e){e()}},u=function(e){s.checkOpenWritePinModal(function(){i.current={open:!0,props:null!=e?e:null}})},l=function(){i.current={open:!1,props:null}}},32e3:function(e,t,n){"use strict";n.d(t,{FA:function(){return m},VW:function(){return g},iH:function(){return _}});var r=n(94009),o=n(85879),i=n(87363),a=n(91850),c=n(65733),s=n(7835),u=n(83537),l=n(88329),d=n.n(l),p=n(66263),f=(0,i.createContext)(null),h=(0,i.createContext)(!1),_=function(e){var t=e.children,n=(0,r._)((0,a.k)(!1),2),s=n[0],u=n[1],l=u.on,d=u.off,p=(0,i.useRef)({authModalOpenCount:0,firstGuideConsumed:!1}),_=(0,c.A)(function(e){e?(p.current.authModalOpenCount++,l()):d()}),m=(0,c.A)(function(){p.current.firstGuideConsumed=!0});return(0,o.tZ)(f.Provider,{value:(0,i.useState)({statusRef:p,collectModalOpen:_,consumeFirstGuide:m})[0],children:(0,o.tZ)(h.Provider,{value:s,children:t})})},m=function(){var e=(0,i.useContext)(f);(0,s.b)(function(){return null==e||e.collectModalOpen(!0),function(){null==e||e.collectModalOpen(!1)}})},g=function(e){var t=(0,i.useContext)(f),n=(0,i.useContext)(h);(0,u.K)(function(){if(!t)return d();var r=t.consumeFirstGuide,o=t.statusRef.current,i=o.authModalOpenCount,a=o.firstGuideConsumed;n||1!==i&&0!==i||a||!(window.scrollY<p.BR)||(r(),e())},n?null:0)}},33510:function(e,t,n){"use strict";n.d(t,{A:function(){return o},q:function(){return P}});var r=n(32e3),o=function(){return(0,r.FA)(),null},i=n(85879),a=n(81037),c=n(3028),s=n(94009),u=n(15021),l=n(87363),d=n.n(l),p=n(32210),f=n(91850),h=n(36892),_=n(65733),m=n(24405),g=n(24486),T=n(87641),E=n(63638),y=n.p+"assets/liukanshan-peek.a71ecf3e.png",C=function(e){var t=e.onLoginClick,n=e.onXMarkClick,r=(0,m.F)().colors;return(0,i.tZ)(E.ZAEnv,{block:"bottom_layer",children:(0,i.BX)(E.ZAShow,{as:T.xu,bg:"GBK99A",p:"32px 20px",css:{borderRadius:4},zaType:"Popup",children:[(0,i.tZ)(E.ZAClick,{zaType:"Button",zaText:"关闭",as:g.ZP,size:12,css:{position:"absolute",right:12,top:12,color:r.GBK06A,cursor:"pointer"},onClick:n}),(0,i.tZ)(T.Ee,{css:{position:"absolute",right:0,top:44},width:82,src:y}),(0,i.BX)(T.xv,{as:"span",fontWeight:"bold",fontSize:17,color:"GBK02A",children:["登录即可查看",(0,i.tZ)(T.xv,{as:"span",color:"GBL01A",children:" 超5亿 "}),"专业优质内容"]}),(0,i.tZ)(T.xv,{color:"GBK03A",lineHeight:1.6,mt:12,fontSize:14,pr:36,children:"超 5 千万创作者的优质提问、专业回答、深度文章和精彩视频尽在知乎。"}),(0,i.tZ)(E.ZAClick,{zaType:"Button",zaText:!0,as:a.ZP,css:{marginTop:24,width:"100%",position:"relative"},preset:"primary",onClick:function(){t(),n()},color:"blue",children:"立即登录/注册"})]})})},S={from:{opacity:0,translateY:4},enter:{opacity:1,translateY:0},leave:{opacity:0,translateY:4},config:{ease:"easeOut",duration:.3}},I=(0,c.Z)(null)(function(e){var t=e.onLoginClick,n=(0,s._)((0,f.k)(!1),2),r=n[0],o=n[1],a=(0,l.useRef)(null),c=(0,h.N)(function(){window.scrollY>700&&o.on()},100),d=(0,_.A)(function(){var e;o.off(),null===(e=a.current)||void 0===e||e.unsubscribe()});return(0,l.useEffect)(function(){return a.current=(0,p.subscribe)("scroll",c),function(){var e;null===(e=a.current)||void 0===e||e.unsubscribe()}},[c]),(0,i.tZ)(u.Z,{target:null,isOpen:r,animation:S,css:{position:"fixed",bottom:50,right:64,width:336,zIndex:2},arrowed:!1,children:(0,i.tZ)(C,{onLoginClick:t,onXMarkClick:d})})}),A=n(10748),b=n(66980),w=Object.assign,Z=Object.assign,x=Object.assign,k=Object.assign,R=[{Icon:function(e){return d().createElement(b.Z,w({width:"28",height:"28",fill:"none",viewBox:"0 0 28 28"},e),d().createElement("circle",{cx:"14",cy:"14",r:"14",fill:"url(#id-2307047740-a)"}),d().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M11.111 7.972c-.181 0-.506.22-.506.734v7.627a.583.583 0 1 1-1.167 0v-3.957H7.591a.77.77 0 0 0-.008.114v5.81a.77.77 0 0 0 .008.115H10.02c.322 0 .584.261.584.583v.685c0 .513.325.733.506.733h7.632c.181 0 .506-.22.506-.733V8.706c0-.513-.325-.734-.506-.734h-7.631Zm-1.673 11.61v.1c0 .942.65 1.901 1.673 1.901h7.632c1.022 0 1.673-.959 1.673-1.9V8.706c0-.942-.65-1.9-1.673-1.9h-7.631c-1.023 0-1.674.958-1.674 1.9v2.503h-2.09c-.436 0-.674.338-.768.527a1.71 1.71 0 0 0-.164.754v5.81c0 .264.052.532.164.755.094.188.332.527.768.527h2.09Zm2.811-8.693c0-.322.261-.584.584-.584h3.889a.583.583 0 0 1 0 1.167h-3.89a.583.583 0 0 1-.583-.583Zm.584 2.139a.583.583 0 0 0 0 1.166h3.889a.583.583 0 0 0 0-1.166h-3.89Zm-.584 3.305c0-.322.261-.583.584-.583h2.333a.583.583 0 1 1 0 1.166h-2.333a.583.583 0 0 1-.584-.583Zm-4.623 2.205-.001-.002v.002Zm0-6.285-.001.001v-.001Z",clipRule:"evenodd"}),d().createElement("defs",null,d().createElement("linearGradient",{id:"id-2307047740-a",x1:"1.5",x2:"26",y1:"-2",y2:"32",gradientUnits:"userSpaceOnUse"},d().createElement("stop",{stopColor:"#CDE1FF"}),d().createElement("stop",{offset:".155",stopColor:"#D5E5FE",stopOpacity:".869"}),d().createElement("stop",{offset:".758",stopColor:"#E2E2FF",stopOpacity:".256"}),d().createElement("stop",{offset:".942",stopColor:"#E5E1FF",stopOpacity:".115"}))))},text:"更懂你的优质内容"},{Icon:function(e){return d().createElement(b.Z,Z({width:"28",height:"28",fill:"none",viewBox:"0 0 28 28"},e),d().createElement("circle",{cx:"14",cy:"14",r:"14",fill:"url(#id-2832850787-a)"}),d().createElement("path",{stroke:"#06F",strokeWidth:"1.167",d:"M20.028 12.444c0 3.082-2.665 5.64-6.028 5.64-3.363 0-6.028-2.558-6.028-5.64 0-3.081 2.665-5.639 6.028-5.639 3.363 0 6.028 2.558 6.028 5.64Z"}),d().createElement("path",{stroke:"#06F",strokeLinecap:"round",strokeWidth:"1.167",d:"M10.111 19.055v1.804c0 .44.445.74.854.577l2.573-1.029c.297-.119.628-.119.924 0l2.574 1.03a.622.622 0 0 0 .853-.578v-1.804"}),d().createElement("path",{stroke:"#06F",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.167",d:"M11.666 12.574c.273-.348.549-.693 1.152-.746 1.214-.106 1.328 1.189 2.542 1.082.61-.053.885-.406 1.162-.758"}),d().createElement("defs",null,d().createElement("linearGradient",{id:"id-2832850787-a",x1:"1.5",x2:"26",y1:"-2",y2:"32",gradientUnits:"userSpaceOnUse"},d().createElement("stop",{stopColor:"#CDE1FF"}),d().createElement("stop",{offset:".155",stopColor:"#D5E5FE",stopOpacity:".869"}),d().createElement("stop",{offset:".758",stopColor:"#E2E2FF",stopOpacity:".256"}),d().createElement("stop",{offset:".942",stopColor:"#E5E1FF",stopOpacity:".115"}))))},text:"更专业的大咖答主"},{Icon:function(e){return d().createElement(b.Z,x({width:"28",height:"28",fill:"none",viewBox:"0 0 28 28"},e),d().createElement("circle",{cx:"14",cy:"14",r:"14",fill:"url(#id-2666423292-a)"}),d().createElement("path",{fill:"#06F",d:"m8.077 17.025.408-.417a.583.583 0 0 1 .148.593l-.556-.176Zm2.268 1.414-.174-.557a.583.583 0 0 1 .37.007l-.196.55Zm-2.222.694.174.557-.174-.557Zm-.54-.542-.557-.176.556.176Zm-.653-5.602c0 1.397.586 2.672 1.555 3.62l-.816.833c-1.175-1.149-1.906-2.718-1.906-4.453H6.93Zm5.639-5.25c-3.15 0-5.64 2.385-5.64 5.25H5.764c0-3.579 3.083-6.417 6.806-6.417V7.74Zm5.639 5.25c0-2.865-2.489-5.25-5.64-5.25V6.572c3.723 0 6.806 2.838 6.806 6.417h-1.166Zm-5.64 5.25c3.151 0 5.64-2.386 5.64-5.25h1.166c0 3.579-3.083 6.416-6.805 6.416V18.24Zm-2.026-.35c.628.226 1.31.35 2.027.35v1.166a7.16 7.16 0 0 1-2.421-.418l.394-1.098Zm-2.593.687 2.222-.694.348 1.113-2.222.695-.348-1.114Zm.19.19a.152.152 0 0 0-.19-.19l.348 1.114a1.015 1.015 0 0 1-1.271-1.275l1.113.352Zm.494-1.565-.494 1.566-1.113-.352.494-1.565 1.113.35Z"}),d().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M20.423 12.742a.583.583 0 0 1 .764.311c.376.893.542 1.879.454 2.876-.09 1.023-.478 2.03-1.065 2.917a.39.39 0 0 1-.005.006l.003.012a.7.7 0 0 1 .006.028l.257 1.249.002.011c.065.353-.06.7-.337.914a.943.943 0 0 1-.936.117l-1.064-.42-.015-.006a.083.083 0 0 0-.027-.008c-.004 0-.013 0-.034.004a1.31 1.31 0 0 0-.276.114l-.008.005c-.936.446-2.05.612-3.032.526a6.05 6.05 0 0 1-1.83-.46.584.584 0 0 1 .457-1.074c.473.201.972.327 1.475.371.795.07 1.695-.068 2.424-.415l.004-.002c.277-.137.745-.37 1.297-.137l.668.264-.165-.806a1.155 1.155 0 0 1 .17-.948c.493-.746.799-1.566.869-2.364a4.877 4.877 0 0 0-.367-2.32.583.583 0 0 1 .31-.765Z",clipRule:"evenodd"}),d().createElement("defs",null,d().createElement("linearGradient",{id:"id-2666423292-a",x1:"1.5",x2:"26",y1:"-2",y2:"32",gradientUnits:"userSpaceOnUse"},d().createElement("stop",{stopColor:"#CDE1FF"}),d().createElement("stop",{offset:".155",stopColor:"#D5E5FE",stopOpacity:".869"}),d().createElement("stop",{offset:".758",stopColor:"#E2E2FF",stopOpacity:".256"}),d().createElement("stop",{offset:".942",stopColor:"#E5E1FF",stopOpacity:".115"}))))},text:"更深度的互动交流"},{Icon:function(e){return d().createElement(b.Z,k({width:"28",height:"28",fill:"none",viewBox:"0 0 28 28"},e),d().createElement("circle",{cx:"14",cy:"14",r:"14",fill:"url(#id-2355950134-a)"}),d().createElement("path",{stroke:"#06F",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.167",d:"M15.457 8.089H9.29a1.2 1.2 0 0 0-1.2 1.2v9.42a1.2 1.2 0 0 0 1.2 1.2h9.422a1.2 1.2 0 0 0 1.2-1.2v-6.167M13.999 14.002l5.835-5.836"}),d().createElement("defs",null,d().createElement("linearGradient",{id:"id-2355950134-a",x1:"1.5",x2:"26",y1:"-2",y2:"32",gradientUnits:"userSpaceOnUse"},d().createElement("stop",{stopColor:"#CDE1FF"}),d().createElement("stop",{offset:".155",stopColor:"#D5E5FE",stopOpacity:".869"}),d().createElement("stop",{offset:".758",stopColor:"#E2E2FF",stopOpacity:".256"}),d().createElement("stop",{offset:".942",stopColor:"#E5E1FF",stopOpacity:".115"}))))},text:"更高效的创作环境"}],N=function(e){var t=e.onLoginClick,n=e.onMouseEnter,r=e.onMouseLeave;return(0,i.tZ)(E.ZAEnv,{block:"top_layer",children:(0,i.BX)(E.ZAShow,{zaType:"Popup",as:T.xu,p:24,fontSize:14,css:{borderRadius:4},width:361,bg:"GBK99A",onMouseEnter:n,onMouseLeave:r,children:[(0,i.tZ)(T.xv,{fontWeight:"bold",children:"登录知乎，您可以享受以下权益："}),(0,i.tZ)(T.kC,{mt:"24px",flexWrap:"wrap",justifyContent:"space-between",css:{"@supports (gap: 16px)":{gap:"16px"}},children:R.map(function(e){var t=e.Icon,n=e.text;return(0,i.BX)(T.kC,{alignItems:"center",css:{flex:"none","@supports not (gap: 16px)":{marginTop:16}},children:[(0,i.tZ)(t,{width:"28px"}),(0,i.tZ)(T.xv,{ml:"6px",children:n})]},n)})}),(0,i.tZ)(E.ZAClick,{zaType:"Button",zaText:!0,as:a.ZP,css:{marginTop:16,width:"100%"},preset:"primary",onClick:t,color:"blue",children:"立即登录/注册"})]})})},O=function(e){var t=e.onLoginClick,n=(0,l.useRef)(null),o=(0,s._)((0,f.k)(!1),2),c=o[0],d=o[1],p=d.on,h=d.off,m=(0,l.useRef)(!1);(0,r.VW)(p);var g=(0,_.A)(function(){h(),null==t||t()}),T=(0,_.A)(function(){c&&h()}),y=(0,_.A)(function(){p(),m.current=!0}),C=(0,_.A)(function(){m.current=!1,setTimeout(function(){m.current||h()},300)});return(0,i.BX)(i.HY,{children:[(0,i.tZ)(E.ZAShow,{as:a.ZP,zaType:"Button",zaText:"login",preset:"primary",color:"blue",css:{marginRight:16},ref:n,onMouseEnter:y,onMouseLeave:C,onClick:g,children:"登录/注册"}),(0,i.tZ)(A.Z,{onScrollDown:T,threshold:20}),(0,i.tZ)(u.Z,{isOpen:c,target:n.current,placement:"bottom",onClose:h,globalClose:!0,listenResize:!0,arrowed:!0,fixed:!0,children:(0,i.tZ)(N,{onLoginClick:g,onMouseEnter:y,onMouseLeave:C})})]})},P=(0,c.Z)((0,i.tZ)(a.ZP,{className:"AppHeader-login",children:"登录"}))(function(e){var t=e.onClick;return(0,i.BX)(i.HY,{children:[(0,i.tZ)(O,{onLoginClick:t}),(0,i.tZ)(I,{onLoginClick:t})]})})},26609:function(e,t,n){"use strict";n.d(t,{Z:function(){return et}});var r=n(85879),o=n(14168),i=n.n(o),a=n(87363),c=n(63638),s=n(20857),u=n(9338),l=n(22107),d=n(94707),p=n(87320),f=n(86325),h=n(55164),_=n(71728),m=n(85626),g=n(30971),T=n(55698),E=n(72111),y=n(42849),C=n(43299),S=n(9219),I=n(27723),A=n(6779),b=n(13707),w=n(34473),Z=n(82644),x=n(67814),k=n.n(x),R=n(4667),N=n.n(R),O=n(92258),P=n(14914),D=n(87641),L=n(55536),M=n(69383),B=n(1733),U=n(25452),G=n(7181),F=n(97476),H=n(80714),z=n(45842),q=n(36591),V=n(40382),W=n(7407),X=n(55344),K=n(83821),j=function(e){var t=e.href,n=e.className,o=(0,_._)(e,["href","className"]);return(0,r.tZ)(E._o,{zaText:!0,children:(0,r.tZ)(B.sN,(0,h._)({tag:D.rU,className:k()("AppHeaderProfileMenu-item",n),css:function(e){return{color:e.colors.GBL05A,fontSize:"14px"}},href:(0,q.Z)(t)},o))})},Y=function(e){(0,f._)(n,e);var t=(0,m._)(n);function n(){var e;return(0,l._)(this,n),e=t.apply(this,arguments),(0,p._)((0,s._)(e),"state",{isMenuOpen:!1}),(0,p._)((0,s._)(e),"handleMenuOpen",function(){M.Z.trackEvent((0,s._)(e),{id:2764,action:"Click"}),e.setState({isMenuOpen:!0}),e.closeCreatorHint()}),(0,p._)((0,s._)(e),"handleMenuClose",function(){e.setState({isMenuOpen:!1}),e.openCreatorHint()}),(0,p._)((0,s._)(e),"handleCreatorHintRef",function(t){e.creatorHintPopover=t,e.openCreatorHint()}),(0,p._)((0,s._)(e),"openCreatorHint",function(){var t=e.props,n=t.creatorNotification,r=t.ua;t.currentUserIsCreator||!(n.invitationBubble>0)||!e.creatorHintPopover||e.props.routes.find(function(e){return"Creator"===e.name})||r.Mobile||r.Tablet||r.Zhihu||(e.creatorHintPopover.open(),e.trackCreatorHintCardshow())}),(0,p._)((0,s._)(e),"closeCreatorHint",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.closeForever;e.creatorHintPopover.close(),void 0!==n&&n&&e.props.readNotification("invitation_bubble")}),(0,p._)((0,s._)(e),"trackCreatorHintCardshow",N()(function(){M.Z.trackCardShow(null,{id:4229})})),(0,p._)((0,s._)(e),"handleCreatorHintCloseIconClick",function(){M.Z.trackEvent(null,{id:4232,action:"Click"}),e.closeCreatorHint({closeForever:!0})}),e}return(0,d._)(n,[{key:"componentDidMount",value:function(){this.loadData()}},{key:"loadData",value:function(){var e=this;return(0,u._)(function(){return(0,g.__generator)(this,function(t){switch(t.label){case 0:return[4,e.props.loadSwitches(["isCreator"])];case 1:if(!t.sent().isCreator)return[3,3];return[4,e.props.loadCreatorApplyStatus()];case 2:t.sent(),t.label=3;case 3:return e.props.creatorNotification.invitationBubble>0&&e.openCreatorHint(),[2]}})})()}},{key:"render",value:function(){if(!this.props.isLogin)return null;var e=this.props,t=e.className,n=e.currentUser,o=e.currentUserIsCreator,i=e.creatorNotification,a=e.location,s=this.state.isMenuOpen,u=H.Z.isMobileEntry?24:34,l="https://".concat(H.Z.wwwHost,"/").concat("organization"===n.userType?"org":"people","/").concat(n.urlToken||n.id),d=(0,r.BX)(c.ZAClick,{as:U.ZP,zaType:"Image",zaAction:"Unknown",zaText:"用户头像",className:"AppHeader-profileEntry",preset:"plain",children:[(0,r.tZ)(T.qE,{className:"AppHeader-profileAvatar",size:u,url:n.avatarUrl,alt:"点击打开".concat(n.name,"的主页"),css:{borderRadius:"100%"}}),!s&&o&&i.accessed>0&&(0,r.tZ)("div",{className:"AppHeader-profileAvatarRedDot"})]});return(0,r.BX)(K.ZP,{placeholder:d,children:[(0,r.BX)(B.ZP,{className:t,menuClassName:"AppHeaderProfileMenu",menuContainerClassName:"AppHeaderProfileMenu-container",positionStatus:"fixed",toggler:d,boundary:{padding:16},onOpen:this.handleMenuOpen,onClose:this.handleMenuClose,arrowed:!0,children:[(0,r.BX)(j,{href:l,children:[(0,r.tZ)(y.Z,{size:16}),"我的主页"]}),(0,r.BX)(j,{href:"https://".concat(H.Z.wwwHost,"/recent-viewed"),children:[(0,r.tZ)(C.Z,{size:16}),"最近浏览"]}),(0,r.BX)(j,{href:"",onClick:function(e){e.preventDefault(),(0,F.Gb)()},children:[(0,r.tZ)(S.Z,{}),"无障碍"]}),(0,r.BX)(j,{href:(0,F.cg)((null==a?void 0:a.pathname)||""),children:[(0,r.tZ)(I.Z,{}),"关怀版"]}),(0,r.BX)(j,{href:"https://".concat(H.Z.wwwHost,"/settings/profile"),children:[(0,r.tZ)(A.Z,{size:16}),"设置"]}),(0,r.BX)(j,{href:"https://".concat(H.Z.wwwHost,"/logout"),children:[(0,r.tZ)(b.Z,{size:16}),"退出"]})]}),(0,r.BX)(G.Z,{className:"AppHeaderProfileMenu-creatorHintPopover",toggler:(0,r.tZ)("div",{className:k()("AppHeaderProfileMenu-creatorHintToggler",H.Z.isMobileEntry&&"AppHeaderProfileMenu-creatorHintToggler--small")}),toggleEvent:null,targetClassName:"AppHeaderProfileMenu-creatorHint",placement:"bottom",positionStatus:"fixed",globalClose:!1,boundary:{padding:16},ref:this.handleCreatorHintRef,arrowed:!0,children:[(0,r.tZ)(w.Z,{className:"AppHeaderProfileMenu-creatorHintCreatorIcon",size:20}),(0,r.tZ)("div",{className:"AppHeaderProfileMenu-creatorHintText",children:"你已被邀请入驻创作中心，"}),(0,r.tZ)("a",{className:"AppHeaderProfileMenu-creatorHintLink",href:"https://".concat(H.Z.wwwHost,"/creator"),"data-za-detail-view-id":4231,children:"立即入驻"}),(0,r.tZ)("div",{className:"AppHeaderProfileMenu-creatorHintCloseContainer",onClick:this.handleCreatorHintCloseIconClick,children:(0,r.tZ)(Z.ZP,{size:20})})]})]})}}]),n}(a.PureComponent);(0,p._)(Y,"propTypes",{currentUser:i().object,currentUserIsCreator:i().bool});var Q=(0,L.compose)(z.Z,P.withRouter,(0,O.connect)(function(e){return{ua:(0,W.Uh)(e),currentUserIsCreator:e.switches.isCreator,creatorNotification:(0,V.EtQ)(e).notification||{}}},{readNotification:V.iGT,loadSwitches:X.X2,loadCreatorApplyStatus:V.bGQ}))(Y),J=n(33510);n(50953);var $=n(45471);function ee(e){var t=e.currentUser,n=e.enableGuidesForLogin;return t&&"guest"!==t.userType?(0,r.tZ)(Q,{className:"AppHeader-profileMenu"}):(0,r.tZ)($.Vy,{loginButtonWithZa:void 0!==n&&n?(0,r.tZ)(J.q,{}):(0,r.tZ)(c.ZAShow,{as:U.ZP,className:"AppHeader-login",zaType:"Button",zaText:"login",color:"blue",css:{whiteSpace:"nowrap"},children:"登录/注册"})})}var et=(0,a.memo)(ee);ee.propTypes={currentUser:i().object}},94307:function(e,t,n){"use strict";n.d(t,{D5:function(){return g},pl:function(){return y}});var r=n(55164),o=n(57477),i=n(71728),a=n(94009),c=n(85879),s=n(13649),u=n(71549),l=n.n(u),d=n(87363),p=n(87641),f=n(63638),h=n(55462),_=function(e,t){if(!t)return e;var n=(0,a._)(e.split("#"),2),r=n[0],o=n[1],i=r+(r.includes("?")?"&":"?")+t;return o?i+"#"+o:i},m=function(e,t){var n,r=function(){var n,r,o,i,a,c=null,s=null;t.WxMiniProgram?c=null===(r=window.wx)||void 0===r?void 0:null===(o=r.miniProgram)||void 0===o?void 0:o.navigateTo:t.JDMiniProgram&&(c=null===(i=window.jd)||void 0===i?void 0:null===(a=i.miniProgram)||void 0===a?void 0:a.navigateTo);var u=null===(n=/\/topic\/(\d+)/.exec(e))||void 0===n?void 0:n[1];if(u&&(t.WxMiniProgram?s="/pages/topic?id=".concat(u):t.JDMiniProgram&&(s="/pages/topic/index?id=".concat(u))),s){null==c||c({url:s});return}/^http(s)?:/.test(e)&&(location.href=e)};!t.WxMiniProgram||(null===(n=window.WeixinJSBridge)||void 0===n?void 0:n.invoke)?r():document.addEventListener("WeixinJSBridgeReady",r,!1)},g=function(e){return/^\w+:\/\//.test(e)||"undefined"==typeof window?e:/^\/\//.test(e)?location.protocol+e:location.origin+e},T=function(e,t){var n=t.params,r=t.onRequestOpen,o=(0,s.n)();return function(t){var i=e.href,a=e.onClick;if(a&&a(t),!t.defaultPrevented){var c=_(g(i),n);if(o.ZhihuHybrid){t.preventDefault(),(0,h.Z)("base/openURL").dispatch({url:c});return}if(o.isMiniProgram){t.preventDefault(),m(c,o);return}(null==r?void 0:r({ua:o,url:c}))&&t.preventDefault()}}},E=function(e,t){var n=t.extra;return{zaType:"Button",zaAction:"OpenUrl",zaEventType:"Click",shouldTrackClick:!0,extra:l()({link:{get url(){return g(e)}}},n)}},y=(0,d.forwardRef)(function(e,t){var n=e.params,a=e.onRequestOpen,s=e.extra,u=(0,i._)(e,["params","onRequestOpen","extra"]);return(0,c.tZ)(f.ZAEvent,(0,o._)((0,r._)({as:p.rU},E(u.href,{extra:s}),u),{ref:t,onClick:T(u,{params:n,onRequestOpen:a})}))})},8282:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(85626),l=n(85879),d=n(16836),p=n(67814),f=n.n(p),h=n(14168),_=n.n(h),m=n(87363),g=n(54674),T=n(99878),E=n(82644),y=n(88423),C=n(72137),S=n(17132),I=n.n(S),A=n(81488),b=n(14804),w=n(14236),Z={top:10,left:20},x={top:0,left:0};function k(){var e=I()(navigator.userAgent).Mobile?x:Z,t=e.top,n=e.left,r=window.innerWidth,o={left:0,top:0,width:r,height:window.innerHeight},i={x:o.left+o.width/2,y:o.top+o.height/2},a=(96+n)*2,c=r,s=0;return r<1e3+a?c=r-a:(c=1e3,s=(r-(1e3+a))/2),{x:i.x,y:i.y,imgContainerWidth:c,imgContainerHeight:o.height-2*t,left:s,top:t}}var R=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(e){var i;return(0,o._)(this,n),i=t.call(this,e),(0,a._)((0,r._)(i),"getBoundingClientRect",function(e,t){var n=t.width,r=t.height,o={top:0,left:0,width:0,height:0},i=1;return e.width>e.height?(o.height=r,i=r/e.height,o.width=e.width*i,o.left="-".concat((o.width-n)/2)):e.width<e.height?(o.width=n,i=n/e.width,o.height=e.height*i,o.top="-".concat((o.height-r)/2)):(o.width=n,o.height=r),o}),(0,a._)((0,r._)(i),"getTransformString",function(e){if(!e||0===e.x&&0===e.y&&1===e.scale)return"";var t="";return(0!==e.x||0!==e.y)&&(t+="translate(".concat(e.x,"px, ").concat(e.y,"px)")),1!==e.scale&&(t+=" scale(".concat(e.scale,")")),t.trim()}),(0,a._)((0,r._)(i),"getParentNode",function(){for(var e,t=i.props.img.parentNode;t&&"BODY"!==t.nodeName;){if(t.matches("[data-thumbnail-list-container]")){e=t;break}t=t.parentNode}return e}),(0,a._)((0,r._)(i),"getChildImgNode",function(e){if(e){var t=e.childNodes,n=i.state.index,r=n;return n>=t.length&&(r=t.length-1),{img:(0,t[r]).querySelector("img[data-thumbnail-image]"),index:r}}}),(0,a._)((0,r._)(i),"setImageElAttr",function(){i.setState({canShowAILabel:!1});var e,t=i.state,n=t.width,r=t.transition,o=i.props,a=o.images,c=o.onClose,s=i.getParentNode(),u=i.getChildImgNode(s);if(!u||!u.img){console.error("[ImageGallery] 找不到缩略图元素",{hasParents:!!s,hasChildren:!!u,imageUrl:null===(e=a[i.state.index])||void 0===e?void 0:e.url,index:i.state.index}),null==c||c();return}var l=u.img.getBoundingClientRect(),d=i.getBoundingClientRect(a[u.index],{width:l.width,height:l.height}),p=i.imgEl.getBoundingClientRect(),f=i.containerClientRect,h=f.left,_=f.top,m={x:p.left+p.width/2-h-d.width/2,y:p.top+p.height/2-_-d.height/2},g=n/d.width;if("transition"===r){i.setState({translate:null,scale:null,opacity:-1,transform:{x:l.left-h,y:l.top-_,scale:1}});return}i.setState({transition:""},function(){i.setState({rect:l,transition:"",width:d.width,height:d.height,translate:m,scale:g,transform:{x:m.x,y:m.y,scale:g}})}),setTimeout(function(){i.setState({transition:"transition",translate:null,scale:null,transform:{x:l.left-h,y:l.top-_,scale:1},opacity:-1})},20)}),(0,a._)((0,r._)(i),"getImageSize",function(e){var t=i.containerClientRect,n=t.imgContainerWidth,r=t.imgContainerHeight,o=e.width,a=e.height,c=!1,s=1;return(e.width>n||e.height>r)&&(e.width>n&&(s=n/e.width,o=e.width*s,a=s*e.height),a>r&&(s=r/a,a*=s,o*=s),c=!0),i.setState({cursorZoomIn:c}),{width:o,height:a}}),(0,a._)((0,r._)(i),"handleResizeCallback",function(){i.containerClientRect=k();var e=i.state.index,t=i.props.images;i.setState((0,s._)({transition:"fixed",transform:{x:0,y:0,scale:1}},i.getImageSize(t[e])))}),(0,a._)((0,r._)(i),"handleClick",function(e){var t=i.state.cursorZoomIn,n=e.target;n&&n.classList&&n.classList.contains("ImageGallery-Img")&&t&&i.setState({previewImage:n}),(n.classList.contains("ImageGallery")||n.classList.contains("ImageGallery-Inner"))&&i.setImageElAttr()}),(0,a._)((0,r._)(i),"handleTransEnd",function(){i.setState({canShowAILabel:!0});var e=i.state,t=e.translate,n=e.scale,r=i.props.onClose;t&&n||r()}),(0,a._)((0,r._)(i),"handlePreviewImageClose",function(){i.setState({previewImage:null},function(){C.Cp()})}),(0,a._)((0,r._)(i),"handleKeyUpCallback",function(e){39===e.keyCode?i.handleCutImage(1):37===e.keyCode&&i.handleCutImage(-1)}),(0,a._)((0,r._)(i),"handleCutImage",function(e){var t=i.state.index+e,n=i.props.images;t<n.length&&t>=0&&i.setState((0,s._)({index:t,transition:"fixed",transform:{x:0,y:0,scale:1}},i.getImageSize(n[t])))}),i.state={canShowAILabel:!1,translate:null,scale:null,url:null,index:e.index||0,width:0,height:0,rect:null,transition:"transition",previewImage:null,transform:{x:0,y:0,scale:1},cursorZoomIn:!1,opacity:1},i.containerClientRect=k(),i}return(0,i._)(n,[{key:"UNSAFE_componentWillMount",value:function(){var e=this.props,t=e.data,n=e.img.getBoundingClientRect();C.Cp();var r=this.containerClientRect,o=r.left,i=r.top,a=this.getBoundingClientRect(t,{width:n.width,height:n.height}),c={left:n.left-o+Number(a.left),top:n.top-i+Number(a.top)};this.setState({rect:a,width:a.width,height:a.height,transform:{x:c.left,y:c.top,scale:1}})}},{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){e.setState((0,s._)({},e.computeTransition(e.props.index)))},20),window.addEventListener("keyup",this.handleKeyUpCallback),window.addEventListener("resize",this.handleResizeCallback)}},{key:"componentWillUnmount",value:function(){C.$Z(),window.removeEventListener("keyup",this.handleKeyUpCallback),window.removeEventListener("resize",this.handleResizeCallback)}},{key:"computeTransition",value:function(e){var t=this.props.images[e],n=this.containerClientRect,r=n.x,o=n.y,i=n.left,a=n.top,c=this.getImageSize(t).width;if(this.imgEl){var s=this.imgEl.getBoundingClientRect(),u=c/s.width,l={x:r-s.width/2-i,y:o-s.height/2-a};return{translate:l,scale:u,transform:{x:l.x,y:l.y,scale:u}}}}},{key:"render",value:function(){var e=this,t=this.props.images,n=this.state,r=n.translate,o=n.index,i=n.width,a=n.height,c=n.transition,s=n.previewImage,u=n.transform,p=n.cursorZoomIn,h=n.opacity,_=this.containerClientRect,m=_.left,C=_.top,S=_.imgContainerWidth,k=_.imgContainerHeight,R=(I()(navigator.userAgent).Mobile?x:Z).left,N=t[o];return(0,l.tZ)(d.Z,{children:(0,l.BX)("div",{className:f()("ImageGallery",{"is-active":r}),onClick:this.handleClick,children:[(0,l.BX)("div",{className:"ImageGallery-Content",style:{width:"".concat(S+(96+R)*2,"px"),height:"".concat(k,"px"),left:"".concat(m,"px"),top:"".concat(C,"px")},children:[!s&&t.length>1&&(0,l.tZ)("a",{className:f()("ImageGallery-arrow-left",{"ImageGallery-arrow-disabled":0===o}),style:{left:"".concat(R,"px")},onClick:function(){return e.handleCutImage(-1)},children:(0,l.tZ)(g.e,{fill:"#fff",size:42})}),(0,l.BX)("div",{className:"ImageGallery-Inner",ref:function(t){e.scrollNode=t},children:[(0,l.tZ)("div",{style:{"anchor-name":"--ImageGallery-Img",position:"absolute",zIndex:2,width:i*u.scale,height:a*u.scale,pointerEvents:"none",left:"50%",top:"50%",marginLeft:-(i*u.scale)/2,marginTop:-(a*u.scale)/2},children:!this.props.disableAILabel&&(0,l.tZ)(b.C,{children:function(){return(0,w.KQ)(t.map(function(e){return e.url}))[N.url]&&e.state.canShowAILabel?(0,l.tZ)(w.tL,{}):null}})}),(0,l.tZ)("img",{ref:function(t){e.imgEl=t},src:(0,y.imgUrl)(N.url,"r"),className:f()("ImageGallery-Img",{"ImageGallery-transition":"transition"===c,"ImageGallery-fixed":"fixed"===c,"ImageGallery-CursorZoomIn":p}),style:{width:i,height:a,transform:this.getTransformString(u),opacity:h},onTransitionEnd:this.handleTransEnd,alt:"preview","data-rawwidth":N.width,"data-rawheight":N.height,"data-thumbnail":N.thumbnail,"data-original":(0,y.imgUrl)(N.url,"r"),"data-actualsrc":(0,y.imgUrl)(N.url,"b")})]}),!s&&t.length>1&&(0,l.tZ)("a",{className:f()("ImageGallery-arrow-right",{"ImageGallery-arrow-disabled":o>=t.length-1}),onClick:function(){return e.handleCutImage(1)},style:{right:"".concat(R,"px")},children:(0,l.tZ)(T.N,{fill:"#fff",size:42})})]}),!s&&(0,l.tZ)("a",{className:"ImageGallery-close",onClick:this.setImageElAttr,children:(0,l.tZ)(E.HN,{fill:"#fff"})}),s&&(0,l.tZ)(A.Z,{img:s,onClose:this.handlePreviewImageClose})]})})}}]),n}(m.Component);(0,a._)(R,"propTypes",{img:_().object.isRequired,data:_().object.isRequired,onClose:_().func.isRequired,disableAILabel:_().bool}),t.Z=R},81488:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(85626),l=n(85879),d=n(16836),p=n(92073),f=n(67814),h=n.n(f),_=n(14168),m=n.n(_),g=n(87363),T=n.n(g),E=n(87641),y=n(88423),C=n(17132),S=n.n(C),I={top:10,left:20},A={top:0,left:0},b=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"scrollerRef",T().createRef()),(0,a._)((0,r._)(e),"state",{transEnded:!1,rect:null,translate:null,scale:null}),(0,a._)((0,r._)(e),"getBoundingClientRect",function(){var t=e.props,n=t.img,r=t.data,o=n.getBoundingClientRect(),i=o.left,a=o.top,c=o.width,s=o.height,u=r.width,l=r.height,d={left:i,top:a,width:c,height:s},p=1;return u>l?(d.height=s,p=s/l,d.width=u*p,d.left=i+(c-d.width)/2,d.top=a+(s-d.height)/2):u<l&&(d.width=c,p=c/u,d.height=l*p,d.left=i+(c-d.width)/2,d.top=a+(s-d.height)/2),d}),(0,a._)((0,r._)(e),"handleClick",function(t){t.stopPropagation(),e.setState({translate:null,scale:null})}),(0,a._)((0,r._)(e),"handleKeyDown",function(t){"Escape"===t.key&&(t.stopPropagation(),t.preventDefault(),e.setState({translate:null,scale:null}))}),(0,a._)((0,r._)(e),"handleTransitionEnd",function(){var t=e.state,n=t.translate,r=t.scale,o=e.props.onClose;n&&r?(e.setState({transEnded:!0}),e.scrollerRef.current.style.overflow="auto"):o()}),e}return(0,i._)(n,[{key:"originalSrc",get:function(){return this.props.img.dataset.original}},{key:"currentSrc",get:function(){var e=this.props.img;return e.currentSrc||e.src}},{key:"UNSAFE_componentWillMount",value:function(){var e=this.props,t=e.img,n=e.isOriginalUrl;this.originalSrc!==this.currentSrc&&(new Image().src=this.originalSrc),this.setState({rect:!1===n?this.getBoundingClientRect():t.getBoundingClientRect()})}},{key:"componentDidMount",value:function(){var e=this;(0,p.disableBodyScroll)(this.scrollerRef.current);var t=this.props.img;setTimeout(function(){return e.setState((0,s._)({},e.computeTransition(e.state.rect,{width:t.dataset.rawwidth||t.naturalWidth})))})}},{key:"componentWillUnmount",value:function(){(0,p.enableBodyScroll)(this.scrollerRef.current)}},{key:"computeTransition",value:function(e,t){var n,r=this.props,o=r.transitionType,i=r.data,a=S()(navigator.userAgent).Mobile?A:I,c=a.top,s=a.left,u={left:0,top:0,width:window.innerWidth,height:window.innerHeight},l={x:u.left+u.width/2,y:u.top+u.height/2},d={width:u.width-2*s,height:u.height-2*c},p={},f={};return 1===o?(p.width=d.width>i.width?i.width:d.width,n=p.width/i.width,p.height=i.height*n,f={x:(d.width-p.width)/2+s,y:p.height<d.height?(d.height-p.height)/2+c:I.top}):(p.width=d.width>t.width?t.width:d.width,n=p.width/e.width,p.height=e.height*n,f={x:l.x-e.width/2,y:(p.height<d.height?l.y:I.top+p.height/2)-e.height/2}),{translate:f,scale:n}}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.img,o=n.isOriginalUrl,i=n.data,a=n.transitionType,c=n.className,s=this.state,u=s.translate,p=s.scale,f=s.rect,_=s.transEnded,m=u&&p,g=1,T="";if(1===a){var C=(S()(navigator.userAgent).Mobile?A:I).left;e=Math.min(window.innerWidth-2*C,i.width);var b=f.width/e;T=m?"translate(".concat(u.x,"px, ").concat(u.y,"px) scale(1) "):"translate(".concat(f.left,"px, ").concat(f.top,"px) scale(").concat(b,") "),g=m?1:0}else T=m?"translate(".concat(u.x,"px ,").concat(u.y,"px) scale(").concat(p,") "):"translate(".concat(f.left,"px,").concat(f.top,"px)");return(0,l.tZ)(d.Z,{children:(0,l.tZ)(E.xu,{className:h()("ImageView",c,{"is-active":m}),style:{paddingBottom:I.top},onClick:this.handleClick,onKeyDown:this.handleKeyDown,children:(0,l.tZ)("div",{className:"ImageView-inner",ref:this.scrollerRef,children:(0,l.tZ)("img",{ref:function(e){t.imgEl=e},src:!1===o?(0,y.imgUrl)(r.dataset.original,"r"):_&&this.originalSrc||this.currentSrc,className:h()("ImageView-img",{"ImageView-transformOrigin":1===a}),style:{width:e||f.width,transform:T,opacity:g},onTransitionEnd:this.handleTransitionEnd,alt:"preview"})})})})}}]),n}(g.Component);(0,a._)(b,"propTypes",{img:m().object.isRequired,onClose:m().func.isRequired}),t.Z=b},87114:function(e,t,n){"use strict";n.d(t,{F:function(){return s}});var r=n(55164),o=n(57477),i=n(85879),a=n(79852),c=n(14236),s=function(e){return(0,i.tZ)(a.Z,(0,o._)((0,r._)({},e),{renderDecoration:function(e,t){return(0,i.tZ)(c.mz,{id:e.src,enabled:"animate"===t})}}))}},44118:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(55164),o=n(71728),i=n(85879),a=n(67814),c=n.n(a),s=n(87363),u=n(25452),l={InputButton:"W2ewFU1c0bx6tahox08q"},d=n(57477),p={InputLike:"EQvEDwRqICOvs_x_kUWW"},f=(0,s.forwardRef)(function(e,t){var n=e.as,a=void 0===n?"div":n,s=e.className,u=e.large,l=e.isFocus,f=(0,o._)(e,["as","className","large","isFocus"]);return(0,i.tZ)(a,(0,d._)((0,r._)({},f),{ref:t,className:c()("InputLike",p.InputLike,s,{"is-focus":l,"is-large":u})}))}),h=(0,s.forwardRef)(function(e,t){var n=e.className,a=e.large,s=(0,o._)(e,["className","large"]);return(0,i.tZ)(f,(0,r._)({as:u.ZP,className:c()("InputButton",l.InputButton,n),large:a,ref:t},s))})},9887:function(e,t,n){"use strict";n.d(t,{Z:function(){return _}});var r=n(87320),o=n(55164),i=n(57477),a=n(71728),c=n(94009),s=n(85879),u=n(17103),l=n(67814),d=n.n(l),p=n(87363),f=n.n(p),h={wrapper:"QZcfWkCJoarhIYxlM_sG",grey:"evPjxqnqXpIBzSRrcIDv",spread:"qfAmOtjvjgHNSfCPTpcX",multiline:"SPwbMsVc_0aH1eDVWflY",large:"ju2X6TRIjoJMT4oPHAtz",disabled:"boPCcYOmq77n3IFk97nE",noPadding:"wwIaO3dKFgOr8Ft1HHUg",Input:"i7cW1UcwT6ThdhTakqFm",validationError:"re7iEHUAbZCEqcG5SwA8"},_=f().forwardRef(function(e,t){var n,l=e.onRef,f=e.className,_=e.targetClassName,m=e.multiline,g=void 0!==m&&m,T=e.grey,E=void 0!==T&&T,y=e.spread,C=void 0!==y&&y,S=e.before,I=e.after,A=e.large,b=void 0!==A&&A,w=e.disabled,Z=e.placeholder,x=e.validationError,k=e.tag,R=e.noPadding,N=void 0!==R&&R,O=e.onFocus,P=e.onBlur,D=(0,a._)(e,["onRef","className","targetClassName","multiline","grey","spread","before","after","large","disabled","placeholder","validationError","tag","noPadding","onFocus","onBlur"]),L=(0,c._)((0,p.useState)(!1),2),M=L[0],B=L[1],U=k||(g?"textarea":"input");return(0,s.BX)("label",{className:d()(f,"Input-wrapper",h.wrapper,(n={"Input-wrapper--grey":E,"Input-wrapper--spread":C,"Input-wrapper--multiline":g,"Input-wrapper--large":b,"Input-wrapper--disabled":w,"Input-wrapper--noPadding":N,"is-focus":M},(0,r._)(n,h.grey,E),(0,r._)(n,h.spread,C),(0,r._)(n,h.multiline,g),(0,r._)(n,h.large,b),(0,r._)(n,h.disabled,w),(0,r._)(n,h.noPadding,N),n)),children:[S,(0,s.tZ)(U,(0,i._)((0,o._)({},D),{disabled:w,className:d()("Input",h.Input,_,(0,r._)({"Input--validationError":!!x},h.validationError,!!x)),placeholder:x||Z,ref:(0,u.q)(t,l),onFocus:function(e){O&&O(e),B(!0)},onBlur:function(e){P&&P(e),B(!1)}})),I]})})},99953:function(e,t,n){"use strict";var r=n(85879),o=n(12684),i=n(87363),a=n(92258),c=n(10416),s=function(){return(0,r.tZ)("div",{className:"LabelContainer-loading"})};t.Z=function(e){var t=e.item,n=t.type,u=t.id,l=t.isLabeled,d=t.endorsements,p=(0,a.useDispatch)(),f=(0,a.useSelector)(function(e){return(0,c.yM)(e,t)});if((0,i.useEffect)(function(){!d&&l&&!f&&n&&u&&p((0,c.WW)(n,u))},[d,p,n,u,l,f]),!d&&!l)return null;var h=(null==d?void 0:d.length)?d:(null==f?void 0:f.length)?f:[];return(null==h?void 0:h.length)?(0,r.tZ)("div",{css:{margin:"16px 0 8px"},children:(0,r.tZ)(o.Ox,{endorsement:h})}):!d&&l?(0,r.tZ)(s,{}):null}},31142:function(e,t,n){"use strict";var r=n(22107),o=n(94707),i=n(86325),a=n(55164),c=n(71728),s=n(85626),u=n(85879),l=n(14168),d=n.n(l),p=n(87363),f=n(14914),h=n(25452),_=function(e){(0,i._)(n,e);var t=(0,s._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"render",value:function(){var e=this.props,t=e.a,n=e.to,r=e.activeClassName,o=(0,c._)(e,["a","to","activeClassName"]);return t?(o.component="a",o.href=n):(o.component=f.Link,o.to=n,o.activeClassName=r),(0,u.tZ)(h.ZP,(0,a._)({},o))}}]),n}(p.Component);_.propTypes={a:d().bool,to:d().string},_.defaultProps={a:!1},t.Z=_},74963:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(79065),a=n(85879),c=n(24405),s=n(41402),u=n(18837),l=n.n(u),d=n(46448),p=n.n(d),f=n(55067),h=n(86110),_=n.n(h),m=n(70874),g=n(30574),T=n.n(g),E=n(87363),y=n(87038);function C(){var e=(0,i._)(["\n          ","\n        "]);return C=function(){return e},e}var S={level:[2,3],slugify:function(e){return e.replace(/\s/g,"-")}},I=new(p())({html:!0}).use(T()).use(_()).use(f.Z,S).use(m.Z,(0,o._)((0,r._)({},S),{containerClass:"toc"})),A=l()(function(e){return I.render(e)}),b=(0,E.memo)(function(e){var t,n=e.text,r=void 0===n?"":n,o=e.className;return(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xB,{styles:(0,s.iv)(C(),(t=(0,c.F)(),"\n.ztext table {\n  border-collapse: collapse;\n  font-size: 15px;\n  margin: 1.4em auto;\n  max-width: 100%;\n  table-layout: fixed;\n  text-align: left;\n  width: 100%;\n\n  &[data-size='small'] {\n    min-width: 260px;\n    width: 40%;\n  }\n\n  &[data-row-style='striped'] tr:nth-of-type(2n + 1) {\n    background: ".concat(t.colors.GBK10A,";\n  }\n\n  td,\n  th {\n    border: 1px solid ").concat(t.colors.GBK08A,";\n    line-height: 24px;\n    height: 24px;\n    padding: 3px 12px;\n  }\n\n  th {\n    background: ").concat(t.colors.GBK09A,";\n    color: ").concat(t.colors.GBK02A,";\n    font-weight: 500;\n  }\n}\n")))}),(0,a.tZ)(y.Z,{className:o,html:A(r)})]})});t.Z=b},86385:function(e,t,n){"use strict";var r=n(85879),o=n(75056),i=n(87641),a=n(63638),c=n(25452),s=n(7181);t.Z=function(){return(0,r.tZ)(a.ZAEnv,{block:"MarkdownTips",children:(0,r.BX)(i.xv,{color:"GBL05A",ml:"24px",fontSize:14,children:[(0,r.tZ)(a.ZAShow,{zaType:"Popup",zaText:"Markdown 输入中"}),"Markdown 语法输入中",(0,r.tZ)(s.Z,{arrowed:!0,toggleEvent:"hover",toggler:(0,r.tZ)(c.ZP,{icon:o.ZP,preset:"plain",css:{marginLeft:5}}),children:(0,r.BX)(i.xu,{height:64,width:253,px:14,py:12,fontSize:14,css:function(e){return{color:e.colors.GBK02A}},children:[(0,r.tZ)(a.ZAShow,{zaType:"Popup",zaText:"Markdown 识别中 - 气泡"}),"可在「工具栏」-「更多」中关闭此模式，支持语法请参考「帮助文档」"," "]})})]})})}},18960:function(e,t,n){"use strict";n.d(t,{Z:function(){return tU}});var r,o,i=n(94009),a=n(85879),c=n(65733),s=n(14168),u=n.n(s),l=n(87363),d=n.n(l),p=n(63638),f=n(31467),h=n(87320),_=n(55164),m=n(57477),g=n(91850),T=n(10840),E=n(20382),y=n(71728),C=n(49274),S=n(87641),I=n(79091),A=n(81956),b=(0,l.createContext)({}),w=function(){return(0,l.useContext)(b)},Z=function(e){var t=e.onClose,n=e.sourceType,r=e.sourceId,o=e.contentId,i=e.insertImage,c=e.setTabType,s=e.initLocalList,u=e.setInitLocalList,d=e.children,p=e.maxImage,f=e.imgAutoRotate,h=e.phoneScanPanelShown,_=e.phoneScanPanelShownSwitch,m=e.setPhoneScanPanelPage,g=e.onUseAiImageFeature,T=e.originalImages;return(0,a.tZ)(b.Provider,{value:(0,l.useMemo)(function(){return{onClose:t,sourceType:n,sourceId:r,contentId:o,insertImage:i,setTabType:c,initLocalList:s,setInitLocalList:u,maxImage:p,imgAutoRotate:f,phoneScanPanelShown:h,phoneScanPanelShownSwitch:_,setPhoneScanPanelPage:m,onUseAiImageFeature:g,originalImages:T}},[t,n,r,o,i,c,s,u,p,f,h,_,m,g,T]),children:d})},x=n(51940),k=n(62641),R=n(80565),N=n(43831),O=n(40326),P=n(88423),D=function(){return new Promise(requestAnimationFrame)},L=function(e,t,n){e({eventType:"Click",action:"Unknown",elementLocation:{type:t,text:n}})},M=function(e){var t=(0,p.useTracker)().trackEvent,n=(0,i._)((0,l.useState)(null),2),r=n[0],o=n[1],c="ready"===r,s=function(n){n.stopPropagation(),"loading"!==r&&(o("loading"),L(t,"Button","加载 gif"),Promise.all([(0,P.loadImage)(e),D().then(D)]).then(function(){o("ready")}).catch(function(){o("error")}))},u=null;return u="loading"===r||c?(0,a.tZ)(x.e1,{className:"MaterialLibrary-GifIcon",onClick:s}):"error"===r?(0,a.tZ)(x.wT,{className:"MaterialLibrary-GifIcon",onClick:s}):(0,a.tZ)(x.OU,{className:"MaterialLibrary-GifIcon",onClick:s}),{isGifReady:c,gifIcon:u}},B=function(){return(0,a.tZ)(S.xu,{color:"GBK02A",width:"96px",css:function(e){return{position:"absolute",left:"4px",bottom:"4px",width:"48px",height:"16px",lineHeight:"16px",textAlign:"center",fontSize:"12px",background:e.colors.GBL05A,color:e.colors.GBK99A,borderRadius:"2px",zIndex:1}},children:"已删除"})},U=function(e){return(0,a.tZ)(p.ZAClick,(0,_._)({as:S.kC,zaType:"Button",zaAction:"Unknown",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",css:{borderRadius:"2px",position:"absolute",lineHeight:"24px"}},e))},G=function(e){var t,n=e.data,r=e.onChooseImage,o=e.deleted,i=e.onDeleteSingleImage,c=e.imageUrl,s=e.poster,u=e.isPrivate,l=void 0!==u&&u,d=(0,p.useTracker)().trackEvent,f=(0,k.D)(),h=(0,O.rD)(c||(null==n?void 0:n.origin)),g=c||(null==n?void 0:n.origin),T=h?g:(0,P.imgUrl)(g,"100w"),E=M(T),y=E.isGifReady,C=E.gifIcon,I=(t=h?s||(null==n?void 0:n.thumbnail):(0,P.imgUrl)(s||(null==n?void 0:n.thumbnail),"100w"),"dynamic"===n.subtype?y?T:t:h?null==n?void 0:n.thumbnail:T);return(0,a.BX)(S.xu,{color:"GBK02A",width:l?"96px":"105px",css:[{display:"inline-block",marginBottom:"10px",marginLeft:l?"14px":"5px",verticalAlign:"top",".MaterialLibrary-GifIcon":{position:"absolute",width:"46px",height:"46px",marginLeft:"-23px",marginTop:"-23px",top:"50%",left:"50%",transition:"0.3s ease-out",transitionProperty:"transform, opacity",transform:"scale(1)",transformOrigin:"center",opacity:"1"}},y&&{".MaterialLibrary-GifIcon":{transform:"scale(0.3)",opacity:"0",width:0,height:0,margin:0}}],children:[(0,a.BX)(S.xu,{width:l?"96px":"105px",height:l?"96px":"105px",css:function(e){return{borderRadius:"2px",cursor:"pointer",position:"relative",backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.08),"&:hover > .MaterialLibrary-imgListItemHover":{display:"flex",backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.3)}}},onClick:function(){o||(r(n),L(d,"Image","".concat((null==n?void 0:n.checked)?"取消选中图片":"选中图片")))},children:[(0,a.tZ)(S.Ee,{src:I,loading:"lazy",size:"100%",css:(0,_._)({position:"absolute",left:0,right:0,objectFit:"cover",borderRadius:"inherit",opacity:o?"0.3":"1"},f)}),(0,a.tZ)(S.xu,{sx:{color:"GBK99A",border:"2px solid",borderColor:"GBL01A"},css:function(e){return(0,_._)({display:(null==n?void 0:n.checked)?"flex":"none",position:"absolute",top:"0",left:"0",right:"0",width:"100%",height:"100%",borderRadius:"inherit"},(null==n?void 0:n.checked)&&{backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.3)})},className:"MaterialLibrary-imgListItemHover",children:o?(0,a.tZ)(U,{zaText:"删除图片",title:"删除",css:function(e){return{bottom:"2px",right:"2px",backgroundColor:e.colors.GBL01A}},onClick:function(e){e.stopPropagation(),i(n)},children:(0,a.tZ)(N.R,{fill:"currentColor",size:18})}):(0,a.tZ)(U,{zaType:"Image",zaText:"选中图片",title:"选中图片",onClick:function(e){e.stopPropagation(),r(n)},css:function(e){return{top:"6px",right:"6px",border:"2px solid ".concat((null==n?void 0:n.checked)?e.colors.GBL01A:e.colors.GBK99A),borderRadius:"50%"}}})}),(null==n?void 0:n.checked)&&(0,a.tZ)(U,{zaType:"Image",zaText:"取消选中图片",title:"取消选中图片",onClick:function(e){e.stopPropagation(),r(n)},css:function(e){return{top:"8px",right:"8px",fontSize:"14px",textAlign:"center",backgroundColor:e.colors.GBL01A,color:e.colors.GBK99A,borderRadius:"50%"}},children:null==n?void 0:n.checkedIndex}),"dynamic"===n.subtype&&C,o&&(0,a.tZ)(B,{})]}),(0,a.tZ)(S.xu,{mt:"4px",fontSize:"10px",lineHeight:"20px",css:(0,m._)((0,_._)({},(0,R.S)(1)),{wordBreak:"break-all"}),title:"文件名称",children:null==n?void 0:n.name})]})};G.propTypes={data:u().object,deleted:u().bool,imageUrl:u().string,poster:u().string,isPrivate:u().bool,onChooseImage:u().func,onDeleteSingleImage:u().func};var F=n(99178),H=function(e){return(0,a.tZ)("i",(0,_._)({css:{marginLeft:"14px",width:"96px"}},e))},z=function(e){var t=e.children,n=(0,y._)(e,["children"]);return(0,a.BX)(F.ZP,(0,m._)((0,_._)({css:{display:"flex",flex:1,overflow:"auto",flexWrap:"wrap",justifyContent:"space-between",alignContent:"flex-start",height:"100%",marginLeft:"-5px",padding:"0 20px 0"}},n),{children:[t,(0,a.tZ)(H,{}),(0,a.tZ)(H,{}),(0,a.tZ)(H,{}),(0,a.tZ)(H,{}),(0,a.tZ)(H,{}),(0,a.tZ)(H,{})]}))},q=n(91486),V=function(e){var t=e.checked,n=e.onChange,r=(0,y._)(e,["checked","onChange"]);return(0,a.BX)(S.kC,(0,m._)((0,_._)({alignItems:"center",css:function(e){return{fontSize:"13px",color:e.colors.GBL04A}}},r),{children:[(0,a.tZ)(q.C,{type:"checkbox",checked:t,onChange:function(e){n(e.target.checked)},size:15,css:{marginRight:"5px",marginTop:"1px"}}),"本页全选"]}))},W=n(49899),X=n(57730),K=n(74135),j=function(e){var t=e.itemKey,n=(0,A.Z)(),r=(0,p.useTracker)().trackEvent,o=w(),a=o.sourceId,s=o.sourceType,u=o.insertImage,d=o.onClose,f=(0,i._)((0,l.useState)([]),2),h=f[0],g=f[1],T=(0,i._)((0,l.useState)(!0),2),E=T[0],y=T[1],C=(0,i._)((0,l.useState)(!1),2),S=C[0],I=C[1],b=(0,i._)((0,l.useState)(!1),2),Z=b[0],x=b[1],k=(0,i._)((0,l.useState)(!1),2),R=k[0],N=k[1],O=(0,i._)((0,l.useState)("all"),2),P=O[0],D=O[1],L=(0,i._)((0,l.useState)(null),2),M=L[0],B=L[1],U=h.length&&h.every(function(e){return e.checked}),G=function(){y(!0),N(!1),x(!1),B(null),g([]),I(!1)},F=(0,c.A)(function(e,t){if(y(!1),t)N(!0);else{var n;X.Z.alert((null==e?void 0:e.message)||(null==e?void 0:null===(n=e.error)||void 0===n?void 0:n.message)||"网络错误，稍后重试吧!")}}),H=(0,c.A)(function(e){var t,n=(0,K.camelizeKeys)(e.payload||{});y(!1),x(null==n?void 0:null===(t=n.paging)||void 0===t?void 0:t.isEnd),B(null==n?void 0:n.paging),g(function(e){return e.concat((null==n?void 0:n.data)||[])})}),z=(0,c.A)(function(e){g(function(n){var r,o=(0,W._)(n),i=o.find(function(n){return e[t]===n[t]}),a=(null===(r=null==o?void 0:o.map(function(e){return null==e?void 0:e.checkedIndex}).sort(function(e,t){return t-e}))||void 0===r?void 0:r[0])||0;return i&&(i.checked=!i.checked,i.checked?i.checkedIndex=a+1:(o.forEach(function(e){(null==e?void 0:e.checkedIndex)>i.checkedIndex&&e.checkedIndex--}),delete i.checkedIndex)),o})});return{materialList:h,setMaterialList:g,paging:M,isLoading:E,setIsLoading:y,hasInited:S,setHasInited:I,isDrained:Z,setIsDrained:x,isPageError:R,setIsPageError:N,subTypeCatch:P,setSubTypeCatch:D,selectAllChecked:U,toggleSelectAll:function(e){e&&r({action:"Unknown",eventType:"Click",elementLocation:{type:"Button",text:"本页全选"}}),g(function(t){return t.map(function(t,n){return(0,m._)((0,_._)({},t),{checked:e,checkedIndex:e?n+1:void 0})})})},reset:G,handleSubTypeChange:function(e){S&&e!==P&&(D(e),G())},handleResponseErrorData:F,handleResponseData:H,chooseImage:z,insertImages:(0,c.A)(function(e){u(e.map(function(e){return e.origin})),n("".concat(location.origin,"/api/v4/materials/pc_editor/recently-materials"),{method:"POST",body:{source_type:s,source_id:String(a),material_type:"image",material_ids:e.map(function(e){return e.materialId})}}),d()})}},Y=function(e){return(0,a.tZ)(S.kC,(0,_._)({justifyContent:"space-between",css:{padding:"10px 20px 10px 8px"}},e))},Q=function(e){return(0,a.tZ)("div",(0,m._)((0,_._)({css:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"}},e),{children:"加载中..."}))},J=function(e){return(0,a.tZ)(p.ZAClick,(0,_._)({as:"button",zaType:"Button",zaText:!0,zaAction:"Unknown",css:{marginRight:"10px",padding:"7px 15px",fontSize:"14px",borderRadius:"3px","&:last-child":{marginRight:0}}},e))},$=function(e){var t=e.active,n=(0,y._)(e,["active"]);return(0,a.tZ)(J,(0,_._)({css:function(e){return[{background:e.colorMod(e.colors.GBL01A).alpha(.3),color:e.colors.GBK99A,"&[disabled]":{opacity:.5,cursor:"default"}},t&&{background:e.colors.GBL01A}]}},n))},ee=function(e){return(0,a.tZ)(J,(0,_._)({css:function(e){return{background:e.colors.GBK10A,color:e.colors.GBK03A}}},e))},et=function(e){return(0,a.tZ)(J,(0,_._)({css:function(e){return{background:e.colors.GBK10A,color:e.colors.GRD03A}}},e))},en=function(e){return(null==e?void 0:e.length)?e.sort(function(e,t){return(null==e?void 0:e.checkedIndex)-(null==t?void 0:t.checkedIndex)}):[]},er=function(e){var t=e.isPageError,n=e.keywordCatch,r=e.reset;return t?(0,a.tZ)(C.H.EI1A,{image:"loadingError",content:"网络连接失败",buttonText:"刷新页面",buttonOnClick:r}):(0,a.tZ)(C.H.EI1A,{image:"default",content:"没有找到".concat(n?"「"+n+"」":"","相关内容"),buttonText:"搜索其他内容",buttonOnClick:function(){var e;null===(e=document.querySelector(".materials_library_public_search"))||void 0===e||e.focus()}})},eo=function(e){var t=e.dataList,n=e.insertImages,r=(0,y._)(e,["dataList","insertImages"]),o=(t||[]).filter(function(e){return!0===e.checked});return(0,a.tZ)(S.kC,(0,m._)((0,_._)({css:{padding:"13px 20px"},justifyContent:"flex-end"},r),{children:(0,a.tZ)($,{active:o.length>0,onClick:function(){n(en(o))},css:{margin:0},zaText:"插入图片；图片数：".concat(o.length||0),children:"插入图片"})}))},ei=function(e){var t=e.keywordCatch,n=(0,y._)(e,["keywordCatch"]),r=(0,A.Z)(),o=w(),i=o.insertImage,s=o.onClose,u=j({itemKey:"id"}),d=u.materialList,p=u.paging,f=u.isLoading,h=u.setIsLoading,g=u.hasInited,T=u.setHasInited,E=u.isDrained,C=u.isPageError,b=u.setIsPageError,Z=u.selectAllChecked,x=u.toggleSelectAll,k=u.reset,R=u.handleResponseErrorData,N=u.handleResponseData,O=u.chooseImage,P=!d.length,D=(0,c.A)(function(){return h(!0),b(!1),r((null==p?void 0:p.next)||(0,I.D)("".concat(location.origin,"/api/v4/materials/pc_editor/search"),{offset:null==d?void 0:d.length,limit:24,keyword:t||"表情包"}))}),L=(0,c.A)(function(){return D().then(N).catch(function(e){R(e.payload)})}),M=(0,c.A)(function(e){i(e.map(function(e){return e.origin})),s()});(0,l.useEffect)(function(){g||D().then(N).catch(function(e){R(e.payload,!0)}).finally(function(){T(!0)})},[g,T,D,N,R]);var B=P?!f&&(0,a.tZ)(er,{isPageError:C,keywordCatch:t,reset:k}):(0,a.BX)(a.HY,{children:[(0,a.tZ)(z,{getContainer:function(e){return e},onLoad:L,isLoading:f,isDrained:E,children:d.map(function(e,t){return(0,a.tZ)(G,{data:e,onChooseImage:O},String([e.id,t]))})}),(0,a.tZ)(eo,{dataList:d,insertImages:M})]});return(0,a.BX)(S.kC,(0,m._)((0,_._)({flexDirection:"column",color:"GBL05A",css:{height:"530px",fontSize:"12px"}},n),{children:[(0,a.BX)(Y,{children:[(0,a.tZ)("div",{className:"MaterialLibrary-SearchTipsContainer",children:t&&!P&&!f&&!C&&(0,a.BX)(S.xu,{color:"GBK03A",width:"200px",css:{margin:"0px 12px",fontSize:"12px"},children:["以下为「",t,"」相关搜索内容"]})}),(0,a.tZ)(V,{checked:Z,onChange:x})]}),g?B:(0,a.tZ)(Q,{})]}))},ea=n(62263),ec="materialId",es=function(e){var t=e.isPageError,n=e.reset,r=w().setTabType;return t?(0,a.tZ)(C.H.EI1A,{image:"loadingError",content:"网络连接失败",buttonText:"刷新页面",buttonOnClick:n}):(0,a.tZ)(C.H.EI1A,{image:"default",content:"最近使用为空，请搜索网络素材或上传图片",buttonText:"上传图片",buttonOnClick:function(){r(ea.gn.PRIVATE)}})},eu=function(e){var t=e.dataList,n=e.deleteImages,r=e.insertImages,o=(0,y._)(e,["dataList","deleteImages","insertImages"]),i=(t||[]).filter(function(e){return!0===e.checked});return(0,a.BX)(S.kC,(0,m._)((0,_._)({css:{padding:"13px 20px"},justifyContent:i.length>0?"space-between":"flex-end"},o),{children:[i.length>0&&(0,a.tZ)(et,{onClick:function(){0!==i.length&&X.Z.confirm((0,a.BX)("div",{className:"MaterialLibrary-alert",children:[(0,a.BX)("h2",{children:["是否删除已选择共 ",i.length," 张图片？"]}),(0,a.tZ)("p",{children:"插入至内容中的图片不会受到影响"})]}),{text:{ok:"删除",cancel:"取消"}}).then(function(){n(i.map(function(e){return e[ec]}))},function(){})},children:"删除图片"}),(0,a.tZ)($,{active:i.length>0,onClick:function(){r(en(i))},zaText:"插入图片；图片数：".concat(i.length||0),children:"插入图片"})]}))},el=n(9338),ed=n(30971),ep=n(87376),ef=n(29229),eh=n(49288),e_=n(6907),em=n(92258),ev=n(17132),eg=n.n(ev),eT=n(81374),eE=n(67927),ey=n(42308),eC=n(38020),eS=n(5543),eI=n(82644),eA=n(19603),eb=function(e){var t,n=e.data,r=e.deleteImage,o=e.reUploadImage,i=e.dragWrapRef,c=n||{},s=c.tag,u=c.index,l=(null==i?void 0:null===(t=i.current)||void 0===t?void 0:t.clientWidth)||746,d={cursor:"pointer",userDrag:"none",userSelect:"none",WebkitUserDrag:"none",WebkitUserSelect:"none"};return(0,a.BX)(S.xu,{id:s.originSrc+u,css:function(e){return(0,_._)({position:"relative",display:"inline-block",width:"105px",height:"105px",margin:"0 calc(".concat(l-655,"px / 12) 15px"),borderRadius:"2px",background:e.colors.GBK10C,"&:active":{filter:"drop-shadow(0px 3px 6px rgba(0, 0, 0, 0.15)) drop-shadow(0px 0px 4px rgba(0, 0, 0, 0.3))"}},"pending"===s.status&&d)},children:[(0,a.tZ)(eS.pt,{src:s.originSrc,scene:"pin_draft",width:"100%",height:"100%",css:{borderRadius:"2px"},sx:{objectFit:"cover"}}),(0,a.BX)(S.xu,{css:function(e){return{position:"absolute",top:0,left:0,width:"105px",height:"105px",borderRadius:"2px",zIndex:2,backgroundColor:e.colorMod(e.colors.GBK02A).alpha("pending"===s.status?.4:0),"& .CircleLoadingBar .path":{stroke:e.colors.MapBrand},"&:hover":{".close":{display:"block"}}}},children:["pending"===s.status&&(0,a.tZ)(eC.Z,{}),(0,a.tZ)(S.xu,{className:"close",css:function(e){return(0,_._)({position:"absolute",top:"-10px",right:"-9px",zIndex:3,width:"20px",height:"20px",lineHeight:"21px",fontSize:"15px",textAlign:"center",borderRadius:"50%",display:"none",backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.4),color:e.colors.GBK99A,"&>span":{marginLeft:"1px"}},d)},onClick:function(){return r(s,u)},children:(0,a.tZ)(eI.HN,{center:!0,width:"13px",height:"13px"})}),"error"===s.status&&(0,a.tZ)(eA.S,{onUploadImage:o,cssStyle:d,tag:s,fileKey:u})]})]},s.originSrc+u)},ew=n(24405),eZ=n(30283),ex=n(93975),ek=function(e){var t=e.handleUploadImage,n=e.content,r=e.style,o=void 0===r?{}:r,i=e.isLocal,c=e.className,s=(0,l.useRef)(),u=(0,p.useTracker)().trackEvent;return(0,a.BX)(a.HY,{children:[(0,a.tZ)("input",{css:{display:"none"},ref:s,type:"file",onChange:function(e){t(e),i&&(s.current.value=null);var n,r=e.target.files;(null==r?void 0:r.length)&&(null===(n=Array.from(r))||void 0===n||n.forEach(function(e){(0,P.loadImage)(window.URL.createObjectURL(e)).then(function(t){var n=t.height,r=t.width;u({eventType:"Click",action:"Upload",elementLocation:{type:"Button",moduleId:"image_upload"}},{configMap:{fileSize:String(e.size),imageWidth:String(r),imageHeight:String(n),imageFormat:e.name.split(".").pop(),pixels:String(n*r)}})})}))},accept:"image/*",multiple:!0}),(0,a.tZ)(p.ZAClick,{zaType:"Button",zaText:"本地图片上传",as:S.kC,role:"button",width:"112px",height:"32px",lineHeight:"32px",fontSize:"12px",color:"MapBrand",alignItems:"center",justifyContent:"center",ml:"19px",mb:"6px",onClick:function(){return s.current.click()},css:(0,_._)({verticalAlign:"top",display:"inline-flex",cursor:"pointer",borderRadius:"3px",border:"1px solid rgba(23, 114, 246, 0.2)"},o),className:c,children:n||(0,a.BX)(a.HY,{children:[(0,a.tZ)(eZ.Z,{size:"20px"}),(0,a.tZ)(S.xv,{ml:"4px",fontWeight:500,children:"本地图片上传"})]})})]})},eR=function(e){var t=e.handleUploadImage,n=e.enterPhoneScanPanel,r=e.isLocal,o=e.isEnableAiImage,i=e.onUseAiImageFeature,c=(0,y._)(e,["handleUploadImage","enterPhoneScanPanel","isLocal","isEnableAiImage","onUseAiImageFeature"]),s=(0,ew.F)(),u=function(e){return{width:"104px",height:"104px",border:"2px solid ".concat(e.colorMod(e.colors.MapBrand).alpha(.2)),margin:0,background:"transparent",borderRadius:"12px",cursor:"pointer","&:hover":{background:"rgba(246, 246, 246, 0.3)"}}};return(0,a.BX)(S.kC,(0,m._)((0,_._)({},c),{height:"100%",alignItems:"center",justifyContent:"center",children:[(0,a.BX)(S.xu,{textAlign:"center",children:[(0,a.tZ)(ek,{handleUploadImage:t,css:u,content:(0,a.tZ)(eZ.Z,{css:function(e){return{color:e.colors.MapBrand}}})}),(0,a.tZ)(S.xv,{color:"MapText02A",fontSize:"14px",fontWeight:"500",mt:"14px",lineHeight:"20px",children:"本地图片上传"})]}),r&&(0,a.BX)(p.ZAClick,{zaModuleId:"scan_code_upload_picture_btn",zaType:"Button",extra:{configMap:{scan_code_upload_picture_btn_position:"middle"}},as:S.xu,textAlign:"center",ml:"100px",onClick:n,children:[(0,a.tZ)(S.kC,{css:u,alignItems:"center",justifyContent:"center",children:(0,a.tZ)(eh.Z,{css:function(e){return{color:e.colors.MapBrand}}})}),(0,a.tZ)(S.xv,{color:"MapText02A",fontSize:"14px",fontWeight:"500",mt:"14px",lineHeight:"20px",children:"手机扫码上传"})]}),o&&(0,a.BX)(p.ZAClick,{shouldTrackShow:!0,zaModuleId:"editor_ai_images",zaType:"Button",as:S.xu,textAlign:"center",ml:"100px",onClick:i,children:[(0,a.tZ)(S.kC,{color:"MapAI",css:{width:"104px",height:"104px",border:"2px solid ".concat(s.colorMod(s.colors.MapAI).alpha(.2)),borderRadius:"12px",cursor:"pointer","&:hover":{background:"rgba(246, 246, 246, 0.3)"}},alignItems:"center",justifyContent:"center",children:(0,a.tZ)(ex.Z,{})}),(0,a.tZ)(S.xv,{color:"MapText02A",fontSize:"14px",fontWeight:"bold",mt:"14px",lineHeight:"20px",children:"AI 配图"})]})]}))},eN=n(11942),eO=n(81037),eP=n(7835),eD=n(14528),eL=n(42559),eM=n.n(eL),eB=n(50953),eU={QRCODE:"QRCODE",UPLOADING:"UPLOADING"},eG=function(e){var t=e.page===eU.QRCODE;return(0,a.BX)(S.kC,{mt:"50px",alignItems:"center",justifyContent:"center",lineHeight:"42px",children:[(0,a.BX)(S.kC,{alignItems:"center",justifyContent:"center",fontSize:"19px",fontWeight:500,px:"4px",children:[(0,a.tZ)(S.xv,{color:t?"MapBrand":"MapInfoSub",mr:"4px",children:"01"}),(0,a.tZ)(S.xv,{color:t?"MapText02A":"MapInfoSub",children:"打开知乎 APP 扫一扫"})]}),(0,a.tZ)(eD.C,{css:function(e){return{margin:"0 20px",color:e.colors.MapText06A}}}),(0,a.BX)(S.kC,{alignItems:"center",justifyContent:"center",fontSize:"19px",fontWeight:500,px:"4px",children:[(0,a.tZ)(S.xv,{color:t?"MapInfoSub":"MapBrand",mr:"4px",children:"02"}),(0,a.tZ)(S.xv,{color:t?"MapInfoSub":"MapText02A",children:"选择相册图片上传"})]})]})},eF=function(e){var t=e.children,n=e.borderRadius,r=(0,y._)(e,["children","borderRadius"]);return(0,a.BX)(S.xu,(0,m._)((0,_._)({width:"152px",height:"162px",css:{overflow:"hidden",position:"relative"}},r),{children:[(0,a.tZ)(S.xu,{css:function(e){return{border:"2px solid ".concat(e.colorMod("#056DE8").alpha(.3)),width:"100%",minHeight:"328px",borderRadius:n||"12px",overflow:"hidden"}},children:t}),(0,a.tZ)(S.xu,{css:{position:"absolute",left:0,top:0,right:0,bottom:0,background:"linear-gradient(to top, #fff, transparent)"}})]}))},eH={WAIT:-1,UPLOADING:0,DONE:1},ez=function(e){var t=e.taskId,r=e.setPage,o=(0,ef._)(function(){return Promise.resolve().then(n.bind(n,98141))}),i=(0,eB.Z)(["urlToken"]),c=(0,A.Z)(),s=w(),u=s.setPhoneScanPanelPage,l=s.sourceType;return(0,eP.b)(function(){var e=setInterval(function(){c("/api/v4/image/transmission/task/status",{query:{task_id:t}}).then(function(t){t.payload&&t.payload.status!==eH.WAIT&&(clearInterval(e),r(eU.UPLOADING))})},3e3);return function(){return clearInterval(e)}}),(0,eP.b)(function(){u("scan_code")}),(0,a.BX)(a.HY,{children:[(0,a.BX)(p.ZAShow,{as:S.kC,zaModuleId:"scan_code_upload_picture_block",extra:{configMap:{scan_code_upload_picture_status:"scan_code"}},zaType:"Block",mt:"74px",alignItems:"center",justifyContent:"center",children:[(0,a.tZ)(S.Ee,{src:"https://pic1.zhimg.com/v2-6c79f8c8bfbad8f8d0bf72a37d5b67db.png",css:{width:"152px"}}),(0,a.tZ)(eF,{css:{marginLeft:"40px"},children:o&&(null==i?void 0:i.urlToken)?(0,a.tZ)(o,{fgColor:"#0F88EB",bgColor:"#fff",css:{margin:"6px 6px 0",position:"relative",zIndex:1},level:"H",size:136,value:"https://oia.zhihu.com/media/upload_to_pc/selector?type=image&max_count=9&enable_capture=true&user_token=".concat(i.urlToken,"&task_id=").concat(t,"&source=").concat(l),alt:"二维码",imageSettings:{height:30,width:30,src:"https://picx.zhimg.com/v2-9e41ea16bdfbe9cf4896617ecad5b4ca.png"}}):(0,a.tZ)(S.xu,{size:"136px",css:{margin:"4px 4px 0"}})})]}),(0,a.tZ)(S.xv,{mt:"30px",fontSize:"15px",color:"MapText02A",lineHeight:"22px",fontWeight:"500",children:"知乎 APP - 我的 - 右上角扫一扫"}),(0,a.tZ)(S.xv,{mt:"4px",fontSize:"12px",color:"MapInfoSub",lineHeight:"16px",children:"仅支持知乎 iOS 和 Android 10.41.0 以上版本"})]})},eq=Array.from({length:12}).map(function(){return null}),eV=function(e){var t=e.endTask,n=e.setTaskId,r=e.taskId,o=e.setPage,c=e.setImageList,s=(0,A.Z)(),u=(0,i._)((0,l.useState)([]),2),d=u[0],f=u[1],h=w(),g=h.phoneScanPanelShownSwitch,T=h.setPhoneScanPanelPage,E=h.sourceType,y=h.sourceId,C=h.contentId;return((0,eP.b)(function(){var e=setInterval(function(){s("/api/v4/image/transmission/task/list",{query:{task_id:r}}).then(function(e){var t,n=((null===(t=e.payload)||void 0===t?void 0:t.imagesList)||[]).map(function(e){return(0,m._)((0,_._)({},e),{src:(0,eT.K)(e.src,E,y,C)})});f(function(e){return!function(e,t,n){if(e.length!==t.length)return!1;for(var r=e.map(n).sort(),o=t.map(n).sort(),i=0;i<r.length;i++)if(r[i]!==o[i])return!1;return!0}(n,e,function(e){return e.id})?n:e})})},3e3);return function(){return clearInterval(e)}}),(0,l.useEffect)(function(){T(d.length>0?"receive":"wait")},[d]),d.length)?(0,a.BX)(a.HY,{children:[(0,a.tZ)(p.ZAShow,{as:S.kC,zaModuleId:"scan_code_upload_picture_block",zaType:"Block",extra:{configMap:{scan_code_upload_picture_status:"receive"}},mt:"72px",pl:"20px",pr:"5px",justifyContent:d.length>6?"flex-start":"center",flexWrap:"wrap",children:d.map(function(e,t){return(0,a.tZ)(S.Ee,{size:"105px",mr:"15px",mb:"15px",flex:"0 0 105px",src:e.url,css:{objectFit:"cover"}},String([e.url,t]))})},"receive"),(0,a.tZ)(p.ZAClick,{as:eO.ZP,zaType:"Button",zaModuleId:"scan_code_upload_picture_confirm_btn",extra:{configMap:{scan_code_upload_picture_task_id:String(r),scan_code_upload_picture_num:String(d.length)}},preset:"primary",color:"blue",label:"确认",css:{width:"86px",marginTop:"auto",marginBottom:"40px"},onClick:function(){c(function(e){return(0,W._)(e||[]).concat((0,W._)(d.map(function(e){return{originSrc:e.url,status:"success",id:(0,e_.E)("image"),fromPhoneScan:!0,data:e}})))}),g.off()}})]}):(0,a.BX)(a.HY,{children:[(0,a.tZ)(p.ZAShow,{as:S.kC,zaModuleId:"scan_code_upload_picture_block",zaType:"Block",extra:{configMap:{scan_code_upload_picture_status:"wait"}},mt:"92px",alignItems:"center",justifyContent:"center",children:(0,a.BX)(eF,{borderRadius:"16px",css:{width:"156px"},children:[(0,a.tZ)(S.kC,{mt:"10px",justifyContent:"center",children:(0,a.tZ)(S.xu,{bg:"MapText07A",width:"34px",height:"10px",css:{borderRadius:"4px",opacity:"0.1"}})}),(0,a.tZ)(S.kC,{mt:"10px",pl:"3px",pr:"1px",justifyContent:"center",flexWrap:"wrap",children:eq.map(function(e,t){return(0,a.tZ)(S.xu,{bg:"MapText07A",width:"34px",height:"34px",mr:"2px",mb:"2px",flex:"0 0 34px",css:{borderRadius:"4px",opacity:"0.1"}},t)})})]})},"wait"),(0,a.tZ)(S.xv,{mt:"30px",fontSize:"15px",color:"MapText02A",lineHeight:"22px",fontWeight:"500",children:"请在手机相册中选择图片上传"}),(0,a.tZ)(S.kC,{css:{marginTop:"auto",marginBottom:"40px"},children:(0,a.tZ)(S.kC,{role:"button",width:"86px",height:"32px",lineHeight:"32px",fontSize:"14px",color:"MapBrand",alignItems:"center",justifyContent:"center",onClick:function(){n(eM()()),t(r),o(eU.QRCODE)},css:{verticalAlign:"top",display:"inline-flex",cursor:"pointer",borderRadius:"3px",border:"1px solid rgba(23, 114, 246, 1)"},children:(0,a.tZ)(S.xv,{fontWeight:600,children:"重新扫码"})})})]})},eW=function(e){var t=e.page,n=e.setPage,r=e.setImageList,o=(0,i._)((0,l.useState)(function(){return eM()()}),2),s=o[0],u=o[1],d=(0,A.Z)(),p=(0,c.A)(function(e){d("/api/v4/image/transmission/task/status",{method:"POST",body:{task_id:e,status:1}})});return((0,eP.b)(function(){return function(){p(s)}}),t===eU.QRCODE)?(0,a.tZ)(ez,{setPage:n,taskId:s}):(0,a.tZ)(eV,{setPage:n,endTask:p,setTaskId:u,taskId:s,setImageList:r})},eX=function(e){var t=e.setImageList,n=(0,i._)((0,l.useState)(eU.QRCODE),2),r=n[0],o=n[1];return(0,a.BX)(S.kC,{height:"100%",alignItems:"center",flexDirection:"column",children:[(0,a.tZ)(eG,{page:r}),(0,a.tZ)(eW,{page:r,setPage:o,setImageList:t})]})},eK=function(e){var t=e.src,n=e.originalSrc,r=e.watermarkSrc,o=e.privateWatermarkSrc,i=e.watermark,a=e.dataRawwidth,c=e.dataRawheight,s=e.hash,u=e.sourceType,l=e.sourceId,d=e.contentId,p=(0,O.rD)(t)?(0,eT.K)(t,u,l,d):(0,P.imgUrl)(t,{quality:eg()(navigator.userAgent).Mobile?50:80,size:window.devicePixelRatio>=1.5?"1440w":"720w"});return{src:p,url:p,originalSrc:n,watermarkSrc:r,privateWatermarkSrc:o,watermark:i,rawWidth:a,rawHeight:c,id:s}},ej=function(e){var t=e.dataList,n=e.insertImages,r=e.onClose,o=e.maxImage,i=(0,y._)(e,["dataList","insertImages","onClose","maxImage"]),c=!!o&&t.length>o;return(0,a.BX)(S.kC,(0,m._)((0,_._)({css:{padding:"13px 20px",position:"relative"},alignItems:"center",justifyContent:"flex-end"},i),{children:[o&&(null==t?void 0:t.length)>0&&(0,a.BX)(S.xu,{css:{position:"absolute",left:20,top:20,display:"flex"},color:"GBK03A",fontSize:"13px",children:[(0,a.tZ)(S.xv,{css:{color:c&&"red"},children:t.length}),"/",o,(0,a.BX)(S.xv,{css:{opacity:.9,marginLeft:5},children:["(最多上传 ",o," 张图片)"]})]}),(null==t?void 0:t.length)>0&&(0,a.BX)(S.xv,{color:"GBK03A",fontSize:"14px",fontWeight:"400",mr:"10px",children:["已上传 ",t.length," 张图片，拖拽可调整顺序"]}),(0,a.tZ)($,{zaModuleId:"upload_picture_insert_picture_btn",extra:{configMap:{scan_code_upload_picture_num:String(t.filter(function(e){return e.fromPhoneScan}).length)}},active:t.length>0,onClick:function(){n(t.map(function(e){var t,n=e.data,r=(t=null==n?void 0:n.src)&&t.includes("resize:200:q75")?null==n?void 0:n.originalSrc:null==n?void 0:n.src;return(0,m._)((0,_._)({},n||{}),{src:r,url:r})}),{isRequest:!0}),r()},disabled:c,zaText:"插入图片；图片数：".concat(t.length||0),children:"插入图片"})]}))},eY=function(e){var t=e.handleUploadImage,n=e.errorList,r=e.reUpload,o=e.enterPhoneScanPanel;return(0,a.BX)(S.kC,{alignItems:"center",children:[(0,a.tZ)(ek,{handleUploadImage:t,style:{margin:"12px 0 2px 20px",height:"32px"},isLocal:!0}),(0,a.BX)(p.ZAClick,{zaModuleId:"scan_code_upload_picture_btn",zaType:"Button",extra:{configMap:{scan_code_upload_picture_btn_position:"top"}},zaText:!0,as:S.kC,role:"button",width:"112px",height:"32px",lineHeight:"32px",fontSize:"12px",color:"MapBrand",alignItems:"center",justifyContent:"center",ml:"10px",mt:"12px",mb:"2px",onClick:o,css:{verticalAlign:"top",display:"inline-flex",cursor:"pointer",borderRadius:"3px",border:"1px solid rgba(23, 114, 246, 0.2)"},children:[(0,a.tZ)(eh.Z,{size:"20px"}),(0,a.tZ)(S.xv,{ml:"4px",fontWeight:500,children:"手机扫码上传"})]}),(null==n?void 0:n.length)>0&&(0,a.BX)(S.kC,{ml:"auto",alignItems:"center",mr:"20px",mt:"1px",fontSize:"14px",children:[(0,a.BX)(S.xv,{color:"GRD03A",children:[n.length," 张上传失败"]}),(0,a.tZ)(S.xv,{css:function(e){return{width:"114px",height:"32px",lineHeight:"32px",marginLeft:"10px",borderRadius:"3px",cursor:"pointer",background:e.colors.GBK10A,color:e.colors.GBL01A,fontWeight:500,textAlign:"center"}},onClick:r,children:"批量重新上传"})]})]})},eQ=function(){var e,t,r,o,s,u=((0,ef._)(function(){return n.e(5389).then(n.t.bind(n,50526,23))})||{}).DraggableArea,d=(0,l.useRef)(),p=(0,em.useDispatch)(),f=w(),h=f.sourceType,g=f.sourceId,T=f.contentId,E=w(),y=E.insertImage,C=E.onClose,I=E.initLocalList,A=E.setInitLocalList,b=E.maxImage,Z=E.imgAutoRotate,x=E.phoneScanPanelShown,k=E.phoneScanPanelShownSwitch,R=E.onUseAiImageFeature,N=(0,i._)((0,l.useState)(I||[]),2),O=N[0],P=N[1],D=(0,l.useRef)(O),L=(0,c.A)(function(){k.on()}),M=(e=(0,eN.B)(function(){return new Map}),t=(0,c.A)(function(t){if(t&&"string"==typeof t){var n=e.get(t);n&&n.abort();var r=new AbortController;return e.set(t,r),r}}),r=(0,c.A)(function(t,n){n&&e.get(t)===n&&e.delete(t)}),o=(0,c.A)(function(t){var n=e.get(t);n&&(n.abort(),e.delete(t))}),s=(0,c.A)(function(){e.forEach(function(e){return e.abort()}),e.clear()}),(0,l.useEffect)(function(){return s},[s]),{create:t,remove:r,abort:o,abortAll:s});(0,l.useEffect)(function(){D.current=O},[O]),(0,l.useEffect)(function(){P(I)},[I]),(0,l.useEffect)(function(){return function(){var e;A(null===(e=D.current)||void 0===e?void 0:e.map(function(e){return(0,_._)({},e,"pending"===e.status&&{status:"error"})}))}},[A]);var B=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.findIndex(function(e){return e.id===t}),o=(0,W._)(e);return -1!==r&&o.splice(r,1,(0,_._)({},e[r],n)),o},U=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e){var o=(null==r?void 0:r.isUpload)?null==r?void 0:r.imageList:O,i=(0,W._)(o),a=null===(n=i[t])||void 0===n?void 0:n.id;if(!a)return;var c=M.create(a);i.splice(t,1,(0,m._)((0,_._)({},i[t]),{status:"pending"})),P(function(){return(0,W._)(i)}),p((0,ey.Ix)(e,"default",h,Z,c)).then(function(e){var t=e.payload;P(function(e){return B(e,a,{data:eK((0,m._)((0,_._)({},t),{sourceType:h,sourceId:g,contentId:T})),status:"success"})})}).catch(function(e){(null==e?void 0:e.name)!=="AbortError"&&P(function(e){return B(e,a,{status:"error"})})}).finally(function(){M.remove(a,c)})}},G=function(e,t){var n=t.length-1;U(t[n].file,n,{isUpload:!0,imageList:t})},F=function(e){var t=e.target.files;if(null==t?void 0:t.length){if((null==t?void 0:t.length)>100){X.Z.alert("添加图片请不要超过 100 张哦~");return}var n,r,o=(n=(0,el._)(function(e){var t,n,r,o,i,a,c,s,u,l,d,f,h;return(0,ed.__generator)(this,function(_){switch(_.label){case 0:return[4,Promise.allSettled((t=Array.from(e)).map(function(e){return(0,ep.fs)({file:e,preset:ep.PG.content})}))];case 1:if(n=_.sent(),r=[],o=[],n.forEach(function(e,n){"fulfilled"===e.status?r.push(t[n]):o.push({file:t[n],error:e.reason})}),o.length>0){i=!0,a=!1,c=void 0;try{for(s=o[Symbol.iterator]();!(i=(u=s.next()).done);i=!0)d=(l=u.value).file,f=l.error,h="".concat(d.name,": ").concat(f.message||"暂不支持上传该文件"),p((0,eE.c0)(h,"red"))}catch(e){a=!0,c=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw c}}}return[2,r]}})}),function(e){return n.apply(this,arguments)}),i=function(e){var t=(0,W._)(O),n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var c=i.value,s={originSrc:window.URL.createObjectURL(c),status:"pending",id:(0,e_.E)("image"),file:c};t.push(s),P(t),G([c],t)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}};(r=(0,el._)(function(){var e,n;return(0,ed.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,o(t)];case 1:return(e=r.sent()).length>0&&i(e),[3,3];case 2:return n=r.sent(),p((0,eE.c0)(n.message||"图片处理失败，请重试","red")),[3,3];case 3:return[2]}})}),function(){return r.apply(this,arguments)})()}},H=function(e,t){var n,r=null===(n=O[t])||void 0===n?void 0:n.id;r&&"pending"===O[t].status&&M.abort(r);var o=(0,W._)(O);o.splice(t,1),P(o)},z=function(e){var t=[];return null==e||e.forEach(function(e,n){"error"===e.status&&t.push((0,m._)((0,_._)({},e),{index:n}))}),t};return x?(0,a.tZ)(eX,{setImageList:P}):(null==O?void 0:O.length)?(0,a.BX)(a.HY,{children:[(0,a.tZ)(eY,{handleUploadImage:F,errorList:z(O),reUpload:function(){var e;null===(e=z(O))||void 0===e||e.forEach(function(e){return U(e.file,e.index)})},enterPhoneScanPanel:L}),(0,a.tZ)(S.xu,{ref:d,css:{position:"relative",width:"100%",height:"505px",overflowY:"scroll",padding:"10px 12.5px 16px",lineHeight:"0.8"},children:u?(0,a.tZ)(u,{tags:O.map(function(e){return(0,m._)((0,_._)({},e),{id:"".concat(e.id,"_").concat(e.status)})}),render:function(e){return(0,a.tZ)(eb,{data:e,deleteImage:H,reUploadImage:U,dragWrapRef:d})},onChange:function(e){P(e.map(function(e){var t,n;return(0,m._)((0,_._)({},e),{id:(null===(t=null===(n=e.id)||void 0===n?void 0:n.split("_"))||void 0===t?void 0:t[0])||(0,e_.E)("image")})}))}}):O.map(function(e,t){return(0,a.tZ)(eb,{data:{tag:e,index:t},deleteImage:H,reUploadImage:U,dragWrapRef:d},"".concat(e.id,"_").concat(t))})}),(0,a.tZ)(ej,{dataList:O.filter(function(e){return"success"===e.status}),onClose:C,insertImages:y,maxImage:b})]}):(0,a.tZ)(eR,{handleUploadImage:F,enterPhoneScanPanel:L,isEnableAiImage:!!R,onUseAiImageFeature:function(){null==R||R(),C()},isLocal:!0})},eJ=function(e){var t=e.dataList,n=e.insertImages,r=(0,y._)(e,["dataList","insertImages"]),o=(t||[]).filter(function(e){return!0===e.checked});return(0,a.tZ)(S.kC,(0,m._)((0,_._)({css:{padding:"13px 20px",position:"absolute",bottom:0,width:"100%",borderTop:"1px solid var(--GBK09A)"},justifyContent:"flex-end"},r),{children:(0,a.tZ)($,{active:o.length>0,onClick:function(){n(en(o))},children:"插入图片"})}))},e$=n(65849),e0=n(47219),e1=n(44066),e2=n(2016),e3=n(85752),e4=n(57665),e5=n(80714),e6=n(48929),e7=function(){var e,t,n=(0,em.useDispatch)(),r=w(),o=r.sourceType,i=r.imgAutoRotate,a=(0,c.A)((e=(0,el._)(function(e,t){return(0,ed.__generator)(this,function(r){switch(r.label){case 0:return[4,n((0,ey.Ix)(e.file,"default",o,i)).then(function(n){var r={state:"success",file:e.file,localId:e.localId,data:(0,e6.R)(n.payload)};return null==t||t(r),r}).catch(function(n){throw null==t||t((0,m._)((0,_._)({},e),{state:"error"})),n})];case 1:return[2,r.sent()]}})}),function(t,n){return e.apply(this,arguments)})),s=(0,c.A)((t=(0,el._)(function(e,t){return(0,ed.__generator)(this,function(n){switch(n.label){case 0:var r;return[4,Promise.all(e.map((r=(0,el._)(function(e){var n,r;return(0,ed.__generator)(this,function(o){switch(o.label){case 0:return n=e,[4,fetch(e)];case 1:return[4,o.sent().blob()];case 2:return r={state:"uploading",file:o.sent(),localId:n},null==t||t(r),[2,a(r)]}})}),function(e){return r.apply(this,arguments)})))];case 1:return[2,n.sent()]}})}),function(e,n){return t.apply(this,arguments)}));return{uploadLocalImage:a,uploadExternalImages:s}},e8=n(71119),e9=n(79852),te=n(8512),tt=n(83849),tn=n.n(tt),tr=function(e){var t=e.photo,n=e.selected,r=e.onSelect,o=(0,l.useRef)(null),c=n.has(t),s=(0,i._)((0,l.useState)(null),2),u=s[0],d=s[1],f=(0,a.tZ)(S.kC,{alignItems:"center",justifyContent:"center",size:"24px",fontSize:"14px",fontWeight:"bold",sx:{border:"1.5px solid",borderColor:c?"MapBrand":"MapUIFrame99A",backgroundColor:c?"MapBrand":"none",borderRadius:9999},children:c?(0,W._)(n).indexOf(t)+1:null}),h=(0,a.BX)(S.kC,{alignItems:"center",justifyContent:"space-between",color:"MapUIFrame99A",sx:{position:"absolute",zIndex:1,color:c?"MapBrand":"MapText06A",top:0,width:"100%",padding:"6px",userSelect:"none","& ~[data-author-tooltip]":{opacity:0,transition:"opacity 0.15s ease"},"&:hover ~[data-author-tooltip]":{opacity:1}},children:[(0,a.tZ)("a",{"data-hover-visible":!0,href:t.detailUrl,target:"_blank",rel:"noreferrer",onClick:function(e){return e.stopPropagation()},css:{display:"flex"},children:(0,a.tZ)(S.Ee,{width:69,height:20,src:t.logo,alt:""})}),f]}),_=(0,a.BX)(S.kC,{alignItems:"center",justifyContent:"space-between","data-author-tooltip":!0,css:function(e){return{position:"absolute",left:"50%",transform:"translateX(-50%)",top:-28,width:"fit-content",height:24,padding:"6px",color:e.colors.MapUIFrame99A,backgroundColor:e.colorMod(e.colors.MapText02A).alpha(.8),borderRadius:4,whiteSpace:"nowrap",fontSize:"12px"}},children:["Photo by ",t.author," on ",tn()(t.supplier)]}),m=(0,a.BX)(a.HY,{children:[(0,a.tZ)(p.ZAClick,{zaType:"Button",zaModuleId:"view_large_image",extra:{configMap:{url:t.url}},as:S.zx,"data-hover-visible":!0,display:"flex",bg:"unset",p:"8px",css:{zIndex:1,border:"none",position:"absolute",right:0,bottom:0},onClick:function(e){e.preventDefault(),e.stopPropagation(),d(o.current)},children:(0,a.tZ)(te.Z,{size:20})}),(0,a.tZ)(e9.Z,{forceDataSize:!0,img:u,onClose:function(){return d(null)}})]}),g=(0,a.tZ)(S.Ee,{ref:o,loading:"lazy",size:"100%",src:t.previewUrl,"data-zoom-initial":t.url,"data-original":t.url,"data-rawwidth":t.width,"data-rawheight":t.height,css:{objectFit:"cover",borderRadius:2}}),T=(0,a.tZ)(S.xu,{sx:{border:c?"2px solid":"none",borderColor:c?"GBL01A":"transparent",position:"absolute",top:0,left:0,right:0,bottom:0},children:(0,a.tZ)(S.xu,{"data-hover-visible":!0,size:"100%",css:function(e){return{backgroundColor:e.colorMod(e.colors.GBK02A).alpha(.3)}}})});return(0,a.BX)(S.xu,{size:"105px",bg:"MapUIFrame10A",sx:{position:"relative",cursor:"pointer","&:nth-of-type(6n + 1) [data-author-tooltip]":{left:0,transform:"none"},"&:nth-of-type(6n + 6) [data-author-tooltip]":{left:"auto",right:0,transform:"none"},"& [data-hover-visible]":{opacity:0,transition:"opacity 0.15s ease"},"&:hover [data-hover-visible]":{opacity:1}},children:[m,(0,a.BX)(S.xu,{size:"100%",onClick:function(){r(t)},children:[T,g,h,_]})]})},to=(r=(0,el._)(function(){var e,t,n,r,o=arguments;return(0,ed.__generator)(this,function(i){switch(i.label){case 0:e=o.length>0&&void 0!==o[0]?o[0]:1,t=o.length>1?o[1]:void 0,n=o.length>2?o[2]:void 0,i.label=1;case 1:if(!(e-- >0))return[3,3];return[4,t()];case 2:if(n(r=i.sent()))return[3,1];return[2,r];case 3:return[2,r]}})}),function(){return r.apply(this,arguments)}),ti=function(e){var t,n=e.query,r=e.selected,o=e.setSelected,c=e.maxImage,s=void 0===c?9:c,u=(0,l.useRef)(1),d=(0,i._)((0,l.useState)([]),2),p=d[0],f=d[1],h=(0,i._)((0,e3.x)({error:null,isLoadedOnce:!1,isLoading:!1,isDrained:!1}),2),_=h[0],m=_.isLoadedOnce,g=_.isLoading,T=_.error,E=_.isDrained,y=h[1],I=1===u.current,b=p.length>0,w=(0,A.Z)(),Z=(0,em.useDispatch)(),x=(t=(0,el._)(function(){var e,t,r,o;return(0,ed.__generator)(this,function(i){switch(i.label){case 0:if(g||E||!n.trim())return[2];y(function(e){e.isLoading=!0,e.error=null}),i.label=1;case 1:return i.trys.push([1,3,4,5]),e=0,[4,to(12,(0,el._)(function(){var t,r,o,i,a;return(0,ed.__generator)(this,function(c){switch(c.label){case 0:return[4,w("/api/v4/creator/public/img/query",{query:{query:n,page:u.current}})];case 1:return a=c.sent(),u.current+=1,e+=(null===(t=a.payload.data)||void 0===t?void 0:null===(r=t.items)||void 0===r?void 0:r.length)||0,(null===(o=a.payload.data)||void 0===o?void 0:null===(i=o.items)||void 0===i?void 0:i.length)&&(f(function(e){return(0,W._)(e).concat((0,W._)(a.payload.data.items))}),y(function(e){e.isLoadedOnce=!0,e.isLoading=!1})),[2,a]}})}),function(t){var n;return(null===(n=t.payload.data)||void 0===n?void 0:n.hasMore)&&(!e||(u.current-1)%4!=0)})];case 2:return t=i.sent(),y(function(e){var n;e.isDrained=!(null===(n=t.payload.data)||void 0===n?void 0:n.hasMore)}),[3,5];case 3:return o=(null===(r=i.sent().payload)||void 0===r?void 0:r.message)||"加载失败，请稍后再试",I||Z((0,eE.c0)(o,"red")),y(function(e){e.error=o}),[3,5];case 4:return y(function(e){e.isLoadedOnce=!0,e.isLoading=!1}),[7];case 5:return[2]}})}),function(){return t.apply(this,arguments)});return(0,eP.b)(function(){o(new Set),x()}),(0,a.BX)(a.HY,{children:[(0,a.BX)(S.kC,{flexWrap:"wrap",css:{gap:"15px"},children:[!b&&(T?(0,a.tZ)(C.H.EI1,{preset:"normal",image:"loadingError",content:T,css:{flex:1}}):m&&(0,a.tZ)(C.H.EI1,{preset:"normal",image:"default",content:"暂无匹配图片",css:{flex:1}})),p.map(function(e){return(0,a.tZ)(tr,{photo:e,selected:r,onSelect:function(e){o(function(t){return t.has(e)?(t.delete(e),new Set(t)):(t.size>=s&&(t.delete((0,W._)(t)[0]),Z((0,eE.c0)("公共图片库每次最多选择 9 图"))),new Set((0,W._)(t).concat([e])))})}},e.token+e.supplier)})]}),g&&(0,a.tZ)(S.kC,{flex:1,minHeight:I?"300px":"100px",flexDirection:"column",alignItems:"center",justifyContent:"center",children:(0,a.BX)(S.kC,{minHeight:"100px",flexDirection:"column",children:[(0,a.tZ)(S.xu,{flex:1,css:{position:"relative"},children:(0,a.tZ)(eC.Z,{})}),(0,a.tZ)(S.xu,{fontSize:"13px",color:"MapText06A",children:"正在搜索，请稍等..."})]})}),m&&b&&!E&&!g&&(0,a.tZ)(S.kC,{justifyContent:"center",children:(0,a.BX)(S.zx,{bg:"unset",css:{border:"none",display:"flex",gap:"5px"},color:"MapInfoSub",fontSize:"13px",fontWeight:"normal",onClick:x,children:["展开更多",(0,a.tZ)(e$.Z,{size:16,center:!0})]})})]})},ta=function(e){var t=e.isSearched,n=e.keyword,r=e.setKeyword,o=e.onSubmit,s=(0,l.useRef)(null),u=(0,p.useTracker)().trackEvent,d=(0,i._)((0,g.k)(!1),2),f=d[0],h=d[1],_=n&&f,m=function(e){o(e),e&&u({eventType:"Click",action:"Search",elementLocation:{type:"Button",moduleId:"public_image_confirmation_search",text:"搜索"}},{configMap:{search_query:e}})},T=(0,c.A)(function(e){var t;e.preventDefault(),r(""),m(""),null===(t=s.current)||void 0===t||t.focus()}),E=(0,l.useRef)(),y=(0,c.A)(function(e){E.current&&clearTimeout(E.current),E.current=setTimeout(e?h.on:h.off,100)}),C=(0,c.A)(function(){return y(!1)}),I=(0,c.A)(function(){return y(!0)});return(0,a.BX)(S.kC,{as:"form",onSubmit:function(e){e.preventDefault(),m(n)},flexDirection:"column",height:t?"auto":"100%",justifyContent:"center",alignItems:"center",children:[(0,a.tZ)(p.ZAShow,{zaType:"Block",zaModuleId:"public_image_search_box"},String(t)),(0,a.BX)(S.kC,{alignItems:"center",pl:"12px",width:"100%",maxWidth:"546px",sx:{height:t?"30px":"46px",border:"1.5px solid",borderColor:t?"MapUIFrame09A":"MapBrand",borderRadius:4},children:[(0,a.tZ)("input",{ref:s,autoFocus:!0,type:"text",placeholder:"输入关键字查找图片",onFocus:C,onBlur:I,css:{flex:1,width:"100%",height:"100%",border:"none",background:"none",fontSize:"15px"},value:n,onChange:function(e){r(e.target.value)}}),_?(0,a.tZ)(S.zx,{bg:"unset",color:"MapInfoSub",justifyItems:"center",height:"100%",pr:"12px",display:"flex",alignItems:"center",onClick:T,children:(0,a.tZ)(e0.Z,{size:t?16:20})}):(0,a.tZ)(S.zx,{onFocus:C,onBlur:I,type:"submit",bg:"unset",color:"MapInfoSub",justifyItems:"center",height:"100%",pr:"12px",display:"flex",alignItems:"center",onClick:function(){var e;null===(e=s.current)||void 0===e||e.focus()},children:(0,a.tZ)(e1.ZP,{size:t?16:20})})]}),(0,a.tZ)(S.xu,{my:"20px",textAlign:"center",fontSize:"13px",color:"MapText06A",children:"搜索服务及图片库由 Pexels、Pixabay 等提供"})]})},tc=function(){var e,t=w(),n=t.sourceType,r=t.insertImage,o=t.onClose,c=t.maxImage,s=(0,i._)((0,l.useState)(""),2),u=s[0],d=s[1],f=(0,i._)((0,l.useState)(!1),2),h=f[0],_=f[1],m=(0,i._)((0,l.useState)(""),2),g=m[0],T=m[1],E=(0,a.tZ)(ta,{isSearched:h,keyword:u,setKeyword:d,onSubmit:function(e){_(!0);var t=e.trim();T(t?t+Math.random():"")}}),y=(0,i._)((0,l.useState)(function(){return new Set}),2),C=y[0],I=y[1],A=(0,i._)((0,l.useState)(!1),2),b=A[0],Z=A[1],x=e7(),k=(0,em.useDispatch)(),R=(e=(0,el._)(function(){var e;return(0,ed.__generator)(this,function(t){switch(t.label){case 0:if("pin"!==n)return[3,6];Z(!0),t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,x.uploadExternalImages((0,W._)(C).map(function(e){return e.url}))];case 2:return r(t.sent().map(function(e){return e.data}),!0),o(),[3,5];case 3:return t.sent(),k((0,eE.c0)("图片上传失败，请稍后再试","red")),[3,5];case 4:return Z(!1),[7];case 5:return[2];case 6:return(e=(0,W._)(C).map(function(e){return e.url})).forEach(function(e){return e8.U.add(e)}),r(e,!1),o(),[2]}})}),function(){return e.apply(this,arguments)}),N=(0,a.BX)(S.kC,{flexDirection:"column",height:"100%",css:{position:"relative"},children:[(0,a.BX)(S.xu,{flex:1,p:"20px",css:{overflowY:"auto",overflowX:"hidden"},children:[E,(0,a.tZ)(ti,{query:u,selected:C,setSelected:I,maxImage:c},g)]}),(0,a.BX)(S.kC,{p:"13px 20px",bg:"MapUIFrame99A",sx:{borderTop:".5px solid",borderColor:"GBK09A"},children:[(0,a.BX)(S.kC,{flex:1,color:"MapInfoSub",alignItems:"center",fontSize:"13px",sx:{gap:"5px"},children:[(0,a.tZ)(e2.Z,{size:13}),(0,a.tZ)(S.rU,{color:"inherit",target:"_blank",href:"//".concat(e5.Z.wwwHost,"/term/photo-library"),children:"查看《知乎公共图片库功能使用条款》"})]}),(0,a.tZ)(p.ZAClick,{zaType:"Button",zaModuleId:"insert_picture",zaText:"插入图片；图片数：".concat(C.size),as:eO.ZP,preset:"primary",color:"blue",disabled:0===C.size||b,onClick:R,css:{position:"relative"},children:b?(0,a.tZ)(e4.Z,{css:{top:"4px"}}):"插入图片"})]})]});return(0,a.tZ)(p.ZAEnv,{extra:{configMap:{is_image_search_result_module:h?"after_search_result":"before_search_result"}},children:N})},ts=n(74963),tu=n(89483),tl=function(){var e,t=(0,em.useDispatch)(),n=(0,i._)((0,g.k)(),2),r=n[0],o=n[1],c=(0,tu.g9)(),s=(0,A.Z)(),u=(e=(0,el._)(function(){return(0,ed.__generator)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,s("/api/v4/creator/public/img/license",{method:"POST"})];case 1:return e.sent(),c(function(e){e.isTermAgreed=!0}),[3,3];case 2:return e.sent(),t((0,eE.c0)("出错了，请稍后再试","red")),[3,3];case 3:return[2]}})}),function(){return e.apply(this,arguments)});return(0,a.BX)(p.ZAShow,{zaType:"Block",zaModuleId:"public_image_authorization",as:S.kC,flexDirection:"column",maxHeight:"100%",css:{position:"relative"},children:[(0,a.tZ)(S.xu,{flex:1,p:"20px",maxHeight:"100%",css:{overflow:"auto",h1:{textAlign:"center"}},children:(0,a.tZ)(ts.Z,{text:"# 知乎公共图片库功能使用条款\n\n为使用公共图片库功能（以下简称“公共图片库”），你应当阅读并遵守《公共图片库功能使用条款》（以下简称“本条款”），本条款为《知乎协议》的特别功能服务条款。\n\n## 1. 术语含义\n\n如无特别说明，下列术语在本条款中的含义为：\n\n1.1 知乎公共图片库：指知乎向用户提供的来源于第三方图库网站的图片素材集合。简称为“公共图片库”。 <br>\n1.2 知乎公共图片库素材：指在知乎公共图片库中的单张或多张图片素材。简称为“图片素材”。<br>\n1.3 知乎公共图片库用户：指搜索、查看、使用知乎公共图片库图片素材的知乎账号用户。视情况简称为“你”、“公共图片库用户”或者“用户”。<br>\n1.4 知乎：是指北京智者天下科技有限公司及其相关服务可能存在的运营关联单位。<br>\n\n## 2. 关于公共图片库\n\n2.1 公共图片库是知乎开发的向知乎账号用户提供的来源于第三方图库网站的图片素材库。<br>\n2.2 你可以在选择图片功能下使用公共图片库，你可在公共图片库中进行搜索、查看、筛选、收藏、使用图片素材。<br>\n2.3 公共图片库的搜索服务及图片素材由第三方图库网站（包括 Pexels、Pixabay，可点击查看使用协议）提供。第三方图库网站图片的使用遵循其网站协\n议。不同图库网站的图片使用规则有所差异，你应当阅读并遵循。知乎仅提供公共图片库的技术服务。通过此功能获取的图片仅限于在知乎场景内使用。<br>\n2.4 知乎有权决定可以开通公共图片库的用户的范围和条件等。<br>\n\n## 3. 公共图片库用户的权利和义务\n\n3.1 你的行为应当符合《知乎协议》和《知乎社区规范》中对于用户行为规范的相关约定。<br>\n3.2 你应当在合法合规的前提下使用公共图片库，不得将公共图片库用于违反法律法规、政策及违背公序良俗、社会公德或干扰知乎正常运营和侵犯其他用户或第三方合法权益的目的。<br>\n3.3 你知悉并同意，公共图片库的图片素材来源于第三方图库网站，知乎并非公共图片库的权利方，你使用公众图片库功能并不代表知乎认可或担保你所使用的图片素材符合法律规定或不侵犯第三方的合法权利。<br>\n3.4 你知悉并同意，知乎在收到图片版权方或其他用户投诉图片素材的通知后，如通过核实认为你使用的图片素材违反法律规定或侵犯第三方合法权利的，知乎将删除涉嫌违规的图片素材或删除包含图片素材的作品，并将处理结果向你通知。尽管如此，你对图片的使用在极端情况下仍有可能被图片版权方主张侵权并且最终侵权成立，对此你应当充分的知悉并同意。<br>\n3.5 如涉及到免费的第三方图库，其图片内容涉及的版权之外的相关权益，如肖像权、商标权、隐私权等，知乎均不作保证或担保亦没有能力作核查，你应当自行核查是否存在侵犯他人权益或未经授权的内容，并联系权利方取得授权，对此你应当充分的知悉并同意。<br>\n3.6 你自愿使用公共图片库，知乎不对你使用公共图片库图片素材的关注量、阅读量、最终所得等作任何承诺。<br>\n\n## 4. 知乎的权利和义务\n\n4.1 知乎在目前技术水平下，最大程度地保障公共图片库的正常运行，以维护你的利益。<br>\n4.2 知乎有权根据运营情况调整或暂停公共图片库功能，并及时向你通知。<br>\n4.3 知乎作为提供信息发布功能的中立平台方，为公共图片库的顺利使用提供技术支持。<br>\n4.4 你理解并同意，为保障良好的用户体验，知乎会在收到图片版权方或其他用户的投诉通知后，要求投诉方如实填写投诉内容、侵权类型和具体原因、投诉理由，并提供权利证明文件、相关机构颁发的合法证书、授权文件等。知乎会核实投诉是否成立，如投诉成立，知乎将对涉嫌违规的素材图片或包含素材图片的作品采取删除、屏蔽、断开链接等必要措施。<br>\n4.5 你理解并同意，如你使用公众库图片素材与其他第三方产生争议或法律纠纷，你需自行承担由此导致的法律责任，知乎无权也无依据参与你与第三方的争议解决。<br>\n\n## 5.其它\n\n5.1 本条款内容同时包括知乎的各项制度规范、其它本条款附件中的协议或规则、知乎可能不断发布的关于公共图片库的其他相关协议、规则等内容。上述内容一经正式发布，即为本条款不可分割的组成部分，你同样应当遵守。上述内容与本条款存在冲突的，以本条款为准。一经注册或使用本条款下任何服务，即视为你已阅读并同意接受本条款及上述内容的约束。知乎有权在必要时单方修改本条款或上述内容，相关内容变更后，如果你继续使用公共图片库，即视为你已接受修改后的相关内容。如果你不接受修改后的相关内容，应当停止使用相关功能。<br>\n5.2 本条款签订地为中华人民共和国北京市海淀区。<br>\n5.3 本条款的成立、生效、履行、解释及纠纷解决，适用中华人民共和国大陆地区法律（不包括冲突法）。<br>\n5.4 若你和知乎之间发生任何纠纷或争议，首先应友好协商解决；协商不成功的，双方均同意将纠纷或争议提交本条款签订地有管辖权的人民法院解决。<br>\n5.5 本条款所有条款的标题仅为阅读方便，本身并无实际涵义，不能作为本条款涵义解释的依据。（完）<br>\n"})}),(0,a.BX)(S.kC,{p:"13px 20px",bg:"MapUIFrame99A",sx:{borderTop:".5px solid",borderColor:"GBK09A"},children:[(0,a.BX)(S.kC,{flex:1,alignItems:"center",fontSize:"13px",sx:{gap:"5px"},children:[(0,a.BX)(S.kC,{as:"label",alignItems:"center",css:{gap:"5px"},children:[(0,a.tZ)(q.C,{shape:"circle",size:16,checked:r,onChange:function(){o.toggle()}}),(0,a.tZ)(S.xv,{color:"MapText03A",children:"我已阅读并同意遵守"})]}),(0,a.tZ)(S.rU,{target:"_blank",href:"//".concat(e5.Z.wwwHost,"/term/photo-library"),children:"《知乎公共图片库功能使用条款》"})]}),(0,a.tZ)(p.ZAClick,{zaType:"Button",zaModuleId:"public_image_agree_authorize",zaText:!0,as:eO.ZP,preset:"primary",color:"blue",disabled:!r,onClick:u,children:"同意并继续"})]})]})},td=n(33961),tp=n(85009),tf=n(77880),th=function(e){var t=(0,A.Z)(),n=(0,i._)((0,l.useState)({}),2),r=n[0],o=n[1],a=(0,i._)((0,l.useState)(!1),2),s=a[0],u=a[1],d=(0,i._)((0,l.useState)(""),2),p=d[0],f=d[1],h=(0,i._)((0,l.useState)(!1),2),_=h[0],m=h[1],g=(0,c.A)(function(){m(!1),o({}),u(!1)}),T=(0,c.A)(function(){return t("".concat(location.origin,"/api/v4/materials/pc_editor/folders?type=").concat(e,"&material_type=image")).then(function(e){var t,n=(0,K.camelizeKeys)((null===(t=e.payload)||void 0===t?void 0:t.data)||{});return o(n),n})});return(0,l.useEffect)(function(){s||T().then(function(e){var t,n;f(null==e?void 0:null===(t=e.child)||void 0===t?void 0:null===(n=t[0])||void 0===n?void 0:n.id)}).catch(function(){m(!0)}).finally(function(){u(!0)})},[s,T]),{hasInited:s,isPageError:_,setIsPageError:m,reset:g,folders:r,getFoldersList:T,activeFolderId:p,setActiveFolderId:f}},t_=n(19760),tm=n(51695),tv=n(55890),tg=n(67814),tT=n.n(tg),tE=function(e){var t=e.type,n=e.className,r=e.inputShowName,o=e.resetInput,c=e.folderId,s=e.getFoldersList,u=(0,A.Z)(),d=(0,l.useRef)(),p=(0,i._)((0,l.useState)(void 0===r?"":r),2),f=p[0],h=p[1],_=function(){"add"!==t&&f&&u("".concat(location.origin,"/api/v4/materials/pc_editor/folders/").concat(c),{method:"PUT",body:{name:f}}).then(function(){var e;null===(e=d.current)||void 0===e||e.blur(),s&&s()}).catch(function(e){var t,n,r;X.Z.alert((null===(t=e.payload)||void 0===t?void 0:t.message)||(null===(n=e.payload)||void 0===n?void 0:null===(r=n.error)||void 0===r?void 0:r.message)||"网络错误，稍后重试吧!")})};return(0,a.tZ)("input",{ref:d,type:"text",className:tT()("MaterialLibrary-input-module",n),placeholder:"请输入文件名称",autoFocus:"autofocus",onChange:function(e){h(e.target.value)},value:f,onBlur:function(){o&&o(""),_()},onKeyUp:function(e){if(13===e.keyCode){var t;null===(t=d.current)||void 0===t||t.blur()}}})};tE.propTypes={inputShowName:u().string,resetInput:u().func};var ty=function(e){return(0,a.tZ)(p.ZAClick,(0,_._)({as:S.kC,zaType:"Button",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",css:function(e){return{borderRadius:"12px",backgroundColor:e.colors.GBK99A,cursor:"pointer","&+&":{marginLeft:"4px"}}}},e))},tC=function(e){var t,n=e.folders,r=void 0===n?{}:n,o=e.activeFolderId,c=e.getFoldersList,s=e.folderClick,u=e.reset,d=(0,A.Z)(),p=(0,i._)((0,l.useState)(""),2),f=p[0],h=p[1],_=(0,i._)((0,l.useState)(""),2),m=_[0],g=_[1],T=function(e,t){"nav-edit"===e?(h(t.id),g(t.name)):"nav-delete"===e&&X.Z.confirm((0,a.BX)("div",{className:"MaterialLibrary-alert",children:[(0,a.tZ)("h2",{children:"是否删除已选择分类？"}),(0,a.tZ)("p",{children:"分类中的图片将归入未分类中"})]}),{text:{ok:"删除",cancel:"取消"}}).then(function(){d("".concat(location.origin,"/api/v4/materials/pc_editor/folders/").concat(t.id),{method:"DELETE",body:{delete_material:!1}}).then(function(e){var t,n;(null===(t=e.payload)||void 0===t?void 0:t.success)?(X.Z.alert("已成功删除分组，该分组的图片已移动至「我的图片-未分类」"),u()):X.Z.alert((null===(n=e.payload)||void 0===n?void 0:n.message)||"网络错误，稍后重试吧！")})},function(){})};return(null==r?void 0:r.hidden)?null:(0,a.BX)("div",{className:"MaterialLibraryNav",children:[(0,a.BX)("div",{className:"MaterialLibraryNav-nav",children:[(0,a.BX)(S.kC,{className:"MaterialLibraryNav-Mine",justifyContent:"space-between",alignItems:"center",children:[(0,a.BX)(S.kC,{justifyContent:"space-between",alignItems:"center",children:[(0,a.tZ)(ex.y,{className:"nav-icon"}),null==r?void 0:r.name]}),(0,a.tZ)("div",{className:"nav-num",children:null==r?void 0:r.materialCount})]}),null==r?void 0:null===(t=r.child)||void 0===t?void 0:t.map(function(e){return(0,a.BX)(S.kC,{className:tT()("MaterialLibraryNav-Folder",{active:o===e.id}),justifyContent:"space-between",alignItems:"center",onClick:function(){s(e.id)},children:[(0,a.BX)(S.kC,{justifyContent:"space-between",alignItems:"center",children:[(0,a.tZ)(t_._,{className:"nav-icon"}),f!==e.id&&(0,a.tZ)("div",{className:"nav-name",children:e.name})]}),f!==e.id&&(0,a.tZ)("div",{className:tT()("nav-num",{"disable-hover":!e.supportEdit&&!e.supportDelete}),children:e.materialCount||0}),f!==e.id&&(e.supportEdit||e.supportDelete)&&(0,a.BX)(S.kC,{className:"nav-handle",children:[e.supportEdit&&(0,a.tZ)(ty,{zaText:"编辑",onClick:function(t){t.stopPropagation(),T("nav-edit",e)},children:(0,a.tZ)(tm.yc,{fill:"currentColor",size:10})}),e.supportDelete&&(0,a.tZ)(ty,{zaText:"删除",onClick:function(t){t.stopPropagation(),T("nav-delete",e)},children:(0,a.tZ)(eI.HN,{fill:"currentColor",size:10})})]}),f===e.id&&(0,a.tZ)(tE,{folderId:e.id,inputShowName:m,getFoldersList:c,resetInput:function(e){h(e)}})]},e.id)})]}),(0,a.BX)(S.kC,{className:"MaterialLibraryNav-Add",justifyContent:"space-between",alignItems:"center",onClick:function(){var e;if((null==r?void 0:null===(e=r.child)||void 0===e?void 0:e.length)>15){X.Z.alert("分组已达上限，请删除已有的分类后再行添加");return}X.Z.confirm((0,a.BX)("div",{className:"MaterialLibrary-alert",children:[(0,a.tZ)("h2",{children:"添加分类"}),(0,a.tZ)(tE,{type:"add",className:"MaterialLibraryNav-input-module"})]}),{text:{ok:"添加",cancel:"取消"}}).then(function(){var e,t=null===(e=document.querySelector(".MaterialLibrary-input-module"))||void 0===e?void 0:e.value;d("".concat(location.origin,"/api/v4/materials/pc_editor/folders"),{method:"POST",body:{name:t,material_type:"image"}}).then(function(){c()}).catch(function(e){var t,n,r;X.Z.alert((null===(t=e.payload)||void 0===t?void 0:t.message)||(null===(n=e.payload)||void 0===n?void 0:null===(r=n.error)||void 0===r?void 0:r.message)||"网络错误，稍后重试吧!")})},function(){})},children:[(0,a.tZ)(tv.dU,{className:"nav-icon"}),"添加分类"]})]})};tC.propTypes={folders:u().object,getFoldersList:u().func,folderClick:u().func};var tS="uniqueId",tI=function(e){var t=e.isPageError,n=e.handleUploadImage,r=e.reset;return t?(0,a.tZ)(a.HY,{children:(0,a.tZ)(C.H.EI1A,{image:"loadingError",content:"网络连接失败",buttonText:"刷新页面",buttonOnClick:r})}):(0,a.tZ)(eR,{css:{marginTop:"-50px"},handleUploadImage:n})},tA=function(e){var t=e.dataList,n=e.activeFolderId,r=e.folders,o=e.getFoldersList,i=e.insertImages,c=(0,y._)(e,["dataList","activeFolderId","folders","getFoldersList","insertImages"]),s=(0,A.Z)(),u=(t||[]).filter(function(e){return!0===e.checked}),d=(0,l.useMemo)(function(){var e;return null==r?void 0:null===(e=r.child)||void 0===e?void 0:e.filter(function(e){return e.id!==n})},[r,n]);return(0,a.BX)(S.kC,(0,m._)((0,_._)({css:{padding:"13px 20px"},justifyContent:u.length>0?"space-between":"flex-end"},c),{children:[u.length>0&&(0,a.tZ)(et,{onClick:function(){0!==u.length&&X.Z.confirm((0,a.BX)("div",{className:"MaterialLibrary-alert",children:[(0,a.BX)("h2",{children:["是否删除已选择共 ",u.length," 张图片？"]}),(0,a.tZ)("p",{children:"插入至内容中的图片不会受到影响"})]}),{text:{ok:"删除",cancel:"取消"}}).then(function(){s("".concat(location.origin,"/api/v4/materials/pc_editor/folders/").concat(n,"/materials"),{method:"DELETE",body:{material_type:"image",folder_material_ids:u.map(function(e){return e[tS]})}}).then(function(e){var t,n;(null===(t=e.payload)||void 0===t?void 0:t.success)?o():X.Z.alert((null===(n=e.payload)||void 0===n?void 0:n.message)||"网络错误，稍后重试吧！")})},function(){})},children:"删除图片"}),(0,a.BX)(S.xu,{children:[u.length>0&&(null==d?void 0:d.length)>0&&(0,a.tZ)(ee,{css:{width:"86px"},onClick:function(){if(0!==u.length){var e=d[0].id;X.Z.confirm((0,a.BX)("div",{className:"MaterialLibrary-alert",children:[(0,a.BX)("h2",{children:["为已选择共 ",u.length," 张图片分类"]}),(0,a.tZ)(tf.Z,{buttonClassName:"MaterialLibraryContent-select",listClassName:"MaterialLibraryContent-option",value:n,onChange:function(t){e=t},children:d.map(function(e){var t=e.name,n=e.id;return(0,a.tZ)(tf.W,{value:n,text:t,children:t},n)})})]}),{text:{ok:"确定",cancel:"取消"}}).then(function(){s("".concat(location.origin,"/api/v4/materials/pc_editor/material-move"),{method:"POST",body:{folder_id:n,target_folder_id:e,folder_material_ids:u.map(function(e){return e[tS]})}}).then(function(e){var t,n;(null===(t=e.payload)||void 0===t?void 0:t.success)?o():X.Z.alert((null===(n=e.payload)||void 0===n?void 0:n.message)||"网络错误，稍后重试吧！")})},function(){})}},children:"移动"}),(0,a.tZ)($,{active:u.length>0,onClick:function(){i(en(u))},zaText:"插入图片；图片数：".concat(u.length||0),children:"插入图片"})]})]}))},tb=function(e){var t=e.activeFolderId,n=e.getFoldersList,r=e.folders,o=(0,A.Z)(),i=(0,em.useDispatch)(),s=j({itemKey:tS}),u=s.materialList,d=s.paging,p=s.isLoading,f=s.setIsLoading,h=s.hasInited,_=s.setHasInited,m=s.isDrained,g=s.isPageError,T=s.setIsPageError,E=s.selectAllChecked,y=s.toggleSelectAll,C=s.reset,b=s.handleResponseErrorData,w=s.handleResponseData,Z=s.chooseImage,x=s.insertImages,k=!u.length,R=(0,c.A)(function(){return f(!0),T(!1),o((null==d?void 0:d.next)||(0,I.D)("".concat(location.origin,"/api/v4/materials/pc_editor/folders/").concat(t,"/materials"),{offset:null==u?void 0:u.length,limit:24}))}),N=(0,c.A)(function(){return R().then(w).catch(function(e){b(e.payload)})}),O=function(e){o("".concat(location.origin,"/api/v4/materials/pc_editor/folders/").concat(t,"/materials"),{method:"POST",body:{material_type:"image",materials:e}}).then(function(e){var t,r;(null===(t=e.payload)||void 0===t?void 0:t.success)?n():X.Z.alert((null===(r=e.payload)||void 0===r?void 0:r.message)||"网络错误，稍后重试吧！")}).catch(function(e){var t,n,r;X.Z.alert((null===(t=e.payload)||void 0===t?void 0:t.message)||(null===(n=e.payload)||void 0===n?void 0:null===(r=n.error)||void 0===r?void 0:r.message)||"网络错误，稍后重试吧!")})},P=function(e){var t=e.target.files;if(null==t?void 0:t.length){if((null==t?void 0:t.length)>100){X.Z.alert("添加图片请不要超过 100 张哦~");return}var n=[],r=!0,o=!1,a=void 0;try{for(var c,s=t[Symbol.iterator]();!(r=(c=s.next()).done);r=!0)!function(){var e=c.value;(0,ep.fs)({file:e,preset:ep.PG.content}).then(function(){(0,td.Z)(e).then(function(r){(0,tp.ZP)(r,{source:"material"}).then(function(r){(n=n.concat({name:null==e?void 0:e.name,source:null==r?void 0:r.original_hash})).length===t.length&&O(n)})})}).catch(function(e){i((0,eE.c0)(e.message||"图片上传未完成，请稍后发布","red"))})}()}catch(e){o=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}}};(0,l.useEffect)(function(){!h&&t&&R().then(w).catch(function(e){b(e.payload,!0)}).finally(function(){_(!0)})},[h,_,t,R,w,b]);var D=k?!p&&(0,a.tZ)(tI,{handleUploadImage:P,isPageError:g,reset:C}):(0,a.BX)(a.HY,{children:[(0,a.tZ)(S.xu,{mt:"-36px",width:"100px",children:(0,a.tZ)(ek,{handleUploadImage:P},u.length)}),(0,a.tZ)(z,{getContainer:function(e){return e},onLoad:N,isLoading:p,isDrained:m,css:{marginLeft:"-14px"},children:u.map(function(e,t){return(0,a.tZ)(G,{data:e,onChooseImage:Z,isPrivate:!0},String([e[tS],t]))})}),(0,a.tZ)(tA,{dataList:u,folders:r,activeFolderId:t,getFoldersList:n,insertImages:x})]});return(0,a.BX)(a.HY,{children:[(0,a.tZ)(Y,{children:(0,a.tZ)(V,{css:{marginLeft:"auto"},checked:E,onChange:y})}),h?D:(0,a.tZ)(Q,{})]})},tw=n(87051),tZ=function(e){var t=e.phoneScanPanelPage,n=(0,y._)(e,["phoneScanPanelPage"]);return(0,a.tZ)(p.ZAClick,(0,_._)({as:eO.ZP,zaModuleId:"scan_code_upload_picture_return_btn",zaType:"Button",extra:{configMap:{scan_code_upload_picture_status:t||""}},icon:tw.Z,preset:"plain",color:"grey",label:"取消",css:{height:"40px",width:"72px",marginTop:"10px",marginLeft:"12px"}},n))},tx=n(67516),tk=n.n(tx),tR=n(63459),tN=function(e){var t=e.offset;return(0,a.tZ)(S.xu,{size:"0px",children:(0,a.tZ)(S.xu,{mt:void 0===t?"-11px":t,bg:"MapCriticalTip",size:"6px",sx:{borderRadius:9999}})})},tO=(0,l.forwardRef)(function(e,t){var n=e.active,r=e.zaModuleId,o=e.zaContentType,i=e.sourceId,c=(0,y._)(e,["active","zaModuleId","zaContentType","sourceId"]);return(0,a.tZ)(p.ZAEnv,{content:{type:o,id:i},children:(0,a.tZ)(p.ZAClick,(0,_._)({ref:t,as:"button",zaType:"Button",zaText:!0,zaAction:"Unknown",color:"GBK03A",shouldTrackShow:!0,zaModuleId:r,css:function(e){return[{display:"flex",alignItems:"center",marginRight:"20px",lineHeight:"50px",fontSize:"15px",cursor:"pointer"},n&&{position:"relative",fontWeight:"bold","::after":{position:"absolute",left:"0",bottom:"0",content:"''",display:"block",width:"100%",height:"4px",backgroundColor:e.colors.GBL01A,flexShrink:"0"}}]}},c))})}),tP="material_library_original_image_bubble_shown",tD=function(e){var t=e.tabType,n=e.tabChange,r=e.tabs,o=e.sourceId,c=(0,i._)((0,tu.Lt)(),2),s=c[0],u=c[1],p=(0,l.useRef)(null),f=(0,i._)((0,l.useState)(null),2),h=f[0],_=f[1],m=(0,i._)((0,l.useState)(!1),2),g=m[0],T=m[1],E=(0,l.useMemo)(function(){var e=r?ea.YS.filter(function(e){var t=e.type;return r.includes(t)}):ea.YS,t=!0,n=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var c=i.value;c.type===ea.gn.PHOTO_LIBRARY&&(c.hasBadge=s,c.disabled=!1),c.type===ea.gn.ORIGINAL_IMAGE&&(c.zaModuleId="editor_image_library_tab")}}catch(e){n=!0,o=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw o}}return e.filter(function(e){return!e.disabled})},[r,s]),y=(0,l.useMemo)(function(){return E.some(function(e){return e.type===ea.gn.ORIGINAL_IMAGE})},[E]);(0,l.useEffect)(function(){p.current&&!h&&_(p.current)},[h]),(0,l.useEffect)(function(){!y||!h||g||tk().get(tP)||(T(!0),tk().set(tP,!0))},[y,h,g]);var C=function(){T(!1)};return(0,a.BX)(S.kC,{alignItems:"center",justifyContent:"space-between",css:function(e){return{height:"50px",padding:"0 20px",boxShadow:"inset 0px -0.5px 0px ".concat(e.colors.GBK09A)}},children:[(0,a.tZ)(S.kC,{children:E.map(function(e){var r=e.type===ea.gn.ORIGINAL_IMAGE;return(0,a.BX)(d().Fragment,{children:[(0,a.BX)(tO,{ref:r?p:null,active:t===e.type,zaModuleId:e.zaModuleId,sourceId:o,zaContentType:r?"Pin":"Unknown",onClick:function(){n(e.type),e.type===ea.gn.PHOTO_LIBRARY&&u(!1),g&&C()},children:[e.name,e.hasBadge&&(0,a.tZ)(tN,{})]}),r&&h&&(0,a.tZ)(tR._,{isOpen:g,target:h,placement:"top",css:{padding:"8px 12px",borderRadius:"12px"},globalCloseEvent:"click",globalClose:!0,onClose:C,children:(0,a.tZ)(S.xu,{color:"MapText99B",fontSize:"13px",children:"查看内容中的插图"})})]},e.type)})}),(0,a.tZ)("div",{className:"MaterialLibrary-SearchInputContainer"})]})};tD.propTypes={tabType:u().string,tabChange:u().func,tabs:u().arrayOf(u().oneOf(Object.values(ea.gn))),sourceId:u().string};var tL=(o={},(0,h._)(o,ea.gn.LOCAL,function(e){var t=(0,T._)({},(0,E._)(e));return(0,a.tZ)(a.HY,{children:(0,a.tZ)(S.kC,(0,m._)((0,_._)({flexDirection:"column",color:"GBL05A",css:{height:"530px",fontSize:"12px"}},t),{children:(0,a.tZ)(eQ,(0,_._)({},t))}))})}),(0,h._)(o,ea.gn.PHOTO_LIBRARY,function(){var e=(0,tu._X)();return(0,a.BX)(S.kC,{flexDirection:"column",css:{height:"530px"},children:["loaded"===e.termLoadingState&&(e.isTermAgreed?(0,a.tZ)(tc,{}):(0,a.tZ)(tl,{})),"error"===e.termLoadingState&&(0,a.tZ)(C.H.EI1,{content:"出错了，请稍后再试",image:"loadingError"})]})}),(0,h._)(o,ea.gn.EMOTICON,function(e){var t=(0,T._)({},(0,E._)(e)),n=(0,i._)((0,l.useState)(""),1)[0];return(0,a.tZ)(a.HY,{children:(0,a.tZ)(ei,(0,_._)({keywordCatch:n},t),n)})}),(0,h._)(o,ea.gn.PRIVATE,function(e){var t,n=(0,T._)({},(0,E._)(e)),r=th(ea.gn.PRIVATE),o=r.hasInited,i=r.getFoldersList,c=r.reset,s=r.isPageError,u=r.folders,l=r.activeFolderId,d=r.setActiveFolderId,p=null===(t=u.child)||void 0===t?void 0:t.find(function(e){return e.id===l}),f=s?(0,a.tZ)(tI,{isPageError:!0,reset:c}):(0,a.tZ)(tb,(0,_._)({folders:u,activeFolderId:l,getFoldersList:i},n),String([l,null==p?void 0:p.materialCount]));return(0,a.BX)(S.kC,{color:"GBL05A",css:{height:"530px",overflow:"hidden",fontSize:"12px"},children:[!s&&(0,a.tZ)(tC,{folders:u,activeFolderId:l,folderClick:function(e){l!==e&&d(e)},getFoldersList:i,reset:c}),(0,a.tZ)(S.kC,(0,m._)((0,_._)({flexDirection:"column",color:"GBL05A",css:{height:"530px",fontSize:"12px",flex:1}},n),{children:o?f:(0,a.tZ)(Q,{css:{marginTop:42}})}))]})}),(0,h._)(o,ea.gn.LATEST,function(e){var t=(0,T._)({},(0,E._)(e)),n=(0,A.Z)(),r=j({itemKey:ec}),o=r.materialList,i=r.paging,s=r.isLoading,u=r.setIsLoading,d=r.hasInited,p=r.setHasInited,f=r.isDrained,h=r.isPageError,g=r.setIsPageError,y=r.selectAllChecked,C=r.toggleSelectAll,b=r.reset,w=r.handleResponseErrorData,Z=r.handleResponseData,x=r.chooseImage,k=r.insertImages,R=!o.length,N=(0,c.A)(function(){return u(!0),g(!1),n((null==i?void 0:i.next)||(0,I.D)("".concat(location.origin,"/api/v4/materials/pc_editor/recently-materials"),{offset:null==o?void 0:o.length,limit:24,material_type:"image"}))}),O=(0,c.A)(function(){return N().then(Z).catch(function(e){w(e.payload)})}),P=(0,c.A)(function(e){return n("".concat(location.origin,"/api/v4/materials/pc_editor/recently-materials"),{method:"DELETE",body:{material_type:"image",material_ids:e}}).then(function(e){var t,n;(null===(t=e.payload)||void 0===t?void 0:t.success)?b():X.Z.alert((null===(n=e.payload)||void 0===n?void 0:n.message)||"网络错误，稍后重试吧！")})}),D=(0,c.A)(function(e){X.Z.confirm((0,a.BX)("div",{className:"MaterialLibrary-alert",children:[(0,a.tZ)("h2",{children:"是否从最近使用删除图片？"}),(0,a.tZ)("p",{children:"插入至内容中的图片不会受到影响"})]}),{text:{ok:"删除",cancel:"取消"}}).then(function(){P([e[ec]])},function(){})});(0,l.useEffect)(function(){d||N().then(Z).catch(function(e){w(e.payload,!0)}).finally(function(){p(!0)})},[d,p,N,Z,w]);var L=R?!s&&(0,a.tZ)(es,{isPageError:h,reset:b}):(0,a.BX)(a.HY,{children:[(0,a.tZ)(z,{getContainer:function(e){return e},onLoad:O,isLoading:s,isDrained:f,children:o.map(function(e,t){return(0,a.tZ)(G,{data:e,onChooseImage:x,deleted:e.deleted,onDeleteSingleImage:D},String([e[ec],t]))})}),(0,a.tZ)(eu,{dataList:o,deleteImages:P,insertImages:k})]});return(0,a.BX)(S.kC,(0,m._)((0,_._)({flexDirection:"column",color:"GBL05A",css:{height:"530px",fontSize:"12px"}},t),{children:[(0,a.tZ)(Y,{children:(0,a.tZ)(V,{css:{marginLeft:"auto"},checked:y,onChange:C})}),d?L:(0,a.tZ)(Q,{})]}))}),(0,h._)(o,ea.gn.ORIGINAL_IMAGE,function(){var e=w(),t=e.originalImages,n=e.insertImage,r=e.onClose,o=(0,i._)((0,l.useState)(function(){return t&&Array.isArray(t)?t.map(function(e,t){return e.url||e.originalSrc||e.src?{id:void 0!==e.id?String(e.id):"original_".concat(t),url:e.url||"",src:e.url||e.originalSrc||e.src||"",checked:!1,checkedIndex:void 0,thumbnail:e.url||e.originalSrc||e.src,watermarkSrc:e.watermarkSrc,originalSrc:e.originalSrc,rawWidth:e.rawWidth||e.width,rawHeight:e.rawHeight||e.height}:null}).filter(function(e){return null!==e}):[]}),2),s=o[0],u=o[1],d=(0,c.A)(function(e){u(function(t){var n,r=(0,W._)(t),o=r.find(function(t){return e.id===t.id}),i=(null===(n=r.map(function(e){return(null==e?void 0:e.checkedIndex)||0}).sort(function(e,t){return t-e}))||void 0===n?void 0:n[0])||0;return o&&(o.checked=!o.checked,o.checked?o.checkedIndex=i+1:(r.forEach(function(e){(null==e?void 0:e.checkedIndex)&&e.checkedIndex>o.checkedIndex&&e.checkedIndex--}),delete o.checkedIndex)),r})}),p=(0,c.A)(function(e){n(e.map(function(e){return(0,m._)((0,_._)({},e),{tag:{status:"success"}})})),r()}),f=s.length>0?(0,a.BX)(a.HY,{children:[(0,a.tZ)(S.kC,{flexWrap:"wrap",padding:"20px 20px 10px 15px",css:{gap:"1px 10px"},children:s.map(function(e,t){return(0,a.tZ)(G,{imageUrl:e.src,data:e,onChooseImage:d,poster:e.thumbnail,deleted:!1,onDeleteSingleImage:function(){}},String([e.id,t]))})}),(0,a.tZ)(eJ,{dataList:s,insertImages:p})]}):(0,a.tZ)(C.H.EI1,{image:"default",content:"暂无原文配图"});return(0,a.tZ)(S.kC,{flexDirection:"column",color:"GBL05A",css:{height:"530px",fontSize:"12px",position:"relative"},children:f})}),o),tM=(0,l.forwardRef)(function(e,t){var n=e.onClose,r=e.sourceType,o=e.sourceId,s=e.contentId,u=e.insertImage,d=e.maxImage,f=e.tabs,h=e.imgAutoRotate,T=e.initImage,E=void 0===T?[]:T,y=e.onUseAiImageFeature,C=e.originalImages;(0,tu.Wl)();var S=(0,i._)((0,l.useState)(ea.gn.LOCAL),2),I=S[0],A=S[1],b=(0,i._)((0,l.useState)(E),2),w=b[0],x=b[1],k=(0,i._)((0,g.k)(!1),2),R=k[0],N=k[1],O=(0,i._)((0,l.useState)(""),2),P=O[0],D=O[1],L=tL[I],M=(0,c.A)(function(e,t){u(e,(0,m._)((0,_._)({},t),{tabType:I}))});return(0,l.useImperativeHandle)(t,function(){return{updateImageStatus:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};x(function(r){return r.map(function(r){return r.id===e?(0,_._)((0,m._)((0,_._)({},r),{status:t}),n&&{data:(0,_._)({},r.data,n)}):r})})}}},[]),(0,l.useEffect)(function(){var e=function(e){return e.preventDefault()};return document.addEventListener("drop",e,!1),document.addEventListener("dragover",e,!1),function(){document.removeEventListener("drop",e,!1),document.removeEventListener("dragover",e,!1)}},[]),(0,a.tZ)(Z,{onClose:n,sourceType:r,sourceId:o,contentId:s,insertImage:M,setTabType:A,initLocalList:w,setInitLocalList:x,maxImage:d,imgAutoRotate:h,phoneScanPanelShown:R,phoneScanPanelShownSwitch:N,setPhoneScanPanelPage:D,onUseAiImageFeature:y,originalImages:C,children:(0,a.BX)("div",{children:[R?(0,a.tZ)(tZ,{onClick:N.off,phoneScanPanelPage:P}):(0,a.tZ)(tD,{tabType:I,tabChange:A,tabs:f,sourceId:o}),L&&(0,a.tZ)(p.ZAEnv,{block:I,children:(0,a.tZ)(L,{})})]})})});tM.propTypes={sourceType:u().string,sourceId:u().string,onClose:u().func,insertImage:u().func,imgAutoRotate:u().bool,contentId:u().string,originalImages:u().array};var tB=function(e,t){var n=e.sourceType,r=e.sourceId,o=e.contentId,s=e.insertImage,u=e.maxImage,d=e.tabs,h=e.initImage,_=e.imgAutoRotate,m=e.onUseAiImageFeature,g=e.originalImages,T=(0,i._)((0,l.useState)(!1),2),E=T[0],y=T[1],C=(0,i._)((0,l.useState)(null),2),S=C[0],I=C[1],A=(0,c.A)(function(){return y(function(e){return!e})});return(0,l.useImperativeHandle)(t,function(){return{toggleShown:A,updateImageStatus:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(null==S?void 0:S.updateImageStatus)&&S.updateImageStatus(e,t,n)}}},[A,S]),(0,a.tZ)(f.Z,{css:{minWidth:"746px",".Modal-content":{margin:0,padding:0}},onClose:A,children:E&&(0,a.tZ)(p.ZAEnv,{block:"MaterialLibrary",children:(0,a.tZ)(tM,{ref:I,onClose:A,sourceType:n,sourceId:r,contentId:o,insertImage:s,maxImage:u,tabs:d,initImage:h,imgAutoRotate:_,onUseAiImageFeature:m,originalImages:g})})})};tB.propTypes={sourceType:u().string.isRequired,sourceId:u().string.isRequired,insertImage:u().func.isRequired,contentId:u().string,originalImages:u().array};var tU=(0,l.forwardRef)(tB)},89483:function(e,t,n){"use strict";n.d(t,{Lt:function(){return m},Wl:function(){return g},_X:function(){return f},g9:function(){return h},ij:function(){return _}});var r=n(65733),o=n(9813),i=n(87363),a=n(67516),c=n.n(a),s=n(99281),u=n(81956),l="feature/editor/photo-library-toolbar-tooltip",d="feature/editor/photo-library-tab-badge",p=(0,s.n2)({isTermAgreed:!1,termLoadingState:"loading",hasPhotoLibraryToolbarTooltip:!1,hasPhotoLibraryTabBadge:!1}),f=function(){return(0,s.aO)(p)},h=function(){return(0,s.Bn)(p,o.ZP)},_=function(){return E(),(0,s.j1)(p,function(e){return e.hasPhotoLibraryToolbarTooltip},(0,o.ZP)(function(e,t){e.hasPhotoLibraryToolbarTooltip=t,c().set(l,t)}))},m=function(){return E(),(0,s.j1)(p,function(e){return e.hasPhotoLibraryTabBadge},(0,o.ZP)(function(e,t){e.hasPhotoLibraryTabBadge=t,c().set(d,t)}))},g=function(){var e=(0,u.Z)(),t=h(),n=(0,r.A)(function(){e("/api/v4/creator/public/img/license").then(function(e){t(function(t){t.isTermAgreed=e.payload.data.isLicense,t.termLoadingState="loaded"})}).catch(function(){t(function(e){e.termLoadingState="error"})})});(0,i.useEffect)(function(){n()},[n])},T=!1;function E(){var e=h(),t=(0,r.A)(function(){e(function(e){var t,n=c().get(l);e.hasPhotoLibraryToolbarTooltip=null==n||n,null==n&&c().set(l,!1),e.hasPhotoLibraryTabBadge=null===(t=c().get(d))||void 0===t||t})});(0,i.useEffect)(function(){T||(T=!0,t())},[t])}},19603:function(e,t,n){"use strict";n.d(t,{S:function(){return d}});var r=n(94009),o=n(85879),i=n(24405),a=n(44812),c=n(65871),s=n(87363),u=n.n(s),l=n(87641),d=u().memo(function(e){var t=e.onUploadImage,n=e.tag,u=e.fileKey,d=e.className,p=(0,r._)((0,s.useState)(!1),2),f=p[0],h=p[1],_=(0,i.F)(),m=_.colors,g=_.colorMod;return(0,o.tZ)(o.HY,{children:(0,o.BX)(l.zx,{css:{display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",width:"100%",height:"100%",cursor:"pointer",fontSize:"12px",fontWeight:400,color:f?"var(--MapBrand)":"var(--MapCriticalTip)",backgroundColor:g(m.GBK99A).alpha(.7)},className:d,onMouseEnter:function(){return h(!0)},onMouseLeave:function(){return h(!1)},onClick:function(){return t(n.file,u)},children:[f&&(0,o.BX)(o.HY,{children:[(0,o.tZ)(a.Z,{width:"20px",height:"20px"}),(0,o.tZ)(l.xv,{mt:"4px",children:"重试"})]}),!f&&(0,o.BX)(o.HY,{children:[(0,o.tZ)(c.Z,{width:"20px",height:"20px"}),(0,o.tZ)(l.xv,{mt:"4px",children:"上传失败"})]})]})})})},62263:function(e,t,n){"use strict";n.d(t,{YS:function(){return i},gn:function(){return o}}),(r=o||(o={})).LOCAL="local",r.PHOTO_LIBRARY="public",r.EMOTICON="emoticon",r.PRIVATE="private",r.LATEST="latest",r.ORIGINAL_IMAGE="original_image";var r,o,i=[{type:"local",name:"上传图片"},{type:"public",name:"公共图片库",disabled:!0},{type:"emoticon",name:"表情包"},{type:"private",name:"个人素材"},{type:"latest",name:"最近使用"},{type:"original_image",name:"原文配图"}];Object.fromEntries(i.map(function(e){return[e.type,e]})),Object.fromEntries(i.map(function(e){return[e.type,e.name]}));var a={ALL:{type:"all",name:"全部"},STATIC:{type:"static",name:"普通图片"},DYNAMIC:{type:"dynamic",name:"动图"}},c=Object.values(a);Object.fromEntries(Object.keys(a).map(function(e){return[e,a[e].type]})),Object.fromEntries(c.map(function(e){return[e.type,e.name]}))},71119:function(e,t,n){"use strict";n.d(t,{U:function(){return r}});var r=new Set},92868:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(55164),o=n(85879),i=n(67814),a=n.n(i),c=function(e){return(0,o.tZ)("span",(0,r._)({css:function(e){return{fontSize:"14px",color:e.colors.GBL05A,"&.is-error":{color:e.colors.GRD03A}}}},e))};function s(e){var t=e.current,n=e.max,r=e.className,i=e.name,s=n-t;return t>n?(0,o.BX)(c,{className:a()(r,"MaxLength","is-error"),children:[void 0===i?"字数":i,"已超过 ",-s," 个字"]}):(0,o.tZ)(c,{className:a()(r,"MaxLength"),children:s<=10&&"还可以输入 ".concat(s," 个字")})}},6226:function(e,t,n){"use strict";n.d(t,{Z:function(){return L}});var r=n(55164),o=n(94009),i=n(85879),a=n(91850),c=n(65733),s=n(87363),u=n(92258),l=n(49899),d=n(16e3),p=n(94172),f=n(87641);function h(e){var t=e.onUpdatePresetKeywords,n=e.onHasUpdated,r=e.presetKeywords,a=void 0===r?[]:r,c=(0,o._)((0,s.useState)([]),2),u=c[0],h=c[1],_=function(e){var r=(0,l._)(u),o=r.findIndex(function(t){return t.id===e.id});o>=0?r.splice(o,1):r.push(e),h(r),t(r),n(r.length>0)};return 0===a.length?null:(0,i.BX)(i.HY,{children:[(0,i.tZ)(f.kC,{justifyContent:"space-between",fontSize:13,lineHeight:"19px",children:(0,i.tZ)(f.xv,{color:"MapText06A",children:"选择下方类别减少推荐："})}),(0,i.tZ)(f.kC,{mt:2,mb:"60px",flexWrap:"wrap",sx:{gap:"6px"},children:a&&a.map(function(e){var t=u.some(function(t){return t.id===e.id}),n=t?d.Z:p.Z;return(0,i.BX)(f.kC,{height:36,lineHeight:"22px",fontSize:15,pl:"10px",pr:"14px",color:t?"MapBrand":"MapText03A",sx:function(e){return{borderRadius:"30px",cursor:"pointer",backgroundColor:t?e.colorMod(e.colors.MapBrand).alpha(.08):e.colorMod(e.colors.MapText06A).alpha(.08),alignItems:"center",justifyContent:"center",gap:"4px"}},onClick:function(){return _(e)},children:[(0,i.tZ)(n,{text:!0,center:!0,css:{width:14,height:14,marginRight:4}}),(0,i.tZ)(f.xv,{fontSize:15,children:e.val})]},e.id)})})]})}var _=n(33530),m=n(24405),g=n(14583),T=n(67927),E=n(82644);function y(e){var t=e.word,n=e.onClick,r=e.isVip,o=e.isExceededLimit,a=(0,m.F)(),c=r?a.colors.MapVIPBrand:a.colors.MapBrand,s=o?a.colors.MapText06A:c;return(0,i.BX)(f.kC,{alignItems:"center",p:"7px 10px 7px 14px",fontSize:15,lineHeight:"22px",sx:{backgroundColor:a.colorMod(s).alpha(.08),borderRadius:30},children:[(0,i.tZ)(f.xv,{fontSize:15,css:{wordBreak:"break-all",color:s},children:t}),(0,i.tZ)(E.ZP,{text:!0,center:!0,size:16,onClick:n,css:{fill:s,marginLeft:4}})]})}var C=n(7753);function S(e){var t=e.onUpgrade;return(0,i.BX)(f.kC,{width:"100%",justifyContent:"space-between",alignItems:"center",children:[(0,i.BX)(f.xv,{fontSize:15,lineHeight:"24px",color:"MapText03A",children:[(0,i.tZ)(g.Z,{text:!0,center:!0,css:{marginRight:6}}),"开通会员添加最多 30 关键词"]}),(0,i.BX)(f.xv,{as:"button",onClick:t,fontSize:15,bg:"transparent",color:"MapVIPBrand",sx:{border:"none",cursor:"pointer",padding:0},children:["去开通",(0,i.tZ)(C.ZP,{text:!0,center:!0})]})]})}var I=function(e,t){if(e.length!==t.length)return!1;var n=new Set(e);return e.length===n.size&&t.every(function(e){return n.has(e)})},A=function(e){var t=e.onUpdateCustomKeywords,n=e.onHasUpdated,r=e.sceneCode,a=e.onUpgrade,d=e.isVip,p=e.initialBlockedKeyword,h=e.blockedKeywords,E=e.presetKeywords,C=e.keywordProps,A=(0,u.useDispatch)(),b=(0,o._)((0,s.useState)(""),2),w=b[0],Z=b[1],x=(0,o._)((0,s.useState)(!1),2),k=x[0],R=x[1],N=(0,s.useRef)(null),O=(0,m.F)(),P=d?O.colors.MapVIPBrand:O.colors.MapBrand,D=w.trim().length>=C.kwMinLength&&w.trim().length<=C.kwMaxLength,L=(0,c.A)(function(e){t(e),n(!I(e,p))}),M=function(){if(h.length>=C.kwMaxCount){A((0,T.c0)("关键词数量已达上限","red"));return}if(h.includes(w.trim())){A((0,T.c0)("关键词已存在","red"));return}D?A((0,_.UX)({sceneCode:r,keyword:w.trim()})).then(function(){L([w.trim()].concat((0,l._)(h))),Z("")}):A((0,T.c0)("字数限制为 ".concat(C.kwMinLength,"-").concat(C.kwMaxLength," 字"),"red"))};return(0,i.BX)(i.HY,{children:[(0,i.BX)(f.kC,{justifyContent:"space-between",fontSize:13,lineHeight:"19px",children:[(0,i.tZ)(f.xv,{color:"MapText06A",children:d?(0,i.BX)(i.HY,{children:[(0,i.tZ)(g.Z,{text:!0,center:!0,css:{marginRight:3}}),"会员自定义更多关键词："]}):E.length>0?"以上均不是，我要自定义":"我要自定义："}),(0,i.BX)(f.xv,{color:"MapText07A",children:["已屏蔽 (",h.length>C.kwMaxCount?C.kwMaxCount:h.length,"/",C.kwMaxCount,")"]})]}),(0,i.tZ)(f.kC,{alignItems:"center",mt:"10px",mb:"16px",p:"10px 14px",height:40,sx:{backgroundColor:O.colorMod(O.colors.MapText06A).alpha(.08),borderRadius:8},children:!d&&h.length>=C.kwMaxCount?(0,i.tZ)(S,{onUpgrade:a}):(0,i.BX)(i.HY,{children:[(0,i.tZ)(f.xu,{mr:"4px",as:"input",ref:N,value:w,onChange:function(e){return Z(e.target.value)},onFocus:function(){return R(!0)},onBlur:function(){return R(!1)},onKeyDown:function(e){"Enter"===e.key&&(e.preventDefault(),M())},placeholder:k?"".concat(C.kwMinLength,"-").concat(C.kwMaxLength," 个字"):"+ 自定义关键词",color:"MapText03A",bg:"transparent",fontSize:15,lineHeight:"24px",flex:1,sx:{border:"none",outline:"none","&::placeholder":{color:k?O.colors.MapText07A:O.colors.MapText03A}}}),(k||w)&&(0,i.tZ)(f.xv,{as:"button",onClick:M,fontSize:15,sx:{color:P,border:"none"},children:"添加"})]})}),(0,i.tZ)(f.xv,{mb:"18px",fontSize:13,lineHeight:"19px",color:"MapText07A",children:"* 推荐页将屏蔽包含关键词的内容"}),h.length>0&&(0,i.tZ)(f.kC,{pb:"40px",flexWrap:"wrap",css:{gap:"6px"},children:h.map(function(e,t){var n=!d&&t>=C.kwMaxCount;return(0,i.tZ)(y,{word:e,onClick:function(t){t.stopPropagation(),L(h.filter(function(t){return t!==e}))},isVip:d,isExceededLimit:n},e)})})]})},b=n(71728),w=n(62618),Z=n(51679),x=n(81037),k=n(69118),R=n(24187),N=n(49274),O=n(85085),P=n(58909);function D(e){var t=e.showModal,n=e.onClose,a=e.sceneCode,l=e.children,d=e.type,p=e.id,h=e.recommendId,m=e.feedDeliverType,g=(0,o._)((0,s.useState)([]),2),E=g[0],y=g[1],C=(0,o._)((0,s.useState)({kwMaxCount:5,kwMaxLength:15,kwMinLength:2}),2),S=C[0],I=C[1],A=(0,o._)((0,s.useState)([]),2),D=A[0],L=A[1],M=(0,o._)((0,s.useState)(!1),2),B=M[0],U=M[1],G=(0,o._)((0,s.useState)(!1),2),F=G[0],H=G[1],z=(0,o._)((0,s.useState)(!1),2),q=z[0],V=z[1],W=(0,o._)((0,s.useState)(!1),2),X=W[0],K=W[1],j=(0,o._)((0,s.useState)(null),2),Y=j[0],Q=j[1],J=(0,u.useDispatch)(),$=(0,u.useSelector)(P.ib)||{},ee=$.vipInfo,et=$.kvipInfo,en=(0,s.useRef)([]),er=(void 0===ee?{isVip:!1}:ee).isVip||(void 0===et?{isVip:!1}:et).isVip,eo=((0,u.useSelector)(function(e){var t;return null===(t=e.menuIgnoreSet)||void 0===t?void 0:t["".concat(d,"-").concat(p)]})||{}).data,ei=(0,c.A)(function(){if(B){var e="SETTINGS"===a;J((e?_.PO:_.$6)((0,r._)({sceneCode:a,keywords:E},!e&&{type:d,id:p,tags:D,recommendId:h,feedDeliverType:m}))).then(function(t){var r=t.payload;r.error?J((0,T.c0)(r.error.message,"red")):e||J((0,T.c0)("反馈成功，将为你优化推荐结果")),q&&(O.Z.show(),V(!1)),n()})}}),ea=(0,c.A)(function(){K(!0),Q(null),J((0,_.ER)({sceneCode:a})).then(function(e){var t=e.payload;if(K(!1),t.success){var n=t.data,r=(0,b._)(t,["data"]);en.current=n||[],y(n||[]),I(r)}else Q(t.error||{message:"获取数据失败"})}).catch(function(e){K(!1),Q(e||{message:"获取数据失败"})})});return(0,s.useEffect)(function(){t?ea():U(!1)},[t,ea]),(0,i.BX)(i.HY,{children:[(0,i.tZ)(w.Z,{onClose:function(e){e.stopPropagation(),B?H(!0):n()},maskClosable:!1,css:{position:"relative",width:442,height:600,".Modal-content":{padding:"18px 20px",margin:0,height:600}},children:t&&(0,i.BX)(i.HY,{children:[(0,i.BX)(f.kC,{justifyContent:"space-between",alignItems:"center",m:"-18px -20px 10px",p:"18px 20px 10px",backgroundColor:"GBK99A",css:{position:"sticky",top:0},children:[(0,i.tZ)(f.xv,{fontSize:17,fontWeight:"bold",color:"MapText02A",children:"减少推荐"}),(0,i.tZ)(f.xu,{as:"button",onClick:ei,px:"13px",py:"4px",fontSize:15,fontWeight:"bold",color:"MapUIFrame99B",bg:er?"MapVIPBrand":"MapBrand",sx:{border:"none",borderRadius:"1000px",cursor:"pointer",opacity:B?1:.4},children:"确认"})]}),(0,i.tZ)(f.kC,{flexDirection:"column",onClick:function(e){return e.stopPropagation()},children:X?(0,i.BX)(i.HY,{children:[(0,i.tZ)(R.O,{variant:"H01"}),(0,i.tZ)(R.O,{variant:"Spacing",height:20}),(0,i.tZ)(R.O,{variant:"T02"})]}):Y?(0,i.tZ)(N.H.EI1A,{image:"loadingError",content:(null==Y?void 0:Y.message)||"页面加载失败",buttonText:"点击重试",buttonOnClick:ea,css:{marginTop:80}}):"function"==typeof l?l({sceneCode:a,onUpdateCustomKeywords:y,onUpdatePresetKeywords:L,onHasUpdated:U,onUpgrade:function(){B?(V(!0),H(!0)):(O.Z.show(),n())},isVip:er,presetKeywords:eo||[],blockedKeywords:E,initialBlockedKeyword:en.current,keywordProps:S}):l})]})}),(0,i.tZ)(w.Z,{onClose:function(e){e.stopPropagation(),H(!1)},title:"是否保留当前修改？",css:{width:358},children:F&&(0,i.BX)(Z.Z,{direction:"horizontal",children:[(0,i.tZ)(x.ZP,{color:k.rp.Grey,preset:k.EE.Primary,onClick:function(){H(!1),q&&(O.Z.show(),V(!1)),n()},css:function(e){return{"&.Button":{border:"none",backgroundColor:e.colors.MapUIFrame09A,color:e.colors.MapText02A},"&.Button:hover":{backgroundColor:"oklch(from ".concat(e.colors.MapUIFrame09A," calc(l* 0.92) c h)")}}},children:"不保留"}),(0,i.tZ)(x.ZP,{color:k.rp.Blue,preset:k.EE.Primary,onClick:function(){H(!1),ei()},css:function(e){return{"&.Button":{border:"none",backgroundColor:er?e.colors.MapVIPBrand:e.colors.MapBrand},"&.Button:hover":{"&.Button:hover":{backgroundColor:er?"oklch(from ".concat(e.colors.MapVIPBrand," calc(l* 0.92) c h)"):"oklch(from ".concat(e.colors.MapBrand," calc(l* 0.92) c h)")}}}},children:"保留"})]})})]})}function L(e){var t=e.type,n=e.id,l=(0,u.useDispatch)(),d=(0,o._)((0,a.k)(!1),2),p=d[0],f=d[1],m=(0,u.useSelector)(function(e){var t;return null===(t=e.menuIgnoreSet)||void 0===t?void 0:t.showFilterModal})||{},g=m.shouldShow,T=m.recommendId,E=m.type,y=m.id,C=m.feedDeliverType;(0,s.useEffect)(function(){g&&E===t&&y===n?f.on():f.off()},[g,E,y,t,n,f]);var S=(0,c.A)(function(){l((0,_.ic)({type:E,id:y,shouldShow:!1}))});return p?(0,i.tZ)(D,{showModal:p,onClose:S,sceneCode:T?"RECOMMEND":"DETAIL_PAGE",type:t,id:n,recommendId:T,feedDeliverType:C,children:function(e){return(0,i.BX)(i.HY,{children:[(0,i.tZ)(h,(0,r._)({},e)),(0,i.tZ)(A,(0,r._)({},e))]})}}):null}},46704:function(e,t,n){"use strict";n.d(t,{Z:function(){return x}});var r=n(55164),o=n(57477),i=n(71728),a=n(94009),c=n(79065),s=n(85879),u=n(80565),l=n(91850),d=n(65733),p=n(41402),f=n(7562),h=n(14583),_=n(87363),m=n(92258),g=n(63638),T=n(1733),E=n(58909),y=n(33530),C=n(67927);function S(){var e=(0,c._)(["\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n"]);return S=function(){return e},e}var I=(0,p.F4)(S()),A=function(e){var t=e.isLoading;return(0,s.BX)(T.sN,{css:function(e){return{display:"inline-flex",alignItems:"center",color:e.colors.MapInfoSub,height:40}},children:[(0,s.tZ)("span",{css:{display:"inline-flex",alignItems:"center",width:24},children:(0,s.tZ)(f.Z,{css:t?{animation:"".concat(I," 1s linear 600ms infinite")}:{}})}),t?"加载中...":"加载失败，点击重试"]})},b=function(e){var t=e.onClick,n=e.moduleId,i=e.text,a=e.zaAction,c=e.zaExtra,l=e.canShowVip,d=(0,m.useSelector)(E.cE),p=(0,m.useSelector)(E.sb);return(0,s.tZ)(g.ZAEnv,{moduleId:n,extra:c,children:(0,s.BX)(g.ZAClick,(0,o._)((0,r._)({as:T.sN},a&&{zaAction:a}),{zaType:"Button",zaText:!0,onClick:t,flex:1,css:{display:"flex",alignItems:"center",maxWidth:282,lineHeight:"40px"},children:[(0,s.tZ)(g.ZAShow,{as:"span",zaType:"Button",zaText:!0,css:(0,r._)({marginRight:4},(0,u.S)(1)),children:i}),l&&(d||p)&&(0,s.tZ)(h.Z,{text:!0,center:!0,css:{marginLeft:2,flexShrink:0}})]}),n)})},w=function(e){var t,n=e.content,r=e.recommendId,o=e.zaExtra,i=n.type,c=n.id,u="paid"===n.answerType||"paid"===n.articleType,p=(0,a._)((0,l.k)(!1),2),f=p[0],h=p[1],g=(0,_.useRef)(!1),T=(0,m.useDispatch)(),E=((0,m.useSelector)(function(e){var t;return null===(t=e.menuIgnoreSet)||void 0===t?void 0:t["".concat(i,"-").concat(c)]})||{}).data;(0,_.useEffect)(function(){Array.isArray(E)&&E.length>0||g.current||(g.current=!0,h.on(),T((0,y.p1)({type:i,id:c,sceneCode:r?"RECOMMEND":"DETAIL_PAGE",feedDeliverType:u?"Paid":"Normal"})).finally(function(){h.off()}))},[T,i,c,u,E,h,r]);var C=(0,d.A)(function(){T((0,y.ic)({type:i,id:c,recommendId:r,shouldShow:!0,feedDeliverType:u?"Paid":"Normal"}))});return f?(0,s.tZ)(A,{isLoading:!0}):(0,s.tZ)(b,{onClick:C,text:f||E&&E.length?"我不喜欢：".concat(null===(t=null==E?void 0:E.map(function(e){return e.val}))||void 0===t?void 0:t.join("、")," 等"):"设置屏蔽关键词",moduleId:"ignore_keyword",zaExtra:o,canShowVip:!0})};function Z(e){var t=e.content,n=e.recommendId,i=e.attachedInfoBytes,a=t.author,c=t.type,u=t.id,l=t.answerType,p=t.articleType,f=(0,m.useDispatch)(),h=function(e){var t=e.payload;t.error&&f((0,C.c0)(t.error.message,"red")),f((0,C.c0)("反馈成功，将为你优化推荐结果"))},_=(0,d.A)(function(e){var t={uninterestType:e,contentType:c,contentId:u,feedDeliverType:"paid"===l||"paid"===p?"Paid":"Normal"};n?f((0,y.a9)((0,o._)((0,r._)({},t),{recommendId:n}))).then(h):f((0,y.AW)(t)).then(h)}),g={configMap:{scene_code:n?"RECOMMEND":"DETAIL_PAGE"},attachedInfoBytes:i};return(0,s.BX)(s.HY,{children:[(0,s.tZ)(b,{onClick:function(){_("less_similar")},text:"不喜欢该内容",moduleId:"ignore_reduce_similar",zaAction:"Ignore",zaExtra:g}),(0,s.tZ)(b,{onClick:function(){_("author")},text:"不再推荐作者：".concat(a.name),moduleId:"ignore_author",zaAction:"Ignore",zaExtra:g}),(0,s.tZ)(w,{content:t,recommendId:n,zaExtra:g})]})}function x(e){var t=e.content,n=(0,i._)(e,["content"]),a=(0,m.useSelector)(function(e){var n,r="string"==typeof t.author?t.author:null===(n=t.author)||void 0===n?void 0:n.urlToken;return e.entities.users[r]})||t.author;return(0,m.useSelector)(function(e){return(0,E.pG)(e,a)})?null:(0,s.tZ)(Z,(0,r._)({content:(0,o._)((0,r._)({},t),{author:a})},n))}},92748:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(85879),a=n(87363),c=function(e){var t=e.title,n=e.id,r=e.topics,o=e.answerCount,i=e.commentCount,a=e.created,c=e.updatedTime,s=e.visitsCount,u=e.followerCount;return{name:t,url:"https://www.zhihu.com/question/".concat(n),keywords:null==r?void 0:r.map(function(e){return null==e?void 0:e.name}).join(","),answerCount:o,commentCount:i,dateCreated:new Date(1e3*a).toISOString(),dateModified:new Date(1e3*c).toISOString(),"zhihu:visitsCount":s,"zhihu:followerCount":u}},s=function(e){var t=e.thumbnail,n=e.voteupCount,r=e.question,o=e.id,i=e.createdTime,a=e.updatedTime,c=e.commentCount;return{image:t,upvoteCount:n,url:"https://www.zhihu.com/question/".concat((null==r?void 0:r.id)||"","/answer/").concat(o),dateCreated:new Date(1e3*i).toISOString(),dateModified:new Date(1e3*a).toISOString(),commentCount:c}},u=function(e){var t=e.title,n=e.id,r=e.created,o=e.updated,i=e.commentCount,a=e.imageUrl,c=e.thumbnail;return{headline:t,url:"https://zhuanlan.zhihu.com/p/".concat(n),datePublished:new Date(1e3*r).toISOString(),dateModified:new Date(1e3*o).toISOString(),commentCount:i,image:a||c}},l=function(e){var t=e.isOrg,n=e.urlToken,i=e.avatarUrl,a=e.gender,c=e.voteupCount,s=e.thankedCount,u=e.followerCount,l=e.answerCount,d=e.articlesCount;return(0,o._)((0,r._)({url:"https://www.zhihu.com/".concat(t?"org":"people","/").concat(n)},"number"==typeof a&&{gender:0===a?"Female":"Male"}),{image:i,"zhihu:voteupCount":c,"zhihu:thankedCount":s,"zhihu:followerCount":u,"zhihu:answerCount":l,"zhihu:articlesCount":d})},d=function(e){var t=e.excerpt,n=e.id,r=e.name,o=e.avatarUrl,i=e.bestAnswersCount,a=e.unansweredCount,c=e.questionsCount;return{description:t,url:"https://www.zhihu.com/topic/".concat(n),name:r,image:o,"zhihu:bestAnswersCount":i,"zhihu:unansweredCount":a,"zhihu:questionsCount":c}};t.Z=function(e){var t=e.type,n=e.data,r=(0,a.useMemo)(function(){if(!n)return null;switch(t){case"answer":return s(n);case"article":return u(n);case"question":return c(n);case"user":return l(n);case"topic":return d(n);default:return null}},[t,n]);return r?(0,i.tZ)(i.HY,{children:Object.keys(r).map(function(e){var t=r[e];return null==t?null:(0,i.tZ)("meta",{itemProp:e,content:String(t)},e)})}):null}},91770:function(e,t,n){"use strict";n.d(t,{Z:function(){return C}});var r=n(22107),o=n(94707),i=n(87320),a=n(86325),c=n(55164),s=n(57477),u=n(71728),l=n(85626),d=n(85879),p=n(81037),f=n(67814),h=n.n(f),_=n(14168),m=n.n(_),g=n(87363),T=n(30722);function E(e){var t=e.className,n=e.tag,r=e.name,o=e.value,i=e.isFormatted,a=(0,u._)(e,["className","tag","name","value","isFormatted"]),l="div";return n?l=n:a.href?l="a":a.onClick&&(l=p.ZP),(0,d.tZ)(l,(0,s._)((0,c._)({className:h()("NumberBoard-item",t)},a),{children:(0,d.BX)("div",{className:"NumberBoard-itemInner",children:[(0,d.tZ)("div",{className:"NumberBoard-itemName",children:r}),(0,d.tZ)("strong",{className:"NumberBoard-itemValue",title:o,children:void 0!==i&&i?o:(0,T.uf)(o)})]})}))}var y=function(e){(0,a._)(n,e);var t=(0,l._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.divider,r=e.children,o=e.items,i=(0,u._)(e,["className","divider","children","items"]);return(0,d.tZ)("div",(0,s._)((0,c._)({className:h()("NumberBoard",t,{"NumberBoard--divider":n})},i),{children:r||o.map(function(e){return(0,d.tZ)(E,(0,c._)({},e),e.name)})}))}}]),n}(g.Component);(0,i._)(y,"propTypes",{divider:m().bool}),(0,i._)(y,"defaultProps",{divider:!1}),(0,i._)(y,"Item",E);var C=y},37719:function(e,t,n){"use strict";n.d(t,{F:function(){return o},X:function(){return r}});var r=new Set(["clickCommentInput","toggleLike"]),o=39},76536:function(e,t,n){"use strict";n.d(t,{x:function(){return f},Z:function(){return M}});var r=n(85879),o=n(62880),i=n(37719),a=n(94009),c=n(7835),s=n(87363),u=n.n(s),l=n(32210),d=function(){var e,t=document.querySelectorAll(".RichContent-actions");if(t.length>0){var n=Array.from(t).find(function(e){var t=e.classList;return t.contains("Sticky")&&t.contains("is-fixed")&&t.contains("is-bottom")});return(null==n?void 0:n.clientHeight)||0}var r=document.querySelectorAll(".oia-action-bar");return r.length>0&&(null===(e=r[0])||void 0===e?void 0:e.clientHeight)||0},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,t=(0,a._)((0,s.useState)(0),2),n=t[0],r=t[1],o=(0,s.useRef)();return(0,c.b)(function(){return r(d()),o.current=(0,l.subscribe)("scrollEnd",function(){r(d())}),function(){o.current&&o.current.unsubscribe()}}),n+e};function f(){var e=p(0);return(0,r.BX)(r.HY,{children:[(0,r.tZ)("div",{css:{height:i.F+30+12+e}}),(0,r.tZ)(o.dh,{})]})}var h=n(55164),_=n(65733),m=n(19706),g=n(92258),T=n(63638),E=n(3028),y=n(80550),C=n(58909),S=n(7407),I=n(81037),A=n(66980),b=Object.assign,w=function(e){return u().createElement(A.Z,b({width:"42",height:"30",fill:"none",viewBox:"0 0 42 30"},e),u().createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M7.223 29.227 6.52 26H4a4 4 0 0 1-4-4V8a4 4 0 0 1 4-4h34a4 4 0 0 1 4 4v14a4 4 0 0 1-4 4H13.58l-5.274 3.654a.7.7 0 0 1-1.083-.427ZM6.197 10.98c-.247.7-.852 1.929-.852 1.929s.71.01 1.314-.314c.584-.314.848-.788 1.057-1.512l.047-.159h1.196v2.875a26.8 26.8 0 0 1-.035.764H6.799c-.765 0-1.386.62-1.386 1.386h3.382c-.1.775-.24 1.425-.415 1.905-.45 1.24-.98 2.063-1.56 2.757-.534.638-1.62 1.559-1.62 1.559s1.622.615 2.81-.497c.719-.673 1.364-1.997 1.672-2.99a14.97 14.97 0 0 0 .588-2.734h3.084v-.72a.666.666 0 0 0-.666-.666H10.38c.01-.244.018-.499.02-.764v-2.874h2.644v-.677a.71.71 0 0 0-.71-.71H8.196l.043-.13c.141-.43.596-1.744.596-1.744s-.645-.042-1.248.37c-.298.202-.473.357-.711 1.016-.192.529-.37 1.045-.514 1.456l-.165.474ZM35.69 9.944l.441-.026c.2-.208.457-1.25.357-1.578-.04-.131-.11-.349-.33-.297-.583.14-1.085.244-2.215.379-1.395.164-2.022.21-3.887.346l-.154.011c-3.485.255-6.582.377-6.582.377 0 .756.63 1.36 1.385 1.328 1.18-.049 2.906-.13 4.656-.216v4.819h-6.618c0 .765.621 1.386 1.386 1.386h5.232v3.698c-.005.465-.24.625-.636.634h-2.026c.147.657.765 1.208 1.165 1.369.511.207 1.089.166 1.334.149a4.74 4.74 0 0 1 .066-.005c.706-.036 1.537-.434 1.537-1.869v-3.976h5.844a.666.666 0 0 0 .666-.666v-.72h-6.51v-4.89c2.165-.108 4.14-.21 4.889-.253Zm-21.788-.405h6.393v11.158H17.8l-2.126 1.353-.21-1.353h-1.563V9.539Zm1.441 9.772h.891l.122.79 1.242-.79h1.255v-8.386h-3.51v8.386Zm9.015-7.66 2.203 3.057 1.169-.845-1.503-2.083a1.197 1.197 0 0 0-1.674-.27l-.195.14Zm11.374-.06L33.39 14.69l-1.15-.868 1.62-2.143a1.2 1.2 0 0 1 1.676-.233l.196.146ZM9.825 18.21l1.212-.78 1.602 2.382c.25.446.187.863.147 1.134v.001c-.107.726-.35 1.161-.35 1.161l-2.61-3.898Z",clipRule:"evenodd"}))},Z=function(e){var t=e.onClick;return(0,r.BX)(I.ZP,{color:"blue",preset:"primary",onClick:t,css:{fontSize:16,pointerEvents:"auto",height:"50px",width:"170px",borderRadius:"100px",display:"flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap"},children:[(0,r.tZ)(w,{css:{marginRight:"8px"}}),"App 内打开"]})},x=function(e){var t=e.onClick;return(0,r.tZ)(Z,{onClick:t})},k=n(17057),R=n(67814),N=n.n(R),O={ease:"easeOut",duration:.3},P=function(e){var t=e.children,n=e.className,o=p();return(0,r.tZ)(k.d7.div,{initial:{opacity:0,translateY:8},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:8},transition:O,className:N()("OpenInAppButton is-higher",n),css:{position:"fixed",display:"flex",justifyContent:"center",top:"auto",left:16,bottom:o,transition:"bottom 200ms ease-in-out",width:"calc(100vw - 32px)",zIndex:1,pointerEvents:"none"},children:t})},D=n(258),L=function(e){var t=e.onClick,n=e.href,o=e.className,i=(0,y.F)(!1),a=(0,g.useSelector)(C.ib),c=(0,T.useTracker)().trackEvent,s=(0,_.A)(null!=t?t:function(){(0,D.Z)({trackEvent:c,href:n,zaV3Text:"底部打开App按钮",noEnteringSignin:!!a,from:"poplayer"})});return(0,r.tZ)(m.M,{exitBeforeEnter:!0,initial:!1,children:i&&(0,r.tZ)(P,{className:o,children:(0,r.tZ)(x,{onClick:s},"button")})})},M=(0,E.Z)(null)(function(e){var t=(0,g.useSelector)(S.cM),n=t.oppoSearch,o=t.huaweiSearch,i=(0,g.useSelector)(S.ze);return n||i?null:(0,r.tZ)(L,(0,h._)({},e,o&&{onClick:function(){return location.href="https://onelink.zhihu.com/onelink?id=711"}}))})},258:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(82452),o=n(57138);function i(e,t){var n=e.trackEvent,i=e.zaV3Text,a=e.href,c=e.from,s=a||(0,o.MN)((0,o.Qu)(location.pathname));null==n||n({eventType:"Click",action:"OpenUrl",block:"OpenInAppButton",elementLocation:{type:"Button",text:i}},{link:{url:s},configMap:{callback_from:c}}),(0,r.rH)(s,t)}},78580:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(85879),o=n(87641);function i(e){var t=e.className;return(0,r.tZ)(o.xv,{fontSize:"11px",color:"MapBrand",lineHeight:"20px",height:20,mr:"8px",px:"6px",flexShrink:0,css:function(e){return{borderRadius:6,backgroundColor:e.colorMod(e.colors.MapBrand).alpha(.08)}},className:t,children:"付费专栏"})}},7464:function(e,t,n){"use strict";n.d(t,{Z:function(){return E}});var r=n(55164),o=n(57477),i=n(94009),a=n(85879),c=n(95939),s=n(74135),u=n(87363),l=n(87641),d=n(66913),p=n(81956),f=n(9887),h=n(71728),_=function(e){var t=e.children,n=(0,h._)(e,["children"]);return(0,a.tZ)(l.xv,(0,o._)((0,r._)({color:"GBK06A",fontSize:"13px",lineHeight:"18px"},n),{children:t}))},m=n(51455),g=function(e){var t=e.type,n=e.price;switch(t){case m.vl:return n;case m.iC:return"999999";default:return"0"}},T=function(e){var t=e.type;return{type:t,price:g({type:t,price:e.price})}},E=(0,u.forwardRef)(function(e,t){var n=e.payTypeConfig,h=e.columnId,g=e.contentId,E=e.contentType,y=e.radioButtonSize,C=void 0===y?20:y,S=e.wrapperClassName,I=e.updateDraft,A=(0,p.Z)(),b=(0,i._)((0,u.useState)(!1),2),w=b[0],Z=b[1],x=(0,i._)((0,u.useState)({}),2),k=x[0],R=x[1],N=(null==k?void 0:k.columnPrice)?(k.columnPrice/100).toFixed(2):"";(0,u.useImperativeHandle)(t,function(){return{validate:function(){var e,t=n||{},r=t.type,o=t.price,i=void 0===o?"":o;return r?r!==m.vl?{success:!0}:""===i?{success:!1,error:"请设置单章节价格"}:isNaN(i)||i<1||i>1e4?{success:!1,error:"单章节价格 1-10000 元"}:(null===(e=i.split(".")[1])||void 0===e?void 0:e.length)>2?{success:!1,error:"单章节价格最多保留两位小数"}:N&&i>parseFloat(N)?{success:!1,error:"单章节价格需小于等于专栏价格"}:{success:!0}:{success:!1,error:"请选择付费类型"}}}});var O=(0,u.useCallback)(function(e){A("/api/v4/column/paid-column/can_update_fields",{method:"GET",query:e}).then(function(e){R(e.payload.data||{})}).catch(function(){R({})})},[A]);(0,u.useEffect)(function(){O({column_id:h,content_id:g,content_type:E})},[h,g,E,O]);var P=function(e){I(T({type:e,price:""}))},D=function(e){I(T((0,o._)((0,r._)({},n),{price:e})))},L=(0,i._)((0,u.useMemo)(function(){var e,t;return[null===(e=k.disabledKeys)||void 0===e?void 0:e.includes(d.pL),(null===(t=k.disabledReasons)||void 0===t?void 0:t[(0,s.camelize)(d.pL)])||"每个自然周只能修改一次"]},[k]),2),M=L[0],B=L[1],U=n||{},G=U.type,F=U.price;return(0,a.BX)("div",{className:"PaymentTypeSetting-item PaymentTypeSetting-".concat(void 0===S?"":S),children:[(0,a.tZ)("div",{className:"PaymentTypeSetting-labelName",children:"付费类型"}),(0,a.BX)("div",{className:"PaymentTypeSetting-typeContainer",children:[(0,a.tZ)("div",{className:"PaymentTypeSetting-radioContainer",children:m.rE.map(function(e){return(0,a.BX)("label",{className:"PaymentTypeSetting-radioLabel",children:[(0,a.tZ)(c.Z,{size:C,disabled:M,onChange:function(){P(e.value)},checked:G===e.value}),e.label]},e.value)})}),G===m.iC&&(0,a.tZ)(l.xv,{color:"GBK06A",mt:"8px",css:{fontSize:"13px",lineHeight:"18px"},children:"用户购买专栏后，可阅读该专栏下的全部内容"}),G===m.vl&&(0,a.BX)("div",{className:"PaymentTypeSetting-singlePurchaseContainer",children:[(0,a.tZ)(_,{children:"单章节价格"}),(0,a.tZ)(f.Z,{placeholder:"输入价格1-10000",disabled:M,value:F,onChange:function(e){var t=e.target.value;D(t),t>=parseFloat(N)?Z(!0):Z(!1)},className:"PaymentTypeSetting-singlePurchaseInput"}),(0,a.tZ)(_,{css:{marginLeft:"4px"},children:"元"}),(0,a.tZ)(_,{css:function(e){return{color:w?e.colors.MapCriticalTip:e.colors.MapText06A}},children:"(专栏定价 ".concat(N," 元，单章节价格需低于专栏价格)")})]}),M&&(0,a.tZ)(_,{css:function(e){return{color:e.colors.MapCriticalTip}},children:B})]})]})})},51455:function(e,t,n){"use strict";n.d(t,{iC:function(){return o},rE:function(){return a},v8:function(){return r},vl:function(){return i}});var r=1,o=2,i=3,a=[{value:1,label:"免费"},{value:2,label:"不支持单章节购买"},{value:3,label:"支持单章节购买"}]},13554:function(e,t,n){"use strict";n.d(t,{k:function(){return f}});var r=n(22107),o=n(94707),i=n(86325),a=n(94009),c=n(85626),s=n(53845),u=n(64777),l=n(38163),d=(0,u.k5)(s[0].stickers),p=function(e){(0,i._)(n,e);var t=(0,c._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"checkIsVoidElement",value:function(e){return this.isVoidElement(e)}}]),n}(l._b),f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;if(!t||0===t.length)return e;var n=new Map(t.map(function(e){return[e.placeholder,e.staticImageUrl]})),r=new Set(["pre","code","script","style","textarea","a"]),o=[],i=0,c=new p({onopentag:function(e,t){r.has(e)&&i++,o.push("<"+e);var n=!0,s=!1,u=void 0;try{for(var l,d=Object.entries(t)[Symbol.iterator]();!(n=(l=d.next()).done);n=!0){var p=(0,a._)(l.value,2),f=p[0],h=p[1];o.push(" ".concat(f,'="').concat(h,'"'))}}catch(e){s=!0,u=e}finally{try{n||null==d.return||d.return()}finally{if(s)throw u}}c.checkIsVoidElement(e)?o.push(" />"):o.push(">")},ontext:function(e){if(0===i){var t=e.replace(/\[([^\]]+)\]/g,function(e){var t=n.get(e);return t?'<img src="'.concat(t,'" loading="lazy" class="sticker" width="20" height="20" alt="').concat(e,'" style="margin-bottom: -4px;" />'):e});o.push(t)}else o.push(e)},onclosetag:function(e){r.has(e)&&i--,c.checkIsVoidElement(e)||o.push("</".concat(e,">"))}},{decodeEntities:!1,lowerCaseAttributeNames:!1});return c.write(e),c.end(),o.join("")}},16028:function(e,t,n){"use strict";n.d(t,{Z:function(){return G}});var r=n(55164),o=n(57477),i=n(71728),a=n(79065),c=n(85879),s=n(65733),u=n(41402),l=n(87363),d=n(92258),p=n(14914),f=n(87641),h=n(55536),_=n(63638),m=n(1733),g=n(53171),T=n(80714),E=n(85576),y=n(3028),C=n(40382),S=n(49899),I=n(38322),A=n.n(I),b=n(55344),w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(0,d.useDispatch)(),n=(0,d.useSelector)(function(t){return A()(t.switches,e)},d.shallowEqual);return(0,l.useEffect)(function(){t((0,b.X2)(e))},[t].concat((0,S._)(e))),n},Z={Question:"8413324000",Analytics:"0513324000"},x=function(e){var t=(0,d.useDispatch)(),n=(0,d.useSelector)(function(t){return(0,C.J31)(t,e)}),r=w(["isCreator"]).isCreator;return(0,l.useEffect)(function(){r&&t((0,C.LOu)(e))},[t,e,r]),n},k=n(50953),R=n(84954),N=n.p+"assets/answer.cf78e2ff.png",O=n.p+"assets/article.58c0b223.png",P=n.p+"assets/pin.fdd0b57c.png",D=n.p+"assets/question.a5a0c912.png",L=n.p+"assets/video.eb5f3bfe.png";function M(){var e=(0,a._)(["\n          line-height: 40px;\n          white-space: nowrap;\n          color: var(--MapText03A);\n          font-size: 13px;\n          font-weight: 500;\n          display: flex;\n          align-items: center;\n          padding-left: 24px;\n          padding-right: 24px;\n          gap: 12px;\n          &:hover {\n            color: var(--MapText03A) !important;\n            background: var(--MapUIFrame10A) !important;\n          }\n        "]);return M=function(){return e},e}function B(){var e=(0,a._)(["\n                &.Popover-content--bottom.Popover-content--arrowed {\n                  margin-top: 8px;\n                }\n              "]);return B=function(){return e},e}var U=function(e){return(0,c.tZ)(_.ZAClick,(0,r._)({zaType:"Button",zaAction:"OpenUrl",zaText:!0},e))},G=(0,h.compose)((0,y.Z)(null),p.withRouter,E.Z,R.ru)(function(e){var t=e.className,n=e.toggler,a=e.authRequired,p=e.realNameRequired,h=e.inAppHeader,E=e.forwardedRef,y=(0,i._)(e,["className","toggler","authRequired","realNameRequired","inAppHeader","forwardedRef"]),S=(0,k.Z)(["isOrg"]),I=x(Z.Question),A=(0,d.useSelector)(C.F07),b=(0,s.A)(function(){(0,g.Nb)()}),w=(0,s.A)(function(){p(function(){var e="https://".concat(T.Z.wwwHost)+(S.isOrg?"/organization/question/recommend#recommend":I||!A?"/creator/featured-question/invited":"/question/waiting");window.open(e)})()}),R=(0,s.A)(function(){p(function(){var e="//".concat(T.Z.zhuanlanHost,"/write");window.open(e)})()}),G=(0,s.A)(function(){a(function(){return p(function(){var e="https://".concat(T.Z.wwwHost,"/upload-video?entry=navPanel");window.open(e)})()})()});return(0,l.useImperativeHandle)(E,function(){return{ask:b}}),(0,c.tZ)(u.ms,{children:function(e){var i=e.css,a=i(M());return(0,c.tZ)(_.ZAEnv,{extra:{configMap:{plus_panel_status:h?"popup_normal":"popup_swipe"}},children:(0,c.BX)(m.ZP,(0,o._)((0,r._)({toggleEvent:"click",stickHover:!0,placement:"bottom",className:t,toggler:n,menuContainerClassName:i(B()),positionStatus:"fixed",hideOnScroll:!0,arrowed:!0,itemClassName:a},y),{children:[(0,c.BX)(U,{as:m.sN,zaModuleId:"plus_panel_popup_question_button",onClick:b,children:[(0,c.tZ)(f.Ee,{size:20,src:D}),"提问题"]}),(0,c.BX)(U,{as:m.sN,zaModuleId:"plus_panel_popup_answer_button",onClick:w,children:[(0,c.tZ)(f.Ee,{size:20,src:N}),"写回答"]}),(0,c.BX)(U,{as:m.sN,zaModuleId:"plus_panel_popup_pin_button",onClick:function(){return(0,g.pZ)(null)},children:[(0,c.tZ)(f.Ee,{size:20,src:P}),"发想法"]}),(0,c.BX)(U,{as:m.sN,zaModuleId:"plus_panel_popup_post_button",onClick:R,children:[(0,c.tZ)(f.Ee,{size:20,src:O}),"写文章"]}),(0,c.BX)(U,{as:m.sN,zaModuleId:"plus_panel_popup_zvideo_button",onClick:G,children:[(0,c.tZ)(f.Ee,{size:20,src:L}),"发视频"]}),(0,c.tZ)(_.ZAShow,{as:"div",zaType:"Block",zaModuleId:"plus_panel_popup"})]}))})}})})},80692:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(85879),o=n(67814),i=n.n(o),a={Attention:"NGMMjPlIgmNJSiEet7HX"},c=n(4526),s=n(3426),u=function(e){var t=e.placement,n=void 0===t?c.BOTTOM:t,o=e.children,u=e.target,l=e.container,d=e.isOpen,p=e.isFixed,f=void 0!==p&&p,h=e.repositionKey,_=e.boundary,m=e.className,g=e.isListenNode;return(0,r.tZ)(s.Z,{arrowed:!0,listenResize:!0,placement:n,target:u,container:l,isOpen:d,className:i()("AttentionPopover",a.Attention,m),fixed:f,repositionKey:h||String(f),boundary:_,isListenNode:g,children:o})}},3426:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(15030),u=n(55164),l=n(57477),d=n(71728),p=n(85626),f=n(85879),h=n(67814),_=n.n(h),m=n(14168),g=n.n(m),T=n(87363),E=n(61533),y=n(17002),C=n(90746),S=n(4526),I=n(15243),A=n(58357),b=function(e){(0,c._)(n,e);var t=(0,p._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"listenNodeDisconnect",function(){}),(0,a._)((0,r._)(e),"state",{placement:e.props.placement}),(0,a._)((0,r._)(e),"position",function(){var t=e.props,n=t.target,r=t.container,o=t.placement,i=t.fixed,a=t.boundary;if(e.element&&n){var c=(0,s._)(n,HTMLElement)?n:(0,E.findDOMNode)(n),u=document.body;r&&(u=(0,s._)(r,HTMLElement)?r:(0,E.findDOMNode)(r));var l=(0,A.Z)(c.getBoundingClientRect(),(0,C.Z)(a,u),e.element.getBoundingClientRect(),o);i||(l.targetContainerStyle.left+=window.pageXOffset,l.targetContainerStyle.top+=window.pageYOffset),e.setState(l)}}),(0,a._)((0,r._)(e),"handleRef",function(t){e.element=t,e.props.onRef(t)}),(0,a._)((0,r._)(e),"handleAfterEnter",function(){e.position()}),e}return(0,i._)(n,[{key:"listenNode",value:function(e){if("function"==typeof MutationObserver){var t=new MutationObserver(e);return t.observe(document.body,{attributes:!0,childList:!0,subtree:!0}),{isSuccess:!0,disconnect:t.disconnect}}return{isSuccess:!1}}},{key:"componentDidMount",value:function(){if(this.props.isListenNode){var e=this.listenNode(this.position),t=e.isSuccess,n=e.disconnect;t&&(this.listenNodeDisconnect=n)}this.props.listenResize&&window.addEventListener("resize",this.position)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.target,r=t.repositionKey;(e.target!==n||e.repositionKey!==r)&&requestAnimationFrame(this.position)}},{key:"componentWillUnmount",value:function(){this.props.isListenNode&&this.listenNodeDisconnect(),this.props.listenResize&&window.removeEventListener("resize",this.position)}},{key:"render",value:function(){var e,t=this.props,n=t.isOpen,r=t.arrowed,o=t.fixed,i=t.children,c=t.className,s=(t.placement,t.repositionKey,t.onRef,t.listenResize,t.target,t.container,t.boundary,(0,d._)(t,["isOpen","arrowed","fixed","children","className","placement","repositionKey","onRef","listenResize","target","container","boundary"])),p=this.state,h=p.arrowStyle,m=p.targetContainerStyle,g=p.placement,T=n&&(0,f.BX)("div",(0,l._)((0,u._)({className:_()(c,"Popover-content","Popover-content--".concat(g),I.Z.content,I.Z["content--".concat(g)],(e={"Popover-content--fixed":o,"Popover-content--arrowed":r},(0,a._)(e,I.Z["content--fixed"],o),(0,a._)(e,I.Z["content--arrowed"],r),e)),ref:this.handleRef,style:m},s),{children:[r&&(0,f.tZ)("span",{className:_()("Popover-arrow","Popover-arrow--".concat(g),I.Z.arrow,I.Z["arrow--".concat(g)]),style:h}),i]}));return(0,f.tZ)(y.Z,{onAfterEnter:this.handleAfterEnter,transitionName:I.Z.content,timeout:200,children:T})}}]),n}(T.Component);(0,a._)(b,"propTypes",{isOpen:g().bool,arrowed:g().bool,fixed:g().bool,placement:g().oneOf(Object.keys(S).map(function(e){return S[e]})),repositionKey:g().string,onRef:g().func,listenResize:g().bool,container:g().object,boundary:g().shape({getElement:g().func,padding:g().number,getBoundaryInfo:g().func}),isListenNode:g().bool}),(0,a._)(b,"defaultProps",{isOpen:!1,arrowed:!1,fixed:!1,placement:"bottom",onRef:function(){}}),t.Z=b},90746:function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=e.getElement,r=e.padding,o=void 0===r?0:r,i=e.getBoundaryInfo;if(i)return i();var a={};n?a=n():t&&(a=t);var c=a.getBoundingClientRect();return{top:c.top+o,right:c.right-o,bottom:c.bottom-o,left:c.left+o}}n.d(t,{Z:function(){return r}})},7181:function(e,t,n){"use strict";n.d(t,{Z:function(){return k}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(57477),l=n(49899),d=n(85626),p=n(85879),f=n(67814),h=n.n(f),_=n(6907),m=n(14168),g=n.n(m),T=n(87363),E=n(61533),y=n(32210),C=n(65522),S=n(17002),I=n(90746),A=n(4526),b=n(15243),w=n(58357),Z=b.Z.content,x=["appear","enter","enter-active","exit","exit-active","leave","leave-active"].map(function(e){return"".concat(Z,"-").concat(e)}),k=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{id:null,opened:!1,arrowStyle:null,targetContainerStyle:null,placement:null}),(0,a._)((0,r._)(e),"handleMouseEnter",function(t){var n=e.props,r=n.delay,o=n.enterDelay,i=n.onMouseEnter;i&&i(t),t.isDefaultPrevented()||(clearTimeout(e.openTask),clearTimeout(e.closeTask),e.openTask=setTimeout(function(){e.openTask=null,e.open()},null!=o?o:r))}),(0,a._)((0,r._)(e),"handleMouseLeave",function(){var t=e.props,n=t.stickHover,r=t.delay,o=t.leaveDelay;!n&&(clearTimeout(e.openTask),clearTimeout(e.closeTask),e.state.opened&&(e.closeTask=setTimeout(function(){e.closeTask=null,e.close()},null!=o?o:r)))}),(0,a._)((0,r._)(e),"handleClick",function(t){var n=e.props.onClick;n&&n(t),t.isDefaultPrevented()||e.open()}),(0,a._)((0,r._)(e),"position",function(){if(!e.toggler||!e.targetContainer)return null;var t=e.props,n=t.placement,r=t.getContainer,o=t.position,i=t.positionStatus,a=t.boundary,c=(0,E.findDOMNode)(e.toggler),s=r(),u=e.targetContainer.getBoundingClientRect(),l=o?o(c,e.targetContainer):(0,w.Z)(c.getBoundingClientRect(),(0,I.Z)(void 0===a?{}:a,s),u,n);return"fixed"!==i&&l&&l.targetContainerStyle&&(l.targetContainerStyle.top+=window.pageYOffset,l.targetContainerStyle.left+=window.pageXOffset),e.setState(l),l}),(0,a._)((0,r._)(e),"close",function(){if(e.state.opened){var t=e.props.onClose;e.setState({opened:!1},function(){e.removeGlobalListener(),t&&t()})}}),(0,a._)((0,r._)(e),"open",function(){e.state.opened||e.setState({opened:!0})}),(0,a._)((0,r._)(e),"handleAfterEnter",function(){var t=e.props.onOpen,n=e.position();setTimeout(function(){e.addGlobalListener()},0),t&&t(n)}),(0,a._)((0,r._)(e),"handleGlobalClose",function(t){var n=e.props,r=n.preventCloseOnTarget;n.globalClose&&(r?e.toggler&&e.targetContainer&&document.body.contains(t.target)&&t.target.classList&&!e.targetContainer.contains(t.target)&&!(0,E.findDOMNode)(e.toggler).contains(t.target)&&!t.target.classList.contains("preventCloseOnTarget")&&e.close():e.close())}),(0,a._)((0,r._)(e),"handleGlobalKeyDown",function(t){27===t.keyCode&&e.close()}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){this.setState({id:(0,_.E)("Popover")})}},{key:"getSnapshotBeforeUpdate",value:function(){return this.targetContainer?Array.from(this.targetContainer.classList).filter(function(e){return x.includes(e)}):null}},{key:"componentDidUpdate",value:function(e,t,n){if(n&&n.length>0&&this.targetContainer&&this.targetContainer.classList){var r;(r=this.targetContainer.classList).add.apply(r,(0,l._)(n))}}},{key:"componentWillUnmount",value:function(){clearTimeout(this.openTask),clearTimeout(this.closeTask),this.removeGlobalListener()}},{key:"getEventProps",value:function(){var e=this.props.toggleEvent;return"hover"===e?{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave}:"click"===e?{onClick:this.handleClick}:{}}},{key:"addGlobalListener",value:function(){var e=this;document.addEventListener("click",this.handleGlobalClose),document.addEventListener("keydown",this.handleGlobalKeyDown),this.subscriptions=[(0,y.subscribe)("resize",this.position)],(this.props.scrollOutClear||this.props.hideOnScroll)&&this.subscriptions.push((0,y.subscribe)("scroll",function(){var t;!e.props.hideOnScroll&&(t=e.targetContainer.getBoundingClientRect()).top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)||e.handleGlobalClose()}))}},{key:"removeGlobalListener",value:function(){document.removeEventListener("click",this.handleGlobalClose),document.removeEventListener("keydown",this.globalKeyDown),this.subscriptions&&(this.subscriptions.forEach(function(e){return e.unsubscribe()}),this.subscriptions=null)}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.toggler,o=n.toggleEvent,i=n.arrowed,c=n.children,l=n.className,d=n.targetClassName,f=n.positionStatus,_=n.noLayer,m=n.transitionEnterTimeout,g=n.transitionLeaveTimeout,E=this.state,y=E.id,I=E.opened,A=this.getEventProps(),w=(0,s._)({ref:function(e){t.toggler=e},id:"".concat(y,"-toggle"),"aria-haspopup":!0,"aria-expanded":I},A),x=this.state,k=x.arrowStyle,R=x.targetContainerStyle,N=x.placement,O=I&&(0,p.BX)("div",(0,u._)((0,s._)({className:h()("Popover-content","Popover-content--".concat(N),b.Z.content,b.Z["content--".concat(N)],d,(e={"Popover-content--fixed":"fixed"===f,"Popover-content--arrowed":i},(0,a._)(e,b.Z["content--fixed"],"fixed"===f),(0,a._)(e,b.Z["content--arrowed"],i),e)),ref:function(e){t.targetContainer=e},style:R,id:"".concat(y,"-content"),"aria-labelledby":"".concat(y,"-toggle")},"hover"===o&&A),{children:[i&&(0,p.tZ)("span",{className:h()("Popover-arrow","Popover-arrow--".concat(N),b.Z.arrow,b.Z["arrow--".concat(N)]),style:k}),c]}));return I&&!_&&(O=(0,p.tZ)(C.Z,{children:O})),(0,p.BX)("div",{className:h()("Popover",b.Z.Popover,l),children:[(0,T.cloneElement)(r,w),(0,p.tZ)(S.Z,{transitionName:Z,timeout:{enter:m,exit:g},onAfterEnter:this.handleAfterEnter,children:O})]})}}]),n}(T.Component);k.propTypes={toggler:g().node.isRequired,toggleEvent:g().string,targetClassName:g().string,delay:g().number,enterDelay:g().number,leaveDelay:g().number,onOpen:g().func,onClose:g().func,noLayer:g().bool,getContainer:g().func,placement:g().oneOf(Object.keys(A).map(function(e){return A[e]})),arrowed:g().bool,stickHover:g().bool,position:g().func,positionStatus:g().string,preventCloseOnTarget:g().bool,globalClose:g().bool,scrollOutClear:g().bool,hideOnScroll:g().bool,boundary:g().shape({padding:g().number,getElement:g().func,getBoundaryInfo:g().func})},k.defaultProps={toggleEvent:"click",delay:200,getContainer:function(){return document.body},placement:"bottom",arrowed:!1,preventCloseOnTarget:!1,globalClose:!0,stickHover:!1,noLayer:!1,scrollOutClear:!1,transitionEnterTimeout:200,transitionLeaveTimeout:200}},4526:function(e,t,n){"use strict";n.r(t),n.d(t,{BOTTOM:function(){return a},BOTTOM_LEFT:function(){return c},BOTTOM_RIGHT:function(){return s},LEFT:function(){return r},LEFT_BOTTOM:function(){return p},LEFT_TOP:function(){return d},RIGHT:function(){return o},RIGHT_BOTTOM:function(){return h},RIGHT_TOP:function(){return f},TOP:function(){return i},TOP_LEFT:function(){return u},TOP_RIGHT:function(){return l}});var r="left",o="right",i="top",a="bottom",c="bottom-left",s="bottom-right",u="top-left",l="top-right",d="left-top",p="left-bottom",f="right-top",h="right-bottom"},58357:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(94009),o=n(4526),i=[o.TOP,o.BOTTOM],a=[o.LEFT,o.RIGHT];function c(e,t,n,c){var s=(0,r._)(c.split("-"),2),u=s[0],l=s[1],d=(_=t.top,m=t.bottom,g=t.left,T=t.right,{top:Math.max(_,0),bottom:Math.min(Math.max(m,0),window.innerHeight),left:Math.max(g,0),right:Math.min(Math.max(T,0),window.innerWidth)}),p={},f={},h=u;if(i.includes(u)){var _,m,g,T,E,y,C,S=d.right-n.width,I=d.left;if(l===o.LEFT?(E=e.left,y=I):l===o.RIGHT?(E=e.right-n.width,y=S):(E=e.left+e.width/2-n.width/2,y=I),S>I?E<I?f.left=I:E<S?f.left=E:f.left=S:f.left=y,e.width<=n.width){var A=e.left+e.width/2;p.left=A-f.left}else p.left=n.width/2;u===o.BOTTOM&&e.bottom+n.height>d.bottom&&e.top-n.height>d.top&&(h=o.TOP),u===o.TOP&&e.bottom+n.height<d.bottom&&e.top-n.height<d.top&&(h=o.BOTTOM),C=(0,r._)(h===o.TOP?[n.height,e.top-n.height]:[0,e.bottom],2),p.top=C[0],f.top=C[1]}if(a.includes(u)){var b,w,Z,x=d.bottom-n.height,k=d.top;if(l===o.TOP?(b=e.top,w=k):l===o.BOTTOM?(b=e.bottom-n.height,w=x):(b=e.top+e.height/2-n.height/2,w=k),x>k?b<k?f.top=k:b<x?f.top=b:f.top=x:f.top=w,e.width<=n.width){var R=e.top+e.height/2;p.top=R-f.top}else p.top=n.height/2;u===o.RIGHT&&e.right+n.width>d.right&&e.left-n.width>d.left&&(h=o.LEFT),u===o.LEFT&&e.right+n.width<d.right&&e.left-n.width<d.left&&(h=o.RIGHT),Z=(0,r._)(h===o.LEFT?[n.width,e.left-n.width]:[0,e.right],2),p.left=Z[0],f.left=Z[1]}return{arrowStyle:p,targetContainerStyle:f,placement:h}}},66268:function(e,t,n){"use strict";n.d(t,{rh:function(){return M},Rt:function(){return L},at:function(){return O}});var r=n(55164),o=n(94009),i=n(85879),a=n(91850),c=n(82644),s=n(89965),u=n.n(s),l=n(87363),d=n.n(l),p=n(92258),f=n(87641),h=n(63638),_=n(75334),m=n(3681),g=n(66980),T=Object.assign,E=function(e){return d().createElement(g.Z,T({width:"20",height:"20",fill:"#06F",viewBox:"0 0 20 20"},e),d().createElement("path",{d:"m4.635 4.884-1.133.647 4.944 8.65 1.132-.647-4.943-8.65Z"}),d().createElement("path",{d:"M18.342 3.003 5.524 4.429l5.093 8.991a1.534 1.534 0 0 1 .14 1.153 1.488 1.488 0 0 1-1.25 1.102 1.448 1.448 0 0 1-1.096-.31 1.501 1.501 0 0 1-.377-.45l-4.975-8.79L2 6.76l5.042 8.882c.23.405.558.742.952.98a2.623 2.623 0 0 0 2.612.056 2.69 2.69 0 0 0 .99-.938l7.306-11.792a.622.622 0 0 0-.233-.883.588.588 0 0 0-.327-.062Zm-8.056 4.902a1.175 1.175 0 0 1-.665-.203 1.214 1.214 0 0 1-.442-.546 1.245 1.245 0 0 1 .256-1.331 1.17 1.17 0 0 1 1.301-.267 1.2 1.2 0 0 1 .536.45 1.24 1.24 0 0 1-.146 1.538 1.18 1.18 0 0 1-.84.36Zm3.82-.114a.756.756 0 0 1-.424-.14.781.781 0 0 1-.278-.357.802.802 0 0 1 .181-.853.762.762 0 0 1 .841-.154c.14.063.257.166.34.297a.798.798 0 0 1 .12.44.795.795 0 0 1-.23.556.761.761 0 0 1-.55.222v-.011Z"}))},y=n(67927),C=n(49899),S=n(95939),I=n(24405),A=n(49274),b=n(31467),w=n(25452),Z=n(23354),x=function(e){var t=(null==e?void 0:e.bindTaskDTO)||{},n=t.taskType,r=t.taskId,o=t.taskName;return[Z.AQ[n],r,o].join("  ").trim()},k=function(e){var t=e.task,n=e.checked,r=(0,I.F)().colors;if(!t.bindTaskDTO)return null;var o=t.bindTaskDTO,a=o.taskType,c=o.taskId,s=o.taskName;return(0,i.BX)(f.kC,{css:{lineHeight:"22px",fontSize:"15px",fontWeight:"500",color:n?r.MapBrand:r.MapText03A,alignItems:"center"},children:[(0,i.tZ)(f.xu,{css:{marginRight:"4px",height:"22px",paddingInline:"6px",borderRadius:"4px",backgroundColor:"#8590A61A",fontSize:"13px",color:n?r.MapBrand:r.MapInfoSub},children:Z.AQ[a]}),(0,i.BX)(f.xv,{children:[c," ",s]})]})},R=function(e){var t=e.children,n=e.onClick,o=e.active,a=e.type,c=(0,I.F)().colors;return(0,i.tZ)(f.xu,{css:(0,r._)({height:"30px",lineHeight:"30px",paddingInline:"15px",borderRadius:"15px",flex:"0 0 auto",fontSize:"12px",color:c.MapText04A,cursor:"pointer",backgroundColor:c.MapUIFrame10A},o?{fontWeight:"500",color:c.MapText02A}:{}),onClick:function(){return n(a)},children:void 0===t?"":t})},N=function(e){var t=e.visible,n=e.onClose,r=e.onConfirm,a=e.value,c=e.taskList,s=void 0===c?[]:c,u=e.permissionList,d=void 0===u?[]:u,p=(0,o._)((0,l.useState)("ALL"),2),h=p[0],_=p[1],m=(0,o._)((0,l.useState)(a),2),g=m[0],T=m[1];(0,l.useEffect)(function(){var e,n;t&&(null==a?void 0:null===(e=a.bindTaskDTO)||void 0===e?void 0:e.taskId)!==(null==g?void 0:null===(n=g.bindTaskDTO)||void 0===n?void 0:n.taskId)&&T(a)},[t]);var E="ALL"===h?s:s.filter(function(e){return e.bindTaskDTO.taskType===h});return(0,i.tZ)(b.Z,{title:"选择芝士任务",size:"large",onClose:n,children:t&&(0,i.BX)(f.xu,{children:[(0,i.tZ)(f.kC,{css:{gap:"8px",justifyContent:"center",marginBottom:"24px"},children:["ALL"].concat((0,C._)(d)).map(function(e){return(0,i.tZ)(R,{type:e,active:h===e,onClick:function(e){_(e)},children:Z.sA[e]},e)})}),(0,i.tZ)(f.xu,{color:"GBK02A",maxHeight:"50vh",minHeight:"".concat(141,"px"),mr:"-24px",pr:"24px",overflowY:"auto",children:(null==E?void 0:E.length)?E.map(function(e){var t,n;return(0,i.BX)(f.kC,{flex:1,py:"12px",justifyContent:"space-between",alignItems:"center",css:function(e){var t=e.colors;return{cursor:"pointer",borderBottom:"1px solid ".concat(t.GBK09A)}},as:"label",children:[(0,i.tZ)(k,{task:e,checked:(null==g?void 0:null===(t=g.bindTaskDTO)||void 0===t?void 0:t.taskId)===e.bindTaskDTO.taskId}),(0,i.tZ)(S.Z,{checked:(null==g?void 0:null===(n=g.bindTaskDTO)||void 0===n?void 0:n.taskId)===e.bindTaskDTO.taskId,onChange:function(){T(e)}})]},e.bindTaskDTO.taskId)}):(0,i.tZ)(A.H.EI1,{content:"暂无可绑定任务"})}),(0,i.BX)(f.kC,{mt:"32px",justifyContent:"center",children:[(0,i.tZ)(w.ZP,{preset:"outline",color:"grey",css:{width:"168px",marginRight:"16px"},onClick:n,children:"取消"}),(0,i.tZ)(w.ZP,{preset:"primary",color:"blue",css:{width:"168px"},disabled:!g,onClick:function(){r(g)},children:"确认"})]})]})})},O=function(e){var t,n=null==e?void 0:null===(t=e.bindTaskDTO)||void 0===t?void 0:t.taskId;return n&&"0"!==n?{bind_operate:"BIND",task_id:n,task_type:e.bindTaskDTO.taskType}:null},P=function(e){var t,n=e.value,s=e.onChange,d=e.taskList,p=e.permissionList,_=e.disabled,m=void 0!==_&&_,g=e.onOpen,T=void 0===g?function(){return!0}:g,y=(0,o._)((0,a.k)(!1),2),C=y[0],S=y[1],I=(0,h.useTracker)().trackEvent;(0,l.useEffect)(function(){m&&C&&S.off()},[m,C,S]);var A=x(n),b=function(){I({eventType:"Click",elementLocation:{type:"Text",text:A||"选择绑定芝士任务",block:{blockText:"PublishSettingZhiTaskBind"}}}),S.on()},w=!!(null==n?void 0:null===(t=n.bindTaskDTO)||void 0===t?void 0:t.taskId)&&(null==n?void 0:n.bindStatus)!==Z.W6.UNBOUND;return(0,i.BX)(f.kC,{flex:1,css:{overflow:"hidden"},alignItems:"center",children:[(0,i.BX)(h.ZAShow,{zaType:"Text",zaText:!0,view:{elementLocation:{block:{blockText:"PublishSettingZhiTaskBind"}}},as:f.kC,p:"3px 0",alignItems:"center",fontSize:"14px",color:"GBL05A",css:function(e){var t=e.colors,n=e.colorMod;return(0,r._)({cursor:m?"not-allowed":"pointer",opacity:m?.5:1},w?{paddingInline:"12px",height:"38px",fontWeight:"500",background:n(t.MapBrand).alpha(.1),borderRadius:"19px",color:t.GBL01A}:{})},onClick:function(){if(!m){var e=T();u()(null==e?void 0:e.then)?e.then(b):!1!==e&&b()}},children:[(0,i.tZ)(E,{css:function(e){var t=e.colors;return{fill:w?t.GBL01A:t.GBL05A,flexShrink:0}}}),w?(0,i.BX)(f.kC,{alignItems:"center",mx:"4px",lineHeight:"20px",children:[(0,i.BX)(f.kC,{alignItems:"center",flexShrink:"0",children:[Z.AQ[n.bindTaskDTO.taskType],(0,i.tZ)(f.xu,{css:function(e){return{height:"12px",width:"1px",backgroundColor:e.colors.MapBrand,marginInline:"4px"}}})]}),(0,i.BX)(f.xv,{css:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:[n.bindTaskDTO.taskId," ",n.bindTaskDTO.taskName]})]}):(0,i.tZ)(f.xv,{mx:"4px",children:"选择绑定芝士任务"}),w&&!m&&(0,i.tZ)(c.HN,{size:"14px",css:{flexShrink:0},onClick:function(e){e.stopPropagation(),null==s||s(null)}})]}),(0,i.tZ)(N,{visible:C,value:n,taskList:d,permissionList:p,onClose:S.off,onConfirm:function(e){null==s||s(e),S.off()}})]})},D=function(e){return(0,i.BX)(f.kC,{py:"11px",children:[(0,i.tZ)(m.gN,{name:"芝士任务",title:"芝士任务绑定",helper:(0,i.tZ)("p",{children:"如该内容为芝士任务投稿内容，需在此处进行对应任务的绑定操作，请在发布前认真检查绑定关系，内容发布后关系即刻生效。"})}),(0,i.tZ)(P,(0,r._)({},e))]})},L=function(e){var t=e.taskList,n=e.permissionList,r=e.commercialZhitaskBindInfo,a=e.onChange,c=(0,o._)((0,l.useState)(null),2),s=c[0],u=c[1],d=!!r,p=function(e){a(e),u(e)};return(0,l.useEffect)(function(){var e;(null==r?void 0:null===(e=r.bindTaskDTO)||void 0===e?void 0:e.taskId)&&p(r)},[d]),(0,i.tZ)(D,{taskList:t,permissionList:n,disabled:(null==s?void 0:s.bindStatus)===Z.W6.BINDING,value:s,onChange:function(e){return p(e)}})},M=function(e){var t=e.taskList,n=e.permissionList,r=e.isAnonymous,o=(0,p.useDispatch)(),a=(0,l.useContext)(_.j),c=a.updateFormData,s=(0,a.getFormData)().commercialZhitaskBindInfo,u=(0,l.useCallback)(function(e){c({commercialZhitaskBindInfo:e})},[c]);return(0,l.useEffect)(function(){(null==s?void 0:s.bindStatus)===Z.W6.UNBIND&&u(null)},[s,u]),(0,i.tZ)(D,{taskList:t,permissionList:n,disabled:(null==s?void 0:s.bindStatus)===Z.W6.BINDING,value:s,onChange:u,onOpen:function(){if(r)return o((0,y.c0)("已经启用匿名的内容不能进行芝士任务绑定","red")),!1}})}},23354:function(e,t,n){"use strict";n.d(t,{AQ:function(){return i},PC:function(){return c},W6:function(){return s},sA:function(){return a}});var r=n(55164),o=n(57477),i={INVITED_TASK:"特邀定制",EVALUATE_TASK:"众测任务",ZHONGYAO_TASK:"众邀任务",SALES_COMMISSION_TASK:"优选带货"},a=(0,o._)((0,r._)({},i),{ALL:"全部"}),c={CHEESE:"CHEESE",COMMERCIAL_VIP:"COMMERCIAL_VIP"},s={FE_INIT:"FE_INIT",BINDING:"BINDING",UNBIND:"UNBIND",UNBOUND:"UNBOUND"}},13905:function(e,t,n){"use strict";n.d(t,{Z:function(){return N}});var r=n(55164),o=n(94009),i=n(85879),a=n(7835),c=n(87363),s=n(92258),u=function(){if("undefined"==typeof window)return"https://bvip.zhihu.com";var e=window.location.host,t=e.includes(".test")||e.includes(".dev")?"dev":"com",n="https://bvip.zhihu.".concat(t),r=/--box-(\d+)--/g.exec(e);return r&&(n="https://ad-business-vip-web--box-".concat(r[1],"--bvip-zhihu-").concat(t,".zpres.zhihu.").concat(t,"/")),n},l=(0,n(4661).FH)("biz",["OPEN_BIZ_VIP","QUERY_BIZ_VIP_STATUS","GET_COMMERCIAL_REPORT_INFO"]),d=n(66268),p=n(23354),f=n(57477),h=n(91850),_=n(65733),m=n(63638),g=n(87641),T=n(71728),E=n(91486),y=n(31467),C=function(e){var t=e.shown,n=e.toggle,o=(0,T._)(e,["shown","toggle"]);return(0,i.tZ)(y.Z,(0,f._)((0,r._)({title:"",subtitle:"",onClose:function(){n()}},o),{children:t&&(0,i.BX)("div",{children:[(0,i.BX)(g.xu,{color:"GBK02A",css:{fontSize:"15px",lineHeight:"22px"},children:[(0,i.tZ)(g.xv,{children:"系统检测到您的账号已开通芝士平台权限。创作者与品牌主的商业合作，需统一通过知乎官方商业合作服务平台「芝士平台」进行。"}),(0,i.tZ)(g.xv,{children:"知享仅针对品牌自营账号开放。如果您是商家，可以在推出芝士平台后，申请开通知享。"}),(0,i.BX)(g.xv,{children:["如仍有疑问，请详询",(0,i.tZ)(g.rU,{href:"https://www.zhihu.com/messages/0cb9df58ed7a3ff685d0ac55d1c1e553",target:"_blank",rel:"noreferrer noopener",color:"primary",children:"@知乎商业小管家\xa0"}),"反馈，我们将积极解决您的问题。"]})]}),(0,i.tZ)("button",{onClick:function(){n()},css:function(e){return[{width:"166px",height:"32px",backgroundColor:e.colors.GBL01A,textAlign:"center",lineHeight:"32px",fontSize:"14px",color:e.colors.GBK99A,borderRadius:"3px",margin:"25px 0 0 93px"}]},children:"知道了"})]})}))},S=n(67927),I=function(e){var t=e.shown,n=e.toggle,a=e.onSuccess,d=e.onFail,p=(0,T._)(e,["shown","toggle","onSuccess","onFail"]),_=(0,s.useDispatch)(),I=(0,o._)((0,c.useState)(!0),2),A=I[0],b=I[1],w=(0,o._)((0,h.k)(!1),2),Z=w[0],x=w[1],k=(0,m.useTracker)().trackEvent;return(0,i.BX)(i.HY,{children:[(0,i.tZ)(y.Z,(0,f._)((0,r._)({title:"商业内容推广",subtitle:"",onClose:function(){k({eventType:"Click",action:"Unknown",elementLocation:{text:"开通商业会员弹窗关闭"}}),n()}},p),{children:t&&(0,i.BX)("div",{children:[(0,i.tZ)(g.xu,{color:"GBK02A",css:{fontSize:"15px",lineHeight:"22px"},children:"报备后，将自动为您开通「知享」试用版，符合商业内容规范的内容可以正常曝光"}),(0,i.BX)(g.kC,{flexDirection:"inherit",flexWrap:"nowrap",alignItems:"center",style:{marginTop:"10px"},children:[(0,i.tZ)(E.C,{onChange:function(){b(!A)},type:"checkbox",checked:A}),(0,i.BX)(g.xv,{ml:"4px",children:["我已阅读并同意",(0,i.tZ)(g.rU,{href:"https://bvip.zhihu.com/agreement",target:"_blank",rel:"noreferrer noopener",color:"primary",children:"《知享服务使用协议》"})]})]}),(0,i.tZ)("button",{disabled:!A,onClick:function(){_({API:{types:l.OPEN_BIZ_VIP,endpoint:"/commercial/vip",root:"".concat(u(),"/api/v1"),method:"POST"}}).then(function(e){var t,n,r=e.payload;if(r.isSuccess){a(),_((0,S.c0)("开通成功"));return}d(),(null==r?void 0:null===(t=r.err)||void 0===t?void 0:t.code)==="-300"?x.on():_((0,S.c0)((null==r?void 0:null===(n=r.err)||void 0===n?void 0:n.msg)||"开通失败","red"))}).catch(function(e){var t;d(),_((0,S.c0)((null==e?void 0:null===(t=e.err)||void 0===t?void 0:t.msg)||"开通失败","red"))}),n()},css:function(e){return[{width:"166px",height:"32px",backgroundColor:e.colors.GBL01A,textAlign:"center",lineHeight:"32px",fontSize:"14px",color:e.colors.GBK99A,borderRadius:"3px",margin:"25px 0 0 93px"},!A&&{cursor:"not-allowed"}]},children:"确认并开通"})]})})),(0,i.tZ)(C,{shown:Z,toggle:x.toggle})]})},A=n(75334),b=n(3681),w=[{type:!1,description:"非商业推广"},{type:!0,description:"商业推广"}],Z=function(e){var t=e.isReport,n=e.commercialPermissionInfo,a=e.setCommercialPermissionInfo,c=e.setIsReport,s=e.validate,u=(0,m.useTracker)().trackEvent,l=(0,o._)((0,h.k)(!1),2),d=l[0],p=l[1];return(0,i.BX)(i.HY,{children:[(0,i.tZ)(b.Qr,{onChange:function(e){if(!s||s()){var t=w.find(function(t){return t.type===e});if(u({eventType:"Click",action:"Unknown",elementLocation:{type:"Button",text:"商业推广-".concat(null==t?void 0:t.description)}}),!0===e&&!(null==n?void 0:n.isCommercialVip)){p.on();return}c(e)}},value:!!t,children:w.map(function(e){return(0,i.tZ)(b.o3,{css:function(e){return{color:e.colors.GBK02A,fontSize:"14px"}},value:e.type,text:e.description},e.type)})}),(0,i.tZ)(I,{shown:d,toggle:p.toggle,onSuccess:function(){c(!0),a(function(e){return(0,f._)((0,r._)({},e),{isCommercialVip:!0})})},onFail:function(){c(!1)}})]})},x=function(e){return(0,i.BX)(g.kC,{py:"11px",children:[(0,i.tZ)(b.gN,{name:"商业推广",title:"商业内容推广",helper:(0,i.BX)(i.HY,{children:[(0,i.tZ)("p",{children:"商业内容是指，未经平台允许，用户以推广曝光为目的，发布含有产品售卖信息、牟利性外链等内容，或引导用户至第三方平台进行交易。"}),(0,i.tZ)("p",{children:"知乎提供了报备功能，创作者可以选择主动对包含商业推广的内容进行报备。对于包含商业推广但是未报备的内容，将按社区规范进行处理"}),(0,i.BX)("p",{style:{marginTop:"10px"},children:["关于报备功能更多的信息，",(0,i.tZ)("a",{href:"https://www.zhihu.com/creator/explore/academy/rights/rights",target:"_blank",rel:"noreferrer noopener",children:"点击前往了解"})]})]})}),(0,i.tZ)(g.xu,{flex:"1",children:(0,i.tZ)(Z,(0,r._)({},e))})]})},k=(0,c.forwardRef)(function(e,t){var n=e.commercialReportInfo,r=e.initCommercialPermissionInfo,a=(0,o._)((0,c.useState)(r),2),s=a[0],u=a[1],l=(0,o._)((0,c.useState)(!1),2),d=l[0],p=l[1],f=!!n;return(0,c.useEffect)(function(){f&&p(n.isReport)},[f]),(0,c.useImperativeHandle)(t,function(){return{getIsReport:function(){return d}}}),(0,i.tZ)(x,{isReport:!!d,commercialPermissionInfo:s,setIsReport:p,setCommercialPermissionInfo:u})}),R=function(e){var t=e.isAnonymous,n=e.updateDraftSettings,r=e.initCommercialPermissionInfo,a=(0,s.useDispatch)(),u=(0,o._)((0,c.useState)(r),2),l=u[0],d=u[1],p=(0,c.useContext)(A.j),f=p.updateFormData,h=(0,p.getFormData)().isReport,m=(0,_.A)(function(e){f({isReport:e}),requestAnimationFrame(n)}),g=(0,_.A)(function(){return!t||(a((0,S.c0)("已经启用匿名的内容不能进行商业推广声明","red")),!1)});return(0,i.tZ)(x,{isReport:!!h,commercialPermissionInfo:l,setIsReport:m,setCommercialPermissionInfo:d,validate:g})},N=function(e){var t=e.type,n=e.questionId,u=e.answerId,f=e.articleId,h=e.reportProps,_=void 0===h?{}:h,m=e.taskBindProps,g=void 0===m?{}:m,T=(0,s.useDispatch)(),E=(0,o._)((0,c.useState)([]),2),y=(0,o._)(E[0],3),C=y[0],S=void 0===C?null:C,I=y[1],A=void 0===I?{}:I,b=y[2],w=void 0===b?"":b,Z=E[1],x="article"===t;return((0,a.b)(function(){T(x?{API:{types:l.QUERY_BIZ_VIP_STATUS,endpoint:"/articles/settings",query:{token:f},method:"GET"}}:{API:{types:l.QUERY_BIZ_VIP_STATUS,endpoint:"/questions/".concat(n,"/answer-settings"),query:{token:u},method:"GET"}}).then(function(e){var t,n=(null==e?void 0:null===(t=e.payload)||void 0===t?void 0:t.commercialPermissionInfo)||{};p.PC.CHEESE===n.businessLine?Z([x?d.Rt:d.rh,{taskList:(n.cheeseTaskList||[]).map(function(e){return{bindStatus:p.W6.FE_INIT,bindTaskDTO:e}}),permissionList:n.cheesePermissionList||[]},p.PC.CHEESE]):p.PC.COMMERCIAL_VIP===n.businessLine&&n.isShowTab&&Z([x?k:R,{initCommercialPermissionInfo:n},p.PC.COMMERCIAL_VIP])})}),p.PC.CHEESE===w&&"answer"===t&&g.isVideoAnswer)?null:S?(0,i.tZ)(S,(0,r._)({},p.PC.CHEESE===w?g:_,A)):null}},34434:function(e,t,n){"use strict";n.d(t,{AI:function(){return E},PH:function(){return C},a9:function(){return S}});var r=n(55164),o=n(57477),i=n(94009),a=n(85879),c=n(91850),s=n(65733),u=n(87363),l=n(92258),d=n(87641),p=n(75334),f=n(21680),h=n(67927),_=n(67036),m=n(55344),g=n(3681),T="送礼物设置",E=function(e){var t;return{rewardTagline:(null==e?void 0:null===(t=e.rewardInfo)||void 0===t?void 0:t.tagline)||""}},y=function(e){var t=e.isAnonymous,n=e.disabled,r=e.updateDraftSettings,o=e.onChange,u=e.rewardChecked,p=(0,i._)((0,c.k)(!1),2),_=p[0],m=p[1],T=(0,l.useDispatch)(),E=(0,s.A)(function(e){o(e),m.off(),requestAnimationFrame(r)});return(0,a.BX)(d.xu,{color:"GBL05A",flex:"1",css:{fontSize:"14px"},children:[(0,a.BX)(d.kC,{height:"38px",children:[(0,a.tZ)(g.KT,{checked:u,text:"开启送礼物",onChange:function(){if(t){T((0,h.c0)("匿名内容无法开启送礼物，请先取消匿名","red"));return}m.on()},id:"PublishPanel-RewardSetting-0",disabled:n,shouldTrackClick:!0,zaModuleId:"open_send_gift"}),(0,a.tZ)(g.KT,{checked:!u,text:"关闭送礼物",onChange:function(){o(""),requestAnimationFrame(r)},id:"PublishPanel-RewardSetting-1",disabled:n,shouldTrackClick:!0,zaModuleId:"open_send_gift"})]}),_&&(0,a.tZ)(f.Z,{submitRewardText:E,onClose:m.off,edit:!1})]})},C=function(e){var t=e.question.id,n=(0,l.useDispatch)(),i=(0,l.useSelector)(function(e){return e.switches}).isAnswerRewardable,c=(0,u.useContext)(p.j),f=c.getFormData,h=c.updateFormData,E=f().rewardTagline,C=(0,s.A)(function(e){h({rewardTagline:e}),n((0,_.$j)(t,!!e))});return((0,u.useEffect)(function(){void 0===i&&n((0,m.X2)(["isAnswerRewardable"]))},[n,i]),i)?(0,a.BX)(d.kC,{py:"11px",children:[(0,a.tZ)(g.gN,{name:T}),(0,a.tZ)(y,(0,o._)((0,r._)({},e),{onChange:C,rewardChecked:!!E}))]}):null},S=function(e){var t=e.setCanReward,n=e.canReward,i=(0,l.useDispatch)(),c=(0,l.useSelector)(function(e){return e.switches}).isAnswerRewardable,p=(0,s.A)(function(e){t(!!e)});return((0,u.useEffect)(function(){void 0===c&&i((0,m.X2)(["isAnswerRewardable"]))},[i,c]),c)?(0,a.BX)(d.kC,{py:"11px",children:[(0,a.tZ)(g.gN,{name:T}),(0,a.tZ)(y,(0,o._)((0,r._)({},e),{onChange:p,rewardChecked:!!n}))]}):null}},3681:function(e,t,n){"use strict";n.d(t,{$_:function(){return R},KT:function(){return P},NZ:function(){return w},Qr:function(){return D},Tw:function(){return O},gN:function(){return Z},o3:function(){return L},vQ:function(){return N}});var r=n(55164),o=n(57477),i=n(71728),a=n(94009),c=n(49899),s=n(85879),u=n(95939),l=n(24405),d=n(91850),p=n(65733),f=n(79107),h=n(75056),_=n(64137),m=n(28753),g=n(88329),T=n.n(g),E=n(87363),y=n(87641),C=n(23719),S=n(63638),I=n(57730),A=n(21060),b=n(77880),w=function(e){return(0,s.tZ)(y.xv,(0,r._)({color:"GBK03A",css:{lineHeight:"61px",fontSize:"17px",fontWeight:"500"}},e))},Z=function(e){var t=e.required,n=e.name,a=e.title,c=e.helper,u=(0,i._)(e,["required","name","title","helper"]),d=(0,l.F)();return(0,s.BX)(y.kC,(0,o._)((0,r._)({as:"label",color:"GBK03A",mr:"3px",css:[{lineHeight:"38px",fontSize:"15px",fontWeight:"400",width:"110px"},!t&&{paddingLeft:"10px"}]},u),{children:[t&&(0,s.tZ)(y.xv,{"aria-label":"必填",color:"GRD03A",mt:"2px",mr:"4px",children:"*"}),n,c&&(0,s.tZ)(S.ZAClick,{as:"button",zaType:"Button",zaText:"提示信息-".concat(n),css:function(e){return{color:e.colors.GBL05A}},onClick:function(){I.Z.alert((0,s.BX)("div",{css:{paddingTop:"16px",h2:{paddingBottom:"20px",fontWeight:"bold",fontSize:"24px",textAlign:"center"},p:{textAlign:"left",fontSize:"15px",textIndent:"30px"},a:{textDecoration:"underline",color:d.colors.primary}},children:[(0,s.tZ)("h2",{children:a||n}),c]}),{text:{ok:"我知道了"}}).then(T(),T())},children:(0,s.tZ)(h.rk,{css:{marginLeft:"4px"},center:!0,size:18})})]}))},x=function(e){var t=e.isBottom,n=(0,i._)(e,["isBottom"]);return(0,s.tZ)(S.ZAClick,(0,o._)((0,r._)({as:"button",zaType:"Button",zaText:!0,css:function(e){return{cursor:"pointer",display:"flex",alignItems:"center",color:e.colors.GBL05A}}},n),{children:t?(0,s.BX)(s.HY,{children:[(0,s.tZ)(y.xv,{mr:"4px",fontSize:"14px",children:"回到顶部"}),(0,s.tZ)(_.v,{text:!0,fontSize:"16px"})]}):(0,s.BX)(s.HY,{children:[(0,s.tZ)(y.xv,{mr:"4px",fontSize:"14px",children:"发布设置"}),(0,s.tZ)(m.f,{text:!0,fontSize:"16px"})]})}))},k=function(e){var t=e.className,n=(0,i._)(e,["className"]);return(0,s.tZ)(y.kC,(0,r._)({className:t,height:"52px",css:function(e){return{justifyContent:"center",borderTop:"1px solid ".concat(e.colors.GBK09A),background:e.colors.GBK99C,WebkitFontSmoothing:"subpixel-antialiased"}}},n))},R=function(e){var t=e.children,n=e.hideScrollButton,r=e.isAnswer,o=(0,a._)((0,d.k)(!1),2),i=o[0],c=o[1];return(0,E.useEffect)(function(){var e=function(){var e=document.documentElement;e.scrollTop+e.clientHeight>=e.scrollHeight-5?c.on():c.off()};return document.addEventListener("scroll",e),function(){window.removeEventListener("scroll",e)}},[c]),(0,s.BX)(s.HY,{children:[(0,s.tZ)(y.xu,{height:"52px",css:{visibility:"hidden"}}),(0,s.tZ)(k,{css:{position:"fixed",left:0,right:0,bottom:0,zIndex:1},children:(0,s.BX)(y.kC,{height:"52px",alignItems:"center",mx:"auto",css:{width:r?"654px":"800px"},children:[!n&&(0,s.tZ)(x,{onClick:function(){(0,C.X5)(window,{top:i?0:document.body.scrollHeight,behavior:"smooth"})},isBottom:i}),t]})})]})},N=function(e){var t=e.children,n=e.hideScrollButton,r=e.getContaner;return(0,s.tZ)(A.Z,{bottom:!0,getStyle:function(){return{width:"1000px",bottom:0,maxWidth:"100vw"}},container:r,children:function(e){var o=!e.isFixed;return(0,s.tZ)(k,{children:(0,s.BX)(y.kC,{width:"100%",height:"52px",alignItems:"center",mx:"auto",px:"20px",children:[!n&&(0,s.tZ)(x,{onClick:function(){if(o){(0,C.X5)(window,{top:0,behavior:"smooth"});return}var e=null==r?void 0:r();if(e){var t=e.getBoundingClientRect().bottom+52;(0,C.yZ)(window,{top:t-document.documentElement.clientHeight,behavior:"smooth"})}},isBottom:o}),t]})})}})},O=function(e){return(0,s.tZ)("button",(0,o._)((0,r._)({css:function(e){return{color:e.colors.GBK08B,marginLeft:"auto",flex:"0 0 auto",height:"100%",padding:"0 10px"}}},e),{children:(0,s.tZ)(f.C,{text:!0})}))};function P(e){var t=e.checked,n=e.onChange,a=e.text,l=e.id,d=e.disabled,f=e.shouldTrackClick,h=e.zaTextPrefix,_=e.zaText,m=e.zaModuleId,g=e.size,T=(0,i._)(e,["checked","onChange","text","id","disabled","shouldTrackClick","zaTextPrefix","zaText","zaModuleId","size"]),E=(0,S.useTracker)().trackEvent;return(0,s.BX)(y.kC,(0,o._)((0,r._)({flex:1,alignItems:"center",as:"label",htmlFor:l,css:{flex:"0 0 auto",marginRight:"20px",cursor:"pointer"}},T),{children:[(0,s.tZ)(u.Z,{id:l,size:void 0===g?20:g,checked:t,onChange:(0,p.A)(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];f&&E({eventType:"Click",action:"Unknown",elementLocation:{moduleId:m,type:"Button",text:_||(h?"".concat(h,"-").concat(a):a)}}),n.apply(void 0,(0,c._)(t))}),disabled:d}),(0,s.tZ)(y.xv,{ml:"4px",fontSize:"14px",color:"GBL05A",className:"RadioButtonSet-label",children:a})]}))}var D=function(e){return(0,s.tZ)(b.Z,(0,r._)({css:{".Select-button":{width:"270px",height:"38px"},".Select-arrow":{marginLeft:"auto"}}},e))},L=function(e){return(0,s.tZ)(b.W,(0,r._)({css:function(e){return{color:e.colors.GBK02A,fontSize:"14px"}}},e))}},23858:function(e,t,n){"use strict";n.d(t,{Z:function(){return g}});var r=n(85879),o=n(65733),i=n(92258),a=n(92638),c=n(83577),s=n(50152),u=n(92071),l=n(50018);function d(e){var t=e.visible,n=e.onClose,o=e.header,i=e.searchValue,a=e.onSearchChange,d=e.searchPlaceholder,p=e.list,f=e.renderItem,h=e.onLoadMore,_=e.isEnd,m=e.emptyMessage,g=e.width;return(0,r.tZ)(u.Z,{visible:t,onClose:n,width:g,children:(0,r.tZ)(s.Z,{header:o,searchInput:(0,r.tZ)(c.Z,{value:i,onChange:a,placeholder:d}),children:(0,r.tZ)(l.Z,{list:p,onLoadMore:h,isEnd:_,renderItem:f,emptyMessage:m})})})}var p=n(31483),f=n(80787),h=n(29397),_=n(91350),m=n(60716);function g(e){var t=e.visible,n=e.onClose,c=e.contentType,s=e.contentId,u=e.contentTitle,l=e.contentUrl,g=(0,i.useDispatch)(),T=(0,m.Z)(),E=T.searchQuery,y=T.list,C=T.handleSearchChange,S=T.handleLoadMore,I=T.isEnd,A=T.config,b=(0,h.Z)({contentType:c,contentId:String(s),contentTitle:void 0===u?"":u,contentUrl:l}),w=b.sendMessage,Z=b.sentUsers,x=b.sendingUsers,k=(0,f.Z)(),R=(0,o.A)(function(e){var t=k(e);t&&w(t.id)}),N=(0,_.Z)({list:y,sentIds:Z,sendingIds:x,onSend:R}),O=N.transformedList,P=N.renderItem,D=N.setPendingConfirmIds,L=(0,o.A)(function(e){C(e),D(new Set)}),M=(0,o.A)(function(){g((0,a.Ug)()),n()});return(0,r.tZ)(d,{visible:t,onClose:M,header:(0,r.tZ)(p.Z,{children:"私信知友"}),searchValue:E,onSearchChange:L,searchPlaceholder:A.placeholder,list:O,renderItem:P,onLoadMore:S,isEnd:I,emptyMessage:A.emptyMessage})}},93931:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(62618);function s(e){var t=e.visible,n=e.onClose,s=e.width,u=e.footer,l=e.title,d=e.children,p=e.containFocus,f=e.restoreFocus,h=(0,i._)(e,["visible","onClose","width","footer","title","children","containFocus","restoreFocus"]);return t?(0,a.BX)(c.Z,(0,o._)((0,r._)({onClose:n,title:l,containFocus:p,restoreFocus:f,css:{width:"number"==typeof s?"".concat(s,"px"):s,maxWidth:"90vw"}},h),{children:[d,u&&(0,a.tZ)("div",{css:{marginTop:16},children:u})]})):null}},83577:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(85879),o=n(24405),i=n(50559),a=n(9887);function c(e){var t=e.value,n=e.onChange,c=e.placeholder,s=(0,o.F)().colors;return(0,r.tZ)(a.Z,{value:t,onChange:n,placeholder:void 0===c?"搜索":c,before:(0,r.tZ)(i.Z,{size:16,css:{flexShrink:0,marginRight:4,fill:s.MapText07A}}),css:{backgroundColor:s.MapUIFrame10A,borderRadius:"32px",border:"none",padding:"8px 12px",width:"100%","&:focus-within":{backgroundColor:s.MapUIFrame10A},"& .Input":{fontSize:"13px",lineHeight:"19px","&::placeholder":{color:s.MapText07A}}}})}},50152:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(85879),o=n(24405),i=n(87641);function a(e){var t=e.header,n=e.searchInput,a=e.children,c=(0,o.F)().colors;return(0,r.BX)(i.kC,{flexDirection:"column",children:[(0,r.BX)(i.kC,{flexDirection:"column",css:{position:"sticky",top:0,backgroundColor:c.GBK99A,zIndex:1,marginLeft:"-24px",marginRight:"-24px",paddingLeft:"24px",paddingRight:"24px"},children:[t,(0,r.tZ)(i.kC,{pb:"10px",css:{gap:"4px"},children:n})]}),a]})}},92071:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(85879),o=n(87641),i=n(93931);function a(e){var t=e.visible,n=e.onClose,a=e.width,c=e.children;return(0,r.tZ)(i.Z,{visible:t,onClose:n,width:void 0===a?470:a,footer:null,title:null,containFocus:!1,restoreFocus:!1,styles:{content:{marginTop:0}},children:(0,r.tZ)(o.xu,{css:{height:"382px",overflowY:"auto",overflowX:"hidden",marginLeft:"-24px",marginRight:"-24px",paddingLeft:"24px",paddingRight:"24px"},children:c})})}},84055:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(85879),o=n(66011),i=n(24405),a=n(87641),c=n(63638);function s(e){var t=e.itemId,n=e.imageUrl,s=e.renderTitle,u=e.description,l=e.buttonText,d=e.buttonDisabled,p=void 0!==d&&d,f=e.onClick,h=e.onLeftPartClick,_=e.zaModuleId,m=e.zaExtra,g=(0,i.F)(),T=g.colors,E=g.colorMod,y="确认发送"===l;return(0,r.BX)(a.kC,{"data-item-id":t,alignItems:"center",py:"8px",px:"6px",mx:"-6px",css:{gap:"16px",cursor:"pointer",borderRadius:"12px",transition:"background-color 0.2s ease",backgroundColor:y?T.MapBrand:"transparent","&:hover":{backgroundColor:y?T.MapBrand:T.MapUIFrame10A}},children:[(0,r.BX)(a.kC,{alignItems:"center",flex:1,onClick:h,children:[(0,r.tZ)(o.Nm,{width:40,height:40,src:n,alt:"",css:{flexShrink:0,borderRadius:"6px",objectFit:"cover"}}),(0,r.BX)(a.kC,{ml:"8px",flex:1,flexDirection:"column",children:[s(y),u&&(0,r.tZ)(a.xv,{mt:"2px",fontSize:"13px",lineHeight:"18px",color:y?"MapText99B":"MapText06A",css:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:u})]})]}),(0,r.tZ)(c.ZAClick,{as:a.kC,shouldTrackShow:!0,zaType:"Button",zaModuleId:_,extra:m,alignItems:"center",justifyContent:"center",width:60,py:"4px",onClick:function(){p||f()},css:{borderRadius:"20px",backgroundColor:p?E(T.MapText06A).alpha(.1):E(T.MapBrand).alpha(.1),cursor:p?"default":"pointer"},children:(0,r.tZ)(a.xv,{fontSize:"11px",lineHeight:"18px",fontWeight:"bold",color:p?"MapText06A":y?"GBK99B":"MapBrand",css:{whiteSpace:"nowrap"},children:l})})]})}},50018:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(94009),o=n(85879),i=n(4018),a=n(24187),c=n(87363),s=n(87641);function u(e){var t=e.message;return(0,o.tZ)(s.kC,{justifyContent:"center",alignItems:"center",css:{padding:"40px 20px"},children:(0,o.tZ)(s.xv,{fontSize:"13px",color:"MapText03A",children:t})})}function l(e){var t=e.list,n=e.onLoadMore,s=e.isEnd,l=e.renderItem,d=e.emptyMessage,p=(0,r._)((0,c.useState)(!1),2),f=p[0],h=p[1],_=(0,c.useCallback)(function(){return f||s?Promise.resolve():(h(!0),n().catch(function(e){console.error("加载更多失败:",e)}).finally(function(){h(!1)}))},[f,s,n]);return(0,o.BX)(i.b,{isDrained:s,onLoad:_,placeholder:(0,o.tZ)(a.O,{variant:"T01",height:120}),children:[t.map(function(e,t){var n=e.id||"".concat(e.name,"-").concat(e.imageUrl,"-").concat(t);return l(e,n)}),0===t.length&&!f&&(0,o.tZ)(u,{message:void 0===d?"暂无数据":d})]})}},31483:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(85879),o=n(24405),i=n(87641);function a(e){var t=e.children,n=(0,o.F)().colors;return(0,r.tZ)(i.xu,{css:{padding:"20px 0",cursor:"pointer",fontSize:"17px",lineHeight:"25px",fontWeight:500,position:"sticky",top:0,backgroundColor:n.GBK99A,zIndex:1,marginLeft:"-24px",marginRight:"-24px",paddingLeft:"24px",paddingRight:"24px"},children:t})}},80787:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(49899),o=n(65733),i=n(92258);function a(){var e=(0,i.useSelector)(function(e){var t,n;return{userSearchResults:(null===(t=e.publishedModal.userSearchResults)||void 0===t?void 0:t.data)||[],canMessageUsers:(null===(n=e.publishedModal.canMessageUsers)||void 0===n?void 0:n.data)||[]}}),t=e.userSearchResults,n=e.canMessageUsers;return(0,o.A)(function(e){return(0,r._)(t).concat((0,r._)(n)).find(function(t){return t.name===e.name&&t.avatarUrl===e.imageUrl})})}},48490:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(9338),o=n(30971),i=n(65733);function a(e){var t=e.currentPaging,n=e.searchQuery,a=e.onLoadWithSearch,c=e.onLoadWithoutSearch;return(0,i.A)((0,r._)(function(){return(0,o.__generator)(this,function(e){switch(e.label){case 0:if(!t||t.isEnd)return[2];if(!n.trim())return[3,2];return[4,a()];case 1:return e.sent(),[3,4];case 2:return[4,c()];case 3:e.sent(),e.label=4;case 4:return[2]}})}))}},11107:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(94009),o=n(65733),i=n(87363);function a(e){var t=e.onSearch,n=e.debounceMs,a=void 0===n?300:n,c=(0,r._)((0,i.useState)(""),2),s=c[0],u=c[1],l=(0,i.useRef)();return(0,i.useEffect)(function(){return function(){l.current&&clearTimeout(l.current)}},[]),{searchQuery:s,handleSearchChange:(0,o.A)(function(e){var n=e.target.value;u(n),l.current&&clearTimeout(l.current),n.trim()&&(l.current=setTimeout(function(){t(n)},a))}),setSearchQuery:u}}},29397:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(94009),o=n(49899),i=n(65733),a=n(87363),c=n(92258),s=n(81956),u=n(67927);function l(e){var t=e.contentType,n=e.contentId,l=e.contentTitle,d=void 0===l?"":l,p=e.contentUrl,f=(0,s.Z)(),h=(0,c.useDispatch)(),_=(0,r._)((0,a.useState)(new Set),2),m=_[0],g=_[1],T=(0,r._)((0,a.useState)(new Set),2),E=T[0],y=T[1],C=function(){var e=p||"查看详情 ID: ".concat(n);return"我分享了一篇".concat({answer:"回答",article:"文章",pin:"想法"}[t]||"内容","给你：").concat(d," ").concat(e)};return{sendMessage:(0,i.A)(function(e){m.has(e)||E.has(e)||(y(function(t){return new Set((0,o._)(t).concat([e]))}),f("/api/v4/chat",{method:"POST",body:{content_type:"text",receiver_id:e,text:C()}}).then(function(){g(function(t){return new Set((0,o._)(t).concat([e]))}),h((0,u.c0)("已发送私信"))}).catch(function(e){var t;h((0,u.c0)((null==e?void 0:null===(t=e.payload)||void 0===t?void 0:t.message)||"发送失败","red"))}).finally(function(){y(function(t){var n=new Set(t);return n.delete(e),n})}))}),isSent:(0,i.A)(function(e){return m.has(e)}),isSending:(0,i.A)(function(e){return E.has(e)}),sentUsers:m,sendingUsers:E,resetSentUsers:(0,i.A)(function(){g(new Set)})}}},91350:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(55164),o=n(57477),i=n(94009),a=n(85879),c=n(65733),s=n(87363),u=n(80714),l=n(58245),d=n(87641),p=n(84055);function f(e){var t=e.userId,n=e.imageUrl,o=e.name,i=e.description,c=e.buttonText,s=e.buttonDisabled,u=e.onClick,f=e.isFollowing,h=e.isFollowed,_=e.onLeftPartClick,m=f&&h?"互相关注":f?"我关注的":h?"关注我的":"";return(0,a.tZ)(p.Z,{itemId:t,imageUrl:n,renderTitle:function(e){return(0,a.BX)(d.kC,{alignItems:"center",css:{gap:"4px"},children:[(0,a.tZ)(d.xv,{fontSize:"14px",lineHeight:"20px",fontWeight:"bold",color:e?"MapText99B":"MapText02A",css:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:o}),m&&(0,a.tZ)(d.kC,{alignItems:"center",justifyContent:"center",px:"4px",height:16,flexShrink:0,color:e?"MapText99B":"MapText06A",css:(0,r._)({borderRadius:"4px"},(0,l.M)({border:"1px solid currentColor"})),children:(0,a.tZ)(d.xv,{fontSize:"10px",lineHeight:"14px",css:{whiteSpace:"nowrap"},children:m})})]})},description:i,buttonText:c,buttonDisabled:void 0!==s&&s,onClick:u,onLeftPartClick:_,zaModuleId:"search_user_entry"})}function h(e){var t=e.list,n=e.sentIds,l=void 0===n?new Set:n,d=e.sendingIds,p=void 0===d?new Set:d,h=e.onSend,_=(0,i._)((0,s.useState)(new Set),2),m=_[0],g=_[1];(0,s.useEffect)(function(){var e=function(e){0!==m.size&&(e.target.closest("[data-item-id]")||g(new Set))};return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}},[m.size]);var T=(0,s.useCallback)(function(e){var t,n=null!==(t=e.id)&&void 0!==t?t:"".concat(e.name,"-").concat(e.imageUrl);l.has(n)||(m.has(n)?(h(e),g(new Set)):g(new Set([n])))},[m,l,h]),E=(0,c.A)(function(e){e.id&&window.open("".concat(u.Z.fetchRoot.www,"/people/").concat(e.id),"_blank")});return{transformedList:(0,s.useMemo)(function(){return t.map(function(e){var t,n=null!==(t=e.id)&&void 0!==t?t:"".concat(e.name,"-").concat(e.imageUrl),i=p.has(n),a=l.has(n),c=m.has(n);return i?(0,o._)((0,r._)({},e),{buttonText:"发送中",buttonDisabled:!0}):a?(0,o._)((0,r._)({},e),{buttonText:"已私信",buttonDisabled:!0}):(0,o._)((0,r._)({},e),{buttonText:c?"确认发送":e.buttonText})})},[t,m,l,p]),renderItem:(0,s.useCallback)(function(e,t){return(0,a.tZ)(f,{userId:e.id,imageUrl:e.imageUrl,name:e.name,description:e.description,buttonText:e.buttonText,buttonDisabled:e.buttonDisabled,onClick:function(){return T(e)},isFollowing:e.isFollowing,isFollowed:e.isFollowed,onLeftPartClick:function(){return E(e)}},t)},[T,E]),setPendingConfirmIds:g}}},60716:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(87363),o=n(92258),i=n(92638),a=n(48490),c=n(11107),s={placeholder:"搜索知友",emptyMessage:"暂无知友",buttonText:"私信"};function u(){var e,t=(0,o.useDispatch)(),n=(0,c.Z)({onSearch:function(e){t((0,i.iF)(e,!0))}}),u=n.searchQuery,l=n.handleSearchChange,d=(0,o.useSelector)(function(e){var t=e.publishedModal,n=t.canMessageUsers,r=t.userSearchResults;return{canMessageUsers:(null==n?void 0:n.data)||[],userSearchResults:(null==r?void 0:r.data)||[],canMessageUsersPaging:null==n?void 0:n.paging,userSearchResultsPaging:null==r?void 0:r.paging}}),p=d.canMessageUsers,f=d.userSearchResults,h=d.canMessageUsersPaging,_=d.userSearchResultsPaging;(0,r.useEffect)(function(){t((0,i.mh)())},[t]);var m=(0,r.useMemo)(function(){return u.trim()?_:h},[u,_,h]),g=(0,r.useMemo)(function(){return(u.trim()?f:p).map(function(e){return{id:e.id,type:"user",imageUrl:e.avatarUrl||"",name:e.name||"",description:e.headline||"",buttonText:s.buttonText,buttonDisabled:!1,isFollowing:e.isFollowing,isFollowed:e.isFollowed}})},[u,f,p]),T=(0,a.Z)({currentPaging:m,searchQuery:u,onLoadWithSearch:function(){return t((0,i.iF)(u,!1))},onLoadWithoutSearch:function(){return t((0,i.mh)())}});return{searchQuery:u,list:g,handleSearchChange:l,handleLoadMore:T,isEnd:null!==(e=null==m?void 0:m.isEnd)&&void 0!==e&&e,config:s}}},53030:function(e,t,n){"use strict";n.d(t,{Z:function(){return ej}});var r=n(94009),o=n(85879),i=n(91850),a=n(65733),c=n(7835),s=n(87363),u=n.n(s),l=n(92258),d=n(87641),p=n(63638),f=n(67516),h=n.n(f),_=n(4757),m=n(66263),g=n(92638),T=n(23858),E=n(50559);function y(e){var t=e.onSearchClick,n=e.hasMixedMode,r=void 0!==n&&n;return(0,o.BX)(d.kC,{justifyContent:"space-between",alignItems:"center",py:"10px",children:[(0,o.tZ)(d.xv,{fontSize:"15px",lineHeight:"22px",color:"GBK03A",fontWeight:"bold",children:r?"同步与私信分享":"私信分享"}),(0,o.BX)(p.ZAClick,{as:d.kC,zaModuleId:"after_created_search_btn",zaType:"Button",alignItems:"center",onClick:t,color:"MapText06A",css:function(e){return{gap:"4px",cursor:"pointer",padding:"4px 0",borderRadius:"4px","&:hover":{color:e.colors.MapLink}}},children:[(0,o.tZ)(E.Z,{size:14}),(0,o.tZ)(d.xv,{fontSize:"13px",lineHeight:"19px",css:{whiteSpace:"nowrap"},children:r?"搜索圈子/知友":"搜索知友"})]})]})}var C=n(55164),S=n(57477),I=n(24405),A=n(96366),b=n(83931);function w(e){var t=e.user,n=e.isSending,i=e.isSent,a=e.isSpinning,c=e.onClick,u=e.flex,l=(0,I.F)(),f=l.colors,h=l.colorMod,_=(0,r._)((0,s.useState)(!1),2),m=_[0],g=_[1],T=(0,s.useRef)(null),E=(0,s.useRef)(0);(0,s.useEffect)(function(){if(m){var e=function(e){var t=e.target;T.current&&!T.current.contains(t)&&g(!1)},t=setTimeout(function(){document.addEventListener("click",e,!0)},0);return function(){clearTimeout(t),document.removeEventListener("click",e,!0)}}},[m]);var y=i?A.Z:b.ZP;return(0,o.tZ)(p.ZAShow,(0,S._)((0,C._)({shouldTrackClick:!0,as:d.xu,zaType:"Button",zaModuleId:"after_created_message_entry",extra:{configMap:{user_token:String(t.urlToken)}}},u&&{flex:u}),{ref:T,css:{cursor:i||n?"default":"pointer"},onClick:function(){if(!i&&!n){var e=Date.now(),r=E.current;if(!(e-r<300)){if(E.current=e,!m){g(!0);return}g(!1),c(t)}}},children:(0,o.BX)(d.kC,{flexDirection:"column",children:[(0,o.BX)(d.xu,{mb:"4px",width:54,height:54,css:{position:"relative",borderRadius:"6px",border:"1px solid ".concat(h(f.GBK02A).alpha(.04)),transition:"box-shadow 0.2s ease","&:hover":i||n?{}:{border:"none",boxShadow:"0 0 0 1px ".concat(f.MapText99B,", 0 4px 30px 0 rgba(0,0,0,0.2) ")}},children:[(0,o.tZ)(d.Ee,{src:t.avatarUrl,alt:"",width:"100%",height:"100%",css:{borderRadius:"6px",objectFit:"cover"}}),m&&(0,o.BX)(o.HY,{children:[(0,o.tZ)(d.xu,{bg:"MapBrand",css:{position:"absolute",inset:0,opacity:.8,borderRadius:"6px","@keyframes fadeIn":{from:{opacity:0},to:{opacity:.8}},animation:"fadeIn 150ms ease-in"}}),(0,o.tZ)(d.kC,{alignItems:"center",justifyContent:"center",css:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:(0,o.tZ)(b.ZP,{size:12,css:{color:f.MapText99B}})})]}),!m&&(0,o.BX)(d.xu,{width:20,height:20,css:{position:"absolute",right:-4,bottom:-4},children:[a&&(0,o.tZ)(d.xu,{css:{position:"absolute",inset:0,borderRadius:"50%",border:"2px solid transparent",borderTopColor:f.MapText99B,"@keyframes spin":{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}},animation:"spin 500ms ease-in-out"}}),(0,o.tZ)(d.kC,{alignItems:"center",justifyContent:"center",bg:"MapBrand",css:{position:"absolute",inset:0,borderRadius:"50%",border:"1px solid ".concat(f.MapText99B)},children:(0,o.tZ)(y,{size:12,css:{color:f.MapText99B}})})]})]}),(0,o.tZ)(d.xv,{fontSize:"12px",lineHeight:"17px",color:m?"MapBrand":i?"MapText06A":"GBK03A",css:{maxWidth:"54px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"center"},children:m?"确认发送":i?"已发送":t.name})]})}))}var Z=n(49899);function x(e){var t=e.sendMessage,n=e.isSent,o=(0,r._)((0,s.useState)(new Set),2),i=o[0],c=o[1],u=(0,r._)((0,s.useState)(new Set),2),l=u[0],d=u[1];return{handleSendMessage:(0,a.A)(function(e){var r=e.id;n(r)||i.has(r)||(c(function(e){return new Set((0,Z._)(e).concat([r]))}),d(function(e){return new Set((0,Z._)(e).concat([r]))}),setTimeout(function(){d(function(e){var t=new Set(e);return t.delete(r),t})},500),t(r),setTimeout(function(){c(function(e){var t=new Set(e);return t.delete(r),t})},2e3))}),sendingUsers:i,spinningUsers:l}}var k=n(29397);function R(e){var t=e.users,n=e.contentType,i=e.contentId,a=e.contentTitle,c=void 0===a?"":a,u=e.contentUrl,l=(0,r._)((0,s.useState)(!1),2),p=l[0],f=l[1],h=(0,k.Z)({contentType:n,contentId:i,contentTitle:c,contentUrl:u}),_=h.sendMessage,m=h.isSent,g=x({sendMessage:_,isSent:m}),E=g.handleSendMessage,C=g.sendingUsers,S=g.spinningUsers;return(0,o.BX)(o.HY,{children:[(0,o.BX)(d.xu,{children:[(0,o.tZ)(y,{onSearchClick:function(){f(!0)}}),t.length>0&&(0,o.tZ)(d.kC,{css:{gap:24},children:t.slice(0,5).map(function(e){return(0,o.tZ)(w,{flex:1,user:e,isSending:C.has(e.id),isSent:m(e.id),isSpinning:S.has(e.id),onClick:E},e.id)})})]}),p&&(0,o.tZ)(T.Z,{visible:p,onClose:function(){f(!1)},contentType:n,contentId:i,contentTitle:c,contentUrl:u})]})}var N=n(13962),O=n(91986),P=n(83577),D=n(50152),L=n(92071),M=n(50018),B=n(31483);function U(e){var t=e.activeTab,n=e.onTabChange,r=(0,I.F)().colors;return(0,o.BX)(d.kC,{height:65,py:"10px",css:{gap:"32px"},children:[(0,o.BX)(d.xu,{onClick:function(){return n("ring")},css:{padding:"10px 0",cursor:"pointer",position:"relative",fontSize:"17px",lineHeight:"25px",fontWeight:500,color:"ring"===t?r.MapBrand:"#8590A6"},children:[(0,o.tZ)(d.xv,{children:"同步到圈子"}),"ring"===t&&(0,o.tZ)(d.xu,{css:{position:"absolute",bottom:0,left:0,right:0,height:"2px",backgroundColor:r.MapBrand}})]}),(0,o.BX)(d.xu,{onClick:function(){return n("user")},css:{padding:"10px 0 20px",cursor:"pointer",position:"relative",fontSize:"17px",lineHeight:"25px",fontWeight:500,color:"user"===t?r.MapBrand:"#8590A6"},children:[(0,o.tZ)(d.xv,{children:"私信知友"}),"user"===t&&(0,o.tZ)(d.xu,{css:{position:"absolute",bottom:0,left:0,right:0,height:"2px",backgroundColor:r.MapBrand}})]})]})}var G=n(80787),F=n(48490),H=n(11107),z={placeholder:"搜索圈子",emptyMessage:"暂无圈子",buttonText:"选择"},q=n(80714),V=n(84055);function W(e){var t=e.ringId,n=e.imageUrl,r=e.name,i=e.description,a=e.buttonText,c=e.buttonDisabled,s=e.onClick,u=e.onLeftPartClick;return(0,o.tZ)(V.Z,{itemId:t,imageUrl:n,renderTitle:function(e){return(0,o.tZ)(d.xv,{fontSize:"14px",lineHeight:"20px",fontWeight:"bold",color:e?"MapText99B":"MapText02A",css:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r})},description:i,buttonText:a,buttonDisabled:void 0!==c&&c,onClick:s,onLeftPartClick:u,zaModuleId:"after_created_search_ring_select",zaExtra:{configMap:{ring_id:t}}})}var X=n(91350),K=n(60716);function j(e){var t,n,c,u,p,f,h,_,m,T,E,y,I,A,b,w,x,R,N,V,j,Y,Q,J,$=e.visible,ee=e.onClose,et=e.pinId,en=e.contentTitle,er=e.contentUrl,eo=e.hasMixedMode,ei=(0,l.useDispatch)(),ea=(0,r._)((0,s.useState)(eo?"ring":"user"),2),ec=ea[0],es=ea[1],eu=(0,r._)((0,i.k)(!1),2),el=eu[0],ed=eu[1],ep=(0,r._)((0,s.useState)(null),2),ef=ep[0],eh=ep[1],e_=(0,r._)((0,s.useState)(new Set),2),em=e_[0],ev=e_[1],eg=(n=({pinId:String(et),onItemClick:function(){}}).pinId,c=(0,l.useDispatch)(),p=(u=(0,H.Z)({onSearch:function(e){c((0,g.U3)(e,!0))}})).searchQuery,f=u.handleSearchChange,_=(h=(0,l.useSelector)(function(e){var t,r=e.publishedModal,o=null===(t=r.recommendedRings)||void 0===t?void 0:t[String(null!=n?n:"")],i=r.ringSearchResults;return{recommendedRings:(null==o?void 0:o.data)||[],ringSearchResults:(null==i?void 0:i.data)||[],recommendedRingsPaging:null==o?void 0:o.paging,ringSearchResultsPaging:null==i?void 0:i.paging}})).recommendedRings,m=h.ringSearchResults,T=h.recommendedRingsPaging,E=h.ringSearchResultsPaging,(0,s.useEffect)(function(){n&&c((0,g.dR)(String(n)))},[n,c]),y=(0,s.useMemo)(function(){return p.trim()?m:_},[p,m,_]),I=(0,s.useMemo)(function(){return p.trim()?E:T},[p,E,T]),A=(0,s.useMemo)(function(){return y.map(function(e){return{id:e.id,type:"ring",imageUrl:e.avatar||"",name:e.ringName||"",description:e.ringDesc||"",buttonText:z.buttonText,buttonDisabled:!1}})},[y]),b=(0,F.Z)({currentPaging:I,searchQuery:p,onLoadWithSearch:function(){return c((0,g.U3)(p,!1))},onLoadWithoutSearch:function(){n&&c((0,g.dR)(String(n)))}}),{searchQuery:p,list:A,handleSearchChange:f,handleLoadMore:b,isEnd:null!==(t=null==I?void 0:I.isEnd)&&void 0!==t&&t,config:z}),eT=(0,K.Z)(),eE=(x=(w=(0,l.useSelector)(function(e){var t,n,r;return{ringSearchResults:(null===(t=e.publishedModal.ringSearchResults)||void 0===t?void 0:t.data)||[],recommendedRings:(null===(n=e.publishedModal.recommendedRings)||void 0===n?void 0:null===(r=n[String(et)])||void 0===r?void 0:r.data)||[]}})).ringSearchResults,R=w.recommendedRings,(0,a.A)(function(e){return(0,Z._)(x).concat((0,Z._)(R)).find(function(t){return t.ringName===e.name&&t.avatar===e.imageUrl})})),ey=(0,G.Z)(),eC=(0,k.Z)({contentType:"pin",contentId:String(et),contentTitle:void 0===en?"":en,contentUrl:er}),eS=eC.sendMessage,eI=eC.sentUsers,eA=eC.sendingUsers,eb=(0,a.A)(function(e){var t=eE(e);t&&(eh(t),ed.on())}),ew=(0,a.A)(function(e){var t=ey(e);t&&eS(t.id)}),eZ=(V=(N={list:eg.list,selectedRingIds:em,onSelect:eb}).list,Y=void 0===(j=N.selectedRingIds)?new Set:j,Q=N.onSelect,J=(0,a.A)(function(e){e.id&&window.open("".concat(q.Z.fetchRoot.www,"/ring/host/").concat(e.id),"_blank")}),{transformedList:(0,s.useMemo)(function(){return V.map(function(e){var t,n=null!==(t=e.id)&&void 0!==t?t:"".concat(e.name,"-").concat(e.imageUrl);return Y.has(n)?(0,S._)((0,C._)({},e),{buttonText:"已选择",buttonDisabled:!0}):e})},[V,Y]),renderItem:(0,s.useCallback)(function(e,t){var n,r=null!==(n=e.id)&&void 0!==n?n:"".concat(e.name,"-").concat(e.imageUrl);return(0,o.tZ)(W,{ringId:r,imageUrl:e.imageUrl,name:e.name,description:e.description,buttonText:e.buttonText,buttonDisabled:e.buttonDisabled,onClick:function(){return Q(e)},onLeftPartClick:function(){return J(e)}},t)},[Q,J])}),ex=(0,X.Z)({list:eT.list,sentIds:eI,sendingIds:eA,onSend:ew}),ek=ex.transformedList,eR=ex.renderItem,eN=ex.setPendingConfirmIds,eO=(0,a.A)(function(){ed.off(),eh(null)}),eP=(0,a.A)(function(){ef&&ev(function(e){return new Set((0,Z._)(e).concat([ef.id]))}),ed.off(),eh(null)}),eD="ring"===ec?eg:eT,eL=function(e){eD.handleSearchChange(e),"user"===ec&&eN(new Set)},eM=(0,a.A)(function(){ei((0,g.Ug)()),ee()});return(0,s.useEffect)(function(){"user"===ec&&eN(new Set)},[ec,eN]),(0,o.BX)(o.HY,{children:[(0,o.BX)(L.Z,{visible:$,onClose:eM,children:[(0,o.tZ)(d.xu,{css:{display:"ring"===ec?"block":"none"},children:(0,o.tZ)(D.Z,{header:eo?(0,o.tZ)(U,{activeTab:ec,onTabChange:es}):(0,o.tZ)(B.Z,{children:"私信知友"}),searchInput:(0,o.tZ)(P.Z,{value:eg.searchQuery,onChange:eL,placeholder:eg.config.placeholder}),children:(0,o.tZ)(M.Z,{list:eZ.transformedList,onLoadMore:eg.handleLoadMore,isEnd:eg.isEnd,renderItem:eZ.renderItem,emptyMessage:eg.config.emptyMessage})})}),(0,o.tZ)(d.xu,{css:{display:"user"===ec?"block":"none"},children:(0,o.tZ)(D.Z,{header:eo?(0,o.tZ)(U,{activeTab:ec,onTabChange:es}):(0,o.tZ)(B.Z,{children:"私信知友"}),searchInput:(0,o.tZ)(P.Z,{value:eT.searchQuery,onChange:eL,placeholder:eT.config.placeholder}),children:(0,o.tZ)(M.Z,{list:ek,onLoadMore:eT.handleLoadMore,isEnd:eT.isEnd,renderItem:eR,emptyMessage:eT.config.emptyMessage})})})]}),el&&ef&&(0,o.tZ)(O.e,{contentId:et,onClose:eO,onSuccess:eP,ringConfig:{selectedRing:{ringId:ef.id,ringName:ef.ringName,ringDesc:ef.ringDesc,avatar:ef.avatar},syncMode:"SyncRing"}})]})}function Y(e){var t=e.users,n=e.rings,c=e.pinId,u=e.contentTitle,l=void 0===u?"":u,f=e.contentUrl,h=e.onClose,_=(0,r._)((0,s.useState)(!1),2),m=_[0],g=_[1],T=(0,I.F)().colors,E=(0,r._)((0,i.k)(!1),2),C=E[0],S=E[1],A=(0,r._)((0,s.useState)(null),2),b=A[0],Z=A[1],R=n.length>0,P=n.slice(0,2),D=t.slice(0,R?3:5),L=(0,k.Z)({contentType:"pin",contentId:c,contentTitle:l,contentUrl:f}),M=L.sendMessage,B=L.isSent,U=x({sendMessage:M,isSent:B}),G=U.handleSendMessage,F=U.sendingUsers,H=U.spinningUsers,z=(0,a.A)(function(e){Z(e),S.on()}),q=(0,a.A)(function(){S.off(),Z(null)}),V=(0,a.A)(function(){S.off(),Z(null),null==h||h()});return 0===n.length&&0===t.length?null:(0,o.BX)(o.HY,{children:[(0,o.BX)(d.xu,{children:[(0,o.tZ)(y,{onSearchClick:function(){g(!0)},hasMixedMode:R}),(0,o.BX)(d.kC,{css:{gap:24},children:[P.map(function(e){return(0,o.tZ)(p.ZAShow,{shouldTrackClick:!0,as:d.xu,zaModuleId:"after_created_ring_entry",zaType:"Button",extra:{configMap:{ring_id:String(e.id)}},css:{cursor:"pointer"},onClick:function(){return z(e)},children:(0,o.BX)(d.kC,{flexDirection:"column",alignItems:"center",css:{gap:"4px"},children:[(0,o.BX)(d.xu,{width:54,height:54,css:{position:"relative",borderRadius:"6px",transition:"box-shadow 0.2s ease","&:hover":{boxShadow:"0 0 0 1px ".concat(T.MapText99B,", 0 4px 30px 0 rgba(0,0,0,0.2) ")}},children:[(0,o.tZ)(d.xu,{width:54,height:54,as:"img",src:e.avatar,alt:"",css:{borderRadius:"6px",objectFit:"cover",display:"block"}}),(0,o.tZ)(d.kC,{width:20,height:20,alignItems:"center",justifyContent:"center",bg:"MapUIAccentC",css:{position:"absolute",right:-4,bottom:-4,width:"20px",height:"20px",borderRadius:"50%",border:"1px solid white"},children:(0,o.tZ)(N.ZP,{size:12,css:{color:T.MapText99B}})})]}),(0,o.tZ)(d.xv,{fontSize:"12px",lineHeight:"17px",color:"GBK03A",css:{maxWidth:"54px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"center"},children:e.ringName})]})},e.id)}),D.map(function(e){var t=F.has(e.id),n=B(e.id),r=H.has(e.id);return(0,o.tZ)(w,{user:e,flex:P.length>0?void 0:1,isSending:t,isSent:n,isSpinning:r,onClick:G},e.id)})]})]}),m&&(0,o.tZ)(j,{visible:m,onClose:function(){g(!1)},pinId:c,contentTitle:l,contentUrl:f,hasMixedMode:R}),C&&b&&(0,o.tZ)(O.e,{contentId:c,onClose:q,onSuccess:V,ringConfig:{selectedRing:{ringId:b.id,ringName:b.ringName,ringDesc:b.ringDesc,avatar:b.avatar},syncMode:"SyncRing"}})]})}var Q=n(93931),J=n(10700),$=n(16234),ee=n(45913),et=n(77813),en=n(78603),er=n(11362),eo=n.n(er),ei=n(54422),ea=n(67927),ec=n(61533),es=n.n(ec),eu=n(9338),el=n(30971),ed=n(29229),ep=n(64777),ef=n(18862),eh=n(98141),e_=n(66980),em=Object.assign,ev=function(e){return u().createElement(e_.Z,em({width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},e),u().createElement("path",{stroke:"#1772F6",d:"M12 4.5a7.5 7.5 0 1 1 0 15 7.5 7.5 0 0 1 0-15Z"}),u().createElement("path",{stroke:"#1772F6",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.75",d:"m9.5 12.5 2.5 3 2.5-3"}),u().createElement("rect",{width:"2",height:"6",fill:"#1772F6",rx:"1",transform:"matrix(1 0 0 -1 11 14.5)"}))},eg="'Noto Sans CJK SC', -apple-system, BlinkMacSystemFont, 'Helvetica Neue', 'PingFang SC', 'Microsoft YaHei', 'Source Han Sans SC', 'WenQuanYi Micro Hei', sans-serif",eT=null,eE=null;function ey(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:eg,r="undefined"==typeof document?null:(eT||(eE=(eT=document.createElement("canvas")).getContext("2d")),eE);return r?(r.font="".concat(t,"px ").concat(n),r.measureText(e).width):e.length*t}function eC(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:eg;if(!e)return[];for(var o=[],i="",a=0;a<e.length;a++){var c=e[a],s=i+c;ey(s,n,r)>t&&i.length>0?(o.push(i),i=c):i=s}return i.length>0&&o.push(i),o}function eS(e){var t,n,r,i,a,c=e.contentType,s=e.contentData,u=e.contentUrl;if(!s)return null;var l=s.author,p=s.content,f=s.excerpt,h=s.question,_=s.title,m={answer:(null==h?void 0:h.title)||"",article:_||"",pin:""}[c],g="pin"===c&&Array.isArray(p)&&(null===(a=p.find(function(e){return"text"===e.type}))||void 0===a?void 0:a.content)||"",T=function(e,t){if("pin"===t&&Array.isArray(e))return e.filter(function(e){return"image"===e.type}).map(function(e){return e.originalUrl||e.url}).filter(Boolean).slice(0,3);if("string"==typeof e){var n="undefined"!=typeof DOMParser?new DOMParser:null;if(!n)return[];try{var r=n.parseFromString(e,"text/html");return Array.from(r.querySelectorAll("img")).map(function(e){return e.getAttribute("src")||e.getAttribute("data-original")||e.getAttribute("data-actualsrc")||""}).filter(Boolean).slice(0,3)}catch(e){console.error("解析图片失败:",e)}}return[]}(p||"",c),E=(i=27*(r=eC((n="pin"===(t={content:p||"",contentType:c,images:T,pinTextContent:g,excerpt:f||""}).contentType?t.pinTextContent:t.content||t.excerpt||"").replace(/<[^>]*>/g,"").trim().replace(/\s+/g," "),303,16).length)+(t.images.length>0?211*t.images.length:0)+(t.images.length>0?12:0),{needsReadMore:r>10||i>811,summary:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:303,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16;if(!e)return"";var o=e.replace(/<[^>]*>/g,"").trim().replace(/\s+/g," "),i=20*t,a=o.length>1.2*i?o.slice(0,Math.floor(1.2*i)):o;if("undefined"!=typeof document){var c=eC(a,n,r);if(c.length<=t)return o.length>1.2*i?a+"...":o;var s=c.slice(0,t),u=s.join(""),l=s[s.length-1],d=s.slice(0,-1).join("");if(ey(l+"...",r)<=n)return u+"...";for(var p=l,f=l.length-1;f>=0&&!(ey((p=l.slice(0,f))+"...",r)<=n);f--);return d+p+"..."}var h=18*t;return o.length<=h?o:o.slice(0,h)+"..."}(n,10),maxContentHeight:811}),y=E.needsReadMore,C=E.summary,S=E.maxContentHeight;return(0,o.BX)(d.kC,{flexDirection:"column",width:343,minHeight:418,p:"20px",bg:"#fff",fontFamily:eg,children:[(0,o.BX)(d.xu,{flex:1,children:[m&&(0,o.tZ)(d.xv,{as:"h1",fontSize:21,fontWeight:"bold",color:"#36393F",m:"0 0 12px",style:{wordBreak:"break-word"},children:m}),(0,o.BX)(d.kC,{alignItems:"center",mb:"12px",children:[(0,o.tZ)(d.Ee,{src:l.avatarUrl,width:24,height:24,mr:"8px",alt:"",css:{borderRadius:"50%"},crossOrigin:"anonymous"}),(0,o.tZ)(d.xv,{fontSize:14,fontWeight:"bold",color:"#545962",children:l.name})]}),(0,o.BX)(d.xu,{mb:12,style:{position:"relative",maxHeight:y?"".concat(S,"px"):"none",overflow:"hidden"},children:[C&&(0,o.tZ)(d.xv,{fontSize:16,lineHeight:"27px",color:"#36393F",mb:T.length>0?"12px":0,css:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:C}),T.length>0&&(0,o.tZ)(d.kC,{flexDirection:"column",css:{gap:"2px"},children:T.filter(function(e){return!!e}).map(function(e,t){return(0,o.tZ)(d.Ee,{src:e,alt:"",width:"100%",height:"auto",css:{objectFit:"cover",borderRadius:"12px"}},t)})}),y&&(0,o.BX)(o.HY,{children:[(0,o.tZ)("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"65px",background:"linear-gradient(to bottom, rgba(255,255,255,0) 0%, rgba(255,255,255,0.93) 38.374%, #ffffff 90.602%)",pointerEvents:"none"}}),(0,o.BX)(d.kC,{alignItems:"center",css:{position:"absolute",bottom:"10px",left:"50%",transform:"translateX(-50%)",gap:"4px"},children:[(0,o.tZ)(ev,{}),(0,o.tZ)(d.xv,{as:"span",fontSize:14,fontWeight:"bold",color:"#1772F6",css:{whiteSpace:"nowrap"},children:"扫码查看全文"})]})]})]})]}),(0,o.BX)("div",{children:[(0,o.tZ)(d.xu,{height:12,mb:"12px",children:(0,o.tZ)("svg",{width:"100%",height:"100%",viewBox:"0 0 303 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",children:(0,o.tZ)("path",{d:"M0 0.5H29L33 13L51.5 0.5H303",stroke:"#E8EAED",strokeWidth:"1"})})}),(0,o.BX)(d.kC,{justifyContent:"space-between",alignItems:"center",children:[(0,o.BX)(d.kC,{flexDirection:"column",flex:1,children:[m&&(0,o.tZ)(d.xv,{mb:"4px",fontSize:12,fontWeight:"bold",color:"#191B1F",css:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:m}),(0,o.tZ)(d.xv,{fontSize:10,color:"#191B1F",style:{opacity:.4,whiteSpace:"pre"},children:"长按识别二维码阅读全文"})]}),(0,o.tZ)(eh.default,{value:u,size:58,level:"M",includeMargin:!1})]})]})]})}function eI(e){var t=e.contentType,r=e.contentData,i=e.contentUrl,a=e.onProgress,c=e.onSuccess,u=e.onError,l=(0,s.useRef)(null),d=(0,ed._)(function(){return n.e(9241).then(n.bind(n,44052))},!0);return(0,s.useEffect)(function(){if(d&&l.current){var e;if(!r){null==u||u(Error());return}(e=(0,eu._)(function(){var e,n,o;return(0,el.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),e=l.current,null==a||a("正在加载图片..."),[4,function(e){return eA.apply(this,arguments)}(e)];case 1:return i.sent(),null==a||a("正在生成分享图..."),[4,d.snapdom(e.firstElementChild,{scale:2,backgroundColor:"#ffffff"})];case 2:return[4,i.sent().toCanvas()];case 3:if(!(n=i.sent())||0===n.width||0===n.height)return console.error("生成的 canvas 无效: width=".concat(null==n?void 0:n.width,", height=").concat(null==n?void 0:n.height)),null==u||u(Error("生成图片失败")),[2];return null==a||a("正在保存图片..."),o="zhihu_".concat(t,"_").concat(r.id,"_").concat(Date.now(),".png"),n.toBlob(function(e){if(e)(0,ef.saveAs)(e,o),null==c||c();else{console.error("生成图片 Blob 失败"),null==u||u(Error("生成图片失败"));return}},"image/png"),[3,5];case 4:return console.error(i.sent()),null==u||u(Error("生成图片失败")),[3,5];case 5:return[2]}})}),function(){return e.apply(this,arguments)})()}},[d,t,r,a,c,u]),(0,o.tZ)("div",{ref:l,style:{position:"fixed",left:0,top:0,pointerEvents:"none",zIndex:-9999,opacity:0},children:(0,o.tZ)(eS,{contentType:t,contentData:(0,ep.k5)(r),contentUrl:i})})}function eA(){return(eA=(0,eu._)(function(e){var t;return(0,el.__generator)(this,function(n){switch(n.label){case 0:if(0===(t=Array.from(e.querySelectorAll("img"))).length)return[2];return[4,Promise.all(t.map(function(e){return new Promise(function(t){e.complete?t(null):(e.onload=function(){return t(null)},e.onerror=function(){return t(null)},setTimeout(function(){return t(null)},3e3))})}))];case 1:return n.sent(),[2]}})})).apply(this,arguments)}function eb(e){var t=e.label,n=e.qrCodeUrl,r=(0,I.F)().colors,i=(0,s.useRef)();return(0,c.b)(function(){var e;null===(e=i.current)||void 0===e||e.trackEvent({eventType:"Click",action:"Share",elementLocation:{type:"Button",moduleId:"after_created_more_share",text:t}})}),(0,o.BX)(d.xu,{ml:"8px",p:"12px",bg:"MapUIFrame99A",css:{position:"absolute",top:"50%",marginTop:-11,left:"100%",transform:"translateY(-50%)",borderRadius:"8px",boxShadow:"0 2px 16px rgba(0, 0, 0, 0.12)",zIndex:2},children:[(0,o.tZ)(p.ZARef,{ref:i}),(0,o.tZ)(d.xu,{width:0,height:0,css:{position:"absolute",left:"-6px",top:"50%",transform:"translateY(-50%)",borderTop:"6px solid transparent",borderBottom:"6px solid transparent",borderRight:"6px solid ".concat(r.MapUIFrame99A,"}")}}),(0,o.BX)(d.xv,{fontSize:"11px",lineHeight:"16px",color:"MapInfoSub",textAlign:"center",mb:"8px",children:[t,"扫码查看"]}),(0,o.tZ)("img",{src:n,alt:"".concat(t,"二维码"),width:110,height:110})]})}function ew(e){var t,n,c,f,h,_,g,T,E,y,C,S,A,b,w=e.content,Z=e.url,x=e.type,k=e.authorName,R=(0,I.F)(),N=R.colorMod,O=R.colors,P=(0,r._)((0,i.k)(!1),2),D=P[0],L=P[1],M=(0,r._)((0,i.k)(!1),2),B=M[0],U=M[1],G=(0,r._)((0,i.k)(!1),2),F=G[0],H=G[1],z=(0,r._)((0,i.k)(!1),2),V=z[0],W=z[1],X=w||{},K=X.title,j=X.shareText,Y=(n=(t={type:x,title:void 0===K?"":K,url:Z,authorName:k}).type,c=t.title,f=t.authorName,h=t.url,_=(0,l.useDispatch)(),(0,a.A)(function(){var e={pin:"想法",article:"文章",answer:"回答"}[n]||"",t=f&&"匿名用户"!==f&&e?"".concat(f,"的").concat(e," - "):"",r=(0,ei.BY)(h);eo()("".concat(c?"".concat(c," - "):"").concat(t,"知乎\n").concat(r),{format:"text/plain"}),_((0,ea.c0)("链接复制成功！"))})),Q=(T=(g={type:x,content:w,contentUrl:Z}).type,E=g.content,y=g.contentUrl,C=(0,l.useDispatch)(),A=(S=(0,r._)((0,s.useState)(!1),2))[0],b=S[1],{handleDownload:(0,a.A)(function(){if(!A)return b(!0),new Promise(function(e,t){!function(e){var t=e.contentType,n=e.onProgress,r=e.onSuccess,o=e.onError,i=e.content,a=e.contentUrl,c=null;try{var s=function(){c&&document.body.contains(c)&&(es().unmountComponentAtNode(c),document.body.removeChild(c),c=null)};null==n||n("正在准备画布..."),c=document.createElement("div"),document.body.appendChild(c),es().render(u().createElement(eI,{contentType:t,contentData:i,contentUrl:a,onProgress:n,onSuccess:function(){null==r||r(),s()},onError:function(e){null==o||o(e),s()}}),c)}catch(e){c&&document.body.contains(c)&&(es().unmountComponentAtNode(c),document.body.removeChild(c)),null==o||o(e)}}({content:E,contentType:T,contentUrl:y,onProgress:function(e){console.log(e)},onSuccess:function(){b(!1),C((0,ea.c0)("分享图下载成功！")),e()},onError:function(){b(!1),C((0,ea.c0)("生成分享图失败，请稍后重试","red")),t(Error("生成分享图失败"))}})})}),isGenerating:A}),er=Q.handleDownload,ec=Q.isGenerating,eu=(0,a.A)(function(){var e,t,n;e={appKey:m.M5.sina},j&&(e.title=j),t=Object.keys(e).map(function(t){return"".concat(t,"=").concat(encodeURIComponent(e[t]||""))}).join("&"),n="https://service.weibo.com/share/share.php?".concat(t),window.open(n,"_blank","width=615,height=505")||(location.href=n)}),el="".concat(q.Z.protocol,"//").concat(q.Z.wwwHost,"/qrcode?url=").concat(encodeURIComponent(Z)),ed=[{id:"copy",icon:J.Z,label:F?"链接已复制":"复制链接",onClick:F?void 0:function(){Promise.resolve(Y()).then(function(){H.on()}).catch(function(){})},disabled:F},{id:"share-image",icon:$.ZP,label:ec?"下载中...":V?"图片已下载":"生成分享图",onClick:V||ec?void 0:function(){Promise.resolve(er()).then(function(){W.on()}).catch(function(){})},disabled:V||ec},{id:"wechat",icon:ee.ZP,label:"微信",onClick:void 0,showQrcode:!0,qrCodeUrl:el,qrcodeVisible:D,onMouseEnter:L.on,onMouseLeave:L.off,color:O.MapPass},{id:"qq",icon:et.ZP,label:"QQ",onClick:void 0,showQrcode:!0,qrCodeUrl:el,qrcodeVisible:B,onMouseEnter:U.on,onMouseLeave:U.off},{id:"weibo",icon:en.ZP,label:"微博",onClick:eu,color:O.MapHighlight}];return(0,o.BX)(d.xu,{children:[(0,o.tZ)(d.kC,{py:"10px",children:(0,o.tZ)(d.xv,{fontSize:"15px",lineHeight:"22px",color:"GBK03A",fontWeight:"bold",children:"更多分享"})}),(0,o.tZ)(d.kC,{mx:"-12px",children:ed.map(function(e){var t=e.icon,n=e.id,r=e.label,i=e.onClick,a=e.onMouseEnter,c=e.onMouseLeave,s=e.color,u=void 0===s?O.MapBrand:s,l=e.showQrcode,f=e.qrcodeVisible,h=e.qrCodeUrl,_=e.disabled,m=void 0!==_&&_;return"pin"===x&&"weibo"===n?null:(0,o.BX)(p.ZAClick,{shouldTrackShow:!0,as:d.kC,zaType:"Button",zaAction:"Share",zaModuleId:"after_created_more_share",zaText:r,width:78,flexDirection:"column",alignItems:"center",css:{position:"relative",cursor:m?"not-allowed":"pointer"},onClick:i,onMouseEnter:a,onMouseLeave:c,children:[(0,o.tZ)(d.kC,{width:54,height:54,alignItems:"center",justifyContent:"center",css:{borderRadius:"50%",color:u,backgroundColor:N(u).alpha(.1),transition:"box-shadow 0.2s ease","&:hover":m?{}:{boxShadow:"0 0 0 1px ".concat(O.MapText99B,", 0 4px 30px 0 rgba(0,0,0,0.2) ")}},children:(0,o.tZ)(t,{size:30})}),(0,o.tZ)(d.xv,{fontSize:"13px",lineHeight:"19px",color:m?"GBK06A":"GBK03A",textAlign:"center",mt:"4px",css:{wordBreak:"keep-all"},children:r}),void 0!==l&&l&&f&&(0,o.tZ)(eb,{label:r,qrCodeUrl:h})]},n)})})]})}var eZ=n(79065),ex=n(56969),ek=n(75616),eR=n(50953),eN=n(81037),eO=n(55698),eP=n(45374),eD=n(92718);function eL(e){var t=e.avatarUrl,n=e.contentId,r=e.hasAiToPinPermission,i=e.contentType,a=e.onOpenPinWriteModal,c=e.onOpenAIToPinModal,s="1"===(0,eD.Z)("nm_pc_ai_pin",{mock:"1"});return(0,o.BX)(d.kC,{justifyContent:"space-between",p:"16px",children:[(0,o.BX)(p.ZAClick,{as:d.kC,zaModuleId:"after_created_topin_edit",zaType:"Button",alignItems:"center",css:{cursor:"pointer",flex:1},onClick:a,children:[(0,o.tZ)(eO.qE,{url:t,size:24,css:{marginRight:"4px",flexShrink:0}}),(0,o.tZ)(d.xv,{fontSize:"16px",lineHeight:"24px",color:"MapUIFrame07A",children:"说点什么..."})]}),s&&r&&(0,o.tZ)(p.ZAEnv,{content:{type:m.ur[i]||"Unknown",token:String(n)},children:(0,o.tZ)(p.ZAClick,{as:eN.ZP,zaType:"Button",zaModuleId:"after_created_ai_topin",preset:"plain",icon:eP.Z,label:"智能发布",color:"blue",onClick:c,shouldTrackShow:!0,css:{color:"var(--MapAI)"}})})]})}var eM=n(83921);function eB(e){var t=e.rings,n=e.onSyncToRingClick,r=e.onRingClick;return 0===t.length?null:(0,o.BX)(d.kC,{alignItems:"center",p:"16px",css:{gap:8},children:[(0,o.BX)(p.ZAClick,{as:d.kC,shouldTrackShow:!0,zaModuleId:"after_created_select_ring",zaType:"Button",alignItems:"center",flexShrink:0,color:"MapText03A",bg:"MapUIFrame99A",p:"2px 12px",height:28,css:{borderRadius:"32px",gap:4,cursor:"pointer"},onClick:n,children:[(0,o.tZ)(d.xv,{fontSize:13,lineHeight:"19px",children:"同步到圈子"}),(0,o.tZ)(eM.ZP,{size:12})]}),(0,o.tZ)(d.kC,{alignItems:"center",flex:1,height:28,css:{overflowX:"auto",overflowY:"hidden",gap:8,flexWrap:"nowrap","&::-webkit-scrollbar":{display:"none"}},children:t.map(function(e){return(0,o.BX)(d.kC,{height:28,p:"2px 12px 2px 6px",color:"MapText04A",bg:"MapUIFrame99A",alignItems:"center",justifyContent:"center",flexShrink:0,css:{borderRadius:"32px",cursor:"pointer"},onClick:function(){return r(e)},children:[(0,o.tZ)(N.ZP,{css:{flexShrink:0},size:16}),(0,o.tZ)(d.xv,{ml:"2px",css:{fontSize:13,lineHeight:"19px",whiteSpace:"nowrap"},children:e.ringName})]},e.id)})})]})}function eU(){var e=(0,eZ._)(['<a href="','" data-draft-title="','"  data-draft-node="inline"  data-draft-type="text-link">',"</a>"]);return eU=function(){return e},e}function eG(e){var t=e.contentId,n=e.contentTitle,r=e.contentUrl,i=e.contentType,c=e.relatedRings,s=e.onClose,u=e.hasAiToPinPermission,l=(0,eR.Z)(["avatarUrl"]),p=(0,a.A)(function(){(0,ek.pZ)({enableLocalDraft:!1,draft:[{type:"text",content:'<p><a href="'.concat(r,'" data-insert-way="force" data-draft-node="inline" data-draft-type="text-link">').concat(r,"</a></p>")}],onSuccess:s})}),f=(0,a.A)(function(){null==s||s(),(0,ek.pZ)({enableLocalDraft:!1,draft:[{type:"text",content:(0,ex.tx)(eU(),r,n,n)}],source:"ai_to_pin",extraInfo:{contentId:t,contentUrl:r,contentType:i,contentTitle:n}})}),h=(0,a.A)(function(){(0,ek.pZ)({enableLocalDraft:!1,draft:[{type:"text",content:'<p><a href="'.concat(r,'" data-insert-way="force" data-draft-node="inline" data-draft-type="text-link">').concat(r,"</a></p>")}],actionType:"ring",onSuccess:s})}),_=(0,a.A)(function(e){var t=e.id,n=e.ringName,o=e.avatar,i=e.ringDesc;(0,ek.pZ)({enableLocalDraft:!1,draft:[{type:"text",content:'<p><a href="'.concat(r,'" data-insert-way="force" data-draft-node="inline" data-draft-type="text-link">').concat(r,"</a></p>")},{type:"ring",ringConfig:{selectedRing:{ringId:t,ringName:n,ringDesc:i,avatar:o},syncMode:"SyncRing"}}],onSuccess:s})});return(0,o.BX)(d.xu,{children:[(0,o.tZ)(d.kC,{py:"10px",children:(0,o.tZ)(d.xv,{fontSize:"15px",lineHeight:"22px",color:"GBK03A",fontWeight:"bold",children:"转发到想法"})}),(0,o.BX)(d.xu,{bg:"MapUIFrame10A",css:{borderRadius:"12px"},children:[(0,o.tZ)(eL,{contentType:i,contentId:t,avatarUrl:null==l?void 0:l.avatarUrl,hasAiToPinPermission:u,onOpenPinWriteModal:p,onOpenAIToPinModal:f}),(0,o.tZ)(eB,{rings:c,onSyncToRingClick:h,onRingClick:_})]})]})}var eF=n(36963),eH=n(7753);function ez(e){var t=e.totalContentCount,n=void 0===t?0:t,r=e.showDetailLink,i=e.onGoToDetail;return(0,o.BX)(d.kC,{flexDirection:"column",alignItems:"center",mt:"8px",css:{background:"url('".concat("https://pic1.zhimg.com/v2-c793801eb96db22f0f5c7728e8fffff7.png","') no-repeat center center"),backgroundSize:"248px 54px",backgroundPosition:"top center"},children:[(0,o.tZ)(eF.ZP,{size:60,css:function(e){return{fill:e.colors.MapBrand}}}),(0,o.BX)(d.kC,{flexDirection:"column",alignItems:"center",mt:"4px",children:[(0,o.tZ)(d.xv,{fontSize:"19px",lineHeight:"24px",color:"GBK03A",fontWeight:"bold",children:"发布成功"}),(0,o.tZ)(d.kC,{alignItems:"center",fontSize:"13px",lineHeight:"19px",color:"GBK03A",mt:"8px",children:n?(0,o.BX)(o.HY,{children:["感谢你的第",(0,o.tZ)(d.xv,{fontSize:"16px",lineHeight:"16px",color:"GBL01A",fontFamily:"ZHScoreFont",fontWeight:"bold",mx:1,children:n}),"篇创作！",void 0!==r&&r&&(0,o.BX)(d.kC,{alignItems:"center",color:"MapLink",ml:"4px",onClick:i,css:{cursor:"pointer","&:hover":{opacity:.8}},children:[(0,o.tZ)(d.xv,{fontWeight:"bold",mr:"2px",children:"查看详情"}),(0,o.tZ)(eH.ZP,{size:14})]})]}):"分享你的精彩创作吧 ~"})]})]})}var eq=n(81956);function eV(){return(eV=(0,eu._)(function(e,t,n){var r;return(0,el.__generator)(this,function(o){switch(o.label){case 0:if(!(r=({answer:"/api/v4/answers/".concat(t,"?include=content,excerpt,question,share_text"),pin:"/api/v4/pins/".concat(t)})[e]))throw Error("不支持的内容类型: ".concat(e));return[4,n(r)];case 1:return[2,o.sent().payload]}})})).apply(this,arguments)}var eW=function(e){return Array.isArray(e)&&e.length>0},eX=function(e){var t=e.children;return(0,o.tZ)(d.kC,{flexDirection:"column",alignItems:"center",justifyContent:"center",css:{minHeight:"200px",gap:"16px"},children:t})},eK=function(e,t){var n=m.LA[e];return"pin"===e?{type:n,id:String(t)}:{type:n,token:String(t)}};function ej(e){var t,n,u,f,m,T,E,y,C,S,I,A,b,w,Z,x,k,N,O=e.author,P=e.type,D=e.contentId,L=e.contentTitle,M=void 0===L?"":L,B=e.onClose,U=e.onGoToDetail,G=(0,r._)((0,_.Ue)(),3),F=G[0],H=G[1],z=G[2],V=(0,r._)((0,i.k)(!1),2),W=V[0],X=V[1],K=(0,l.useDispatch)(),j=(0,p.useTracker)().trackEvent,J=eK(P,D),$=(0,l.useSelector)(function(e){return e.publishedModal})||{},ee=$.publishedContentCount,et=$.recommendedRings,en=$.canMessageUsers,er=$.aiToPinPermission,eo=(null==er?void 0:null===(k=er.data)||void 0===k?void 0:k.hasAiToPinPermission)||!1,ei=(null==et?void 0:null===(N=et[D])||void 0===N?void 0:N.data)||[],ea=(null==en?void 0:en.data)||[],ec=(0,r._)((0,s.useState)("idle"),2),es=ec[0],ed=ec[1],ef="pin"===P,eh={pin:"https://".concat(q.Z.wwwHost,"/pin/").concat(D),article:"https://".concat(q.Z.zhuanlanHost,"/p/").concat(D),answer:"https://".concat(q.Z.wwwHost,"/answer/").concat(D)}[P]||"",e_="pin"===P,em=(n=(t={type:P,contentId:D,isPinType:e_,enabled:W&&F}).type,u=t.contentId,f=t.isPinType,T=void 0!==(m=t.enabled)&&m,y=(E=(0,r._)((0,s.useState)(null),2))[0],C=E[1],S=(0,eq.Z)(),I=(0,l.useSelector)(function(e){return e.entities.articles[u]}),b=(A=(0,r._)((0,s.useState)([]),2))[0],w=A[1],x=(0,a.A)((Z=(0,eu._)(function(e){var t,n,r,o;return(0,el.__generator)(this,function(i){switch(i.label){case 0:return r=new URLSearchParams({scene:"ring_config",title:e}),[4,S("".concat(q.Z.fetchRoot.www,"/content/publish/configs?").concat(r.toString()))];case 1:return[2,((null===(t=null===(n=null==(o=i.sent().payload)?void 0:o.data)||void 0===n?void 0:n.ringConfig)||void 0===t?void 0:t.editorList)||[]).filter(function(e){return!!e.canSelect})]}})}),function(e){return Z.apply(this,arguments)})),(0,s.useEffect)(function(){T&&function(){e.apply(this,arguments)}();function e(){return(e=(0,eu._)(function(){var e,t,r;return(0,el.__generator)(this,function(o){switch(o.label){case 0:if(o.trys.push([0,6,,7]),"article"!==n)return[3,1];return t=I,[3,3];case 1:return[4,function(e,t,n){return eV.apply(this,arguments)}(n,u,S)];case 2:t=o.sent(),o.label=3;case 3:if(!t)return[2];if(C((0,ep.k5)(t)),!((r=(null==t?void 0:t.title)||(null==t?void 0:null===(e=t.question)||void 0===e?void 0:e.title)||(null==t?void 0:t.excerpt)||"")&&!f))return[3,5];return[4,x(r)];case 4:w(o.sent()),o.label=5;case 5:return[3,7];case 6:return console.error("Failed to fetch content or rings:",o.sent()),[3,7];case 7:return[2]}})})).apply(this,arguments)}},[T]),{content:y,contentBasedRings:b}),ev=em.content,eg=em.contentBasedRings,eT=(0,a.A)(function(){ed("loading");try{var e=[K((0,g.ZK)(D,P)),K((0,g.mh)()),e_&&K((0,g.dR)(String(D))),!e_&&K((0,g.d9)()),("article"===P||"answer"===P)&&K((0,g.oT)(D,P))].filter(Boolean);Promise.allSettled(e).then(function(){ed("success"),"function"==typeof H&&H(),X.on()}).finally(function(){h().set("showEditorTipModal",!1)})}catch(e){console.error("Failed to fetch publish feedback data:",e),ed("error"),"function"==typeof z&&z(),h().set("showEditorTipModal",!1)}});(0,c.b)(function(){var e=h().get("showEditorTipModal");if("pin"!==P&&!e){"function"==typeof z&&z();return}eT()});var eE=(0,a.A)(function(){j({eventType:"Click",action:"Close",elementLocation:{type:"Button",moduleId:"after_created_close",content:J}}),X.off(),null==B||B()}),ey=(0,a.A)(function(){j({eventType:"Click",action:"OpenUrl",elementLocation:{type:"Button",moduleId:"after_created_view_detail",content:J}}),U?U():window.open(eh,"_blank")});return(0,o.tZ)(p.ZAEnv,{content:J,children:(0,o.tZ)(Q.Z,{visible:W&&F,onClose:eE,width:430,footer:null,containFocus:!1,restoreFocus:!1,styles:{inner:{overflow:"unset"},content:{padding:"0 32px 32px"}},children:(0,o.tZ)(p.ZAShow,{zaType:"Popup",zaModuleId:"after_created_block",view:{elementLocation:{type:"Popup"}},children:"error"===es?(0,o.tZ)(eX,{children:(0,o.tZ)(d.xv,{fontSize:"14px",color:"#8590A6",children:"加载失败，请稍后重试"})}):"loading"===es?(0,o.BX)(eX,{children:[(0,o.tZ)(d.xu,{css:{width:"32px",height:"32px",border:"3px solid #f0f0f0",borderTop:"3px solid #1772F6",borderRadius:"50%",animation:"spin 0.8s linear infinite","@keyframes spin":{"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}}}),(0,o.tZ)(d.xv,{fontSize:"14px",color:"#8590A6",children:"加载中..."})]}):(0,o.BX)(d.kC,{flexDirection:"column",css:{gap:"20px"},children:[(0,o.tZ)(ez,{totalContentCount:void 0===ee?0:ee,showDetailLink:ef,onGoToDetail:ey}),!e_&&(0,o.tZ)(eG,{contentUrl:eh,contentId:D,contentType:P,onClose:eE,contentTitle:M,relatedRings:eg,hasAiToPinPermission:eo}),e_&&(eW(ea)||eW(ei))&&(0,o.tZ)(Y,{users:ea,rings:ei,pinId:D,contentTitle:M,contentUrl:eh,onClose:eE}),!e_&&eW(ea)&&(0,o.tZ)(R,{users:ea,contentType:P,contentId:D,contentTitle:M,contentUrl:eh}),(0,o.tZ)(ew,{url:eh,type:P,id:D,authorName:null==O?void 0:O.name,content:ev})]})})})})}},36173:function(e,t,n){"use strict";n.d(t,{W:function(){return f}});var r,o=n(87320),i=n(94009),a=n(85879),c=n(65733),s=n(87363),u=n(31467),l=n(64386),d=n(85576),p=n(81956),f={comment_img:"comment_img",dynamic_top:"dynamic_top",comment_sticker:"comment_sticker",block_keyword:"block_keyword"},h=(r={},(0,o._)(r,f.comment_img,"https://pic1.zhimg.com/v2-1b6677f81c2df41f55332474e15bc5a8.png"),(0,o._)(r,f.dynamic_top,"https://pic1.zhimg.com/v2-e16a265a43592abd5b98fceef02a1614.png"),(0,o._)(r,f.comment_sticker,"https://pic1.zhimg.com/v2-183a98cd480d24cd3e3246ba7a26303b.png"),(0,o._)(r,f.block_keyword,"https://pic3.zhimg.com/v2-0ad4e8aa43c3279cc7536f2fb7ac8348.png"),r);t.Z=(0,d.Z)(function(e){var t=e.show,n=e.setShow,r=e.type,o=e.isLogin,d=(0,i._)((0,s.useState)(""),2),f=d[0],_=d[1],m=(0,i._)((0,s.useState)(!1),2),g=m[0],T=m[1],E=(0,p.Z)(),y=(0,c.A)(function(){t&&n(!1)});return(0,s.useEffect)(function(){!f&&o&&(T(!0),E("/api/v4/unlimited/vip_rights/popup?token="+r).then(function(e){_(e.payload.button.text)}).catch(function(){}).then(function(){T(!1)}))},[t]),(0,a.tZ)(u.Z,{css:{".Modal-content":{padding:0,marginTop:0}},onClose:y,children:t&&!g&&(0,a.BX)(a.HY,{children:[(0,a.tZ)("img",{alt:"",src:h[r],css:{height:"230px",width:"400px",display:"block"}}),(0,a.tZ)("div",{css:{padding:20},children:(0,a.tZ)("div",{role:"button",tabIndex:0,css:function(e){return{padding:8,background:"linear-gradient(135deg, ".concat(e.colors.GYL06A," 0.2%, ").concat(e.colors.GYL08A," 100%)"),borderRadius:3,textAlign:"center",fontsize:14,color:e.colors.GYL12A,userSelect:"none","&:hover":{cursor:"pointer"}}},onClick:l.Z.show,children:f||"开通会员立即解锁"})})]})})})},3707:function(e,t,n){"use strict";n.d(t,{Z:function(){return T}});var r=n(55164),o=n(57477),i=n(79065),a=n(85879),c=n(24405),s=n(80565),u=n(65733),l=n(7753),d=n(82806),p=n.n(d),f=n(92258),h=n(87641),_=n(63638);function m(){var e=(0,i._)(["",""]);return m=function(){return e},e}var g=function(e){var t=e.avatars,n=e.isDarkMode;return(0,a.tZ)("ul",{css:{display:"flex",alignItems:"center",marginRight:3},children:t.map(function(e){var t=e||{},r=t.day,o=t.night,i=t.width,c=void 0===i?14:i,s=t.height,u=void 0===s?14:s,l=n?o:r;return l?(0,a.tZ)("li",{css:{display:"flex",alignItems:"center","& + &":{marginLeft:-5}},children:(0,a.tZ)("img",{src:l,alt:"",css:function(e){return{width:c,height:u,borderRadius:"100%",border:"1px solid ".concat(e.colors.GBK99A)}}})},l):null})})};function T(e){var t=e.contentType,n=e.id,i=e.onClickVoterInfo,d=(0,f.useSelector)(function(e){return e["".concat(t,"s")].relationEndorsement[n]})||{},T=d.icon,E=d.text,y=void 0===E?"":E,C=d.textColor,S=void 0===C?"GBK06A":C,I=d.textSize,A=void 0===I?14:I,b=d.isBold,w=void 0!==b&&b,Z=d.type,x=d.avatars,k=d.relationshipEndorseReasonType,R=(0,c.F)().isDarkMode,N="reaction_endorse"===Z,O=(0,u.A)(function(){N&&i()});if(!y)return null;var P=T||{},D=P.day,L=P.night,M=P.width,B=P.height,U=!!(null==x?void 0:x.length);return(0,a.tZ)(_.ZAShow,(0,o._)((0,r._)({zaType:"Text",zaModuleId:"relationship_endorse"},"relationship_endorse"===Z?{extra:{configMap:{relationship_endorse_type:String(k)}}}:{zaBlock:"VoterInfo",zaText:y}),{shouldTrackClick:!0,children:(0,a.BX)(h.kC,{css:(0,r._)({},N&&{cursor:"pointer",display:"inline-flex"}),onClick:O,alignItems:"center",my:"12px",children:[!U&&T&&(0,a.tZ)(h.Ee,{mr:"4px",width:void 0===M?12:M,height:void 0===B?12:B,src:R?void 0===L?"":L:void 0===D?"":D,alt:""}),U&&(0,a.tZ)(g,{avatars:x,isDarkMode:R}),(0,a.tZ)(h.xv,{css:function(e){return(0,r._)({fontSize:A,fontWeight:w?"bold":"normal",color:e.colors[S]},(0,s.S)(1))},children:p()(m(),y)}),(0,a.tZ)(l.ZP,{size:"14px",css:function(e){return{color:e.colors[S]}}})]})}))}},82473:function(e,t,n){"use strict";n.d(t,{Z:function(){return A}});var r=n(22107),o=n(94707),i=n(86325),a=n(55164),c=n(85626),s=n(85879),u=n(87363),l=n(92258),d=n(50373),p=n(84210),f=n(87320),h=n(57477),_=n(74135),m=n(39716),g=n(4661),T=n(67927),E=(0,g.FH)("report",["ADD","REPORT_USER_ACTION"]),y=function(e){var t=e.message;return[103006,103007].includes(e.code)?t||m.dC.failure:[103003,103001].includes(e.code)?m.dC.duplicate:m.dC.failure},C=m.dC.success,S=function(){return Promise.all([n.e(9357),n.e(3103),n.e(6967),n.e(876)]).then(n.bind(n,33802)).then(function(e){return e.default})},I=function(e){(0,i._)(n,e);var t=(0,c._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"render",value:function(){return(0,s.tZ)(d.Z,(0,a._)({getComponent:S},this.props))}}]),n}(u.Component),A=(0,l.connect)(null,function(e,t){return{loadProfile:function(t){e((0,p.hr)({urlToken:t}))},updateUserBlocking:function(t,n){e((0,p.cR)(t,n))},doReport:function(n){var r,o,i,c,s,u,l,d,p,m,g,S,I,A;return e((r=n.resourceId,o=n.resourceIds,i=n.type,c=n.reasonType,s=n.reasonId,u=n.customReason,l=n.source,d=n.reportedMemberHashId,m=void 0===(p=n.options)?{}:p,g=n.url,S=n.pictures,I=n.reportedResource,A=n.businessExt,{API:{types:E.ADD,endpoint:"reports",method:"POST",body:(0,_.decamelizeKeys)((0,a._)((0,h._)((0,a._)({},r&&{resourceId:r},o&&{resourceIds:o},I&&{reportedResource:I}),{type:i,reasonType:c,reasonId:s,reasonKey:s,customReason:u,source:void 0===l?"web":l,reportedMemberHashId:d,url:g,pictures:S}),A&&{businessExt:A}))},UPDATE:{success:function(e){return(0,f._)({},"".concat(i,"s"),(0,f._)({},r,{isHidden:e.reportInvisibleDisappear}))}},NOTIFICATION:void 0===m.NOTIFICATION?{key:"comment"===i?T.zQ:T.V8,success:C,failure:y}:m.NOTIFICATION})).then(function(e){return e.payload.sarcasmRecommend&&t.showWalle(),e})}}})(I)},57386:function(e,t,n){"use strict";n.d(t,{Z:function(){return O}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(57477),l=n(71728),d=n(85626),p=n(85879),f=n(82038),h=n(88329),_=n.n(h),m=n(92769),g=n.n(m),T=n(14168),E=n.n(T),y=n(87363),C=n(69383),S=n(63638),I=n(4534),A=n(25452),b=n(74128),w=n(31142),Z=function(e){var t=e.onClose,n=e.shown;return(0,p.tZ)(b.Z,{wrapperClassName:"WalleModal",className:"WalleModal",title:"举报成功",onClose:t,children:n&&(0,p.BX)("div",{className:"WalleModal-wrapper",children:[(0,p.tZ)("p",{className:"WalleModal-des",children:"你的举报我们已经收到，处理结果会通过系统通知进行告知。"}),(0,p.tZ)("img",{className:"WalleModal-img",src:"https://zhstatic.zhihu.com/heifetz/wall-E.png",alt:"walle"}),(0,p.BX)("div",{className:"WalleModal-open",children:[(0,p.BX)("div",{className:"WalleModal-content",children:[(0,p.tZ)("div",{className:"WalleModal-title",children:"遇到不友善评论了？"}),(0,p.tZ)("div",{className:"WalleModal-intro",children:"开启瓦力保镖评论区保护，瓦力将自动为你识别并处理不友善的评论。"})]}),(0,p.tZ)(w.Z,{className:"WalleModal-btn",preset:"primary",color:"blue",to:"/settings/preference",children:"立即开启"})]})]})})},x=n(66263),k=n(85576),R=n(82473),N=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{shown:!1,walleModalShown:!1}),(0,a._)((0,r._)(e),"handleShow",e.props.authRequired(function(t){var n=e.props.zaReportId;e.setState({shown:!0}),e.props.onModalShown(!0),C.Z.trackEvent(t.target,(0,s._)({action:"Report",element:"Button",is_intent:!0},n&&{id:n}))},x.q0.report)),(0,a._)((0,r._)(e),"handleHide",function(t){e.setState({shown:!1}),e.props.onModalShown(!1,t)}),(0,a._)((0,r._)(e),"handleWalleShow",function(){e.setState({walleModalShown:!0}),e.props.onModalShown(!0)}),(0,a._)((0,r._)(e),"handleWalleClose",function(){e.setState({walleModalShown:!1}),e.props.onModalShown(!1)}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this.state,t=e.shown,n=e.walleModalShown,r=this.props,o=r.id,i=r.resourceType,a=r.type,c=r.modalProps,d=(0,l._)(r,["id","resourceType","type","modalProps"]),h=g()(d,["zaReportId","onModalShown","authRequired","isLogin","currentUser","dispatch"]);return(0,p.BX)(p.HY,{children:[(0,p.BX)(S.ZAClick,(0,u._)((0,s._)({as:A.ZP,zaAction:"Report",zaType:"Button",preset:"plain",onClick:this.handleShow,zaModuleId:"click_report"},h),{children:[(0,p.tZ)(f.Z,{text:!0,center:!0})," 举报"]})),(0,p.tZ)(R.Z,(0,u._)((0,s._)({resourceType:i,type:a,urlToken:o,shown:t,onClose:this.handleHide,showWalle:this.handleWalleShow},c),{zaEnabled:!0})),(0,p.tZ)(Z,{shown:n,onClose:this.handleWalleClose})]})}}]),n}(y.Component);(0,a._)(N,"propTypes",{type:E().oneOf(I.eX).isRequired,id:E().oneOfType([E().number,E().string]).isRequired,zaReportId:E().number,onModalShown:E().func}),(0,a._)(N,"defaultProps",{onModalShown:_()});var O=(0,k.Z)(N)},24752:function(e,t,n){"use strict";n.d(t,{y:function(){return r.Z}});var r=n(82473);n(57386)},21680:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),u=n(85879),l=n(72111),d=n(67814),p=n.n(d),f=n(14168),h=n.n(f),_=n(87363),m=n(87641),g=n(74128),T=n(25452),E=n(66263),y=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(e){(0,o._)(this,n),i=t.call(this,e),(0,a._)((0,r._)(i),"onChangeInputType",function(e){i.setState({checked:e.target.checked})}),(0,a._)((0,r._)(i),"onChangeInputValue",function(e){i.setState({text:e.target.value})}),(0,a._)((0,r._)(i),"submit",function(){var e=i.state.text;i.props.submitRewardText(e)});var i,c=e.tagline;return i.state={text:c.replace(/^「/,"").replace(/」$/,"")||E.Sp,checked:!0},i}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.isClose,r=this.state.checked;return(0,u.BX)(g.Z,{onClose:t,className:"RewardForm-rewardModal",children:[(0,u.tZ)("p",{className:"RewardForm-rewardTitle",children:(n?"关闭":"开启")+"送礼物"}),(0,u.BX)(m.xv,{fontSize:"14px",lineHeight:"24px",textAlign:"center",color:"MapText03A",mt:"24px",mb:"32px",children:[n?"关闭后用户将无法对你的内容送礼物":"开启送礼物后可以接受用户的礼物，同时代表默认接受",!n&&(0,u.tZ)(l.pl,{target:"_blank",href:"https://www.zhihu.com/terms/tipjar",css:function(e){return{color:e.colors.GBL01A}},children:"《知乎赞赏功能使用协议》"})]}),(0,u.tZ)(T.ZP,{className:p()("RewardForm-rewardSubmit",{"RewardForm-rewardSubmit-disabled":!r}),onClick:this.submit,disabled:!r,children:"确定"})]})}}]),n}(_.Component);(0,a._)(y,"propTypes",{onClose:h().func,submitRewardText:h().func,edit:h().bool,tagline:h().string,isClose:h().bool}),(0,a._)(y,"defaultProps",{tagline:E.Sp})},45684:function(e,t,n){"use strict";n.d(t,{Z:function(){return eB}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),u=n(85879),l=n(14168),d=n.n(l),p=n(87363),f=n(92258),h=n(55536),_=n(85576),m=n(66263),g=n(8866),T=n(67927),E=n(67036),y=n(94009),C=n(91850),S=n(87641),I=n(21680),A=function(e){var t=e.disableReward,n=e.className,r=(0,y._)((0,C.k)(!1),2),o=r[0],i=r[1];return(0,u.BX)(u.HY,{children:[(0,u.tZ)(S.kC,{my:"60px",justifyContent:"center",className:n,children:(0,u.tZ)(S.xv,{lineHeight:"32px",textAlign:"center",color:"MapUIFrame08A",fontSize:"14px",css:{cursor:"pointer"},onClick:i.on,children:"已开启送礼物"})}),o&&(0,u.tZ)(I.Z,{isClose:!0,submitRewardText:function(){i.off(),null==t||t()},onClose:i.off})]})},b=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props.activateReward;return(0,u.BX)("div",{className:"Reward",children:[(0,u.tZ)("button",{className:"Reward-activateBtn",onClick:e,children:"开启送礼物"}),(0,u.tZ)("div",{className:"Reward-activateHint",children:"赞赏已升级为送礼物，用户可以付费支持你的创作"})]})}}]),n}(p.Component);(0,a._)(b,"propTypes",{activateReward:d().func});var w=n(25197),Z=n(63638),x=n(7407),k=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.onClick,n=e.isNewStyle;return(0,u.tZ)("div",{children:(0,u.tZ)(Z.ZAClick,{as:"button",shouldTrackShow:!0,zaType:"Button",zaModuleId:"content_send_gift",zaText:!0,className:"Reward-rewardBtn",onClick:t,children:(0,u.BX)(S.kC,{alignItems:"center",children:[n&&(0,u.tZ)(w.Z,{size:18}),(0,u.tZ)(S.xv,{css:{fontWeight:"500",marginLeft:2},children:"送礼物"})]})})})}}]),n}(p.Component);(0,a._)(k,"propTypes",{onClick:d().func,isNewStyle:d().bool});var R=(0,f.connect)(function(e){return{isNewStyle:"PC1"===(0,x.tQ)(e,{paramId:"nm_gift_button"})}})(k),N=n(7835),O=n(7753),P=n(81956),D=function(e){var t=e.handleListShown,n=e.rewardMemberCount,r=e.type,o=e.id,i=(0,P.Z)(),a=(0,y._)((0,p.useState)(null),2),c=a[0],s=a[1];if((0,N.b)(function(){n&&i("/api/v4/community-prod/appreciation/gifts/list",{query:{list_type:"page_detail",content_type:r,content_token:o}}).then(function(e){s(e.payload)})}),!n||!c)return null;var l=c.valuableGiftMembersData,d=c.normalGiftMembersData,f=c.giftCountText,h=null==l?void 0:l[0],_=(d||[]).slice(0,3);return(0,u.BX)(Z.ZAShow,{as:S.xu,shouldTrackClick:!0,zaType:"Button",zaModuleId:"send_gift_head_sculpture",zaText:!0,mb:"60px",onClick:t,css:{cursor:"pointer"},children:[(0,u.BX)(S.kC,{justifyContent:"center",children:[!!h&&(0,u.BX)(S.kC,{p:"2px",alignItems:"center",justifyContent:"center",bg:"MapUIFrame10C",css:{borderRadius:"99px","&+.Reward-User-avatar":{marginLeft:"6px"}},children:[(0,u.tZ)(S.Ee,{src:h.avatarUrl,alt:"送礼物用户",size:"24px",css:{borderRadius:"99px"}}),(0,u.tZ)(S.Ee,{src:h.sendGiftIcon,alt:"礼物",ml:"4px",size:"24px",css:{borderRadius:"99px"}})]},"ValuableUser"),_.map(function(e,t){return(0,u.tZ)(S.kC,{size:"26px",alignItems:"center",justifyContent:"center",className:"Reward-User-avatar",css:{borderRadius:"99px",background:"#fff","&+.Reward-User-avatar":{marginLeft:"-4px"}},children:(0,u.tZ)(S.Ee,{src:e.avatarUrl,alt:"送礼物用户",size:"24px",css:{borderRadius:"99px"}})},String(["NormalUser",t]))})]}),(0,u.BX)(S.xv,{mt:"12px",lineHeight:"20px",textAlign:"center",color:"MapInfoSub",fontSize:"13px",css:{display:"inline-flex",alignItems:"center"},children:[f,(0,u.tZ)(O.ZP,{size:"14px",css:{marginTop:"1px"}})]})]})},L=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.rewardMemberCount,n=e.handleListShown,r=e.isAuthor,o=e.type,i=e.id;return t?(0,u.tZ)(D,{handleListShown:n,rewardMemberCount:t,type:o,id:i}):(0,u.tZ)(S.xv,{mb:"60px",lineHeight:"19px",textAlign:"center",color:"MapUIFrame07A",fontSize:"13px",className:"Reward-countZero",children:r?null:"还没有人送礼物，鼓励一下作者吧"})}}]),n}(p.Component);(0,a._)(L,"propTypes",{rewardMemberCount:d().number,handleListShown:d().func,isAuthor:d().bool});var M=n(74128),B=n(55164),U=n(49899),G=n(55698),F=n(49910),H=n(72111),z=n(58245),q=n(80565),V=n(65733),W=n(24187),X=n(49274),K=function(e){var t=e.item,n=t.avatarUrl,r=t.badgeV2,o=t.name,i=t.headline,a=t.sendGiftIcon,c=t.urlToken;return(0,u.BX)(S.kC,{px:"16px",alignItems:"center",height:"66px",css:function(e){return(0,B._)({},(0,z.M)({borderBottom:"1px solid ".concat(e.colors.MapUIFrame09A)}))},children:[(0,u.BX)(H.pl,{target:"_blank",href:"https://www.zhihu.com/people/".concat(c),css:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,u.BX)(S.xu,{css:{position:"relative",flex:"0 0 auto"},children:[(0,u.tZ)(G.qE,{round:!0,url:n,size:36}),(0,u.tZ)(F.Vh,{badge:r,size:14,css:{position:"absolute",right:"0px",bottom:"0px"}})]}),(0,u.BX)(S.kC,{ml:"8px",height:"38px",justifyContent:"center",flexDirection:"column",children:[(0,u.tZ)(S.xv,{color:"GBK02A",fontSize:"15px",lineHeight:"21px",fontWeight:"500",css:(0,B._)({},(0,q.S)(1)),children:o}),i&&(0,u.tZ)(S.xv,{color:"GBK06A",fontSize:"12px",lineHeight:"15px",mt:"2px",css:(0,B._)({},(0,q.S)(1)),children:i})]})]}),(0,u.tZ)(S.Ee,{ml:"auto",size:"44px",src:a,alt:"赞赏礼物",css:{flex:"0 0 auto",pointerEvents:"none"}})]})},j=function(e){var t=e.item,n=t.avatarUrl,r=t.badgeV2,o=t.name,i=t.headline,a=t.sendGiftIcon,c=t.urlToken;return(0,u.BX)(S.kC,{mx:"24px",pt:"14px",pb:"12px",alignItems:"center",css:function(e){return{borderBottom:"1px solid ".concat(e.colors.MapUIFrame09A)}},children:[(0,u.BX)(H.pl,{target:"_blank",href:"https://www.zhihu.com/people/".concat(c),css:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,u.tZ)(G.qE,{url:n,size:54}),(0,u.BX)(S.kC,{ml:"12px",height:"54px",justifyContent:"center",flexDirection:"column",children:[(0,u.BX)(S.kC,{alignItems:"center",children:[(0,u.tZ)(S.xv,{color:"MapText02A",fontSize:"18px",lineHeight:"25px",fontWeight:"500",css:(0,B._)({},(0,q.S)(1)),children:o}),(0,u.tZ)(F.Vh,{flex:"0 0 auto",badge:r,size:18,css:{flex:"0 0 auto",marginLeft:"2px"}})]}),i&&(0,u.tZ)(S.xv,{color:"MapText06A",fontSize:"15px",lineHeight:"21px",mt:"6px",css:(0,B._)({},(0,q.S)(1)),children:i})]})]}),(0,u.tZ)(S.Ee,{ml:"auto",size:"60px",src:a,alt:"赞赏礼物",css:{flex:"0 0 auto",pointerEvents:"none"}})]})},Y=function(e){var t=e.inApp,n=e.type,r=e.token,o=(0,P.Z)(),i=(0,y._)((0,p.useState)(null),2),a=i[0],c=i[1],s=(0,y._)((0,C.k)(!0),2),l=s[0],d=s[1],f=(0,y._)((0,p.useState)(!1),2),h=f[0],_=f[1],g=(0,y._)((0,p.useState)(null),2),T=g[0],E=g[1],S=(0,V.A)(function(){d.on(),h&&_(!1),o((null==T?void 0:T.next)||"/api/v4/community-prod/appreciation/gifts/list",(null==T?void 0:T.next)?{}:{query:{content_token:r,content_type:n}}).then(function(e){var t;c(function(t){var n;return(0,U._)(t||[]).concat((0,U._)((null===(n=e.payload)||void 0===n?void 0:n.data)||[]))}),E(null===(t=e.payload)||void 0===t?void 0:t.paging)}).catch(function(){_(!0)}).finally(d.off)});if((0,N.b)(function(){S()}),l)return(0,u.tZ)(W.O,{variant:"T01",height:120});if(!(null==a?void 0:a.length))return h?(0,u.tZ)(X.H.EI1,{image:"loadingError",content:"系统升级中，请稍后再试"}):(0,u.tZ)(X.H.EI1,{image:"default",content:"暂无礼物"});var I=t?K:j;return null==a?void 0:a.map(function(e,t){return(0,u.tZ)(Z.ZAEnv,{content:{type:m.ur[n],token:r,id:r},children:(0,u.tZ)(Z.ZAEnv,{content:{type:"User",id:String(e.urlToken),token:String(e.urlToken)},moduleId:"gift_list",children:(0,u.tZ)(I,{item:e})})},String([e.urlToken,t]))})},Q=n(13427),J=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.modalShown,n=e.onClose,r=e.token,o=e.type;return t?(0,u.tZ)(M.Z,{size:"fullPage",onClose:n,children:t&&(0,u.BX)(Z.ZAShow,{zaType:"Popup",zaModuleId:"gift_list_popup",view:{elementLocation:{content:{type:m.ur[o],token:String(r),id:String(r)}}},children:[(0,u.tZ)(Q.Z,{header:"送礼物"}),(0,u.tZ)(Y,{token:r,type:o})]})}):null}}]),n}(p.Component);(0,a._)(J,"propTypes",{onLoad:d().func,modalShown:d().bool});var $=n(9338),ee=n(57477),et=n(30971),en=n(17057),er=n(41807),eo=n.n(er),ei=n(31467),ea=n(88423),ec=n(24405),es=n(64777),eu=n(49695),el=n(57665),ed=n(71728),ep=n(36963),ef=n(85224),eh=function(e){var t=e.children,n=e.extra,r=(0,ed._)(e,["children","extra"]);return(0,u.BX)(S.xv,(0,ee._)((0,B._)({color:"MapText02A",lineHeight:"27px",fontSize:"17px",fontWeight:"500",css:{display:"flex",alignItems:"center"}},r),{children:[t,n]}))},e_=function(e){var t=e.rewarderList,n=e.rewardMemberCount,r=e.showRewarderListModal;return(0,u.BX)(S.xv,{color:"MapText04A",lineHeight:"16px",fontSize:"12px",fontWeight:"400",mt:"6px",css:{display:"flex",alignItems:"center",width:"fit-content",cursor:"pointer"},onClick:r,children:[null==t?void 0:t.slice(0,3).map(function(e,t){return(0,u.tZ)(S.kC,{size:"16px",alignItems:"center",justifyContent:"center",className:"Reward-User-avatar",css:{borderRadius:"99px",background:"#fff","&+.Reward-User-avatar":{marginLeft:"-5px"}},children:(0,u.tZ)(S.Ee,{src:e,alt:"送礼物用户",size:"14px",css:{borderRadius:"99px"}})},String(["SendGiftModal-Rewarder",t]))}),(0,u.tZ)("span",{css:n>0&&{marginLeft:"4px"},children:n>0?"".concat(n," 人已送礼物"):"还没有人送礼物，快支持答主吧"})]})},em=function(e){var t=e.checked,n=(0,ed._)(e,["checked"]),r=(0,ec.F)().colors;return t?(0,u.tZ)(ep.ZP,(0,B._)({css:{color:r.MapLiveBrand,marginLeft:"auto"}},n)):(0,u.tZ)(ef.ZP,(0,B._)({css:{color:r.MapUIFrame07A,marginLeft:"auto"}},n))},ev=function(e){var t=e.amount,n=e.isSalt,r=(0,ed._)(e,["amount","isSalt"]);return(0,u.tZ)(S.xv,(0,ee._)((0,B._)({color:"MapText02A",fontSize:"17px",fontWeight:"500",fontFamily:"ZHVipFont"},r),{children:n?t:(0,u.BX)(u.HY,{children:[(0,u.tZ)("span",{css:{marginRight:"1px"},children:"￥"}),(t/100).toFixed(2)]})}))},eg={SALT:"ZHIPAY_ACCOUNT_SALT_BEAN",WECHAT:"WXPAY_NATIVE"},eT="自定义",eE="https://pay.zhihu.com/order/v1",ey={PURCHASE:"".concat(eE,"/purchase"),STATUS:"".concat(eE,"/delivery/status"),CHECKOUT:"".concat(eE,"/checkout")},eC="https://pic1.zhimg.com/v2-c8cfc819a2d6923f1b37f584db99f297.png",eS=function(e){var t=e.canAffordSalt,n=e.setSelectedMethod,r=e.balanceSalt,o=e.finalAmount,i=e.finalSaltAmount,a=e.selectedMethod,c=(0,ec.F)(),s=c.colors,l=c.colorMod;return(0,u.BX)(S.xu,{mt:"12px",p:"14px 12px",bg:"MapUIFrame10C",css:{borderRadius:"10px"},children:[(0,u.BX)(S.xu,{onClick:function(){t&&n(eg.SALT)},children:[(0,u.BX)(S.kC,{lineHeight:"24px",alignItems:"center",children:[(0,u.tZ)(S.Ee,{src:"https://picx.zhimg.com/v2-437bd1272ac2ad67b3edcd87f4f74f49.png",size:"20px"}),(0,u.BX)(S.xv,{ml:"4px",color:"MapText03A",fontSize:"14px",fontWeight:"500",children:["盐粒支付",(0,u.BX)("span",{css:{fontSize:"11px"},children:["（余额 ",r,"）"]})]}),t?(0,u.BX)(S.xv,{ml:"auto",color:"MapLiveBrand",fontSize:"15px",fontWeight:"500",children:[(0,u.tZ)("span",{css:{fontFamily:"ZHVipFont",marginRight:"3px"},children:i}),"盐粒"]}):(0,u.tZ)(S.xv,{ml:"auto",color:"MapText06A",fontSize:"12px",fontWeight:"400",lineHeight:"17px",children:"盐粒不足以抵扣"}),(0,u.tZ)(em,{checked:a===eg.SALT,css:[{marginLeft:"6px"},!t&&{opacity:.2}]})]}),t&&(0,u.BX)(S.kC,{mt:"2px",alignItems:"center",children:[(0,u.tZ)(S.xv,{ml:"24px",color:"MapHighlight",fontSize:"10px",css:{borderRadius:"4px",width:"41px",textAlign:"center",lineHeight:"16px",background:l(s.MapHighlight).alpha(.08)},children:"享 9 折"}),(0,u.BX)(S.xv,{ml:"auto",color:"MapText06A",fontSize:"12px",fontWeight:"400",lineHeight:"17px",children:["小计 ",o," 盐粒，已减 ",o-i," 盐粒"]})]})]}),(0,u.BX)(S.kC,{mt:"14px",lineHeight:"24px",alignItems:"center",onClick:function(){n(eg.WECHAT)},children:[(0,u.tZ)(S.Ee,{src:"https://pic1.zhimg.com/v2-831b40bfa7a9ee369daf0c08dfc460fe.png",size:"20px"}),(0,u.tZ)(S.xv,{ml:"4px",color:"MapText03A",fontSize:"14px",fontWeight:"500",children:"微信支付"}),(0,u.tZ)(em,{checked:a===eg.WECHAT})]})]})},eI=function(){return(0,u.BX)(S.xv,{mt:"12px",color:"MapText06A",fontSize:"12px",fontWeight:"400",lineHeight:"16px",textAlign:"center",children:["礼物收益将全部给到作者，支付即视为同意",(0,u.tZ)(H.pl,{target:"_blank",href:"https://www.zhihu.com/grapp/protocol/payment",color:"MapBrand",children:"《支付协议》"})]})},eA=function(e){var t=e.isSalt,n=e.finalSaltAmount,r=e.finalAmount,o=e.onSubmit,i=e.loading,a=e.isGift,c=e.selectedMethod,s=e.quantity,l=e.item,d=(0,ec.F)().colors;return(0,u.BX)(S.kC,{mt:"12px",alignItems:"center",children:[(0,u.tZ)(S.xv,{color:"MapText02A",fontSize:"15px",fontWeight:"500",lineHeight:"22px",children:"实付："}),(0,u.tZ)(ev,{color:"MapLiveBrand",amount:t?n:r,isSalt:t}),t&&(0,u.tZ)(S.xv,{ml:"3px",color:"MapLiveBrand",fontSize:"17px",fontWeight:"500",children:"盐粒"}),(0,u.tZ)(Z.ZAClick,{as:eu.z,zaType:"Button",zaModuleId:a?"click_send_gift":"click_send_red_envelope",extra:{configMap:a?{gift_id:String(l.id),pay_method:c}:{red_envelope_amt:String(s),pay_method:c}},isDisabled:i,onClick:o,css:{color:d.MapUIFrame99A,background:d.MapLiveBrand,height:"46px",width:"124px",marginLeft:"auto",fontWeight:"500"},children:i?(0,u.tZ)(el.Z,{white:!0}):"立即送出"})]})},eb=function(e){var t=e.successSwitch,n=e.item,r=e.quantity,o=e.balanceSalt,i=e.wechatShownSwitch,a=e.type,c=e.id,s=e.setOrderData,l=e.isGift,d=(0,f.useDispatch)(),h=function(e,t){d((0,T.c0)(e,t))},_=n||{},m=_.amount,g=_.saltAmount,E=m*r,I=g*r,A=o>=I,b=(0,y._)((0,C.k)(!1),2),w=b[0],Z=b[1],x=(0,y._)((0,p.useState)(function(){return A?eg.SALT:eg.WECHAT}),2),k=x[0],R=x[1],N=(0,P.Z)(),O=k===eg.SALT,D=(0,V.A)((0,$._)(function(){var e,o,u,l,d,p,f,_,m;return(0,et.__generator)(this,function(g){switch(g.label){case 0:Z.on(),g.label=1;case 1:return g.trys.push([1,4,5,6]),[4,N("/api/v4/community-prod/appreciation/gift/check",{query:{content_type:a,content_token:c}})];case 2:if(!(e=g.sent().payload).transparent)return h("出错了，请稍后再试试","red"),[2];return[4,N(ey.PURCHASE,{method:"POST",body:{sku_data:{sku_id:O?n.saltSkuId:n.skuId,quantity:Number(r)},payment:{payment_channel:k},extra:(0,B._)({},(0,es.iF)(e.transparent)),kind:"normal",is_anonymous:!1}})];case 3:if(o=g.sent().payload,O)return t.on(),[2];if(l=(u=o.paymentOutParams).qrcodeUrl,d=u.qrCode,p=u.qrCodeUrl,!(f=l||d||p))return h("加载微信支付二维码失败，请稍后重试","red"),[2];return s({dealId:o.dealId,qrCodeLink:f}),i.on(),[3,6];case 4:return h((null===(m=(_=g.sent()).payload)||void 0===m?void 0:m.message)||_.message||"出错了，请稍后再试","red"),[3,6];case 5:return Z.off(),[7];case 6:return[2]}})}));return(0,p.useEffect)(function(){R(A?eg.SALT:eg.WECHAT)},[I]),(0,u.BX)(u.HY,{children:[(0,u.BX)(S.xu,{mt:"32px",children:[(0,u.BX)(S.kC,{p:"14px 12px",bg:"MapUIFrame10C",lineHeight:"22px",css:{borderRadius:"10px"},children:[(0,u.tZ)(S.xv,{color:"MapText03A",fontSize:"15px",fontWeight:"500",children:"合计"}),(0,u.BX)(S.xv,{color:"MapText06A",fontSize:"13px",fontWeight:"400",ml:"auto",children:["折合 ",E," 盐粒"]}),(0,u.tZ)(ev,{color:"MapText02A",ml:"8px",amount:E})]}),(0,u.tZ)(eS,{canAffordSalt:A,setSelectedMethod:R,balanceSalt:o,finalAmount:E,finalSaltAmount:I,selectedMethod:k}),(0,u.tZ)(eI,{})]}),(0,u.tZ)(eA,{loading:w,isSalt:O,finalSaltAmount:I,finalAmount:E,onSubmit:D,isGift:l,selectedMethod:k,quantity:r,item:n})]})},ew=function(e){var t=e.giftList,n=e.successSwitch,r=e.rewarderList,o=e.rewardMemberCount,i=e.redPacketShownSwitch,a=e.balanceSalt,c=e.wechatShownSwitch,s=e.setSelectedItem,l=e.type,d=e.id,f=e.setOrderData,h=e.currentPanelRef,_=e.showRewarderListModal,m=(0,ec.F)(),g=m.colors,T=m.colorMod,E=(0,y._)((0,p.useState)(null),2),C=E[0],I=E[1],A=(0,p.useRef)(null);return(0,N.b)(function(){h.current="GiftPanel"}),(0,u.BX)(S.xu,{children:[(0,u.tZ)(Z.ZAShow,{zaType:"Popup",zaModuleId:"gift_popup"}),(0,u.tZ)(eh,{children:"送礼物"}),(0,u.tZ)(e_,{rewarderList:r,rewardMemberCount:o,showRewarderListModal:_}),(0,u.tZ)(S.xu,{mt:"12px",children:t.map(function(e,t){return(0,u.tZ)(S.kC,{justifyContent:"space-between",className:"SendGiftModal-GiftListWrapper",css:{"&+.SendGiftModal-GiftListWrapper":{marginTop:"8px"}},children:e.map(function(e){if(null==e)return(0,u.tZ)(S.kC,{css:{height:"107px",width:"78px"}},String(["Gift",e.id]));var t=C===e.id;return(0,u.BX)(S.kC,{onClick:e.isRedPacket?i.on:function(){A.current=e,I(e.id),s(e)},flexDirection:"column",css:{height:"107px",width:"78px",border:"2px solid",borderColor:t?g.MapLiveBrand:"transparent",background:t?T(g.MapLiveBrand).alpha(.06):"transparent",borderRadius:"10px",alignItems:"center",cursor:"pointer","&:hover":{background:T(g.MapLiveBrand).alpha(.06)}},children:[(0,u.tZ)(S.Ee,{mt:"2px",src:e.imgUrl,size:"60px"}),(0,u.tZ)(S.xv,{mt:"4px",color:"MapText02A",lineHeight:"19px",fontSize:"13px",fontWeight:"400",children:e.name}),(0,u.tZ)(S.xv,{color:"MapText06A",lineHeight:"16px",fontSize:"10px",fontWeight:"400",fontFamily:"ZHVipFont",children:!e.isRedPacket&&(0,u.BX)(u.HY,{children:[(0,u.tZ)("span",{css:{fontSize:"11px",marginRight:"1px"},children:"￥"}),e.amount/100]})})]},String(["Gift",e.id]))})},String(["GiftListWrapper",t]))})}),null!=C&&(0,u.tZ)(eb,{successSwitch:n,quantity:1,item:A.current,balanceSalt:a,wechatShownSwitch:c,type:l,id:d,setOrderData:f,isGift:!0})]})},eZ=n(81702),ex=function(e){var t=e.customQuantityShown,n=e.customQuantityShownSwitch,r=e.setCustomQuantity,o=e.maxQuantity,i=(0,ec.F)(),a=i.colors,c=i.colorMod,s=(0,y._)((0,p.useState)(""),2),l=s[0],d=s[1],f=(0,V.A)(function(e){var t=(e.target.value||"").replace(/[^\d]/g,"");if("0"===t){d("1");return}if(t>o){d(String(o));return}d(t)});return(0,u.tZ)(ei.Z,{css:function(){return{width:442,".Modal-content":{padding:"12px 24px 32px",margin:0}}},title:null,onClose:n.off,closeButton:null,children:t&&(0,u.BX)(S.xu,{css:{position:"relative"},children:[(0,u.tZ)(S.kC,{size:"24px",color:"MapText06A",alignItems:"center",justifyContent:"center",css:{borderRadius:"100%",background:c(a.MapText06A).alpha(.1),position:"absolute",right:"-12px",top:0,cursor:"pointer"},onClick:n.off,children:(0,u.tZ)(eZ.Z,{size:"13px"})}),(0,u.tZ)(S.xv,{pt:"28px",color:"MapText02A",fontWeight:"500",fontSize:"24px",lineHeight:"30px",textAlign:"center",children:"自定义金额"}),(0,u.tZ)("input",{placeholder:"0",onChange:f,value:l,css:{marginTop:"24px",lineHeight:"44px",width:"100%",borderRadius:"6px",fontWeight:"500",background:a.MapUIFrame10A,caretColor:a.MapLiveBrand,color:a.MapText03A,fontSize:"16px",textAlign:"center",padding:0,border:"none","&::placeholder":{color:a.MapUIFrame08A}}}),(0,u.tZ)(eu.z,{isDisabled:""===l,css:{marginTop:"32px",color:a.MapUIFrame99A,background:a.MapLiveBrand,height:"46px",width:"100%",marginLeft:"auto",fontWeight:"500"},onClick:function(){r(l),n.off()},children:"确定"})]})})},ek=function(e){var t=e.item,n=e.redPacketList,r=e.successSwitch,o=e.redPacketShownSwitch,i=e.balanceSalt,a=e.wechatShownSwitch,c=e.type,s=e.id,l=e.setOrderData,d=e.currentPanelRef,f=(0,ec.F)(),h=f.colors,_=f.colorMod,m=(0,y._)((0,p.useState)(2),2),g=m[0],T=m[1],E=(0,y._)((0,p.useState)(null),2),I=E[0],A=E[1],b=(0,y._)((0,C.k)(!1),2),w=b[0],x=b[1],k=g===eT?null==I?1:I:g,R=t.maxQuantity;return(0,N.b)(function(){d.current="RedPacketPanel"}),(0,u.BX)(S.xu,{children:[(0,u.tZ)(Z.ZAShow,{zaType:"Popup",zaModuleId:"red_envelope_popup"}),(0,u.tZ)(eh,{extra:(0,u.tZ)(eu.z,{colorPreset:"grey",onClick:o.off,css:{color:h.MapText03A,height:"27px",width:"60px",marginLeft:"auto",fontWeight:"400",fontSize:"13px"},children:"返回"}),children:"选择红包"}),(0,u.tZ)(S.xu,{mt:"18px",children:n.map(function(e,t){return(0,u.tZ)(S.kC,{justifyContent:"space-between",className:"SendGiftModal-RedpacketListWrapper",css:{"&+.SendGiftModal-RedpacketListWrapper":{marginTop:"8px"}},children:e.map(function(e){var t=e===eT;if(null==e)return(0,u.tZ)(S.kC,{size:"78px"},String(["Redpacket","empty"]));var n=g===e;return(0,u.tZ)(S.kC,{onClick:function(){T(e),t&&x.on()},css:{cursor:"pointer",height:"78px",width:"78px",border:"2px solid",borderColor:n?h.MapLiveBrand:"transparent",background:_(h.MapLiveBrand).alpha(.06),borderRadius:"10px",alignItems:"center",justifyContent:"center",color:"MapText02A",fontSize:"17px"},children:t&&null==I?(0,u.tZ)(S.xv,{fontWeight:"500",fontSize:"13px",children:e}):(0,u.BX)(u.HY,{children:[(0,u.tZ)(S.xv,{fontWeight:"500",fontFamily:"ZHVipFont",children:t?I:e}),(0,u.tZ)(S.xv,{fontWeight:"600",children:"\xa0元"})]})},String(["Redpacket",e]))})},String(["RedpacketListWrapper",t]))})}),(0,u.tZ)(eb,{successSwitch:r,item:t,quantity:k,balanceSalt:i,wechatShownSwitch:a,type:c,id:s,setOrderData:l}),(0,u.tZ)(ex,{customQuantityShown:w,customQuantityShownSwitch:x,setCustomQuantity:A,maxQuantity:R})]})},eR=function(e,t){var n=t-e.length%t;return n<t&&(e=e.concat(Array(n).fill(null))),eo()(e,t)},eN=(0,en.d7)(S.xu),eO=function(e){var t=e.onClose,n=e.getSelectedItem,r=(0,y._)((0,C.k)(),2),o=r[0],i=r[1];(0,N.b)(function(){var e=setTimeout(function(){i.on()},100);return function(){return clearTimeout(e)}}),(0,N.b)(function(){var e=setTimeout(function(){null==t||t()},1900);return function(){return clearTimeout(e)}});var a=n();return(0,u.tZ)(S.xu,{color:"blue",children:(0,u.tZ)(S.kC,{justifyContent:"center",children:(0,u.BX)(S.kC,{flexDirection:"column",alignItems:"center",pt:"50px",width:"280px",css:{position:"relative"},children:[(0,u.tZ)(eN,{iinitial:{scale:0},animate:{scale:[0,1,.8,1],transition:{times:[0,.533,.733,1],duration:.6,delay:.2,ease:"easeInOut"}},style:{lineHeight:0,position:"relative",zIndex:1},children:(0,u.tZ)(S.Ee,{src:null==a?void 0:a.imgUrl,size:"180px"})}),(0,u.tZ)(eN,{initial:{scale:0,opacity:0},animate:{scale:[0,1],opacity:[0,1],transition:{times:[0,1],duration:.32,delay:.2,ease:"easeInOut"}},style:{position:"relative",zIndex:1},children:(0,u.BX)(S.xu,{color:"MapUIFrame99B",css:{textShadow:"0px 0px 30px rgba(0,0,0,0.5)",textAlign:"center"},children:[(0,u.tZ)(S.xv,{lineHeight:"28px",fontSize:"20px",children:"恭喜你"}),(0,u.BX)(S.xv,{mt:"4px",color:"MapUIFrame99B",lineHeight:"25px",fontSize:"17px",children:["成功送出一个「",null==a?void 0:a.name,"」"]})]})}),o&&(0,u.tZ)(S.Ee,{src:eC,css:{position:"absolute",top:0,left:0,bottom:0,right:0}})]})})})},eP=function(e){var t=e.orderData,n=e.successSwitch,r=(0,P.Z)();return(0,N.b)(function(){var e=setInterval(function(){var o;(o=(0,$._)(function(){return(0,et.__generator)(this,function(o){switch(o.label){case 0:return[4,r(ey.STATUS,{query:{deal_id:t.dealId}})];case 1:return o.sent().payload.paidIsReady&&(clearInterval(e),n.on()),[2]}})}),function(){return o.apply(this,arguments)})().catch(function(){})},3e3);return function(){return clearInterval(e)}}),(0,u.BX)(S.xu,{pt:"28px",pb:"16px",css:{textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,u.tZ)(S.xv,{color:"GBK03A",lineHeight:"33px",fontSize:"24px",children:"微信支付"}),(0,u.tZ)(S.xv,{color:"GBK04A",lineHeight:"40px",fontSize:"14px",children:"使用微信扫描二维码完成支付"}),(0,u.tZ)(S.Ee,{src:"https://www.zhihu.com/qrcode?url=".concat(t.qrCodeLink),size:"115px",alt:"微信支付二维码"})]})},eD=(0,p.forwardRef)(function(e,t){var n,r,o=e.onClose,i=e.rewardMemberCount,a=e.giftInfo,c=e.closeButtonShownSwitch,s=e.transparentBgSwitch,l=e.type,d=e.id,f=e.showRewarderListModal,h=(0,y._)((0,C.k)(),2),_=h[0],m=h[1],g=(0,y._)((0,C.k)(),2),T=g[0],E=g[1],S=(0,y._)((0,C.k)(),2),I=S[0],A=S[1],b=(0,y._)((0,p.useState)(null),2),w=b[0],Z=b[1],x=(0,y._)((0,p.useState)(null),2),k=x[0],R=x[1],O=(0,p.useRef)("GiftPanel"),D=(0,V.A)(function(){return"RedPacketPanel"===O.current?(0,ee._)((0,B._)({},null==a?void 0:a.luckyMoney),{name:"红包"}):w}),L=(0,P.Z)(),M=(0,V.A)(function(){if(_){m.off();return}null==o||o()});(0,p.useImperativeHandle)(t,function(){return{handleClose:M}});var G=(0,y._)((0,p.useState)(null),2),F=G[0],H=G[1];(0,N.b)(function(){i&&L("/api/v4/community-prod/appreciation/gifts/list",{query:{list_type:"short",content_type:l,content_token:d}}).then(function(e){var t;H((null==e?void 0:null===(t=e.payload)||void 0===t?void 0:t.avatarList)||[])})}),(0,p.useEffect)(function(){if(T){c.off();return}if(I){c.on();return}if(_){c.off();return}c.on()},[_,T,I,c]),(0,p.useEffect)(function(){if(T||I){m.off();return}},[T,I,m]),(0,p.useEffect)(function(){if(T){s.on();return}s.off()},[T,s]),(0,N.b)(function(){(0,ea.loadImage)(eC)});var z=(0,p.useMemo)(function(){return a?eR([(0,ee._)((0,B._)({},a.luckyMoney),{name:"红包",isRedPacket:!0})].concat((0,U._)(a.giftList||[])),4):[]},[a]),q=(0,p.useMemo)(function(){var e;return a?eR((0,U._)((null==a?void 0:null===(e=a.luckyMoney)||void 0===e?void 0:e.quantity)||[]).concat([eT]),4):[]},[a]);return T?(0,u.tZ)(eO,{onClose:o,getSelectedItem:D}):I?(0,u.tZ)(eP,{orderData:k,successSwitch:E}):_?(0,u.tZ)(ek,{currentPanelRef:O,redPacketList:q,successSwitch:E,redPacketShownSwitch:m,item:null==a?void 0:a.luckyMoney,balanceSalt:null==a?void 0:null===(r=a.balance)||void 0===r?void 0:r.salt,wechatShownSwitch:A,type:l,id:d,setOrderData:R}):(0,u.tZ)(ew,{currentPanelRef:O,giftList:z,showRewarderListModal:f,successSwitch:E,rewarderList:F,rewardMemberCount:i,redPacketShownSwitch:m,balanceSalt:null==a?void 0:null===(n=a.balance)||void 0===n?void 0:n.salt,wechatShownSwitch:A,setSelectedItem:Z,type:l,id:d,setOrderData:R})}),eL=function(e){var t=e.shown,n=(0,y._)((0,C.k)(!0),2),r=n[0],o=n[1],i=(0,y._)((0,C.k)(!1),2),a=i[0],c=i[1],s=(0,p.useRef)(),l=(0,P.Z)(),d=(0,V.A)(function(){var e,t;null==s||null===(e=s.current)||void 0===e||null===(t=e.handleClose)||void 0===t||t.call(e)}),f=(0,y._)((0,p.useState)(null),2),h=f[0],_=f[1];return(0,p.useEffect)(function(){t&&!h&&l("/api/v4/community-prod/appreciation/gift/info").then(function(e){_(null==e?void 0:e.payload)})},[t,l,_,h]),(0,p.useEffect)(function(){t||setTimeout(function(){o.on(),c.off()},500)},[t,o,c]),(0,u.tZ)(ei.Z,{css:function(){return[{width:442,".Modal-content":{padding:"16px 20px 32px",margin:0}},a&&{boxShadow:"none",transform:"translateY(0)!important",".Modal-inner":{background:"transparent"}}]},title:null,onClose:d,closeButton:r?void 0:null,children:!!(t&&h)&&(0,u.tZ)(eD,(0,ee._)((0,B._)({},e),{giftInfo:h,ref:s,closeButtonShownSwitch:o,transparentBgSwitch:c}))})},eM=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{TipjarRender:!1,modalShown:!1}),(0,a._)((0,r._)(e),"onSubmitReward",function(t){e.updateReward(t)}),(0,a._)((0,r._)(e),"handleListShown",function(){e.setState({modalShown:!0})}),(0,a._)((0,r._)(e),"handleListHide",function(){e.setState({modalShown:!1})}),(0,a._)((0,r._)(e),"updateReward",function(t){var n=e.props,r=n.type,o=n.id,i=n.rewardInfo.canOpenReward;"article"===r?e.props.updateArticleReward(o,t,!!i):e.props.updateAnswerReward(o,t)}),(0,a._)((0,r._)(e),"activateReward",function(){e.onSubmitReward(m.Sp)}),(0,a._)((0,r._)(e),"disableReward",function(){e.onSubmitReward("")}),(0,a._)((0,r._)(e),"handleRewardButtonClick",function(){e.setState({TipjarRender:!0})}),(0,a._)((0,r._)(e),"colseTijarDialog",function(){e.setState({TipjarRender:!1})}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){this.props.imperativeRef&&(this.props.imperativeRef.current={activateReward:this.activateReward.bind(this)})}},{key:"componentWillUnmount",value:function(){this.props.imperativeRef&&(this.props.imperativeRef.current=null)}},{key:"render",value:function(){var e=this.props,t=e.currentUser,n=e.isAuthor,r=e.id,o=e.type,i=e.rewardInfo,a=i.canOpenReward,c=i.isRewardable,s=i.tagline,l=i.rewardMemberCount;if(n&&t&&"organization"===t.userType)return null;var d=this.state,p=d.TipjarRender,f=d.modalShown;if(n&&a)return(0,u.tZ)("div",{children:(0,u.tZ)(b,{activateReward:this.activateReward})});if(c){var h=(0,u.tZ)(J,{type:o,token:String(r),modalShown:f,onClose:this.handleListHide}),_=(0,u.tZ)(L,{rewardMemberCount:l,handleListShown:this.handleListShown,isAuthor:n,type:o,id:r});return n?(0,u.BX)("div",{className:"Reward",children:[(0,u.tZ)(A,{disableReward:this.disableReward,css:l>0&&{marginBottom:"12px"}}),_,h]}):(0,u.BX)("div",{className:"Reward",children:[(0,u.tZ)(R,{tagline:s,onClick:this.handleRewardButtonClick}),_,h,(0,u.tZ)(eL,{shown:p,showRewarderListModal:this.handleListShown,onClose:this.colseTijarDialog,rewardMemberCount:l,type:o,id:r})]})}return null}}]),n}(p.Component);(0,a._)(eM,"propTypes",{reward:d().object,isAuthor:d().bool,author:d().object,id:d().string,rewardInfo:d().object,currentUser:d().object,ua:d().object,type:d().string,isMobile:d().bool,balanceEnable:d().bool}),(0,a._)(eM,"defaultProps",{rewardInfo:{},type:"answer",balanceEnable:!0});var eB=(0,h.compose)(_.Z,(0,f.connect)(null,{updateAnswerReward:g.fT,updateArticleReward:E.i3,showNotification:T.c0}))(eM)},69578:function(e,t,n){"use strict";var r=n(9338),o=n(55164),i=n(57477),a=n(49899),c=n(30971),s=n(85879),u=n(65733),l=n(87363),d=n(92258),p=n(80714),f=n(81374),h=n(48929),_=n(66263),m=n(67927),g=n(42308),T=n(37209),E=n(37705),y=n(71119),C=[".webp",".jpg",".jpeg",".png",".gif"];t.Z=(0,l.forwardRef)(function(e,t){var n,S=e.allowImageCaption,I=(0,d.useDispatch)(),A=(0,d.useSelector)(function(e){return e.switches.couldSuperVideoUpload}),b=(0,d.useSelector)(function(e){return e.env.trafficSource}),w=(0,u.A)(function(t,n){var r;null===(r=e.onUploadError)||void 0===r||r.call(e,t,n)}),Z=(0,u.A)((n=(0,r._)(function(t){var n;return(0,c.__generator)(this,function(r){switch(r.label){case 0:if(!y.U.has(t))return[3,2];return[4,fetch(t).then(function(e){return e.blob()})];case 1:return n=r.sent(),[3,3];case 2:n=t,r.label=3;case 3:return[2,I.apply(void 0,[g.Ix.apply(void 0,[n,e.uploadType,e.editingContentType,"1"===p.Z.apollo.editor_auto_rotate])]).then(function(e){return e.payload}).then(function(t){return(0,h.R)(t,e.editingContentType,e.sourceId,e.contentId)}).catch(function(e){throw w(e,"image"),e})]}})}),function(e){return n.apply(this,arguments)})),x=(0,l.useCallback)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return I(T.Ty.apply(void 0,(0,a._)(t))).then(function(e){return e.payload}).catch(function(e){throw w(e,"video"),e})},[I,w]),k=(0,l.useCallback)(function(e){if("object"==typeof e){I((0,m.c0)(e.message,"red"));return}switch(e){case"type":I((0,m.c0)("格式不支持，请上传以下格式的图片：".concat(C.join(", ")),"red"));return;case"size":I((0,m.c0)("请上传不超过 ".concat(_.i3,"M 的图片"),"red"));return;case"dimension":I((0,m.c0)("GIF 图片的长或宽低于 ".concat(120,"px，无法上传"),"red"));return;case"disable-question-answer-image-upload":I((0,m.c0)("图片服务进行升级改造，暂时不能在「问题」「回答」中添加图片","red"));return;case"other":I((0,m.c0)("图片上传未完成，请稍后发布"));return}},[I]),R=(0,l.useCallback)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return I(T.o2.apply(void 0,(0,a._)(t))).then(function(e){return e.payload})},[I]);return(0,s.tZ)(E.Z,(0,i._)((0,o._)({},e),{ref:t,allowInlineCode:!0,allowImageCaption:void 0===S||S,allowResizeImage:!0,onImageUpload:Z,onVideoUpload:x,uploadImageError:k,loadVideo:R,couldSuperVideoUpload:A,onTransformVideoPoster:function(t){return(0,f.K)(t,e.editingContentType,e.sourceId,e.contentId)},isProduction:"production"===b}))})},73614:function(e,t,n){"use strict";n.d(t,{L:function(){return c},m:function(){return a}});var r=n(85879),o=n(87363),i=(0,o.createContext)({useNewMentionStyles:!1}),a=function(){return(0,o.useContext)(i)},c=function(e){var t=e.useNewMentionStyles,n=e.children,a=(0,o.useRef)({useNewMentionStyles:void 0!==t&&t}).current;return(0,r.tZ)(i.Provider,{value:a,children:n})}},36225:function(e,t,n){"use strict";n.d(t,{Z:function(){return P}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(57477),l=n(85626),d=n(85879),p=n(87363),f=n(55536),h=n(92258),_=n(2930),m=n(94636),g=n(69383),T=n(68159),E=n(67927),y=n(37209),C=n(99447),S=n(42559),I=n.n(S),A=function(e,t){return .01>Math.abs(e-t)},b={auto:"Auto",ld:"LD",sd:"SD",hd:"HD"},w={auto:"自动",ld:"低清",sd:"标清",hd:"超清"},Z=[1,2,3,5,8,13],x=n(80714),k=n(35502),R=function(e){var t=e.children,n=e.videoId,r=e.iframeRef;return(0,k.Z)({videoId:n,iframeRef:r}),t},N=function(e){var t=new URL(e);return t.searchParams.append("hideWatermark","1"),t.toString()},O=function(e){(0,c._)(n,e);var t=(0,l._)(n);function n(e){(0,o._)(this,n),x=t.call(this,e),(0,a._)((0,r._)(x),"handleMessage",function(e,t){var n=x.videoTracker,r=n.handlePlayEvent,o=n.handlePauseEvent,i=n.handleQualityChangeEvent,a=n.handleFragmentLoading,c=n.handleFragmentLoaded;switch(e){case T.FP.DOM.PLAY:r(t);break;case T.FP.DOM.PAUSE:o(t);break;case T.FP.PLAYER.QUALITY_CHANGE:i(t);break;case"fragment-loading":a(t);break;case"fragment-loaded":c(t)}}),(0,a._)((0,r._)(x),"handlePlay",function(){x.props.trackEvent((0,r._)(x),{id:5500,action:"Play",element:"Video"})}),(0,a._)((0,r._)(x),"handlePlayFailed",function(){(0,x.props.showNotification)("视频加载失败，请刷新页面重试","red")}),(0,a._)((0,r._)(x),"handleIframeLoad",function(e){x.setState({iframe:e})});var i,c,u,l,d,p,f,h,_,m,E,y,C,S,x,k=e.data;return x.messageHelper=(0,T.Wn)(k.id,"*",!0),x.videoTracker=(i=function(e,t){g.Z.trackEvent((0,r._)(x),e,{play:t})},u=function(e,t){var n;i(e,(0,s._)({play_event_identifier:_,duration:1e3*h,elapsed:m+((n=E)?Date.now()-n:0),video_quality:b[f]},t))},l=function(){(++S<15?Z.includes(S):S%15==0)&&u({action:"Playing"})},d=function(){S=0,p(),c=setInterval(l,1e3)},f="sd",h=0,_=null,m=0,E=null,y=!1,C=0,S=0,{handlePlayEvent:function(e){var t=e.currentTime;h=e.duration,A(t,0)&&(_=I()(),m=0),E=Date.now(),A(t,0)?u({action:"Play"}):u({action:"ResumePlay"}),d()},handlePauseEvent:function(e){var t=e.currentTime,n=e.duration;E&&(m+=Date.now()-E,E=null),A(t,n)?u({action:"EndPlay"}):u({action:"Pause"}),p()},handleQualityChangeEvent:function(e){var t=e.quality;u({action:"Switch",name:w[t]}),f=t},handleFragmentLoading:function(){y||(C=Date.now())},handleFragmentLoaded:function(){y||(y=!0,u({action:"Load"},{video_load_time:Date.now()-C}))},clearTick:p=function(){clearInterval(c)}}),x.state={iframe:null},x}return(0,i._)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=t.isLens,r=t.id,o=t.playerUrl,i=t.flvPlayerUrl,a=e.loadVideo;n||!r||o||i||a(r);var c=this.messageHelper.subscribeMessage;this.messageSubscription=c(this.handleMessage)}},{key:"componentWillUnmount",value:function(){this.messageSubscription.unsubscribe(),this.videoTracker.clearTick()}},{key:"render",value:function(){var e=this.props,t=e.data,n=e.data.error,r=e.onBeforePlay,o=e.hideWatermark&&t.playerUrl?N(t.playerUrl):t.playerUrl;return(0,d.tZ)("div",{className:"RichText-video",children:n?(0,d.tZ)(m.Z,(0,s._)({},t)):(0,d.tZ)(R,{videoId:t.id,iframeRef:{current:this.state.iframe},children:(0,d.tZ)(_.Z,(0,u._)((0,s._)({},t),{playerUrl:o,onIframeRef:this.handleIframeLoad,onPlay:this.handlePlay,onPlayFailed:this.handlePlayFailed,onBeforePlay:r}))})})}}]),n}(p.Component),P=(0,f.compose)((0,h.connect)(function(e,t){var n=t.data,r=n.isLens,o=n.id;return r?{data:(0,u._)((0,s._)({},t.data),{source:"lens",playerUrl:"https://".concat(x.Z.videoHost,"/video/").concat(o)})}:{data:e.video.data[o]||t.data}},{showNotification:E.c0,loadVideo:y.o2}),(0,C.a)(function(e){var t=e.data;return{module:"VideoItem",content:{type:"Video",sub_type:t.isLens?"SelfHosted":"Embedded",video_id:t.id,is_playable:!!t.isPlayable},trackCardShow:!0,view:{id:174}}}))(O)},26802:function(e,t,n){"use strict";n.d(t,{Z:function(){return ez}});var r=n(55164),o=n(57477),i=n(71728),a=n(94009),c=n(49899),s=n(85879),u=n(99565),l=n(41402),d=n(74246),p=n(87363),f=n(55536),h=n(31252),_=n(70400),m=n(80714),g=n(41805),T=n(91726),E=n(15021),y=n(13649),C=n(24405),S=n(17103),I=n(40529),A=n(23707),b=n(64099),w=n(79264),Z=n(60927),x=n(97183),k=n(77711),R=n(61907),N=n(25593),O=n(33846),P=n(84632),D=n(55283),L=n(14533),M=n(87641),B=n(65744),U=n(73614),G=n(7835),F=n(16850),H=function(e){var t=e.children,n=e.className;(0,F.Z)();var r=(0,p.useRef)();return(0,G.b)(function(){}),(0,s.tZ)("div",{className:n,ref:r,children:t})},z=n(65733),q={question:"question",answer:"answer",question_ask:"question_ask",article:"article",column:"column",collection:"collection",roundtable:"roundtable",live_course:"live_course",live:"live",ebook:"ebook",pin:"pin",eventcard:"eventcard",zvideo:"zvideo",edu_section:"edu_section"},V=n(35502),W=function(e){var t=e.root,n=e.parentType,c=e.parentId,u=e.language,l=(0,i._)(e,["root","parentType","parentId","language"]),d=(0,a._)((0,p.useState)(),2),f=d[0],h=d[1];(0,V.Z)({videoId:null==f?void 0:f.videoId,iframeRef:null==f?void 0:f.videoIframeRef});var _=(0,z.A)(function(e){var t="";return[q.zvideo,q.answer].includes(n)&&(t="?".concat(new URLSearchParams([["itemId",c],["itemType",n]]).toString())),"https://".concat(m.Z.videoHost,"/video/").concat(e).concat(t)}),g=(0,z.A)(function(e){var t=e.videoId,n=e.videoIframeRef;t&&(null==n?void 0:n.current)&&h({videoId:t,videoIframeRef:n})});return(0,s.tZ)(s.HY,{children:(0,s.tZ)(P.SM,(0,o._)((0,r._)({language:u,onLinkCardPlayerLoaded:g,getVideoUrl:_,useZVideoLinkCard:!1},l),{root:t}))})},X=n(88329),K=n.n(X),j=function(e){var t=this;return e.length?function(n,r){for(var o=e.length-1,i=n;o>=0;)i=e[o].call(t,i,r),o--;return i}:K()},Y=/<img\b[^>]*data-rawwidth="([^>"]*)"[^>]*?>/g,Q=function(e){return e?e.replace(Y,function(e,t){if(!(t=parseInt(t)))return e;var n=t>=343?"normal":"small";return e.replace(/data-size="[^">]*"/g,'data-size="'.concat(n,'"'))}):e},J=function(e){var t=(0,U.m)(),n=e.onRef,u=e.htmlProcessors,l=e.linkCardInfo,d=e.zvideoLinkCardProps,f=e.adLinkCardProps,h=e.mcnLinkCardProps,_=e.eduCardProps,m=e.mkSkuLinkCardProps,g=e.html,T=e.sourceId,G=e.shouldShowCatalog,F=e.shouldCatalogCollapse,z=e.shouldFoldCatalog,q=e.referenceLinkProps,V=e.useCatalogV2,X=e.isAuthor,K=e.maskGradientColor,Y=e.isVideoAnswer,J=void 0!==Y&&Y,$=e.catalog,ee=(0,i._)(e,["onRef","htmlProcessors","linkCardInfo","zvideoLinkCardProps","adLinkCardProps","mcnLinkCardProps","eduCardProps","mkSkuLinkCardProps","html","sourceId","shouldShowCatalog","shouldCatalogCollapse","shouldFoldCatalog","referenceLinkProps","useCatalogV2","isAuthor","maskGradientColor","isVideoAnswer","catalog"]),et=f||{},en=et.parentType,er=et.parentId,eo=(0,a._)((0,p.useState)(null),2),ei=eo[0],ea=eo[1],ec=(0,a._)((0,p.useState)(null),2),es=ec[0],eu=ec[1],el=(0,C.F)(),ed=(0,y.n)(),ep=(0,p.useRef)(null),ef=(0,p.useRef)(null),eh=j((0,c._)(void 0===u?[]:u).concat([(0,O.Pq)(),w.g,Z.Tw,(0,A.PD)(V),Q,t.useNewMentionStyles?R.F:L.y]));(0,P.af)(ei,d,l),(0,O.AV)(ei,q),(0,A.cy)(ep.current,ef.current,52);var e_=(0,p.useMemo)(function(){var e=(0,A.f1)(g,T).catalog;if($&&(null==$?void 0:$.length)>e.length){var t=$.slice(e.length).map(function(e){return{status:"",text:e.text,titleLevel:e.level-1||1,virtual:!0,targetId:"VirtualCatalogAnchorPoint"}});e=(0,c._)(e).concat((0,c._)(t))}return{catalog:e}},[$,g,T]).catalog,em=(0,p.useMemo)(function(){if(!ei)return{};var e=ei.getBoundingClientRect().left-20;return{shouldFold:F||(0,A.b6)(e),width:(0,A.XD)(e)}},[ei,F]),ev=em.shouldFold,eg=em.width;return(0,s.BX)(H,{css:{position:"relative",display:"inline"},children:[(0,Z.fv)(ei),G&&z&&(0,s.tZ)(A.$n,{root:ei}),(0,s.tZ)(I.H,(0,o._)((0,r._)({},f),{root:ei})),(0,s.tZ)(N._,(0,o._)((0,r._)({},m),{root:ei})),J&&(0,s.tZ)(W,(0,o._)((0,r._)({parentId:er,parentType:en,isVideoAnswer:J},d),{root:ei})),(0,k.H)({root:ei,mcnLinkCardProps:h,contentType:en,token:er,isAuthor:X}),(0,D.cD)({root:ei,createLinkCardPortal:b.EN,eduCardProps:_,Popover:E.Z}),G&&V&&(null==e_?void 0:e_.length)>0&&(0,s.BX)(s.HY,{children:[(0,s.tZ)(M.xu,{ref:eu,css:(0,r._)({position:"absolute",left:ev?-20:-eg-A.PO-20,top:ev?60:0,width:eg},ev&&{pointerEvents:"none"})}),(0,s.tZ)(A.fo,{catalogRef:ep,catalog:e_,inEditor:!1,scrollOffset:52,stickyOffset:ev?132:72,contentRoot:ei,container:es,shouldShowFoldIcon:ev,shouldCollapse:F,maskGradientColor:K,onClick:function(e){e.virtual&&(0,B.t)("该段落内容需付费后方可阅读",{theme:"red"})}})]}),(0,s.BX)("span",{id:"content",ref:ef,children:[(0,s.tZ)(b.Ho,(0,r._)({ref:(0,S.q)(n,ea),css:function(e){return(0,o._)((0,r._)({},(0,w.b)(e),x.e),{"img.content_image, img.origin_image":{'&[data-size="normal"]':{width:"100%",maxWidth:"100%"},'&[data-size="small"]':{width:"320px",maxWidth:"100%"}}})},html:eh(g,{sourceId:T,ua:ed,theme:el,shouldShowCatalog:G,shouldFoldCatalog:z,linkCardInfo:l})},ee)),(0,s.tZ)("span",{id:"VirtualCatalogAnchorPoint"})]})]})},$=n(54231),ee={},et=function(e,t){var n=t.split("/").reverse()[0],r=(0,a._)(n.split("."),2),o=r[0],i=r[1],c=(0,a._)(o.split("_"),2)[1],s=(0,$.HP)({appName:"heifetz"})("".concat("webp"===i||"gif"===i?i:"image",".").concat(c,".unknown.RichText"));switch(e){case"loadstart":ee[n]=Date.now();break;case"load":if(ee[n]){var u="".concat(s,".success");$.ZP.increment({raw:"".concat(u,".count")}),$.ZP.timing(u,Date.now()-ee[n]),delete ee[n]}break;case"timeout":ee[n]&&($.ZP.increment({raw:"".concat(s,".timeout.count")}),delete ee[n]);break;case"error":ee[n]&&($.ZP.increment({raw:"".concat(s,".failure.count")}),delete ee[n])}},en=function(e){return(0,s.tZ)(b.BU,(0,o._)((0,r._)({onLoadStateChange:et},e),{useMp4:!0}))},er=function(e){var t=e.node,n=e.index,r=t.dataset.thumbnail,o="uncomfortable"in t.dataset,i=function(){return r?"load-gif":"load-image"},c=(0,a._)((0,p.useState)(o?"uncomfortable":i()),2),u=c[0],l=c[1];return"load-image"===u?(0,s.tZ)(b.RP,{node:t,onLoadStateChange:et,index:n}):"load-gif"===u?(0,s.tZ)(b.pE,{node:t,Component:en}):"uncomfortable"===u?(0,s.BX)(s.HY,{children:[(0,s.tZ)(b.rI,{node:t,style:{display:"none"}}),(0,s.tZ)(x.i,{node:t,onClick:function(){delete t.dataset.uncomfortable,l(i())}})]}):null},eo=n(69920),ei=n(39658),ea=new eo.Z,ec=function(e){return ea("",e)},es=function(e){var t=e.paidInfo,n=e.targetSelector,r=(0,p.useMemo)(function(){var e=function(e){if(!e)return"";var t=e.font;return t&&t.base64?{normalFontFaceCss:"\n        @font-face {\n            font-family: 'DynamicFonts".concat(t.fontType,"';\n            font-display: 'swap';\n            font-weight: normal;\n            src: url(").concat(t.base64,");\n        }\n    "),boldFontFaceCss:t.boldBase64?"\n        @font-face {\n            font-family: 'DynamicFonts".concat(t.fontType,"';\n            font-display: 'swap';\n            font-weight: var(--zFontWeightBold);\n            src: url(").concat(t.boldBase64,");\n        }\n    "):"",fontFamilyCss:"\n        font-family: 'DynamicFonts".concat(t.fontType,"', -apple-system, BlinkMacSystemFont,\n        'Helvetica Neue', 'PingFang SC', 'Microsoft YaHei',\n        'Source Han Sans SC', 'Noto Sans CJK SC', 'WenQuanYi Micro Hei',\n        sans-serif;\n    ")}:{}}(t),r=e.normalFontFaceCss,o=e.boldFontFaceCss,i=e.fontFamilyCss;return[r,o,i?"".concat(n,"{").concat(i,"}"):""].filter(Boolean).map(ec)},[t,n]);return(0,s.tZ)(ei.ql,{children:r.map(function(e,t){return(0,s.tZ)("style",{type:"text/css",children:e},t)})})},eu=n(92258),el=n(81897),ed=n.n(el),ep=n(29229),ef=n(82267),eh=function(){var e=(0,a._)((0,p.useState)(null),2),t=e[0],n=e[1];return[t,(0,z.A)(function(e){n(e.currentTarget.dataset.mcnId)}),(0,z.A)(function(){return n(null)})]},e_=function(e){var t=e.goodsCardId,r=e.handleClose,o=(0,eu.useSelector)(function(e){return e.currentUser}),i=(0,ep._)(function(){return n.e(430).then(n.bind(n,23717))}),a=(0,ef._)(),c=(0,z.A)(function(e){a({id:e.id,source:e.sourceId,url:e.url,appSchemaIos:e.app_schema_ios,appSchemaAndroid:e.app_schema_android})});return t?(0,s.tZ)(i,{showModal:!!t,id:t,userId:o,clientId:ed().get("_zap"),onClose:r,onSelectCard:c}):null},em=n(2122),ev=function(e){var t=e.className,n=e.html,r=e.lazyLoadImageProps,o=(0,a._)((0,p.useState)(null),2),i=o[0],c=o[1];return(0,b.RK)(i,r),(0,s.tZ)("div",{ref:c,children:(0,s.tZ)(em.Z,{className:t,content:n})})},eg=n(63638),eT=n(36892),eE=n(61533),ey=n(85661),eC=n(91850),eS=n(83537),eI=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id,t=(0,a._)((0,eC.k)(),2),n=t[0],i=t[1],c=(0,a._)((0,eC.k)(),2),s=c[0],u=c[1];(0,eS.K)(i.on,s?100:null),(0,eS.K)(i.off,s?null:100);var l=(0,p.useRef)(null);return[(0,o._)((0,r._)({ref:l},n&&{"aria-haspopup":n,"aria-controls":e}),{onMouseEnter:u.on,onMouseLeave:u.off}),{id:e,hitSlop:8,isOpen:n,target:l.current,onMouseEnter:u.on,onMouseLeave:u.off}]},eA=function(e){var t=e.data,i=!(0,y.n)().Mobile,c=(0,ep._)(function(){return n.e(9597).then(n.bind(n,89804))},i),u=(0,a._)(eI({id:"popover-".concat(t.id)}),2),l=u[0],d=u[1];return(0,s.BX)(s.HY,{children:[(0,s.tZ)(R.h,(0,r._)({data:t},i&&l)),i&&c?(0,s.tZ)(c,(0,o._)((0,r._)({},d),{popoverID:d.id,id:t.id,urlToken:t.id,user:t})):null]})},eb=function(e){var t=e.getAttribute("data-hash"),n=e.textContent.replace(/^@/,""),r=document.createElement("span");return e.parentNode.replaceChild(r,e),{target:r,data:{id:t,name:n}}},ew=function(e){var t=(0,U.m)(),n=(0,p.useRef)(t),r=(0,a._)((0,p.useState)(null),2),o=r[0],i=r[1];return(0,p.useEffect)(function(){if(e){var t=Array.from(e.querySelectorAll(".member_mention,.ztext-mention-hook"));t.length&&i(t.map(eb).map(function(e,t){var r=e.data,o=e.target;return(0,eE.createPortal)(n.current.useNewMentionStyles?(0,s.tZ)(eA,{data:r},t):(0,s.BX)(ey.Z,{user:r,children:["@",r.name]},t),o)}))}},[e]),o},eZ=n(55462),ex=n(88423),ek=function(e,t){var n=t.root;if(!e.defaultPrevented){var o=e.target;if(!("img"!==o.tagName.toLowerCase()||!o.src.includes("zhimg")&&o.src.includes("equation")||o.classList.contains("ztext-gif")&&!o.parentNode.classList.contains("isPlaying"))){var i=Array.from(n.querySelectorAll(["img"])).filter(function(e){return e.src.includes("zhimg")&&!e.src.includes("equation")}),a=i.indexOf(o);if(-1!==a){e.preventDefault();var c=i.map(function(e){return e.dataset.thumbnail&&e.src.replace(/\.jpg|\.webp/,".gif")||e.dataset.src||e.src||""}).map(function(e){return(0,ex.imgUrl)(e,(0,r._)({quality:""},e.endsWith("webp")&&{extension:"jpg"}))});(0,eZ.Z)("base/openImage").dispatch({images:c,index:a})}}}},eR=function(e){var t=(0,y.n)(),n=(0,p.useCallback)(function(n){t.ZhihuHybrid&&ek(n,{root:e})},[e,t.ZhihuHybrid]);(0,p.useEffect)(function(){if(e)return e.addEventListener("click",n),function(){e.removeEventListener("click",n)}},[e,n])},eN=n(80565),eO=n(24340),eP=n(29504),eD=function(e){var t=e.getAttribute("data-poster"),n={title:e.getAttribute("data-name"),thumbnail:"data:,"===t?"":t,url:e.getAttribute("href"),src:e.getAttribute("data-src")};n=e.getAttribute("data-lens-id")?(0,o._)((0,r._)({},n),{isLens:!0,id:e.getAttribute("data-lens-id"),isPlayable:!0}):(0,o._)((0,r._)({},n),{isLens:!1,id:e.getAttribute("data-video-id"),isPlayable:"true"===e.getAttribute("data-video-playable")}),e.hasAttribute("data-lens-status")&&(n=(0,o._)((0,r._)({},n),{error:{status:e.getAttribute("data-lens-status"),message:e.getAttribute("data-description")}}));var i=document.createElement("div");return e.parentNode.replaceChild(i,e),{target:i,data:n}},eL=function(e){return e.getAttribute("data-lens-id")||e.getAttribute("data-video-id")},eM=function(e,t){var n=t.hideWatermark,r=t.contentType,o=t.contentId,i=(0,a._)((0,p.useState)(null),2),c=i[0],u=i[1];return(0,p.useEffect)(function(){if(e){var t=Array.from(e.querySelectorAll(".video-box, .video-link, .unprocessable_video"));t.length&&u(t.filter(eL).map(eD).map(function(e,t){var i=e.data,a=e.target;return(0,eE.createPortal)((0,s.BX)("div",{css:{margin:"20px 0"},children:[(0,s.tZ)(eO.Z,{ratio:16/9,children:(0,s.tZ)(eP.Z,{zaProps:{type:r,token:o},videoId:i.id,contentId:o,contentType:r,hideWatermark:n},t)}),!!i.title&&(0,s.tZ)(M.xv,{textAlign:"center",fontSize:"13px",lineHeight:"20px",mt:"10px",color:"MapText06A",css:(0,eN.S)(2),children:i.title})]}),a)}))}},[e,n,r,o]),c},eB=function(e){var t=e.root,r=e.ecommerce,o=e.sourceType,i=e.sourceId,a=e.entityWords,c=e.hideWatermark,l=e.onEntityWordClick;return(0,s.BX)(s.HY,{children:[eM(t,{hideWatermark:c,contentType:o,contentId:i}),ew(t),(0,s.tZ)(_.SV,{target:"ecommercePortal",replacement:null,children:(0,h.su)(t,{ecommerce:r,getComponent:function(){return Promise.resolve().then(n.bind(n,27725))}})}),(0,u.K)(t,{type:o,sourceId:i,entityWords:a,onClick:l})]})},eU=function(e){var t,n,l,d,h,_,m,E,y=e.className,C=e.ecommerce,S=e.html,I=e.shouldShowCatalog,A=e.sourceId,b=e.sourceType,w=e.isExpanded,Z=e.entityWords,x=e.isVideoAnswer,k=e.hideWatermark,R=(0,i._)(e,["className","ecommerce","html","shouldShowCatalog","sourceId","sourceType","isExpanded","entityWords","isVideoAnswer","hideWatermark"]),N=(0,a._)((0,p.useState)(null),2),O=N[0],P=N[1],D=(0,p.useMemo)(function(){return S?f.compose.apply(void 0,(0,c._)([(0,u.z)(Z)].filter(Boolean)))(S):""},[S,Z]);eR(O),n=(t=(0,a._)((0,p.useState)(!1),2))[0],l=t[1],d=(0,eg.useTracker)().trackEvent,h=(0,z.A)((0,eT.N)(function(){document.getSelection().toString()&&d({eventType:"Click",elementLocation:{moduleId:"text_select",type:"Text"}})},1e3)),_=(0,z.A)(function(){document.addEventListener("selectionchange",h)}),m=(0,z.A)(function(){document.getSelection().toString()&&(d({eventType:"Click",elementLocation:{moduleId:"text_copy",type:"Text",text:n?"快捷键复制":"右键复制"}}),l(!1))}),E=(0,z.A)(function(e){("c"===e.key||67===e.keyCode)&&(e.ctrlKey||e.metaKey)&&l(!0)}),(0,p.useEffect)(function(){if(O)return O.addEventListener("selectstart",_),O.addEventListener("copy",m),document.addEventListener("keydown",E),function(){O.removeEventListener("selectstart",_),O.removeEventListener("copy",m),document.removeEventListener("keydown",E),document.removeEventListener("selectionchange",h)}},[O,m,E,h,_]);var L=(0,a._)(eh(),3),M=L[0],B=L[1],U=L[2],G=(0,T.K)();return(0,s.BX)(s.HY,{children:[(0,s.tZ)(J,(0,o._)((0,r._)({},R),{className:y,html:void 0===w||w?D:S,onRef:P,ConditionalImage:er,adLinkCardProps:{parentId:A,parentType:b},mcnLinkCardProps:{onClick:B},mkSkuLinkCardProps:{cardSize:"large",enableBackdrop:!1,sourceConvert:!1,tagPreset:"plain",enableMetaTag:!1,enableButton:!0,buttonPreset:"plain",buttonColor:"orange",enableHint:!1},eduCardProps:{token:A,contentType:b},zvideoLinkCardProps:{enableInlinePlay:!0},shouldShowCatalog:I,sourceId:A,useCatalogV2:!0,isVideoAnswer:x})),(0,s.tZ)(eB,{root:O,ecommerce:C,sourceId:A,sourceType:b,entityWords:Z,hideWatermark:k,onEntityWordClick:function(e,t){if(G){e.preventDefault();var n=new URL(t.linkUrl),r=new URLSearchParams(n.search);(0,g.Y$)({query:r.get("q"),contentId:r.get("content_id"),contentType:r.get("content_type"),matchOrder:r.get("match_order"),zhidaSource:"entity",zdToken:r.get("zd_token")})}}}),M&&(0,s.tZ)(e_,{goodsCardId:M,handleClose:U})]})},eG=function(e){var t=e.paidInfo,n=(0,i._)(e,["paidInfo"]);return(0,s.tZ)(eU,(0,r._)({css:(0,l.iv)((0,d.Z)(t))},n))},eF=function(e){var t;return(null==e?void 0:null===(t=e.font)||void 0===t?void 0:t.fontType)||""},eH=function(e){var t=e.paidInfo,n=(0,i._)(e,["paidInfo"]),o=eF(t);return(0,s.BX)(s.HY,{children:[(0,s.tZ)(es,{paidInfo:t,targetSelector:'.RichText[data-font-id="'.concat(o,'"]')}),(0,s.tZ)(eU,(0,r._)({"data-font-id":o},n))]})},ez=function(e){var t=e.isNovel,n=e.paidInfo,o=(0,i._)(e,["isNovel","paidInfo"]);if(t){var a=o.className,c=o.html;return(0,s.tZ)(ev,{className:a,html:c,lazyLoadImageProps:{onLoadStateChange:et,useWebP:!1}})}return n?"1"===m.Z.apollo.dynamic_font_schema?(0,s.tZ)(eH,(0,r._)({paidInfo:n},o)):(0,s.tZ)(eG,(0,r._)({paidInfo:n},o)):(0,s.tZ)(eU,(0,r._)({},o))}},83821:function(e,t,n){"use strict";n.d(t,{F3:function(){return _},ZP:function(){return h}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(85626),l=n(85879),d=n(89146),p=n(14168),f=n.n(p),h=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{visible:e.props.disabled}),(0,a._)((0,r._)(e),"onShow",function(){e.setState({visible:!0})}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){this.state.visible||(this.props.timeout>0?this.timeout=setTimeout(this.onShow,this.props.timeout):this.onShow())}},{key:"componentWillUnmount",value:function(){this.timeout&&clearTimeout(this.timeout)}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.placeholder;return this.state.visible?t:n}}]),n}(n(87363).Component);(0,a._)(h,"propTypes",{disabled:f().bool,placeholder:f().node,timeout:f().number}),(0,a._)(h,"defaultProps",{disabled:!1,placeholder:null,timeout:-1});var _=(0,d.Z)("withSSRSuspend",function(e){return function(t){return(0,l.tZ)(h,{children:(0,l.tZ)(e,(0,s._)({},t))})}})},28209:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(87363);function o(){return(0,r.useEffect)(function(){window.scrollTo(0,0)},[]),null}},68491:function(e,t,n){"use strict";n.d(t,{Z:function(){return eX}});var r,o,i,a=n(55164),c=n(85879),s=n(30037),u=n(6080),l=n(45804),d=n(97187),p=n(57477),f=n(65733),h=n(67700),_=n(71783),m=n(36728),g=n(62713),T=n(61533),E=n(87641),y=n(63638),C=n(62639),S=n(91726),I=n(94009),A=n(24405),b=n(76280),w=n(87363),Z={Top:{top:"-14px",transform:"scale(0.7, 0.4)"},Bottom:{bottom:"-14px",transform:"rotate(180deg) scale(0.7, 0.4)"}},x=function(e){var t=e.arrowPosition,n=e.arrowShift,r=(0,A.F)().colors.MapUIFrame03C;return(0,c.tZ)(b.ZP,{css:(0,p._)((0,a._)({position:"absolute",color:r},Z[t]),{left:n})})},k=function(e){var t=e.shown,n=e.position,r=e.arrowPosition,o=void 0===r?"Bottom":r,i=e.children,s=e.root,u=(0,w.useRef)(null),l=(0,I._)((0,w.useState)({left:0,top:0}),2),d=l[0],h=l[1],_=(0,I._)((0,w.useState)(0),2),m=_[0],g=_[1],T=(0,I._)((0,w.useState)(0),2),y=T[0],C=T[1],S=n.left,A=n.top,b=(0,f.A)(function(e){var t,n,r,i,a,c,s,u,l,d,p,f,_=(null===(p=document.documentElement)||void 0===p?void 0:p.scrollTop)||(null===(f=document.body)||void 0===f?void 0:f.scrollTop),m=e.clientWidth||0,T=(n=(t={arrowPosition:o,top:A,left:S,popWidth:m,popHeight:e.clientHeight||0,scrollTop:_,rootWidth:y}).arrowPosition,r=t.popWidth,i=t.popHeight,a=t.top,c=t.left,s=t.rootWidth,u=t.scrollTop,l=c-r/2,16>Math.abs(u-(d="Top"===n?a+17+10:a-i-10))&&(d=16),l<16&&(l=16),l>s-16-r&&(l=s-16-r),{left:l,top:d}),E=function(e){var t=e.boxPosition,n=e.left,r=e.popWidth,o=n-t.left-10;if(o<10)return 10;var i=r-10-20;return o>i?i:o}({boxPosition:T,left:S,popWidth:m});h(T),g(E)});return((0,w.useLayoutEffect)(function(){t&&(null==u?void 0:u.current)&&b(null==u?void 0:u.current)},[t,S,A,o,b]),(0,w.useLayoutEffect)(function(){var e;C(null===(e=null==s?void 0:s.getBoundingClientRect())||void 0===e?void 0:e.width)},[s]),t)?(0,c.BX)(E.xu,{ref:u,sx:(0,p._)((0,a._)({zIndex:1,minWidth:"40px",position:"absolute"},d),{backgroundColor:"MapUIFrame03C",borderRadius:"12px",userSelect:"none"}),onClick:function(e){return e.stopPropagation()},children:[i,(0,c.tZ)(x,{arrowPosition:o,arrowShift:m})]}):null},R=function(e){var t=e.icon,n=e.text,r=e.onClick,o=e.segmentId,i=e.za,s=e.className;return(0,c.BX)(y.ZAClick,(0,p._)((0,a._)({zaModuleId:"detail_tool_bar",zaType:"Button",shouldTrackShow:!0},i),{extra:{configMap:{segment_id:o||"0"}},as:E.kC,onClick:r,className:s,flexDirection:"column",alignItems:"center",justifyContent:"space-between",width:"40px",height:"40px",margin:"0 7px",fontWeight:"500",css:{cursor:"pointer"},children:[t,(0,c.tZ)("span",{css:{whiteSpace:"nowrap",lineHeight:"14px"},children:n})]}))},N=function(e){return e.isLike?(0,c.tZ)(_.ZP,{css:function(e){return{color:e.colors.GRD01A}}}):(0,c.tZ)(m.Z,{})},O={Copy:function(e){var t=e.onItemClick,n=e.segmentData.id,r=(0,f.A)(function(e){var n,r;null===(n=e.nativeEvent)||void 0===n||null===(r=n.stopImmediatePropagation)||void 0===r||r.call(n),e.preventDefault(),t({module:"Copy"})});return(0,c.tZ)(R,{onClick:r,icon:(0,c.tZ)(h.Z,{}),text:"复制",za:{zaBlock:"TextCopy",zaText:"复制"},segmentId:n})},Like:function(e){var t=e.onItemClick,n=e.segmentData,r=n.id,o=n.isLike,i=n.likeCount,a=(0,f.A)(function(e){var n,r;null===(n=e.nativeEvent)||void 0===n||null===(r=n.stopImmediatePropagation)||void 0===r||r.call(n),e.preventDefault(),t({module:"Like"})});return(0,c.tZ)(R,{onClick:a,icon:(0,c.tZ)(N,{isLike:o}),text:0===i?"喜欢":i,segmentId:r,za:{zaAction:o?"UnLike":"Like",zaText:"喜欢"}})},Comment:function(e){var t=e.onItemClick,n=e.segmentData,r=n.commentCount,o=n.id,i=(0,f.A)(function(e){var n,r;null===(n=e.nativeEvent)||void 0===n||null===(r=n.stopImmediatePropagation)||void 0===r||r.call(n),e.preventDefault(),t({module:"Comment"})});return(0,c.tZ)(R,{onClick:i,icon:(0,c.tZ)(g.ZP,{}),text:0===r?"评论":r,segmentId:o,za:{zaBlock:"Segment",zaText:"评论"}})},AIExplain:function(e){var t=e.onItemClick,n=e.segmentData.id,r=(0,f.A)(function(e){var n,r;null===(n=e.nativeEvent)||void 0===n||null===(r=n.stopImmediatePropagation)||void 0===r||r.call(n),e.preventDefault(),t({module:"AIExplain"})});return(0,S.K)()?(0,c.tZ)(R,{onClick:r,icon:(0,c.tZ)(C.Z,{fill:"var(--MapText99B)"}),text:"AI 解释",segmentId:n,za:{zaBlock:"AIExplain",zaText:"AI 解释"}}):null}},P=function(e){var t=e.modules,n=e.root,r=e.show,o=e.position,i=e.arrowPosition,a=e.text,s=e.segmentData,u=e.onItemClick;return n?(0,T.createPortal)((0,c.tZ)(k,{root:n,shown:r,position:o,arrowPosition:i,children:(0,c.tZ)(E.xu,{px:"7px",py:"12px",fontSize:"10px",color:"MapText99B",children:(0,c.tZ)(E.kC,{justifyContent:"space-between",css:{svg:{width:"22px",height:"22px"}},children:null==t?void 0:t.map(function(e){var t=O[e];return(0,c.tZ)(t,{text:a,segmentData:s,onItemClick:u},e)})})})}),n):null},D=(0,w.createContext)(null),L=function(e){var t=e.children,n=e.contentId,r=e.contentType,o=e.richTextRef,i=e.highlighter,a=e.author,s=e.questionId,u=e.reshipmentSettings,l=e.relationship,d=e.isAuthor,p=(0,w.useMemo)(function(){return{contentId:n,contentType:r,richTextRef:o,highlighter:i,author:a,questionId:s,reshipmentSettings:u,relationship:l,isAuthor:d}},[u,null==l?void 0:l.isAuthor,null==l?void 0:l.isAuthorized,d]);return(0,c.tZ)(D.Provider,{value:p,children:t})},M=function(){var e=(0,w.useContext)(D);if(!e)throw Error("SegmentInteractionContext 未初始化");return e},B=n(9338),U=n(30971),G=n(91850),F=n(36892),H=n(88197),z={likeCount:0,commentCount:0,myCommentCount:0,isLike:!1,isMaster:!1,id:void 0},q=n(15030),V=n(49899),W=n(74314);function X(e,t){for(var n=e;n&&!t(n);)n=n.parentNode;return n}function K(e){return X(e,function(e){return(0,q._)(e,HTMLElement)&&!!e.dataset.pid})}function j(e,t,n,r){if(t===e){var o=e.childNodes;if(0===o.length)return e;if(r){var i=Math.min(n,o.length-1);return o[i]}var a=Math.max(0,Math.min(n-1,o.length-1));return o[a]}for(var c=t;c.parentNode&&c.parentNode!==e;)c=c.parentNode;return c}function Y(e){return X(e,function(e){return(0,q._)(e,HTMLElement)&&e.classList.contains("highlight-wrap")})}function Q(e){return X(e,function(e){return(0,q._)(e,HTMLElement)&&e.classList.contains("RichText-LinkCardContainer")})}function J(e){return(0,p._)((0,a._)({},z),{text:$(e)})}function $(e){var t=e.commonAncestorContainer;if(!((0,q._)(t,HTMLElement)&&t.classList.contains("RichText")))return e.toString();var n,r=e.cloneContents(),o=document.createElement("div"),i=r.querySelectorAll("[data-pid]");(n=o).append.apply(n,(0,V._)(Array.from(i)));var a=o.innerText;return o=null,a}function ee(e){var t=e.startMeta,n=e.endMeta,r=t.pid,o=document.querySelector('[data-pid="'.concat(r,'"]'));if(!o)return"";var i=t.paragraphOffset,a=n.paragraphOffset;return o.innerText.slice(i,a)}var et=n(75472),en=n.n(et),er=n(38322),eo=n.n(er);function ei(e,t){return t.find(function(t){return t.id===e})}var ea=n(9813),ec=n(99281),es=(0,ec.n2)({}),eu=(0,ec.n2)(null),el=[],ed=[],ep=function(e){var t;return[(0,ec.aO)(es,function(n){var r;return null!==(t=null===(r=n[e])||void 0===r?void 0:r.list)&&void 0!==t?t:el}),(0,ec.Bn)(es,(0,ea.ZP)(function(t,n){var r=t[e],o=null!==(a=null==r?void 0:r.list)&&void 0!==a?a:el,i=null!==(c=null==r?void 0:r.disabledPids)&&void 0!==c?c:ed;if(n&&"object"==typeof n&&"list"in n&&!Array.isArray(n)){var a,c,s,u="function"==typeof n.list?n.list(o):n.list,l=null!==(s=n.disabledPids)&&void 0!==s?s:i;t[e]={list:u,initialized:!0,disabledPids:l}}else{var d="function"==typeof n?n(o):n;t[e]={list:d,initialized:!0,disabledPids:i}}}))]},ef=function(e){var t=(0,ec.aO)(eu,function(e){return e}),n=(0,ec.Bn)(eu);return[t===e,function(t){n(function(n){var r=n===e;return("function"==typeof t?t(r):t)?e:r?null:n})}]},eh=function(e){var t;return(0,ec.aO)(es,function(n){var r;return null!==(t=null===(r=n[e])||void 0===r?void 0:r.initialized)&&void 0!==t&&t})},e_=function(e){var t;return(0,ec.aO)(es,function(n){var r;return null!==(t=null===(r=n[e])||void 0===r?void 0:r.disabledPids)&&void 0!==t?t:ed})},em=n(19061);function ev(e){return document.createTreeWalker(e,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,{acceptNode:function(e){return e.nodeType===Node.TEXT_NODE||"BR"===e.nodeName?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}})}function eg(e){if(e.nodeType===Node.TEXT_NODE){var t,n;return null!==(n=null===(t=e.textContent)||void 0===t?void 0:t.length)&&void 0!==n?n:0}return"BR"===e.nodeName?1:0}function eT(e,t){var n=t?e.startContainer:e.endContainer,r=t?e.startOffset:e.endOffset,o=K(n);return o?n===o?function(e,t){for(var n=0,r=Array.from(e.childNodes),o=0;o<t&&o<r.length;o++){var i=r[o];if(i.nodeType===Node.TEXT_NODE||"BR"===i.nodeName)n+=eg(i);else for(var a=ev(i),c=void 0;c=a.nextNode();)n+=eg(c)}return n}(o,r):n.nodeType===Node.TEXT_NODE?function(e,t,n){for(var r,o=0,i=ev(e);r=i.nextNode();){if(r===t)return r.nodeType===Node.TEXT_NODE&&(o+=n),o;o+=eg(r)}return null}(o,n,r):function(e){for(var t,n=0,r=e,o=!1;r&&!(null==r?void 0:null===(t=r.dataset)||void 0===t?void 0:t.pid);)r.previousSibling?(r=r.previousSibling,o=!1):(r=r.parentElement,o=!0),!o&&((0,q._)(r,Text)?n+=r.length:(0,q._)(r,HTMLElement)&&(n+=r.innerText.length));return n}(n)+r:null}function eE(e){return e.slice().sort(function(e,t){var n=e.startMeta.pid.localeCompare(t.startMeta.pid);return 0!==n?n:!e.isMaster&&t.isMaster?-1:e.isMaster&&!t.isMaster?1:e.startMeta.paragraphOffset-t.startMeta.paragraphOffset})}function ey(e,t){var n=e.querySelector('[data-pid="'.concat(t.pid,'"]'));if(!n)return null;var r=n.tagName,o=Array.from(e.querySelectorAll(r)).findIndex(function(e){return e===n});return{parentTagName:r,parentIndex:o,textOffset:function(e,t){if(0===t)return 0;for(var n=ev(e),r=0,o=0;i=n.nextNode();)if(i.nodeType===Node.TEXT_NODE){var i,a,c,s=null!==(c=null===(a=i.textContent)||void 0===a?void 0:a.length)&&void 0!==c?c:0;if(r+s>=t)return o+(t-r);r+=s,o+=s}else if("BR"===i.nodeName){if(r>=t)return o;r+=1}return o}(n,t.paragraphOffset)}}var eC=n(11362),eS=n.n(eC),eI=n(24246),eA=n(65744),eb=n(81956),ew=n(41805),eZ=(r=(0,B._)(function(e,t,n,r,o){return(0,U.__generator)(this,function(i){switch(i.label){case 0:return[4,e("https://www.zhihu.com/api/v4/reaction/".concat(t,"s/").concat(n,"/segment_reaction"),{method:"POST",body:(0,p._)((0,a._)({},o?{seg_id:o}:{}),{content:r.text,position:{start:{paragraph_id:r.startMeta.pid,offset:r.startMeta.paragraphOffset},end:{paragraph_id:r.endMeta.pid,offset:r.endMeta.paragraphOffset}}})})];case 1:return[2,i.sent().payload.segId]}})}),function(e,t,n,o,i){return r.apply(this,arguments)}),ex=function(e,t){return(0,em.G)(e.split(","),t.split(",")).sort().join(",")},ek=function(e,t){var n=e.startMeta.paragraphOffset,r=e.endMeta.paragraphOffset,o=t.startMeta.paragraphOffset,i=t.endMeta.paragraphOffset;return r<o||n>i?null:{startMeta:n<=o?e.startMeta:t.startMeta,endMeta:r>=i?e.endMeta:t.endMeta}},eR=function(e,t){var n=e.startMeta.paragraphOffset,r=e.endMeta.paragraphOffset,o=t.startMeta.paragraphOffset,i=t.endMeta.paragraphOffset;return n>o&&r<i?{startMeta:t.startMeta,endMeta:t.endMeta}:null},eN=(o=(0,B._)(function(e,t){var n,r,o,i,c,s,u,l,d,f,h;return(0,U.__generator)(this,function(_){switch(_.label){case 0:return n=e.highlightList,r=e.currentSegmentData,o=e.updateSegmentData,i=e.fetchDelete,c=r.id,[4,i()];case 1:return _.sent(),u=!(s=o(r)).isLike&&0===s.myCommentCount,l=[],f=(d=n).findIndex(function(e){return e.id===c}),h=d[f].fullMatch,u&&!h?(l.push(c),d=(0,ea.Uy)(d,function(e){e.splice(f,1)})):d=(0,ea.Uy)(d,function(e){-1!==f&&(e[f]=(0,p._)((0,a._)({},e[f],s),{fullMatch:!1}))}),[2,t(eE(d),s,u,{deleteIds:l})]}})}),function(e,t){return o.apply(this,arguments)}),eO=(i=(0,B._)(function(e,t){var n,r,o,i,c,s,u,l,d,f,h,_,m,g,T,E,y,C,S;return(0,U.__generator)(this,function(I){switch(I.label){case 0:var A,b,w,Z,x,k,R;if(n=e.richTextRef,r=e.highlightList,o=e.currentSegmentData,i=e.updateSegmentData,c=e.rangeData,s=e.fetchAdd,l=void 0,d=void 0,c)A=r,b=c.startMeta,w=c.endMeta,Z=c.text,x=["pid","paragraphOffset"],(f=A.find(function(e){var t=e.startMeta,n=e.endMeta,r=e.text;return(en()(eo()(b,x),eo()(t,x))&&en()(eo()(w,x),eo()(n,x))||en()(eo()(w,x),eo()(t,x))&&en()(eo()(b,x),eo()(n,x)))&&Z===r}))&&(l=f.id),u=c;else{if(k=r,h=(R=ei(o.id,k))?{text:R.text,startMeta:R.startMeta,endMeta:R.endMeta}:null,l=o.id,!h)return[2];u=h}if(!l)return[3,2];return[4,s(u,l)];case 1:return I.sent(),[3,4];case 2:return[4,s(u)];case 3:d=I.sent(),I.label=4;case 4:return g=(m=function(e,t,n,r){var o=t.startMeta.pid;if(n.id)return{highlightList:eE(e.map(function(e){return e.id===n.id?(0,a._)({},e,n):e})),newHighlight:null,deleteIds:[]};var i=(0,p._)((0,a._)({},n),{id:r}),c=null,s=[],u=e.reduce(function(e,n){if(n.startMeta.pid!==o)return e.push(n),e;var r=n.isMaster?ek(n,t):eR(n,t);return r?(!n.isMaster&&r?e.push(n):s.push(n.id),(c=c?(0,p._)((0,a._)({},c),{id:ex(c.id,n.id),startMeta:r.startMeta,endMeta:r.endMeta,likeCount:c.likeCount+n.likeCount,myCommentCount:c.myCommentCount+n.myCommentCount,commentCount:c.commentCount+n.commentCount,isLike:c.isLike||n.isLike,isMaster:c.isMaster||n.isMaster}):{id:ex(n.id,i.id),text:"",startMeta:r.startMeta,endMeta:r.endMeta,likeCount:i.likeCount+n.likeCount,myCommentCount:i.myCommentCount+n.myCommentCount,commentCount:i.commentCount+n.commentCount,isLike:i.isLike||n.isLike,isMaster:i.isMaster||n.isMaster}).text=ee(c),e):(e.push(n),e)},[]),l=(0,V._)(u),d=null;return c?(d=c,l.push(c)):(d=(0,a._)({id:i.id,text:ee(t),startMeta:t.startMeta,endMeta:t.endMeta},i),l.push(d)),{highlightList:eE(l),newHighlight:d,deleteIds:s}}(r,u,_=i(o,l),d)).highlightList,T=m.newHighlight,E=m.deleteIds,d&&(_.id=d),y=void 0,T&&(C=ey(n.current,null==T?void 0:T.startMeta),S=ey(n.current,T.endMeta),C&&S&&(y={startMeta:C,endMeta:S,text:T.text,id:T.id})),t(g,_,!1,{add:y,deleteIds:E}),[2]}})}),function(e,t){return i.apply(this,arguments)});function eP(){return(eP=(0,B._)(function(e,t,n,r,o,i,c,s,u){return(0,U.__generator)(this,function(t){return i.isLike?[2,eN({highlightList:o,currentSegmentData:i,fetchDelete:function(){var e;return e=i.id,s("https://www.zhihu.com/api/v4/reaction/".concat(n,"s/").concat(r,"/segment_reaction"),{method:"DELETE",body:{seg_ids:e}})},updateSegmentData:function(e){return(0,p._)((0,a._)({},e),{isLike:!1,likeCount:e.likeCount-1,isMaster:0!==e.myCommentCount})}},u)]:[2,eO({richTextRef:e,highlightList:o,currentSegmentData:i,rangeData:c,fetchAdd:function(e,t){return eZ(s,n,r,e,t)},updateSegmentData:function(e,t){return(0,p._)((0,a._)({},e),{id:t,likeCount:e.likeCount+1,isLike:!0,isMaster:!0})}},u)]})})).apply(this,arguments)}var eD=n(82371),eL=function(e){(0,eA.t)((0,eD.n)(e),{theme:"red"})},eM=n(22107),eB=n(94707),eU=n(87320),eG=function(){function e(t){var n=this;(0,eM._)(this,e),(0,eU._)(this,"parent",void 0),this.parent=new Map,t.forEach(function(e){return n.parent.set(e,e)})}return(0,eB._)(e,[{key:"find",value:function(e){var t=this.parent.get(e);if(!t||t===e)return e;var n=this.find(t);return this.parent.set(e,n),n}},{key:"union",value:function(e,t){var n=this.find(e),r=this.find(t);n!==r&&this.parent.set(n,r)}},{key:"getGroups",value:function(e){var t=this,n=new Map;return e.forEach(function(e){var r=t.find(e.id),o=n.get(r)||[];o.push(e),n.set(r,o)}),n}}]),e}(),eF=n(7835),eH=function(e,t){if(!t.current)return!1;var n=e.target;return!!n&&t.current.contains(n)},ez=function(e){var t,n,r,o,i,s,u,h,_,m,g,T,E,y,C,S,A,b,Z,x,k,R,N,O,D,L,V,ee,et,en,er,eo,ea,ec,es,eu,el,ed,ev,eg,eC,eZ,ex,ek,eR,eD,eM,eB,eU,ez,eq,eV,eW,eX,eK,ej,eY,eQ,eJ,e$,e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,te,tt,tn,tr,to,ti,ta=e.segmentsFromContent,tc=e.permissions,ts=M(),tu=ts.contentId,tl=ts.contentType,td=(n=(t=M()).contentId,r=t.highlighter,i=(o=(0,I._)(ep(n),2))[0],s=o[1],u=e_(n),_=(h=(0,I._)((0,w.useState)({left:0,top:0}),2))[0],m=h[1],T=(g=(0,I._)(ef(n),2))[0],E=g[1],C=(y=(0,I._)((0,G.k)(!1),2))[0],S=y[1],b=(A=(0,I._)((0,w.useState)(null),2))[0],Z=A[1],k=(x=(0,I._)((0,w.useState)(z),2))[0],R=x[1],O=(N=(0,I._)((0,w.useState)(null),2))[0],D=N[1],L=(0,f.A)(function(e){var t;if(null==e?void 0:e.onlyPopover){T&&(E(!1),D(null),r.removeClass("highlight-wrap-checking"));return}null===(t=window.getSelection())||void 0===t||t.removeAllRanges(),T&&E(!1),C&&S.off(),D(null),r.removeClass("highlight-wrap-checking")}),V=(0,F.N)(function(e){if(0!==e.rangeCount){var t,n,r=e.getRangeAt(0);if(!function(e,t){if(a=e.startContainer,c=e.endContainer,Q(a)&&Q(c))return!1;var n=function(e){var t=e.commonAncestorContainer.nodeType===Node.ELEMENT_NODE?e.commonAncestorContainer:e.commonAncestorContainer.parentNode,n=j(t,e.startContainer,e.startOffset,!0),r=j(t,e.endContainer,e.endOffset,!1);if(n!==r&&(n.compareDocumentPosition(r)&Node.DOCUMENT_POSITION_PRECEDING)!=0){var o=n;n=r,r=o}for(var i=[],a=n;a&&(i.push(a),a!==r);)a=a.nextSibling;return i}(e),r=!0,o=!1,i=void 0;try{for(var a,c,s,u=n[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var l=s.value,d=K(l);if(!d)return!1;var p=d.dataset.pid;if(p&&t&&t.includes(p)||function e(t,n){if((0,q._)(t,HTMLElement)){if(n.intersectsNode(t)&&(t.classList.contains("ztext-math")||"SUP"===t.tagName))return!0;for(var r=0;r<t.childNodes.length;r++)if(e(t.childNodes[r],n))return!0}else(0,q._)(t,Text)&&n.intersectsNode(t);return!1}(l,e))return!1}}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return!0}(r,u)){T&&E(!1);return}var o=function(e){var t=e.startContainer,n=e.endContainer,r=eT(e,!0),o=eT(e,!1);if(null==r||null==o)return null;var i=$(e),a=K(t);if(!a)return null;var c=a.dataset.pid,s=K(n);return s?{startMeta:{pid:c,paragraphOffset:r},endMeta:{pid:s.dataset.pid,paragraphOffset:o},text:i}:null}(r),c=function(e,t){var n=t.startContainer,r=t.endContainer,o=Y(n),i=Y(r);if(!o||!i)return J(t);var c=o.dataset.highlightId,s=i.dataset.highlightId;if(!c||!s)return J(t);var u=e.find(function(e){return e.id===c}),l=e.find(function(e){return e.id===s});return u&&l&&u.id===l.id?(0,p._)((0,a._)({},J(t)),{id:u.id,likeCount:u.likeCount,isLike:u.isLike}):J(t)}(i,r);R(c),Z(o),D(o?0===c.commentCount?{text:o.text,position:{start:{offset:o.startMeta.paragraphOffset,paragraphId:o.startMeta.pid},end:{offset:o.endMeta.paragraphOffset,paragraphId:o.endMeta.pid}}}:{id:c.id,text:o.text}:null),m((t=r.getBoundingClientRect(),n=document.body.scrollTop||document.documentElement.scrollTop,{left:t.left+t.width/2,top:n+t.top})),E(!0)}},300,{trailing:!0}),et=(0,f.A)((ee=function(e,t){R(t),Z(null),D(0===t.commentCount?{text:t.text,position:{start:{offset:t.startMeta.paragraphOffset,paragraphId:t.startMeta.pid},end:{offset:t.endMeta.paragraphOffset,paragraphId:t.endMeta.pid}}}:{id:t.id,text:t.text}),m(e),E(!0)},function(e,t,n){var o=e.id;if(t.removeClass("highlight-wrap-checking"),n.stopImmediatePropagation(),!(!n.target||X(n.target,function(e){return(0,q._)(e,HTMLElement)&&"A"===e.tagName&&(e.classList.contains("internal")||e.classList.contains("external"))}))){var a=ei(o,i);if(a){var c,s,u=r.getDoms(a.id);u.forEach(function(e){e.classList.add("highlight-wrap-checking")});var l=(c=u.reduce(function(e,t){var n=t.getBoundingClientRect(),r=e.left,o=e.top,i=e.bottom,a=e.right;return(!r||n.left<r)&&(r=n.left),(!o||n.top<o)&&(o=n.top),(!i||n.bottom>i)&&(i=n.bottom),(!a||n.right>a)&&(a=n.right),{left:r,top:o,bottom:i,right:a}},{left:0,top:0,bottom:0,right:0}),s=document.body.scrollTop||document.documentElement.scrollTop,{left:c.left+(c.right-c.left)/2,top:s+c.top});l&&ee(l,a)}}})),eo=(er={highlightList:i,currentSegmentData:k,rangeData:b,mutateHighlightList:(0,f.A)((en=(0,B._)(function(e,t,n,o){var i,a,c,u,l,d;return(0,U.__generator)(this,function(p){switch(p.label){case 0:if(null===(i=window.getSelection())||void 0===i||i.removeAllRanges(),o.deleteIds.forEach(function(e){r.remove(e)}),o.add&&(c=(a=o.add).startMeta,u=a.endMeta,l=a.text,d=a.id,r.fromStore(c,u,l,d)),s(e),R(t),O&&t.commentCount>0&&t.id!==O.id&&D({id:t.id,text:t.text||""}),!n)return[3,2];return[4,(0,H.g)(150)];case 1:p.sent(),L(),p.label=2;case 2:return[2]}})}),function(e,t,n,r){return en.apply(this,arguments)})),showComments:C,openComments:S.on,closeComments:S.off,resetAll:L}).highlightList,ea=er.currentSegmentData,ec=er.rangeData,es=er.mutateHighlightList,eu=er.openComments,el=er.closeComments,ed=er.resetAll,eg=(ev=M()).contentId,eC=ev.contentType,eZ=ev.highlighter,ex=ev.richTextRef,ek=ev.author,eR=ev.questionId,eD=ev.reshipmentSettings,eM=ev.relationship,eB=ev.isAuthor,eU=(0,eb.Z)(),ez=(0,f.A)(function(){if(ec&&ec.startMeta.pid!==ec.endMeta.pid)return(0,eA.t)("暂不支持跨段划线喜欢或评论哦"),!1;var e=(ea.text||"").length;return e<5?((0,eA.t)("选中字数 < 5 个字，请重新选择"),!1):!(e>500)||((0,eA.t)("文本过长，请重新选择"),!1)}),eV=(eq={handleToolbarClick:(0,f.A)(function(e){var t=e.module;if("Copy"===t){var n=(0,eI.iC)(null,{id:eg,type:eC,author:ek,questionId:eR,reshipmentSettings:eD,relationship:eM,isCurrentUser:!!eB},eS());n.message?"string"==typeof n.message?(0,eA.t)(n.message,{theme:"red"}):(0,eA.t)((0,c.tZ)("a",{href:n.message.href,children:n.message.text}),{theme:"red"}):(0,eA.t)("复制成功"),(0,H.g)(150).then(ed);return}if("AIExplain"===t){(0,ew.Y$)({query:ea.text||"",contentId:eg,contentType:eC,zhidaSource:"underlined_word",showContentCard:!0});return}if(ez()){if("Like"===t){if(eB){(0,eA.t)("不能对自己的内容互动",{theme:"red"});return}(function(e,t,n,r,o,i,a,c,s){return eP.apply(this,arguments)})(ex,eZ,eC,eg,eo,ea,ec,eU,es).catch(eL);return}if("Comment"===t){if(eB&&0===ea.commentCount){(0,eA.t)("不能对自己的内容互动",{theme:"red"});return}eu()}}}),handleOnComment:(0,f.A)(function(e){eO({richTextRef:ex,highlightList:eo,currentSegmentData:ea,rangeData:ec,fetchAdd:function(){return Promise.resolve(e.resourceId)},updateSegmentData:function(e,t){return(0,p._)((0,a._)({},e),{id:t,myCommentCount:e.myCommentCount+1,commentCount:e.commentCount+1,isMaster:!0})}},es)}),handleOnDeleteComment:(0,f.A)(function(e,t){eN({highlightList:eo,currentSegmentData:ea,fetchDelete:function(){return Promise.resolve()},updateSegmentData:function(e){var n,r=Math.max(0,(null===(n=t.counts)||void 0===n?void 0:n.totalCounts)||0),o=Math.max(0,e.myCommentCount-1);return(0,p._)((0,a._)({},e),{myCommentCount:o,commentCount:r,isMaster:e.isLike||0!==o})}},es)}),closeComments:el}).handleToolbarClick,eW=eq.handleOnComment,eX=eq.handleOnDeleteComment,eK=eq.closeComments,{highlightList:i,setHighlightList:s,position:_,showPopover:T,rangeData:b,currentSegmentData:k,commentSegment:O,resetAll:L,onSelectionChange:V,onClickHighlight:et,showComments:C,handleToolbarClick:eV,handleOnComment:eW,handleOnDeleteComment:eX,closeComments:eK}),tp=td.highlightList,tf=td.setHighlightList,th=td.position,t_=td.showPopover,tm=td.showComments,tv=td.currentSegmentData,tg=td.commentSegment,tT=td.handleToolbarClick,tE=td.handleOnComment,ty=td.handleOnDeleteComment,tC=td.closeComments,tS=td.resetAll;return eY=(ej={showComments:tm,segmentsFromContent:ta,setHighlightList:tf,onSelectionChange:td.onSelectionChange,onClickHighlight:td.onClickHighlight,onClose:tS}).showComments,eQ=ej.segmentsFromContent,eJ=ej.setHighlightList,e$=ej.onSelectionChange,e0=ej.onClose,e1=ej.onClickHighlight,e3=(e2=M()).highlighter,e4=e2.richTextRef,e5=e2.contentId,e6=(0,w.useRef)(!1),e7=eh(e5),e8=(0,f.A)(function(e){var t,n=window.getSelection();!eY&&n&&(t=n.anchorNode,e4.current&&t&&e4.current.contains(t))&&(e.stopPropagation(),n.isCollapsed||0===n.rangeCount||(e6.current=!0,e$(n)))}),e9=(0,f.A)(function(e){if(e6.current){e6.current=!1;return}if(!eY){var t=eH(e,e4);if((0,q._)(e.target,HTMLElement)&&e.target.classList.contains("highlight-wrap")){var n=e.target.dataset.highlightId;n&&t&&e1({id:n},e3,e)}else e0({onlyPopover:!t})}}),(0,eF.b)(function(){var e,t=new Map;e3.hooks.Render.SelectedNodes.tap(function(e,t){return t.filter(function(e){var t=e.$node;return!X(t,function(e){return(0,q._)(e,HTMLElement)&&(e.classList.contains("RichText-Ecommerce")||e.classList.contains("RichText-MCNLinkCardContainer")||"FIGURE"===e.tagName)})&&""!==t.textContent})}),e3.on("selection:remove",function(e){e.ids.forEach(function(e){var n=t.get(e);n&&(n.disconnect(),t.delete(e))})});var n=[];if(e4.current&&e4.current.querySelectorAll("[data-pid]").forEach(function(e){var t=e.dataset.pid;t&&e.querySelector(".ztext-math")&&n.push(t)}),!e7)try{var r,o=Array.isArray(eQ)?eQ:[],i=(e4.current,r=new Map,o.forEach(function(e){var t=e.pid,o=e.text,i=e.marks;null!=n&&n.includes(t)||i.forEach(function(e){var n=e.masterSegInfo,i=e.segInfo,c=e.startIndex,s=e.endIndex,u=!!n,l=n||i;if(l&&!(c>s)&&!(c>=o.length)){var d=l.isLike,f=l.likeCount,h=l.commentCount,_=l.myCommentCount,m=(0,em.G)((null==n?void 0:n.segIds)||[],(null==i?void 0:i.segIds)||[]).sort().join(","),g="".concat(m,"_").concat(t),T={id:m,likeCount:f,myCommentCount:null!=_?_:0,commentCount:h,isLike:d,isMaster:u,text:o.substring(c,s),startMeta:{pid:t,paragraphOffset:c},endMeta:{pid:t,paragraphOffset:s}},E=r.get(g);E?u&&r.set(g,(0,p._)((0,a._)({},T),{isLike:E.isLike||T.isLike,likeCount:E.likeCount,commentCount:E.commentCount,fullMatch:!0})):r.set(g,T)}})}),eE(Array.from(r.values())));eJ({list:i,disabledPids:n})}catch(e){eJ({list:[],disabledPids:n})}return(e=[["selectionchange",e8,!1],["click",e9,!1]]).forEach(function(e){var t=(0,I._)(e,3),n=t[0],r=t[1],o=t[2];return document.addEventListener(n,r,o)}),function(){e.forEach(function(e){var t=(0,I._)(e,3),n=t[0],r=t[1],o=t[2];return document.removeEventListener(n,r,o)})}}),tt=(te=M()).highlighter,tn=te.richTextRef,tr=(0,w.useRef)(!1),(0,w.useEffect)(function(){tn.current&&(tr.current||(function(e,t,n){n.forEach(function(n){var r={id:n.id,text:n.text,startMeta:ey(t,n.startMeta),endMeta:ey(t,n.endMeta)};r.startMeta&&r.endMeta&&e.fromStore(r.startMeta,r.endMeta,r.text,r.id)})}(tt,tn.current,tp),function(e){var t=new URLSearchParams(window.location.search).get("sentenceId");if(t){var n=e.getDoms(t);0!==n.length&&((0,W.TS)(n[0],150,!0),n.forEach(function(e){e.classList.add("highlight-animation")}))}}(tt),0===tp.length||(tr.current=!0)),function(e,t,n){e.querySelectorAll(".segment-no-style").forEach(function(e){e.classList.remove("segment-no-style")}),e.querySelectorAll(".has-comments").forEach(function(e){e.classList.remove("has-comments")}),e.querySelectorAll("[data-highlight-id]").forEach(function(e){e.classList.remove("mine","other")});var r,o,i=(r=new Set,o=new Map,n.forEach(function(e){var t=e.startMeta.pid,n=o.get(t)||[];n.push(e),o.set(t,n)}),o.forEach(function(e){for(var t=new eG(e.map(function(e){return e.id})),n=0;n<e.length;n++)for(var o=n+1;o<e.length;o++)(function(e,t){var n=e.startMeta.paragraphOffset,r=e.endMeta.paragraphOffset,o=t.startMeta.paragraphOffset,i=t.endMeta.paragraphOffset;return!(r<o||n>i)})(e[n],e[o])&&t.union(e[n].id,e[o].id);t.getGroups(e).forEach(function(e){if(e.some(function(e){return e.commentCount>0})){var t=0===e.length?null:e.reduce(function(e,t){return t.endMeta.paragraphOffset>e.endMeta.paragraphOffset?t:e});t&&r.add(t.id)}})}),r);n.forEach(function(e){var n=t.getDoms(e.id);if(0!==n.length){var r=i.has(e.id);if(n.forEach(function(t){t.innerText&&(e.isMaster?(t.classList.add("mine"),t.classList.remove("other")):(t.classList.add("other"),t.classList.remove("mine")))}),r){var o=n[n.length-1],a=o.dataset.highlightSplitType,c=o.parentElement,s=(null==c?void 0:c.classList.contains("RichContent-EntityWord"))&&"tail"===a;o.classList.add("has-comments"),s&&(null==c||c.classList.add("segment-no-style"))}}})}(tn.current,tt,tp))},[tp,tt,tn]),(0,c.BX)(l.T,{enableHotComment:!1,children:[(0,c.tZ)(P,{show:t_,modules:(to=M().isAuthor,ti=tv.commentCount>0,(0,w.useMemo)(function(){return[tc.copy&&"Copy",tc.like&&!to&&"Like",tc.comment&&(!to||ti)&&"Comment",tc.aiExplain&&"AIExplain"].filter(Boolean)},[tc,ti,to])),text:tv.text||"",segmentData:tv,onItemClick:tT,position:th,arrowPosition:"Bottom",root:document.body,contentToken:tu,contentType:tl}),tg&&(0,c.tZ)(d.Z,{shown:tm,parent:{id:tu,type:tl},segment:tg,commentPattern:"fixed",autoFocus:!0,onClose:tC,onComment:tE,onDeleteComment:ty})]})},eq=n(29229),eV=function(e){var t=(0,I._)((0,w.useState)(null),2),r=t[0],o=t[1],i=(0,eq._)(function(){return n.e(3109).then(n.t.bind(n,3255,23))},!0);return(0,w.useEffect)(function(){if(i&&e.current){var t=new i({$root:e.current,verbose:!0,style:{className:"highlight-wrap"}});return o(t),function(){null==t||t.dispose(),o(null)}}},[i,e]),r},eW=function(e){var t=e.contentId,n=e.contentType,r=e.richTextRef,o=e.isAuthor,i=e.segmentsFromContent,a=e.author,u=e.questionId,l=e.reshipmentSettings,d=e.relationship,p=(0,s.qC)().blockStrategies.isBlockingSegmentLike,f=eV(r);return!f||p?null:(0,c.tZ)(L,{contentId:t,contentType:n,richTextRef:r,highlighter:f,author:a,questionId:u,reshipmentSettings:l,relationship:d,isAuthor:o,children:(0,c.tZ)(ez,{segmentsFromContent:i,permissions:{copy:!0,like:!p,comment:!p,aiExplain:!0}})})},eX=function(e){return"1"!==(0,u.c)("segment_interaction",{mock:"1"})?null:(0,c.tZ)(eW,(0,a._)({},e))}},77880:function(e,t,n){"use strict";n.d(t,{W:function(){return N},Z:function(){return P}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(57477),l=n(71728),d=n(85626),p=n(85879),f=n(83921),h=n(67814),_=n.n(h),m=n(6907),g=n(7656),T=n.n(g),E=n(92769),y=n.n(E),C=n(14168),S=n.n(C),I=n(87363),A=n(77617),b=n.n(A),w=n(98125),Z=n(44118),x=n(7181),k={button:"HrHisPElmD_XxB9LKi6j",plainButton:"h39gnJsHf0NWeCTuygxV",arrow:"RXYxRcvJ7zVIfNZSOcHa",list:"wzIYYDapUzV6NOo6FjeV",option:"A1LO1m96faGxseE9tNf3",popoverTarget:"U4KXos1rwjW8g8If_xHY"},R=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleMouseEnter",function(){e.node.focus()}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.value,r=t.text,o=t.className,i=t.onClick,a=t.children,c=(0,l._)(t,["value","text","className","onClick","children"]);return(0,p.tZ)("button",(0,u._)((0,s._)({ref:function(t){e.node=t},className:_()("Select-option",k.option,o),onClick:i,onMouseEnter:this.handleMouseEnter,tabIndex:-1,role:"option"},c),{children:a||r||n}))}}]),n}(I.Component);(0,a._)(R,"propTypes",{value:S().oneOfType([S().string,S().number,S().bool]).isRequired,text:S().string,onClick:S().func,children:S().node});var N=R,O=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.call(this),(0,a._)((0,r._)(e),"state",{open:!1}),(0,a._)((0,r._)(e),"handleOpen",function(){e.timeout=setTimeout(function(){if(e.list){var t=e.getSelectedIndex(),n=e.isRepositioned?0:t,r=e.list.querySelector(".Select-option:nth-child(".concat(n+1,")"));r&&r.focus()}},100),e.setState({open:!0})}),(0,a._)((0,r._)(e),"handleClose",function(){clearTimeout(e.timeout),e.isRepositioned=!1,e.setState({open:!1})}),(0,a._)((0,r._)(e),"handleItemClick",function(t){var n=e.props,r=n.onChange,o=n.children,i=I.Children.toArray(o)[t];r&&r(i.props.value,t)}),(0,a._)((0,r._)(e),"position",function(t){if(!t)return null;var n=e.props,r=n.plain,o=n.margin,i=n.needsReposition,a=n.topExcludedHeight,c=n.fixFirstItem,s=t.getBoundingClientRect(),u=s.top,l=s.left,d=getComputedStyle(t);e.listRect||(e.listRect=e.list.getBoundingClientRect());var p=e.listRect.width,f=e.list.clientHeight,h=e.list.scrollHeight,_=e.getSelectedIndex(),m=e.list.querySelector(".Select-option:nth-child(".concat((c?0:_)+1,")"));if(!m)return null;var g=m.offsetTop,E=m.offsetHeight,y=T()(Math.round(g-(f-E)/2),0,h-f),C=u+-(g-y+1)+o;i&&C<a&&(C=u-9+o,e.isRepositioned=!0);var S=l;return r&&(S-=20),S=Math.min(window.innerWidth-p,S),e.list.scrollTop=y,{targetContainerStyle:{top:C=Math.max(14,C),left:S=Math.max(14,S),fontSize:d.fontSize}}}),e.id=(0,m.E)("Select"),e.isRepositioned=!1,e}return(0,i._)(n,[{key:"getSelectedIndex",value:function(){var e=this.props,t=e.value,n=e.children,r=I.Children.toArray(n).findIndex(function(e){return e.props.value===t});return -1!==r?r:0}},{key:"renderToggler",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.text,r=t.value,o=this.props,i=o.buttonClassName,c=o.plain,s=o.large,u=o.width,l=o.disabled;return(0,p.BX)(Z.Z,{large:s,preset:c?"plain":null,className:_()("Select-button",k.button,i,(0,a._)({"Select-plainButton":c},k.plainButton,c)),style:{width:u},role:"combobox","aria-expanded":!1,disabled:l,children:[(0,p.tZ)("span",{children:"function"==typeof e?e(n,r):e||n||r}),(0,p.tZ)(f.ZP,{text:!0,className:_()("Select-arrow",k.arrow)})]})}},{key:"render",value:function(){var e=this,t=y()(this.props,["buttonClassName"]),n=t.text,r=t.children,o=t.listClassName,i=t.menuToggler,c=t.width,d=t.useDefaultPosition,f=(0,l._)(t,["text","children","listClassName","menuToggler","width","useDefaultPosition"]),h=I.Children.toArray(r),m=h[this.getSelectedIndex()],g=i||this.renderToggler(n,m&&m.props),T=_()((0,a._)({"Select-list":!0},o,o),k.list);return(0,p.tZ)(x.Z,(0,u._)((0,s._)({toggler:g,fade:!0,delay:0,arrowed:!1,targetClassName:_()("Select-popoverTarget",k.popoverTarget),position:d?null:this.position,onOpen:this.handleOpen,onClose:this.handleClose},f),{children:(0,p.tZ)(w.Z,{selector:".Select-option",children:(0,p.tZ)("div",{className:T,role:"listbox",style:{width:c},ref:function(t){e.list=t},children:h.map(function(t,n){return(0,I.cloneElement)(t,{id:"".concat(e.id,"-").concat(n),onClick:function(r){t.props.onClick&&t.props.onClick(r),e.handleItemClick(n)},key:n})})})})}))}}]),n}(I.Component);(0,a._)(O,"propTypes",{className:S().string,listClassName:S().string,buttonClassName:S().string,plain:S().bool,large:S().bool,width:S().number,value:S().oneOfType([S().string,S().number,S().bool]),text:S().oneOfType([S().node,S().func]),margin:S().number,needsReposition:S().bool,topExcludedHeight:S().number,onChange:S().func,children:S().node,disabled:S().bool,useDefaultPosition:S().bool}),(0,a._)(O,"defaultProps",{plain:!1,large:!1,margin:0,needsReposition:!1,topExcludedHeight:60,disabled:!1,fixFirstItem:!1});var P=b()(O,{value:"onChange"})},82311:function(e,t,n){"use strict";var r=n(85879),o=n(37335);t.Z=function(){return(0,r.BX)("div",{className:"SelfVisibleLable-wrap",children:[(0,r.tZ)(o.P,{className:"SelfVisibleLable-lockIcon",width:16,center:!0}),"仅自己可见"]})}},24794:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(57477),l=n(79065),d=n(85626),p=n(85879),f=n(7629),h=n(17262),_=n(85761),m=n(51512),g=n(78603),T=n(45913),E=n(83931),y=n(67814),C=n.n(y),S=n(56969),I=n(11362),A=n.n(I),b=n(88329),w=n.n(b),Z=n(14168),x=n.n(Z),k=n(87363),R=n(92258),N=n(87641),O=n(55536),P=n(69383),D=n(63638),L=n(4534),M=n(1733),B=n(54422),U=n(8693),G=n(25452),F=n(42367),H=n(75616),z=n(23858),q=n(97727),V=n(80714),W=n(7407),X=n(66263),K=n(67927),j=n(40861);function Y(){var e=(0,l._)(['<a href="','" data-draft-title="','"  data-draft-node="inline"  data-draft-type="text-link">',"</a>"]);return Y=function(){return e},e}function Q(e){return e&&e.startsWith("//")?"".concat(V.Z.protocol).concat(e):e}var J={copied:"链接复制成功！"},$=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"togglerRef",(0,k.createRef)()),(0,a._)((0,r._)(e),"state",{showSearchFriendsModal:!1,toastKey:0}),(0,a._)((0,r._)(e),"shouldShowMenu",function(){var t=e.props,n=t.onTogglerClick,r=t.disabled;return!1!==n()&&!r}),(0,a._)((0,r._)(e),"handleTogglerClick",function(t){if(!e.shouldShowMenu()){t.preventDefault();return}e.handleShare(t)}),(0,a._)((0,r._)(e),"handleMouseEnter",function(t){if(!e.shouldShowMenu()){t.preventDefault();return}e.handleShare(t)}),(0,a._)((0,r._)(e),"open",function(t){e.shouldShowMenu()&&(e.loadQrcodeImage(),e.menu.popover.open(),e.handleShare(t))}),(0,a._)((0,r._)(e),"handleShare",function(){var t=e.props,n=t.id,r=t.type,o=t.getShareText,i=t.zaShareId,a=t.onShare;["live","edu_course","edu_section"].includes(r)||o(n,r),P.Z.trackEvent(e.togglerRef.current,(0,s._)({action:"Share",element:"Button",is_intent:!0,element_name:X.ur[r]},i&&{id:i})),null==a||a()}),(0,a._)((0,r._)(e),"copyLink",function(){var t=e.props,n=t.type,r=t.title,o=t.authorName,i=t.href,a=t.showNotification,c=t.useFancyToast,s=L.iB[n]||"",u=o&&"匿名用户"!==o&&s?"".concat(o,"的").concat(s," - "):"",l=i?(0,B.BY)(i):e.url();A()("".concat(r?"".concat(r," - "):"").concat(u,"知乎\n").concat(Q(l)),{format:"text/plain"}),c?e.setState(function(e){return{toastKey:e.toastKey+1}}):a(J.copied)}),(0,a._)((0,r._)(e),"url",function(){var t=e.props,n=t.id,r=t.type,o=t.shouldUseHrefFirst,i=t.href;return o?(0,B.BY)(i):Q((0,B.BY)(e.props.url))||"".concat(location.origin,"/").concat(r,"/").concat(n)}),(0,a._)((0,r._)(e),"getQrCodeUrl",function(){var t=e.props,n=t.shouldUseHrefFirst,r=t.href,o=n?r:"".concat(e.url(),"#showWechatShareTip");return"".concat(V.Z.protocol,"//").concat(V.Z.wwwHost,"/qrcode?url=").concat(encodeURIComponent(o),"&margin=0")}),(0,a._)((0,r._)(e),"loadQrcodeImage",function(){"undefined"!=typeof location&&(new Image().src=e.getQrCodeUrl())}),(0,a._)((0,r._)(e),"shareToWeibo",function(){var t={appKey:"3063806388"},n=e.props.shareText;n&&(t.title=n);var r="http://service.weibo.com/share/share.php?".concat(Object.keys(t).map(function(e){return"".concat(e,"=").concat(encodeURIComponent(t[e]))}).join("&"));window.open(r,"_blank","width=615,height=505")||(location.href=r)}),(0,a._)((0,r._)(e),"shareToPin",function(){var t=e.url(),n=e.props,r=n.id,o=n.type;(0,H.pZ)({enableLocalDraft:!1,draft:[{type:"link_card_draft",url:t}],forwardFromContentId:r,forwardFromContentType:o})}),(0,a._)((0,r._)(e),"shareAIToPin",function(){var t=e.url(),n=e.props,r=n.id,o=n.type,i=n.title;(0,H.pZ)({enableLocalDraft:!1,draft:[{type:"text",content:(0,S.tx)(Y(),t,i,i)}],source:"ai_to_pin",extraInfo:{contentId:r,contentUrl:t,contentType:o,contentTitle:i}})}),(0,a._)((0,r._)(e),"shareToMessage",function(){e.menu.popover.close(),e.setState({showSearchFriendsModal:!0})}),(0,a._)((0,r._)(e),"handleCloseSearchFriendsModal",function(){e.setState({showSearchFriendsModal:!1})}),e}return(0,i._)(n,[{key:"componentDidUpdate",value:function(e){this.props.positionStatus!==e.positionStatus&&this.menu.popover.close()}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.togglerClassName,o=t.positionStatus,i=t.toggler,a=t.type,c=t.disabled,l=t.placement,d=t.toggleEvent,E=t.stickHover,y=t.children,S=t.id,I=t.title,A=t.enableAiToPin,b=t.renderAIToPin,w=t.useFancyToast,Z=A&&b,x=this.state,R=x.showSearchFriendsModal,O=x.toastKey,P=(0,p.tZ)("div",{className:C()("ShareMenu-toggler",r),children:(0,k.cloneElement)(i,{onMouseEnter:this.loadQrcodeImage,disabled:c,ref:this.togglerRef})}),L="hover"===d?{onMouseEnter:this.handleMouseEnter}:{onClick:this.handleTogglerClick};return(0,p.BX)(p.HY,{children:[(0,p.tZ)(q.bY,{input:"s",action:this.open}),(0,p.tZ)(D.ZAClick,(0,u._)((0,s._)({as:M.ZP,zaText:!0,zaType:"Button",zaAction:"Share",zaModuleId:"more_panel_share",className:C()("ShareMenu",n),positionStatus:o,ref:function(t){e.menu=t},toggler:P,placement:l,toggleEvent:d,stickHover:E},L),{children:(0,p.BX)("div",{className:"ShareMenu-content",children:[(0,p.BX)("div",{className:C()("ShareMenu-menuItems",Z&&"ShareMenu-menuItems-aiToPin"),children:[(0,p.BX)(D.ZAClick,{as:M.sN,zaType:"Button",zaAction:"Share",zaModuleIndex:0,zaText:!0,className:"ShareMenu-button",onClick:this.copyLink,children:[(0,p.tZ)(f.ZP,{size:16}),"复制链接"]}),(0,p.BX)(D.ZAClick,{as:M.sN,zaType:"Button",zaAction:"Share",zaModuleIndex:1,zaModuleId:"share_channel_button",zaText:!0,className:"ShareMenu-button",onClick:this.shareToPin,children:[(0,p.tZ)(h.ZP,{size:16}),"转发到想法"]}),Z&&(0,p.BX)(D.ZAClick,{as:M.sN,zaType:"Button",zaAction:"Share",zaModuleIndex:3,zaText:!0,zaModuleId:"share_channel_button",className:"ShareMenu-button",shouldTrackShow:!0,onClick:this.shareAIToPin,children:[(0,p.tZ)(_.Z,{size:16}),"智能发布到想法"]}),(0,p.BX)(D.ZAClick,{as:M.sN,zaType:"Button",zaAction:"Share",zaModuleIndex:2,zaText:!0,zaModuleId:"share_channel_button",className:"ShareMenu-button",onClick:this.shareToMessage,children:[(0,p.tZ)(m.Z,{size:16}),"私信分享"]}),["question","answer","article"].includes(a)&&(0,p.BX)(D.ZAClick,{as:M.sN,zaType:"Button",zaAction:"Share",zaText:!0,className:"ShareMenu-button",onClick:this.shareToWeibo,children:[(0,p.tZ)(g.ZP,{size:16}),"新浪微博"]}),y]}),(0,p.tZ)("div",{className:"ShareMenu-divider"}),(0,p.BX)("div",{className:"ShareMenu-qrcodeSection",children:[(0,p.tZ)(N.xv,{color:"MapText04A",fontSize:"12px",fontWeight:"medium",lineHeight:"18px",children:"扫码分享"}),(0,p.BX)("div",{className:"ShareMenu-qrcodeBox",children:[(0,p.tZ)("img",{src:"undefined"!=typeof location?this.getQrCodeUrl():"",alt:"二维码",width:80,height:80}),(0,p.BX)("div",{className:"ShareMenu-qrcodeText",children:[(0,p.tZ)(T.ZP,{size:12}),(0,p.tZ)(N.xv,{color:"MapText06A",fontSize:"10px",lineHeight:"14px",children:"微信扫码查看"})]})]})]})]})})),R&&(0,p.tZ)(z.Z,{visible:R,onClose:this.handleCloseSearchFriendsModal,contentType:a,contentId:S,contentTitle:I,contentUrl:this.url()}),w&&O>0&&(0,p.tZ)(F.lY,{duration:3e3,fixed:!0,targetPath:"parent",onClose:function(){return e.setState({toastKey:0})},children:J.copied},O)]})}}]),n}(k.Component);(0,a._)($,"propTypes",{toggler:x().node,onTogglerClick:x().func,zaShareId:x().number}),(0,a._)($,"defaultProps",{toggler:(0,p.tZ)(G.ZP,{preset:"plain",icon:E.ZP,label:"分享"}),onTogglerClick:w()}),t.Z=V.Z.isMobileEntry?function(){return null}:(0,O.compose)(U.Uk,(0,R.connect)(function(e,t){var n=t.id,r=t.type,o=t.interactMode,i=e.shareTexts,a=(0,W.tQ)(e,{paramId:"nm_pc_ai_pin"});return{useFancyToast:"ordered"===o,shareText:(null==i?void 0:i["".concat(r).concat(n)])||t.shareText,enableAiToPin:"1"===a}},{showNotification:K.c0,getShareText:j.kB}))($)},4416:function(e,t,n){"use strict";n.d(t,{n:function(){return s},y:function(){return u}});var r=n(87363),o=n(51070),i=n.n(o),a=n(65733),c=n(4817),s=function(e,t){var n=(0,c.Z)(),o=(0,a.A)(t);(0,r.useEffect)(function(){if(n){var t=new(i());return t.bind(e,o),function(){t.reset()}}},[o,n,e])},u=function(e){return s(e.input,e.action),null}},97727:function(e,t,n){"use strict";n.d(t,{yW:function(){return r.y},bY:function(){return _},wi:function(){return m}});var r=n(4416),o=n(85879);n(67814);var i=n(87363),a=n.n(i),c=n(94009),s=n(49899),u=n(51070),l=n.n(u),d=n(65733),p=n(4817),f=a().createContext(null),h=function(e,t){var n=(0,p.Z)(),r=(0,i.useContext)(f),o=(0,d.A)(t);(0,i.useEffect)(function(){if(n&&r)return r.bind(e,o),function(){r.unbind(e)}},[n,r,e,o])},_=function(e){var t=e.input,n=e.action;return h(t,function(e){for(var t,r=arguments.length,o=Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];t=e.target,/^(input|textarea|select)$/i.test(t.tagName)||t.isContentEditable||n.apply(void 0,[e].concat((0,s._)(o)))}),null},m=function(e){var t=e.children,n=e.root,r=(0,c._)((0,i.useState)(null),2),a=r[0],s=r[1];return(0,i.useEffect)(function(){if(n){var e=new(l())(n);return s(e),function(){e.reset()}}},[n]),(0,o.tZ)(f.Provider,{value:a,children:t})}},4817:function(e,t,n){"use strict";var r=n(92258);t.Z=function(){return(0,r.useSelector)(function(e){return e.env.enableShortcut})}},49906:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),u=n(85879),l=n(82452),d=n(14168),p=n.n(d),f=n(87363),h=n(31011),_=n(99447),m=n(31467),g=n(17132),T=n.n(g),E=n(16850),y={zhihu:"注册或登录",wechat:"使用微信快速登录",weibo:"使用微博快速登录",qq:"使用 QQ 快速登录"},C={qq:"qqconn",weibo:"sina",wechat:"wechat_mp"},S=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"jumpToOAuthUrl",function(t){var n=e.props.redirectUrl,r=void 0===n?location.href:n,o=(0,l.tL)(r),i=o.utm_source,a=o.utm_medium,c=T()(navigator.userAgent).isZhihu;if("zhihu"===t){location.href=c?"zhihu://signin?next=".concat(r):"https://www.zhihu.com/signin?next=".concat(encodeURIComponent(r)).concat(i?"?utm_source=".concat(i):"");return}location.href="https://www.zhihu.com/oauth/redirect/login/".concat(C[t],"?next=/oauth/account_callback&from=").concat(encodeURIComponent(r),"&utm_source=").concat(i,"&ref_source=").concat(a)}),(0,a._)((0,r._)(e),"renderSignButtons",function(){var t=e.props.buttons;return"string"==typeof t?e.renderSingleSignButton({name:t}):t.map(function(t){return"string"==typeof t?e.renderSingleSignButton({name:t}):"object"==typeof t?e.renderSingleSignButton(t):null})}),(0,a._)((0,r._)(e),"renderSingleSignButton",function(t){var n=t.name,r=t.text,o=t.fill,i=t.color,a="#fff"===o||"#ffffff"===o;return Object.keys(y).includes(n)?(0,u.tZ)("button",{className:"SignInModal-button-".concat(n),style:{backgroundColor:o,borderColor:a?"#0f88eb":o,color:a?"#0f88eb":i},onClick:function(){e.jumpToOAuthUrl(n)},children:r||y[n]},n):null}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.urlScheme,r=e.isMobile,o=this.props.title||"".concat(n?"打开 App 或":"","登录后继续操作"),i=r?h.Z:m.Z;return(0,u.tZ)(i,{size:"small",className:"SignInModal",title:o,onClose:t,children:(0,u.tZ)(_.r,{module:"SignForm",moduleName:o,trackCardShow:!0,children:(0,u.BX)("div",{className:"SignInModal-content",children:[n&&(0,u.tZ)(l.yv,{className:"SignInModal-openInAppButton",href:n,children:"立即打开 App"}),this.renderSignButtons()]})})})}}]),n}(f.Component);(0,a._)(S,"propTypes",{onClose:p().func.isRequired,urlScheme:p().string,redirectUrl:p().string,buttons:p().oneOfType([p().array,p().string])}),(0,a._)(S,"defaultProps",{buttons:["zhihu"]}),t.Z=(0,E.$)()(S)},57665:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(85879),o=n(14168),i=n.n(o),a=n(67814),c=n.n(a),s=Array.from(Array(12),function(e,t){return(0,r.tZ)("span",{className:"Spinner-blade-12"},t)});function u(e){var t=e.className,n=e.white,o=e.large;return(0,r.tZ)("div",{className:c()("Spinner-blade",t,{"Spinner-blade--large":o,"Spinner-blade--white":n}),children:s})}u.propTypes={className:i().string,large:i().bool,white:i().bool};var l=u},33523:function(e,t,n){"use strict";var r=n(85879),o=n(87363),i=n(90236),a=(0,o.forwardRef)(function(e,t){var n=e.mainSections,o=e.setButtonRectInfo,a=e.onCommand,c=e.queryCommandState,s=e.queryCommandEnable,u=e.editorState;return(0,r.tZ)("div",{className:"AiAssistantArea",ref:t,css:{display:"flex",flexShrink:1},children:n.map(function(e,t,n){return e&&n?e.items.length>0&&(0,r.tZ)(i.Z,{sectionIndex:t,onButtonRectInfoGet:o,items:e.items,onCommand:a,queryCommandState:c,queryCommandEnable:s,editorState:u,showDivider:!1,showRightSpace:!1},e.sectionName):null})})});t.Z=a},63459:function(e,t,n){"use strict";n.d(t,{_:function(){return h}});var r=n(55164),o=n(57477),i=n(71728),a=n(94009),c=n(85879),s=n(15021),u=n(7835),l=n(69755),d=n(87641),p=n(99281),f=n(85826),h=function(e){var t=e.text,n=e.children,h=e.focusScope,_=(0,i._)(e,["text","children","focusScope"]),m=(0,a._)((0,p.j1)(f.Q),2),g=m[0],T=m[1],E=(0,l.M)().scrollY;return(0,u.b)(function(){return E.onChange(function(){T(function(e){return e+1})})}),(0,c.BX)(s.Z,(0,o._)((0,r._)({repositionKey:g,focusScope:void 0!==h&&h},_),{css:function(e){return{padding:10,backgroundColor:e.colors.MapBrand}},children:[t&&(0,c.tZ)(d.xu,{color:"MapText99B",fontWeight:"bold",fontSize:"15px",children:t}),n]}))}},14982:function(e,t,n){"use strict";var r=n(85879),o=n(87363),i=n(90236),a=(0,o.forwardRef)(function(e,t){var n=e.fixSections,o=e.onCommand,a=e.queryCommandState,c=e.queryCommandEnable,s=e.editorState;return(0,r.tZ)("div",{className:"fixArea",ref:t,css:{display:"flex"},children:n.map(function(e){return e.items.length>0&&(0,r.tZ)(i.Z,{items:e.items,onCommand:o,queryCommandState:a,queryCommandEnable:c,editorState:s,showDivider:!1,showRightSpace:!1},e.sectionName)})})});t.Z=a},9710:function(e,t,n){"use strict";var r=n(85879),o=n(87363),i=n(90236),a=(0,o.forwardRef)(function(e,t){var n=e.mainSections,o=e.setButtonRectInfo,a=e.onCommand,c=e.queryCommandState,s=e.queryCommandEnable,u=e.editorState;return(0,r.tZ)("div",{className:"mainArea",ref:t,css:{display:"flex",flexShrink:1},children:n.map(function(e,t,n){return e&&n?e.items.length>0&&(0,r.tZ)(i.Z,{sectionIndex:t,onButtonRectInfoGet:o,items:e.items,onCommand:a,queryCommandState:c,queryCommandEnable:s,editorState:u,showDivider:!0,showRightSpace:!0},e.sectionName):null})})});t.Z=a},54713:function(e,t,n){"use strict";var r=n(85879),o=n(87363),i=n(90236),a=(0,o.forwardRef)(function(e,t){var n=e.moreSections,o=e.onCommand,a=e.queryCommandState,c=e.queryCommandEnable,s=e.editorState,u=e.showDivider;return(0,r.tZ)("div",{className:"moreArea",ref:t,css:{display:"flex"},children:n.map(function(e){return e?e.items.length>0&&(0,r.tZ)(i.Z,{items:e.items,onCommand:o,queryCommandState:a,queryCommandEnable:c,editorState:s,showDivider:u,showRightSpace:u,replaceIconByOnlyChild:!1,shouldHide:function(e){return e.every(function(e){var t;return(null==e?void 0:null===(t=e.children)||void 0===t?void 0:t.length)===0})}},e.sectionName):null})})});t.Z=a},90236:function(e,t,n){"use strict";n.d(t,{Z:function(){return k}});var r=n(55164),o=n(57477),i=n(85879),a=n(14168),c=n.n(a);function s(){return(0,i.tZ)("span",{className:"ToolbarDivider",css:function(e){return{height:"20px",borderRight:"1px solid",borderColor:e.colors.GBK09A,marginLeft:"-4px"}}})}var u=n(13649),l=n(17103),d=n(32894),p=n(67814),f=n.n(p),h=n(87363),_=n(63638),m=n(25452),g=n(63459),T=n(69297),E={hover:function(e){return{background:e.colors.GBK10A,borderRadius:"4px"}},isCommandActive:function(e){return{svg:{path:{fill:e.colors.GBL01A}},".togglerIcon":{borderLeftColor:e.colors.GBL01A},color:e.colors.GBL01A}}},y=(0,h.forwardRef)(function(e,t){var n=e.showTogglerIcon,a=e.isMenuOpen,c=e.icon,s=e.isActive,p=e.disabled,y=e.onClick,C=e.className,S=e.text,I=e.label,A=e.sectionIndex,b=e.buttonIndex,w=e.onButtonRectInfoGet,Z=e.featureBubbleText,x=e.shortcut,k=(0,u.n)(),R=(0,h.useRef)(null);(0,h.useEffect)(function(){var e,t=(null===(e=R.current)||void 0===e?void 0:e.getBoundingClientRect()).right;t&&(null==w||w({label:I,sectionIndex:A,buttonIndex:b,right:t}))},[A,b]);var N=n&&(0,i.tZ)("div",{className:"togglerIcon",css:{transform:"".concat(a?"rotate(180deg)":"rotate(0deg)"),fontSize:0,marginBottom:"2px"},children:(0,i.tZ)(d.r,{})});return(0,i.BX)(_.ZAClick,{as:m.ZP,zaType:"Button",zaText:I,ref:(0,l.q)(t,R),preset:m.EE.Plain,className:f()("ToolbarButton",C),disabled:p,css:function(e){return{"&.Button.Button--plain":(0,o._)((0,r._)({marginRight:"20px",padding:"2px 4px",paddingRight:n?"1px":"4px",fontSize:"11px",color:e.colors.GBK03A,textAlign:"center",alignItems:"flex-end",display:"flex",whiteSpace:"nowrap"},s&&E.isCommandActive(e)),{"&:hover":E.hover(e)})}},"aria-label":I,"data-tooltip":(0,T.t)(x,k),"data-tooltip-position":"bottom","data-tooltip-classname":"u-pointerEventsNone",onClick:y,children:[(0,i.BX)("div",{css:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,i.tZ)(c,{center:!0}),(0,i.tZ)("span",{css:{width:"100%"},children:null!=S?S:I})]}),N,Z&&(0,i.tZ)(g._,{isOpen:!0,target:R.current,text:Z})]})});y.propTypes={icon:c().elementType.isRequired,label:c().string.isRequired,isActive:c().bool,disabled:c().bool,showTogglerIcon:c().bool,isMenuOpen:c().bool,className:c().string,text:c().string,shortcut:c().string,onClick:c().func,sectionIndex:c().number,buttonIndex:c().number,onButtonRectInfoGet:c().func},y.defaultProps={isActive:!1,disabled:!1,isMenuOpen:!1,showTogglerIcon:!1,onClick:function(){}};var C=n(94009),S=n(1733),I=n(4526),A=n(82677);function b(e,t,n){return!!n&&((null==e?void 0:e.children)?e.children.find(function(e){return b(e,t,n)}):e.commandName?t(e.commandName,n)&&e:void 0)}function w(e,t,n){return!!n&&((null==e?void 0:e.children)?e.children.some(function(e){return w(e,t,n)}):t(e.commandName,n))}function Z(e){var t=e.items,n=e.onCommand,r=e.queryCommandState,o=e.queryCommandEnable,a=e.editorState;return t.map(function(e){if(!0===e.hide)return null;var t,c,s,u=b(e,r,a),l=!w(e,o,a);return(null==e?void 0:null===(t=e.children)||void 0===t?void 0:t.length)?(0,i.tZ)(S.ZP,{toggleEvent:"hover",placement:I.RIGHT,enterDelay:300,leaveDelay:300,toggler:(0,i.tZ)(A.Z,{icon:null!==(c=null==u?void 0:u.icon)&&void 0!==c?c:e.icon,onClick:function(t){var r;null===(r=e.onClick)||void 0===r||r.call(e,t),e.commandName&&n(e.commandName)},label:e.label,shortcut:e.shortcut,desc:e.desc,isActive:!!u,disabled:l}),className:"ToolbarV3SubmenuButton",children:(0,i.tZ)(Z,{items:e.children,onCommand:n,queryCommandState:r,queryCommandEnable:o,editorState:a})},e.label):(0,i.tZ)(A.Z,{zaModuleId:e.zaModuleId,zaBlock:e.zaBlock,icon:null!==(s=null==u?void 0:u.icon)&&void 0!==s?s:e.icon,onClick:function(t){var r;null===(r=e.onClick)||void 0===r||r.call(e,t),e.commandName&&n(e.commandName),e.hideMenuOnClick&&document.body.click()},desc:e.desc,label:e.label,shortcut:e.shortcut,isActive:!!u,disabled:l,component:e.Component},e.label)})}function x(e){var t=e.subMenu,n=e.onCommand,r=e.queryCommandState,o=e.queryCommandEnable,a=e.editorState,c=e.isActive,s=e.label,u=e.shortcut,l=e.disabled,d=e.onClick,p=e.icon,f=e.sectionIndex,m=e.buttonIndex,g=e.onButtonRectInfoGet,T=(0,C._)((0,h.useState)(!1),2),E=T[0],I=T[1],A=(0,_.useTracker)().trackShow,b=function(){E||"导入"!==s||A({elementLocation:{type:"Block",block:{blockText:"EditorInsertAction_Editor"},moduleId:"editor_insert_action"}}),I(!0)},w=(0,i.tZ)(y,{isMenuToggler:!0,isMenuOpen:E,showTogglerIcon:!0,icon:p,isActive:c,disabled:l,shortcut:u,onClick:d,label:s,sectionIndex:f,buttonIndex:m,onButtonRectInfoGet:g});return(0,i.tZ)(S.ZP,{toggler:w,onOpen:function(){return b()},onClose:function(){return I(!1)},arrowed:!1,menuContainerClassName:"ToolbarV3Menu-container",preventCloseOnTarget:!0,children:(0,i.tZ)(Z,{items:t,onCommand:n,queryCommandState:r,queryCommandEnable:o,editorState:a})})}function k(e){var t=e.items,n=e.onCommand,a=e.queryCommandState,c=e.queryCommandEnable,u=e.editorState,l=e.showDivider,d=e.showRightSpace,p=e.replaceIconByOnlyChild,f=void 0===p||p,h=e.shouldHide,_=e.sectionIndex,m=e.onButtonRectInfoGet;return(null==h?void 0:h(t))?null:(0,i.BX)("div",{className:"toolbar-section",css:(0,r._)({display:"flex",alignItems:"center"},d&&{marginRight:"16px"}),children:[t.filter(function(e){return!!e}).map(function(e,t){var s,l=e.Component,d=e.label,p=e.text,h=e.children,g=e.shortcut,T=e.commandName,E=e.onClick,C=e.hide,S=e.featureBubbleText;if(!0===C)return null;var I=b(e,a,u),A=!w(e,c,u),Z=e.icon,k={label:d,icon:Z,disabled:A,shortcut:g,isActive:!!I,text:p,sectionIndex:_,buttonIndex:t,onButtonRectInfoGet:m,featureBubbleText:S,onClick:function(e){null==E||E(e),T&&n(T)}};if((null==h?void 0:h.length)>1||!f&&(null==h?void 0:h.length)>0)Z=(null==I?void 0:I.icon)||Z,s=x,k=(0,o._)((0,r._)({},k),{icon:Z,onCommand:n,queryCommandState:a,queryCommandEnable:c,editorState:u,subMenu:h});else if((null==h?void 0:h.length)===1&&f){s=y;var R=h[0],N=R.icon,O=R.label,P=R.text,D=R.shortcut,L=R.commandName;k=(0,o._)((0,r._)({},k),{icon:N,label:O,text:P,shortcut:D,onClick:function(e){null==E||E(e),L&&n(L)}})}else s=y;return l?(0,i.tZ)(l,(0,r._)({toolbarButton:s},k),e.label):(0,i.tZ)(s,(0,r._)({},k),e.label)}),l&&(0,i.tZ)(s,{})]})}Z.propTypes={items:c().arrayOf(c().oneOfType([c().object,c().bool])).isRequired,onCommand:c().func.isRequired,queryCommandState:c().func.isRequired,queryCommandEnable:c().func.isRequired,editorState:c().object.isRequired},x.propTypes={icon:c().elementType.isRequired,subMenu:c().arrayOf(c().oneOfType([c().object,c().bool])).isRequired,label:c().string.isRequired,onCommand:c().func.isRequired,queryCommandEnable:c().func.isRequired,queryCommandState:c().func.isRequired,editorState:c().object.isRequired,shortcut:c().string,disabled:c().bool,isActive:c().bool,onClick:c().func,sectionIndex:c().number,buttonIndex:c().number,onButtonRectInfoGet:c().func},x.defaultTypes={disabled:!1,isActive:!1,onClick:function(){}},k.propTypes={items:c().arrayOf(c().oneOfType([c().object,c().bool])).isRequired,onCommand:c().func.isRequired,queryCommandState:c().func.isRequired,queryCommandEnable:c().func.isRequired,shouldHide:c().func,editorState:c().object.isRequired,showDivider:c().bool.isRequired,showRightSpace:c().bool.isRequired,isMoreSection:c().bool,sectionIndex:c().number,replaceIconByOnlyChild:c().bool,onButtonRectInfoGet:c().func}},82677:function(e,t,n){"use strict";var r=n(55164),o=n(85879),i=n(13649),a=n(14168),c=n.n(a),s=n(87363),u=n(63638),l=n(25452),d=n(69297),p={hover:function(e){return{background:e.colors.GBK10A,".togglerIcon":{borderLeftColor:e.colors.GBL01A}}},isCommandActive:function(e){return{svg:{path:{fill:e.colors.GBL01A}},".togglerIcon":{borderLeftColor:e.colors.GBL01A},color:e.colors.GBL01A}}},f=(0,s.forwardRef)(function(e,t){var n=e.isActive,a=e.disabled,c=e.onClick,s=e.icon,f=e.text,h=e.label,_=e.desc,m=e.onMouseEnter,g=e.onMouseLeave,T=e.component,E=e.shortcut,y=e.zaModuleId,C=e.zaBlock,S=(0,i.n)();return T?(0,o.tZ)(T,(0,r._)({},e)):(0,o.BX)(u.ZAClick,{as:l.ZP,zaType:"Button",zaText:h,zaBlock:C,zaModuleId:y,preset:l.EE.Plain,"aria-label":h,disabled:a,css:function(e){return{"&.Button.Button--plain":(0,r._)({padding:"12px 16px",display:"flex",alignItems:"center",color:e.colors.GBK03A,width:"100%",boxSizing:"border-box",whiteSpace:"nowrap",borderRadius:"4px","&:hover":p.hover(e),"&:active":p.isCommandActive(e)},n&&p.isCommandActive(e))}},onClick:c,onMouseEnter:m,onMouseLeave:g,ref:t,"data-tooltip":(0,d.t)(E,S),"data-tooltip-position":"bottom","data-tooltip-classname":"u-pointerEventsNone",children:[(0,o.tZ)(s,{center:!0,css:{marginRight:"4px"}}),null!=f?f:h,_&&(0,o.tZ)("span",{css:{fontSize:"12px",fontWeight:"500",color:"var(--GBK05A)",backgroundColor:"var(--GBK10A)",padding:"4px",borderRadius:"4px",marginLeft:"10px"},children:_})]})});f.propTypes={icon:c().elementType.isRequired,label:c().string.isRequired,isActive:c().bool,disabled:c().bool,className:c().string,text:c().string,shortcut:c().string,onClick:c().func,onMouseEnter:c().func,onMouseLeave:c().func},t.Z=f},34982:function(e,t,n){"use strict";n.d(t,{Z:function(){return _}});var r=n(94009),o=n(85879),i=n(95951),a=n(67814),c=n.n(a),s=n(87363),u=n(63638),l=n(49899),d=n(65334),p=function(e){var t=!1;return function(){for(var n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];t||(t=!0,e.apply(void 0,(0,l._)(r)),requestAnimationFrame(function(){t=!1}))}},f=function(e){var t,n=(0,d.I)(e),r=(0,s.useRef)();return r.current=(0,s.useMemo)(function(){return p(function(){for(var e=arguments.length,r=Array(e),o=0;o<e;o++)r[o]=arguments[o];return(t=n).current.apply(t,(0,l._)(r))})},[n]),r.current},h=n(85826),_=(0,s.forwardRef)(function(e,t){var n=e.children,a=e.className,l=(0,h.$)(),d=(0,r._)((0,i.h)(),2),p=d[0],_=d[1];return(0,s.useEffect)(function(){l(function(e){return e+1})},[_,l]),(0,o.tZ)(u.ZAEnv,{block:"EditorToolbar",children:(0,o.tZ)("div",{ref:t,css:{width:"100%",display:"flex",justifyContent:"center"},children:(0,o.tZ)("div",{className:c()("toolbarV3",a),ref:p,css:{display:"flex",overflowX:"auto",padding:"10px 0 10px 20px",boxShadow:"0px -0.5px 0px 0px rgba(235, 235, 235, 1) inset"},onMouseDown:function(e){return e.preventDefault()},onScroll:f(function(){return l(function(e){return e+1})}),children:n})})})})},69297:function(e,t,n){"use strict";n.d(t,{t:function(){return r}});var r=function(e,t){return e&&!t.isAppleDevice?e.replace("⌘","Ctrl").replace("⌥","Alt").replace("⇧","Shift"):e}},18341:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});var r=n(85879),o=n(19064),i=n(33523),a=n(14982),c=n(9710),s=n(54713),u=n(34982),l=n(94009),d=n(95951),p=n(65733),f=n(7835),h=n(86105),_=n(87363);function m(e){var t,n,m,g,T,E,y,C,S,I,A,b,w,Z,x,k,R,N,O,P,D,L,M=e.onCommand,B=e.queryCommandState,U=e.queryCommandEnable,G=e.editorState,F=e.toolbarMainAreaData,H=e.toolbarMoreAreaData,z=e.toolbarFixtureAreaData,q=e.toolbarAiAssistantData,V=e.className,W=(n=(t={toolbarMainAreaData:F,toolbarMoreAreaData:H,toolbarAiAssistantData:q}).toolbarMainAreaData,m=t.toolbarMoreAreaData,g=t.toolbarAiAssistantData,E=(T=(0,l._)((0,_.useState)(function(){return[(0,h.fromJS)(n),(0,h.fromJS)(m),(0,h.fromJS)(g||[])]}),2))[0],y=T[1],S=(C=(0,l._)((0,_.useState)(!1),2))[0],I=C[1],b=(A=(0,l._)((0,d.h)(),2))[0],w=A[1],Z=(0,_.useRef)(null),x=(0,_.useRef)(null),k=(0,_.useRef)(null),R=(0,_.useRef)(null),N=(0,_.useRef)(0),O=(0,p.A)(function(e){e&&(Z.current=e,N.current=e.offsetLeft)}),P=(0,_.useRef)([]),D=(0,p.A)(function(e){var t=e.label,n=e.sectionIndex,r=e.buttonIndex,o=e.right;P.current.push({label:t,right:o,sectionIndex:n,buttonIndex:r}),P.current=P.current.sort(function(e,t){var n=e.sectionIndex,r=e.buttonIndex,o=t.sectionIndex,i=t.buttonIndex;return n>o?-1:n<o?1:r>i?-1:r<i?1:0})}),L=(0,p.A)(function(){var e=null==w?void 0:w.width,t=null==Z?void 0:null===(o=Z.current)||void 0===o?void 0:o.getBoundingClientRect().width,n=(null==x?void 0:null===(i=x.current)||void 0===i?void 0:i.getBoundingClientRect().width)||0,r=null==k?void 0:null===(a=k.current)||void 0===a?void 0:a.getBoundingClientRect().width;if(e&&t&&void 0!==n&&r){var o,i,a,c,s=e-n-r,u=null===(c=P.current)||void 0===c?void 0:c.find(function(e){return s>e.right-N.current});if(u){var d=u.sectionIndex,p=u.buttonIndex,f=d,h=p;d<3&&(f=3),(d<3||p<1)&&(h=1);var _=(0,l._)(E,3),m=_[0],g=_[1],T=_[2],C=m.getIn([f,"items"]),S=g.getIn([0,"items",0,"children"]),A=C.concat(S),b=A.slice(0,h+1),R=A.slice(h+1);y([m.setIn([f,"items"],b),g.setIn([0,"items",0,"children"],R),T])}}I(!1)}),(0,_.useEffect)(function(){y([(0,h.fromJS)(n),(0,h.fromJS)(m),(0,h.fromJS)(g||[])]),I(!0)},[n]),(0,_.useEffect)(function(){S&&L()},[S]),(0,_.useEffect)(function(){I(!0)},[w]),(0,f.b)(function(){I(!0)}),{mainSections:E[0].toJS(),moreSections:E[1].toJS(),aiAssistantSections:E[2].toJS(),setToolbarRef:b,setMainAreaRef:O,moreAreaRef:x,fixAreaRef:k,setButtonRectInfo:D,aiAssistantAreaRef:R}),X=W.mainSections,K=W.moreSections,j=W.setToolbarRef,Y=W.setMainAreaRef,Q=W.moreAreaRef,J=W.aiAssistantAreaRef,$=W.fixAreaRef,ee=W.setButtonRectInfo,et=(0,o.p3)().isAIAssistantEnabled;return(0,r.BX)(u.Z,{ref:j,className:V,children:[(0,r.tZ)(c.Z,{ref:Y,mainSections:X,setButtonRectInfo:ee,onCommand:M,queryCommandState:B,queryCommandEnable:U,editorState:G}),(0,r.tZ)(a.Z,{ref:$,fixSections:z,queryCommandEnable:U,queryCommandState:B,onCommand:M,editorState:G}),(0,r.tZ)(s.Z,{ref:Q,queryCommandState:B,queryCommandEnable:U,editorState:G,onCommand:M,showDivider:et,moreSections:K}),et&&(0,r.tZ)(i.Z,{ref:J,mainSections:q,setButtonRectInfo:ee,onCommand:M,queryCommandState:B,queryCommandEnable:U,editorState:G})]})}},85826:function(e,t,n){"use strict";n.d(t,{$:function(){return i},Q:function(){return o}});var r=n(99281),o=(0,r.n2)(0),i=function(){return(0,r.Bn)(o)}},62317:function(e,t,n){"use strict";n.d(t,{Z:function(){return C}});var r=n(20857),o=n(22107),i=n(94707),a=n(86325),c=n(85626),s=n(85879),u=n(67814),l=n.n(u),d=n(14168),p=n.n(d),f=n(87363),h=n(17002),_=n(87320),m=n(55164),g=n(57477),T=n(71728),E=function(e){(0,a._)(n,e);var t=(0,c._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.position,n=e.preset,r=e.restricted,o=e.className,i=e.childrenClassName,a=e.children,c=(0,T._)(e,["position","preset","restricted","className","childrenClassName","children"]);return(0,s.tZ)("div",{className:"TooltipContent-wrapper",children:(0,s.BX)("div",(0,g._)((0,m._)({className:l()("TooltipContent","TooltipContent--".concat(t),"TooltipContent--".concat(n),o)},c),{children:[(0,s.tZ)("div",{className:"TooltipContent-arrow"}),(0,s.tZ)("div",{className:l()("TooltipContent-children",i,{"TooltipContent-children--restricted":r}),children:a})]}))})}}]),n}(f.Component);(0,_._)(E,"propTypes",{position:p().oneOf(["top","bottom","left","right"]),preset:p().oneOf(["black","white"]),restricted:p().bool,className:p().string,childrenClassName:p().string,children:p().node}),(0,_._)(E,"defaultProps",{position:"top",preset:"black",restricted:!0});var y=function(e){(0,a._)(n,e);var t=(0,c._)(n);function n(){var e;return(0,o._)(this,n),(e=t.call(this)).handleBodyClick=e.handleBodyClick.bind((0,r._)(e)),e.hideOnNextClick=!1,e}return(0,i._)(n,[{key:"componentDidMount",value:function(){this.props.hideOnClick&&document.body.addEventListener("click",this.handleBodyClick)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.timeout,r=t.hideOnClick,o=t.onClose;!this.props.shown&&e.shown&&(r&&(this.hideOnNextClick=!0),-1!==n&&(this.timeoutId=setTimeout(function(){o&&o()},n))),this.props.shown&&!e.shown&&this.reset()}},{key:"componentWillUnmount",value:function(){this.reset(),this.props.hideOnClick&&document.body.removeEventListener("click",this.handleBodyClick)}},{key:"handleBodyClick",value:function(){this.hideOnNextClick&&(this.reset(),this.props.onClose&&this.props.onClose())}},{key:"reset",value:function(){this.hideOnNextClick=!1,clearTimeout(this.timeoutId)}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.contentClassName,r=e.contentChildrenClassName,o=e.preset,i=e.restricted,a=e.shown,c=e.x,u=e.y,d=e.position,p=e.content,f=e.children,_=e.isTooltipRichText,m=p||f;return(0,s.tZ)(h.Z,{transitionName:"Tooltip",timeout:300,children:a&&(0,s.tZ)("div",{style:{left:c,top:u},className:l()("Tooltip",t),children:(0,s.tZ)(E,{className:n,childrenClassName:r,position:d,preset:o,restricted:i,children:_?(0,s.tZ)("div",{className:"RecruitmentCompanyProfile-content",dangerouslySetInnerHTML:{__html:m}}):m})},JSON.stringify({x:c,y:u}))})}}]),n}(f.Component);y.propTypes={position:E.propTypes.position,preset:E.propTypes.preset,restricted:E.propTypes.restricted,className:p().string,contentClassName:p().string,contentChildrenClassName:p().string,shown:p().bool,timeout:p().number,hideOnClick:p().bool,onClose:p().func,content:p().node,x:p().number,y:p().number,isTooltipRichText:p().bool},y.defaultProps={position:E.defaultProps.position,preset:E.defaultProps.preset,restricted:E.defaultProps.restricted,shown:!0,timeout:-1,hideOnClick:!1,isTooltipRichText:!1};var C=y},13427:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(85879),o=n(67814),i=n.n(o),a=n(80714);function c(e){var t=e.header,n=e.options,o=e.className,c=e.onRef,s=e.showOptions;return(0,r.BX)("div",{className:i()("Topbar",o,a.Z.isMobileEntry&&"Topbar--mobile"),ref:c,children:[(0,r.tZ)("div",{className:"Topbar-title",children:t}),(void 0===s||s)&&(0,r.tZ)("div",{className:"Topbar-options",children:n})]})}},57177:function(e,t,n){"use strict";n.d(t,{Z:function(){return M}});var r=n(22107),o=n(94707),i=n(87320),a=n(86325),c=n(55164),s=n(57477),u=n(71728),l=n(85626),d=n(85879),p=n(55698),f=n(72111),h=n(67814),_=n.n(h),m=n(14168),g=n.n(m),T=n(87363),E=n(92258),y=n(55536),C=n(7407),S=n(20857),I=n(77236),A=n(69383),b=n(87038),w=n(30722),Z=n(25452),x=n(91770),k=n(66263),R=n(85576),N=n(76741),O=n(31142),P=function(e){(0,a._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,r._)(this,n),e=t.apply(this,arguments),(0,i._)((0,S._)(e),"load",function(){var t=e.props,n=t.dispatch,r=t.id;n((0,N.hX)(r))}),(0,i._)((0,S._)(e),"track",function(){var t=e.props.topic;e.hoverCardElement&&t&&(A.Z.setModule(e.hoverCardElement,{module:"TopicItem"},{card:{content:{type:"Topic",token:t.id,item_num:t.questionsCount,follower_num:t.followersCount}}}),A.Z.trackCardShow(e.hoverCardElement))}),(0,i._)((0,S._)(e),"handleFollow",e.props.authRequired(function(){var t=!e.props.topic.isFollowing;A.Z.trackEvent(e.hoverCardElement,{action:t?"Follow":"UnFollow",element:"Button"});var n=e.props,r=n.dispatch,o=n.id;r((0,N.KS)(o))},k.q0.follow)),(0,i._)((0,S._)(e),"handleOpen",function(){e.load(),e.track()}),e}return(0,o._)(n,[{key:"isTopicReady",value:function(){var e=this.props.topic||{},t=e.questionsCount,n=e.followersCount,r=e.bestAnswersCount;return!(void 0===t&&void 0===n&&void 0===r)}},{key:"render",value:function(){var e=this,t=this.props,n=t.toggler,r=t.topic,o=t.id,i=t.isLoading,a=t.onRef,l=(0,u._)(t,["toggler","topic","id","isLoading","onRef"]),p=r||{},f=p.name,h=p.introduction,_=p.totalPv,m=p.discussCount,g=p.bestAnswersCount,T=p.avatarUrl,E=p.isFollowing,y=p.headerCard,C="//www.zhihu.com/topic/".concat(o),S=y&&y.avatarUrl||T;return(0,d.BX)(I.Z,(0,s._)((0,c._)({toggler:n,preventCloseOnTarget:!0,isLoading:i,onOpen:this.handleOpen,size:"large"},l),{ref:function(t){a&&"function"==typeof a&&a(t),e.hoverCardElement=t},children:[(0,d.tZ)(I.O,{title:(0,d.tZ)("a",{target:"_blank",rel:"noopener noreferrer",href:C,children:f}),avatarUrl:S,avatarFit:"cover"}),h&&(0,d.tZ)("div",{children:(0,d.tZ)(b.Z,{className:"HoverCard-description",html:h})}),(0,d.BX)("div",{children:[this.isTopicReady()&&(0,d.BX)(x.Z,{children:[(0,d.tZ)(x.Z.Item,{tag:O.Z,preset:"plain",a:!0,to:"".concat(C,"/questions"),name:"浏览量",value:(0,w.Zh)(Number(_)),isFormatted:!0,target:"_blank"}),(0,d.tZ)(x.Z.Item,{tag:O.Z,preset:"plain",a:!0,to:"".concat(C,"/top-answers"),name:"精华",value:g,target:"_blank"}),(0,d.tZ)(x.Z.Item,{tag:O.Z,preset:"plain",a:!0,to:"".concat(C,"/followers"),name:"讨论量",target:"_blank",value:(0,w.Zh)(Number(m)),isFormatted:!0})]}),(0,d.tZ)("div",{className:"HoverCard-buttons",children:r&&(0,d.tZ)(Z.ZP,{preset:"primary",color:E?"grey":"blue",onClick:this.handleFollow,children:E?"已关注":"关注话题"})})]})]}))}}]),n}(T.Component),D=(0,y.compose)(R.Z,(0,E.connect)(function(e,t){var n=t.id,r=e.entities.topics,o=e.loading.local;return{topic:r[n],isLoading:!!o["topic/".concat(n)]}}))(P),L=function(e){(0,a._)(n,e);var t=(0,l._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"render",value:function(){var e,t=this.props,n=t.isMobile,r=t.topic,o=r.name,i=r.avatarUrl,a=r.id,l=r.headerCard,h=t.avatar,m=t.avatarProps,g=t.noHoverCard,T=t.noLink,E=t.style,y=t.className,C=t.children,S=(t.dispatch,t.trackEvent,(0,u._)(t,["isMobile","topic","avatar","avatarProps","noHoverCard","noLink","style","className","children","dispatch","trackEvent"])),I=l&&l.avatarUrl||i;e=h?(0,d.tZ)(p.qE,(0,c._)({className:"TopicLink-avatar",url:I,alt:o},m)):C||o,T||(void 0===g?n:g)||(e=(0,d.tZ)(D,{toggler:e,id:a}));var A=T?"span":f.pl;return(0,d.tZ)(A,(0,s._)((0,c._)({style:E,className:_()("TopicLink",y),href:"//www.zhihu.com/topic/".concat(a),target:"_blank",as:T?"":"a",zaBlock:"TopicLink"},S),{children:e}))}}]),n}(T.Component);(0,i._)(L,"propTypes",{topic:g().object.isRequired,user:g().object,avatar:g().bool,avatarProps:g().object,noHoverCard:g().bool,noLink:g().bool,style:g().object,className:g().string,children:g().node}),(0,i._)(L,"defaultProps",{avatar:!1,noLink:!1});var M=(0,y.compose)((0,E.connect)(function(e){return{isMobile:(0,C.Hu)(e,{includeTablet:!0})}}))(L)},48710:function(e,t,n){"use strict";n.d(t,{OP:function(){return p},SS:function(){return f}});var r=n(55164),o=n(94009),i=n(85879),a=n(84871),c=n.n(a),s=n(87363),u=n(42559),l=n.n(u),d=(0,s.createContext)(null),p=function(){return(0,s.useContext)(d)},f=function(e){return c()(function(t){var n=p();return(0,i.tZ)(e,(0,r._)({traceId:n},t))},e)};t.ZP=function(e){var t=e.children,n=(0,o._)((0,s.useState)(function(){return String([Date.now(),l()()])}),1)[0];return(0,i.tZ)(d.Provider,{value:n,children:t})}},84407:function(e,t,n){"use strict";var r=n(94009),o=n(85879),i=n(24405),a=n(87363),c=n(87641),s=n(9887),u=n(3681);t.Z=function(e){var t=e.value,n=e.onChange,l=(0,i.F)().colors,d=(0,r._)((0,a.useState)(!1),2),p=d[0],f=d[1],h=function(e){return!(isNaN(e)||30>Number(e)||Number(e)>80)};return(0,o.tZ)(c.kC,{py:"11px",children:(0,o.BX)(c.kC,{children:[(0,o.tZ)(u.gN,{name:"试看内容",className:"ColumnSetting-Field",required:!0}),(0,o.BX)(c.kC,{flexDirection:"column",children:[(0,o.BX)(c.kC,{alignItems:"center",height:38,color:"GBL05A",css:{fontSize:"14px"},children:[(0,o.tZ)(c.xv,{children:"比例"}),(0,o.tZ)(s.Z,{value:t,onChange:function(e){var t=e.target.value.trim();f(!h(t)),n(t,h(t))},css:{width:"80px",margin:"0 8px",height:"38px"},maxLength:3}),(0,o.tZ)(c.xv,{children:"%"})]}),(0,o.tZ)(c.xv,{color:p?l.MapCriticalTip:"GBK06A",mt:"8px",css:{fontSize:"13px",lineHeight:"18px"},children:"试看比例为 30%～80%"})]})]})})}},60051:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(49910),s=n(18837),u=n.n(s),l=n(87641),d=n(88423),p=n(94307),f=u()(d.findImageSpec),h=function(e,t){return(0,d.imgUrl)(e,f(t))};t.Z=function(e){var t=e.user,n=e.size,s=void 0===n?38:n,u=e.noBadge,d=e.noLink,f=void 0!==d&&d,_=e.borderRadius,m=e.linkProps,g=(0,i._)(e,["user","size","noBadge","noLink","borderRadius","linkProps"]),T=t.avatarUrl,E=t.isOrg,y=t.urlToken,C=!f&&y?"https://www.zhihu.com/".concat(E?"org":"people","/").concat(y):null,S=(0,a.tZ)(l.Ee,{loading:"lazy",src:h(T,s),srcSet:"".concat(h(T,2*s)," 2x"),size:s,display:"block",css:{borderRadius:void 0===_?"50%":_}});return(0,a.BX)(l.xu,(0,o._)((0,r._)({display:"inline-block",size:s,css:{position:"relative"}},g),{children:[C?(0,a.tZ)(p.pl,(0,o._)((0,r._)({href:C,target:"_blank"},m),{children:S})):S,!(void 0!==u&&u)&&(0,a.tZ)(c.Vh,{css:(0,c.FJ)(s),isOrg:E,badge:t.badgeV2||t.badge,linkify:!f,enableTooltip:!0,useNew:!0})]}))}},73596:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(49910),s=n(14168),u=n.n(s),l=n(87363),d=n(87038),p=n(27258);function f(e){var t,n=e.user,s=void 0===n?{}:n,u=e.noHeadline,f=(0,i._)(e,["user","noHeadline"]),h=s.headline,_=s.isOrg,m=s.subTitle,g=(0,l.useMemo)(function(){return(0,c.TE)(s.badgeV2||s.badge)},[s]),T=g.identity,E=g.bestAnswerer,y=g.baike,C=g.title;return s?m||C?(0,a.tZ)(d.Z,(0,r._)({html:m||C},f)):!_&&(null==E?void 0:null===(t=E.topics)||void 0===t?void 0:t.length)?(0,a.BX)("div",(0,o._)((0,r._)({},f),{children:[(0,a.tZ)(p.Z,{topics:E.topics,user:s}),"的优秀答主"]})):T?(0,a.tZ)("div",(0,o._)((0,r._)({},f),{children:T[0].description})):y?(0,a.tZ)("div",(0,o._)((0,r._)({},f),{children:y.description})):h&&!u?(0,a.tZ)(d.Z,(0,r._)({html:h},f)):null:null}f.propTypes={user:u().object.isRequired,noHeadline:u().bool},t.Z=(0,l.memo)(f)},63658:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(85879),o=n(24405),i=n(63638);function a(e){var t=e.vipInfo,n=(0,o.F)().isDarkMode,a=t.vipIcon,c=a.nightModeUrl,s=a.url,u=t.targetUrl;return(0,r.tZ)(i.ZAClick,{zaType:"Button",zaEventType:"Click",zaModuleId:"kvip_icon",as:"a",ml:"0.3em",className:"UserLink-vipIcon",href:u,target:"_blank",rel:"noopener noreferrer",css:{display:"flex",alignItems:"center",justifyContent:"center",width:"14px",height:"14px",marginLeft:"0.3em"},children:(0,r.tZ)("img",{src:n?c:s,alt:"知乎知识会员",width:"100%",height:"100%"})})}},73831:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(29229),s=n(92258),u=n(7407),l=n(72111),d=n(65733),p=n(88329),f=n.n(p),h=n(87363),_=n(14914),m=n(69383),g=n(55462),T=(0,h.forwardRef)(function(e,t){var n=e.isPinProfile,c=e.user,s=e.isPinDaily,u=e.onClick,p=void 0===u?f():u,h=e.children,T=(0,i._)(e,["isPinProfile","user","isPinDaily","onClick","children"]),E=c.id,y=c.urlToken,C=c.isOrg,S=c.url,I=c.maskLevel,A="//www.zhihu.com/".concat(C?"org":"people","/").concat(y||E),b="zhihu://pin".concat(S,"/moments"),w=(0,d.A)(function(e){s&&"A"===e.target.nodeName&&m.Z.trackEvent(e.target,{id:2065}),n&&(e.preventDefault(),(0,g.Z)("base/openURL").dispatch({url:b})),I&&e.preventDefault(),p(e)});return(0,a.tZ)(l._o,{zaText:!0,zaBlock:"User",zaModuleId:"author_portrait_text_button",children:(0,a.tZ)(_.Link,(0,o._)((0,r._)({ref:t,to:A,href:A,target:"_blank",onClick:w,className:"UserLink-link","data-za-detail-view-element_name":"User"},T),{children:h}))})}),E=n(95956),y=function(e){var t=e.user,l=e.noHoverCard,d=e.noLink,p=e.children,f=(0,i._)(e,["user","noHoverCard","noLink","children"]),h=t.id,_=t.urlToken,m=(0,E.e)(t),g=(0,s.useSelector)(function(e){return(0,u.Hu)(e,{includeTablet:!0})}),y=null!=l?l:g,C=(0,c._)(function(){return n.e(9597).then(n.bind(n,89804))},!y);if(!m||d)return p||null;var S=(0,a.tZ)(T,(0,o._)((0,r._)({},f),{user:t,children:p}));return y||!C?S:(0,a.tZ)(C,{toggler:S,id:h,urlToken:_,user:t})}},50494:function(e,t,n){"use strict";var r=n(22107),o=n(94707),i=n(87320),a=n(86325),c=n(85626),s=n(85879),u=n(14168),l=n.n(u),d=n(87363),p=n(92258),f=n(20072),h=n(69383),_=function(e){(0,a._)(n,e);var t=(0,c._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"componentDidMount",value:function(){var e=this.props.zaViewName;(0,f.y3)(this.node,function(){h.Z.trackCardShow(null,{id:3613,name:e})})}},{key:"render",value:function(){var e=this,t=this.props,n=t.theme,r=t.zaViewName,o=t.vipIcon,i=o.nightModeUrl,a=o.url;return(0,s.tZ)("a",{className:"UserLink-vipIcon",href:"https://www.zhihu.com/vip",target:"_blank",rel:"noopener noreferrer",ref:function(t){return e.node=t},"data-za-detail-view-id":3612,"data-za-detail-view-name":r,children:(0,s.tZ)("img",{src:"light"===n?a:i,alt:"zhihu vip"})})}}]),n}(d.Component);(0,i._)(_,"propTypes",{vipIcon:l().shape({nightModeUrl:l().string,url:l().string}).isRequired,zaViewName:l().string}),t.Z=(0,p.connect)(function(e){return{theme:e.env.theme}})(_)},85661:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(55698),s=n(49910),u=n(29229),l=n(67814),d=n.n(l),p=n(92769),f=n.n(p),h=n(14168),_=n.n(h),m=n(92258),g=n(14914),T=n(69383),E=n(55462),y=n(7407),C=n(63658),S=n(50494),I=n(95956),A=function(e){var t,l,p=e.isPinProfile,h=e.onClick,_=e.isPinDaily,A=e.user,b=e.avatar,w=e.avatarProps,Z=e.showVipIcon,x=e.vipIconZaViewName,k=e.badgeProps,R=e.noBadge,N=e.noLink,O=e.noHoverCard,P=e.style,D=e.className,L=e.children,M=(0,i._)(e,["isPinProfile","onClick","isPinDaily","user","avatar","avatarProps","showVipIcon","vipIconZaViewName","badgeProps","noBadge","noLink","noHoverCard","style","className","children"]),B=(0,m.useSelector)(function(e){return(0,y.Hu)(e,{includeTablet:!0})}),U=A.id,G=A.name,F=A.avatarUrl,H=A.urlToken,z=A.isOrg,q=A.vipInfo,V=A.kvipInfo,W=A.url,X=A.maskLevel,K=void 0===O?B:O,j=(0,u._)(function(){return n.e(9597).then(n.bind(n,89804))},!K&&!B);l=b?(0,a.tZ)(c.qE,(0,r._)({className:"UserLink-avatar",url:F,alt:G},w)):L||G;var Y=!!(0,I.e)(A),Q="//www.zhihu.com/".concat(z?"org":"people","/").concat(H||U);return Y&&!N&&(l=(0,a.tZ)(g.Link,(0,o._)((0,r._)({className:"UserLink-link","data-za-detail-view-element_name":"User",to:Q,target:"_blank",onClick:(t="zhihu://pin".concat(W,"/moments"),function(e){_&&"A"===e.target.nodeName&&T.Z.trackEvent(e.target,{id:2065}),p&&(e.preventDefault(),(0,E.Z)("base/openURL").dispatch({url:t})),X&&e.preventDefault(),h&&"function"==typeof h&&h(e)})},f()(M,["isPinProfile","trackEvent","onClick","dispatch","isPinDaily"])),{children:l})),!K&&j&&(l=(0,a.tZ)(j,{toggler:l,id:U,urlToken:H,user:A}))),(0,a.BX)("span",{style:P,className:d()("UserLink",D),children:[l,Y&&!R&&!b&&(0,a.tZ)(s.Vh,(0,r._)({css:{marginLeft:".3em"},isOrg:z,badge:A.badgeV2||A.badge,linkify:!0,enableTooltip:!0,useNew:!0},k)),Y&&Z&&!b&&q&&q.vipIcon&&(0,a.tZ)(S.Z,{vipIcon:q.vipIcon,zaViewName:x}),Y&&Z&&!b&&V&&V.vipIcon&&(0,a.tZ)(C.Z,{vipInfo:V})]})};A.propTypes={user:_().object.isRequired,avatar:_().bool,avatarProps:_().object,noBadge:_().bool,noHoverCard:_().bool,showVipIcon:_().bool,style:_().object,className:_().string,children:_().node,isPinProfile:_().bool,isPinDaily:_().bool},A.defaultProps={avatar:!1,noBadge:!1,showVipIcon:!1},t.Z=A},95956:function(e,t,n){"use strict";n.d(t,{e:function(){return o}});var r=n(66263);function o(e){var t=e.id,n=e.urlToken;return t!==r.aK.id&&!!(n||t)}},94226:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(55698),s=n(67814),u=n.n(s),l=n(73831);function d(e){var t=e.className,n=e.user,s=void 0===n?{}:n,d=e.avatarProps,p=void 0===d?{}:d,f=(0,i._)(e,["className","user","avatarProps"]),h=s.name,_=s.avatarUrl;return(0,a.tZ)("span",{className:u()("UserLink",t),children:(0,a.tZ)(l.Z,(0,o._)((0,r._)({},f),{user:s,children:(0,a.tZ)(c.qE,(0,r._)({className:"UserLink-avatar",url:_,alt:h},p))}))})}},78:function(e,t,n){"use strict";n.d(t,{Z:function(){return w}});var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(49910),s=n(67814),u=n.n(s);n(22107),n(94707),n(86325),n(85626);var l=n(87363);l.Component;var d=n(24405),p=n(14583),f=n(63638),h=function(e){var t=e.vipInfo,n=(0,i._)(e,["vipInfo"]),c=(0,d.F)().isDarkMode,s=t.vipIcon,u=t.targetUrl,l=s||{},h=l.url,_=l.nightModeUrl,m=c?_:h;return(0,a.BX)(f.ZAClick,(0,o._)((0,r._)({as:"a",href:u,rel:"noopener noreferrer",zaType:"Button",zaEventType:"Click",zaModuleId:"kvip_icon",css:{cursor:"pointer",display:"inline-flex",alignItems:"center"}},n),{children:["​",m?(0,a.tZ)("img",{src:m,alt:"知乎知识会员",css:{width:"1em",height:"1em"}}):(0,a.tZ)(p.Z,{css:{height:"1em",width:"1em"}})]}))},_=n(64386),m=n(16850),g=function(e){var t=e.vipIcon,n=e.imageToken,r=e.nightModeToken,o=(0,d.F)().isDarkMode,i=t||{},a=i.url,c=i.nightModeUrl;return o?r?"https://picx.zhimg.com/".concat(r):c:n?"https://picx.zhimg.com/".concat(n):a},T=(0,l.memo)(function(e){var t=e.vipInfo,n=(0,i._)(e,["vipInfo"]),c=g(t),s=(0,m.Z)();return(0,a.BX)(f.ZAClick,(0,o._)((0,r._)({as:"span",rel:"noopener noreferrer",zaBlock:"VipBadge",zaType:"Button",zaEventType:"Click",onClick:function(){s?window.location.href=" https://www.zhihu.com/xen/market/vip-privileges":_.Z.show()},css:{cursor:"pointer",display:"inline-flex",alignItems:"center"}},n),{children:["​",c?(0,a.tZ)("img",{src:c,alt:"",css:{width:"1em",height:"1em"}}):(0,a.tZ)(p.Z,{css:{height:"1em",width:"1em"}})]}))}),E=n(6627),y=n(87641),C=function(){var e=(0,d.F)().colors;return(0,a.BX)(y.kC,{css:function(e){return{paddingInline:3,alignItems:"center",borderRadius:4,backgroundColor:e.colors.MapUIFrame10A,display:"inline-flex",marginLeft:6}},children:[(0,a.tZ)(E.Z,{size:12,fill:e.MapBrand}),(0,a.tZ)(y.xv,{css:function(e){return{fontSize:10,lineHeight:"16px",fontWeight:"500",color:e.colors.MapBrand,marginLeft:2}},children:"航海家赞同"})]})},S=n(63658),I=n(73831),A=n(50494),b=n(95956);function w(e){var t,n,s,l,d,p=e.className,f=e.showVipIcon,_=e.vipIconZaViewName,m=e.user,g=void 0===m?{}:m,E=e.noBadge,y=e.noVipBadge,w=void 0!==y&&y,Z=e.children,x=e.badgeProps,k=void 0===x?{}:x,R=e.showNavigatorVoteBadge,N=(0,i._)(e,["className","showVipIcon","vipIconZaViewName","user","noBadge","noVipBadge","children","badgeProps","showNavigatorVoteBadge"]),O=(0,b.e)(g),P=(null===(t=g.vipInfo)||void 0===t?void 0:t.isVip)&&!w,D=!w&&(null===(n=g.kvipInfo)||void 0===n?void 0:n.isVip)&&(null===(s=g.kvipInfo)||void 0===s?void 0:s.vipIcon),L=O&&f&&(null===(l=g.vipInfo)||void 0===l?void 0:l.vipIcon),M=O&&f&&(null===(d=g.kvipInfo)||void 0===d?void 0:d.vipIcon);return(0,a.BX)("span",{className:u()("UserLink",p),children:[(0,a.tZ)(I.Z,(0,o._)((0,r._)({},N),{user:g,children:Z||g.name})),g.isNavigator&&void 0!==R&&R&&(0,a.tZ)(C,{}),O&&!E&&(0,a.tZ)(c.Vh,(0,r._)({css:{marginLeft:".3em"},isOrg:g.isOrg,badge:g.badgeV2||g.badge,linkify:!0,enableTooltip:!0,useNew:!0},k)),P&&(0,a.tZ)(T,{vipInfo:g.vipInfo,css:{marginLeft:".3em"}}),D&&(0,a.tZ)(h,{vipInfo:g.kvipInfo,css:{marginLeft:".3em"}}),L&&(0,a.tZ)(A.Z,{vipIcon:g.vipInfo.vipIcon,zaViewName:_}),M&&(0,a.tZ)(S.Z,{vipInfo:g.kvipInfo})]})}},29504:function(e,t,n){"use strict";var r=n(94009),o=n(85879),i=n(67550),a=n(38151),c=n(65733),s=n(58338),u=n(6080),l=n(68159),d=n(87363),p=n(55),f=n(76976),h=n(89774),_=n(83821);t.Z=(0,d.memo)(function(e){var t=e.videoId,n=e.contentId,m=e.contentType,g=e.zaProps,T=e.cover,E=e.muted,y=e.standalone,C=e.useSingle,S=void 0!==C&&C,I=e.hideWatermark,A=(0,h.Z)(),b="1"===(0,u.c)("use_hevc")||A,w="1"===(0,u.c)("use_backdrop_blur")||A,Z="1"===(0,u.c)("play_station")||A,x=(0,d.useRef)({isPlaying:!1,isPip:!1}).current,k=(0,d.useRef)((0,l.Wn)(t,"*",!0)).current,R=(0,r._)((0,a.Y)({threshold:.5},S),2),N=R[0],O=R[1],P="1"===(0,u.c)("use_new_player")?"ks":"zhihu",D=(0,f.Hg)(),L=(0,c.A)(function(){O||!x.isPlaying||x.isPip||k.dispatchMessage(window,l.aO.PAUSE,{dontApplyOnFullScreen:!0})}),M=(0,c.A)(function(){x.isPlaying=!0,k.dispatchMessage(window,l.aO.EXIT_PIP)}),B=(0,c.A)(function(){x.isPlaying=!1}),U=(0,c.A)(function(){x.isPip=!0}),G=(0,c.A)(function(){x.isPip=!1}),F=(0,s.f)((0,c.A)(function(){L()}),200);return(0,d.useEffect)(function(){if(S){var e=[k.subscribeMessage(l.FP.PLAY,M).unsubscribe,k.subscribeMessage(l.FP.PAUSE,B).unsubscribe,k.subscribeMessage(l.FP.ENTER_PIP,U).unsubscribe,k.subscribeMessage(l.FP.EXIT_PIP,G).unsubscribe];return window.addEventListener("scroll",F),function(){window.removeEventListener("scroll",F),e.forEach(function(e){return e()})}}},[S,B,M,F,k,U,G]),(0,o.tZ)("div",{ref:N,css:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},children:(0,o.tZ)(_.ZP,{children:(0,o.tZ)(i.ZP,{hideWatermark:void 0!==I&&I,identify:P,id:t,zaProps:g,pageName:m,muted:void 0!==E&&E,useHEVC:b,standalone:void 0!==y&&y,shouldShowPageFullScreenButton:!0,cover:T,backdropBlur:w,usePlayStation:Z,scene:D,contentId:"".concat(n),contentType:m,children:n&&m&&(0,o.tZ)(p.Z,{id:t,itemId:n,itemType:m})})})})})},69183:function(e,t,n){"use strict";n.d(t,{Z:function(){return P}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(57477),l=n(85626),d=n(85879),p=n(6627),f=n(76280),h=n(10421),_=n(67814),m=n.n(_),g=n(84871),T=n.n(g),E=n(14168),y=n.n(E),C=n(87363),S=n(55536),I=n(63638),A=n(30722),b=n(25452),w=n(97727),Z=n(80714),x=n(66263),k=n(85576),R=n(16850),N={OPPOSITION:-1,NONE:0,NORMAL:1,NAVIGATOR:2},O=function(e){(0,c._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"voteUpButtonRef",(0,C.createRef)()),(0,a._)((0,r._)(e),"voteDownButtonRef",(0,C.createRef)()),(0,a._)((0,r._)(e),"onVote",e.props.authRequired(function(t,n){e.props.onVote(t,n)},x.q0.vote)),(0,a._)((0,r._)(e),"voteUp",function(t){var n,r,o=e.props,i=o.voting,a=o.isNavigator,c=o.voteNextStep;if(a){switch(i){case N.NONE:case N.OPPOSITION:n="up",r="已赞同，再次点击可执行「航海家赞同」";break;case N.NORMAL:"vote"===c?(n="navigator_up",r="已完成「航海家赞同」，内容会推给更多人"):(n="neutral",r="已取消");break;case N.NAVIGATOR:n="normal_up",r="已取消「航海家赞同」";break;default:n="neutral",r="已取消"}e.vote(t,n,r)}else{var s=i===N.NORMAL?"neutral":"up";e.vote(t,s)}e.voteUpButtonRef.current.focus()}),(0,a._)((0,r._)(e),"voteDown",function(t){var n=e.props.voting;e.vote(t,-1===n?"neutral":"down"),e.voteDownButtonRef.current.focus()}),(0,a._)((0,r._)(e),"vote",function(t,n,r){var o=e.props,i=o.disableAuth,a=o.handleToggleGuide,c=o.onClick;if(c){c(t,n);return}if(i){a(t,n);return}e.onVote(n,r)}),(0,a._)((0,r._)(e),"handleTogglerClick",function(t){e.shouldShowMenu()||t.preventDefault(),e.voteDown(t)}),(0,a._)((0,r._)(e),"voteUpButtonZAProps",function(){var t,n,r,o,i=e.props,a=i.isNavigator,c=i.voting,s=i.voteNextStep;if(a)switch(c){case N.NONE:t="赞同",n="Upvote",r="general",o="general";break;case N.NORMAL:"vote"===s?(t="赞同",n="Upvote",r="general",o="navigator"):(t="取消赞同",n="UnUpvote",r="general",o="general");break;case N.NAVIGATOR:t="取消赞同",n="UnUpvote",r="navigator",o="navigator";break;default:t="取消赞同",n="UnUpvote",r="general",o="general"}else t=c===N.NORMAL?"取消赞同":"赞同",n=c===N.NORMAL?"UnUpvote":"Upvote",r="general",o="general";return{zaText:t,zaAction:n,upvoteBtnStyleShow:r,upvoteBtnStyleClick:o}}),(0,a._)((0,r._)(e),"renderVoteUpButton",function(){var t=e.props,n=t.isOwner,r=t.count,o=t.voting,i=t.disabled,a=t.hideDesc,c=o===N.NAVIGATOR,s=o===N.NORMAL,u=c||s?"已赞同":"赞同",l=[u,(0,A.Zh)(r)].join(" "),h=[!a&&u,0!==r&&(0,A.Zh)(r).trim()].filter(Boolean).join(" "),_=e.voteUpButtonZAProps(),g=_.zaText,T=_.zaAction,E=_.upvoteBtnStyleShow,y=_.upvoteBtnStyleClick;return(0,d.tZ)(I.ZAShow,{zaType:"Button",zaModuleId:"upvote_btn",zaText:g,extra:{configMap:{upvote_btn_style:E}},as:"span",children:(0,d.BX)(I.ZAClick,{as:b.ZP,zaModuleId:"upvote_btn",zaText:g,zaType:"Button",zaAction:T,className:m()("VoteButton",{"is-active":o===N.NORMAL||o===N.NAVIGATOR}),disabled:n||i,onClick:e.voteUp,"aria-label":l,"aria-live":"polite",extra:{configMap:{upvote_btn_style:y}},onRef:e.voteUpButtonRef,children:[c?(0,d.tZ)(p.Z,{center:!0,size:14,className:"VoteButton-Ship"}):(0,d.tZ)(f.Ex,{center:!0,size:10,className:"VoteButton-TriangleUp"}),h]})})}),(0,a._)((0,r._)(e),"renderVoteDownButton",function(){var t=e.props,n=t.voting,r=t.disabled,o=t.isMobile,i=-1===n;return(0,d.tZ)(I.ZAClick,{as:b.ZP,zaText:i?"取消反对":"反对",zaType:"Button",zaModuleId:"downvote_btn",zaAction:i?"UnDownvote":"Downvote",className:m()("VoteButton VoteButton--down",{"is-active":-1===n},{"VoteButton--mobileDown":Z.Z.isMobileEntry||o}),disabled:r,onClick:e.voteDown,"aria-label":i?"已反对":"反对","aria-live":"polite",onRef:e.voteDownButtonRef,children:(0,d.tZ)(h.y,{center:!0,size:10})})}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.isOwner,n=e.hideDownVote;return(0,d.BX)("span",{ref:this.voteButtonRef,children:[(0,d.tZ)(w.bY,{input:"v",action:this.voteUp}),(0,d.tZ)(w.bY,{input:"d",action:this.voteDown}),this.renderVoteUpButton(),!t&&!n&&this.renderVoteDownButton()]})}}]),n}(C.Component);(0,a._)(O,"propTypes",{voting:y().oneOf([-1,0,1,2]).isRequired,voteNextStep:y().oneOf(["vote","unvote"]),disabled:y().bool,type:y().string,hideDesc:y().bool,zaIds:y().shape({voteUp:y().number,voteDown:y().number}),hideDownVote:y().bool,isNavigator:y().bool}),(0,a._)(O,"defaultProps",{voting:0,voteNextStep:"vote",disabled:!1,type:"",hideDesc:!1,zaIds:{},hideDownVote:!1,isNavigator:!1});var P=(0,S.compose)((0,R.$)(),k.Z,function(e){return T()(function(t){var n=t.navigatorVote,r=t.voting;return(0,d.tZ)(e,(0,u._)((0,s._)({},t),{voting:r===N.NORMAL&&n?N.NAVIGATOR:r}))},e)})(O)},97285:function(e,t,n){"use strict";n.d(t,{Z:function(){return b}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(85626),l=n(85879),d=n(87363),p=n(92258),f=n(8866),h=n(89250),_=n(10886),m=n(70236),g=n(62618),T=n(24405),E=n(14168),y=n.n(E),C=n(75106),S=function(e){var t=e.voteupCount,n=e.type,r=e.isFetching,o=e.isDrained,i=e.items,a=e.onLoad,c=e.handleListHide,s=e.modalShown,u=e.hasNavigatorUser,d=(0,T.F)().colors;return t<=0?null:(0,l.tZ)("span",{css:{color:d.GBL05A},children:(0,l.tZ)(g.Z,{size:"fullPage",onClose:c,styles:{root:{height:520}},children:s&&(0,l.tZ)(C.Z,{isFetching:r,isDrained:o,text:"column"===n?"关注了":"赞同了",items:i,voteupCount:t,onLoad:a,hasNavigatorUser:u})})})};S.propTypes={openable:y().bool,id:y().oneOfType([y().number,y().string]),type:y().oneOf(["pin","answer","article","column"]).isRequired,modalShown:y().bool,handleListHide:y().func},S.defaultProps={openable:!0};var I={answer:"answers",article:"articles",pin:"pins",column:"columns"},A=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleLoad",function(){var t=e.props,n=t.type,r=t.id,o=t.loadAnswerVoters,i=t.loadArticleVoters,a=t.loadColumnsFollowers,c=t.loadPinVoters;switch(n){case"answer":return o(r);case"article":return i(r);case"column":return a(r);case"pin":return c(r);default:return null}}),e}return(0,i._)(n,[{key:"render",value:function(){return(0,l.tZ)(S,(0,s._)({onLoad:this.handleLoad},this.props))}}]),n}(d.Component);(0,a._)(A,"propsTypes",(0,s._)({},S.propsTypes)),(0,a._)(A,"defaultProps",(0,s._)({},S.defaultProps));var b=(0,p.connect)(function(e,t){var n=t.id,r=t.type,o=e.entities.users,i=(e[I[r]]||{}).upvoters,a=(void 0===i?{}:i)[n]||{isFetching:!1,isDrained:!1,order:"normal",ids:[]},c=a.isFetching,s=a.isDrained,u=a.order,l=a.ids,d=a.extra;return{isFetching:c,isDrained:s,order:u,items:l.map(function(e){return o[e]}),hasNavigatorUser:null==d?void 0:d.hasNavigatorUser}},{loadAnswerVoters:f.Yu,loadArticleVoters:h.Id,loadColumnsFollowers:_.bK,loadPinVoters:m.Qw})(A)},75106:function(e,t,n){"use strict";n.d(t,{Z:function(){return G}});var r=n(22107),o=n(94707),i=n(87320),a=n(86325),c=n(55164),s=n(57477),u=n(85626),l=n(85879),d=n(99178),p=n(14168),f=n.n(p),h=n(87363),_=n(22715),m=n(30722),g=n(80714),T=n(13427),E=n(20857),y=n(55536),C=n(69383),S=n(63638),I=n(44169),A=n(56628),b=n(1606),w=n(30361),Z=n(46829),x=n(74914),k=n(73596),R=n(85661),N=n(78),O=n(94226),P=function(e){(0,a._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,r._)(this,n),e=t.apply(this,arguments),(0,i._)((0,E._)(e),"zaRef",(0,h.createRef)()),(0,i._)((0,E._)(e),"handleClickFollowButton",function(){var t=e.props,n=t.onClick,r=t.user,o=r.isFollowing,i=r.id,a=r.urlToken;return null==n||n(),e.zaRef.current.trackEvent({eventType:"Click",action:(0,A.ah)(o).action,elementLocation:{type:"Button",moduleId:"agree_list_popup_user_card_follow_button",content:{type:"User",id:i,token:a}}}),!0}),e}return(0,o._)(n,[{key:"componentDidMount",value:function(){var e=this.props.user;C.Z.setModule(this,{module:"UserItem"},{card:{content:{type:"User",member_hash_id:e.id,follower_num:e.followerCount}}})}},{key:"renderRewardDetails",value:function(){var e=this.props.user,t=e.amount,n=e.rewardCreated;return(0,l.BX)("div",{className:"ContentItem-rewardDetails",children:[(0,l.tZ)("p",{className:"ContentItem-rewardAmount",children:t&&"赞赏了 \xa5".concat(t/100)}),(0,l.tZ)("p",{className:"ContentItem-rewardTime",children:(0,I.rL)(n)})]})}},{key:"render",value:function(){var e=this.props,t=e.user,n=t.urlToken,r=t.isFollowed,o=t.isFollowing,i=t.answerCount,a=t.articlesCount,c=t.followerCount,s=t.id,u=t.isOrg,d=e.user,p=e.type,f=e.isRewardList,_=e.action,T=e.meta,E=e.status,y=e.noTrackCardShow,C=e.currentUser,I=e.showNavigatorVoteBadge,A=!n,b=C&&C.id===s,P=void 0!==_?_:!b&&!A&&(0,l.tZ)(Z.Z,{id:d.urlToken,type:p||d.type,preset:Z.Z.PRESETS.primary,gender:d.gender,isFollowing:o,onClick:this.handleClickFollowButton}),D=void 0!==T?T:A||(0,l.tZ)(k.Z,{user:d}),L=void 0!==E?(0,l.tZ)(w.qb,{children:E}):!A&&(0,l.BX)(w.qb,{children:[!!i&&"".concat((0,m.uf)(i)," 回答"),!!a&&"".concat((0,m.uf)(a)," 文章"),!!c&&"".concat((0,m.uf)(c)," 关注者")]}),M="//www.zhihu.com/".concat(u?"org":"people","/").concat(n||s),B=this.props.userLinkV2;return(0,l.BX)(h.Fragment,{children:[(0,l.tZ)(w.ZP,{data:d,link:M,image:B?(0,l.tZ)(O.Z,{className:"UserItem-avatar",avatarProps:{size:g.Z.isMobileEntry?46:60},user:d,target:"_blank"}):(0,l.tZ)(R.Z,{className:"UserItem-avatar",avatar:!0,avatarProps:{size:g.Z.isMobileEntry?46:60},user:d,target:"_blank"}),title:(0,l.BX)("div",{className:"UserItem-title",children:[B?(0,l.tZ)(N.Z,{user:d,target:"_blank",showNavigatorVoteBadge:I}):(0,l.tZ)(R.Z,{user:d,target:"_blank"}),(0,l.tZ)(x.Z,{isFollowing:o,isFollowed:r})]}),meta:(0,l.BX)("div",{children:[D,L]}),noTrackCardShow:y,extra:f?this.renderRewardDetails():P}),(0,l.tZ)(S.ZARef,{ref:this.zaRef})]})}}]),n}(h.Component);(0,i._)(P,"propTypes",{action:f().node,status:f().node,meta:f().node,type:f().string,isRewardList:f().bool,onClick:f().func,currentUser:f().object});var D=(0,y.compose)((0,b.Ib)(function(e){var t=e.user;return{content:{type:"User",token:String(t.urlToken),id:String(t.id)},moduleId:"user_card"}}))(P),L=n(7753),M=n(87641),B=function(e){return e.hasNavigatorUser?(0,l.tZ)(S.ZAShow,{as:M.xu,zaType:"Button",zaModuleId:"agree_list_page_navigator_Introduction",shouldTrackClick:!0,css:{marginTop:12,marginInline:20},children:(0,l.BX)(M.kC,{css:function(e){return{paddingInline:10,paddingBlock:8,borderRadius:4,backgroundColor:e.colors.MapUIFrame10A,alignItems:"center",justifyContent:"space-between",cursor:"pointer"}},onClick:function(){window.open("https://www.zhihu.com/question/1802492974/answer/12754771901","_blank")},children:[(0,l.tZ)(M.xv,{css:function(e){return{fontSize:12,lineHeight:"16px",color:e.colors.MapBrand}},children:"航海家赞同了该内容，什么是航海家？"}),(0,l.tZ)(L.ZP,{size:12,css:function(e){return{color:e.colors.MapBrand}}})]})}):null},U=function(e){(0,a._)(n,e);var t=(0,u._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"render",value:function(){var e=this.props,t=e.isFetching,n=e.isDrained,r=e.items,o=e.voteupCount,i=e.onLoad,a=e.text,u=e.isRewardList,p=e.notice,f=e.type,h=e.currentUser,E=e.hasNavigatorUser,y=g.Z.isMobileEntry?{}:{getContainer:function(e){return e}};return(0,l.BX)("div",{className:"VoterList",children:[(0,l.tZ)(T.Z,{header:"".concat((0,m.uf)(o)," 人").concat(a||"赞同了")}),u&&p&&(0,l.tZ)("div",{className:"VoterList-description",children:(0,l.tZ)("p",{children:p})}),(0,l.tZ)(B,{hasNavigatorUser:E}),(0,l.tZ)(d.ZP,(0,s._)((0,c._)({className:"VoterList-content",isLoading:t,isDrained:n,onLoad:i,placeholder:(0,l.tZ)(d.i,{className:"List-item",withAvatar:!0})},y),{children:r&&r.map(function(e,t){return(0,l.tZ)(_.HC,{children:(0,l.tZ)(D,{currentUser:h,user:e,isRewardList:u,meta:null,type:f,userLinkV2:!0,showNavigatorVoteBadge:!0})},"".concat(t,".").concat(e.urlToken))})}))]})}}]),n}(h.Component);(0,i._)(U,"propTypes",{isFetching:f().bool.isRequired,isDrained:f().bool.isRequired,items:f().array.isRequired,voteupCount:f().number.isRequired,text:f().string.isRequired,onLoad:f().func.isRequired,isRewardList:f().bool,type:f().string,currentUser:f().object});var G=U},10284:function(e,t,n){"use strict";n.d(t,{A:function(){return a},MZ:function(){return c},SR:function(){return s}});var r=n(55164),o=n(85879),i=function(e){return(0,o.tZ)("div",(0,r._)({css:{paddingTop:"16px",marginBottom:-10,h2:{paddingBottom:"20px",fontWeight:"500",fontSize:"24px",textAlign:"center"},p:{textAlign:"center",fontSize:"14px"}}},e))};t.ZP=function(){return(0,o.BX)(i,{children:[(0,o.tZ)("h2",{children:"保存草稿？"}),(0,o.tZ)("p",{children:"保存已添加的内容，后续继续编辑"})]})};var a=function(){return(0,o.BX)(i,{children:[(0,o.tZ)("h2",{children:"是否放弃本次编辑？"}),(0,o.tZ)("p",{children:"退出后，当前编辑的内容不会保存"})]})},c=function(){return(0,o.BX)(i,{children:[(0,o.tZ)("h2",{children:"图片正在上传中，是否现在退出编辑？"}),(0,o.tZ)("p",{children:"草稿中将无法保存正在上传的图片"})]})},s=function(){return(0,o.BX)(i,{children:[(0,o.tZ)("h2",{children:"是否保存本次编辑到草稿？"}),(0,o.tZ)("p",{children:"保存的草稿可在「创作中心 - 草稿箱」查看"})]})}},91986:function(e,t,n){"use strict";n.d(t,{D3:function(){return h},e:function(){return u}});var r=n(55164),o=n(85879),i=n(50373),a=n(58216),c=n(48710);function s(){return Promise.all([n.e(2090),n.e(1608),n.e(5886),n.e(4717)]).then(n.bind(n,51098))}var u=function(e){return(0,o.tZ)(c.ZP,{children:(0,o.tZ)(a.ZP,{children:(0,o.tZ)(i.Z,(0,r._)({getComponent:s},e))})})},l=n(29229),d=n(24187),p=(0,n(94648).I)(function(){return Promise.all([n.e(2090),n.e(1608),n.e(5886),n.e(3199)]).then(n.bind(n,59645))}),f=function(e){return function(t){var n=(0,l._)(function(){return p()}),i=n?n[e]:null;return(0,o.tZ)(c.ZP,{children:(0,o.tZ)(a.ZP,{children:i?(0,o.tZ)(i,(0,r._)({},t)):(0,o.tZ)(o.HY,{children:"WritePinForm"===e&&(0,o.tZ)(d.O,{variant:"T02"})})})})}};f("WritePinForm");var h=f("WritePinModal")},617:function(e,t,n){"use strict";n.d(t,{Z:function(){return Z}});var r=n(55164),o=n(94009),i=n(85879),a=n(65733),c=n(43897),s=n(87363),u=n(92258),l=n(87641),d=n(69383),p=n(31467),f=n(25452),h=n(86172),_=n(89694),m=n(67927),g=n(41492),T=n(77263),E=n(53438),y=n(99178),C=n(70400),S=n(91486),I=n(80565),A=n(44169);function b(e){var t=e.item,n=e.onCheck,r=(0,o._)((0,s.useState)(!1),2),a=r[0],c=r[1],u=t.id,d=t.title,p=t.description,f=t.imageUrl,h=t.publishedAt,m=t.video,g=null==m?void 0:m.duration;return(0,i.BX)(l.kC,{p:"20px 24px",justifyContent:"space-between",alignItems:"center",children:[(0,i.BX)(l.kC,{flex:1,children:[(0,i.BX)(l.xu,{width:112,height:70,flexShrink:0,marginRight:"16px",css:{position:"relative",borderRadius:3,overflow:"hidden"},children:[(0,i.tZ)(l.Ee,{width:"100%",height:"100%",src:f,alt:"",css:{objectFit:"cover"}}),(0,i.tZ)(l.xv,{fontSize:12,lineHeight:"14px",color:"GBK99A",css:{position:"absolute",bottom:4,right:7,textShadow:"0 0 5px rgba(0,0,0,0.5)"},children:(0,_.LU)(g)})]}),(0,i.BX)(l.kC,{flexDirection:"column",justifyContent:"center",flex:1,children:[(0,i.tZ)(l.xv,{fontSize:14,fontWeight:500,lineHeight:"20px",color:"GBK03A",css:[(0,I.S)(1)],children:d}),(0,i.tZ)(l.xv,{mt:"6px",fontSize:14,lineHeight:"20px",color:"GBK04A",css:[(0,I.S)(1)],children:p}),(0,i.tZ)(l.xv,{mt:"8px",fontSize:13,lineHeight:"16px",color:"GBK06A",children:(0,A.rL)(h)})]})]}),(0,i.tZ)(S.C,{css:{marginLeft:16,flexShrink:0},checked:a,onChange:function(e){c(e.currentTarget.checked),n(u)}})]})}function w(e){var t,n=e.onClose,r=e.onSubmit,a=(0,o._)((0,s.useState)([]),2),c=a[0],d=a[1],p=(0,u.useSelector)(function(e){return e.zvideos.insertable})||{},h=p.isLoading,_=p.data,m=p.paging,T=(0,u.useDispatch)(),E=(0,s.useCallback)(function(){T((0,g.Fn)())},[T]),S=(0,s.useCallback)(function(e){c.includes(e)?d(c.filter(function(t){return t!==e})):d(c.concat([e]))},[c]);return(0,i.BX)(l.xu,{height:688,children:[(0,i.tZ)(l.xu,{m:"40px auto",fontSize:24,fontWeight:500,lineHeight:"30px",color:"GBK02A",textAlign:"center",children:"选择已发布的视频"}),(0,i.tZ)(y.ZP,{css:{marginBottom:100},onLoad:E,isLoading:null!=h&&h,isDrained:null!==(t=null==m?void 0:m.isEnd)&&void 0!==t&&t,getContainer:function(e){return e.parentElement.parentElement.parentElement},children:_.map(function(e,t){return(0,i.tZ)(C.SV,{children:(0,i.tZ)(b,{item:e,onCheck:S})},t)})}),(0,i.BX)(l.kC,{bg:"GBK99A",p:"32px 25px",width:"100%",height:100,justifyContent:"center",css:{position:"absolute",left:0,right:0,bottom:0},children:[(0,i.tZ)(f.ZP,{css:{flex:1},onClick:n,children:"返回"}),(0,i.tZ)(f.ZP,{disabled:0===c.length,css:{flex:1,marginLeft:18},preset:"primary",color:"blue",onClick:function(){r(c),n()},children:"添加"})]})]})}var Z=function(e){var t=e.show,n=e.onZVideoSubmit,y=e.onVideoSubmit,C=e.onClose,S=((0,u.useSelector)(function(e){return e.zvideos.insertable})||{}).data,I=(0,o._)((0,s.useState)(!1),2),A=I[0],b=I[1],Z=(0,o._)((0,s.useState)(!1),2),x=Z[0],k=Z[1],R=(0,u.useDispatch)(),N=function(){if((null==S?void 0:S.length)>0){k(!0);return}R((0,g.Fn)()).then(function(e){e.payload.data.length?k(!0):R((0,m.c0)("还没有发布过视频"))})},O=(0,a.A)(function(e){var t=(0,_.D3)(e),n=t.message,r=t.abortUpload,o=t.validFiles;n&&(R((0,m.c0)(n,r?"red":"white")),r)||y({value:o[0]})});return t?(0,i.BX)(p.Z,{css:{width:688},onClose:C,children:[x&&(0,i.tZ)(w,{onSubmit:n,onClose:function(){k(!1)}}),!x&&(0,i.BX)(i.HY,{children:[(0,i.tZ)(l.xv,{fontSize:"24px",color:"GBK02A",lineHeight:"34px",fontWeight:500,m:"40px 0 30px",textAlign:"center",children:"导入视频"}),(0,i.BX)(l.kC,{flexDirection:"column",alignItems:"center",width:"440px",height:"300px",margin:"0 auto 45px",css:function(e){return(0,r._)({border:"2px dashed ".concat(e.colors.GBK09A),borderRadius:4},A&&{borderColor:e.colors.GBL05A,"*":{pointerEvents:"none"}})},onDragOver:function(e){return e.preventDefault()},onDragEnter:function(){return b(!0)},onDragLeave:function(){return b(!1)},onDrop:function(e){e.preventDefault(),O((0,h.Z)(e))},children:[(0,i.tZ)(c.z,{size:90,css:function(e){return{color:A?e.colors.GBL05A:e.colors.GBK09A,marginTop:66}}}),(0,i.tZ)(l.xv,{color:"GBK03A",fontSize:"20px",lineHeight:"28px",fontWeight:"500",mt:"16px",children:"拖放要导入的视频文件"}),(0,i.BX)(l.xu,{mt:"20px",children:[(0,i.tZ)(T.Z,{text:"导入视频",multiple:!1,css:{width:142},zaBlockText:"UploadVideoFile",onFiles:O}),(0,i.tZ)(f.ZP,{preset:"secondary",color:"blue",css:{width:142,marginLeft:12,padding:"0 14px",whiteSpace:"nowrap"},onClick:function(e){d.Z.trackEvent(e.target,{id:8622,action:"Click"},{button:{text:"选择已发布的视频"}}),N()},children:"选择已发布的视频"})]})]}),(0,i.tZ)(E.Z,{})]})]}):null}},77263:function(e,t,n){"use strict";var r=n(85879),o=n(67814),i=n.n(o),a=n(87363),c=n(87641),s=n(69383),u=n(63638),l=n(25452),d=n(66263);t.Z=function(e){var t=e.className,n=e.text,o=e.onFiles,p=e.zaClickId,f=e.zaBlockText,h=e.multiple,_=e.disabled,m=e.preset,g=e.size,T=e.icon,E=e.handleMouseEnter,y=e.handleMouseLeave,C=(0,a.useRef)(null);return(0,r.BX)(r.HY,{children:[(0,r.tZ)(u.ZAClick,{zaText:!0,zaType:"Button",as:c.xu,zaBlock:f,zaAction:"Upload",css:{display:"spread"===g?"block":"inline-block"},onMouseEnter:E,onMouseLeave:y,children:(0,r.tZ)(l.ZP,{className:i()("VideoUploadButton",t),preset:m||"primary",size:g||"spread",color:"blue",disabled:_,icon:T,onClick:function(e){p&&s.Z.trackEvent(e.target,{id:p,action:"Upload"}),C.current.click()},children:n})}),(0,r.tZ)("input",{type:"file",className:"VideoUploadButton-fileInput",ref:C,onChange:function(){o(C.current.files,"Add"),C.current.value=null},accept:d.CZ.VIDEO.join(","),multiple:void 0===h||h})]})}},53438:function(e,t,n){"use strict";var r=n(85879),o=n(24405),i=n(87363),a=n(87641);t.Z=(0,i.memo)(function(e){var t=e.className,n=e.showRuleDesc,i=(0,o.F)().colors;return(0,r.BX)(a.xu,{className:t,css:{fontSize:14,lineHeight:"22px",color:i.GBL05A,textAlign:"center",a:{textDecoration:"underline"}},children:[void 0!==n&&n&&(0,r.BX)(a.kC,{marginTop:34,fontSize:10,width:688,justifyContent:"center",children:[(0,r.BX)(a.xu,{css:{width:"134px"},children:[(0,r.tZ)(a.xv,{css:{color:i.GBK04A,fontWeight:500,marginBottom:6},fontSize:13,children:"视频大小"}),(0,r.tZ)(a.xv,{fontSize:12,lineHeight:1.4,css:{color:i.GBK06A},children:"时长和大小均不限"}),(0,r.tZ)(a.xv,{fontSize:12,lineHeight:1.4,css:{color:i.GBK06A},children:"推荐上传大小为 5G 以内"})]}),(0,r.BX)(a.xu,{css:{width:"340px",position:"relative",margin:"0 40px","&::after,&::before":{content:'""',position:"absolute",width:1,height:20,verticalAlign:"middle",top:"50%",transform:"translate(0,-50%)",backgroundColor:i.GBK09A},"&::after":{left:0},"&::before":{right:0}},children:[(0,r.tZ)(a.xv,{css:{color:i.GBK04A,fontWeight:500,marginBottom:6},fontSize:13,children:"视频分辨率"}),(0,r.tZ)(a.xv,{fontSize:12,lineHeight:1.4,css:{color:i.GBK06A},children:"最大支持 1080P"}),(0,r.tZ)(a.xv,{fontSize:12,lineHeight:1.4,css:{color:i.GBK06A},children:"分辨率超过 1920 *1080，会被压缩为 1920 *1080"})]}),(0,r.BX)(a.xu,{css:{width:"134px"},children:[(0,r.tZ)(a.xv,{css:{color:i.GBK04A,fontWeight:500,marginBottom:6},fontSize:13,children:"视频格式"}),(0,r.tZ)(a.xv,{fontSize:12,lineHeight:1.4,css:{color:i.GBK06A},children:"支持常用视频格式"}),(0,r.tZ)(a.xv,{fontSize:12,lineHeight:1.4,css:{color:i.GBK06A},children:"推荐使用 mp4"})]})]}),(0,r.BX)(a.xv,{marginTop:35,color:i.GBL05A,fontSize:12,children:["上传视频，即代表您已同意"," ",(0,r.tZ)("a",{href:"https://www.zhihu.com/question/20118966",target:"_blank",rel:"noopener noreferrer",css:{color:i.GBL07A},children:"知乎视频使用规范"})," ","与"," ",(0,r.tZ)("a",{href:"https://www.zhihu.com/term/video",target:"_blank",rel:"noopener noreferrer",css:{color:i.GBL07A},children:"《知乎视频用户协议》"})]})]})})},32854:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(9219),s=n(27723),u=n(14914),l=n(87641),d=n(1733),p=n(97476),f=n(25452);function h(e){var t=e.children,n=(0,i._)(e,["children"]);return(0,a.tZ)(d.sN,(0,o._)((0,r._)({css:function(e){return{height:36,display:"flex",alignItems:"center",color:e.colors.GBL05A,fontSize:"14px"}}},n),{children:t}))}t.Z=(0,u.withRouter)(function(e){var t=e.location,n=(0,a.tZ)(f.ZP,{component:l.kC,preset:"plain",color:"gray",alignItems:"center",mr:"20px",children:"切换模式"});return(0,a.BX)(d.ZP,{positionStatus:"fixed",toggler:n,boundary:{padding:16},children:[(0,a.BX)(h,{onClick:p.Gb,children:[(0,a.tZ)(c.Z,{css:{marginRight:6}}),"无障碍"]}),(0,a.BX)(h,{tag:"a",href:(0,p.cg)((null==t?void 0:t.pathname)||""),children:[(0,a.tZ)(s.Z,{css:{marginRight:6}}),"关怀版"]})]})})},97476:function(e,t,n){"use strict";n.d(t,{cg:function(){return c},Gb:function(){return a}}),n(81897);var r=n(87608),o=n(80714);n(85879);var i=new r.xQ;function a(){var e;null===(e=window.aria)||void 0===e||e.start()}function c(e){return"https://".concat(o.Z.wwwHost,"/aria").concat(e)}"undefined"!=typeof window&&(window.RQ_HALW_QDPH=function(){i.next("off")},window.RQ_VWDUW_QDPH=function(){i.next("on")})},31318:function(e,t,n){"use strict";n.d(t,{Z:function(){return ea}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),u=n(85879),l=n(87977),d=n(83921),p=n(67814),f=n.n(p),h=n(35695),_=n(78160),m=n(14168),g=n.n(m),T=n(87363),E=n(44118),y=n(7181),C=n(49899),S=n(98690),I=n(54674),A=n(99878),b=n(87123),w=n(24943),Z=n(64101),x=n(45088),k=n(44250),R=n(82764),N=n(94115),O=n(99495),P=n(69306),D=n(152),L=n(25626),M=n(9539),B=n(28872),U=n(22083),G=n(74296),F=n(46148),H=n(98813),z=n(70362),q=n(98029),V=n(48641),W=n(35273),X=n(79846),K=n(64956),j=n(78110),Y=n.n(j),Q=n(55164),J=n(57477),$=n(94009),ee=n(87641),et=[{key:"hour",title:"时",length:24},{key:"minutes",title:"分",length:60},{key:"second",title:"秒",length:60}],en={hour:"00",minutes:"00",second:"00"},er=function(e){var t=e.value,n=void 0===t?en:t,r=e.onChange,o=(0,$._)((0,T.useState)(n),2),i=o[0],c=o[1],s=(0,T.useCallback)(function(e,t){return function(){var n=(0,J._)((0,Q._)({},i),(0,a._)({},e,t));c(n),null==r||r(n)}},[i,r]);return(0,T.useEffect)(function(){c(n)},[n]),(0,u.tZ)(ee.kC,{mt:"10px",height:"170px",flex:"0 0 100%",children:et.map(function(e){var t=e.key,n=e.title,r=e.length;return(0,u.BX)(ee.xu,{px:"8px",css:function(e){return{borderLeft:"1px solid ".concat(e.colorMod(e.colors.GBL01A).alpha(.1)),textAlign:"center"}},children:[(0,u.tZ)(ee.xv,{fontSize:"12px",lineHeight:"24px",color:"GBL05A",children:n}),(0,u.tZ)(ee.xu,{css:{height:"140px",overflowY:"scroll",cursor:"pointer","&::-webkit-scrollbar":{display:"none"}},children:Array(r).fill().map(function(e,n){var r=Y()(String(n),2,"0"),o=r===i[t];return(0,u.tZ)(ee.xv,{fontSize:"14px",height:"24px",lineHeight:"24px",css:function(e){return(0,Q._)({borderRadius:"4px"},o?{background:e.colors.GBL01A,color:e.colors.GBK99A}:{"&:hover":{background:e.colorMod(e.colors.GBL01A).alpha(.1)}})},onClick:s(t,r),children:r},"".concat(t,"_").concat(r))})})]},t)})})},eo=["日","一","二","三","四","五","六"],ei=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{calendarDate:e.props.defaultCalendarDate||(Array.isArray(e.props.value)?e.props.value[0]:e.props.value),hoveringDate:null,now:new Date}),(0,a._)((0,r._)(e),"handlePrevYearClick",function(){var t=(0,w.Z)(e.state.calendarDate,-1);e.setState({calendarDate:t}),e.props.onCalendarDateChange(t)}),(0,a._)((0,r._)(e),"handlePrevMonthClick",function(){var t=(0,Z.Z)(e.state.calendarDate,-1);e.setState({calendarDate:t}),e.props.onCalendarDateChange(t)}),(0,a._)((0,r._)(e),"handleNextMonthClick",function(){var t=(0,Z.Z)(e.state.calendarDate,1);e.setState({calendarDate:t}),e.props.onCalendarDateChange(t)}),(0,a._)((0,r._)(e),"handleNextYearClick",function(){var t=(0,w.Z)(e.state.calendarDate,1);e.setState({calendarDate:t}),e.props.onCalendarDateChange(t)}),(0,a._)((0,r._)(e),"handleDayClick",function(t){e.setState({calendarDate:t}),e.props.onCalendarDateChange(t),e.props.onChange(t)}),(0,a._)((0,r._)(e),"onTimeChange",function(t){var n=t.hour,r=t.minutes,o=t.second,i=(0,x.Z)((0,k.Z)((0,R.Z)(e.state.calendarDate,Number(n)),Number(r)),Number(o));e.handleDayClick(i)}),(0,a._)((0,r._)(e),"handleDayHover",function(t){e.setState({hoveringDate:t}),e.props.onHover(t)}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.weekStartsOn,o=t.value,i=t.disabledDate,a=t.showToday,c=t.showPrevMonth,s=t.showPrevYear,l=t.showNextMonth,d=t.showNextYear,p=t.showTime,h=t.isFirst,m=this.state,g=m.calendarDate,T=m.hoveringDate,E=m.now,y=(0,N.Z)((0,O.Z)(g),{weekStartsOn:r}),w=(0,P.Z)((0,D.Z)(g),{weekStartsOn:r}),Z=(0,C._)(Array((0,L.Z)(w,y)+1)).map(function(e,t){return(0,M.Z)(y,t)}).reduce(function(e,t){var n=(0,B.Z)(t,y,{weekStartsOn:r});return e[n]=e[n]?(0,C._)(e[n]).concat([t]):[t],e},[]),x=Z[0].map(U.Z),k=Array.isArray(o);return(0,u.BX)("div",{className:f()("Calendar",n,{"Calendar--hasBottomTool":a,"Calendar--showtime":p}),children:[(0,u.BX)("div",{className:"Calendar-topTool",children:[s&&(0,u.tZ)("button",{className:"Calendar-topToolButton Calendar-topToolButton--prevYear",onClick:this.handlePrevYearClick,children:(0,u.tZ)(S.t,{size:20,center:!0})}),c&&(0,u.tZ)("button",{className:"Calendar-topToolButton Calendar-topToolButton--prevMonth",onClick:this.handlePrevMonthClick,children:(0,u.tZ)(I.e,{size:20,center:!0})}),(0,u.tZ)("div",{className:"Calendar-topToolDate",children:(0,_.Z)(g,"yyyy 年 M 月")}),l&&(0,u.tZ)("button",{className:"Calendar-topToolButton Calendar-topToolButton--nextMonth",onClick:this.handleNextMonthClick,children:(0,u.tZ)(A.N,{size:20,center:!0})}),d&&(0,u.tZ)("button",{className:"Calendar-topToolButton Calendar-topToolButton--nextYear",onClick:this.handleNextYearClick,children:(0,u.tZ)(b.r,{size:20,center:!0})})]}),(0,u.BX)("div",{className:"Calendar-date",children:[(0,u.BX)("table",{className:"Calendar-table",cellSpacing:0,children:[(0,u.tZ)("thead",{className:"Calendar-thead",children:(0,u.tZ)("tr",{children:x.map(function(e){return(0,u.tZ)("th",{className:"Calendar-weekName",children:eo[e]},e)})})}),(0,u.tZ)("tbody",{children:Z.map(function(t,n){return(0,u.tZ)("tr",{children:t.map(function(t,n){var r=i(t),a=k?(0,V.Z)(t,o[0])||(0,V.Z)(t,o[1]):(0,V.Z)(t,o),c=!1;if(k){var s=(0,z.Z)(o),l=(0,q.Z)(o);c=(0,W.Z)(t,s)>0&&(0,W.Z)(l,t)>0}return(0,u.tZ)("td",{className:f()("Calendar-day",{"is-hovered":(0,V.Z)(t,T),"is-today":(0,V.Z)(t,E),"is-disabled":r,"is-not-this-month":!(0,X.Z)(t,g),"is-input-date":a,"is-in-range":c}),onClick:function(){r||e.handleDayClick(t)},onMouseEnter:function(){r||e.handleDayHover(t)},onMouseLeave:function(){r||e.handleDayHover(null)},children:(0,K.Z)(t)},n)})},n)})})]}),p&&(0,u.tZ)(er,{value:function(){var e=function(e){return{hour:Y()(String((0,G.Z)(e)),2,"0"),minutes:Y()(String((0,F.Z)(e)),2,"0"),second:Y()(String((0,H.Z)(e)),2,"0")}};if(k){var t=(0,z.Z)(o),n=(0,q.Z)(o);return e(h?t:n)}return e(o)}(),onChange:this.onTimeChange})]}),a&&(0,u.tZ)("div",{className:"Calendar-bottomTool",children:a&&(0,u.tZ)("button",{className:"Calendar-todayButton",onClick:function(){return e.handleDayClick(E)},disabled:i(E),children:"今天"})})]})}}]),n}(T.Component);(0,a._)(ei,"defaultProps",{weekStartsOn:0,disabledDate:function(){return!1},onChange:function(){return!1},onCalendarDateChange:function(){return!1},onHover:function(){return!1},showToday:!0,showPrevMonth:!0,showPrevYear:!0,showNextMonth:!0,showNextYear:!0,showTime:!1}),ei.propTypes={defaultCalendarDate:g().instanceOf(Date),value:g().oneOfType([g().instanceOf(Date),g().arrayOf(g().instanceOf(Date))]),weekStartsOn:g().number,disabledDate:g().func,onChange:g().func,onHover:g().func,showToday:g().bool,showPrevMonth:g().bool,showPrevYear:g().bool,showNextMonth:g().bool,showNextYear:g().bool};var ea=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{isFocused:!1}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.large,o=t.value,i=t.onChange,a=t.isButtonActive,c=t.toggler,s=t.disabledDate,p=t.getContainer,m=t.placeholder,g=t.showIcon,T=t.onClose,C=this.state.isFocused;return(0,u.tZ)(y.Z,{className:f()("DatePicker",n),toggler:c||(0,u.BX)(E.Z,{large:r,className:f()("DatePicker-Button",{"is-active":C||a}),children:[void 0!==g&&g&&(0,u.tZ)(l.i,{center:!0,size:20}),o?_.Z(o,"yyyy/MM/dd"):m,(0,u.tZ)(d.ji,{css:{marginLeft:8}})]}),onOpen:function(){e.setState({isFocused:!0})},onClose:function(){e.setState({isFocused:!1}),null==T||T()},ref:function(t){e.popover=t},placement:"bottom",arrowed:!0,preventCloseOnTarget:!0,getContainer:p,children:(0,u.tZ)(ei,{value:o||h.Z(),onChange:function(t){e.popover.close(),i(t)},disabledDate:s})})}}]),n}(T.Component);(0,a._)(ea,"propTypes",{toggler:g().element,disabledDate:g().func})},61514:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),u=n(85879),l=n(67814),d=n.n(l),p=n(45088),f=n(72280),h=n(66345),_=n(48127),m=n(32293),g=n(96690),T=n(22926),E=n(21619),y=n(71905),C=n(78160),S=n(82764),I=n(74296),A=n(44250),b=n(46148),w=n(33960),Z=n.n(w),x=n(78110),k=n.n(x),R=n(67633),N=n.n(R),O=n(87363),P=n(77880),D=n(31318),L=N()(0,24).map(function(e){return k()(e,2,"0")}),M=N()(0,60).map(function(e){return k()(e,2,"0")}),B=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{value:p.Z(e.props.value,0)}),e}return(0,i._)(n,[{key:"handleChange",value:function(e,t){var n=this.props,r=n.onChange,o=n.min,i=n.max,a=e;o&&f.Z(e,o)&&(a=o),i&&h.Z(e,i)&&(a=i),this.setState({value:a}),r(a,t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.large,o=t.min,i=t.max,a=t.onRef,c=t.showIcon,s=this.state.value,l=o&&_.Z(m.Z(s),m.Z(o)),p=l&&_.Z(g.Z(s),g.Z(o)),w=i&&_.Z(m.Z(s),m.Z(i)),x=w&&_.Z(g.Z(s),g.Z(i));return(0,u.BX)("div",{className:d()("DateTimePicker",n),ref:a,children:[(0,u.tZ)(D.Z,{showIcon:void 0!==c&&c,large:r,value:s,disabledDate:function(e){return!!(o&&f.Z(e,m.Z(o))||i&&h.Z(e,m.Z(i)))},onChange:function(t){e.handleChange(Z()(function(e){return T.Z(e,t.getFullYear())},function(e){return E.Z(e,t.getMonth())},function(e){return y.Z(e,t.getDate())})(s),{date:t})}}),(0,u.tZ)(P.Z,{listClassName:"DateTimePicker-selectList",large:r,value:C.Z(s,"HH"),onChange:function(t){return e.handleChange(S.Z(s,t),{hours:t})},children:L.map(function(e){var t=l&&e<I.Z(o)||w&&e>I.Z(i);return(0,u.tZ)(P.W,{value:e,disabled:t,css:function(e){return{color:t?e.colors.GBK07B:e.colors.GBK02A}}},e)})}),(0,u.tZ)("span",{className:"DateTimePicker-label",children:"时"}),(0,u.tZ)(P.Z,{listClassName:"DateTimePicker-selectList",large:r,value:C.Z(s,"mm"),onChange:function(t){return e.handleChange(A.Z(s,t),{minutes:t})},children:M.map(function(e){var t=p&&e<b.Z(o)||x&&e>b.Z(i);return(0,u.tZ)(P.W,{value:e,disabled:t,css:function(e){return{color:t?e.colors.GBK07B:e.colors.GBK02A}}},e)})}),(0,u.tZ)("span",{className:"DateTimePicker-label",children:"分"})]})}}]),n}(O.Component);t.Z=B},66654:function(e,t,n){"use strict";n.r(t);var r=JSON.parse(document.getElementById("js-clientConfig").textContent);t.default=r},80714:function(e,t,n){"use strict";var r=n(66654);t.Z=r.default},66263:function(e,t,n){"use strict";n.d(t,{AW:function(){return q},An:function(){return A},BR:function(){return f},Bg:function(){return es},CZ:function(){return Y},Dm:function(){return N},G5:function(){return et},If:function(){return y},K9:function(){return O},K_:function(){return u},LA:function(){return H},M:function(){return x},M5:function(){return S},Pw:function(){return _},R8:function(){return M},Sp:function(){return z},T$:function(){return E},TY:function(){return R},Uw:function(){return k},W0:function(){return D},Wy:function(){return C},Xq:function(){return X},aK:function(){return Q},dN:function(){return ei},dd:function(){return ee},fH:function(){return w},hY:function(){return Z},i3:function(){return V},i7:function(){return l},iG:function(){return I},jB:function(){return L},kr:function(){return P},lH:function(){return en},lM:function(){return W},mC:function(){return er},o$:function(){return J},o7:function(){return b},o8:function(){return s},oP:function(){return B},of:function(){return j},ov:function(){return eo},pL:function(){return $},q0:function(){return T},rX:function(){return d},rc:function(){return F},t6:function(){return ec},ur:function(){return G},vg:function(){return p},xR:function(){return K},yK:function(){return h},yc:function(){return eu},zg:function(){return m},zs:function(){return U}});var r=n(87320),o=n(55164),i=n(57477),a=n(88423),c=n(80714),s="1"===c.Z.apollo.enableAsyncDraftConvert,u={"-1":"他",0:"她",1:"他"},l="//www.zhihu.com",d="column"!==c.Z.currentEntry?"":l,p="//zhuanlan.zhihu.com",f=62,h="www.zhihu.com",_={hang:"hang",lock:"lock",ban:"ban",isForceRenamed:"isForceRenamed",isGuest:"isGuest",destroy:"destroy",suicide:"suicide",notBindPhone:"notBindPhone"},m=Object.keys(_).map(function(e){return _[e]}),g={follow:[_.ban,_.isForceRenamed,_.notBindPhone,_.isGuest],report:[_.ban,_.notBindPhone],share:[_.ban,_.isForceRenamed],editProfile:[_.ban,_.isForceRenamed,_.notBindPhone],thank:[_.notBindPhone],deblock:[_.lock],vote:[_.notBindPhone],favlists:[_.notBindPhone],like:[_.notBindPhone],message:[_.notBindPhone],serviceAccountMessage:[_.notBindPhone,_.ban],deletePin:[_.notBindPhone],invite:[_.notBindPhone],getCoupon:[_.notBindPhone],gift:[_.notBindPhone],blockUser:[_.notBindPhone],buy:[_.notBindPhone]},T=Object.keys(g).reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t,m.filter(function(e){return!g[t].includes(e)})))},{}),E={blocking:"因为你已将此人屏蔽，暂时无法进行该操作。您可以进入他的个人主页解除屏蔽。",commentBlocked:"根据对方设置，暂时无法进行评论操作。",blocked:"根据对方设置，暂时无法进行该操作。"},y=2400,C=1e4,S={sina:"3063806388",qqconn:"100490701",wechat:"wx268fcfe924dcb171",mobileWechat:"wx21dd00cd1ccac236"},I="bindPhoneLastAlertTime",A=4039,b=100007,w=1e5,Z=100010,x=100016,k=100017,R=100018,N=100028,O=40312,P=18e4,D=110600,L={add:"annotation",cancel:"annotation_cancel",view:"show_annotation_detail"},M=0,B=1,U=2,G={topic:"Topic",people:"User",column:"Column",collection:"Collection",live:"Live",ebook:"EBook",publication:"EBook",pin:"Pin",article:"Post",answer:"Answer",question:"Question",question_ask:"QuestionAsk",promotion:"Promotion",roundtable:"RoundtableItem",live_course:"LiveCourse",remix_album:"RemixAlbum",search_course:"LiveCourse",search_special:"LiveAlbum",out_link:"ExternalAd",ad:"Ad",album:"RemixAlbum",rewardPeople:"User",zvideo:"Video"},F={answer:"回答",comment:"评论",article:"文章",member:"用户",question:"问题",pin:"想法",zvideo:"视频实体",message:"私信",book_note:"读书笔记",column:"专栏",discussion_review:"众裁观点",favlist:"收藏夹",vip_pin:"笔记",paid_consultation_question:"付费咨询（提问）",paid_consultation_answer:"付费咨询（回答）",zvideo_collection:"视频合集",vip_short_work:"短篇故事"},H={question:"Question",answer:"Answer",comment:"Comment",message:"Message",pin:"Pin",live:"Live",live_message:"LiveMessage",book_review:"BookReview",promotion:"Promotion",column:"Column",theater:"Theater",drama:"Drama",zvideo:"Zvideo",zvideo_collection:"ZvideoCollection",topic:"Topic",collection:"Collection",question_ask:"QuestionAsk",roundtable:"Roundtable",ebook:"EBook",remix_album:"RemixAlbum",live_course:"LiveCourse",ad:"Ad",article:"Post",favlist:"Collection",people:"User",member:"User",publication:"EBook",album:"RemixAlbum",search_course:"LiveCourse",search_special:"LiveAlbum",out_link:"ExternalAd",paid_consultation_question:"Conversation",paid_consultation_answer:"Conversation",activity:"Unknown",live_feedback:"Unknown",live_feedback_reply:"Unknown",infinity:"Unknown",zhihu_daily:"Unknown",market_comment:"Unknown",topic_log:"Unknown",book_note:"Unknown",discussion_review:"Unknown",drama_bullet:"Unknown",drama_statement:"Unknown",bullet:"Unknown",vip_comment:"Unknown",search_suggested_word:"Unknown",zpoll:"Unknown"},z="真诚赞赏，手留余香",q={abuseip:40350,imfrozen:40351,unhuman:40352},V=10,W=20,X="global::enableShortcut",K={alertTimeSpan:3600,canWrite:!1,tip:"应国家法规对于账号实名的要求，进行下一步操作前，需要先完成手机绑定。"},j={NO_AUTH:-1,ENTER_RECRUIT:0,NO_SETTING:1,PASS:2},Y={IMAGE:[".png",".jpeg",".gif",".jpg"],VIDEO:[".3gp",".asf",".avi",".dat",".f4v",".flv",".m4v",".mkv",".mov",".mp4",".mp4v",".mpe",".mpeg",".mpg",".ra",".ram",".rm",".rmvb",".vob",".webm",".wm",".wmv"]},Q={id:"0",urlToken:null,name:"匿名用户",gender:-1,avatarUrl:(0,a.imgUrl)("https://pic1.zhimg.com/v2-d41c2ceaed8f51999522f903672a521f.jpeg","is"),headline:null,badge:null,isOrg:!1,isFollowing:!1,isFollowed:!1,isBlocking:!1,isBlocked:!1};(0,i._)((0,o._)({},Q),{id:null,urlToken:"",name:"知乎用户",avatarUrl:(0,a.imgUrl)("https://pic1.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff.jpeg","is")});var J={answer:["1396303730","1394715943","1309692335","571602599","1405988657","1551858840","528969715","1126833448","1551974986"],question:["329062584","298155229","335633281","344276433","418460881","424224869","423070517"]},$="https://www.zhihu.com/xen/market/vip-privileges",ee=!0,et="zhihumobilesvip",en=["四川","地震"],er={up:1,down:-1,neutral:0},eo={collect_answer:"收藏",up:"赞同",down:"反对",neutral:"取消赞同/反对"},ei={auto_notif:"auto_notif",header:"header",question_header_card:"question_header_card",force_launch_notif:"force_launch_notif",agree:"agree",disagree:"disagree",comment:"comment",star:"star",comment_list:"comment_list",comment_more:"comment_more",more_answers:"more_answers",bottom:"bottom",capsule:"capsule",follow:"follow",write_answer:"write_answer"},ea="auto_notif",ec={expand_answer:"force_launch_notif",expand_answer1:ea,expand_answer2:ea,up:"agree",down:"disagree",comment_answer:"comment",collect_answer:"star"},es=6,eu=["image/png","image/jpeg","image/webp"]},37630:function(e,t,n){"use strict";n.d(t,{Y:function(){return r},b:function(){return o}});var r="・",o="包含AI生成内容"},1641:function(e,t,n){"use strict";n.d(t,{Z:function(){return e4}});var r,o,i,a,c,s=n(20857),u=n(22107),l=n(94707),d=n(87320),p=n(86325),f=n(55164),h=n(85626),_=n(85879),m=n(67814),g=n.n(m),T=n(87363),E=n(92258),y=n(55536),C=n(42559),S=n.n(C),I=n(63638),A=n(57730),b=n(25452),w=function(e){var t=function(t){var n=e(t);if(n)return(t||window.event).returnValue=n,n};return window.addEventListener("beforeunload",t),function(){return window.removeEventListener("beforeunload",t)}},Z=function(e){(0,p._)(n,e);var t=(0,h._)(n);function n(){return(0,u._)(this,n),t.apply(this,arguments)}return(0,l._)(n,[{key:"componentDidMount",value:function(){this.unsubscriber=w(this.props.onUnload)}},{key:"componentWillUnmount",value:function(){this.unsubscriber()}},{key:"render",value:function(){return this.props.children||null}}]),n}(T.Component),x=n(10284),k=n(80714),R=n(26921),N=n(27521),O=n(21379),P=n(21260),D=n(9338),L=n(57477),M=n(30971),B=n(44073),U=n(65733),G=n(84871),F=n.n(G),H=n(31274),z=n(67927),q=n(40195),V=n(62250);q.Kx;var W=n(64512),X=n(65514),K=n(15336),j=n(49910),Y=n(77880),Q=n(48504),J=n(58909),$=n(84210),ee=n(71728),et=(r=r||{},i=(o=T.createContext(r)).Provider,a=o.Consumer,{consume:function(e){return function(t){e=e||function(e){return e};var n=function(n){(0,p._)(o,n);var r=(0,h._)(o);function o(){return(0,u._)(this,o),r.apply(this,arguments)}return(0,l._)(o,[{key:"render",value:function(){var n=this.props,r=n.forwardedRef,o=(0,ee._)(n,["forwardedRef"]);return(0,_.tZ)(a,{children:function(n){return(0,_.tZ)(t,(0,L._)((0,f._)({ref:r},o,e(n)),{onChangeContext:n.onChangeContext}))}})}}]),o}(T.Component);return F()(T.forwardRef(function(e,t){return(0,_.tZ)(n,(0,L._)((0,f._)({},e),{forwardedRef:t}))}),t)}},provide:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e};return function(t){var n=function(n){(0,p._)(o,n);var r=(0,h._)(o);function o(){var t;return(0,u._)(this,o),t=r.apply(this,arguments),(0,d._)((0,s._)(t),"state",(0,f._)({},"function"==typeof e?e(t.props):e)),(0,d._)((0,s._)(t),"handleChange",function(e,n){return t.setState(e,n)}),t}return(0,l._)(o,[{key:"render",value:function(){return(0,_.tZ)(i,{value:(0,f._)({onChangeContext:this.handleChange},this.state),children:(0,_.tZ)(t,(0,L._)((0,f._)({},this.props,this.state),{onChangeContext:this.handleChange}))})}}]),o}(T.Component);return F()(n,t)}}}),en=et.provide,er=et.consume,eo=function(e){(0,p._)(n,e);var t=(0,h._)(n);function n(){var e;return(0,u._)(this,n),e=t.apply(this,arguments),(0,d._)((0,s._)(e),"handleChange",function(t){return e.props.onChangeContext({brandId:t})}),e}return(0,l._)(n,[{key:"render",value:function(){var e=this.props,t=e.brandId,n=e.data,r=n&&n.payload&&n.payload.data||[];return(0,_.tZ)(Y.Z,(0,L._)((0,f._)({className:"AskBrand",listClassName:"AskBrand--list"},!t&&{text:(0,_.tZ)("span",{className:"AskBrand-text",children:"选择品牌"})}),{value:t,onChange:this.handleChange,children:r.map(function(e){return(0,_.tZ)(Y.W,{value:e.id,text:(0,_.BX)("span",{className:"AskBrand-text",children:[e.name,e.clickInfo&&e.clickInfo.target&&e.clickInfo.target.isOrg&&(0,_.tZ)(j.xV,{size:24,"aria-label":"已认证账号"})]})},e.id)})}))}}]),n}(T.Component),ei=(0,y.compose)((0,E.connect)(function(e){return{currentUser:(0,J.ib)(e)}}),(c={load:function(e){return e.dispatch((0,$.R8)(e.currentUser.urlToken))}},function(e){var t=c.load,n=function(n){(0,p._)(o,n);var r=(0,h._)(o);function o(){var e;return(0,u._)(this,o),e=r.apply(this,arguments),(0,d._)((0,s._)(e),"state",{isFetching:!1,isDrained:!1,error:null,data:null}),(0,d._)((0,s._)(e),"load",function(){e.setState({isFetching:!0}),t(e.props).then(function(t){return e.setState({isFetching:!1,isDrained:!0,data:t})}).catch(function(t){return e.setState({isFetching:!1,error:t})})}),e}return(0,l._)(o,[{key:"render",value:function(){return(0,_.tZ)(e,(0,L._)((0,f._)({},this.props,this.state),{load:this.load}))}}]),o}(T.Component);return F()(n,e)}),(0,Q.Z)({load:function(e){return e.load()}}),er(function(e){return{brandId:e.brandId}}))(eo),ea=function(e){(0,p._)(n,e);var t=(0,h._)(n);function n(){return(0,u._)(this,n),t.apply(this,arguments)}return(0,l._)(n,[{key:"render",value:function(){return(0,_.BX)("div",{className:"AskBrandTitle",children:[(0,_.tZ)("h2",{className:"AskBrandTitle-main",children:"品牌提问"}),(0,_.tZ)("div",{className:"AskBrandTitle-sub",children:"创建前请先与商务确认订单，如未确认联系 ad@zhihu.com"})]})}}]),n}(T.Component),ec=n(80660),es=n(70228),eu=n(94902),el=n(93975),ed=n(93406),ep=n(22701),ef=n(84071),eh=n(69578),e_=n(35102),em=n(65744),ev=n(9278),eg=n(94009),eT=n(72111),eE=n(80565),ey=n(91850),eC=n(88286),eS=n(85761),eI=n(67136),eA=n(87641),eb={REPEAT:1,LOW:2,SIMILAR:3},ew=function(e){return(0,_.tZ)(eA.xu,(0,f._)({className:"AskQuestionTips-TipCardWrapper",py:"4px",css:function(e){return{borderRadius:"3px",border:"1px solid ".concat(e.colors.MapUIFrame09A),"&+.AskQuestionTips-TipCardWrapper":{marginTop:"8px"}}}},e))},eZ=function(e){return(0,_.tZ)(eA.kC,(0,f._)({px:"8px",py:"4px",alignItems:"center"},e))},ex=function(e){var t=e.type,n=(0,ee._)(e,["type"]);return(0,_.tZ)(eA.xv,(0,f._)({css:function(e){return{color:t===eb.REPEAT?e.colors.MapCriticalTip:e.colors.MapText06A,lineHeight:"14px",fontSize:"12px"}}},n))},ek=function(e){var t=e.data,n=t.title,r=t.footerLeft,o=t.footerRight,i=t.routeUrl,a=t.questionToken,c=e.index;return(0,_.BX)(eT.pl,{target:"_blank",href:i,zaModuleId:"search_similar_question_card",zaModuleIndex:c,zaType:"Card",view:{elementLocation:{content:{type:"Question",token:a}}},shouldTrackShow:!0,css:{padding:"4px 8px",display:"block"},children:[(0,_.tZ)(eA.xv,{color:"MapText03A",css:(0,f._)({lineHeight:"19px",fontSize:"13px",fontWeight:"500"},(0,eE.S)(1)),children:n}),(0,_.BX)(eA.kC,{alignItems:"center",lineHeight:"14px",fontSize:"10px",children:[(0,_.tZ)(eA.xv,{color:"MapText06A",children:r}),(0,_.BX)(eA.xv,{ml:"auto",display:"flex",alignItems:"center",color:"MapBrand",css:{lineHeight:"14px",cursor:"pointer"},children:[o,(0,_.tZ)(eC.Z,{size:"12px",ml:"4px",css:{transform:"rotate(90deg)"}})]})]})]})},eR=function(e){var t,n,r=e.data,o=e.focusArea,i=(0,T.useRef)();(0,T.useEffect)(function(){var e;r&&(null===(e=i.current)||void 0===e||e.scrollIntoView())},[r]);var a=(0,eg._)((0,ey.k)(function(){return!o||"title"===o}),2),c=a[0],s=a[1],u=(0,T.useRef)(!1);if((0,T.useEffect)(function(){o&&(u.current||("title"===o?s.on():s.off()))},[o,s]),!r||!r.large&&!r.small)return null;var l=(null===(t=r.large)||void 0===t?void 0:null===(n=t.items)||void 0===n?void 0:n.filter(Boolean).length)>0,d=r.large?r.small?c?r.large:r.small:r.large:r.small;return(0,_.tZ)(I.ZAEnv,{extra:{attachedInfoBytes:r.attachedInfo},children:(0,_.tZ)(eA.xu,{mb:"12px",ref:i,children:(0,_.BX)(ew,{children:[(0,_.BX)(eZ,{children:[(0,_.tZ)(ex,{type:r.type,children:d.title}),d.buttonText&&(0,_.BX)(eT.pl,{zaModuleId:"view_summary_jump_url",target:"_blank",href:d.buttonRouteUrl,ml:"8px",display:"flex",color:"MapAI",css:{lineHeight:"16px",cursor:"pointer",fontSize:"12px"},children:[d.buttonText,(0,_.tZ)(eS.Z,{size:"14px",css:{marginLeft:"2px"}})]}),l&&(0,_.BX)(I.ZAClick,{as:eA.xv,zaType:"Button",zaAction:c?"Collapse":"Expand",zaModuleId:"similar_question_block_expand",ml:"auto",display:"flex",alignItems:"center",color:"MapText06A",css:{lineHeight:"14px",cursor:"pointer",fontSize:"10px"},onClick:function(){s.toggle(),u.current=!0},children:[c?"收起":"展开",(0,_.tZ)(eC.Z,{size:"12px",ml:"4px",css:!c&&{transform:"rotate(180deg)"}})]})]}),l&&(0,_.tZ)(eI.Collapse,{isOpened:c,children:r.large.items.filter(Boolean).slice(0,2).map(function(e,t){return(0,_.tZ)(ek,{data:e,index:t},String([e.title,t]))})})]})})})},eN=n(85456),eO=n.n(eN),eP=n(69383),eD=n(5171),eL=n(83589),eM=function(e){(0,p._)(n,e);var t=(0,h._)(n);function n(){var e;return(0,u._)(this,n),e=t.apply(this,arguments),(0,d._)((0,s._)(e),"state",{changed:!1}),(0,d._)((0,s._)(e),"updateTopicsFromKeyword",eO()(function(t){e.updateTopicsFromKeyword.abort&&e.updateTopicsFromKeyword.abort.abort(),e.updateTopicsFromKeyword.abort=new AbortController;var n=e.props,r=n.loadMatchTopics,o=n.onChangeContext;r({text:t,signal:e.updateTopicsFromKeyword.abort.signal}).then(function(e){o({topics:e.payload.data.slice(0,3)})})},2e3,{leading:!1,trailing:!0})),(0,d._)((0,s._)(e),"handleChange",function(t){var n=e.props.onChangeContext,r=e.validate(t);r||e.setState({changed:!0}),n({topics:t,topicsTip:r}),r?e.focus():e.deactivated()}),(0,d._)((0,s._)(e),"handleRemove",function(){return eP.Z.trackEvent((0,s._)(e),{id:2466,action:"Delete"})}),(0,d._)((0,s._)(e),"deactivated",function(){e.props.activated&&e.props.toggleActivated()}),(0,d._)((0,s._)(e),"validate",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.value;return(0,eL.Fw)(t)}),(0,d._)((0,s._)(e),"focus",function(){return e.topicsInput&&e.topicsInput.focus()}),e}return(0,l._)(n,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.keyword,r=t.onChangeContext;if(n!==e.keyword&&!this.state.changed){if(!n){r({topics:[]});return}n.length>=4&&this.updateTopicsFromKeyword(n)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.value,r=t.activated;return(0,_.tZ)(eD.Z,{actived:r,inputProps:{className:"AskTopics-input"},onRef:function(t){e.topicsInput=t},value:void 0===n?[]:n,onChange:this.handleChange,onRemove:this.handleRemove,onToggleActived:this.props.toggleActivated,showAddButton:!1,css:{paddingTop:"4px",minHeight:"38px"}})}}]),n}(T.Component),eB=(0,y.compose)((0,E.connect)(null,{loadMatchTopics:X.$X}),er(function(e){return{keyword:e.title,value:e.topics||[]}}))(eM),eU=function(e){(0,p._)(n,e);var t=(0,h._)(n);function n(){var e;return(0,u._)(this,n),e=t.apply(this,arguments),(0,d._)((0,s._)(e),"state",{toolBarShown:!1,topicInputActivated:!1,currentLinkTextReplacedInfo:null}),(0,d._)((0,s._)(e),"tipsArea",(0,T.createRef)()),(0,d._)((0,s._)(e),"focus",function(){return e.editable&&e.editable.focus()}),(0,d._)((0,s._)(e),"toggleTopicInputActivated",function(){e.setState({topicInputActivated:!e.state.topicInputActivated})}),(0,d._)((0,s._)(e),"bindTopic",function(){e.state.topicInputActivated||e.toggleTopicInputActivated()}),(0,d._)((0,s._)(e),"insertMention",function(){e.editable&&e.editable.handleKeyCommand("insert-mention")}),(0,d._)((0,s._)(e),"triggerImageUpload",function(){e.editable&&e.editable.handleKeyCommand("insert-image")}),(0,d._)((0,s._)(e),"triggerVideoUpload",function(){e.editable&&e.editable.handleKeyCommand("insert-video")}),(0,d._)((0,s._)(e),"handleChange",function(t){var n=e.props.onChangeContext;n&&n({detail:t})}),(0,d._)((0,s._)(e),"handleBlur",function(t){var n=e.validate();(0,e.props.onChangeContext)({detailTip:n});var r=e.props.onBlur;r&&r(t)}),(0,d._)((0,s._)(e),"handlekDescriptionClick",function(t){var n;t.currentTarget.contains(t.target)&&((null===(n=e.tipsArea.current)||void 0===n?void 0:n.contains(t.target))||!e.editable||e.editable.focus(!1))}),(0,d._)((0,s._)(e),"handleToggleToolbar",function(){return e.setState({toolBarShown:!e.state.toolBarShown})}),(0,d._)((0,s._)(e),"handleRef",function(t){return e.editable=t}),(0,d._)((0,s._)(e),"handleUploadError",function(t,n){switch(n){case"video":e.handleError("video-upload-error");break;case"image":e.handleError("image-upload-error",t)}}),(0,d._)((0,s._)(e),"handleError",function(e,t){return(0,e_.Xc)(e,t,em.t)}),(0,d._)((0,s._)(e),"checkIfCanUpload",function(){return e.props.canUpload}),(0,d._)((0,s._)(e),"hasVideo",function(){return e.editable&&e.editable.hasVideo()}),(0,d._)((0,s._)(e),"canExit",function(){return e.editable&&e.editable.hasVideo("upload")?(0,em.y)("关闭弹窗将丢失上传中的视频内容"):Promise.resolve()}),(0,d._)((0,s._)(e),"validate",function(){return(0,eL.Op)(e.editable)}),(0,d._)((0,s._)(e),"validateAndNotice",function(){var t=e.validate();return!!t&&("fatal"===t.level?A.Z.alert(t.text,{title:t.title}):(0,em.t)(t.text),e.focus(),t)}),(0,d._)((0,s._)(e),"handleReplaceLinkText",function(t){e.setState({currentLinkTextReplacedInfo:t})}),(0,d._)((0,s._)(e),"getLinkTextReplacedInfo",function(){var t=e.state.currentLinkTextReplacedInfo;return t&&e.setState({currentLinkTextReplacedInfo:null}),t}),(0,d._)((0,s._)(e),"createEditorPlugins",function(){return[(0,ef.Z)({scene:"question",contentToken:"",traceId:e.props.traceId,getLinkTextReplacedInfo:e.getLinkTextReplacedInfo})]}),(0,d._)((0,s._)(e),"handleFocus",function(t){e.props.onChangeContext({focusArea:"description"});var n=e.props.onFocus;n&&n(t)}),e}return(0,l._)(n,[{key:"render",value:function(){var e=this.state,t=e.toolBarShown,n=e.topicInputActivated,r=this.props,o=r.value,i=r.submitBtn,a=r.topicsCount,c=r.questionTips,s=r.focusArea,u=a>4,l=u?"最多绑定5个话题":"绑定相关话题可以被更多人看到";return(0,_.BX)("div",{className:"AskDetail",children:[(0,_.tZ)("div",{className:"AskDetail-inputWrapper",onClick:this.handlekDescriptionClick,css:{height:t?263:168,marginBottom:"12px"},children:(0,_.BX)("div",{ref:this.tipsArea,children:[(0,_.tZ)(eR,{data:c,focusArea:s}),(0,_.tZ)(eh.Z,{allowMention:!0,placeholder:"输入问题背景、条件等详细信息（选填）",className:"AskDetail-input",css:{"&.InputLike":{border:"none"},".Editable-content":{padding:"0",minHeight:"unset !important"},".Editable-toolbar":{border:"1px solid var(--GBK09A)",borderRadius:"3px",marginBottom:"12px"}},ref:this.handleRef,allowDragAndDrop:!0,allowLinkCard:!0,minRows:2,allowToolbar:t,allowHeaderThree:!1,allowVideoTitleChange:!0,defaultValue:o&&o.toHTML({source:"AskDetail_render"}),onChange:this.handleChange,onError:this.handleError,onUploadError:this.handleUploadError,onBeforeVideoUpload:this.checkIfCanUpload,onBlur:this.handleBlur,onFocus:this.handleFocus,editingContentType:"question",videoSource:"question",onReplaceLinkText:this.handleReplaceLinkText,createEditorPlugins:this.createEditorPlugins,mentionSuggestionConfig:this.props.mentionSuggestionConfig})]})}),(0,_.tZ)(eB,{activated:n,toggleActivated:this.toggleTopicInputActivated}),(0,_.BX)("div",{className:"Ask-footer",children:[(0,_.tZ)("div",{className:"AskDetail-actionsWrapper",children:(0,_.BX)("div",{className:"AskDetail-actions",css:{".Editable-control":{margin:"0",marginRight:"24px"}},children:[(0,_.tZ)("span",{"data-tooltip":l,"aria-label":l,"data-tooltip-position":"bottom",children:(0,_.tZ)(I.ZAClick,{zaType:"Button",zaModuleId:"add_topic_button",as:ep.hA,label:"",isActive:n,icon:ec.Z,disabled:u,onClick:this.bindTopic})}),(0,_.tZ)(I.ZAClick,{zaType:"Button",zaModuleId:"at_user",as:ep.hA,label:"提到用户并通知对方",icon:es.Z,onClick:this.insertMention}),(0,_.tZ)(ep.hA,{label:"添加更多描述文本样式",isActive:t,icon:eu.ZP,onClick:this.handleToggleToolbar}),(0,_.tZ)(ep.hA,{label:"上传相关图片",icon:el.Z,onClick:this.triggerImageUpload}),(0,_.tZ)(ep.hA,{label:"上传相关视频",icon:ed.Z,onClick:this.triggerVideoUpload})]})}),i]})]})}}]),n}(T.Component),eG=(0,y.compose)((0,ev.Fd)({scene:ev.xK.QuestionEditor}),er(function(e){var t=e.detail,n=e.topics,r=e.questionTips,o=e.focusArea;return{value:t&&t.toHTML?t:{toHTML:function(){return t}},topicsCount:(n||[]).length,questionTips:r,focusArea:o}}))(eU),eF=n(64514),eH=n(32336),ez=n(85423),eq=n(63276),eV=function(e){return(0,_.tZ)(eA.kC,(0,f._)({color:"MapBrand",alignItems:"center",css:{fontWeight:"500"},mr:"4px"},e))},eW=function(e){return(0,_.tZ)(eA.kC,(0,f._)({color:"MapText06A",mb:"8px",css:{fontSize:"13px",lineHeight:"19px"}},e))},eX=function(e){var t=e.onClickOutside,n=(0,T.useRef)(null);return!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=(0,T.useRef)({boundaryRef:t,callback:e});(0,T.useEffect)(function(){n.current={boundaryRef:t,callback:e}}),(0,T.useEffect)(function(){var e=function(e){var t,r=n.current,o=r.boundaryRef,i=r.callback;null!==o&&(null==o?void 0:null===(t=o.current)||void 0===t?void 0:t.contains(e.target))||i(e)};return document.body.addEventListener("click",e),function(){document.body.removeEventListener("click",e)}},[])}(t,n),(0,_.BX)("div",{className:"AskGuide-content",ref:n,css:function(e){return{padding:"12px 12px 4px",borderRadius:"3px",border:"1px solid ".concat(e.colors.MapUIFrame09A),marginBottom:"16px"}},children:[(0,_.BX)(eW,{children:[(0,_.BX)(eV,{children:[(0,_.tZ)(eF.Z,{size:"16px",css:{marginRight:"4px"}}),"规范准确"]}),"规范使用语句标点清晰表述"]}),(0,_.BX)(eW,{children:[(0,_.BX)(eV,{children:[(0,_.tZ)(eH.Z,{size:"16px",css:{marginRight:"4px"}}),"讨论价值"]}),"鼓励专业、实用、脑洞等价值讨论"]}),(0,_.BX)(eW,{children:[(0,_.BX)(eV,{children:[(0,_.tZ)(ez.Z,{size:"16px",css:{marginRight:"4px"}}),"客观公开"]}),"谨慎暴露隐私，理性陈述问题"]})]})},eK=function(e){var t=e.submitBtn,n=(0,eg._)((0,ey.k)(!1),2),r=n[0],o=n[1];return(0,_.BX)(eA.kC,{css:{height:149},flexDirection:"column",justifyContent:"flex-end",children:[r&&(0,_.tZ)(eX,{onClickOutside:o.toggle}),(0,_.BX)("div",{className:"Ask-footer",children:[(0,_.BX)("div",{onClick:o.toggle,css:function(e){return{color:r?e.colors.MapBrand:e.colors.MapInfoSub,lineHeight:"16px",fontSize:"12px",display:"flex",alignItems:"center",cursor:"pointer"}},children:[(0,_.tZ)(eq.Z,{css:{marginRight:"4px"}}),"如何更好地提问？"]}),t]})]})},ej=n(30722),eY=n(9887),eQ=n(92868),eJ=function(e){return(0,_.tZ)("div",{style:{textAlign:"right",minHeight:"14px",lineHeight:0},children:(0,_.tZ)("span",{className:g()("AskFieldTip",(0,d._)({},"AskFieldTip--".concat(e.level),e.level)),children:e.text})})},e$={default:17,smaller:16},e0=function(e){return(e||"").replace(/(\?|？)+$/,"")},e1=function(e){(0,p._)(n,e);var t=(0,h._)(n);function n(){var e;return(0,u._)(this,n),e=t.apply(this,arguments),(0,d._)((0,s._)(e),"state",{fontSize:e$.default,items:[],rows:1,pos:0}),(0,d._)((0,s._)(e),"appended",!1),(0,d._)((0,s._)(e),"focus",function(){return e.input&&e.input.focus()}),(0,d._)((0,s._)(e),"handleKeyDown",function(e){13===e.keyCode&&e.preventDefault()}),(0,d._)((0,s._)(e),"handleSelect",function(e,t){window.open("/question/".concat(t.urlToken,"?q=").concat(e),"_self")}),(0,d._)((0,s._)(e),"handleFocus",function(t){e.change(t.target.value),e.setState({focused:!0}),e.props.onChangeContext({focusArea:"title"});var n=e.props.onFocus;n&&n(t)}),(0,d._)((0,s._)(e),"handleBlur",function(t){var n=t.target.value;n.length>0&&-1===n.indexOf("?")&&-1===n.indexOf("？")&&(n+="？"),e.change(n),e.setState({focused:!1})}),(0,d._)((0,s._)(e),"handleDivRef",function(t){e.div=t}),(0,d._)((0,s._)(e),"handleChange",function(t){e.props.questionTips&&e.props.onChangeContext({questionTips:null}),e.change(t.target.value)}),(0,d._)((0,s._)(e),"change",function(t){var n=e.props,r=n.onChangeContext,o=n.value;t!==o&&(r({title:t,titleTip:e.validate(t)}),e0(t)!==e0(o)&&((null==t?void 0:t.length)>=4?e.updateItems(t):e.setState({items:[]})))}),(0,d._)((0,s._)(e),"updateItems",eO()(function(t){return e.updateItems.abort&&e.updateItems.abort.abort(),e.updateItems.abort=new AbortController,e.props.onChangeContext({questionTips:null}),e.props.loadQuestionTips({title:t,signal:e.updateItems.abort.signal}).then(function(t){var n;e.props.onChangeContext({questionTips:null==t?void 0:null===(n=t.payload)||void 0===n?void 0:n.data})})},2e3)),(0,d._)((0,s._)(e),"updateHeight",function(){if(e.input&&e.div){var t=e.props,n=t.line,r=t.onChangeLine,o=e.div.scrollHeight,i=n;(i=o>=81?3:o<81&&o>=54?2:1)!==n&&r(i)}}),(0,d._)((0,s._)(e),"validate",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.props.value,n=(0,eL.uq)(t||""),r=e.props.onError;return r&&r(n),n}),(0,d._)((0,s._)(e),"renderLabel",function(e){return(0,_.BX)("div",{className:"AskTitle-suggestionClose",children:[(0,_.tZ)("span",{children:e}),(0,_.tZ)(b.ZP,{preset:"plain",children:"关闭"})]})}),(0,d._)((0,s._)(e),"renderItem",function(t){var n=e.props.value;return(0,_.BX)("a",{className:"AskTitle-suggestionItemLink",href:"//www.zhihu.com/question/".concat(t.urlToken,"?q=").concat(n),children:[(0,_.tZ)("span",{className:"AskTitle-suggestionItemTitle",dangerouslySetInnerHTML:{__html:t.name}}),(0,_.BX)("span",{className:"AskTitle-suggestionItemDesc",children:[(0,ej.uf)(t.answersCount)," 个回答"]})]},t.urlToken)}),e}return(0,l._)(n,[{key:"componentDidMount",value:function(){var e=this;this.updateHeight(),setTimeout(function(){e.focus();var t=e.props.onFocus;t&&t()})}},{key:"componentDidUpdate",value:function(e){e.value!==this.props.value&&(this.updateHeight(),this.validate())}},{key:"render",value:function(){var e=this,t=this.state,n=t.focused,r=t.fontSize,o=this.props,i=o.value,a=o.line,c=o.tip,s=o.questionTips,u=o.hasContent,l=!!((null==s?void 0:s.large)||(null==s?void 0:s.small)),d={required:!0,multiline:!0,rows:a,spread:!0,large:!0,placeholder:"写下你的问题，准确地描述问题更容易得到解答",className:"AskTitle-input",onKeyDown:this.handleKeyDown,style:{fontSize:r}};return(0,_.BX)(T.Fragment,{children:[(0,_.BX)("div",{className:"AskTitle",children:[(0,_.tZ)("div",{className:"AskTitle-text",ref:this.handleDivRef,css:{lineHeight:"27px",fontSize:r},children:i}),(0,_.tZ)(eY.Z,(0,L._)((0,f._)({value:i,autoFocus:!0,onChange:this.handleChange,ref:function(t){return e.input=t}},d),{onBlur:this.handleBlur,onFocus:this.handleFocus}))]}),(0,_.tZ)(eJ,(0,f._)({},n&&(!c||c.ignoreInInput)?{text:(0,_.tZ)(eQ.Z,{current:i?i.length:0,max:eL.S8,name:""})}:c)),(0,_.tZ)("div",{css:function(e){return{borderBottom:"1px solid ".concat(i&&!l&&u?n?e.colors.MapBrand:e.colors.MapUIFrame09A:"transparent"),marginTop:"2px",marginLeft:"-52px"}}})]})}}]),n}(T.Component),e2=(0,y.compose)((0,E.connect)(null,{loadQuestionTips:X.oq}),er(function(e){return{value:e.title||"",tip:e.titleTip,questionTips:e.questionTips}}))(e1),e3=function(e){(0,p._)(n,e);var t=(0,h._)(n);function n(){var e;return(0,u._)(this,n),e=t.apply(this,arguments),(0,d._)((0,s._)(e),"state",{line:1,submitting:!1,guideShown:!1}),(0,d._)((0,s._)(e),"zaRef",(0,T.createRef)()),(0,d._)((0,s._)(e),"traceId",String([Date.now(),S()()])),(0,d._)((0,s._)(e),"createAskFormRef",function(t){e.form=t}),(0,d._)((0,s._)(e),"askDetail",(0,T.createRef)()),(0,d._)((0,s._)(e),"handleChangeLine",function(t){return e.setState({line:t})}),(0,d._)((0,s._)(e),"handleUnload",function(){if(!(0,O.y)()){var t=e.props,n=t.topics,r=t.title,o=t.detail;(0,eL.Mu)({title:r,topics:n,detail:o&&o.toHTML?o.toHTML({source:"Ask_handleUnload"}):o})}}),(0,d._)((0,s._)(e),"handleSuccess",function(){var t=e.props.publishErrorReporter;null==t||t.safeRecordStageStart("post-publish"),(0,O.y)()||(0,eL.Mu)({title:null,topics:null,detail:null});var n=e.props,r=n.onSuccess,o=n.id;r?r({id:o}):location.href="//".concat(k.Z.wwwHost,"/question/").concat(o)}),(0,d._)((0,s._)(e),"handleSubmit",function(){if(e.checkSubmittable()){e.setState({submitting:!0});var t=e.props.publishErrorReporter;null==t||t.startFreshReport("question","Ask"),requestAnimationFrame(function(){e.doSubmit().then(e.handleSuccess).catch(function(e){throw null==t||t.safeReport(e,"catch in submit promise"),e}).finally(function(){e.setState({submitting:!1})})})}}),(0,d._)((0,s._)(e),"setTitle",function(){var t=e.props.setTitle;if(t){var n=e.props.currentUser.isOrg,r=e.props.questionType;n&&((0,eL.cr)(r)?t("创建品牌提问",(0,_.BX)("p",{children:["创建前请先与商务确认订单，如未确认联系"," ",(0,_.tZ)("a",{href:"mailto:ad@zhihu.com",children:"ad@zhihu.com"})]})):t("创建社区提问",(0,_.BX)("div",{children:["描述精确的问题更易得到解答",(0,_.tZ)("a",{href:"/question/19806261",target:"_blank",children:"知乎社区提问规范"})]}))),t("写下你的问题","描述精确的问题更易得到解答")}}),(0,d._)((0,s._)(e),"canExit",function(){var t=e.askDetail&&e.askDetail.current;if((0,O.y)()){var n,r=e.props,o=r.title,i=r.detail,a=r.topics;return o||(null==i?void 0:null===(n=i.toHTML)||void 0===n?void 0:n.call(i,{source:"Ask_canExit"}))||a&&a.length?new Promise(function(e,t){A.Z.confirm((0,_.tZ)(x.A,{}),{text:{ok:"放弃",cancel:"继续编辑"}}).then(function(){return e()},function(){return t()})}):Promise.resolve()}return e.handleUnload(),t&&t.canExit()}),(0,d._)((0,s._)(e),"checkSubmittable",function(){var t=e.props,n=t.titleTip,r=t.topicsTip;if(n&&n.blockSubmit)return!1;var o=e.askDetail&&e.askDetail.current;return!(o&&o.validateAndNotice())&&(!r||!r.blockSubmit)}),(0,d._)((0,s._)(e),"disabled",function(){var t=e.props,n=t.title,r=t.titleTip,o=t.topicsTip;return!n||r&&r.blockSubmit||o&&o.blockSubmit}),(0,d._)((0,s._)(e),"toggleGuideShown",function(){e.setState({guideShown:!e.state.guideShown})}),e}return(0,l._)(n,[{key:"componentDidMount",value:function(){var e,t,n=this;null===(e=this.props.writeShield)||void 0===e||null===(t=e.setOnModalClose)||void 0===t||t.call(e,function(){var e,t;null===(t=(e=n.props).onClose)||void 0===t||t.call(e)}),(0,O.y)()||this.props.onChangeContext((0,eL.kA)(),this.checkSubmittable),this.setTitle(),this.props.imperativeRef&&(this.props.imperativeRef.current={canExit:this.canExit.bind(this)})}},{key:"componentWillUnmount",value:function(){this.timeout&&clearTimeout(this.timeout),this.props.imperativeRef&&(this.props.imperativeRef.current=null)}},{key:"doSubmit",value:function(){var e=this.props,t=e.brandId,n=e.questionType,r=e.questionContentPublish,o=e.title,i=e.topics,a=e.detail,c=e.isAnonymous,s=this.props.publishErrorReporter,u=new N.y;u.set("publish",{traceId:this.traceId}),u.set("title",{title:o}),u.set("topic",{topics:i.map(function(e){return{topic_name:e.name,topic_token:e.urlToken||e.id}})}),null==s||s.safeRecordParamCollected("topic",i.length);var l=a&&a.toHTML?a.toHTML({source:"Ask_doSubmit"}):a,d=l&&l.html?l.html:l;null==s||s.safeRecordParamCollected("html",null==d?void 0:d.length);var p="string"==typeof d?d:"";u.set("hybrid",{html:p,textLength:(0,P.V)(p)}),u.setExtraInfo("publisher","pc"),u.set("questionConfig",{brand_id:String(t),type:String((0,eL.A3)(n))}),void 0!==c&&u.set("anonymity",{isAnonymity:c});var f=u.build();return null==s||s.safeRecordStageStart("publish",{hitContentPublish:!0}),r.publish(f)}},{key:"render",value:function(){var e,t=this.state,n=t.line,r=t.submitting,o=this.props,i=o.questionType,a=o.brandId,c=o.title,s=o.detail,u=o.topics,l=o.isAnonymous,d=(0,eL.cr)(i),p=!!(c||(null==s?void 0:null===(e=s.toHTML)||void 0===e?void 0:e.call(s,{source:"Ask_render"}))||u&&u.length),f=(0,_.tZ)("div",{className:"Ask-footer-buttonWrapper",children:(0,_.tZ)(I.ZAClick,{as:b.ZP,zaType:"Button",zaText:!0,zaAction:"Question",zaModuleId:"published_button",extra:{configMap:{traceId:this.traceId,type:"Question",publish_type:"newPublish"}},preset:"primary",color:"blue",disabled:r||this.disabled(),onClick:this.handleSubmit,children:r?"发布中...":"发布问题"})}),h=(0,_.BX)("div",{className:"Ask-items",children:[(0,_.BX)("div",{className:g()("Ask-titleWrapper"),css:{marginBottom:"6px",display:"flex",flexDirection:"row"},children:[(0,_.tZ)(K.Z,{isAnonymous:l,questionType:i,brandId:a,css:{float:"left",marginTop:"6px",marginRight:"12px",flex:"0 0 auto"}}),(0,_.tZ)("div",{className:"Ask-title",css:{flex:"1 1 auto"},children:(0,_.tZ)(e2,{line:n,onChangeLine:this.handleChangeLine,hasContent:p})})]}),!p&&(0,_.tZ)(eK,{submitBtn:f}),p&&(0,_.tZ)(eG,{ref:this.askDetail,canUpload:!l,submitBtn:f,traceId:this.traceId})]});return(0,_.BX)("form",{ref:this.createAskFormRef,className:"Ask-form",onSubmit:function(e){return e.preventDefault()},noValidate:!0,children:[(0,_.tZ)(I.ZAShow,{zaType:"Popup",zaModuleId:"pc_question_editor_popup"}),(0,_.tZ)(I.ZARef,{ref:this.zaRef}),d&&(0,_.BX)("div",{className:"Ask-header",children:[(0,_.tZ)(ea,{}),(0,_.tZ)(ei,{})]}),h,(0,_.tZ)(Z,{onUnload:this.handleUnload})]})}}]),n}(T.Component),e4=(0,y.compose)((0,R.ZP)({init:!0,getScene:function(){return{type:"question"}}}),en(),(0,E.connect)(function(e){return(0,f._)({},e.common.ask)},{askQuestion:X.jt}),function(e){var t=function(t){var n,r,o,i=(n=(0,V.u)("question","Ask"),r=(0,E.useDispatch)(),o=(0,E.useStore)(),{publish:(0,U.A)(function(e){var t,o,i=(t=(0,D._)(function(e){return(0,M.__generator)(this,function(t){throw r((0,z.c0)((0,B.n$)(e),"red")),e})}),function(e){return t.apply(this,arguments)}),a=(o=(0,D._)(function(e){return(0,M.__generator)(this,function(t){switch(t.label){case 0:return[4,r((0,H.j7)(e))];case 1:return t.sent(),[2,e]}})}),function(e){return o.apply(this,arguments)});return n.publish(e).then(a,i)}),update:(0,U.A)(function(e,t){var i,a,c,s,u,l=o.getState(),d={};(null==t?void 0:null===(s=t.title)||void 0===s?void 0:s.title)&&(d.title=t.title.title),(null==t?void 0:null===(u=t.hybrid)||void 0===u?void 0:u.html)&&(d.editableDetail=t.hybrid.html);var p=(i=(0,D._)(function(){return(0,M.__generator)(this,function(t){return[2,r((0,q.k9)({id:e,optimisticData:d},l))]})}),function(){return i.apply(this,arguments)}),f=(a=(0,D._)(function(t){var n;return(0,M.__generator)(this,function(o){switch(o.label){case 0:return n=t,[4,r((0,q.Kd)({id:e},n,l))];case 1:return o.sent(),[2,n]}})}),function(e){return a.apply(this,arguments)}),h=(c=(0,D._)(function(t){return(0,M.__generator)(this,function(n){switch(n.label){case 0:return[4,r((0,q.nH)({id:e},t,l))];case 1:throw n.sent(),t}})}),function(e){return c.apply(this,arguments)});return p().then(function(){return n.update(t).then(f,h)})})});return(0,_.tZ)(e,(0,L._)((0,f._)({},t),{questionContentPublish:i}))};return F()(t,e),t},W.FK)(e3)},15336:function(e,t,n){"use strict";var r=n(55164),o=n(71728),i=n(85879),a=n(55698),c=n(92258),s=n(58909),u=n(83589),l=function(e,t){var n,r;if(t)return null===(n=null===(r=e.people.brands)||void 0===r?void 0:r.find(function(e){return e.id===t}))||void 0===n?void 0:n.logo};t.Z=function(e){var t=e.questionType,n=e.brandId,d=e.brand,p=e.isAnonymous,f=e.css,h=(0,o._)(e,["questionType","brandId","brand","isAnonymous","css"]),_=(0,c.useSelector)(function(e){var r;if(!p)return(0,u.cr)(t)?(null==d?void 0:d.logo)||l(e,n):null===(r=(0,s.ib)(e))||void 0===r?void 0:r.avatarUrl});return(0,i.tZ)(a.qE,(0,r._)({size:40,url:_,css:f},h))}},68320:function(e,t,n){"use strict";n.d(t,{Z:function(){return R}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),u=n(85879),l=n(87363),d=n(92258),p=n(14914),f=n(55536),h=n(69383),_=n(31467),m=n(80714),g=n(85576),T=n(21379),E=n(58909),y=n(84210),C=n(84954),S=n(1641),I=n(99878),A=n(57730),b=n(65744),w=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleRefresh",function(){Promise.resolve(e.props.fillCurrentUserIfNeeded(["adType"])).then(e.handleCommercialSelect)}),(0,a._)((0,r._)(e),"handleNormalSelect",function(){return e.props.onSelect("normal")}),(0,a._)((0,r._)(e),"handleCommercialSelect",function(){var t=e.props,n=t.adType,r=t.onSelect;if("normal"===n)return A.Z.alert((0,u.BX)("p",{children:["请发邮件至 ",(0,u.tZ)("a",{href:"mailto:ad@zhihu.com",children:"ad@zhihu.com"})," ","申请，标题为「申请品牌提问 - 账号名称」。我们会在 1 个工作日内联系你。"]}),{title:"暂无权限"});if("invited"===n){var o=e.props.currentUser.urlToken;return(0,b.y)("你尚未激活广告账号",{content:(0,u.tZ)("div",{children:"激活广告账号后即可创建品牌提问"}),text:{ok:"激活广告账号",cancel:"已激活，继续创建"}}).then(function(){return window.open("https://e.zhihu.com/activate-advertiser?rf=createBrandQuestion&urlToken=".concat(o),"_blank")},e.handleRefresh)}r("commercial")}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){var e=this.props.setTitle;e&&e("选择提问类型",(0,u.tZ)("a",{className:"QuestionCategory-link",href:"/organization/ophelp/faq/19",target:"_blank",children:"如何选择？"}))}},{key:"render",value:function(){return(0,u.BX)("div",{className:"QuestionCategorySelect",children:[(0,u.tZ)(n.Item,{onClick:this.handleNormalSelect,title:"社区提问",desc:"公共提问，社区用户共同参与问题编辑和管理，适合发起公共讨论。"}),(0,u.tZ)(n.Item,{onClick:this.handleCommercialSelect,title:"品牌提问",desc:(0,u.BX)("span",{children:["私有提问，由您自主管理问题展示和回答展示，适合承载官方活动。这是一款付费产品。",(0,u.tZ)("a",{href:"https://www.zhihu.com/introduction/brand_question",children:"了解更多"})]})})]})}}]),n}(l.Component);(0,a._)(w,"Item",function(e){var t=e.onClick,n=e.title,r=e.desc;return(0,u.BX)("div",{role:"button",tabIndex:0,className:"AskOrgSelect-item",onClick:t,children:[(0,u.BX)("div",{className:"AskOrgSelect-ItemContent",children:[(0,u.tZ)("div",{className:"AskOrgSelect-itemTitle",children:n}),(0,u.tZ)("div",{className:"AskOrgSelect-itemDesc",children:r})]}),(0,u.tZ)(I.N,{size:"2em"})]})});var Z=(0,f.compose)((0,d.connect)(function(e){return{currentUser:(0,E.ib)(e)}},{fillCurrentUserIfNeeded:E.sF}))(w),x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userType,n=e.adType;return"organization"===t||"registered"===n},k=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{selectShown:e.props.createBrandQuestion,askShown:e.props.show,questionType:"normal"}),(0,a._)((0,r._)(e),"askRef",(0,l.createRef)()),(0,a._)((0,r._)(e),"toggleSelectShown",function(){return e.setState({selectShown:!e.state.selectShown})}),(0,a._)((0,r._)(e),"toggleAskShown",function(t){return e.setState({askShown:null!=t?t:!e.state.askShown})}),(0,a._)((0,r._)(e),"setTitle",function(t,n){return e.setState({title:t,subtitle:n})}),(0,a._)((0,r._)(e),"handleClose",function(){var t,n;if(h.Z.trackEvent((0,r._)(e),{id:2463,action:"Close"}),e.askRef.current)return Promise.resolve(e.askRef.current.canExit()).then(function(){var t,n;e.toggleAskShown(!1),null===(n=(t=e.props).onClose)||void 0===n||n.call(t)}).catch(function(){return null});e.toggleAskShown(!1),null===(n=(t=e.props).onClose)||void 0===n||n.call(t)}),(0,a._)((0,r._)(e),"handleClick",e.props.authRequired(function(t){return e.props.realNameRequired(function(){var n,r;(null===(n=e.props.children)||void 0===n?void 0:n.props.onClick)&&(null===(r=e.props.children)||void 0===r||r.props.onClick(t)),e.props.canCurrentAskBrandQuestion?e.toggleSelectShown():e.toggleAskShown()})()})),(0,a._)((0,r._)(e),"handleSelect",function(t){e.setState({questionType:t}),"commercial"===t?e.props.loadBrands().then(function(){return e.toggleAskShown()}):e.toggleAskShown()}),(0,a._)((0,r._)(e),"handleSuccess",function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id,n=e.props,r=n.askHandleSuccess,o=n.router,i=n.isFromZhida;e.toggleAskShown(),null==r||r();var a="//".concat(m.Z.wwwHost,"/question/").concat(t);if(i||(0,T.y)()){window.open(a);return}o.push(a)}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){(0,this.props.fillCurrentUserIfNeeded)(["adType"]),this.props.imperativeRef&&(this.props.imperativeRef.current={click:this.handleClick})}},{key:"render",value:function(){var e=this.state,t=e.selectShown,n=e.askShown,r=e.questionType,o=e.title,i=e.subtitle,a=this.props,c=a.children,s=a.currentUser;return(0,u.BX)(u.HY,{children:[c&&(0,l.cloneElement)(c,{onClick:this.handleClick}),(0,u.tZ)(_.Z,{size:"large",maskClosable:!1,onClose:this.handleClose,css:{".Modal-content":{paddingBottom:"24px",marginTop:"18px"}},children:n&&(0,u.tZ)(S.Z,{imperativeRef:this.askRef,questionType:r,onSuccess:this.handleSuccess,onClose:this.handleClose})}),(0,u.tZ)(_.Z,{title:o,subtitle:i,onClose:this.toggleSelectShown,children:t&&(0,u.tZ)(Z,{adType:s&&s.adType,onSelect:this.handleSelect,setTitle:this.setTitle})})]})}}]),n}(l.Component),R=(0,f.compose)(p.withRouter,g.Z,C.ru,(0,d.connect)(function(e,t){var n;return{createBrandQuestion:!!((n=t.location)&&n.query&&"createBrandQuestion"===n.query.rf),canCurrentAskBrandQuestion:x((0,E.ib)(e)),currentUser:(0,E.ib)(e)}},{loadBrands:y.R8,fillCurrentUserIfNeeded:E.sF}))(k)},5171:function(e,t,n){"use strict";n.d(t,{Z:function(){return U}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),u=n(85879),l=n(53910),d=n(67814),p=n.n(d),f=n(14168),h=n.n(f),_=n(87363),m=n(25452),g=n(55164),T=n(57477),E=n(49899),y=n(68014),C=n(80565),S=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleAdd",function(t){var n=e.props,r=n.value,o=n.onChange,i=n.onAdd;i&&i(t),o&&o((0,E._)(r).concat([t]))}),(0,a._)((0,r._)(e),"handleRemove",function(t){var n=e.props,r=n.value,o=n.onChange,i=n.onRemove;i&&i(r[t],t),o&&o((0,E._)(r.slice(0,t)).concat((0,E._)(r.slice(t+1))))}),(0,a._)((0,r._)(e),"handleIfBackspace",function(t){var n=e.props.value;8===t.keyCode&&!e.state.value&&n.length&&e.handleRemove(n.length-1)}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.value,o=t.renderTagInner,i=t.renderInput;return(0,u.BX)("div",{className:p()("TagInputAlias",n),children:[r&&r.map(function(t,n){return(0,u.tZ)(y.Z,{removable:!0,onRemove:function(){return e.handleRemove(n)},css:function(e){return{".Tag-content":(0,T._)((0,g._)({},(0,C.S)(1)),{wordBreak:"break-all"}),button:{color:e.colors.MapInfoSub}}},children:o(t)},n)}),i({onAdd:this.handleAdd,onIfBackspace:this.handleIfBackspace})]})}}]),n}(_.Component);(0,a._)(S,"propTypes",{renderTagInner:h().func.isRequired,renderInput:h().func,value:h().array.isRequired,onAdd:h().func,onRemove:h().func,onChange:h().func});var I=n(85456),A=n.n(I),b=n(92258),w=n(55536),Z=n(58718),x=n(80714);function k(e,t){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0;return fetch((r=Object.keys(n=(0,g._)({token:t,max_matches:10,use_similar:0},i)).map(function(e){return"".concat(e,"=").concat(encodeURIComponent(n[e]))}).join("&"),"".concat(("undefined"!=typeof window?window.location.host:null)?"https://".concat(x.Z.wwwHost,"/"):"//www.zhihu.com/").concat(e?"".concat(e,"/"):"","autocomplete?").concat(r))).then(function(e){return e.json().then(function(t){return{res:e,json:t}})}).then(function(t){var n=t.res,r=t.json;if(n.ok)return r[0].filter(Array.isArray).filter(function(t){return!e||t[0]===e}).filter(function(e){return!o.includes(e[1])});throw Error("fetch ".concat(e," error"))})}function R(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return k.apply(void 0,["topic"].concat((0,E._)(t))).then(function(e){return e.map(function(e){return{name:e[1],urlToken:e[2],avatarUrl:e[3]}})})}var N=n(58909),O=n(76741),P=function(e){return e.name.startsWith("创建 ")&&e.name.endsWith(" 话题")},D=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{value:"",items:[]}),(0,a._)((0,r._)(e),"mounted",!1),(0,a._)((0,r._)(e),"fetchTopic",function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return R.apply(void 0,(0,E._)(n).concat([[],{topic_filter:1}])).then(function(t){t=t.filter(function(e){return!P(e)});var r=e.props.currentUser,o=n[0];return!r||!r.canEditTopic||t.find(function(e){return e.name===o})||/\s/.test(o)||/(?:[+=$￥^><~`|!-#%-*,-/:;?@[-\]_{}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F])/.test(o)?t:(0,E._)(t).concat([{urlToken:"topic",token:o,name:"创建 ".concat(o," 话题")}])})}),(0,a._)((0,r._)(e),"createTopic",function(t){return e.props.createTopic(t).then(function(e){return e.payload})}),(0,a._)((0,r._)(e),"handleSelect",function(t,n){var r=e.props.onSelect;Promise.resolve(P(n)?e.createTopic(n.token||n.name):n).then(function(t){r&&r(t),e.mounted&&e.setState({value:""})}).catch(function(){e.setState({value:""})})}),(0,a._)((0,r._)(e),"handleChange",A()(function(t){e.setState({value:t}),e.fetchTopic(t).then(function(t){return e.mounted&&e.setState({items:t})})},200)),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){this.mounted=!0,(0,this.props.fillCurrentUserIfNeeded)(["canEditTopic"])}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"render",value:function(){var e=this.state,t=e.value,n=e.items,r=this.props.filter;return(0,u.tZ)(Z.Z,(0,T._)((0,g._)({},this.props),{autoFocus:!0,value:t,items:r&&n?n.filter(r):n,onChange:this.handleChange,onSelect:this.handleSelect}))}}]),n}(_.Component),L=(0,w.compose)((0,b.connect)(function(e){return{currentUser:(0,N.ib)(e)}},{createTopic:O.HV,fillCurrentUserIfNeeded:N.sF}))(D),M=function(e,t){if(!e||!t)return!1;var n=e.urlToken||e.id,r=t.urlToken||t.id;return n&&n===r},B=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleClick",function(){var t=e.props.onToggleActived;t&&t()}),(0,a._)((0,r._)(e),"handleBlur",function(t){var n=e.props.onBlur;n&&n(t);var r=e.props.onToggleActived;r&&r()}),(0,a._)((0,r._)(e),"handleChange",function(t){var n=e.props,r=n.max,o=n.onChange;r>0&&o(t.slice(0,r))}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.max,o=t.value,i=t.inputProps,a=t.onAdd,c=t.onRemove,s=t.actived,d=t.onRef,f=t.placeholderNote,h=t.showAddButton,_=void 0===h||h,g="绑定话题".concat(o.length>0?"（".concat(o.length,"/").concat(r,"）"):f||"（至少添加一个）");return(0,u.tZ)(S,{className:p()("TopicInputAlias-tagInput",n),value:o,renderInput:function(t){var n=t.onAdd,a=t.onIfBackspace;return(null==o?void 0:o.length)>=r?null:s?(0,u.tZ)(L,{className:"TopicInputAlias-autocomplete",inputProps:{className:p()("TopicInputAlias-input",null==i?void 0:i.className),placeholder:"绑定相关话题可以被更多人看到"},menuProps:{menuClassName:"TopicInputAlias-suggestionContainer"},filter:o&&function(e){return!o.find(function(t){return M(t,e)})},onRef:d,onKeyDown:a,onSelect:n,onBlur:e.handleBlur,placeholder:g}):_&&(0,u.tZ)(m.ZP,{className:"TopicInputAlias-placeholderButton",label:g,icon:l.nY,onClick:e.handleClick,preset:"plain",color:"blue"})},renderTagInner:function(e){return(0,u.tZ)("a",{target:"_blank",rel:"noopener noreferrer",href:"//www.zhihu.com/topic/".concat(e.id||e.urlToken),children:e.name})},onAdd:a,onRemove:c,onChange:this.handleChange})}}]),n}(_.Component);(0,a._)(B,"propTypes",{max:h().number}),(0,a._)(B,"defaultProps",{max:5});var U=B},83589:function(e,t,n){"use strict";n.d(t,{A3:function(){return h},Fw:function(){return d},Mu:function(){return s},Op:function(){return p},S8:function(){return u},cr:function(){return f},kA:function(){return c},uq:function(){return l}});var r=n(67516),o=n.n(r),i={title:"AskQuestion::title",topics:"AskQuestion::topics",detail:"AskQuestion::detail"},a=function(){var e=o().get(i.detail)||"";if(e&&"undefined"!==e){var t=e.html||e;if("string"==typeof t)return t}return""},c=function(){return{title:o().get(i.title)||"",detail:a(),topics:o().get(i.topics)||[]}},s=function(e){Object.keys(e).forEach(function(t){var n=i[t];n&&void 0!==e[t]&&o().set(n,e[t])})},u=51,l=function(e){return e.length<4?{level:"error",text:"至少输入 ".concat(4," 个字"),ignoreInInput:!0,blockSubmit:!0}:e.length>u?{level:"error",text:"已超过 ".concat(e.length-u," 个字"),ignoreInInput:!0,blockSubmit:!0}:(e.match(/(\?|？)/g)||[]).length>1?{level:"warning",text:"多个问题建议拆分"}:null},d=function(){return null},p=function(e){return!!e&&(e.hasVideo("upload")?{level:"error",blockSubmit:!0,text:"请等待视频上传完成后发布"}:e.hasImage("upload")?{level:"error",blockSubmit:!0,text:"请等待图片上传完成后发布"}:e.hasImage("error")||e.hasVideo("error")&&!e.hasVideo("error-review")?{level:"fatal",blockSubmit:!0,text:"草稿中含有上传失败的内容，请更改后重新提交",title:"上传失败"}:!!(e.hasVideo("error-review")||e.hasVideo("censor"))&&{level:"fatal",blockSubmit:!0,text:"视频中包含未通过审核的信息，请更改后重新提交",title:"视频未通过审核"})},f=function(e){return"commercial"===e},h=function(e){return f(e)?2:0}},5469:function(e,t,n){"use strict";n.d(t,{rt:function(){return y}});var r=n(94009),o=n(79065),i=n(85879),a=n(91850),c=n(41402),s=n(7562),u=n(87363),l=n(92258),d=n(1733),p=n(16563),f=n(65744),h=n(803),_=n(71981);function m(){var e=(0,o._)(["\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n"]);return m=function(){return e},e}var g=(0,c.F4)(m()),T=function(e){var t=e.className,n=e.isLoading;return(0,i.BX)(d.sN,{className:t,css:function(e){return{display:"inline-flex",alignItems:"center",color:e.colors.GBK06A}},children:[(0,i.tZ)("span",{css:{display:"inline-flex",alignItems:"center",width:24,marginLeft:-24},children:(0,i.tZ)(s.Z,{css:n?{animation:"".concat(g," 1s linear 600ms infinite")}:{}})}),n?"加载中...":"加载失败，点击「设置」重试"]})},E=function(e){var t=e.className,n=e.current,r=e.permissionItem,o=e.onClick,a=r.permission,c=r.text,s=r.disable,u=r.disableAlert;return a!==p.sO||n===a||(0,p.M1)()?(0,i.tZ)(_.Z,{className:t,onClick:function(){s?(0,f.t)(u,{theme:"red-ghost"}):o(a,c)},checked:n===a,children:c}):null};function y(e){var t=e.current,n=e.target,o=e.type,c=e.onChange,s=e.className,d=(0,r._)((0,a.k)(!1),2),_=d[0],m=d[1],g=(0,r._)((0,a.k)(!0),2),y=g[0],C=g[1],S=(0,l.useDispatch)(),I=n.type,A=n.id,b=o||I,w=(0,l.useSelector)(function(e){var t,n;return null===(t=e.commentPermission)||void 0===t?void 0:null===(n=t[b])||void 0===n?void 0:n[A]})||[];(0,u.useEffect)(function(){_||S((0,h.n5)(b,A)).finally(function(){C.off(),m.on()})},[S,b,A,_,m,C]),(0,u.useEffect)(function(){t!==p.sO||(0,p.M1)()||(0,p.UJ)()},[t]);var Z=function(e,r){if(e!==t){if(!n){c(e);return}var o=n.id;n.adminClosedComment?(0,f.t)("此内容无法更改评论权限",{theme:"red-ghost"}):e===p.Kz||t===p.Kz?(0,f.y)("你确定要更改评论权限吗？",{content:e===p.Kz?"更改后，已有评论不变，新评论需要经过筛选才会公开显示":"更改后，所有待筛选评论都会被公开显示出来"}).then(function(){return c(o,e,r)}).catch(function(){return null}):c(o,e,r)}};return y?(0,i.tZ)(T,{className:s,isLoading:!0}):y||!_||w.length?(0,i.tZ)(i.HY,{children:w.map(function(e){return(0,i.tZ)(E,{className:s,permissionItem:e,onClick:Z,current:t},e.permission)})}):(0,i.tZ)(T,{className:s})}var C=n(22107),S=n(94707),I=n(86325),A=n(85626),b=n(31467),w=n.p+"assets/deleteComment.d2efe0dc.gif",Z=n(99447),x=function(e){(0,I._)(n,e);var t=(0,A._)(n);function n(){return(0,C._)(this,n),t.apply(this,arguments)}return(0,S._)(n,[{key:"render",value:function(){return(0,i.tZ)("img",{src:w,style:{maxWidth:"200px",marginTop:"30px"},alt:"delete-comment-success"})}}]),n}(u.Component);x.showModal=function(e){b.Z.open(function(t){var n=(e||{}).reportText;return setTimeout(t,2e3),(0,i.tZ)(b.Z,{title:"举报成功",onClose:t,children:(0,i.BX)("div",{style:{textAlign:"center"},children:[(0,i.tZ)("div",{children:n||"你的举报我们已经收到，处理结果会通过系统通知进行告知。"}),(0,i.tZ)(x,{})]})})})},(0,Z.a)({view:{id:3038},trackCardShow:!0})(x),n(20857),n(87320),n(25452),n(24752),u.Component},33722:function(e,t,n){"use strict";n.d(t,{xu:function(){return X},WD:function(){return W},Zy:function(){return q},AN:function(){return V},Yj:function(){return H},EE:function(){return j},Oo:function(){return Y},Gf:function(){return K}});var r,o=n(87320),i=n(55164),a=n(49899),c=n(19774),s=n(37742),u=n(87752),l=n(16839),d=n(26969),p=n(95826),f=n(14888),h=n(42951),_=n(7209),m=n(50130),g=n(87363),T=n.n(g),E=n(66980),y=Object.assign,C=Object.assign,S=Object.assign,I=Object.assign,A=Object.assign,b=Object.assign,w=Object.assign,Z=Object.assign,x=Object.assign,k=Object.assign,R=Object.assign,N=Object.assign,O=Object.assign,P=Object.assign,D=Object.assign,L=function(e){return T().createElement(E.Z,D({width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},e),T().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M.552 6.167h2.945l2.853 6.575 2.865-6.575h5.352v11.666h-2.619V6.593l-5.163 11.24h-.858L.552 6.167Zm15.457 0h2.842c1.376 0 2.492.292 3.237.982.733.678 1.079 1.598 1.079 2.696 0 1.242-.366 2.267-1.16 2.995-.791.726-1.921 1.046-3.3 1.046h-.064v3.947h-2.634V6.167Zm2.634 2.422v2.86h.107c.798 0 1.21-.181 1.405-.399.25-.28.378-.615.378-1.03 0-.47-.131-.807-.36-1.057-.19-.207-.567-.374-1.279-.374h-.251Z",clipRule:"evenodd"}))},M=Object.assign,B=Object.assign,U=Object.assign,G=Object.assign,F=Object.assign,H={pass:"pass",applying:"applying",canDraw:"can_draw",canApply:"can_apply",notActive:"not_active",banned:"banned"},z={vip_coupon:{id:"vip_coupon",name:"盐选会员代金券",icon:L,url:null},vip:{id:"vip",name:"盐选会员卡",icon:L,url:null},enjoy_live_free:{id:"enjoy_live_free",name:"畅享免费 Live",icon:function(e){return T().createElement(E.Z,M({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),T().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M22.429 32.336c-1.4.431-2.887.664-4.429.664-8.284 0-15-6.716-15-15C3 9.716 9.716 3 18 3c8.284 0 15 6.716 15 15 0 1.8-.317 3.524-.898 5.123A8.029 8.029 0 0 0 29 22.5c-3.675 0-6.699 2.482-8.346 5.84l-.325.66.325.66c.48.98 1.078 1.885 1.775 2.676ZM11.77 19.907s-.098.128-.044.29c.053.161.24.154.24.154l4.08-.1-1.564 7.714s-.038.138.075.186c.112.047.208-.082.208-.082l8.497-11.009s.098-.127.045-.289c-.054-.162-.241-.154-.241-.154l-4.08.1 1.565-7.715s.037-.137-.075-.185c-.113-.048-.209.082-.209.082L11.77 19.907Z",clipRule:"evenodd"}),T().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M22 29c1.476-3.007 4.06-5 7-5 2.94 0 5.524 1.993 7 5-1.476 3.007-4.06 5-7 5-2.94 0-5.524-1.993-7-5Zm8.75-.375c0 .958-.784 1.734-1.75 1.734-.967 0-1.75-.776-1.75-1.734s.783-1.734 1.75-1.734c.966 0 1.75.776 1.75 1.734Z",clipRule:"evenodd"}))},url:null},read:{id:"read",name:"读书卡",icon:function(e){return T().createElement(E.Z,O({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),T().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"m32.543 31.104-13.772-7.138V10.783c0-.097.055-.186.142-.229l11.36-5.652a.292.292 0 0 1 .422.237l1.098 12.821-1.53.694-.012-.13-9.937 4.546 10.8 5.675-.694-8.225 1.532-.695.946 11.043a.243.243 0 0 1-.355.236Zm-29.087 0 13.772-7.138V10.783a.256.256 0 0 0-.142-.229L5.726 4.903a.292.292 0 0 0-.421.236L4.203 18.006l1.345.61.008-.091 9.937 4.546-10.8 5.674.697-8.263-1.347-.61-.941 10.996a.243.243 0 0 0 .354.236Z",clipRule:"evenodd"}))},url:null},zhihu_vouchers:{id:"zhihu_vouchers",name:"知乎自营代金券",icon:function(e){return T().createElement(E.Z,G({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),T().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M5 6a2 2 0 0 0-2 2v5.756a4.502 4.502 0 0 1 0 8.488V28a2 2 0 0 0 2 2h26a2 2 0 0 0 2-2v-5.756a4.502 4.502 0 0 1 0-8.488V8a2 2 0 0 0-2-2H5Zm10.523 6.962a.75.75 0 1 0-1.046 1.076l2.773 2.695v1.121h-3a.75.75 0 0 0 0 1.5h3V22.5a.75.75 0 0 0 1.5 0v-3.146h3a.75.75 0 0 0 0-1.5h-3v-1.12l2.773-2.696a.75.75 0 1 0-1.046-1.076L18 15.371l-2.477-2.409Z",clipRule:"evenodd"}))},url:null}},q=(0,i._)({"0513324000":{id:"0513324000",name:"内容分析",icon:c.Z,url:"/creator/analytics"},5713324e3:{id:"5713324000",name:"近期热点",icon:function(e){return T().createElement(E.Z,R({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),T().createElement("path",{fill:"#06F",d:"M30 20.24c0 6.218-5.373 11.26-12 11.26S6 26.458 6 20.24c0-2.052.693-3.975 1.714-5.631 1.199-1.944 2.572-2.703 4.286-4.722 1.714-2.018 2.25-4.583 2.25-5.387 0-.804 3.393.255 5.464 4.41 2.072 4.157 1.072 6.84 2.786 6.84s1.5-5.488 3.214-4.137C28.334 13.68 30 16.777 30 20.24Z"}))},url:"/creator/hot-question/hot/0/hour"},6713324e3:{id:"6713324000",name:"盐选合作",icon:function(e){return T().createElement(E.Z,C({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),T().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M15 31.5c8.284 0 15-1.679 15-3.75 0-1.909-5.706-3.485-13.086-3.72.602-.02 1.214-.03 1.835-.03 8.699 0 15.75 2.015 15.75 4.5S27.448 33 18.75 33c-6.275 0-11.693-1.049-14.225-2.566 2.704.66 6.4 1.066 10.476 1.066Z",clipRule:"evenodd"}),T().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M25.388 4.324a2 2 0 0 0-2.833.004L3.476 23.52a2 2 0 0 0-.565 1.152l-.603 4.645a.5.5 0 0 0 .554.561l4.695-.547a2 2 0 0 0 1.183-.573L27.86 9.623a2 2 0 0 0-.001-2.827l-2.471-2.472Zm-7.025-.209a1 1 0 0 0-1.415 0l-4.95 4.95a1 1 0 0 0 0 1.414l.178.177a1 1 0 0 0 1.414 0l4.95-4.95a1 1 0 0 0 0-1.414l-.177-.177Z",clipRule:"evenodd"}))},url:"/creator-salt/welfare"},9613324e3:{id:"9613324000",name:"主页置顶",icon:s.Z,url:null},9513324e3:{id:"9513324000",name:"知乎直播",icon:function(e){return T().createElement(E.Z,F({width:"24",height:"24",viewBox:"0 0 24 24"},e),T().createElement("defs",null,T().createElement("path",{id:"id-1100645874-a",d:"M14.4 2.778c1.988 0 3.6 1.527 3.6 3.412v7.676c0 1.884-1.612 3.412-3.6 3.412H3.6c-1.988 0-3.6-1.528-3.6-3.412V6.19c0-1.885 1.612-3.412 3.6-3.412h10.8ZM7.771 7c-.556 0-1.014.446-1.066 1.017l-.005.108v3.75l.005.108c.052.57.51 1.017 1.066 1.017.165 0 .32-.039.46-.109l.008.005 2.846-1.878A1.13 1.13 0 0 0 11.7 10c0-.397-.196-.746-.492-.949L8.454 7.258A1.037 1.037 0 0 0 7.771 7Zm-.328-3.444L5.361 1.463A.858.858 0 0 1 6.571.249l2.318 2.33L11.204.252a.856.856 0 1 1 1.213 1.21l-2.083 2.094h-2.89Z"})),T().createElement("g",{fill:"none",fillRule:"evenodd"},T().createElement("path",{d:"M0 0h24v24H0z"}),T().createElement("g",{transform:"translate(3 3)"},T().createElement("mask",{id:"id-1100645874-b",fill:"#fff"},T().createElement("use",{xlinkHref:"#id-1100645874-a"})),T().createElement("use",{xlinkHref:"#id-1100645874-a",fill:"currentColor",fillRule:"nonzero"}),T().createElement("g",{fill:"currentColor",mask:"url(#id-1100645874-b)"},T().createElement("path",{d:"M-3-3h24v24H-3z"})))))},url:"/creator/rights-streaming"},2613324e3:{id:"2613324000",name:"知+自选",icon:function(e){return T().createElement(E.Z,y({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),T().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M18 33c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C9.716 3 3 9.716 3 18c0 8.284 6.716 15 15 15Zm6.482-14.41a5 5 0 0 0-7.071-7.072.834.834 0 0 0 1.178 1.179 3.333 3.333 0 1 1 4.714 4.714.833.833 0 0 0 1.179 1.178ZM11.518 17.41a5 5 0 0 0 7.071 7.071.833.833 0 0 0-1.178-1.178 3.333 3.333 0 0 1-4.714-4.714.833.833 0 0 0-1.179-1.179Zm3.982-.244a.833.833 0 0 0 0 1.667h1.667V20.5a.833.833 0 1 0 1.666 0v-1.666H20.5a.833.833 0 0 0 0-1.667h-1.667V15.5a.833.833 0 0 0-1.666 0v1.667H15.5Z",clipRule:"evenodd"}))},url:"/creator/zixuan"},1613324e3:{id:"1613324000",name:"好物推荐",icon:u.Z,url:"/creator/mcn"},7413324e3:{id:"7413324000",name:"内容自荐",icon:l.ZP,url:"/creator/recommend"},3713324e3:{id:"3713324000",name:"内容收益",icon:function(e){return T().createElement(E.Z,b({width:"24",height:"24",viewBox:"0 0 24 24"},e),T().createElement("path",{fillRule:"evenodd",d:"M4 4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H4Zm10.023 4.462a.75.75 0 1 0-1.046 1.076l1.773 1.723v.392H13a.75.75 0 0 0 0 1.5h1.75v1.68a.75.75 0 0 0 1.5 0v-1.68H18a.75.75 0 0 0 0-1.5h-1.75v-.392l1.773-1.723a.75.75 0 1 0-1.046-1.076L15.5 9.898l-1.477-1.436ZM6 8.25a.75.75 0 0 0 0 1.5h4a.75.75 0 0 0 0-1.5H6Zm0 5.25A.75.75 0 0 0 6 15h4a.75.75 0 0 0 0-1.5H6Z",clipRule:"evenodd"}))},url:"/creator/video-support"},3613324e3:{id:"3613324000",name:"众邀任务",icon:function(e){return T().createElement(E.Z,P({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),T().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M7 7.828C9.003 6.34 11.822 4.5 15 4.5c1.934 0 3.189.729 4.404 1.435 1.14.662 2.246 1.304 3.846 1.304 2.634 0 4.405-.58 6.535-1.278.346-.113.7-.23 1.07-.347a.496.496 0 0 1 .645.474v16.62a.097.097 0 0 1-.043.082c-.44.293-4.2 2.71-8.207 2.71-2.32 0-3.669-.956-4.9-1.827-1.032-.731-1.982-1.404-3.35-1.404-1.608 0-3.43.696-5.123 1.342-1.034.395-2.02.771-2.877.958V31.5a1 1 0 1 1-2 0V6.24a1 1 0 0 1 2 0v1.588Z",clipRule:"evenodd"}))},url:"/creator/recruit-task"},"0713324000":{id:"0713324000",name:"创作贴纸",icon:function(e){return T().createElement(E.Z,w({width:"24",height:"24",viewBox:"0 0 24 24"},e),T().createElement("path",{fillRule:"evenodd",d:"M2 4a1 1 0 0 1 1-1h18a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4Zm7 4a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm-3.5 6a.5.5 0 0 0 0 1h13a.5.5 0 0 0 0-1h-13ZM5 17.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5ZM14.5 6a.5.5 0 0 0-.5.5v3.761a.5.5 0 0 0 .686.465l1.443-.577a1 1 0 0 1 .742 0l1.443.577A.5.5 0 0 0 19 10.26V6.5a.5.5 0 0 0-.5-.5h-4Z",clipRule:"evenodd"}))},url:null},1513324e3:{id:"1513324000",name:"送礼物功能",icon:d.Z,url:"/creator/reward"},1713324e3:{id:"1713324000",name:"关注者画像",icon:function(e){return T().createElement(E.Z,k({width:"24",height:"24",viewBox:"0 0 24 24"},e),T().createElement("path",{fillRule:"evenodd",d:"M16.27 8.611c0 .346-.03.684-.09 1.012a6.264 6.264 0 0 0-4.075 10.612h-8.66c-.434 0-.869-.18-1.153-.527a1.275 1.275 0 0 1-.152-1.393c.518-1.05 1.7-2.26 3.223-3.204a11.542 11.542 0 0 1 3.084-1.341A5.613 5.613 0 0 1 10.66 3a5.611 5.611 0 0 1 5.611 5.611Zm6.015 6.692c.315 0 .573-.256.542-.569a5.697 5.697 0 0 0-5.1-5.1c-.313-.031-.57.227-.57.541v4.558c0 .315.256.57.57.57h4.558Zm-.556.57a5.128 5.128 0 1 1-5.128-5.127v4.627a.5.5 0 0 0 .5.5h4.628Z",clipRule:"evenodd"}))},url:"/creator/followers"},8713324e3:{id:"8713324000",name:"编辑器扩容",icon:function(e){return T().createElement(E.Z,Z({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),T().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M3 7.5a3 3 0 0 1 3-3h9.133a1.5 1.5 0 0 1 1.175.568l2.67 3.364A1.5 1.5 0 0 0 20.153 9H30a3 3 0 0 1 3 3v16.5a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3v-21Zm22.5 10.875c.621 0 1.125.504 1.125 1.125v2.063h2.063a1.125 1.125 0 0 1 0 2.25h-2.063v2.062a1.125 1.125 0 0 1-2.25 0v-2.063h-2.063a1.125 1.125 0 0 1 0-2.25h2.063V19.5c0-.621.504-1.125 1.125-1.125Z",clipRule:"evenodd"}))},url:null},3513324e3:{id:"3513324000",name:"品牌特邀",icon:p.ZP,url:"/creator/commercial-task"},9413324e3:{id:"9413324000",name:"自定义推广",icon:f.Z,url:"/creator/custom-promotion"},7513324e3:{id:"7513324000",name:"圆桌主持人",icon:h.Z,url:"/creator/roundtable-host"},2513324e3:{id:"2513324000",name:"知乎 Live",icon:_.Z,url:"/creator/live"},2713324e3:{id:"2713324000",name:"关注者在看",icon:function(e){return T().createElement(E.Z,x({width:"24",height:"24",viewBox:"0 0 24 24"},e),T().createElement("path",{fillRule:"evenodd",d:"M15.408 8.665c0 .887-.203 1.726-.566 2.473-1.79.744-3.253 2.282-4.18 4.188l-.204.419.204.418c.948 1.95 2.456 3.514 4.302 4.238H2.459a1.5 1.5 0 0 1-1.164-.532 1.287 1.287 0 0 1-.154-1.407c.524-1.058 1.716-2.282 3.254-3.234a11.657 11.657 0 0 1 3.114-1.354A5.667 5.667 0 0 1 9.743 3a5.666 5.666 0 0 1 5.665 5.665Zm-3.886 7.08c1.21-2.488 3.328-4.136 5.739-4.136 2.41 0 4.529 1.648 5.739 4.136-1.21 2.487-3.328 4.136-5.74 4.136-2.41 0-4.528-1.649-5.738-4.136Zm7.173-.31a1.435 1.435 0 1 1-2.869 0 1.435 1.435 0 0 1 2.87 0Z",clipRule:"evenodd"}))},url:"/creator/followers"},7713324e3:{id:"7713324000",name:"专属小管家",icon:function(e){return T().createElement(E.Z,U({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),T().createElement("path",{fill:"#06F",d:"M18 1.5c-7.27 0-13.33 5.17-14.707 12.035A3 3 0 0 0 .75 16.5v6a3 3 0 0 0 3 3h1.5a3 3 0 0 0 3-3v-6a3.001 3.001 0 0 0-1.922-2.8C7.59 8.423 12.337 4.5 18 4.5s10.41 3.923 11.672 9.2a3.001 3.001 0 0 0-1.922 2.8v6c0 .841.346 1.602.904 2.147A10.497 10.497 0 0 1 19.5 30a1.5 1.5 0 0 0 0 3c5.3 0 9.888-3.055 12.097-7.5h.653a3 3 0 0 0 3-3v-6a3 3 0 0 0-2.543-2.965C31.33 6.67 25.269 1.5 18 1.5Z"}))},url:null},6613324e3:{id:"6613324000",name:"复用任务",icon:function(e){return T().createElement(E.Z,N({width:"36",height:"36",fill:"none",viewBox:"0 0 36 36"},e),T().createElement("path",{fill:"#06F",d:"M13.5 3A1.5 1.5 0 0 1 15 1.5h6a1.5 1.5 0 0 1 0 3h-6A1.5 1.5 0 0 1 13.5 3Z"}),T().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M10.5 3h-3a3 3 0 0 0-3 3v24a3 3 0 0 0 3 3h21a3 3 0 0 0 3-3V6a3 3 0 0 0-3-3h-3a3 3 0 0 1-3 3h-9a3 3 0 0 1-3-3Zm2.25 11.25a1.875 1.875 0 1 1-3.75 0 1.875 1.875 0 0 1 3.75 0Zm0 9a1.875 1.875 0 1 1-3.75 0 1.875 1.875 0 0 1 3.75 0Zm3-10.125a1.125 1.125 0 0 0 0 2.25h10.124a1.125 1.125 0 1 0 0-2.25H15.75ZM14.625 23.25c0-.621.504-1.125 1.125-1.125h10.125a1.125 1.125 0 0 1 0 2.25H15.75a1.125 1.125 0 0 1-1.125-1.125Z",clipRule:"evenodd"}))},url:"/creator/reuse-task"},4713324e3:{id:"4713324000",name:"内容分析高级数据",icon:function(e){return T().createElement(E.Z,S({width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},e),T().createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4 7.42a1 1 0 0 1 .594-.914l2.393-1.064a4 4 0 0 1 3.683.226l.463.277a2 2 0 0 0 1.923.074l5.828-2.913a1 1 0 0 1 .84-.025l.119.05a1 1 0 0 1 .514 1.337l-.062.135a1 1 0 0 1-.461.477l-5.759 2.88a4 4 0 0 1-3.846-.149l-.392-.235a2 2 0 0 0-1.841-.112L4.703 8.927A.5.5 0 0 1 4 8.47V7.42Zm6.138 2.858c0-.307.335-.497.599-.339.927.557 2.074.6 3.041.117l.027-.013a.402.402 0 0 1 .583.36V18a1 1 0 0 1-1 1h-2.25a1 1 0 0 1-1-1v-7.722Zm-2.591-.801a.5.5 0 0 1 .703.457V18a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-6.297a1 1 0 0 1 .594-.914l2.953-1.312Zm12.255-2.34a.5.5 0 0 1 .724.447V12h-3.598a1.64 1.64 0 0 0-.652.136V9.518a1 1 0 0 1 .553-.894l2.973-1.487ZM16.928 13h4.135c.117 0 .231.032.332.093a.686.686 0 0 1 .244.255l1.296 2.334a.523.523 0 0 1-.081.614l-3.528 3.564a.465.465 0 0 1-.33.14.464.464 0 0 1-.331-.14l-3.52-3.565a.522.522 0 0 1-.082-.612l1.288-2.334a.686.686 0 0 1 .244-.255.642.642 0 0 1 .333-.094Z",clipRule:"evenodd"}))},url:"/creator/analytics/work/all?detailType=profile"},4613324e3:{id:"4613324000",name:"视频推广",url:"/creator/video-distribution",icon:c.Z},8613324e3:{id:"8613324000",name:"图文流量包",url:"/creator/recommend/article-exposure-promotion",icon:l.ZP},5613324e3:{id:"5613324000",name:"流量加油包",url:"/creator/recommend/exposure-promotion",icon:l.ZP},7613324e3:{id:"7613324000",name:"文章发布回答",url:"/creator/manage/creation/article",icon:null},6513324e3:{id:"6513324000",name:"版权服务",url:"/creator/copyright",icon:m.Z},"0613324000":{id:"0613324000",name:"互选任务",url:"https://cheese.zhihu.com/creator/elect/task",icon:function(e){return T().createElement(E.Z,A({width:"18",height:"20",viewBox:"0 0 18 20"},e),T().createElement("path",{fillRule:"evenodd",d:"M2 0h14a2 2 0 0 1 2 2v15.133a1.9 1.9 0 0 1-2.7 1.723l-1.788-.83a2 2 0 0 0-1.796.055l-1.86 1.009a2 2 0 0 1-1.75.076l-2.7-1.171a2 2 0 0 0-1.77.088l-1.386.773A1.513 1.513 0 0 1 0 17.534V2a2 2 0 0 1 2-2Zm8.005 9.055a1.005 1.005 0 0 0 0 2.011h3.99a1.005 1.005 0 0 0 0-2.011h-3.99Zm-1.05-6.033A3.479 3.479 0 0 0 6.5 2.011 3.51 3.51 0 0 0 3 5.531a3.51 3.51 0 0 0 3.5 3.518A3.51 3.51 0 0 0 10 5.53c0-.478-.095-.934-.267-1.35L7.135 7.685a.654.654 0 0 1-.868.17l-1.859-1.14a.662.662 0 0 1-.218-.907.654.654 0 0 1 .902-.22l1.348.827 2.515-3.392Zm-4.95 10.055a1.005 1.005 0 1 0 0 2.011h9.99a1.005 1.005 0 0 0 0-2.011h-9.99Z"}))}},4513324e3:{id:"4513324000",name:"作者经纪",url:"/creator/manager",icon:null},8413324e3:{id:"8413324000",name:"问题推荐",url:null,icon:null},9713324e3:{id:"9713324000",name:"评论置顶",url:null,icon:function(e){return T().createElement(E.Z,I({width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},e),T().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M12.98 2C18.79 2 23 6.746 23 12.015c0 1.682-.49 3.414-1.35 4.997-.16.26-.18.59-.07.902l.67 2.243c.15.541-.31.94-.82.78l-2.02-.6c-.55-.18-.98.05-1.49.361C16.46 21.558 14.64 22 13 22c-1.622 0-3.253-.41-4.713-1.178V19.45a1.978 1.978 0 0 0 1.555-1.164 1.885 1.885 0 0 0-.509-2.196l-2.998-2.598a2.052 2.052 0 0 0-2.67 0l-.492.427A10.699 10.699 0 0 1 3 11.985C3 6.656 7.3 2 12.98 2Zm4.038 11.32a1.103 1.103 0 1 0 0-2.2 1.103 1.103 0 0 0 0 2.2Zm-4.25 0a1.103 1.103 0 1 0 0-2.2 1.103 1.103 0 0 0 0 2.2Zm-3.147-1.103a1.103 1.103 0 0 1-2.205 0 1.103 1.103 0 0 1 2.205 0Z",clipRule:"evenodd"}),T().createElement("path",{fill:"#06F",fillRule:"evenodd",d:"M5.55 14.2a.856.856 0 0 0-1.1 0l-3.198 2.771c-.526.455-.174 1.264.55 1.264h1.025v3.033c0 .404.358.732.8.732h2.745c.443 0 .8-.328.8-.732v-3.033h1.026c.724 0 1.076-.809.55-1.264l-3.197-2.77Z",clipRule:"evenodd"}))}},"0813324000":{id:"0813324000",name:"瓦力保镖",url:"/creator/explore/wall-e",icon:function(e){return T().createElement(E.Z,B({width:"24",height:"24",fill:"none",viewBox:"0 0 24 24"},e),T().createElement("path",{fill:"#056DE8",fillRule:"evenodd",d:"m12.628 1.88 7.837 3.236c.554.23.94.742.99 1.34.124 1.501.29 4.384-.091 5.953-.532 2.185-2.443 8.956-9.364 9.974-6.921-1.018-8.832-7.789-9.364-9.974-.381-1.57-.215-4.452-.091-5.954.05-.597.435-1.11.99-1.339l7.837-3.237a1.645 1.645 0 0 1 1.256 0Zm3.927 8.125a.75.75 0 0 0-1.11-1.01l-4.425 4.868-2.198-2.598a.75.75 0 1 0-1.145.97l2.53 2.988a1.05 1.05 0 0 0 1.578.028l4.77-5.246Z",clipRule:"evenodd"}))}}},z),V={analytics:q["0513324000"],hotSpot:q["5713324000"],advancedCreation:q["6713324000"],dynamicTopping:q["9613324000"],drama:q["9513324000"],zixuan:q["2613324000"],mcn:q["1613324000"],recommend:q["7413324000"],contentRevenue:q["3713324000"],recruitTask:q["3613324000"],pasterPaper:q["0713324000"],reward:q["1513324000"],followProfile:q["1713324000"],commercialTask:q["3513324000"],customPromotion:q["9413324000"],roundtableHost:q["7513324000"],live:q["2513324000"],followInteraction:q["2713324000"],yourHelp:q["7713324000"],reuseTask:q["6613324000"],editorExpansion:q["8713324000"],analyticsAdvancedData:q["4713324000"],videoDistribution:q["4613324000"],articleExposurePromotion:q["8613324000"],exposurePromotion:q["5613324000"],articleToAnswer:q["7613324000"],copyright:q["6513324000"],contentTask:q["0613324000"],manager:q["4513324000"],question:q["8413324000"],commentTopping:q["9713324000"]};r={},(0,o._)(r,H.pass,[V.pasterPaper.id]),(0,o._)(r,H.canDraw,(0,a._)(Object.keys(z))),V.mcn.id,V.contentRevenue.id,V.articleToAnswer.id,V.zixuan.id,V.live.id,V.recruitTask.id,V.reuseTask.id,V.commercialTask.id,V.mcn.id,V.exposurePromotion.id,V.articleExposurePromotion.id,V.videoDistribution.id,V.reuseTask.id,V.recruitTask.id,V.contentTask.id,V.manager.id,V.articleToAnswer.id;var W=[V.advancedCreation.id,V.commercialTask.id,V.contentTask.id,V.reuseTask.id,V.recruitTask.id],X=[V.mcn.id],K=function(e){return!!e&&e.status===H.pass},j="https://hm.baidu.com/hm.js?bff3d83079cef1ed8fc5e3f4579ec3b3",Y=function(e){return{script:[{src:e,async:"async"}]}}},19064:function(e,t,n){"use strict";n.d(t,{Nw:function(){return f},gF:function(){return _},p3:function(){return d}});var r=n(55164),o=n(57477),i=n(85879),a=n(84871),c=n.n(a),s=n(87363),u=n(92258),l=(0,s.createContext)({isAIAssistantEnabled:!1,isAIImageEnabled:!1,isAITaskLoaded:!1}),d=function(){var e=(0,s.useContext)(l);if(!e)throw Error("useAIAssistant must be used within AIAssistantProvider");return e},p=function(e){var t=e.children,n=e.contentType,r=(0,u.useSelector)(function(e){var t,r;return"article"===n?null===(t=e.articleDraft)||void 0===t?void 0:t.aiTask:null===(r=e.question)||void 0===r?void 0:r.aiTask}),o=(0,s.useMemo)(function(){var e,t,n,o=null!=r;return{isAIAssistantEnabled:!!r&&(null==r?void 0:null===(e=r.data)||void 0===e?void 0:e.isShow),isAITaskLoaded:o,isAIImageEnabled:null!==(n=null==r?void 0:null===(t=r.data)||void 0===t?void 0:t.aiImageShow)&&void 0!==n&&n}},[r]);return(0,i.tZ)(l.Provider,{value:o,children:t})},f=function(e){return function(t){var n=d();return(0,i.tZ)(e,(0,r._)({},t,n))}},h=function(e){return(0,e.children)(d())},_=function(e){return function(t){return c()(function(n){return(0,i.tZ)(p,{contentType:e,children:(0,i.tZ)(h,{children:function(e){var a=e.isAIAssistantEnabled,c=e.isAITaskLoaded,s=e.isAIImageEnabled;return(0,i.tZ)(t,(0,o._)((0,r._)({},n),{isAIAssistantEnabled:a,isAITaskLoaded:c,isAIImageEnabled:s}))}})})},t)}}},65033:function(e,t,n){"use strict";n.d(t,{LY:function(){return T},jM:function(){return m},zc:function(){return g}});var r=n(9338),o=n(55164),i=n(57477),a=n(94009),c=n(30971),s=n(85879),u=n(65733),l=n(84871),d=n.n(l),p=n(87363),f=n(29404),h=n(49048),_=function(e){var t=e.type,n=e.id,o=e.extra,i=e.children,l=(0,a._)((0,p.useState)(o),2),d=l[0],_=l[1],m=(0,u.A)((0,r._)(function(){var e;return(0,c.__generator)(this,function(r){switch(r.label){case 0:if(!t||!n)return[2];return[4,(0,h.a)(t,n)];case 1:return(e=r.sent())&&_(e),[2]}})}));return(0,p.useEffect)(function(){o||m()},[o,m,n,t]),(0,s.tZ)(f.Z.Provider,{value:d,children:i})},m=function(e){var t=e.dataPath;return function(e){return d()(function(n){var r,i;return(0,s.tZ)(_,{type:null===(r=n[t])||void 0===r?void 0:r.type,id:null===(i=n[t])||void 0===i?void 0:i.id,children:(0,s.tZ)(e,(0,o._)({},n))})},e)}},g=function(){return(0,p.useContext)(f.Z)},T=function(e){return d()(function(t){var n=g();return(0,s.tZ)(e,(0,i._)((0,o._)({},t),{promotionExtra:n}))},e)}},76976:function(e,t,n){"use strict";n.d(t,{Hg:function(){return c},g_:function(){return a},ks:function(){return s}});var r=n(85879),o=n(87363),i=(0,o.createContext)({scene:null}),a=function(e){var t=e.scene,n=e.children,a=(0,o.useMemo)(function(){return{scene:t}},[t]);return(0,r.tZ)(i.Provider,{value:a,children:n})},c=function(){return(0,o.useContext)(i).scene},s={recommend:"recommend",follow:"follow",search:"search",people:"my",answer:"answer_detail",question:"question_detail",article:"article_detail",zvideo:"zvideo_detail",pin:"pin_detail",topic:"topic",column:"column"}},60490:function(e,t,n){"use strict";n.d(t,{Z:function(){return S}});var r=n(22107),o=n(94707),i=n(87320),a=n(86325),c=n(85626),s=n(85879),u=n(67814),l=n.n(u),d=n(14168),p=n.n(d),f=n(87363),h=n(31467),_=n(25452),m=n(31142),g=n(33722),T=n(30170),E=n.p+"assets/background_title_arrow_left.f95d0571.png",y=n.p+"assets/background_title_arrow_right.0841a637.png",C=n(93029),S=function(e){(0,a._)(n,e);var t=(0,c._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.show,r=e.rights,o=e.onClose;return(0,s.tZ)(h.Z,{className:l()("CreatorPassModal",t),size:"large",onClose:o,children:n&&(0,s.BX)("div",{className:"CreatorPassModal-content",children:[(0,s.BX)("div",{className:"CreatorPassModal-decorateTitle",children:[(0,s.tZ)("img",{className:"CreatorPassModal-decorateTitleArrowLeft",src:E,alt:"background left arrow"}),(0,s.tZ)("span",{className:"CreatorPassModal-decorateTitleText",children:"恭喜获得"}),(0,s.tZ)("img",{className:"CreatorPassModal-decorateTitleArrowRight",src:y,alt:"background right arrow"})]}),(0,s.BX)("div",{className:"CreatorPassModal-image",children:[(0,s.tZ)("img",{src:T,alt:"creator pass"}),(0,s.tZ)("img",{src:C,className:"CreatorPassModal-liukanshanImage",alt:"liukanshan paper"})]}),(0,s.BX)("div",{className:"CreatorPassModal-title",children:["「",r.name,"」权益已成功",r.id===g.AN.pasterPaper.id?"领取":"开启"]}),(0,s.tZ)("div",{className:"CreatorPassModal-text",children:"希望新权益能为你带来更多收获，也期待你创作更多优质内容。"}),(0,s.tZ)(h.w,{children:(null==r?void 0:r.url)?(0,s.tZ)(m.Z,{preset:"primary",color:"blue",to:r.url,onClick:o,a:"a"===r.linkType,children:"进入功能页"}):(0,s.tZ)(_.ZP,{preset:"primary",color:"blue",onClick:o,children:"确定"})})]})})}}]),n}(f.Component);(0,i._)(S,"propTypes",{show:p().bool,rights:p().object,onClose:p().func.isRequired})},3560:function(e,t,n){"use strict";n.d(t,{Y_:function(){return y}});var r,o=n(49899),i=n(34473),a=n(76719),c=n(60566),s=n(97766),u=n(80874),l=n(65224),d=n(88067),p=n(59111),f=n(39831),h=n(33722),_=n(87320),m=n(55164),g=n(57477),T=[h.AN.analytics.id,h.AN.hotSpot.id,h.AN.advancedCreation.id,h.AN.contentRevenue.id,h.AN.followProfile.id,h.AN.mcn.id],E=(r={},(0,_._)(r,h.Yj.banned,[h.AN.recommend.id]),(0,_._)(r,h.Yj.notActive,[h.AN.recommend.id].concat((0,o._)(T))),(0,_._)(r,h.Yj.canApply,[h.AN.commercialTask.id,h.AN.zixuan.id,h.AN.recommend.id].concat((0,o._)(T))),(0,_._)(r,h.Yj.canDraw,[h.AN.commercialTask.id,h.AN.zixuan.id,h.AN.recommend.id].concat((0,o._)(T))),(0,_._)(r,h.Yj.applying,[h.AN.commercialTask.id,h.AN.zixuan.id].concat((0,o._)(T))),r);i.Z,a.Z,c.Z,s.Z,u.ZP,l.Z,d.Z,p.Z,f.Z;var y={ICON_FLAT:"https://zhihu-live.zhimg.com/namespace_1001/static/20210423/237a595e8a3454f3c74a5f587c7bf4a8.png",ICON_RISE:"https://zhihu-live.zhimg.com/namespace_1001/static/20210423/d4c4246f9eda06f25e2f9bb9d5bfdd59.png",ICON_DECLINE:"https://zhihu-live.zhimg.com/namespace_1001/static/20210423/3e1821b2482307dcf4d673a9c2129671.png"}},61879:function(e,t,n){"use strict";n.d(t,{getCreateStore:function(){return _}});var r=n(49899),o=n(55536),i=n(62108),a=n(96809);n(34959);var c=n(28953),s=n(71549),u=n.n(s),l=function(e){if((null==e?void 0:e.name)==="ResponseError"&&401===e.status)throw e},d=function(){return function(e){return function(t){if(t.FAILSAFE){var n=e(t=u()(t,{NOTIFICATION:!1,API:{fetchOptions:{failsafe:!0,timeout:t.FAILSAFE.timeout||1e3}}}));return n.catch?n.catch(l):n}return e(t)}}},p=n(84),f=n(25364);function h(){return function(e){return function(t){if(!t.payload)return e(t);var n=t.payload,r=n.rootComment,o=n.topComments;if(r){var i=(0,p.Fv)(r,c.l.COMMENT_V2),a=i.entities,s=i.result;t.rootComment=s,t.entities=(0,f.Z)(t.entities,a)}if(o){var u=o.data,l=o.paging,d=(0,p.Fv)(u,c.l.COMMENT_ARRAY_V2),h=d.entities,_=d.result;t.topComments={result:_,paging:l},t.entities=(0,f.Z)(t.entities,h)}return e(t)}}}function _(e){return function(t,n){var s=n.http,u=n.root,l=[i.Z.withExtraArgument({fnRefs:{}}),d,(0,a.Z)(s,u),c.Z,h];return(0,o.createStore)(e,t,o.applyMiddleware.apply(void 0,(0,r._)(l)))}}},75597:function(e,t,n){e.exports=n(61879)},77234:function(e,t,n){"use strict";n.d(t,{a:function(){return o},n:function(){return i}});var r={1:49,2:50,r:82,t:84,e:69};function o(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(Array.isArray(n)&&"function"==typeof(null==window?void 0:null===(e=window.aria)||void 0===e?void 0:null===(t=e.initcallback)||void 0===t?void 0:t.disableShortKeys)){var o=n.map(function(e){return r[e]});window.aria.initcallback.disableShortKeys(o)}}function i(){var e,t;"function"==typeof(null==window?void 0:null===(e=window.aria)||void 0===e?void 0:null===(t=e.initcallback)||void 0===t?void 0:t.disableShortKeys)&&window.aria.initcallback.disableShortKeys([])}},91269:function(e,t,n){"use strict";n.d(t,{lf:function(){return d},nX:function(){return l},ql:function(){return u}});var r=n(4667),o=n.n(r),i=n(32900),a=n(74351),c=o()(function(){return{promotionExtras:{},pageContentInfo:{}}}),s=(0,a.isBrowser)(),u=function(e){s&&(c().pageContentInfo=e)},l=function(e,t){s&&(c().promotionExtras[e]=t)};function d(e){try{var t=e.za_log_entry_new;if(!t)return;var n=c(),r=n.promotionExtras,o=void 0===r?{}:r,a=n.pageContentInfo,s=void 0===a?{}:a;(0,i.Z)(t,o,s)}catch(e){var u,l="AdvertZAPluginError",d="向给商业同步 ZA 埋点时发生异常";.09>Math.random()?null===(u=window.Raven)||void 0===u||u.captureException(e,{logger:l,extra:{message:d}}):console.error(l,d)}}},45732:function(e,t,n){"use strict";n.d(t,{Hf:function(){return E},WY:function(){return T},jS:function(){return y}});var r=n(15030),o=n(55164),i=n(57477),a=n(62082),c=n(54231),s=n(87363),u=n(61533),l=n(69383),d=n(63638),p=n(55462),f=n(74351),h=n(80714);n(66263);var _=n(91269),m=n(39315),g=function(){return null};function T(e){return e?fetch(e,{mode:"no-cors"}).catch(g):Promise.reject(Error("request but no url"))}function E(e,t){var n,f={onBeforeSend:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).defaultSendHandler;return setTimeout(function(){return(0,_.lf)(e)}),"function"!=typeof t||t(e)},userId:null==e?void 0:e.uid,memberHashId:null==e?void 0:e.id,userType:{people:"People",organization:"Org"}[null==e?void 0:e.userType],orgStatus:{normal:"Normal",forbidden:"Forbidden",reject:"Reject",audit:"Audit",register:"Register"}[null==e?void 0:e.orgStatus]},g=(0,i._)((0,o._)({},f),{sdkVersion:h.Z.apollo.za_sdk_version,normalizeElement:function(e){return(0,r._)(e,s.Component)?(0,u.findDOMNode)(e):e},shouldAutoTrackPageShow:!1});t.ZhihuHybrid||(g.pageProfile="zhihu-web");var T=(0,i._)((0,o._)({},f),{enableDyeing:!0,readingRefUrlFromSessionStorage:"1"===h.Z.apollo.za_zse_ck_refer}),E=new Promise(function(e){n=e});return!function(e){if(t.ZhihuHybrid){var n=/\b(from=home_tab|in_app_home_tab=|position=tab)\b/.test(location.search);if(t.Android&&n)var r=(0,p.Z)("base/viewDidAppear").listen(function(){r(),e()});else p.Z.onceViewAppeared().finally(e)}else e()}(function(){c.ZP.increment("za_helper.init.count"),l.Z.init(g).then(function(){var e=new window.zap.Client(T,{experimentalProto3:!0});(0,m.I)("zaClient",e),(0,d.configClient)(e),"function"==typeof n&&(null==n||n())}).catch(function(e){var t;throw c.ZP.increment("za_helper.init_failed.count"),.1>Math.random()&&(0,a.zB)({type:"InitZaFailed",appName:"heifetz",spanName:h.Z.currentEntry,release:h.Z.release,sdkVersion:g.sdkVersion,error:{name:e.name,message:e.message,stack:e.stack}}),null===(t=window.Raven)||void 0===t||t.captureException(e,{logger:"ZA",fingerprint:["InitZaFailed"],extra:{zaOption:g}}),e})}),E}var y={onEnter:function(e){if((0,f.isBrowser)()){var t=e.routes[e.routes.length-1];t.zaNotTrackPageShow||l.Z.trackPageShow({id:t.zaPageShowId})}},onChange:function(e,t){var n=t.routes[t.routes.length-1];n.zaNotTrackPageShow||l.Z.trackPageShow({id:n.zaPageShowId})}}},68680:function(e,t,n){"use strict";n.d(t,{St:function(){return r},bP:function(){return o},ny:function(){return i}});var r=function(e){return(null==e?void 0:e.articleType)==="paid"||(null==e?void 0:e.articleType)==="paid_column_content"};function o(e){return(null==e?void 0:e.articleType)==="paid"}function i(e){return(null==e?void 0:e.articleType)==="paid_column_content"}},53159:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var r=n(49910),o=function(e,t){var n;return(null==e?void 0:null===(n=e.mergedBadges)||void 0===n?void 0:n.length)?e:t},i=function(e,t){return(0,r.TE)(o(e,t))}},84778:function(e,t,n){"use strict";n.d(t,{x:function(){return r}});var r=function(e){return(null==e?void 0:e.columnType)==="paid_column"}},16563:function(e,t,n){"use strict";n.d(t,{Kz:function(){return l},M1:function(){return c},Qz:function(){return u},UJ:function(){return a},sO:function(){return s}});var r=n(67516),o=n.n(r),i="enabled_follower_n_days",a=function(){o().set(i,!0)},c=function(){return o().get(i)},s="follower_n_days",u=function(e,t){if(c())return e;var n,r=null===(n=e.find(function(e){return e.permission===s}))||void 0===n?void 0:n.checked;return!c()&&r?(a(),e):"answer"===t||e.find(function(e){return"follower"===e.permission})?e.filter(function(e){return e.permission!==s}):e.map(function(e){return e.permission===s?{permission:"follower",text:"关注我的人能评论",checked:!1,disable:!1,disable_alert:""}:e})},l="censor"},17518:function(e,t,n){"use strict";function r(e){return Promise.all([n.e(6649),n.e(4408)]).then(n.t.bind(n,38343,23)).then(function(t){return t.createMqttClient(e)})}n.d(t,{Z:function(){return r}})},47024:function(e,t,n){"use strict";n.d(t,{O:function(){return T},z:function(){return m}});var r=n(87320),o=n(71728),i=n(29087),a=n(94648),c=n(79855),s={lockId:"du",channelId:"du",storageKey:"".concat("du",":bid"),browserIdKey:"x-du-bid",sessionIdKey:"x-du-sid",sdkUrl:"https://unpkg.zhimg.com/@cfe/assets@1.5.0/dist/third-party/du_web_sdk.js",apiKey:"34f0o511pxi6qj1mbensp66ztbnv3f3c2w64",businessId:"h5_crfznbmbgk"},u=(0,a.I)(function(){return"function"==typeof BroadcastChannel?new BroadcastChannel(s.channelId):null}),l=function(e){for(var t,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return null===(t=u())||void 0===t?void 0:t.postMessage({type:e,data:r[0]})},d=(0,a.I)(function(){return(0,c.v)(s.sdkUrl)}),p=function(e,t){if(navigator.locks){var n=Promise.withResolvers();navigator.locks.request(e,function(){return t(),n.promise});return}setTimeout(t)},f=null,h=function(e){f=e,sessionStorage.setItem(s.storageKey,e),l("syncBrowserID",{id:e})},_=function(){if(!f){var e;null===(e=window.du_web_sdk)||void 0===e||e.getBrowserID(s.apiKey,s.businessId,{},function(e){return h(e)})}},m=(0,a.I)(function(){p(s.lockId,function(){if(!f){var e=sessionStorage.getItem(s.storageKey);if(e){h(e);return}d().then(_)}})}),g=function(e){try{var t=new URL(e,"https://www.zhihu.com").hostname;return/\.zhihu\.(com|dev)$/.test(t)}catch(e){return!1}},T=function(){var e;return null===(e=u())||void 0===e||e.addEventListener("message",function(e){var t=e.data;t&&("syncBrowserID"===t.type?f=t.data.id:"requestBrowserID"===t.type&&f&&l("syncBrowserID",{id:f}))}),l("requestBrowserID"),function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.withDUBrowserID,c=(0,o._)(n,["withDUBrowserID"]);return g(t)&&a&&f?(0,i.A)((0,r._)({},s.browserIdKey,f))(e)(t,c):e(t,c)}}}},65003:function(e,t,n){"use strict";n.d(t,{n:function(){return r}});var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("update-link-card"!==e.getLastChangeType()){var n=t.offsetBottom,r=void 0===n?0:n,o=t.offsetTop,i=void 0===o?0:o,a=t.centerInView,c=void 0!==a&&a;requestAnimationFrame(function(){var t,n=e.getSelection().getIsBackward(),o=document.getSelection();if(o.rangeCount){var a=o.getRangeAt(0).cloneRange();a.collapse(n);var s=a.getBoundingClientRect();if(0===s.height){var u=a.commonAncestorContainer;if(1===u.nodeType&&(s=u.getBoundingClientRect()).height>30)return}0===s.height||(c?(t=s.bottom-window.innerHeight/2,window.scrollBy({left:0,top:t,behavior:"smooth"})):(t=s.bottom-(window.innerHeight-r))>0?window.scrollBy(0,t):s.top>=i&&s.top<=window.innerHeight||window.scrollBy(0,s.top-i-48))}})}}},35102:function(e,t,n){"use strict";n.d(t,{Xc:function(){return a},hu:function(){return c}});var r=n(76931),o=n.n(r);n(88423);var i={"video-count":"最多只能上传 10 个视频","video-count-one":"视频暂时只支持上传一个","video-size":"请上传大小不超过 2G 的视频","video-duration":"请上传不超过 60 分钟的视频","video-type":"暂不支持该文件格式","video-uploading":"视频上传完成后即可发布","video-uploading-draft":"视频上传完成后即可保存草稿","video-upload-cancelled":"匿名身份不能使用视频功能","video-uploading-entity-small":"请上传大小超过 100KB 的视频","video-upload-error":"视频上传失败，请重新上传","doc-size":"文档最大 10MB，请重新上传","doc-type":"暂不支持该文件格式","image-uploading":"图片上传完成后即可发布","mage-uploading-draft":"图片上传完成后即可保存草稿","video-and-image":"图片、视频暂时无法同时上传","unsupported-browser":"暂不支持的浏览器, 请更换浏览器后重试"};function a(e,t,n,r){if("image-upload-error"===e){n(o()(t,"payload.err.payload.message")||"图片上传失败，请重新上传","red",r);return}if(["doc-size","doc-type"].includes(e)){var a=(null==t?void 0:t.message)||i[e];n(a,"red",r,{shouldTrackShow:!0,zaText:"文档导入-".concat(a),zaBlock:"EditorInsertDoc",key:Date.now()});return}n(i[e],"red",r)}var c=function(e){return"string"==typeof e&&["Failed to fetch","Network request failed","NetworkError when attempting to fetch resource","网络连接已中断","请求超时"].some(function(t){return e.includes(t)})}},4785:function(e,t,n){"use strict";n.d(t,{Z:function(){return i},z:function(){return o}});var r=n(94009);function o(e){return new URLSearchParams(Object.entries(e).filter(function(e){return null!=(0,r._)(e,2)[1]}))}function i(e){return new URLSearchParams(Object.entries(e).map(function(e){var t=(0,r._)(e,2),n=t[0],o=t[1];return[n,null!=o?o:""]}))}},86172:function(e,t){"use strict";t.Z=function(e){var t=e.dataTransfer;return t.items?Array.from(t.items).filter(function(e){return"file"===e.kind}).map(function(e){return e.getAsFile()}):Array.from(t.files)}},43361:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(22943),o=[{protocol:"http{s}?",hostname:"{*.}?zhihu.(com|dev)"},{protocol:"http{s}?",hostname:"{*.}?vzuu.(com|dev)"},{protocol:"http{s}?",hostname:"{*.}?yanyangushi.(com|dev)"},{protocol:"http{s}?",hostname:"{*.}?yanyanstory.(com|cn)"}].map(function(e){return new URLPattern(e)}),i="https://zhihu.com",a=/^https?:\/\/|^\/\//,c=/^(javascript|data|file|vbscript|about|blob):/i;function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/";if("string"!=typeof e||"string"!=typeof t)throw TypeError("Invalid decodedUrl or defaultUrl");var n=e.trim();return!n||n===t||c.test(n)||n.includes("\\")?t:(0,r.Z)(function(){if(a.test(n)){var e=n.startsWith("//")?"https:".concat(n):n,r=new URL(e);return r.username||r.password||r.hostname.startsWith("xn--")?t:o.some(function(t){return t.test(e)})?n:t}return n.startsWith("/")&&new URL(n,i).origin===i?n:t},t)}},23113:function(e,t,n){"use strict";var r,o,i,a,c=n(9338),s=n(30971),u=n(4667),l=n.n(u),d="growth-chain",p={},f=new Promise(function(e){return a=e}),h=function(){return new Promise(requestAnimationFrame)},_=function(e){try{return e()}catch(e){}},m="https://www.zhihu.com",g=function(e){return _(function(){return localStorage.setItem(d,JSON.stringify(e))})},T=l()((0,c._)(function(){var e,t,n,r,o,i;return(0,s.__generator)(this,function(a){switch(a.label){case 0:return[4,f];case 1:if(!(e=a.sent().userId))return[2,null];if(t=_(function(){return JSON.parse(localStorage.getItem(d))}),n=new Date,!(!t||t.userId!==e||n>new Date(t.expiresAt)))return[3,3];return[4,fetch("".concat(m,"/api/v4/me/guides"),{credentials:"include"}).then(function(e){return e.json()})];case 2:return r=a.sent(),(o=new Date(n)).setDate(n.getDate()+1),g(i={userId:e,data:r,expiresAt:o}),[2,i];case 3:return[2,t]}})})),E=(r=(0,c._)(function(e){var t;return(0,s.__generator)(this,function(n){switch(n.label){case 0:return[4,fetch("".concat(m,"/api/v4/me/operation_guides/").concat(e.operation_guide_id_str),{method:"DELETE",credentials:"include"})];case 1:return n.sent(),[4,T()];case 2:return(t=n.sent())&&(t.data.actions=t.data.actions.filter(function(t){return t!==e}),g(t)),[2]}})}),function(e){return r.apply(this,arguments)}),y=(o=(0,c._)(function(e){var t;return(0,s.__generator)(this,function(n){switch(n.label){case 0:return[4,T()];case 1:return t=n.sent(),[4,h()];case 2:if(n.sent(),t)return[2,t.data.actions.filter(function(t){return e.includes(t.guide_name)})];return[2,[]]}})}),function(e){return o.apply(this,arguments)}),C=(i=(0,c._)(function(e){var t;return(0,s.__generator)(this,function(n){switch(n.label){case 0:return[4,T()];case 1:return t=n.sent(),[4,h()];case 2:if(n.sent(),t)return[2,t.data.actions.filter(function(t){return t.show_page===e})];return[2,[]]}})}),function(e){return i.apply(this,arguments)});t.Z={config:function(e){a(Object.assign(p,e))},markAsShown:E,getActionsByNames:y,getActionsByPage:C}},81374:function(e,t,n){"use strict";n.d(t,{K:function(){return o}});var r=n(40326),o=function(e,t,n,o){if(!(0,r.rD)(e)||!t||!n)return e;var i="draft_token=".concat(n);return"answer"===t&&(i=o?"draft_token=".concat(o):"question_token=".concat(n)),"".concat(e,"&").concat(i)}},48929:function(e,t,n){"use strict";n.d(t,{R:function(){return a}});var r=n(40326),o=n(88423),i=n(81374),a=function(e,t,n,a){var c=(0,r.rD)(e.src)?(0,i.K)(e.src,t,n,a):(0,o.imgUrl)(e.originalSrc||e.src,"1440w");return{src:c,url:c,originalSrc:(0,i.K)(e.originalSrc||e.src,t,n,a),watermarkSrc:e.watermarkSrc,privateWatermarkSrc:e.privateWatermarkSrc,watermark:e.watermark,rawWidth:e.dataRawwidth,rawHeight:e.dataRawheight,id:e.hash}}},1785:function(e,t,n){"use strict";function r(e,t){return!!e&&!!t&&(e.id===t.id&&void 0!==e.id||e.urlToken===t.urlToken&&void 0!==e.urlToken)}n.d(t,{Z:function(){return r}})},6148:function(e,t,n){"use strict";function r(e){try{return JSON.stringify(e)}catch(e){return""}}function o(e){try{return JSON.parse(e)}catch(e){return null}}n.d(t,{dj:function(){return o},hZ:function(){return r}})},59937:function(e,t,n){"use strict";n.d(t,{Qm:function(){return l},_x:function(){return u}});var r,o,i=n(18837),a=n.n(i),c=n(3343),s=(r=function(e){var t=new FormData;return t.append("items",JSON.stringify(e)),(0,c.Z)("/lastread/touch",{method:"POST",body:t})},o=[],a()(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o.push(t),setTimeout(function(){o.length&&(r(o),o.length=0)},550)},function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return String(t)})),u="read",l="touch";t.ZP=s},38765:function(e,t,n){"use strict";n.d(t,{NY:function(){return i},l6:function(){return o}});var r=n(80714),o=function(e){var t=e.title,n=e.originTitle,o=e.source,i=e.sourceId,a=e.productTypeName,c=new URLSearchParams({title:t,originTitle:n,source:o,sourceId:i,productTypeName:a}).toString();return"".concat(r.Z.protocol,"//").concat(r.Z.wwwHost,"/selection/goods-editor?").concat(c)},i=function(e){var t=e.contentId,n=e.contentType,o=new URLSearchParams({contentId:t,contentType:n}).toString();return"".concat(r.Z.protocol,"//").concat(r.Z.wwwHost,"/selection/profit-selector?").concat(o)}},39315:function(e,t,n){"use strict";n.d(t,{I:function(){return r}}),window.__MODULE_FEDERATION__={};var r=function(e,t){window.__MODULE_FEDERATION__[e]=t}},65744:function(e,t,n){"use strict";n.d(t,{t:function(){return u},y:function(){return l}});var r=n(55164),o=n(71728),i=n(85879),a=n(57730),c=n(19319),s=n(74351),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,r._)({delay:2e3},t),o=n.delay,a=n.theme,u=n.className;return(0,s.isBrowser)()?c.Z.show((0,i.tZ)(c.Z,{className:u,delay:o,notification:{text:e,theme:a}})):null},l=function(e,t){var n=t||{},c=n.content,s=(0,o._)(n,["content"]),u=c&&(0,i.tZ)("div",{style:{textAlign:"center"},children:c});return a.Z.confirm(u,(0,r._)({title:e},s))}},57138:function(e,t,n){"use strict";n.d(t,{DU:function(){return p},MN:function(){return l},Qu:function(){return d}});var r=n(94009),o=n(57045),i=n(74351),a=n(80714),c=n(64512),s=n(6148),u=function(e){var t=e||{},n=t.type,r=t.id,a=t.urlToken,c=t.q;switch(n){case"question":return"/questions/".concat(r);case"answer":return"/answers/".concat(r);case"article":case"p":return"/articles/".concat(r);case"column":return"/columns/".concat(r);case"live":return"/lives/".concat(r);case"ebook":case"book":return"/pub/book/".concat(r);case"feed":return"/feed";case"topic":return"/topics/".concat(r);case"pin":return"/pin/".concat(r);case"people":return"/people/".concat(a||r);case"search":return"/search".concat(c?"?".concat(o.stringify({q:c})):"");case"video":return"video_topic/".concat(r);case"zvideo":if((0,i.isBrowser)()){var s=new URL(location.href);if(!/^\d+$/.test(r)){var u="".concat(s.pathname.replace(/^\//,"")).concat(s.search);return"".concat(decodeURIComponent(u))}var l=s.searchParams.get("page");if(l)return"/zvideo/".concat(r,"?page=").concat(l)}return"/zvideo/".concat(r);case"theater":return"/theater/".concat(r);case"zvideo_answer":case"zvideo_article":var d=n.replace("zvideo_","");return"/".concat(d,"s/").concat(r);case"ai":return"/home/ai";default:return null}},l=function(e,t){var n=t?"?".concat(o.stringify(t)):"",r="string"==typeof e?e:u(e);if(r){var i=r.startsWith("/")?r.slice(1):r;return"zhihu://".concat(i).concat(n)}return"zhihu://".concat(n)},d=function(e){if(!e)return"/feed";try{var t=e.match(/(\/[\w]+)?(\/[\w-]+)?(\/[\w]+)?(\/[\w-]+)?/)||[],n=(0,r._)(t[3]&&t[4]?[t[3],t[4]]:[t[1],t[2]],2),o=n[0],i=n[1];return u({type:o.slice(1),id:null==i?void 0:i.slice(1)})||"/feed"}catch(e){return"/feed"}};function p(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!["/signin","/account/scan/third-login","/account/scan/third-landing"].some(function(e){return location.pathname.startsWith(e)})){var i="other";n.Android?i="android":n.iOS&&(i="ios");var u={type:e,os:i,appName:"heifetz",spanName:a.Z.currentEntry,release:(null==o?void 0:o.id)||"unknown",rawError:(0,s.hZ)(t),errorMessage:(null==t?void 0:t.message)||"unknown",errorName:(null==t?void 0:t.name)||"unknown"};null==window||null===(r=window.webReporter)||void 0===r||r.report("mweb_wechat_sdk",(0,c.Ss)(u))}}},70538:function(e,t,n){"use strict";function r(e){for(var t,n=e.replace(/(<noscript>).*?(<\/noscript>)/g,""),r=[],o=/<\s*img.*?>/g,i=/(zh-lightbox-thumb)|(Slideshow-swiperImage)/,a=/(data-original=").*?"/,c=null;c=null===(t=o.exec(n))||void 0===t?void 0:t[0];)if(i.test(c)){var s=a.exec(c);s&&r.push(s[0].split("data-original=")[1].replace(/"|\\/g,""))}return r}n.d(t,{Z:function(){return r}})},88197:function(e,t,n){"use strict";n.d(t,{g:function(){return r},v:function(){return o}});var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise(function(t){return setTimeout(t,e)})};function o(e){var t=[];return e.reduce(function(e,n){return e.then(function(){return n().then(function(e){t.push(e)})})},Promise.resolve()).then(function(){return t})}},4661:function(e,t,n){"use strict";n.d(t,{FH:function(){return l},co:function(){return d},O1:function(){return f},N4:function(){return h}});var r,o=n(87320),i=n(52905),a=n(66263),c=n(55164),s=n(57477),u=n(74135);function l(e,t){return t.reduce(function(t,n){return(0,s._)((0,c._)({},t),(0,o._)({},n,["request","success","failure"].reduce(function(t,r){return(0,s._)((0,c._)({},t),(0,o._)({},r,"".concat(e,"/").concat((0,u.camelize)(n.toLowerCase()),"/").concat(r)))},{})))},{})}function d(e,t){return t.reduce(function(t,n){return(0,s._)((0,c._)({},t),(0,o._)({},n,"".concat(e,"/").concat((0,u.camelize)(n.toLowerCase()))))},{})}var p=(r={},(0,o._)(r,a.fH,"username"),(0,o._)(r,100003,"username"),(0,o._)(r,100006,"username"),(0,o._)(r,a.Dm,"username"),(0,o._)(r,100029,"username"),(0,o._)(r,100030,"username"),(0,o._)(r,120017,"username"),(0,o._)(r,12e4,"captcha"),(0,o._)(r,120001,"captcha"),(0,o._)(r,120005,"captcha"),(0,o._)(r,100002,"password"),(0,o._)(r,100004,"password"),(0,o._)(r,100005,"password"),(0,o._)(r,a.o7,"digits"),(0,o._)(r,a.M,"digits"),(0,o._)(r,100085,"digits"),(0,o._)(r,403,"extra"),r);function f(e){var t=e.code,n=e.message,r=p[t]||"unknown";return(0,o._)({},r,n||"系统繁忙，请稍后再试")}function h(e){(0,i.i4)(!0),(0,i.L0)(e)}},32599:function(e,t,n){"use strict";n.d(t,{C4:function(){return l},Sv:function(){return c},b:function(){return a}});var r=n(18645),o=n(54231),i=n(94648),a={HydrateStart:"HydrateStart",HydrateEnd:"HydrateEnd",HydrateDuration:"HydrateDuration",OpenInAppButton:"OpenInAppButton",responseEnd:"responseEnd",domInteractive:"domInteractive",domContentLoadedEventStart:"domContentLoadedEventStart",domContentLoadedEventEnd:"domContentLoadedEventEnd",domContentLoadDuration:"domContentLoadDuration"},c="undefined"!=typeof window&&window.performance?window.performance:{mark:function(){return null},measure:function(){return null}},s=(0,i.I)(function(e){if(e.userAgent){var t=e.userAgent,n=[[t.Android,"Android"],[t.iOS,"iOS"],[t.HarmonyOS,"OpenHarmony"]].find(function(e){return e[0]});if(n)return n[1]}return"unknown"}),u=function(e,t,n,r){var o=Array.isArray(n)?n:[{name:n,getValue:function(e){return e[n]}}],i=new PerformanceObserver(function(e){var n=e.getEntries();n.length&&((r?[n[0]]:n).forEach(function(e){o.forEach(function(n){var o=r?n.name:e.name;if(a[o]){var i=n.getValue(e);i&&t({name:o,value:i})}})}),r&&i.disconnect())});return i.observe({type:e,buffered:!0}),i},l=function(e,t){if("function"==typeof PerformanceObserver){var n=s(e),i=function(e){var r;o.ZP.timing({name:(r=e.name,"WebVitals.".concat(t,".").concat(r,".FirstOptimization")),options:{version:n}},e.value,1)};u("mark",i,"startTime"),u("measure",i,"duration"),u("navigation",i,[{name:"responseEnd",getValue:function(e){return e.responseEnd}},{name:"domInteractive",getValue:function(e){return e.domInteractive}},{name:"domContentLoadedEventStart",getValue:function(e){return e.domContentLoadedEventStart}},{name:"domContentLoadedEventEnd",getValue:function(e){return e.domContentLoadedEventEnd}},{name:"domContentLoadDuration",getValue:function(e){return e.domContentLoadedEventEnd-e.domContentLoadedEventStart}}],!0),(0,r.U9)(i)}}},98606:function(e,t,n){"use strict";var r=n(44073),o=n(55462);t.Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o.Z)("ui/showToast").dispatch({icon:"fail",text:(0,r.n$)(e)})}},54826:function(e,t,n){"use strict";n.d(t,{LP:function(){return a},ZP:function(){return s},qz:function(){return c}});var r=n(67516),o=n.n(r),i="uhiuhvk_wrnhq";function a(){return o().get(i)}function c(){o().delete(i)}function s(e){o().set(i,JSON.stringify({token:e,timestamp:Date.now()}))}},93547:function(e,t,n){"use strict";function r(e,t){for(var n,r=0,o="",i=e.length,a=0;a<i&&(128>(n=e[a]).charCodeAt(0)?r+=1:r+=2,o+=n,!(r>=t-1));a+=1);return o}n.d(t,{NJ:function(){return i},Vq:function(){return a},Vt:function(){return c},Xs:function(){return s}});var o=null;function i(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"…",c=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"undefined"==typeof document?t=r(n=e.replace(/<.+?>/g,""),i):((o=o||document.createElement("div")).textContent=e,t=r(n=o.textContent.replace(/<.+?>/g,""),i));var s=!1;return t!==n&&(s=!0,t=t.slice(0,t.length-a.length)+a),c?{output:t,truncated:s}:t}function a(e){return/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g.test(e)}var c=function(e){return e?e.replace(/<.+?>/g,""):""},s=function(e,t){return Array.from(t?c(e):e).length}},25669:function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];var i=r[r.length-1]||{};return n.reduce(function(t,n,o){return t.concat(Number.isInteger(n)&&r[n]||i[n],e[o+1])},[e[0]]).join("")}}n.d(t,{Z:function(){return r}})},79091:function(e,t,n){"use strict";n.d(t,{D:function(){return o}});var r=n(94009),o=function(e,t){try{if(!e||"string"!=typeof e)return"";if(!t||"object"!=typeof t||!Object.keys(t))return e;var n=(0,r._)(e.split("#"),2),o=n[0],i=n[1],a=void 0===i?"":i,c=(0,r._)(o.split("?"),2),s=c[0],u=c[1],l=new URLSearchParams(u);Object.entries(t).forEach(function(e){var t=(0,r._)(e,2),n=t[0],o=t[1];null!=o&&l.set(n,o)});var d=function(e,t){return t?e+t:""};return s+d("?",l.toString())+d("#",a)}catch(t){return console.error(t),e}}},89694:function(e,t,n){"use strict";n.d(t,{D3:function(){return c},LU:function(){return a}});var r=n(78110),o=n.n(r),i=n(66263);function a(e){return"number"!=typeof e?null:"".concat(String(Math.floor(e/60)),":").concat(o()(String(Math.floor(e%60)),2,"0"))}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.multiple,r=void 0!==n&&n,o=t.numLimit,a=void 0===o?i.lM:o,c=t.uploadPartiallyWhenExceedsLimit,s=Array.from(e).filter(function(e){return i.CZ.VIDEO.some(function(t){return e.name.toLowerCase().endsWith(t)})});if(0===s.length)return{message:"视频格式不支持",abortUpload:!0};var u=s.filter(function(e){return e.size>102400});return 0===u.length?{message:"视频必须大于 100KB，请重新选择上传",abortUpload:!0}:!r&&u.length>1?{message:"一次仅能上传一个视频，请分开上传",abortUpload:!1,validFiles:[u[0]]}:r&&u.length>a?0===a?{message:"上传个数已达上限",abortUpload:!0}:void 0===c||c?{message:"最多可上传 ".concat(a," 个视频，已默认选择").concat(a>1?"前":"第"," ").concat(a," 个视频"),abortUpload:!1,validFiles:u.slice(0,a)}:{message:"一次最多上传 ".concat(a," 个视频, 请重新选择上传"),abortUpload:!0}:{message:null,abortUpload:!1,validFiles:u}}},77440:function(e,t,n){"use strict";n.d(t,{Ef:function(){return d},aF:function(){return h}});var r=n(55164),o=n(49899),i=n(97614),a=n(54231),c=n(66111),s=n.n(c),u=n(69383),l={2555:{id:2555,name:"SEM落地页顶部下载点击"},2556:{id:2556,name:"SEM落地页按钮下载点击"},2557:{id:2557,name:"SEM落地页内容下载点击"}},d=function(e,t){var n="number"==typeof t?l[t]:t;"object"==typeof n&&u.Z.trackEvent(e&&e.currentTarget,(0,r._)({action:"Click"},n))},p=["a","b","c","d","e","f","g","h","i","j","k","l"],f=function(e,t){var n=Array(8).fill("").map(function(){return p[s()(11)]}).join("");new Image().src="https://lens.zhihu.com/report?type=msg&msg=".concat(e,"&dummy=").concat(n,"&uploadtype=").concat(t)};function h(e,t){return function(n){for(var r=arguments.length,c=Array(r>1?r-1:0),s=1;s<r;s++)c[s-1]=arguments[s];var u=Date.now(),l=["upload",t?"new":"old",void 0===n?"undefined":(0,i._)(n),n&&n.size?"normal":"empty"].join("_"),d=(0,a.HP)({appName:"heifetz"})("image.".concat((0,a.j0)(),".").concat(l));return a.ZP.increment({raw:"".concat(d,".start.count")}),f("puploadcount",l),Promise.resolve(e.apply(void 0,[n].concat((0,o._)(c)))).then(function(e){var t=Date.now();return f("psuccesscount",l),a.ZP.increment({raw:"".concat(d,".success.count")}),a.ZP.timing({raw:"".concat(d,".success")},t-u),e}).catch(function(e){throw a.ZP.increment({raw:"".concat(d,".error.count")}),f("pfailedcount",l),e})}}},93883:function(e,t,n){"use strict";var r=n(55164),o=n(85879),i=n(84871),a=n.n(i),c=n(63638);t.Z=function(e){return function(t){return a()(function(n){return(0,c.usePageInfo)(e),(0,o.tZ)(t,(0,r._)({},n))},t)}}},26921:function(e,t,n){"use strict";n.d(t,{H2:function(){return b},Z1:function(){return A}});var r=n(55164),o=n(57477),i=n(94009),a=n(85879),c=n(91850),s=n(29229),u=n(65733),l=n(7835),d=n(84871),p=n.n(d),f=n(88329),h=n.n(f),_=n(87363),m=n(80714),g=n(50953),T=n(81956),E="".concat(m.Z.fetchRoot.api,"/content/publish/control/v2"),y={init:!0},C={write:{instruction:!1,msg:""},contribute:{instruction:!1,msg:""},anonymous:{instruction:!1,msg:""}},S=(0,_.createContext)(void 0),I=function(e){return function(t){return p()(function(d){var p,f=(0,i._)((0,c.k)(!1),2),m=f[0],I=f[1],A=(0,i._)((0,_.useState)(!0),2),b=A[0],w=A[1],Z=(0,i._)((0,_.useState)(C),2),x=Z[0],k=Z[1],R=(0,r._)({},y,e),N=(0,g.n)(),O=(0,T.Z)(),P=(0,_.useRef)({onClose:h()}),D=(0,s._)(function(){return n.e(5634).then(n.bind(n,4238))},N),L=(0,u.A)(function(e){var t=e.getScene(d);return O(E,{method:"GET",query:(0,r._)({scene:t.type},t.token&&{questionToken:t.token})}).then(function(e){return e.payload})}),M=(0,u.A)(function(e){P.current.onClose=e}),B=(0,_.useMemo)(function(){return{commands:x,setOnModalClose:M,isLoading:b}},[x,M,b]),U=(0,u.A)(function(){var e,t;I.off(),null===(e=P.current)||void 0===e||null===(t=e.onClose)||void 0===t||t.call(e)});return(0,l.b)(function(){R.init&&"function"==typeof R.getScene&&N&&L(R).then(function(e){var t=e.data;k(t),t.write.instruction&&I.on()}).finally(function(){w(!1)})}),(0,a.BX)(S.Provider,{value:B,children:[D?(0,a.tZ)(D,{show:m,text:(null==x?void 0:null===(p=x.write)||void 0===p?void 0:p.msg)||"系统升级中，敬请谅解",onClose:U}):null,(0,a.tZ)(t,(0,o._)((0,r._)({},d),{writeShield:B}))]})},t)}},A=function(){return(0,_.useContext)(S)},b=I({init:!0,getScene:function(e){return e.writeScene}})(function(e){var t=e.writeShield,n=e.onClose;return(0,l.b)(function(){t.setOnModalClose(function(){null==n||n()})}),null});t.ZP=I},89146:function(e,t,n){"use strict";var r=n(84871),o=n.n(r);t.Z=function(e,t){return function(n){var r=t(n);return o()(r,n),r.displayName||(r.displayName="".concat(e,"(").concat(n.displayName||n.name||"Component",")")),r}}},83290:function(e,t,n){"use strict";n.d(t,{u:function(){return c}});var r=n(55164),o=n(57477),i=n(85879),a=n(87363);function c(e){return function(t){var n=(0,a.useRef)(null);(0,a.useEffect)(function(){return function(){null!==n.current&&(cancelAnimationFrame(n.current),n.current=null)}},[]);var c=(0,a.useCallback)(function(e){null!==n.current&&cancelAnimationFrame(n.current),n.current=requestAnimationFrame(function(){try{e()}catch(e){console.error("Failed to execute AI image feature:",e)}finally{n.current=null}})},[]);return(0,i.tZ)(e,(0,o._)((0,r._)({},t),{scheduleAIImageFeature:c}))}}},48504:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(85626),l=n(85879),d=n(84871),p=n.n(d),f=n(87363);t.Z=function(e){return function(t){var n=e.shouldLoad,d=void 0===n?function(e){return!e.isDrained}:n,h=e.load,_=function(e){(0,c._)(p,e);var n=(0,u._)(p);function p(){var e;return(0,o._)(this,p),e=n.apply(this,arguments),(0,a._)((0,r._)(e),"load",function(){return h(e.props,e.state)}),e}return(0,i._)(p,[{key:"componentDidMount",value:function(){d(this.props,this.state)&&this.load()}},{key:"componentDidUpdate",value:function(e,t){var n=d(e,t),r=d(this.props,this.state);r&&r!==n&&this.load()}},{key:"render",value:function(){return(0,l.tZ)(t,(0,s._)({},this.props))}}]),p}(f.Component);return p()(_,t)}}},45842:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(85879),a=n(84871),c=n.n(a),s=n(92258),u=n(58909);(0,s.connect)(function(e){return{currentUser:(0,u.ib)(e)}}),t.Z=function(e){return c()(function(t){var n=(0,s.useSelector)(function(e){return(0,u.ib)(e)});return(0,i.tZ)(e,(0,o._)((0,r._)({},t),{isLogin:n&&"guest"!==n.userType,currentUser:n}))},e)}},85576:function(e,t,n){"use strict";n.d(t,{M:function(){return p}});var r=n(87320),o=n(55164),i=n(85879),a=n(84871),c=n.n(a),s=n(14168),u=n.n(s),l=n(87363),d=n(45842),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"authRequired";return function(t){var n=function(n,a){var c=a.authRequired,s=void 0===c?function(){}:c,u=(0,l.useRef)(s);u.current=s;var d=(0,l.useMemo)(function(){return(0,r._)({},e,u.current)},[]);return(0,i.tZ)(t,(0,o._)({},n,d))};return n.contextTypes={authRequired:u().func},c()((0,d.Z)((0,l.memo)(n)),t)}},f=p();t.Z=f},55679:function(e,t,n){"use strict";n.d(t,{b8:function(){return y},dF:function(){return m},dT:function(){return T},nx:function(){return E}});var r=n(55164),o=n(57477),i=n(85879),a=n(87363),c=n(39658),s=n(92258),u=n(84871),l=n.n(u),d=n(67814),p=n.n(d),f=n(98329),h=n.n(f),_=n(68900),m=(0,a.memo)(function(e){var t,n=e.className,r=Object.keys(t=(0,s.useSelector)(_.Uh)).filter(function(e){return h()(t[e])&&t[e]}).filter(function(e){return"Mobile"!==e||!t.Tablet}).map(function(e){return"Body--".concat(e)});return(0,i.tZ)(c.ql,{children:(0,i.tZ)("body",{className:p()(n,r)})})}),g=function(e){return function(t){var n=(0,a.forwardRef)(function(n,a){return(0,i.BX)(i.HY,{children:[(0,i.tZ)(m,{className:e}),(0,i.tZ)(t,(0,o._)((0,r._)({},n),{ref:a}))]})});return l()(n,t)}},T=g("LightGreyBg-body"),E=g("WhiteBg-body"),y=g("GreyBg-body");t.ZP=g},65277:function(e,t,n){"use strict";n.d(t,{Yz:function(){return T},l:function(){return g}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(49899),l=n(85626),d=n(85879),p=n(84871),f=n.n(p),h=n(87363),_=n(65744),m={isBadBrowserPlugin:void 0},g=function(){return(0,u._)(document.querySelectorAll("script")).filter(function(e){var t;return null===(t=e.src)||void 0===t?void 0:t.startsWith("chrome-extension://")}).map(function(e){return e.src})},T=function(){return m.isBadBrowserPlugin};t.ZP=function(e){var t=function(t){(0,c._)(u,t);var n=(0,l._)(u);function u(){var e;return(0,o._)(this,u),e=n.apply(this,arguments),(0,a._)((0,r._)(e),"state",{isBadBrowserPlugin:!1}),(0,a._)((0,r._)(e),"checkerRef",(0,h.createRef)()),(0,a._)((0,r._)(e),"count",0),(0,a._)((0,r._)(e),"detect",function(){if(e.count++,!(e.count>10)){if(!e.checkerRef.current){setTimeout(e.detect,3e3);return}var t,n=window.getComputedStyle(e.checkerRef.current);if("none"===n.userSelect||"none"===n.webkitUserSelect){setTimeout(e.detect,3e3),m.isBadBrowserPlugin=!1;return}if(e.setState({isBadBrowserPlugin:!0}),m.isBadBrowserPlugin=!0,(0,_.y)("温馨提示",{content:(0,d.BX)(d.HY,{children:[(0,d.tZ)("p",{children:"检测到您安装了某些破解复制的浏览器插件。"}),(0,d.tZ)("p",{children:"这些插件可能会导致您的内容丢失。"}),(0,d.tZ)("p",{children:"建议您移除后再使用编辑器。"})]}),text:{cancel:"仍要继续",ok:"已移除，重新检测"}}).then(function(){window.location.reload()}).catch(function(){return null}),null===(t=e.props.reporter)||void 0===t?void 0:t.reportFail){var r=Error("bad browser plugin detected");r.payload={url:window.location.href},e.props.reporter.reportFail("BadBrowserPlugin",r)}}}),e}return(0,i._)(u,[{key:"componentDidMount",value:function(){this.detect()}},{key:"render",value:function(){return(0,d.BX)(d.HY,{children:[(0,d.tZ)(e,(0,s._)({},this.props)),(0,d.tZ)("p",{ref:this.checkerRef,css:{userSelect:"none",display:"none"}})]})}}]),u}(h.Component);return f()(t,e)}},23071:function(e,t,n){"use strict";n.d(t,{$:function(){return h}});var r=n(55164),o=n(71728),i=n(49899),a=n(85879),c=n(65733),s=n(87363),u=n(6786),l=n(80714),d=n(54231),p=function(e){if(0!==e.length&&!((null===(t=l.Z.apollo)||void 0===t?void 0:t.editor_convert_report_metric)!=="1")){var t,n=(function(e){var t=new Map,n=new Map,r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var s=a.value,u=s.name,l=s.source,d=s.duration;t.set(u,(t.get(u)||0)+1);var p="".concat(u,"::").concat(l),f=n.get(p);f||(f={name:u,source:l,durations:[],sum:0},n.set(p,f)),f.durations.push(d),f.sum+=d}}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}var h=[],_=!0,m=!1,g=void 0;try{for(var T,E=n.values()[Symbol.iterator]();!(_=(T=E.next()).done);_=!0)!function(){var e=T.value,n=e.name,r=e.source,o=e.durations,i=e.sum,a=o.length;o.sort(function(e,t){return e-t});var c=function(e){return o[Math.max(0,Math.min(Math.ceil(e*a)-1,a-1))]};h.push({spanName:"EditorConvert.".concat(n,".").concat(r),data:{count:t.get(n),sourceCount:a,avgDuration:Number((i/a).toFixed(2)),p95Duration:c(.95),p99Duration:c(.99)}})}()}catch(e){m=!0,g=e}finally{try{_||null==E.return||E.return()}finally{if(m)throw g}}return h})(e).map(function(e){return{spanName:e.spanName,data:e.data,sampleRate:1}});n.length&&(0,d.nP)(n)}},f=n(82321),h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.flushPolicy,d=void 0===n?"blur":n,h=(0,s.forwardRef)(function(t,n){var h,_,m,g=t.flushPolicy,T=t.onBlur,E=(0,o._)(t,["flushPolicy","onBlur"]),y=(0,s.useRef)(null),C=(0,s.useRef)([]),S=(0,s.useRef)([]),I=(0,f.Z)(),A=(0,c.A)(function(e){y.current=e,I()}),b=g||d,w=null===(h=y.current)||void 0===h?void 0:null===(_=h.EditableCore)||void 0===_?void 0:_.getEditorKey(),Z=(null===(m=l.Z.apollo)||void 0===m?void 0:m.editor_convert_report_metric)==="1",x=(0,c.A)(function(e){e.current.length>0&&(p(e.current),e.current=[])});(0,s.useEffect)(function(){if(w&&Z){var e=u.YY.subscribe({next:function(e){"destroy"===b?C.current.push(e):"blur"===b&&S.current.push(e)}},{filter:{editorKey:w}});return function(){var t;null===(t=e.unsubscribe)||void 0===t||t.call(e),"destroy"===b?x(C):"blur"===b&&x(S)}}},[w,b,Z,x]);var k=(0,c.A)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];x(S),null==T||T.apply(void 0,(0,i._)(t))});(0,s.useEffect)(function(){if("destroy"===b&&Z){var e=function(){x(C)},t=function(){"hidden"===document.visibilityState&&x(C)};return window.addEventListener("pagehide",e),window.addEventListener("beforeunload",e),document.addEventListener("visibilitychange",t),function(){window.removeEventListener("pagehide",e),window.removeEventListener("beforeunload",e),document.removeEventListener("visibilitychange",t)}}},[b,Z,x]);var R=(0,r._)({},E,"blur"===b?{onBlur:k}:{onBlur:T});return(0,s.useImperativeHandle)(n,function(){return y.current}),(0,a.tZ)(e,(0,r._)({ref:A},R))});return h.displayName="withEditorMetricReport(".concat(e.displayName||e.name||"Component",")"),h}},3028:function(e,t,n){"use strict";var r=n(22107),o=n(94707),i=n(86325),a=n(55164),c=n(57477),s=n(85626),u=n(85879),l=n(87363),d=n(84871),p=n.n(d),f=n(70400);t.Z=function(e){return function(t){var n=function(n){(0,i._)(p,n);var d=(0,s._)(p);function p(){return(0,r._)(this,p),d.apply(this,arguments)}return(0,o._)(p,[{key:"render",value:function(){var n=e&&!(0,l.isValidElement)(e)?e:{replacement:e};return(0,u.tZ)(f.SV,(0,c._)((0,a._)({},n),{children:(0,u.tZ)(t,(0,a._)({},this.props))}))}}]),p}(l.Component);return p()(n,t)}}},77878:function(e,t,n){"use strict";var r=n(55164),o=n(85879),i=n(66011),a=n(84871),c=n.n(a);t.Z=function(e){return function(t){return c()(function(n){return(0,o.tZ)(i.BM,{query:e,children:(0,o.tZ)(t,(0,r._)({},n))})},t)}}},22566:function(e,t,n){"use strict";n.d(t,{U:function(){return p}});var r=n(55164),o=n(57477),i=n(94009),a=n(85879),c=n(7835),s=n(84871),u=n.n(s),l=n(87363),d=n(81956),p=function(e){return function(t){return u()(function(n){var s=(0,d.Z)(),u=(0,i._)((0,l.useState)(),2),p=u[0],f=u[1];return(0,c.b)(function(){var t=e(n);t&&s(t).then(function(e){var t;return f(null===(t=e.payload)||void 0===t?void 0:t.data)})}),(0,a.tZ)(t,(0,o._)((0,r._)({},n),{paidColumnContent:p}))},t)}}},96485:function(e,t,n){"use strict";n.d(t,{g:function(){return s},k:function(){return c.ks}});var r=n(55164),o=n(85879),i=n(84871),a=n.n(i),c=n(76976),s=function(e){var t=e.scene;return function(e){return a()(function(n){return(0,o.tZ)(c.g_,{scene:t,children:(0,o.tZ)(e,(0,r._)({},n))})},e)}}},30256:function(e,t,n){"use strict";var r=n(55164),o=n(85879),i=n(63638),a=n(84871),c=n.n(a);t.Z=function(e){return c()(function(t){var n=(0,i.useTracker)().trackEvent;return(0,o.tZ)(e,(0,r._)({trackEvent:n},t))},e)}},92718:function(e,t,n){"use strict";n.d(t,{h:function(){return a}});var r=n(55164),o=n(92258),i=n(7407),a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,o.useSelector)(function(n){return(0,i.tQ)(n,(0,r._)({paramId:e},t))})};t.Z=a},25734:function(e,t,n){"use strict";n.d(t,{W5:function(){return c},ZP:function(){return u},mv:function(){return a},pe:function(){return s}});var r=n(55164),o=n(57477),i=n(92258),a={normal:{logo:"primary",navActiveColor:"primary",headerTitle:"GBL01A"},custom:{logo:"GBK99B",boxShadow:"none",icon:"GBK99B",iconOpacity:"0.9",navColor:"GBK99B",navOpacity:"0.75",navActiveColor:"GBK99B",headerTitle:"GBK99B",searchInputColor:"GBK99B",searchButtonColor:"GBL01A",searchButtonBg:"GBK99B",searchButtonOpacity:"0.9",searchAreaColor:"GBK99B",searchBorder:"none",searchBorderColor:"transparent",searchPlaceHolderOpacity:"0.75",searchInputOpacity:"0.2",searchIconOpacity:"0.8"}},c=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return{transitionProperty:"".concat(t.join(",")),transitionDuration:"0.25s",transitionTimingFunction:"ease-in"}},s=function(e){return function(t){return e.colors[t]||t}};function u(){var e=(0,i.useSelector)(function(e){return e.env.appHeaderTheme}),t=e.current,n=e[t].bgColor;return(0,o._)((0,r._)({type:t,bgColor:n},a[t]),{themeTransition:c})}},78970:function(e,t,n){"use strict";var r=n(94009),o=n(91850),i=n(65733);t.Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,r._)((0,o.k)(t),2),a=n[0],c=n[1];return{modalShown:a,openVotersModal:(0,i.A)(function(){e(function(){c.on()})()}),closeVotersModal:(0,i.A)(function(){c.off()})}}},50953:function(e,t,n){"use strict";n.d(t,{n:function(){return u}});var r=n(49899),o=n(38322),i=n.n(o),a=n(87363),c=n(92258),s=n(58909),u=function(){return(0,c.useSelector)(s.dd)};t.Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(0,c.useDispatch)(),n=(0,c.useSelector)(function(t){return i()((0,s.ib)(t),e)},c.shallowEqual);return(0,a.useEffect)(function(){t((0,s.sF)(e))},[t].concat((0,r._)(e))),n}},62095:function(e,t,n){"use strict";var r=n(92258),o=n(58909);t.Z=function(){var e=(0,r.useSelector)(function(e){return(0,o.ib)(e)}),t=(0,r.useSelector)(function(e){return e.switches}),n="https://www.zhihu.com";if("undefined"!=typeof window){var i=window.location,a=i.hostname,c=i.origin,s=[".zpres.zhihu.dev",".zpres.zhihu.com"].some(function(e){return a.endsWith(e)}),u=c.replace(/\D+/g,"");s&&u&&(n="https://heifetz--box-".concat(u,"--www-zhihu-com.zpres.zhihu.").concat(a.slice(-3)))}return{jumpUrl:e&&!e.isOrg&&t&&t.isCreator?"".concat(n,"/creator/editor-setting"):"".concat(n,"/knowledge-plan/editor-setting")}}},45804:function(e,t,n){"use strict";n.d(t,{T:function(){return u},g:function(){return s}});var r=n(55164),o=n(71728),i=n(85879),a=n(87363),c=(0,a.createContext)({}),s=function(){return(0,a.useContext)(c)},u=function(e){var t=e.children,n=(0,o._)(e,["children"]),s=(0,a.useContext)(c),u=(0,a.useRef)((0,r._)({},s,n)).current;return(0,i.tZ)(c.Provider,{value:u,children:t})}},82321:function(e,t,n){"use strict";var r=n(94009),o=n(65733),i=n(87363);t.Z=function(){var e=(0,r._)((0,i.useState)(0),2)[1];return(0,o.A)(function(){return e(function(e){return e+1})})}},99281:function(e,t,n){"use strict";n.d(t,{Bn:function(){return c},aO:function(){return u},j1:function(){return l},n2:function(){return a}});var r=n(15030),o=n(87363),i=n(74124),a=function(e){var t=e,n=new Set;return{initial:e,get current(){return t},set current(v){t=v,n.forEach(function(e){return e()})},subscribe:function(e){return n.add(e),function(){return n.delete(e)}}}},c=function(e,t){var n=(0,o.useRef)(function(t){e.current=(0,r._)(t,Function)?t(e.current):t}).current,i=(0,o.useRef)(t);return i.current=t,(0,o.useRef)(function(t){n(i.current?i.current(e.current,t):t)}).current},s=function(e){return e},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s;return(0,i.useSyncExternalStore)(e.subscribe,function(){return t(e.current)},function(){return t(e.current)})},l=function(e,t,n){return[u(e,t),c(e,n)]}},32380:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(9338),o=n(30971),i=n(65733),a=n(92258),c=n(55542),s=n(48929),u=n(67927),l=n(42308);function d(){var e,t=(0,a.useDispatch)(),n=(0,i.A)(function(e){var t=(0,c.e)(e);if(t)return(0,u.c0)(t,"red")});return{handleUploadImage:(0,i.A)((e=(0,r._)(function(e){return(0,o.__generator)(this,function(r){return[2,t((0,l.Ix)(e)).then(function(e){return e.payload}).then(function(e){return(0,s.R)(e)}).catch(function(e){throw n(e),e})]})}),function(t){return e.apply(this,arguments)})),handleUploadImageError:n}}},80550:function(e,t,n){"use strict";n.d(t,{F:function(){return d},J:function(){return l}});var r=n(94009),o=n(91850),i=n(36892),a=n(7835),c=n(87363),s=n(32210),u=n(32599),l=function(e){var t=e||0,n=(0,r._)((0,o.k)(!1),2),c=n[0],u=n[1],l=(0,i.N)(function(e,n){n.scroll.top>t?u.on():u.off()},100);return(0,a.b)(function(){var e=(0,s.subscribe)("scroll",l,{enableScrollInfo:!0});return function(){e.unsubscribe()}}),c},d=function(e){var t=(0,r._)((0,o.k)(!1),2),n=t[0],l=t[1],d=(0,c.useRef)(!0),p=(0,i.N)(function(){d.current=!0,l.on()},1e3);return(0,a.b)(function(){var t=setTimeout(function(){u.Sv.mark(u.b.OpenInAppButton),d.current=!0,l.on()},1500);if(!e)return function(){clearTimeout(t)};var n=(0,s.subscribe)("scroll",function(){d.current&&(d.current=!1,l.off())}),r=(0,s.subscribe)("scroll",p);return function(){n.unsubscribe(),r.unsubscribe(),clearTimeout(t)}}),n}},81956:function(e,t,n){"use strict";n.d(t,{Z:function(){return i},q:function(){return o}});var r=n(87363),o=(0,r.createContext)(null);function i(){return(0,r.useContext)(o)}},17727:function(e,t,n){"use strict";n.d(t,{Ge:function(){return i},WI:function(){return a},YY:function(){return o}});var r=n(87363),o=(0,r.createContext)();t.ZP=function(){return(0,r.useContext)(o)};var i=(0,r.createContext)(),a=function(){return(0,r.useContext)(i)}},16850:function(e,t,n){"use strict";n.d(t,{$:function(){return u}});var r=n(55164),o=n(57477),i=n(85879),a=n(84871),c=n.n(a),s=n(7407);t.Z=s.dD;var u=function(e){return function(t){return c()(function(n){return(0,i.tZ)(t,(0,o._)((0,r._)({},n),{isMobile:(0,s.dD)(e)}))},t)}}},89774:function(e,t,n){"use strict";var r=n(92258),o=n(7407);t.Z=function(){return(0,r.useSelector)(o.Xj)}},36374:function(e,t,n){"use strict";var r=n(92258),o=n(58909);t.Z=function(){return(0,r.useSelector)(o.W5)}},9278:function(e,t,n){"use strict";n.d(t,{Fd:function(){return m},uk:function(){return h},xK:function(){return o}});var r,o,i=n(55164),a=n(57477),c=n(71728),s=n(85879),u=n(84871),l=n.n(u),d=n(87363);(r=o||(o={})).CommentEditor="comment_editor",r.PinEditor="pin_editor",r.QuestionEditor="question_editor",r.AnswerEditor="answer_editor",r.ArticleEditor="article_editor";var p=(0,d.createContext)(null);function f(e){var t=e.scene,n=e.children;return(0,s.tZ)(p.Provider,{value:{scene:t},children:n})}function h(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.pageSize,r=void 0===n?20:n,o=(null!=(e=(0,d.useContext)(p))?e:{}).scene;return{mentionSuggestionConfig:(0,d.useMemo)(function(){return o?{adapter:{version:"2.1",props:{loaderOnMount:!0,useMenuLoader:!0,useNewUserItem:!0,scene:o,limit:r}}}:void 0},[o,r])}}function _(e){var t=e.Component,n=e.mentionConfigOptions,r=(0,c._)(e,["Component","mentionConfigOptions"]),o=h(n);return(0,s.tZ)(t,(0,i._)({},r,o))}function m(e){var t=e.scene,n=(0,c._)(e,["scene"]);return function(e){var r=function(r){return(0,s.tZ)(f,{scene:t,children:(0,s.tZ)(_,(0,a._)((0,i._)({Component:e},r),{mentionConfigOptions:n}))})};return r.displayName="withMention(".concat(t,")(").concat(e.displayName||e.name||"Component",")"),l()(r,e)}}},96955:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(71728),a=n(94009),c=n(85879),s=n(13649),u=n(6907),l=n(87363),d=n(87641),p=n(31467),f=n(25452),h=n(67689),_=function(e){var t=e.title,n=e.content,u=e.ok,h=e.cancel,_=e.onOk,m=e.onCancel,g=e.disabled,T=(0,i._)(e,["title","content","ok","cancel","onOk","onCancel","disabled"]),E=(0,a._)((0,l.useState)(!0),2),y=E[0],C=E[1],S=(0,a._)((0,l.useState)(!1),2),I=S[0],A=S[1],b=function(e){return function(){C(!1),A(!0),e()}},w=(0,s.n)();return(0,c.tZ)(p.Z,(0,o._)((0,r._)({closeButton:null,maskClosable:!1,hotKeyClosable:!1,css:[{overflow:"hidden",maxWidth:"96vw",".Modal-content":{margin:0,padding:0}},w.Mobile&&{width:320,borderRadius:12,boxShadow:""}]},T),{children:y&&(0,c.BX)(d.xu,{px:"36px",py:"24px",children:[t&&(0,c.tZ)(d.xv,{fontSize:"18px",lineHeight:"28px",fontWeight:"bold",textAlign:"center",children:t}),n&&(0,c.tZ)(d.xv,{mt:t?"16px":"0",fontSize:"14px",lineHeight:"normal",color:"GBK03A",maxHeight:"calc(67vh - 100px)",css:{wordBreak:"break-all",overflowY:"auto",WebkitOverflowScrolling:"touch",marginRight:-10,paddingRight:10},children:n}),(0,c.BX)(d.kC,{mt:"16px",css:{button:{padding:0,flex:1,height:36,lineHeight:1,fontSize:15,borderRadius:4,":active":{opacity:.6}}},justifyContent:"center",fontWeight:"bold",children:[h&&(0,c.tZ)(f.ZP,{css:{marginRight:4},onClick:b(m),children:h}),(0,c.tZ)(f.ZP,{preset:"primary",color:"blue",css:{maxWidth:"60%"},onClick:b(_),disabled:g||I,children:u})]})]})}))};t.Z=function(){var e=(0,h.Z)(),t=e.addInstance,n=e.removeInstance,o=function(e){return setTimeout(function(){return n(e)},300)};return{alert:function(e){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=a.title,l=a.ok,d=(0,i._)(a,["title","ok"]);return new Promise(function(o){t(n=(0,c.tZ)(_,(0,r._)({content:e,title:s,ok:l||"确定",onOk:o,css:{textAlign:"center"}},d),(0,u.E)("modal")))}).finally(function(){return o(n)})},confirm:function(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.title,a=r.ok,s=r.cancel,l=r.disabled;return new Promise(function(r,o){t(n=(0,c.tZ)(_,{content:e,title:i,ok:a||"确定",onOk:r,cancel:s||"取消",onCancel:o,disabled:l},(0,u.E)("modal")))}).finally(function(){return o(n)})}}}},35502:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r=n(94009),o=n(38151),i=n(65733),a=n(58338),c=n(68159),s=n(87363),u=new(n(11197)).EventEmitter,l=Symbol("useAllowOnePlayer/startPlay"),d=!1,p=function(e){var t=e.videoId,n=e.iframeRef,p=(0,r._)((0,s.useState)(null==n?void 0:n.current),2),f=p[0],h=p[1],_=(0,r._)((0,o.Y)({threshold:.5}),2),m=_[0],g=_[1],T=(0,r._)((0,s.useState)((0,c.Wn)(t,"*",!0)),2),E=T[0],y=T[1],C=(0,s.useRef)(!1),S=(0,i.A)(function(){!g&&(null==f?void 0:f.contentWindow)&&C.current&&!d&&E.dispatchMessage(null==f?void 0:f.contentWindow,c.aO.PAUSE,{dontApplyOnFullScreen:!0})}),I=(0,i.A)(function(e){t!==e.sourceId&&(null==f?void 0:f.contentWindow)&&E.dispatchMessage(f.contentWindow,c.aO.PAUSE)}),A=(0,i.A)(function(){C.current=!0,u.emit(l,{sourceId:t})}),b=(0,i.A)(function(){C.current=!1}),w=(0,a.f)((0,i.A)(function(){C.current&&S()}),100),Z=(0,i.A)(function(){d=!0}),x=(0,i.A)(function(){d=!1});(0,s.useEffect)(function(){var e=[E.subscribeMessage(c.FP.PLAY,A).unsubscribe,E.subscribeMessage(c.FP.PAUSE,b).unsubscribe,E.subscribeMessage(c.FP.ENTER_PIP,Z).unsubscribe,E.subscribeMessage(c.FP.EXIT_PIP,x).unsubscribe];return u.on(l,I),window.addEventListener("scroll",w),function(){u.removeListener(l,I),e.forEach(function(e){return e()})}},[b,A,w,I,E,Z,x]),(0,s.useEffect)(function(){m(f)},[f,m]),(0,s.useEffect)(function(){S()},[g,f,S]),(0,s.useEffect)(function(){!f&&(null==n?void 0:n.current)&&t&&(h(n.current),y((0,c.Wn)(t,"*",!0)))})}},67689:function(e,t,n){"use strict";n.d(t,{j:function(){return c}});var r=n(94009),o=n(85879),i=n(87363),a=(0,i.createContext)(),c=function(e){var t=e.children,n=(0,r._)((0,i.useState)([]),2),c=n[0],s=n[1],u=(0,i.useCallback)(function(e){return s(function(t){return t.concat(e)})},[]),l=(0,i.useCallback)(function(e){return s(function(t){return t.filter(function(t){return t!==e})})},[]),d=(0,i.useRef)({addInstance:u,removeInstance:l});return(0,o.BX)(o.HY,{children:[(0,o.tZ)(a.Provider,{value:d.current,children:t}),c]})};t.Z=function(){var e=(0,i.useContext)(a);return{addInstance:e.addInstance,removeInstance:e.removeInstance}}},4607:function(e,t,n){"use strict";n.d(t,{x:function(){return y}});var r=n(9338),o=n(55164),i=n(57477),a=n(94009),c=n(30971),s=n(85879),u=n(7835),l=n(6080),d=n(17347),p=n(9539),f=n(84871),h=n.n(f),_=n(87363),m=n(80714),g=n(81956),T="SMS_SUPPORTED_COUNTRIES",E="".concat(m.Z.fetchRoot.www,"/api/v3/oauth/sms/supported_countries"),y=function(e){return h()(function(t){var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=(0,a._)((0,_.useState)(e),2),n=t[0],o=t[1],i=(0,g.Z)(),s="0"===(0,l.c)("use_cached_supported_countries");return(0,u.b)(function(){function e(){return(e=(0,r._)(function(){var e,t,n,r,a,u,l,d;return(0,c.__generator)(this,function(c){switch(c.label){case 0:return[4,function(e){return C.apply(this,arguments)}(T)];case 1:if(t=null==(e=c.sent())?void 0:e.version,!(!Array.isArray(n=null==e?void 0:e.data)||!t||s))return[3,4];return[4,i(E)];case 2:return a=(r=c.sent().payload).data,[4,S(T,{version:r.version,data:a})];case 3:return c.sent(),o(a),[2];case 4:return[4,i(E,{query:{version:t}})];case 5:if(l=(u=c.sent().payload).data,!(t!==(d=u.version)))return o(n),[2];return[4,S(T,{version:d,data:l})];case 6:return c.sent(),o(l),[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),n}();return(0,s.tZ)(e,(0,i._)((0,o._)({},t),{supportedCountries:n}))},e)};function C(){return(C=(0,r._)(function(e){return(0,c.__generator)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,d.h5.default.get(e)];case 1:return[2,t.sent()];case 2:return A("safe-get",t.sent()),[2,null];case 3:return[2]}})})).apply(this,arguments)}function S(e,t){return I.apply(this,arguments)}function I(){return(I=(0,r._)(function(e,t){var n,r=arguments;return(0,c.__generator)(this,function(o){switch(o.label){case 0:n=r.length>2&&void 0!==r[2]?r[2]:(0,p.Z)(Date.now(),100),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,d.h5.default.set(e,t,n)];case 2:return[2,o.sent()];case 3:return A("safe-set",o.sent()),[3,4];case 4:return[2]}})})).apply(this,arguments)}function A(e,t){if("undefined"!=typeof window){var n;null===(n=window.Raven)||void 0===n||n.captureException(t,{extra:{name:"heifetz-idb-error",type:e}})}}},17721:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});var r=n(55164),o=n(57477),i=n(71728),a=n(94009),c=n(85879),s=n(16836),u=n(16e3),l=n(6907),d=n(87363),p=n.n(d),f=n(76490),h=n(87641),_=n(66980),m=Object.assign,g=n(67689),T={success:(0,c.tZ)(u.Y,{size:24}),fail:(0,c.tZ)(function(e){return p().createElement(_.Z,m({width:"49",height:"48",viewBox:"0 0 49 48"},e),p().createElement("path",{fill:"currentColor",d:"M24 36a4 4 0 1 1 0 8 4 4 0 0 1 0-8Zm3-32c1.105 0 1.91.9 1.801 1.993l-2.593 26.009c-.055.551-.55.998-1.099.998h-2.218a1.127 1.127 0 0 1-1.1-.998L19.2 5.993c-.11-1.1.688-1.993 1.8-1.993H27Z"}))},{size:24})},E=function(e){var t=e.text,n=e.icon,s=e.onClose,u=e.delay,l=void 0===u?2e3:u,p=e.color,_=void 0===p?"GBK04A":p,m=e.zIndex,g=void 0===m?1:m,E=(0,i._)(e,["text","icon","onClose","delay","color","zIndex"]),y=(0,a._)((0,d.useState)(!0),2),C=y[0],S=y[1],I=(0,f.Yz)(C,null,{from:{opacity:0},enter:{opacity:1},leave:{opacity:0}});return n="string"==typeof n?T[n]:n,(0,d.useEffect)(function(){setTimeout(function(){S(!1),s&&s()},l)},[l,s]),I.map(function(e){var i=e.item,a=e.props,s=e.key;return i?(0,c.tZ)(f.q.div,{style:a,children:(0,c.BX)(h.kC,(0,o._)((0,r._)({},E),{role:"alert",p:"18px",alignItems:"center",justifyContent:"center",flexDirection:"column",color:_,css:function(e){return{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",borderRadius:"14px",maxWidth:200,background:e.colorMod(e.colors.GBK99A).alpha(.85),pointerEvents:"none",textAlign:"center",zIndex:g}},children:[n,(0,c.tZ)(h.xv,{fontWeight:"bold",css:[{lineHeight:"20px"},n&&{marginTop:"8px"}],children:t})]}))},s):null})},y=function(){var e=(0,g.Z)(),t=e.addInstance,n=e.removeInstance;return(0,d.useCallback)(function(e){var o,a=e.icon,u=e.text,d=e.delay,p=e.color,f=(0,i._)(e,["icon","text","delay","color"]);return new Promise(function(e){t(o=(0,c.tZ)(s.Z,{children:(0,c.tZ)(E,(0,r._)({icon:a,text:u,onClose:e,delay:d,color:p},f))},(0,l.E)("toast")))}).finally(function(){var e;return e=o,setTimeout(function(){return n(e)},300)})},[t,n])}},36591:function(e,t,n){"use strict";n.d(t,{H:function(){return o}});var r=n(87363),o=(0,r.createContext)("");t.Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"https://www.zhihu.com",n=(0,r.useContext)(o);return e?n?((e=new URL(e,t)).searchParams.append("utm_source",n),e.toString()):e:n}},49048:function(e,t,n){"use strict";n.d(t,{a:function(){return l},w:function(){return u}});var r,o=n(9338),i=n(30971),a=n(80714),c={AD_PROMOTION_EXTRA_GET:"ad/getAdPromotionExtra/get",AD_PROMOTION_EXTRA_GIVE:"ad/getAdPromotionExtra/give"},s=function(e){return["https://".concat(a.Z.wwwHost),"https://".concat(a.Z.zhuanlanHost)].includes(e)},u=function(e,t,n){var r=function(o){var i=o.data,a=o.origin,u=o.source;if(s(a)&&i.type===c.AD_PROMOTION_EXTRA_GET){var l=i.data,d=l.type,p=l.id;d===e&&String(p)===t&&(null==u||u.postMessage({type:c.AD_PROMOTION_EXTRA_GIVE,data:{type:e,id:t,promotionExtra:n}},a),window.removeEventListener("message",r))}};window.addEventListener("message",r,!1);var o=setTimeout(function(){window.removeEventListener("message",r),clearTimeout(o)},6e4)},l=(r=(0,o._)(function(e,t){return(0,i.__generator)(this,function(n){return"undefined"!=typeof window&&(null==window?void 0:window.opener)?[2,new Promise(function(n){var r=function(o){var i=o.data;if(s(o.origin)&&i.type===c.AD_PROMOTION_EXTRA_GIVE){var a=i.data,u=a.type,l=a.id,d=a.promotionExtra;u===e&&l===String(t)&&(n(d),window.removeEventListener("message",r))}};window.addEventListener("message",r,!1);var o={type:c.AD_PROMOTION_EXTRA_GET,data:{type:e,id:t}};window.opener.postMessage(o,"https://".concat(a.Z.wwwHost)),window.opener.postMessage(o,"https://".concat(a.Z.zhuanlanHost))})]:[2,void 0]})}),function(e,t){return r.apply(this,arguments)})},74723:function(e,t,n){"use strict";var r=n(3343),o=n(80714);t.Z=function(e){var t=e.contentToken,n=e.contentType;(0,r.Z)("".concat(o.Z.fetchRoot.www,"/api/v4/read_history/add"),{method:"POST",body:{content_token:t,content_type:n}})}},27521:function(e,t,n){"use strict";n.d(t,{y:function(){return a}});var r=n(22107),o=n(94707),i=n(87320),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r._)(this,e),(0,i._)(this,"data",void 0),this.data=t}return(0,o._)(e,[{key:"set",value:function(e,t){var n="function"==typeof t?t(this.data[e]):t;return this.data[e]=n,this}},{key:"setExtraInfo",value:function(e,t){return this.data.extra_info||(this.data.extra_info={}),this.data.extra_info[e]=t,this}},{key:"setDraft",value:function(e,t){return this.data.draft||(this.data.draft={}),this.data.draft[e]=t,this}},{key:"addMedia",value:function(e){return this.data.media||(this.data.media={}),this.data.media.medias||(this.data.media.medias=[]),this.data.media.medias.push(e),this}},{key:"build",value:function(){return this.data}}]),e}()},94629:function(e,t,n){"use strict";n.d(t,{o:function(){return o}});var r=n(35102),o=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=n.name;return(0,r.hu)(n.message)||"TypeError"===o&&(null==n?void 0:null===(e=n.message)||void 0===e?void 0:e.includes("Load failed"))?"FetchError":"ResponseError"===o?"".concat(o,"_").concat(n.status||0,"_").concat((null===(t=n.payload)||void 0===t?void 0:t.code)||0):o||"Unknown"}},21379:function(e,t,n){"use strict";n.d(t,{y:function(){return o}});var r=n(80714),o=function(){return window.location.origin!=="https://".concat(r.Z.wwwHost)}},21260:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var r=n(93547),o=function(e){return(0,r.Xs)(e||"",!0)}},62250:function(e,t,n){"use strict";n.d(t,{u:function(){return Z}});var r=n(9338),o=n(94009),i=n(49899),a=n(30971);n(85879);var c=n(65733),s=n(54231);n(84871);var u=n(74135),l=n(45851),d=n.n(l),p=n(88329),f=n.n(p),h=n(92258),_=n(80714),m=n(81956),g=n(58909),T=n(94629),E=n(38322),y=n.n(E),C=n(75472),S=n.n(C),I=n(6148);function A(){return(A=(0,r._)(function(e,t,n,r,o){var c,s,u,l,d,p,f,h;return(0,a.__generator)(this,function(a){return c=o.currentUserToken,(l=(0,I.dj)(null==n?void 0:null===(s=n.extra_info)||void 0===s?void 0:s.pc_business_params))&&(d=(0,I.dj)(null==r?void 0:r.pcBusinessParams))&&(p=new Set,"answer"===e?(p.add("content"),"update"===t&&(p.add("answer_id"),p.add("question_id"),p.add("is_copyable"),p.add("is_report"),p.add("biz_ext"),l.comment_permission||d.comment_permission||p.add("comment_permission"),p.add("answer_type"),p.add("tagline"),l.reshipment_settings||d.reshipment_settings||p.add("reshipment_settings"),p.add("publish_at"),p.add("published_at"))):"article"===e&&(l.column&&(l.column=y()(l.column,["id"])),l.column||d.column||p.add("column"),S()(l.commercial_report_info,{commercial_types:[]})&&!d.commercial_report_info&&p.add("commercial_report_info"),l.commercial_zhitask_bind_info||d.commercial_zhitask_bind_info||p.add("commercial_zhitask_bind_info"),p.add("article_id"),(null===(f=l.content_source)||void 0===f?void 0:f.method)!==1&&(p.add("content_source.location"),p.add("content_source.create_at"))),h=[],function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!p.has(r.join("."))){if("object"==typeof t&&"object"==typeof n&&t&&n){Array.from(new Set((0,i._)(Object.keys(t)).concat((0,i._)(Object.keys(n))))).forEach(function(o){return e(t[o],n[o],(0,i._)(r).concat([o]))});return}t!==n&&h.push({path:r.join("."),pc:JSON.stringify(t),be:JSON.stringify(n)})}}(l,d),0===h.length||null===(u=window.webReporter)||void 0===u||u.report("pc_content_publish_payload_consistency",{type:e,action:t,diffs:h,pc:l,backend:d,content:n,userToken:c,result:null==r?void 0:r.publish})),[2]})})).apply(this,arguments)}var b=n(64512),w="".concat(_.Z.fetchRoot.www,"/api/v4/content/publish");function Z(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unknown",l=(0,h.useSelector)(g.wY),p=(0,m.Z)(),_=null!==(t=(0,s.j0)())&&void 0!==t?t:"Unknown",E=(0,o._)((0,b.zb)(),1)[0],y=function(t,o){var c,u=function(){for(var r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];s.ZP.increment(["content_publish",_,n,e,t].concat((0,i._)(o),["count"]).join("."))};return c=(0,r._)(function(n){var r,c,s,p,h,_=arguments;return(0,a.__generator)(this,function(a){switch(a.label){case 0:for(c=Array((r=_.length)>1?r-1:0),s=1;s<r;s++)c[s-1]=_[s];a.label=1;case 1:return a.trys.push([1,3,,4]),u("request"),[4,o.apply(void 0,[n].concat((0,i._)(c)))];case 2:return p=a.sent(),u("success"),(function(e,t,n,r,o){return A.apply(this,arguments)})(e,t,n,d()(p),{currentUserToken:l}).catch(f()),[2,p];case 3:throw h=a.sent(),u("fail",(0,T.o)(h)),h;case 4:return[2]}})}),function(e){return c.apply(this,arguments)}};function C(e){return S.apply(this,arguments)}function S(){return(S=(0,r._)(function(t){return(0,a.__generator)(this,function(n){var o;return null==E||E.safeRecordStageStart("request",t),[2,p(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e,data:t})}).then((o=(0,r._)(function(e){var t,n,r;return(0,a.__generator)(this,function(o){return null==E||E.safeRecordStageStart("post-request",e.payload),[2,(r=null===(t=e.payload)||void 0===t?void 0:null===(n=t.data)||void 0===n?void 0:n.result)?(0,u.camelizeKeys)(JSON.parse(r)):null]})}),function(e){return o.apply(this,arguments)}))]})})).apply(this,arguments)}return{publish:(0,c.A)(y("publish",C)),update:(0,c.A)(y("update",C)),scheduledPublish:(0,c.A)(y("scheduledPublish",C))}}},64512:function(e,t,n){"use strict";n.d(t,{FK:function(){return x},Ss:function(){return b},zb:function(){return Z}});var r=n(22107),o=n(94707),i=n(87320),a=n(15030),c=n(55164),s=n(57477),u=n(94009),l=n(49899),d=n(85879),p=n(62082),f=n(54231),h=n(84871),_=n.n(h),m=n(45851),g=n.n(m),T=n(87363),E=n(92258),y=n(58909),C=n(12592),S=n.n(C),I=n(80714),A=n(94629);function b(e){return(JSON.stringify(e),e&&"object"==typeof e)?Array.isArray(e)?e.map(b):Object.keys(e).reduce(function(t,n){return t[n]=b(e[n]),t},{}):"string"==typeof e?encodeURI(e):e}var w=function(){function e(){(0,r._)(this,e),(0,i._)(this,"_pageName","Unknown"),(0,i._)(this,"_urlToken",""),(0,i._)(this,"_type","unknown"),(0,i._)(this,"_scene","Unknown"),(0,i._)(this,"_snapshots",[]),(0,i._)(this,"_stage","collect")}return(0,o._)(e,[{key:"safeRecordParamCollected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._safeTakeShot("collected",{name:e,payload:t})}},{key:"safeRecordStageStart",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._stage=e,this._safeTakeShot(e,t)}},{key:"_safeTakeShot",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{var n=g()(t);try{this._snapshots.push({name:e,payload:JSON.parse(JSON.stringify(n)),timestamp:+Date.now()})}catch(t){this._snapshots.push({name:e,payload:String(n),timestamp:+Date.now()})}}catch(e){}}},{key:"safeReport",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unset";try{var n,r=(0,a._)(e,Error)?e:Error(String(e));if(this._safeTakeShot("error",{reportedBy:t}),r.name.startsWith("ResponseError")&&"1"!==I.Z.apollo.reportBackendPublishError)return;var o={type:"PublishError",appName:"heifetz",spanName:this._pageName,release:I.Z.release||"unknown",currentUser:this._urlToken,error:{name:(0,A.o)(r),message:r.message,payload:r.payload||"Unknown",stack:r.stack},publish:{type:this._type,stage:this._stage,scene:this._scene,snapshots:this._snapshots}};null==window||null===(n=window.webReporter)||void 0===n||n.report("pc_publish_error",b(o)),(0,p.zB)(o)}catch(e){}}},{key:"setUrlToken",value:function(e){this._urlToken=e}},{key:"startFreshReport",value:function(e,t){var n;this._pageName=null!==(n=(0,f.j0)())&&void 0!==n?n:"Unknown",this._snapshots=[],this._type=e||"unknown",this._scene=t||"Unknown",this._stage="collect"}},{key:"wrapAutoReport",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{freshReport:!1},n=t.reportedBy,r=t.freshReport,o=this;return function(){for(var t=arguments.length,i=Array(t),a=0;a<t;a++)i[a]=arguments[a];r&&o.startFreshReport(r.type,r.scene);try{var c=e.apply(void 0,(0,l._)(i));if(S()(c))return c.catch(function(e){throw o.safeReport(e,n),e});return c}catch(e){throw o.safeReport(e,n),e}}}}]),e}();function Z(){var e=(0,E.useSelector)(y.wY),t=w.instance;return(0,T.useEffect)(function(){w.instance.setUrlToken(e)},[e]),[t]}function x(e){return _()(function(t){var n=(0,u._)(Z(),1)[0];return(0,d.tZ)(e,(0,s._)((0,c._)({},t),{publishErrorReporter:n}))},e)}(0,i._)(w,"instance",new w)},29508:function(e,t,n){"use strict";n.d(t,{H:function(){return r}});var r=function(){return function(){}}},2493:function(e,t,n){"use strict";var r=n(92258),o=n(31824),i=(0,o.wN)(o.PW,r.shallowEqual);t.Z=i},65379:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(49899),o=n(85456),i=n.n(o);function a(e,t,n){var o=!1,a=i()(function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];o=!1,e.apply(void 0,(0,r._)(n))},t,n);return Object.assign(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o=!0,a.apply(void 0,(0,r._)(t))},{cancel:a.cancel,flush:a.flush,pending:function(){return o}})}},82371:function(e,t,n){"use strict";n.d(t,{d:function(){return f},n:function(){return h}});var r,o=n(9338),i=n(30971),a=n(51770),c=n(94648),s=n(58596),u=n(17132),l=n.n(u),d=n(80714),p=(0,c.I)(function(){return(0,s.k)("undefined"!=typeof navigator,"Client only"),(0,a.pv)(l()(navigator.userAgent),d.Z.proxyUrl,!1)}),f=(r=(0,o._)(function(e,t){return(0,i.__generator)(this,function(n){switch(n.label){case 0:return[4,p()];case 1:return[2,n.sent()(e,t)]}})}),function(e,t){return r.apply(this,arguments)}),h=function(e){var t,n;return(null===(t=e.payload)||void 0===t?void 0:null===(n=t.error)||void 0===n?void 0:n.message)||e.statusMessage||"服务繁忙，请稍候再试。"}},95167:function(e,t,n){"use strict";n.d(t,{r:function(){return i}});var r=n(82452),o=n(57138),i=function(e){return(0,r.tL)().utm_psn?"share":e.baiduSearch?"baidu_search":"others"};t.Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown";if(e.iOS||e.Android){var n=e.Wechat&&e.iOS,i=e.Weibo&&e.Android;if(n||i){console.log("stop auto-pull App.");return}var a=(0,o.MN)((0,o.Qu)(location.pathname)),c=new URLSearchParams(location.search.substring(1)),s=(0,r.IV)();s&&c.set("mcid",s),c.set("callback_source",t);var u="".concat(a,"?").concat((c.get("q")?c.set("callback_source","search_result"):(c.delete("q"),c.set("callback_source","search_main")),c).toString());if(console.log("redirect to pull App...",u),e.iOS&&e.QQ){var l=document.createElement("a");l.href=u,l.click();return}location.href=u}}},22943:function(e,t,n){"use strict";function r(e,t){try{return e()}catch(e){return t}}n.d(t,{Z:function(){return r}})},93292:function(e,t){"use strict";t.Z=function(e,t){var n=!1,r=[],o=null;return function(){for(var i=arguments.length,a=Array(i),c=0;c<i;c++)a[c]=arguments[c];return r.push(a),n||(n=!0,o=new Promise(function(o){t(function(){var t=r;n=!1,r=[],o(e(t))})})),o}}},80523:function(e,t){"use strict";t.Z=function(e,t,n){return t in e?e[t]:e[t]=n()}},13901:function(e,t,n){"use strict";n.d(t,{Z:function(){return N}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),u=n(85879),l=n(50220),d=n(67814),p=n.n(d),f=n(14168),h=n.n(f),_=n(87363),m=n(92258),g=n(55536),T=n(25452),E=n(46829),y=n(24752),C=n(66263),S=n(85576),I=n(67927),A=n(84210),b=n(7522),w=n(69383),Z=n(65153),x=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{modalShown:!1}),(0,a._)((0,r._)(e),"handleSendMessage",function(){var t=e.props,n=t.onModalOpen,o=t.user.allowMessage,i=t.dispatch,a=t.doNotCheckAllowMessageSetting;o||void 0===o&&a?(e.setState({modalShown:!0}),n&&n()):i((0,I.c0)(C.T$.blocked,"red")),w.Z.trackEvent((0,r._)(e),{action:"Message",element:"Button",is_intent:!0})}),(0,a._)((0,r._)(e),"handleCloseModal",function(){var t=e.props.onModalClose;e.setState({modalShown:!1}),t&&t()}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.preset,r=e.color,o=e.icon,i=e.label,a=e.className,c=e.tooltip,s=e.tooltipPreset,l=e.authRequired,d=this.state.modalShown,p="3d198a56310c02c4a83efb9f4a4c027e"===t.id;return(0,u.BX)(u.HY,{children:[(0,u.tZ)(T.ZP,{preset:n,color:r,className:a,icon:o,label:i,onClick:l(this.handleSendMessage,p?C.q0.serviceAccountMessage:C.q0.message),"data-tooltip":c,"aria-label":c,"data-tooltip-preset":s}),(0,u.tZ)(Z.Z,{memberHashId:t.id,handleCloseModal:this.handleCloseModal,isModalShow:d})]})}}]),n}(_.Component);x.propTypes={onModalOpen:h().func,onModalClose:h().func},x.defaultProps={preset:"outline",color:"grey",icon:b.d,label:"发私信",doNotCheckAllowMessageSetting:!1};var k=(0,g.compose)(S.Z,(0,m.connect)())(x),R=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{reportModalShown:!1}),(0,a._)((0,r._)(e),"handleShieldUser",function(){var t=e.props,n=t.user.urlToken,r=t.updateUserBlocking,o=t.showNotification;r(n,!1).then(function(){return o("屏蔽已取消")})}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.user,r=t.user,o=r.urlToken,i=r.isBlocking,a=r.isOrg,c=r.id,s=t.canShowMutualFollowStatus,d=t.className,f=t.buttonClassName,h=t.onModalOpen,_=t.onModalClose,m=t.authRequired,g=this.state.reportModalShown,S=p()("MemberButtonGroup",d);return i?(0,u.BX)("div",{className:S,children:[(0,u.BX)(T.ZP,{className:f,preset:"primary",color:"red",onClick:this.handleShieldUser,children:[(0,u.tZ)(l.l,{center:!0,text:!0})," 已屏蔽"]}),!a&&(0,u.BX)(T.ZP,{className:f,onClick:m(function(){e.setState({reportModalShown:!0}),h&&h()},C.q0.report),children:["举报用户",(0,u.tZ)(y.y,{shown:g,onClose:function(){e.setState({reportModalShown:!1}),_&&_()},type:"member",urlToken:o,memberHashID:c,zaEnabled:!0})]})]}):(0,u.BX)("div",{className:S,children:[(0,u.tZ)(E.Z,{id:o,type:n.type,gender:n.gender,isFollowing:n.isFollowing,isFollowed:n.isFollowed,canShowMutualFollowStatus:s,className:f,preset:E.Z.PRESETS.primary}),(0,u.tZ)(k,{user:n,className:f,onModalOpen:h,onModalClose:_})]})}}]),n}(_.Component);(0,a._)(R,"propTypes",{user:h().object.isRequired,buttonClassName:h().string,onModalOpen:h().func,onModalClose:h().func});var N=(0,g.compose)(S.Z,(0,m.connect)(null,{updateUserBlocking:A.cR,showNotification:I.c0}))(R)},56628:function(e,t,n){"use strict";n.d(t,{WD:function(){return a},ah:function(){return i}});var r=n(49899),o=n(80714);["baike_box","edu_course","search_result","one_box","wiki_box","relevant_query","time_box","knowledge_ad","knowledge_result","knowledge_edu","ebook_saltpick","anniversary_activity","video_box","zvideo","koc_box","hot_timing","gaokao","film_box","game_box","education","ring_box"].concat((0,r._)(o.Z.isMobileEntry?["ncee_2020_activity"]:[])),["baike_box","relevant_query","anniversary_activity","video_box","gaokao","film_box","game_box"].concat((0,r._)(o.Z.isMobileEntry?["ncee_2020_activity"]:[]));var i=function(e){return e?{id:3948,action:"UnFollow"}:{id:3947,action:"Follow"}},a=[{key:"advancedFilter",title:"搜索范围",type:"multiple",options:[{val:"keywords",title:"关键词"},{val:"title",title:"题名"},{val:"authors",title:"作者"},{val:"abstract",title:"摘要"}]},{key:"indexedBy",title:"收录类型",type:"single",options:[]},{key:"classification",title:"学科分类",type:"single",options:[]}]},74167:function(e,t,n){"use strict";n.d(t,{L:function(){return a},c:function(){return i}});var r=n(55164),o=n(57477),i=function(e,t){var n=e.reaction||{},i=n||{},a=i.relation,c=i.statistics,s=((null==c?void 0:c.likeCount)||0)+(t?1:-1),u=s<0?0:s;return{isLiked:t,likeCount:u,reaction:(0,o._)((0,r._)({},n),{relation:(0,o._)((0,r._)({},a),{liked:t}),statistics:(0,o._)((0,r._)({},c),{likeCount:u})})}},a=function(e,t){var n=e.reaction||{},i=n||{},a=i.relation,c=i.statistics,s=((null==c?void 0:c.favorites)||0)+(t?1:-1);return{reaction:(0,o._)((0,r._)({},n),{relation:(0,o._)((0,r._)({},a),{faved:t}),statistics:(0,o._)((0,r._)({},c),{favorites:s<0?0:s})})}}},6366:function(e,t,n){"use strict";n.d(t,{ZP:function(){return j},fn:function(){return X},sQ:function(){return H},F4:function(){return G},t_:function(){return W},Z3:function(){return z},L3:function(){return q},MM:function(){return F},LC:function(){return B},Hr:function(){return U},Rv:function(){return V}});var r=n(55164),o=n(57477),i=n(49899),a=n(74135),c=n(4785);n(58909);var s=n(66263),u=n(4661),l=n(81897),d=n.n(l);function p(){return"undefined"!=typeof document&&d().remove("unlock_ticket"),{unlockTicketStatus:!1,unlockTicket:null,challenge:[]}}var f=[s.An,s.hY,s.M,s.Uw,s.TY],h=(0,r._)({},(0,u.FH)("account",["UNLOCK_TICKET_BY_DIGITS","UNLOCK_TICKET_BY_PASSWORD","GET_UNLOCK_REQUEST","REQUEST_UNLOCK_TICKET","GET_UNBLOCK_INFO","REQUEST_PHONE_VERIFICATION_CODE","UPDATE_PHONE_NUMBER","GET_ACCOUNT_PHONE_VERIFY_CODE","UPDATE_ACCOUNT_PHONE","REQUEST_EMAIL_VERIFY_CODE","UPDATE_EMAIL","ACTIVE_EMAIL","MONOPOLIZE_PHONE_NUMBER","RESET_PASSWORD","RESET_ORG_PASSWORD","REQUEST_URL_TOKEN","UPDATE_URL_TOKEN","GET_ACCOUNT_INFO","GET_ORG_ACCOUNT_INFO","UPDATE_ORG_EMAIL","REQUEST_ORG_EMAIL_VERIFY_CODE","GET_ACCOUNT_CARDINFO","GET_ACCOUNT_STICKERS_LIST","GET_ACCOUNT_WIDGET","GET_ACCOUNT_WIDGETID"]),(0,u.co)("account",["RECOVER_DEFAULT_TYPE","SET_UNLOCK_TICKET","SET_HANDLEWIDGET","SET_ACCOUNTUSER_WIDGETID"])),_=h.UNLOCK_TICKET_BY_DIGITS,m=h.UNLOCK_TICKET_BY_PASSWORD,g=h.GET_UNLOCK_REQUEST,T=h.REQUEST_UNLOCK_TICKET,E=h.GET_UNBLOCK_INFO,y=h.REQUEST_PHONE_VERIFICATION_CODE,C=h.UPDATE_PHONE_NUMBER,S=(h.GET_ACCOUNT_PHONE_VERIFY_CODE,h.UPDATE_ACCOUNT_PHONE),I=(h.REQUEST_EMAIL_VERIFY_CODE,h.REQUEST_ORG_EMAIL_VERIFY_CODE,h.UPDATE_EMAIL),A=(h.ACTIVE_EMAIL,h.MONOPOLIZE_PHONE_NUMBER),b=(h.RESET_PASSWORD,h.RESET_ORG_PASSWORD,h.REQUEST_URL_TOKEN),w=h.UPDATE_URL_TOKEN,Z=h.GET_ACCOUNT_INFO,x=h.GET_ORG_ACCOUNT_INFO,k=h.UPDATE_ORG_EMAIL,R=h.GET_ACCOUNT_CARDINFO,N=h.GET_ACCOUNT_STICKERS_LIST,O=(h.GET_ACCOUNT_WIDGET,h.GET_ACCOUNT_WIDGETID),P=h.RECOVER_DEFAULT_TYPE,D=h.SET_UNLOCK_TICKET,L=h.SET_HANDLEWIDGET,M=h.SET_ACCOUNTUSER_WIDGETID;function B(e){return{API:{types:_,method:"POST",body:(0,c.z)((0,a.decamelizeKeys)({digits:e})),endpoint:"v3/oauth/account/unlock/digits"}}}function U(e){return{API:{types:m,method:"POST",body:(0,c.z)((0,a.decamelizeKeys)({password:e})),endpoint:"v3/oauth/account/unlock/password"}}}function G(){return{API:{types:g,method:"GET",endpoint:"v3/oauth/account/unlock/request",fetchOptions:{credentials:"include"}}}}function F(e){return{API:{types:T,method:"POST",endpoint:"v3/oauth/account/unlock/request/".concat(e)}}}function H(){return{API:{types:E,method:"GET",endpoint:"/antispam/lock_info"}}}function z(){return{type:P}}function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.notification;return{API:{types:y,endpoint:"v3/account/api/account/phone_no",method:"POST",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,c.Z)({new_phone_no:e})}},NOTIFICATION:void 0===n||n}}function V(e,t){return{phone:e,API:{types:C,endpoint:"v3/account/api/account/phone_no",method:"PUT",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,c.Z)({new_phone_no:e,digits:t})}},NOTIFICATION:!1}}var W=function(){return{API:{types:A,endpoint:"v3/account/api/account/phone_no/cover",method:"POST",fetchOptions:{credentials:"include"}}}};function X(){return{API:{types:Z,method:"GET",endpoint:"v3/oauth/account"}}}var K={unlockTicketStatus:!1,unlockTicket:null,challenge:[],errorStatus:!1,message:"",isFetching:!1,accountInfo:{},urlToken:{loading:!1},cardUserInfo:{vipInfo:{}},handleWidget:{},widgetList:[],userWidgetId:""};function j(){var e,t,n,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,c=arguments.length>1?arguments[1]:void 0,s=c.type,u=c.payload;if(s===E.success){var l=u.spamLevel,d=u.isAppealed;return(0,o._)((0,r._)({},a),{spamLevel:l,isAppealed:d,antispamLockInfo:u,isUnblockInfoFetched:!0})}if(-1!==[_.success,m.success].indexOf(s))return(0,r._)({},a,(e=c.payload,t=c.res,(n=e.unlockTicket)?{unlockTicketStatus:t.ok,unlockTicket:n,challenge:[],errorStatus:!1,message:""}:p()));if(-1!==[C.success,S.success].indexOf(s)){var h=c.phone,T=(0,o._)((0,r._)({},a.accountInfo),{phoneNo:function(e){if(!e)return"";var t=e+"";return t.slice(0,6)+"****"+t.slice(10)}(h)});return(0,o._)((0,r._)({},a,p()),{accountInfo:T})}if(s===I.success||s===k.success){var y=c.email,A=(0,o._)((0,r._)({},a.accountInfo),{email:function(e){if(!e)return"";var t=e.indexOf("@");return t>2?e.slice(0,2)+"****"+e.slice(t):e}(y)});return(0,o._)((0,r._)({},a,p()),{accountInfo:A})}if(s===g.request)return(0,o._)((0,r._)({},a),{isFetching:!0});if(s===g.success)return(0,o._)((0,r._)({},a),{challenge:u.challenge,isFetching:!1});if(s===g.failure)return(0,o._)((0,r._)({},a),{isFetching:!1});if(s===Z.success)return(0,o._)((0,r._)({},a),{accountInfo:u});if(s===x.success)return(0,o._)((0,r._)({},a),{accountInfo:{passwordSet:"已设置"===u.accountPwd.status,email:u.accountEmail.email}});if(s===b.request)return(0,o._)((0,r._)({},a),{urlToken:{loading:!0}});if(s===b.success)return(0,o._)((0,r._)({},a),{urlToken:{loading:!1,setable:u.setable,token:u.urlToken}});if(s===b.failure)return(0,o._)((0,r._)({},a),{urlToken:{loading:!1}});if(s===w.success){var B=c.urlToken;return(0,o._)((0,r._)({},a),{urlToken:{loading:!1,setable:!1,token:B}})}if(s===P)return(0,o._)((0,r._)({},a),{errorStatus:!1,isFetching:!1});if(s===L)return(0,o._)((0,r._)({},a),{handleWidget:(0,r._)({},c.handleWidget)});if(s===D)return(0,o._)((0,r._)({},a),{unlockTicket:c.unlockTicket});if(c.err&&c.err.payload){var U=c.err.payload;if(f.includes(U.code))return(0,o._)((0,r._)({},a),{unlockTicketStatus:!1,errorStatus:!0,message:U.message})}return s===R.success?(0,o._)((0,r._)({},a),{cardUserInfo:(0,r._)({},u)}):s===N.success?(0,o._)((0,r._)({},a),{widgetList:(0,i._)(u.data)}):s===O.success?(0,o._)((0,r._)({},a),{userWidgetId:u.data.widgetId}):s===M?(0,o._)((0,r._)({},a),{userWidgetId:c.widgetId}):a}},22712:function(e,t,n){"use strict";n.d(t,{Cz:function(){return _},SE:function(){return u}});var r,o=n(87320),i=n(20760),a=n(8866),c=n(89250),s=n(35528),u={vote:{positive:"voteup",revertPositive:"revert_voteup",negative:"votedown",revertNegative:"revert_votedown"},like:"like",revertLike:"revert_like",collect:"collect",revertCollect:"revert_collect",follow:"follow",revertFollow:"revert_follow",comments:{show:"show_comments",close:"close_comments",publish:"comment_publish"},shareClick:"share_click"},l={answer:{},article:{}},d=function(e,t){var n=t.type,r=t.id,o=t.action;Object.keys(l).includes(n)&&r&&(e[n][r]=o)},p=function(e){return function(t,n){var r=n.meta,o=n.payload,i=t.answer[r.id];1===o.voting?i=u.vote.positive:-1===o.voting?i=u.vote.negative:0===o.voting&&1===r.beforeVoting?i=u.vote.revertPositive:0===o.voting&&-1===r.beforeVoting&&(i=u.vote.revertNegative),d(t,{type:e,id:r.id,action:i})}},f=function(e){return function(t,n){var r=n.meta,o=n.payload;d(t,{type:e,id:r.id,action:o.isThanked||o.isLiked?u.like:u.revertLike})}},h=(0,i.oM)({initialState:l,name:"adPromotion",reducers:{updateAdPromotionAction:function(e,t){var n=t.payload;d(e,{type:n.type,id:n.id,action:n.currentAction})}},extraReducers:(r={},(0,o._)(r,a.uJ.UPDATE_VOTE.success,p("answer")),(0,o._)(r,c.VA.VOTE.success,p("article")),(0,o._)(r,a.uJ.UPDATE_THANK.success,f("answer")),(0,o._)(r,c.VA.LIKE.success,f("article")),(0,o._)(r,s.xb.UPDATE_FAVLIST_ITEM.success,function(e,t){var n=t.meta,r=n.collected,o=n.contentId;d(e,{type:n.contentType,id:o,action:r?u.collect:u.revertCollect})}),r)}),_=h.actions.updateAdPromotionAction;t.ZP=h.reducer},8866:function(e,t,n){"use strict";n.d(t,{EI:function(){return E},G:function(){return w},Hh:function(){return N},JA:function(){return B},Ly:function(){return G},Md:function(){return z},Mn:function(){return W},ON:function(){return O},Pe:function(){return x},QX:function(){return L},TC:function(){return S},Uk:function(){return k},Vc:function(){return P},Yu:function(){return R},Zq:function(){return y},_o:function(){return U},ae:function(){return q},bs:function(){return F},eP:function(){return V},eu:function(){return I},f0:function(){return Z},fT:function(){return A},iM:function(){return b},i_:function(){return C},oe:function(){return M},ri:function(){return H},uJ:function(){return g}});var r=n(87320),o=n(55164),i=n(57477),a=n(94648),c=n(74135),s=n(55536),u=n(28953),l=n(84054),d=n.n(l),p=n(80714),f=n(66263),h=n(4661),_=n(74167),m=n(69906),g=(0,h.FH)("answer",["UPDATE_VOTE","NAVIGATOR_UPDATE_VOTE","UPDATE_THANK","UPDATE_COMMENT_PERMISSION","UPDATE_RESHIPMENTSETTINGS","DELETE","RESTORE","GET","GET_SOME","GET_VOTERS","GET_COPYRIGHT_APPLICANTS","GET_FAVLISTS","GET_COMMENT_PERMISSION","COLLAPSE","ADD","UPDATE","STICK","UPDATE_ANSWER_REWARD","GET_UPVOTERS","LOAD_MARKET_ANSWER_PAID_CONTENT","GET_SETTINGS","SCHEDULED_PUBLISH","VALIDATE_SCHEDULED_PUBLISH","CANCEL_SCHEDULED_PUBLISH","CHECK_IF_CAN_CONVERT_TO_VESSAY","SUBMIT_EVALUTE","LOAD_ANSWER_SEARCH_ENTITY","LOAD_ANSWER_RELATION_ENDORSEMENT","LOAD_ANSWER_HOT_SPOT_LIST","LOAD_ANSWER_GROWTH_COMPONENT_ORDER"]),T=(0,h.co)("answer",["UPDATE_SETTINGS_DISCLAIMER"]),E=(0,a.I)(function(){var e,t=(null===(e=p.Z.apollo)||void 0===e?void 0:e.include_reaction)==="1";return d()({is_contain_ai_content:!0,is_visible:!0,paid_info:!0,paid_info_content:!0,has_column:!0,admin_closed_comment:!0,reward_info:!0,annotation_action:!0,annotation_detail:!0,collapse_reason:!0,is_normal:!0,is_sticky:!0,collapsed_by:!0,suggest_edit:!0,comment_count:!0,thanks_count:!0,favlists_count:!0,can_comment:!0,content:!0,editable_content:!0,voteup_count:!0,reshipment_settings:!0,comment_permission:!0,created_time:!0,updated_time:!0,review_info:!0,relevant_info:!0,question:!0,excerpt:!0,attachment:!0,content_source:!0,relationship:{is_authorized:!0,voting:!0,is_thanked:!0,is_author:!0,is_nothelp:!0,is_favorited:!0},is_labeled:!0,endorsements:!0,author:{badge:[{topics:!0}],vip_info:!0,kvip_info:!0},settings:{table_of_content:{enabled:!0}},reaction_instruction:!0,reaction:t,ip_info:!0})});function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"answer";return function(n){return n({meta:{id:e},API:{types:g.CHECK_IF_CAN_CONVERT_TO_VESSAY,endpoint:"vessay/".concat(t,"s/").concat(e,"/status")},UPDATE:{success:function(n){return(0,r._)({},"".concat(t,"s"),(0,r._)({},e,(0,o._)({},n)))}}})}}function C(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.zVideoId,s=n.cardType,u=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0;return function(n,d){var p,h,_,m=d().entities,T=m.answers,E=void 0===T?{}:T,y=m.users,C=m.videoanswers,S=u||("videoanswers"===s?(void 0===C?{}:C)[e]:("koc"===s?null===(w=E[e])||void 0===w?void 0:w.answer:E[e])||{}),I=S.author||{},A=I.urlToken,b="videoanswers"===s?"videoanswers":"answers";if("navigator_up"===t||"normal_up"===t){var w,Z,x,k,R="navigator_up"===t;return n({API:{types:g.NAVIGATOR_UPDATE_VOTE,endpoint:"creators/navigator/upvote?content_type=answer&content_token=".concat(e),method:R?"POST":"DELETE",body:{content_type:"answer",content_token:e}},meta:{beforeVoting:S.relationship.voting,id:e},UPDATE:{request:(0,r._)({},b,(0,r._)({},e,(0,i._)((0,o._)({},S),{relationship:(0,o._)({},S.relationship),navigatorVote:!!R,voteNextStep:R?"vote":"unvote"}))),failure:(k={},(0,r._)(k,b,(0,r._)({},e,S)),(0,r._)(k,"users",(0,r._)({},A,I)),k)},NOTIFICATION:{success:l}})}return x="up"===t?1:1===S.voting?-1:0,n({API:{types:g.UPDATE_VOTE,endpoint:a?"zvideos/".concat(a,"/voters"):"answers/".concat(e,"/voters"),method:"POST",body:(0,c.decamelizeKeys)(a?{voting:t}:{type:t})},meta:{beforeVoting:S.relationship.voting,id:e},UPDATE:{request:(h={},(0,r._)(h,b,(0,r._)({},e,(0,i._)((0,o._)({},S),{voteupCount:S.voteupCount+x,relationship:(0,i._)((0,o._)({},S.relationship),{voting:f.mC[t]}),voteNextStep:"vote"}))),(0,r._)(h,"users",(0,r._)({},A,{voteupCount:(null!==(p=null===(Z=(void 0===y?{}:y)[A])||void 0===Z?void 0:Z.voteupCount)&&void 0!==p?p:0)+x})),h),failure:(_={},(0,r._)(_,b,(0,r._)({},e,S)),(0,r._)(_,"users",(0,r._)({},A,I)),_),success:function(t){return a?{answers:(0,r._)({},e,{voteupCount:t.voteupCount,relationship:(0,i._)((0,o._)({},S.relationship),{voting:t.voting}),voteNextStep:"vote"})}:"koc"===s?{answers:(0,r._)({},e,{answer:{voteupCount:t.voteupCount,relationship:(0,i._)((0,o._)({},S.relationship),{voting:t.voting}),voteNextStep:"vote"}})}:(0,r._)({},b,(0,r._)({},e,(0,i._)((0,o._)({},t),{voteNextStep:"vote"})))}},NOTIFICATION:{success:l}})}}function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.zVideoId,c=n.cardType,s=n.entity,u=n.notification,l=void 0===u||u;return function(n,u){var d,p=u().entities,f=p.answers,h=void 0===f?{}:f,m=p.videoanswers,T="videoanswers"===c?"videoanswers":"answers",E=s||("videoanswers"===c?(void 0===m?{}:m)[e]:"koc"===c?null===(d=h[e])||void 0===d?void 0:d.answer:h[e]);return n({API:{types:g.UPDATE_THANK,endpoint:a?"zvideos/".concat(a,"/likers"):"answers/".concat(e,"/thankers"),method:t?"POST":"DELETE"},meta:{id:e},UPDATE:{request:function(){var n=(0,_.c)(E,t),a=(0,i._)((0,o._)({},n),{relationship:(0,i._)((0,o._)({},n.relationship),{isThanked:t}),thanksCount:n.reaction.statistics.likeCount}),c={answers:(0,r._)({},e,a)};return"videoanswers"===T&&(c.videoanswers=(0,r._)({},e,a)),c},failure:(0,r._)({},T,(0,r._)({},e,E))},NOTIFICATION:l})}}function I(e,t){return function(n,o){var i=o().entities.answers[e];return n({API:{types:g.UPDATE_RESHIPMENTSETTINGS,endpoint:"answers/".concat(e),method:"PUT",body:(0,c.decamelizeKeys)({reshipmentSettings:t})},UPDATE:{request:{answers:(0,r._)({},e,{reshipmentSettings:t})},failure:{answers:(0,r._)({},e,i)}}})}}function A(e,t){return function(n,a){var s=a().entities.answers[e];return n({API:{types:g.UPDATE_ANSWER_REWARD,endpoint:"answers/".concat(e),method:"PUT",query:{include:E()},body:(0,c.decamelizeKeys)({rewardSetting:{canReward:!!t,tagline:t}})},UPDATE:{success:function(t){return{answers:(0,r._)({},e,(0,i._)((0,o._)({},t),{rewardInfo:(0,o._)({},t.rewardInfo)}))}},failure:{answers:(0,r._)({},e,s)}}})}}function b(e,t){return function(n,o){var i=o().entities.answers[e];return n({API:{types:g.UPDATE_COMMENT_PERMISSION,endpoint:"answers/".concat(e),method:"PUT",body:(0,c.decamelizeKeys)({commentPermission:t})},UPDATE:{request:{answers:(0,r._)({},e,{commentPermission:t})},failure:{answers:(0,r._)({},e,i)}}})}}function w(e){return function(t,n){var a=n(),c=a.currentUser,s=a.entities,u=s.answers,l=s.questions,d=s.users,p=u[e],f=p.question.id,h=l[f],_=d[c];return t({API:{types:g.DELETE,endpoint:"answers/".concat(e),method:"DELETE"},UPDATE:(0,i._)((0,o._)({request:(0,i._)((0,o._)({},"paid_column_content"!==p.answerType?{answers:(0,r._)({},e,{isDelete:!0})}:{}),{questions:(0,r._)({},f,{answerCount:h?h.answerCount-1:0,relationship:{myAnswer:{answerId:e,isDeleted:!0}}}),users:(0,r._)({},c,{answerCount:_.answerCount-1})})},"paid_column_content"===p.answerType?{success:{answers:(0,r._)({},e,{isDelete:!0})}}:{}),{failure:{answers:(0,r._)({},e,p),questions:(0,r._)({},f,h),users:(0,r._)({},c,_)}})})}}function Z(e,t){return function(n,o){var i=o(),a=i.currentUser,c=i.entities,s=c.answers,l=c.questions,d=c.users,p=s[t],f=l[e],h=d[a];return n({API:{types:g.RESTORE,endpoint:"/answers/".concat(t,"/actions/restore"),query:{include:E()},method:"POST"},schema:u.l.ANSWER,id:e,UPDATE:{request:{answers:(0,r._)({},t,{isDelete:!1}),questions:(0,r._)({},e,{answerCount:f?f.answerCount+1:0,relationship:{myAnswer:{answerId:t,isDeleted:!1}}}),users:(0,r._)({},a,{answerCount:h.answerCount+1})},failure:{answers:(0,r._)({},t,p),questions:(0,r._)({},e,f),users:(0,r._)({},a,h)}}})}}function x(e){return{API:{endpoint:"v3/entity_word",query:{type:"answer",token:e},types:g.LOAD_ANSWER_SEARCH_ENTITY},meta:e}}function k(e){return{API:{types:g.LOAD_ANSWER_RELATION_ENDORSEMENT,endpoint:"/answers/".concat(e,"/relationship"),query:{desktop:!0}},meta:{id:e},FAILSAFE:!0}}function R(e){return function(t,n){var r=n().answers.upvoters,i=((void 0===r?{}:r)[e]||{}).next;return t({id:e,API:(0,o._)({types:g.GET_UPVOTERS},i?{endpoint:i}:{endpoint:"answers/".concat(e,"/upvoters"),query:{offset:0,limit:m.VZ}}),schema:u.l.USER_ARRAY})}}function N(e){var t;return t=d()({reshipment_settings:!0,comment_permission:!0}),{API:{types:g.GET,endpoint:"/answers/".concat(e),query:{include:t||E(),ws_qiangzhisafe:"0"},fetchOptions:{ssrPassThroughHeaders:["x-error-code","x-bdzh-t"]}},schema:u.l.ANSWER}}function O(e){return function(t,n){var o,i=n(),a=i.currentUser,c=i.entities,s=c.answers[e]||{},u=s.question.questionType,l=c.users[a],d=l.isAdvertiser,p=l.isOrg,f="nobody"!==s.collapsedBy;return t({id:e,answer:s,collapsedBy:o=f?"nobody":d&&"commercial"===u?"advertiser":p?"org":"community",API:{types:g.COLLAPSE,endpoint:"answers/".concat(e,"/actions/collapse"),method:f?"DELETE":"POST"},UPDATE:{request:{answers:(0,r._)({},e,{collapsedBy:o,isSticky:!1})},failure:{answers:(0,r._)({},e,{collapsedBy:s.collapsedBy,isSticky:s.isSticky})}}})}}function P(e){return function(t,n){var i,a=n().entities,c=(a.answers[e]||{}).isSticky,s=Object.values(a.answers).find(function(e){return e.isSticky}),u={};return i=c?"已取消当前精选回答。":s?"已设置为精选，之前的精选回答将被替换。":"已设置为精选，刷新后回答将置顶",s&&(u[s.id]={isSticky:!1}),t({id:e,API:{types:g.STICK,endpoint:"answers/".concat(e,"/actions/stick"),method:c?"DELETE":"POST"},UPDATE:{request:{answers:(0,o._)((0,r._)({},e,{isSticky:!c}),u)},failure:{answers:(0,r._)({},e,{isSticky:c})}},NOTIFICATION:{success:i,failure:function(e){return e.message}}})}}function D(e){var t=e.questionId,n=e.urlToken,a=e.user,c=e.question;return function(e){var s=c.answerCount;"commercial"!==c.questionType&&s++;var u=c.followerCount+1;return{users:(0,r._)({},n,{answerCount:a.answerCount+1}),questions:(0,r._)({},t,(0,i._)((0,o._)({},u&&{followerCount:u}),{answerCount:s,relationship:{myAnswer:{answerId:e.id,isDeleted:!1},isFollowing:!0}})),drafts:(0,r._)({},"question_".concat(t),null)}}}function L(e,t){var n=t.questionId,r=t.urlToken,o=t.user,i=t.question;return{payload:e,type:g.ADD.success,schema:u.l.ANSWER,UPDATE:{success:D({questionId:n,urlToken:r,user:o,question:i})}}}function M(e,t){return function(n,r){var o=r(),i=o.currentUser,a=o.entities,s=a.users,l=a.questions,d=s[i]||{},p=l[e]||{};return n({API:{types:g.ADD,method:"POST",endpoint:t.publishAt?"questions/".concat(e,"/scheduled-answer"):"questions/".concat(e,"/answers"),query:{include:E()},body:(0,c.decamelizeKeys)(t),fetchOptions:{zsAutoSignature:!1}},schema:u.l.ANSWER,id:e,question:p,UPDATE:{success:D({questionId:e,urlToken:i,user:d,question:p})}})}}function B(e,t){var n=e.id,o=e.data,i=t.answer;return{type:g.UPDATE.request,UPDATE:{update:{answers:(0,r._)({},n,o),drafts:(0,r._)({},"question_".concat(i.question.id),null)}}}}function U(e,t,n){var a=e.id,c=n.answer;return{payload:t,type:g.UPDATE.success,schema:u.l.ANSWER,UPDATE:{success:function(e){var t,n;return{answers:(0,r._)({},a,(0,i._)((0,o._)({},e),{rewardInfo:(0,i._)((0,o._)({},e.rewardInfo),{rewardMemberCount:null===(t=c.rewardInfo)||void 0===t?void 0:t.rewardMemberCount,rewardTotalMoney:null===(n=c.rewardInfo)||void 0===n?void 0:n.rewardTotalMoney})})),drafts:(0,r._)({},"question_".concat(c.question.id),null)}}}}}function G(e,t){var n=e.id,o=t.answer,i=t.drafts;return{type:g.UPDATE.failure,UPDATE:{update:{answers:(0,r._)({},n,o),drafts:i}}}}function F(e){return{id:e,API:{root:p.Z.fetchRoot.api,endpoint:"/kmqa/answers/".concat(e,"/paid_content"),query:{include:d()({goods_card:!0,btn_info:!0,za_info:!0,ab_param:!0,benefits_pics:!0})},types:g.LOAD_MARKET_ANSWER_PAID_CONTENT}}}function H(e){return{id:e,API:{types:g.GET_SETTINGS,endpoint:"/answers/".concat(e,"/settings")}}}function z(e,t,n){return{type:T.UPDATE_SETTINGS_DISCLAIMER,id:e,payload:{status:t,type:n}}}function q(e,t){var n=t.id;return e.entities.answers[n]}function V(e){return!!e&&!!e.relevantInfo&&["brand_answer","brand_special","brand_best"].includes(e.relevantInfo.relevantType)}function W(e,t){var n,r;return null===(n=e.answers)||void 0===n?void 0:null===(r=n.paidContent)||void 0===r?void 0:r[t]}(0,a.I)(function(){var e,t=(null===(e=p.Z.apollo)||void 0===e?void 0:e.include_reaction)==="1";return d()({"":[{is_normal:!0,is_sticky:!0,collapsed_by:!0,suggest_edit:!0,comment_count:!0,content:!0,editable_content:!0,voteup_count:!0,reshipment_settings:!0,comment_permission:!0,created_time:!0,updated_time:!0,question:!0,excerpt:!0,relationship:{is_authorized:!0,voting:!0,is_thanked:!0,is_author:!0,is_nothelp:!0},is_labeled:!0,author:{badge:[{topics:!0}]},settings:{table_of_content:{enabled:!0}},ip_info:!0,reaction:t}]})}),t.ZP=(0,s.combineReducers)({voters:(0,m.Fd)(g.GET_VOTERS),upvoters:(0,m.Fd)(g.GET_UPVOTERS,{getExtraData:function(e,t){var n;return{extra:null===(n=t.payload)||void 0===n?void 0:n.extra}}}),copyrightApplicants:(0,m.Fd)(g.GET_COPYRIGHT_APPLICANTS),favlists:(0,m.Fd)(g.GET_FAVLISTS),newAnswer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===g.ADD.success?t.payload:e},entityWords:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===g.LOAD_ANSWER_SEARCH_ENTITY.success){var n=t.meta,a=t.payload,c=(void 0===a?{}:a).searchWords;return(0,i._)((0,o._)({},e),(0,r._)({},n,c))}return t.type===g.LOAD_ANSWER_SEARCH_ENTITY.failure&&window.Raven.captureException(t.err,{logger:"searchEntityError",extra:{id:t.meta,type:"answer"}}),e},paidContent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===g.LOAD_MARKET_ANSWER_PAID_CONTENT.request){var n=t.id;return(0,i._)((0,o._)({},e),(0,r._)({},n,{isRequesting:!0}))}if(t.type===g.LOAD_MARKET_ANSWER_PAID_CONTENT.success){var a=t.id;return(0,i._)((0,o._)({},e),(0,r._)({},a,{isRequesting:!1,result:t.payload}))}if(t.type===g.LOAD_MARKET_ANSWER_PAID_CONTENT.failure){var c=t.id;return(0,i._)((0,o._)({},e),(0,r._)({},c,{isRequesting:!1,error:!0}))}return e},settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===g.GET_SETTINGS.success){var n=t.id,a=t.payload;return(0,i._)((0,o._)({},e),(0,r._)({},n,a))}if(t.type===T.UPDATE_SETTINGS_DISCLAIMER){var c=t.id,s=t.payload,u=s.status,l=s.type;return(0,i._)((0,o._)({},e),(0,r._)({},c,(0,i._)((0,o._)({},e[c]),{disclaimerInfo:[{type:l,status:u}]})))}return e},relationEndorsement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.meta,c=t.payload;return n===g.LOAD_ANSWER_RELATION_ENDORSEMENT.success?(0,i._)((0,o._)({},e),(0,r._)({},a.id,c)):e},growthCardOrder:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,a=n.type,c=n.payload,s=n.answerId;return a===g.LOAD_ANSWER_GROWTH_COMPONENT_ORDER.success?(0,i._)((0,o._)({},t),(0,r._)({},s,null===(e=c.data)||void 0===e?void 0:e.rank)):t}})},89250:function(e,t,n){"use strict";n.d(t,{Id:function(){return m},Pt:function(){return h},VA:function(){return f},cg:function(){return T},iv:function(){return g},k5:function(){return _}});var r=n(87320),o=n(55164),i=n(57477),a=n(55536),c=n(28953);n(84054);var s=n(66263),u=n(4661),l=n(74167),d=n(69906),p=n(67927),f=(0,u.FH)("article",["LIKE","VOTE","NAVIGATOR_VOTE","GET_VOTERS","GET_UPVOTERS","GET_COMMENT_PERMISSION","LOAD_ARTICLE_RELATION_ENDORSEMENT","LOAD_ARTICLE_HOT_SPOT_LIST"]);function h(e,t,n,a){return function(c,u){var l,d=u().entities.articles[e],h=("koc"===n?d.article:d)||{},_=h.voteupCount,m=h.votePosting,g=h.voting;if("navigator_up"===t||"normal_up"===t){var T="navigator_up"===t,E=!!T,y=T?"vote":"unvote";return c({id:e,API:{types:f.NAVIGATOR_VOTE,endpoint:"creators/navigator/upvote?content_type=article&content_token=".concat(e),method:T?"POST":"DELETE",body:{content_type:"article",content_token:e}},meta:{id:e,beforeVoting:g},UPDATE:{request:{articles:(0,r._)({},e,{navigatorVote:E,voteNextStep:y,votePosting:!0})},success:function(t){return"koc"===n?{articles:(0,r._)({},e,{votePosting:!1,article:(0,i._)((0,o._)({},t),{navigatorVote:E,voteNextStep:y,votePosting:!0})})}:{articles:(0,r._)({},e,(0,o._)({votePosting:!1,navigatorVote:E,voteNextStep:y},t))}},failure:{articles:(0,r._)({},e,(0,o._)({votePosting:!1},d))}},NOTIFICATION:{failure:p.XR,success:a}})}if(l=-1===g&&"neutral"===t||0===g&&"down"===t?_:Math.max(_+s.mC[t],0),!m)return c({id:e,API:{types:f.VOTE,endpoint:"articles/".concat(e,"/voters"),method:"POST",body:{voting:s.mC[t]}},meta:{id:e,beforeVoting:g},UPDATE:{request:{articles:(0,r._)({},e,{voteupCount:l,voting:s.mC[t],votePosting:!0,voteNextStep:"vote"})},success:function(t){return"koc"===n?{articles:(0,r._)({},e,{votePosting:!1,article:(0,o._)({},t),voteNextStep:"vote"})}:{articles:(0,r._)({},e,(0,o._)({votePosting:!1,voteNextStep:"vote"},t))}},failure:{articles:(0,r._)({},e,(0,o._)({votePosting:!1},d))}},NOTIFICATION:{failure:p.XR,success:a}})}}function _(e){return function(t,n){var o=n().entities.articles[e],i=o.voteupCount,a=o.voting;return t({id:e,API:{types:f.LIKE,endpoint:"articles/".concat(e,"/likers"),method:1===a?"delete":"post"},UPDATE:{request:{articles:(0,r._)({},e,{voteupCount:Math.max(1===a?i-1:i+1,0),voting:1===a?0:1})},success:function(t){return{articles:(0,r._)({},e,t)}},failure:{articles:(0,r._)({},e,o)}},NOTIFICATION:{failure:p.XR}})}}function m(e){return function(t,n){var r=n().articles,i=((void 0===r?{}:r).upvoters[e]||{}).next;return t({id:e,API:(0,o._)({types:f.GET_UPVOTERS},i?{endpoint:i}:{endpoint:"articles/".concat(e,"/upvoters"),query:{offset:0,limit:d.VZ}}),schema:c.l.USER_ARRAY})}}function g(e){return{API:{types:f.LOAD_ARTICLE_RELATION_ENDORSEMENT,endpoint:"/articles/".concat(e,"/relationship"),query:{desktop:!0}},meta:{id:e},FAILSAFE:!0}}var T=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.notification,o=void 0===n||n;return function(t,n){var i=n().entities.articles[e],a=!i.isLiked;return t({API:{types:f.LIKE,endpoint:"/articles/".concat(e,"/like"),method:a?"POST":"DELETE"},meta:{id:e},UPDATE:{success:function(){var t=(0,l.c)(i,a);return{articles:(0,r._)({},e,t)}}},NOTIFICATION:o})}};t.ZP=(0,a.combineReducers)({voters:(0,d.Fd)(f.GET_VOTERS),upvoters:(0,d.Fd)(f.GET_UPVOTERS,{getExtraData:function(e,t){var n;return{extra:null===(n=t.payload)||void 0===n?void 0:n.extra}}}),relationEndorsement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.meta,c=t.payload;return n===f.LOAD_ARTICLE_RELATION_ENDORSEMENT.success?(0,i._)((0,o._)({},e),(0,r._)({},a.id,c)):e}})},58857:function(e,t,n){"use strict";n.d(t,{ZP:function(){return u},c1:function(){return s}});var r=n(87320),o=n(55164),i=n(57477),a=n(4661),c=(0,o._)({},(0,a.FH)("banner",["GET","GET_BRANDTRACK"]),(0,a.co)("banner",["CLOSE"]));function s(e){var t=e.type,n=e.id;return{API:{types:c.GET_BRANDTRACK,endpoint:"/brand/track",query:{content_type:t,url_token:n}},NOTIFICATION:!1,FAILSAFE:!0}}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===c.GET.success){var n=t.id,a=t.location,s=t.payload.banner;e=(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},e[n]),(0,r._)({},a,{banner:s,isDrained:!0}))))}if(t.type===c.CLOSE){var u=t.id,l=t.location;e=(0,i._)((0,o._)({},e),(0,r._)({},u,(0,i._)((0,o._)({},e[u]),(0,r._)({},l,null))))}return e}},79540:function(e,t,n){"use strict";n.d(t,{PQ:function(){return u},RD:function(){return c},ZP:function(){return d}});var r=n(87320),o=n(55164),i=n(57477),a=(0,n(4661).FH)("brand",["LOAD_CONTENT_PLUGIN"]).LOAD_CONTENT_PLUGIN;function c(e,t){var n={contentType:e,contentToken:t};return{FAILSAFE:!0,API:{types:Object.values(a),endpoint:"brand/content/plugin",query:n},meta:n}}var s=function(e){var t=e.contentType,n=e.contentToken;return"".concat(t,"_").concat(n)},u=function(e,t){var n,r=e.brand,o=t.contentType,i=t.contentToken;return null==r?void 0:null===(n=r.contentPlugin)||void 0===n?void 0:n[s({contentType:o,contentToken:i})]},l={contentPlugin:{}};function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;if(n===a.success){var u=e.contentPlugin,d=s(t.meta);return(0,i._)((0,o._)({},e),{contentPlugin:(0,i._)((0,o._)({},u),(0,r._)({},d,c))})}return e}},13737:function(e,t,n){"use strict";n.d(t,{PI:function(){return p},ZP:function(){return _},hU:function(){return d},il:function(){return l},o5:function(){return f}});var r=n(55164),o=n(57477),i=n(80714),a=n(4785),c=n(68900),s=n(4661),u=(0,r._)({},(0,s.FH)("captcha",["GET","GET_V2","PUT_V2"]),(0,s.co)("captcha",["RESET_CAPTCHA_INFO","CAPTCHA_EXPIRES","RESET_CAPTCHA_V2"]));function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scene,n={type:"captcha_sign_in"};return i.Z.isMobileEntry||"1"!==i.Z.apollo.sign_flow_scene||(n.scene=t||"unknown"),{meta:e,API:{types:u.GET_V2,endpoint:"v3/oauth/captcha/v2",method:"GET",query:n,fetchOptions:{zsAutoSignature:!1,withDUBrowserID:!0}},NOTIFICATION:!1}}function d(){return{type:u.RESET_CAPTCHA_V2}}function p(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,o){var s,l=o(),d=(null!==(s=(0,c.Uh)(l))&&void 0!==s?s:{}).isAppleDevice,p={ticket:e},f=l.captcha.captchaScene;return i.Z.isMobileEntry||"1"!==i.Z.apollo.sign_flow_scene||(p.scene=f),n({API:(0,r._)({types:u.PUT_V2,endpoint:"v3/oauth/captcha/v2",method:"PUT",fetchOptions:{body:(0,a.Z)(p),withDUBrowserID:!0}},d&&{query:{ticket:e}}),NOTIFICATION:t})}}function f(){return{type:u.RESET_CAPTCHA_INFO}}var h={captchaNeeded:!1,captchaValidated:!1};function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0,n=t.type,i=t.payload;if(n===u.GET_V2.success){var a,c=t.meta.scene;return(0,o._)((0,r._)({},e),{v2:i,captchaNeeded:!!(null===(a=i.script)||void 0===a?void 0:a.length),captchaValidated:!1,captchaScene:c})}return n===u.PUT_V2.success?(0,o._)((0,r._)({},e),{captchaNeeded:!i.success,captchaValidated:i.success,captchaScene:void 0}):n===u.RESET_CAPTCHA_INFO?(0,o._)((0,r._)({},h),{captchaValidated:e.captchaValidated,v2:e.v2}):n===u.RESET_CAPTCHA_V2?(0,o._)((0,r._)({},e),{captchaValidated:!1,captchaScene:void 0}):e}},73086:function(e,t,n){"use strict";n.d(t,{Ok:function(){return w},vn:function(){return b},JB:function(){return C},ZP:function(){return V},Rn:function(){return U},$Z:function(){return B},sT:function(){return P},ii:function(){return O},tw:function(){return N},fb:function(){return k},wh:function(){return G},N1:function(){return S},$x:function(){return x},Vq:function(){return D},RW:function(){return L},bG:function(){return R},Hf:function(){return Z},BI:function(){return M}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(6907),s=n(74135),u=n(57266),l=n.n(u),d=n(60683),p=n(30994),f=n(68455),h=n(80714),_=n(4661),m=n(33068),g=n(64813),T=n(25130),E=(0,_.co)("chat",["UPDATE_INBOX"]),y=function(e){var t=e.senderId,n=e.isRead;return function(e,o){var i=o(),a=i.entities,c=i.chat,s=a.chats[t],u=[],l=c.inbox.strangers||{};if(l.result&&(u=l.result),!s)return e(function(e){return e((0,m.pU)(!0)).then(function(t){return t.payload.strangerMessage.switch?e((0,g.v)(!0)):Promise.resolve()})});var d=s.unreadCount,p=void 0===d?0:d;return e(n?u.includes(t)?(0,T.pP)(!1):(0,T.cs)(-1*p):u.includes(t)?(0,T.pP)(!0):(0,T.cs)(1)),e({type:E.UPDATE_INBOX,UPDATE:{update:{chats:(0,r._)({},t,{unreadCount:n?0:p+1})}}})}},C=(0,o._)({},(0,_.FH)("chat",["GET_HISTORY_MESSAGES","GET_LATEST_MESSAGES","SEND_MESSAGE","SEND_ECOM_MESSAGE","SET_MESSAGE_READ","DELETE_MESSAGE","DELETE_MESSAGE_THREAD","GET_ECOM_EVENT","GET_ECOM_COUPON","GET_ECOM_PROFILE","SEND_ECOM_SUBMIT"]),(0,_.co)("chat",["ADD_NEW_MESSAGE","INPUT_MESSAGE","ADD_TEMP_IMAGE_MESSAGE","ADD_TEMP_ECOM_CARD_MESSAGE","SET_IMAGE_SEND_FAILURE","DELETE_LOCAL_MESSAGE","RESET_HISTORY_MESSAGES"]));function S(e){var t=e.senderId,n=e.inputValue;return{type:C.INPUT_MESSAGE,meta:{inputValue:n,senderId:t}}}function I(e){return!!e&&new RegExp(/<a href="https:\/\/www.zhihu.com\/inbox\/+[\s\S]*?is_ecom=1/).test(e)}function A(e){var t=e.contentType,n=e.receiverId,r=e.data,a=e.tempMessageId||(0,c.E)("tempMessageId_"),s=null;return t===d.wF.text&&(s=(0,f.Wf)(r.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"))),{receiverId:n,data:(0,i._)((0,o._)({userType:"receiver",type:"message",createdTime:Date.now(),contentType:t,id:a},r),{richText:s})}}function b(e,t,n,r,o){var i=A({contentType:d.wF.image,receiverId:e,data:{id:n,image:{height:r,width:o,url:t}},tempMessageId:n});return p.Z.info("4️⃣ 添加临时图片消息",{tempMessageId:n,dimensions:{width:o,height:r}}),{type:C.ADD_TEMP_IMAGE_MESSAGE,meta:i}}function w(e,t,n){var r=A({contentType:d.wF.ecomcard,receiverId:e,data:{id:t,ecomCard:{cardType:n}},tempMessageId:t});return{type:C.ADD_TEMP_ECOM_CARD_MESSAGE,meta:r}}function Z(e){var t=e.receiverId,n=e.tempMessageId,r=e.file;return p.Z.info("标记图片发送失败",{tempMessageId:n,receiverId:t,fileSize:r.size,fileName:r.name}),{type:C.SET_IMAGE_SEND_FAILURE,meta:{receiverId:t,tempMessageId:n,file:r}}}function x(e){var t=e.senderId;return function(e){return e({type:C.RESET_HISTORY_MESSAGES,meta:{senderId:t}})}}function k(e){var t=e.senderId,n=e.clientScene,r=e.messageBizName,i=e.messageBizExtInfo;return function(e,a){var c=(a().chat.chats[t]||{}).nextApiUrl,u=(void 0===c?"":c).split("?")[1],d=u?{endpoint:"/chat?".concat(u)}:{endpoint:"/chat",query:(0,s.decamelizeKeys)(l()({senderId:t,clientScene:n,messageBizName:r,messageBizExtInfo:i}))};return e({API:(0,o._)({types:C.GET_HISTORY_MESSAGES},d),meta:{senderId:t}})}}function R(e){var t=e.contentType,n=e.receiverId,r=e.data,i=e.tempMessageId,a=e.sourceType,c=e.sourceId,s=e.replySource,u=A({contentType:t,receiverId:n,data:r,tempMessageId:i});return p.Z.info("\uD83D\uDD1F 发送消息",{tempMessageId:i,hasImage:t===d.wF.image}),{API:{types:C.SEND_MESSAGE,endpoint:"/chat",method:"POST",body:(0,o._)({content_type:d.YX[t],receiver_id:n},a&&{source_type:a},c&&{source_id:c},s&&{reply_source:s},r)},meta:u}}function N(e){return{API:{types:C.GET_ECOM_PROFILE,root:h.Z.fetchRoot.api,endpoint:"api/v4/crm/chat/plugin/profile/".concat(e),method:"GET"}}}function O(e){var t=e.templateType,n=e.senderId;return{API:{types:C.GET_ECOM_EVENT,root:h.Z.fetchRoot.api,endpoint:"api/v4/crm/chat/plugin/clue_activities?template_type=".concat(void 0===t?2:t),method:"GET"},meta:{senderId:n}}}function P(){return{API:{types:C.GET_ECOM_COUPON,root:h.Z.fetchRoot.api,endpoint:"api/v4/crm/chat/plugin/coupons",method:"GET"}}}function D(e){var t=e.contentType,n=e.id,r=e.token,o=e.data,i=e.tempMessageId,a=o.receiverId,c=o.cardType,s=A({contentType:t,receiverId:a,data:o,tempMessageId:i});return{API:{types:C.SEND_ECOM_MESSAGE,root:h.Z.fetchRoot.api,endpoint:1===c?"api/v4/crm/chat/plugin/clue_activities/".concat(r,"/action/send"):"api/v4/crm/chat/plugin/coupons/".concat(n,"/action/send"),method:"POST",body:{receiver_id:a}},meta:s}}function L(e){var t=e.token,n=e.data.phone;return{API:{types:C.SEND_ECOM_SUBMIT,root:h.Z.fetchRoot.api,endpoint:"api/v4/crm/chat/plugin/clue_activities/".concat(t,"/action/submit"),method:"POST",body:{phone_no:n}}}}function M(e){return function(t){t(y({senderId:e,isRead:!0})),t({API:{types:C.SET_MESSAGE_READ,endpoint:"/messages/read/".concat(e),method:"PUT"}})}}function B(e,t){return{API:{types:C.DELETE_MESSAGE,endpoint:"/messages/".concat(e),method:"DELETE"},meta:{messageId:e,senderId:t}}}function U(e,t){return{type:C.DELETE_LOCAL_MESSAGE,meta:{messageId:e,senderId:t}}}function G(e,t){p.Z.info("handleReceiveMessage Start",{message:e,currentUserHashId:t});var n=e.content,r=void 0===n?{}:n,i=e.meta,a=void 0===i?{}:i,c=a.sender_id,u=a.content_type,l=a.created_at,h=a.id,_=e.extra,m=e.extra,g=void 0===m?{}:m,T=g.message_type,E=g.extra_content,S=g.associate_id,A=g.unfriendly,b={userType:t!==c?"sender":"receiver",type:T||"message",createdTime:l,contentType:u,id:h,status:d.Gs.success,extraInfo:(0,s.camelizeKeys)(void 0===_?{}:_),extraContent:E,unfriendly:!!Number(A),associateId:S,isEcomWelcomeCard:!1};return b[b.contentType]=(0,s.camelizeKeys)(r[b.contentType]),u===d.wF.text&&(b.richText=(0,f.Wf)(b.text),b.isEcomWelcomeCard=I(b.richText)),u===d.wF.ecomcard&&(b.ecomCard=(0,o._)({},r.ecom_card)),u===d.wF.csevaluationcard&&(b.csevaluationCard=r.csevaluation_card),p.Z.info("handleReceiveMessage Result",{messageInfo:b,contentType:u,senderId:c}),function(e){e(y({senderId:c})),e({type:C.ADD_NEW_MESSAGE,meta:{messageInfo:b,senderId:c}})}}function F(e){var t=d.HG[e.contentType],n="text"===t?(0,f.Wf)(e.text||e.content):null;return(0,i._)((0,o._)({},e),{contentType:t,createdTime:1e3*e.createdTime,status:d.Gs.success,richText:n,isEcomWelcomeCard:"text"===t&&I(e.text||e.content)})}var H=function(e){return(null==e?void 0:e.messages)||[]},z=function(e){var t=(e||{}).lastTimeStamp;return{lastTimeStamp:void 0===t?null:t}};function q(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(0,a._)(e),c=n.file,s=e.length-1;s>=0;s--)if(e[s].id===t){r[s]=(0,i._)((0,o._)({},r[s],c&&{file:c}),{status:d.Gs.failure});break}return r}function V(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===C.GET_HISTORY_MESSAGES.request){var n=t.meta.senderId;return(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},e[n]),{isLoading:!0})))}if(t.type===C.GET_HISTORY_MESSAGES.success||t.type===C.GET_LATEST_MESSAGES.success){var c=t.payload,s=c.warning,u=c.paging,l=c.data,f=u.isEnd,h=u.next,_=l.receiver,m=l.sender,g=l.messages,T=m.id,E=e[T],y=(null==E?void 0:E.sender)?H(E):[],S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!(null==e?void 0:e.length))return{formattedMessages:[],lastTimeStamp:t};var n=t||1e3*e[0].createdTime;return{formattedMessages:e.map(function(t,r){var a=(0,i._)((0,o._)({},t),{showTime:!1}),c=1e3*a.createdTime;if(Math.abs(n-c)>d.X||n===c)a.showTime=!0;else{var s=e[r+1];s&&Math.abs(c-1e3*s.createdTime)>d.X&&(a.showTime=!0)}return n=c,F(a)}).reverse(),lastTimeStamp:n}}(g,z(E).lastTimeStamp),I=S.formattedMessages,A=S.lastTimeStamp,b=t.type===C.GET_LATEST_MESSAGES.success?(0,a._)(I):(0,a._)(I).concat((0,a._)(y));return(0,i._)((0,o._)({},e),(0,r._)({},T,{receiver:_,sender:m,messages:b,isLoading:!1,isEnd:f,nextApiUrl:h,lastTimeStamp:A,inputValue:e[T].inputValue,warning:void 0===s?{}:s}))}if(t.type===C.RESET_HISTORY_MESSAGES){var w=t.meta.senderId;return(0,i._)((0,o._)({},e),(0,r._)({},w,void 0))}if(t.type===C.ADD_NEW_MESSAGE){var Z,x,k=t.meta,R=k.senderId,N=k.messageInfo;p.Z.info("ADD_NEW_MESSAGE Action",{action:t,senderId:R,messageType:N.contentType});var O=e[R],P=H(O),D=z(O).lastTimeStamp,L=(Z=(0,o._)({},N),x=D,Z.createdTime-x>=d.X?(Z.showTime=!0,x=Z.createdTime):Z.showTime=!1,{message:Z,lastTimeStamp:x}),M=L.message,B=L.lastTimeStamp;if(P.length&&P[P.length-1].id===M.id)return p.Z.info("ADD_NEW_MESSAGE Duplicate",{messageId:M.id}),(0,o._)({},e);var U=(0,i._)((0,o._)({},e),(0,r._)({},R,(0,i._)((0,o._)({},e[R]),{messages:(0,a._)(P).concat([M]),lastTimeStamp:B})));return p.Z.info("ADD_NEW_MESSAGE Success",{newMessage:M,totalMessages:U[R].messages.length}),U}if(t.type===C.INPUT_MESSAGE){var G=t.meta,V=G.senderId,W=G.inputValue;return(0,i._)((0,o._)({},e),(0,r._)({},V,(0,i._)((0,o._)({},e[V]),{inputValue:W})))}if(t.type===C.ADD_TEMP_IMAGE_MESSAGE||t.type===C.ADD_TEMP_ECOM_CARD_MESSAGE){var X=t.meta.receiverId;return(0,i._)((0,o._)({},e),(0,r._)({},X,(0,i._)((0,o._)({},e[X]),{messages:(0,a._)(e[X].messages).concat([(0,i._)((0,o._)({},t.meta.data),{status:d.Gs.loading})])})))}if(t.type===C.SET_IMAGE_SEND_FAILURE){var K=t.meta,j=K.receiverId,Y=K.tempMessageId,Q=K.file,J=q(e[j].messages,Y,{file:Q});return(0,i._)((0,o._)({},e),(0,r._)({},j,(0,i._)((0,o._)({},e[j]),{messages:J})))}if(t.type===C.SEND_MESSAGE.request||t.type===C.SEND_ECOM_MESSAGE.request){var $=t.meta,ee=$.receiverId,et=$.data.contentType;if(et===d.wF.image){var en=t.meta.data,er=en.image.url,eo=en.id,ei=function(e,t,n){for(var r=(0,a._)(e),o=e.length-1;o>=0;o--)if(e[o].id===t){r[o].image.url=n;break}return r}(e[ee].messages,eo,er);return(0,i._)((0,o._)({},e),(0,r._)({},ee,(0,i._)((0,o._)({},e[ee]),{messages:ei})))}if(et===d.wF.ecomcard&&1===t.meta.data.cardType){var ea=e[ee].messages;return(0,i._)((0,o._)({},e),(0,r._)({},ee,(0,i._)((0,o._)({},e[ee]),{messages:ea})))}return(0,i._)((0,o._)({},e),(0,r._)({},ee,(0,i._)((0,o._)({},e[ee],et===d.wF.text&&{inputValue:""}),{messages:(0,a._)(e[ee].messages).concat([(0,i._)((0,o._)({},t.meta.data),{status:d.Gs.loading})])})))}if(t.type===C.SEND_MESSAGE.success||t.type===C.SEND_ECOM_MESSAGE.success){var ec=t.payload.info,es=t.meta,eu=es.receiverId,el=es.data,ed=el.id,ep=el.contentType,ef=e[eu],eh=z(ef).lastTimeStamp,e_=function(e,t,n,r){for(var c=(0,a._)(e),s=(0,o._)({},n),u=r,l=e.length-1;l>=0;l--)if(e[l].id===t){1e3*s.createdTime-u>=d.X?(s.showTime=!0,u=1e3*s.createdTime):s.showTime=!1,c[l]=(0,i._)((0,o._)({},F(s)),{tempMessageId:t});break}return{realMessageList:c,lastTimeStamp:u}}(ef.messages,ed,ec,eh),em=e_.realMessageList,ev=e_.lastTimeStamp;return(0,i._)((0,o._)({},e),(0,r._)({},eu,(0,i._)((0,o._)({},e[eu],ep===d.wF.text&&{inputValue:""}),{messages:em,lastTimeStamp:ev})))}if(t.type===C.SEND_MESSAGE.failure||t.type===C.SEND_ECOM_MESSAGE.failure){var eg=t.meta,eT=eg.receiverId,eE=eg.data.id,ey=q(e[eT].messages,eE);return(0,i._)((0,o._)({},e),(0,r._)({},eT,(0,i._)((0,o._)({},e[eT]),{messages:ey})))}if(t.type===C.DELETE_MESSAGE.success||t.type===C.DELETE_LOCAL_MESSAGE){var eC=t.meta,eS=eC.messageId,eI=eC.senderId,eA=e[eI].messages.filter(function(e){return e.id!==eS});return(0,i._)((0,o._)({},e),(0,r._)({},eI,(0,i._)((0,o._)({},e[eI]),{messages:eA})))}if(t.type===C.GET_ECOM_PROFILE.success){var eb=t.payload.receiver;return(0,i._)((0,o._)({},e),{isEcomMerchant:!!eb.isMerchant})}return e}},25130:function(e,t,n){"use strict";n.d(t,{ZP:function(){return p},cs:function(){return l},pP:function(){return d}});var r=n(55164),o=n(57477),i=n(4661),a=n(33068),c=n(73135),s={newCount:0,strangerMessageSwitch:!1,strangerMessageUnread:!1,friendCount:0},u=(0,i.co)("chat",["UPDATE_TOTAL_UNREAD_COUNT","CHANGE_STRANGER_MESSAGE_UNREAD_STATUS"]);function l(e){return{type:u.UPDATE_TOTAL_UNREAD_COUNT,meta:{count:e}}}function d(e){return{type:u.CHANGE_STRANGER_MESSAGE_UNREAD_STATUS,meta:{status:e}}}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.Hp.GET_RECENTS.success:var n=t.payload,i=n.newCount,l=n.strangerMessage,d=l.switch,p=l.unread;return(0,o._)((0,r._)({},e),{newCount:i,strangerMessageSwitch:d,strangerMessageUnread:p});case c.Hp.GET_FRIENDS.success:return(0,o._)((0,r._)({},e),{friendCount:t.totals});case u.UPDATE_TOTAL_UNREAD_COUNT:var f=e.newCount,h=t.meta.count,_=f+(void 0===h?0:h);return(0,o._)((0,r._)({},e),{newCount:_>0?_:0});case u.CHANGE_STRANGER_MESSAGE_UNREAD_STATUS:var m=t.meta.status;return(0,o._)((0,r._)({},e),{strangerMessageUnread:m});default:return e}}},86871:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(54463),a=n.n(i),c={isFetching:!1,isDrained:!1,isPrevDrained:!1,result:[],next:null,key:null};t.Z=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e},i=e.request,s=e.success,u=e.failure;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,l=arguments.length>1?arguments[1]:void 0;switch(l.type){case t:return c;case i:return(0,o._)((0,r._)({},e),{isFetching:!0});case s:var d=l.key,p=l.result,f=l.next,h=l.isDrained,_=l.isPrevDrained,m=d!==e.key;return(0,o._)((0,r._)({},e),{result:m?p:a()(e.result,p),key:d,next:f,isDrained:h||p.length<10,isPrevDrained:_,isFetching:!1});case u:return(0,o._)((0,r._)({},e),{isFetching:!1});default:return n(e,l)}}}},73135:function(e,t,n){"use strict";n.d(t,{Hp:function(){return i}}),n(28953);var r=n(4661),o=n(86871),i=(0,r.FH)("chat",["GET_FRIENDS"]);t.ZP=(0,o.Z)(i.GET_FRIENDS)},33068:function(e,t,n){"use strict";n.d(t,{Hp:function(){return l},pU:function(){return d}});var r=n(55164),o=n(57477),i=n(49899),a=n(56669),c=n(4661),s=n(86871),u=n(73086),l=(0,c.FH)("chat",["GET_RECENTS"]),d=function(e){return function(t,n){var r=n().chat.inbox.recents.next;return t({API:{types:l.GET_RECENTS,endpoint:e||!r?"/inbox":r},schema:a.e})}};t.ZP=(0,s.Z)(l.GET_RECENTS,null,function(e,t){if(t.type===u.JB.SEND_MESSAGE.success){var n=e.result,a=t.meta.receiverId;return n.indexOf(a)>=0?e:(0,o._)((0,r._)({},e),{result:[a].concat((0,i._)(n))})}if(t.type===u.JB.DELETE_MESSAGE_THREAD.success){var c=t.meta.chatId;return(0,o._)((0,r._)({},e),{result:e.result.filter(function(e){return e!==c})})}return e})},64813:function(e,t,n){"use strict";n.d(t,{v:function(){return l}});var r=n(55164),o=n(57477),i=n(56669),a=n(4661),c=n(86871),s=n(73086),u=(0,a.FH)("chat",["GET_STRANGERS"]),l=function(e){return function(t,n){var r=n().chat.inbox.strangers.next;return t({API:{types:u.GET_STRANGERS,endpoint:e||!r?"/stranger_inbox":r},schema:i.e})}};t.Z=(0,c.Z)(u.GET_STRANGERS,null,function(e,t){if(t.type===s.JB.SEND_MESSAGE.success){var n=e.result,i=t.meta.receiverId;return 0>n.indexOf(i)?e:(0,o._)((0,r._)({},e),{result:n.filter(function(e){return e!==i})})}if(t.type===s.JB.DELETE_MESSAGE_THREAD.success){var a=t.meta.chatId;return(0,o._)((0,r._)({},e),{result:e.result.filter(function(e){return e!==a})})}return e})},56669:function(e,t,n){"use strict";n.d(t,{e:function(){return a}});var r=n(84),o=n(28953),i=new r.fK.Entity("chats",{participant:o.l.USER},{idAttribute:function(e){return e.participant.id}}),a=new r.fK.Array(i)},82335:function(e,t,n){"use strict";n.d(t,{e:function(){return f},u:function(){return p}});var r=n(87320),o=n(55164),i=n(57477),a=n(74135),c=n(4785),s=n(4661),u=n(66263),l=(0,o._)({},(0,s.FH)("collaboration",["ADD_ANNOTATION","CANCEL_ANNOTATION"])),d=function(e){return e===u.R8?"answers":e===u.oP?"pins":e===u.zs?"articles":null},p=function(e,t,n,o){return{API:{types:l.ADD_ANNOTATION,endpoint:"v3/collaboration/annotation",method:"POST",body:(0,c.z)((0,a.decamelizeKeys)({objectType:e,urlToken:t,reason:n,detail:o}))},UPDATE:{success:function(n){var o=d(e);return o?(0,r._)({},o,(0,r._)({},t,n)):null}}}},f=function(e,t,n,s){return{API:{types:l.CANCEL_ANNOTATION,endpoint:"v3/collaboration/annotation_cancel",method:"POST",body:(0,c.z)((0,a.decamelizeKeys)({objectType:e,urlToken:t,reason:n,detail:s}))},UPDATE:{success:function(n){var a=d(e);return a?(0,r._)({},a,(0,r._)({},t,(0,i._)((0,o._)({},n),{annotationDetail:null}))):null}}}}},25809:function(e,t,n){"use strict";n.d(t,{Hp:function(){return f},ZP:function(){return m},Nn:function(){return g}});var r=n(55164),o=n(57477),i=n(49899),a=n(55536),c=n(98104),s=n(35528),u=n(74135),l=n(84),d=n(28953),p=n(4661);new l.fK.Array(new l.fK.Entity("favlistFeedsByIds",{content:new l.fK.Union({article:d.l.ARTICLE,answer:d.l.ANSWER,pin:d.l.PIN,zvideo:d.l.ZVIDEO,eduCourse:d.l.EDU_COURSE,eduSection:d.l.EDU_SECTION},function(e){return(0,u.camelize)(e.type)})},{idAttribute:function(e){var t=e.content,n=t.type,r=t.id;return"".concat(n,"_").concat(r)}}));var f=(0,r._)({},(0,p.FH)("collections",["ADD","DELETE","UPDATE","GET_DETAIL","GET_FEEDS","DELETE_FEED_ITEM","CANCEL_DELETE_FEED_ITEM"])),h={data:[],paging:{},isLoading:!1,errorPayload:null},_=(0,c.V6)(f.GET_FEEDS,{additionalCaseTypes:[f.DELETE_FEED_ITEM.success,f.CANCEL_DELETE_FEED_ITEM.success],additionalCase:function(e,t){return t.type===f.DELETE_FEED_ITEM.success?(0,o._)((0,r._)({},e),{deletedItems:(0,i._)(e.deletedItems||[]).concat([t.deletedItemId])}):t.type===f.CANCEL_DELETE_FEED_ITEM.success?(0,o._)((0,r._)({},e),{deletedItems:e.deletedItems.filter(function(e){return e!==t.deletedItemId})}):e}}),m=(0,a.combineReducers)({hot:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;if(t.type===s.xb.GET_HOT_FAVLISTS.request)return(0,o._)((0,r._)({},e),{isLoading:!0,errorPayload:null});if(t.type===s.xb.GET_HOT_FAVLISTS.success){var n=t.payload,a=n.data,c=n.paging;return{data:(0,i._)(e.data).concat((0,i._)(a.map(function(e){return e.id}))),paging:c,isLoading:!1}}return t.type===s.xb.GET_HOT_FAVLISTS.failure?(0,o._)((0,r._)({},e),{paging:(0,o._)((0,r._)({},e.paging),{isEnd:!0}),isLoading:!1,errorPayload:t.err||t.error}):e},collectionFeeds:_});function g(e,t){return t.type===f.ADD.success?(0,o._)((0,r._)({},e),{totals:e.totals+1,ids:[t.result].concat((0,i._)(e.ids))}):t.type===f.DELETE.success?(0,o._)((0,r._)({},e),{totals:e.totals-1,ids:e.ids.filter(function(e){return e!==t.id})}):e}},10886:function(e,t,n){"use strict";n.d(t,{As:function(){return p},PG:function(){return d},Pu:function(){return u},bK:function(){return f},ly:function(){return l}});var r=n(87320),o=n(55164),i=n(55536),a=n(28953),c=n(4661),s=n(69906),u=(0,c.FH)("column",["GET","UPDATE_FOLLOW","GET_COLUMN_FOLLOWERS","SUBMIT_REQUEST"]);function l(e){return{API:{types:u.GET,endpoint:"columns/".concat(e),query:{include:"title,intro,description,image_url,articles_count,followers,is_following,last_article.created"}},urlToken:e,schema:a.l.COLUMN}}function d(e){return{API:{types:u.SUBMIT_REQUEST,endpoint:"/columns/request",method:"POST",body:e},NOTIFICATION:!1}}function p(e){return function(t,n){var o=n(),i=o.entities,a=i.columns,c=i.users,s=o.currentUser,l=a[e],d=c[s],p=l.isFollowing,f=l.followers,h=p?-1:1;return t({urlToken:s,columnId:e,expect:!p,API:{types:u.UPDATE_FOLLOW,endpoint:"columns/".concat(e,"/").concat(p?"unfollow":"follow"),method:"PUT"},UPDATE:{request:{columns:(0,r._)({},e,{isFollowing:!p,followers:f+h}),users:(0,r._)({},s,{followingColumnsCount:d.followingColumnsCount+h})},failure:{columns:(0,r._)({},e,l),users:(0,r._)({},s,c)}}})}}function f(e){return function(t,n){var r=(n().columns.voters[e]||{}).next;return t({id:e,API:(0,o._)({types:u.GET_COLUMN_FOLLOWERS},r?{endpoint:r}:{endpoint:"columns/".concat(e,"/followers"),query:{include:"data[*].follower_count,gender,is_followed,is_following",offset:0,limit:s.VZ}}),schema:a.l.USER_ARRAY})}}t.ZP=(0,i.combineReducers)({voters:(0,s.Fd)(u.GET_COLUMN_FOLLOWERS)})},803:function(e,t,n){"use strict";n.d(t,{I6:function(){return u},ZP:function(){return d},n5:function(){return l}});var r=n(87320),o=n(55164),i=n(57477),a=n(4661),c=n(16563),s=(0,a.FH)("commentPermission",["LOAD_TYPE_RELATED_COMMENT_PERMISSIONS","LOAD_CONTENT_COMMENT_PERMISSION"]);function u(e){return{API:{types:s.LOAD_TYPE_RELATED_COMMENT_PERMISSIONS,endpoint:"/comment_v5/".concat(e,"s/permission")},meta:{type:e}}}function l(e,t){return{API:{types:s.LOAD_CONTENT_COMMENT_PERMISSION,endpoint:"/comment_v5/".concat(e,"s/").concat(t,"/permission")},meta:{type:e,id:t}}}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.payload,a=t.meta;switch(t.type){case s.LOAD_TYPE_RELATED_COMMENT_PERMISSIONS.success:var u=a.type;return(0,i._)((0,o._)({},e),(0,r._)({},u,(0,i._)((0,o._)({},e[u]),{default:n.data})));case s.LOAD_CONTENT_COMMENT_PERMISSION.success:var l=a.type,d=a.id;return(0,i._)((0,o._)({},e),(0,r._)({},l,(0,i._)((0,o._)({},e[l]),(0,r._)({},d,(0,c.Qz)(n.data,l)))))}return e}},65514:function(e,t,n){"use strict";n.d(t,{$X:function(){return u},ZP:function(){return d},j7:function(){return c},jt:function(){return s},oq:function(){return l}});var r=n(55164),o=n(57477),i=n(74135),a=(0,n(4661).FH)("ask",["GET_MATCH_TOPICS","ADD","GET_QUESTION_TIPS"]);function c(e){return{type:a.ADD.success,payload:e}}function s(e){return{API:{types:a.ADD,method:"POST",endpoint:"questions",fetchOptions:{zsEncrypt:!0,body:(0,i.decamelizeKeys)(e)}}}}function u(e){var t=(0,r._)({type:"question"},e),n=t.text,o=t.type,i=t.signal;return{API:{types:a.GET_MATCH_TOPICS,endpoint:"/recommendations/match-topics",query:{text:n,type:o},fetchOptions:{signal:i}}}}function l(e){var t=(0,r._)({action:"question"},e),n=t.title,o=t.action,i=t.signal;return{API:{types:a.GET_QUESTION_TIPS,endpoint:"/content/publish/notice",query:{title:n,action:o},fetchOptions:{signal:i}}}}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(!t.payload||![a.ADD.success,a.ADD.failure].includes(t.type))return e;var n=t.payload,i=n.id,c=n.code,s=n.message;switch(c){case 103003:return(0,o._)((0,r._)({},e),{title:{level:"error",text:"已经存在的问题"}});case 103001:return(0,o._)((0,r._)({},e),{detail:{level:"error",text:"过长的补充说明"}});default:return i?{id:i}:(0,o._)((0,r._)({},e),{overall:{text:s}})}}},11345:function(e,t,n){"use strict";n.d(t,{Z:function(){return u},z:function(){return s}});var r=n(55164),o=n(57477),i=n(80714),a=(0,n(4661).FH)("cities",["LOAD_CITIES"]),c={cityData:[]};function s(){return{API:{method:"GET",types:a.LOAD_CITIES,endpoint:"content/publish/content_source/config",root:i.Z.fetchRoot.api}}}function u(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,i=arguments.length>1?arguments[1]:void 0;return i.type===a.LOAD_CITIES.success?(0,o._)((0,r._)({},n),{cityData:null===(e=i.payload)||void 0===e?void 0:null===(t=e.data)||void 0===t?void 0:t.regions}):n}},31274:function(e,t,n){"use strict";n.d(t,{j7:function(){return o.j7},zT:function(){return i.z}});var r=n(55536),o=n(65514),i=n(11345);t.ZP=(0,r.combineReducers)({ask:o.ZP,cities:i.Z})},11556:function(e,t,n){"use strict";n.d(t,{O:function(){return s},Z:function(){return u}});var r=n(87320),o=n(55164),i=n(57477),a=n(4661),c=(0,o._)({},(0,a.FH)("CONTENT_COLUMN",["GET_COLUMN_CARD"]));function s(e,t){return{API:{types:c.GET_COLUMN_CARD,endpoint:"/column/".concat(e,"s/").concat(t,"/card")},meta:{type:e,id:t},FAILSAFE:!0}}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===c.GET_COLUMN_CARD.success?(0,i._)((0,o._)({},e),(0,r._)({},"".concat(t.meta.type,"-").concat(t.meta.id),t.payload)):e}},19958:function(e,t,n){"use strict";n.d(t,{NC:function(){return p},Uq:function(){return f},ZP:function(){return m},g3:function(){return h}});var r=n(87320),o=n(55164),i=n(57477),a=n(74135),c=n(36762),s=n.n(c),u=n(4661),l=n(45347),d=(0,o._)({},(0,u.FH)("creator",["GET_CREATOR_CAPTCHA","GET_CREATOR_SMS_SUPPORTED_COUNTRIES","VALIDATE_CREATOR_CAPTCHA","POST_CREATOR_APPLY_INFO","VALIDATE_CREATOR_CAPTCHA","LOAD_CREATOR_SMS_SUPPORTED_COUNTRIES","GET_TOOLS_QUESTION_INVITED_COUNT","GET_TOOLS_QUESTION_DOMAIN","GET_TOOLS_HOT_QUESTION_LIST","GET_TOOLS_MCN_QUESTION_LIST","SUBSCRIBE_TOOLS_HOTSPOT_DOMAIN_LIST","UPDATE_TOOLS_HOTSPOT_DOMAIN","GET_PROFIT_REWARD_COMMUNITY_LIST","GET_PROFIT_REWARD_PROMOTION_TOTAL","GET_PROFIT_REWARD_PROMOTION_LIST","LOAD_PROMOTION_PROTOCOL","GET_CONTENT_RIGHTS_NOTIFICATION","READ_CONTENT_RIGHTS_NOTIFICATION","UNLOCK_CREATOR_RIGHTS","GET_REALNAME_STATUS","GET_MCN_DAILY_STATUS","GET_MCN_ORDER_LIST","GET_MCN_OVERDUE_GOODS_LIST","GET_MCN_ORDER_DETAIL","GET_MCN_STATISTICS","GET_MCN_CURRENT_MONTH_STATS","GET_MCN_OVERVIEW_DATA","GET_MCN_BALANCE_DATA","GET_MCN_BALANCE_LIST","LOAD_TABLE","GET_CREATOR_TASKS","DO_CREATOR_TASK","LOAD_HOT_QUESTION_LIST","LOAD_CREATOR_STATISTICS","GET_RECOMMEND_QUESTION_LIST"]),(0,u.co)("creator",["READ_CONTENT_RIGHTS_NOTIFICATION_LOCALLY","CLEAN_MCN_ORDER_LIST","UPDATE_EDIT_MODAL_STATUS"]));function p(e,t){return{API:{types:d.GET_CONTENT_RIGHTS_NOTIFICATION,method:"GET",endpoint:"/creator/notification/content/".concat(e,"s/").concat(t)},UPDATE:{success:function(n){return(0,r._)({},"".concat(e,"s"),(0,r._)({},t,{creatorRightsNotification:n}))}}}}function f(e,t,n){return function(o,i){var a=i().entities["".concat(e,"s")][t].creatorRightsNotification,c=(0,r._)({},"".concat(e,"s"),(0,r._)({},t,{creatorRightsNotification:s()(a,function(){return 0})}));return o("current"===n?{type:d.READ_CONTENT_RIGHTS_NOTIFICATION_LOCALLY,UPDATE:{update:c}}:{API:{types:d.READ_CONTENT_RIGHTS_NOTIFICATION,method:"next"===n?"PATCH":"DELETE",endpoint:"/creator/notification/content/".concat(e,"s/").concat(t)},UPDATE:{request:c}})}}function h(e){return{API:{types:d.UNLOCK_CREATOR_RIGHTS,method:"PATCH",endpoint:"/creator/rights/".concat(e)}}}var _={tools:{question:{invitationCount:{questionFolloweeCount:0,questionTotalCount:0}},recommend:{recommendTimes:{}}},explore:{},levelUpperLimit:10,mcn:{},mcnManage:{},tasks:{},announcement:{},creatorsRecommendInfo:{}};function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0,n=t.meta,c=void 0===n?{}:n,s=t.payload;switch(t.type){case d.GET_TOOLS_QUESTION_INVITED_COUNT.success:return(0,i._)((0,o._)({},e),{tools:(0,i._)((0,o._)({},e.tools),{question:(0,i._)((0,o._)({},e.tools.question),{invitationCount:t.payload.data,isDrained:!0})})});case d.CLEAN_MCN_ORDER_LIST:return(0,i._)((0,o._)({},e),{mcn:(0,i._)((0,o._)({},e.mcn),{orderSource:void 0,orders:void 0})});case d.GET_MCN_ORDER_LIST.success:var u=t.payload,p=u.data,f=u.paging.totals,h=t.source,m=t.limit,g=t.offset,T=e.mcn.orderSource===h?e.mcn.orders:Array.from({length:f});return(0,i._)((0,o._)({},e),{mcn:(0,i._)((0,o._)({},e.mcn),{orderSource:h,orders:T.map(function(e,t){return t>=g&&t<g+m?p[t-g]:e})})});case d.GET_MCN_OVERDUE_GOODS_LIST.success:var E=t.payload,y=E.data,C=E.paging.totals,S=t.source,I=t.limit,A=t.offset,b=e.mcn.goodsListSource===S?e.mcn.goodsList:Array.from({length:C});return(0,i._)((0,o._)({},e),{mcn:(0,i._)((0,o._)({},e.mcn),{goodsListSource:S,goodsList:b.map(function(e,t){return t>=A&&t<A+I?y[t-A]:e})})});case d.GET_MCN_ORDER_DETAIL.success:var w=t.payload,Z=t.id;return(0,i._)((0,o._)({},e),{mcn:(0,i._)((0,o._)({},e.mcn),{orders:e.mcn.orders.map(function(e){return(null==e?void 0:e.id)&&String(e.id)===Z?(0,i._)((0,o._)({},e,w),{id:e.id,imgURL:e.imgURL}):e})})});case d.LOAD_TABLE.success:var x,k=c.stateKey,R=c.pagesKey,N=c.totalKey,O=c.dataKey,P=c.current,D=s.data,L=s.paging;return(0,i._)((0,o._)({},e),(0,r._)({},k,(0,l.qS)(null!==(x=e[k])&&void 0!==x?x:{},P,{data:null!=D?D:[],total:null==L?void 0:L.totals},{pagesKey:R,totalKey:N,dataKey:O})))}switch(t.type){case d.GET_CREATOR_TASKS.success:var M=t.payload;return(0,i._)((0,o._)({},e),{tasks:M});case d.LOAD_HOT_QUESTION_LIST.success:var B=t.payload;return(0,i._)((0,o._)({},e),{hotQuestionList:null==B?void 0:B.data});case d.LOAD_CREATOR_STATISTICS.success:return(0,i._)((0,o._)({},e),{creatorStatistics:t.payload});case d.GET_RECOMMEND_QUESTION_LIST.success:if(!s)return(0,o._)({},e);return(0,i._)((0,o._)({},e),{creatorsRecommendInfo:(0,i._)((0,o._)({},s),{showType:(0,a.camelize)(s.showType||"")})});case d.GET_RECOMMEND_QUESTION_LIST.failure:return(0,i._)((0,o._)({},e),{creatorsRecommendInfo:{showType:"data"}})}return e}},26267:function(e,t,n){"use strict";n.d(t,{Sy:function(){return u},Xd:function(){return s},ZP:function(){return l}});var r=n(55164),o=n(57477),i=n(4661),a={list:[]},c=(0,i.FH)("creatorRightStatus",["LOAD_CREATOR_RIGHT_STATUS"]);function s(){return{API:{types:c.LOAD_CREATOR_RIGHT_STATUS,endpoint:"/creators/rights/status"}}}var u=function(e){var t;return(null===(t=e.creatorRightStatus)||void 0===t?void 0:t.list)||a.list};function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1?arguments[1]:void 0;if(t.type===c.LOAD_CREATOR_RIGHT_STATUS.success){var n=t.payload;return(0,o._)((0,r._)({},e),{list:Array.isArray(null==n?void 0:n.data)?n.data:[]})}return e}},44893:function(e,t,n){"use strict";n.d(t,{UH:function(){return l},ZP:function(){return p}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(84054),s=n.n(c),u=n(4661),l=s()({data:[{question:{answer_count:!0,follower_count:!0,visit_count:!0,detail:!0,excerpt:!0,relationship:{is_following:!0},author:!0,created:!0}}]}),d=(0,o._)({},(0,u.FH)("creators",["GET_GOODAT_TOPIC_LIST","MODIFY_GOODAT_TOPIC","SEARCH_TOPIC","DELETE_TOOLS_QUESTION","GET_TOOLS_QUESTION_LIST","DELETE_TOOLS_QUESTION_INVITED","GET_TOOLS_QUESTION_INVITED_LIST"]));function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{goodatTopics:[]},t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload,s=t.meta;switch(n){case d.GET_GOODAT_TOPIC_LIST.success:return(0,i._)((0,o._)({},e),{goodatTopics:c.data.map(function(e){return(0,i._)((0,o._)({},e),{isGoodat:!0})}),isDrained:!0});case d.MODIFY_GOODAT_TOPIC.success:var u=s.goodatTopics;return(0,i._)((0,o._)({},e),{goodatTopics:u});case d.DELETE_TOOLS_QUESTION.success:var l=s.stateKey;return(0,i._)((0,o._)({},e),(0,r._)({},l,(0,i._)((0,o._)({},e[l]),{data:e[l].data.filter(function(e){return e.question.id!==t.meta.questionId})})));case d.GET_TOOLS_QUESTION_LIST.request:var p=s.stateKey;return(0,i._)((0,o._)({},e),(0,r._)({},p,(0,i._)((0,o._)({},e[p]),{isLoading:!0})));case d.GET_TOOLS_QUESTION_LIST.success:var f,h=s.stateKey;return(0,i._)((0,o._)({},e),(0,r._)({},h,(0,i._)((0,o._)((0,i._)((0,o._)({},e[h]),{isLoading:!1}),c),{data:(0,a._)((null===(f=e[h])||void 0===f?void 0:f.data)||[]).concat((0,a._)(c.data))})));case d.GET_TOOLS_QUESTION_LIST.failure:var _=s.stateKey;return(0,i._)((0,o._)({},e),(0,r._)({},_,(0,i._)((0,o._)({},e[_]),{isLoading:!1})))}return e}},40382:function(e,t,n){"use strict";n.d(t,{EtQ:function(){return L},Skx:function(){return X},ZPm:function(){return em},wKF:function(){return K},oEW:function(){return T},LOu:function(){return D},SfH:function(){return V},pPO:function(){return W},bGQ:function(){return O},sOG:function(){return E},XX4:function(){return m},iGT:function(){return P},J31:function(){return B},F07:function(){return M}});var r=n(55536),o=n(87320),i=n(55164),a=n(57477),c=n(4661),s=(0,i._)({},(0,c.FH)("creators",["LOAD_KM_RESOURCE"])),u=(0,i._)({},(0,c.FH)("creators",["ACCEPT_UNBIND","LAUNCH_UNBIND","LOAD_MCN_HOMEPAGE","REJECT_UNBIND","REJECT_MCN_INVITE","ACCEPT_MCN_INVITE"])),l=n(49899),d=n(74135),p=(0,i._)({},(0,c.FH)("creators",["UPDATE_CURRENT_PROMOTION","DELETE_CURRENT_PROMOTION","GET_CUSTOM_PROMOTION_STATUS","GET_PROMOTION_ITEM_LIST","GET_PROMOTION_ITEM"])),f=(0,i._)({},(0,c.FH)("creators",["GET_TOOLS_HOTSPOT_DOMAIN_LIST","GET_TOOLS_HOTSPOT_LIST"])),h=n(44893);n(85879),n(12506),n(92995);var _=(0,i._)({},(0,c.FH)("creators",["LOAD_ARTICLE_EXPOSURE_PROMOTION_LIST","LOAD_ARTICLE_EXPOSURE_PROMOTION_AMOUNT_BALANCE","LOAD_ARTICLE_EXPOSURE_PROMOTION_RECORD","CHECK_ARTICLE_EXPOSURE_PROMOTION_PERMISSION","START_ARTICLE_EXPOSURE_PROMOTION","LOAD_EXPOSURE_PROMOTION_AMOUNT_BALANCE","LOAD_EXPOSURE_PROMOTION_LIST","LOAD_EXPOSURE_PROMOTION_RECORD","CHECK_EXPOSURE_PROMOTION_PERMISSION","START_EXPOSURE_PROMOTION","GET_TOOLS_RECOMMEND_LIST","GET_TOOLS_RECOMMEND_LIST_AVAILABLE_TIMES","GET_TOOLS_RECOMMEND_TIMES_RECORD","POST_TOOLS_RECOMMEND","GET_TOOLS_RECOMMEND_RECORD"]));function m(e,t){return{API:{types:_.POST_TOOLS_RECOMMEND,endpoint:"/creators/recommendation/".concat(e),body:{url_token:t},method:"POST"}}}var g=(0,i._)({},(0,c.FH)("creators",["GET_ALGORITHM_RECOMMEND_LIST","GET_TOOLS_SEARCH_QUESTION_LIST","GET_HOT_EVENT","LOAD_HOUR_HOT_QUESTION"]));function T(e){return{API:{types:g.GET_ALGORITHM_RECOMMEND_LIST,endpoint:"creators/match/question/list",method:"GET",query:{article_token:e}}}}function E(e,t){return{API:{types:g.GET_TOOLS_SEARCH_QUESTION_LIST,endpoint:e,query:t}}}var y=(0,i._)({},(0,c.FH)("creators",["GET_CREATOR_SETTINGS","PATCH_CREATOR_SETTINGS_INFO","GET_ACCOUNT_BINDING","POST_ACCOUNT_BINDING_INFO","GET_VALIDATION_MSG","GET_ACCOUNT_BINDING_URL","SET_CANCEL_ACCOUNT_BINDING","GET_ACCOUNT_BINDING_SYNC","POST_ACCOUNT_BINDING_SYNC","GET_CONTENT_SYNC_PERMISSION","ACCOUNT_BINDING_AGGREMENT","GET_SCORE_CHANGE_LOG","GET_CREATOR_APPLY_INFO","GET_GROWTH_LEVEL","LOAD_CONTENT_SYNC_PERMISSION_V2"])),C=(0,i._)({},(0,c.FH)("creators",["LOAD_ACTIVITY_LIST"])),S=(0,i._)({},(0,c.FH)("creators",["LOAD_ANALYTICS_AGGREGATION","LOAD_ANALYTICS_AGGREGATION_V2","LOAD_ANALYTICS_DAILY_TOTAL_DETAIL","LOAD_ANALYTICS_DAILY_TOTAL_DETAIL_V2","LOAD_ANALYTICS_DAILY_SINGLE_DETAIL","LOAD_ANALYTICS_SINGLE_CONTENT_AGGREGATION","LOAD_ANALYTICS_SINGLE_CONTENT_DETAIL","LOAD_ANALYTICS_SINGLE_PIN_CONTENT_AGGREGATION","LOAD_ANALYTICS_SINGLE_PIN_CONTENT_DETAIL","LOAD_ANALYTICS_VISTER_PORTRAIT","LOAD_ANALYTICS_SINGLE_VISTER_PORTRAIT","LOAD_ANALYTICS_FOLLOW_PROFILE"]));n(3560);var I=(0,i._)({},(0,c.FH)("creators",["LOAD_ANNOUNCEMENT_LIST","LOAD_ANNOUNCEMENT"])),A=(0,i._)({},(0,c.FH)("creators",["LOAD_BAYES_DOMAINS_STATUES","SAVE_POPUP_HAS_SHOWN","LOAD_BAYES_DOMAINS_OPYTIONAL","UPDATE_SELECTED_DOMAINS","LOAD_CONTENTS"])),b={status:{},options:{topDomains:null,allDomains:null,editable:0},contents:null},w=n(18837),Z=n.n(w),x=n(4667),k=n.n(x),R=n(80523),N=(0,i._)({},(0,c.FH)("creators",["GET_CREATOR_APPLY_STATUS","READ_NOTIFICATION","GET_CREATOR_RIGHTS_STATUS"]));function O(){return function(e,t,n){var r=n.fnRefs;return(0,R.Z)(r,"loadCreatorApplyStatus",function(){return k()(function(){return e({API:{types:N.GET_CREATOR_APPLY_STATUS,endpoint:"/creator/apply"}})})})()}}function P(e){return{API:{types:N.READ_NOTIFICATION,endpoint:"/creator/notification/read",method:"PATCH",body:{type:e}},meta:{type:e}}}function D(e){return function(t,n,r){var o=r.fnRefs;return(0,R.Z)(o,"getCreatorRightsStatus",function(){return Z()(function(e){return t({meta:{rightsId:e},API:{types:N.GET_CREATOR_RIGHTS_STATUS,endpoint:"/creator/rights/".concat(e,"/switch")}})})})(e)}}var L=function(e){return e.creators.common.applyStatus},M=function(e){return e.creators.common.guide};function B(e,t){var n;return null===(n=e.creators.common.rightsStatus[t])||void 0===n?void 0:n.isPass}n(84054);var U=n(80714),G=n(67516),F=n.n(G),H="VIDEO_CLIP",z={videoSucccess:1,videoEdit:2,pinPublish:3,pinSuccess:4},q=(0,i._)({},(0,c.FH)("creators",["LOAD_CREATION_LIST","LOAD_CREATION","GET_DRAFT_COUNT","GET_DRAFTS","GET_DRAFT_DETAIL","LOAD_ANALYSIS_STATUS","CANCEL_CREATION_RELATION","DELETE_ANSWER","CHECK_ARTICLE_PUBLISH"]),(0,c.co)("creator",["UPDATE_EDIT_MODAL_STATUS"]));function V(e){var t;return"answer"===e&&(t="/answer-drafts/count"),"article"===e&&(t="/articles/my_drafts/count"),"zvideo"===e&&(t="/zvideos/drafts"),"pin"===e&&(t="/content/drafts/count?action=pin"),{meta:{contentType:e},API:{types:q.GET_DRAFT_COUNT,endpoint:t}}}function W(e){return{API:{root:U.Z.fetchRoot.api,types:q.GET_DRAFT_DETAIL,endpoint:"/content/drafts/".concat(e,"?action=pin")}}}function X(e,t){var n={article_token:e};return t&&(n.question_token=t),{API:{types:q.CHECK_ARTICLE_PUBLISH,endpoint:"creators/article_publish/check/question",method:"POST",body:n}}}var K=function(e){return e.creators.creationManage.draftCount},j=(0,i._)({},(0,c.FH)("creators",["GET_EDITOR_SETTING","UPDATE_EDITOR_SETTING"])),Y=(0,i._)({},(0,c.FH)("creators",["GET_ACADEMY_TABS","GET_ACADEMY_ARTICLES"])),Q={tabs:[],article:{}},J=n(71728);n(74351);var $=n(31824),ee=n(33722),et=n(7407),en=(0,$.P1)(function(e){return e.creators.home.newRights},et.Xj,function(e,t){return e.map(function(e){var n=Object.values(ee.Zy).find(function(t){return t.id===e.id});return!n||(null==n?void 0:n.officeOnly)&&!t?null:(0,i._)({},n,e)}).filter(Boolean)});(0,$.P1)(en,function(e){return e.filter(function(e){return e.needShow})});var er=(0,i._)({},(0,c.FH)("creators",["GET_HOME_DATA","APPLY_CREATOR_RIGHTS","GET_CREATOR_NEW_RIGHTS","GET_CREATOR_DIGITAL_ASSISTANT_RIGHTS","LOAD_BVIP_RECOMMEND_MENU_SHOULD_SHOW","LOAD_CREATION_RELATIONSHIP_MENU_SHOULD_SHOW","LOAD_CREATOR_SCORE_INFO","GET_NEW_RIGHTS_IS_ACTIVE","LOAD_BANNER_LIST","GET_LEVEL_UP_WINDOW_SHOW","UPGRADE_WINDOW_DONE","LOAD_RECOMMENDED_FOLLOW_LIST","LOAD_NEW_TASK_HOME_CARD","LOAD_CREATION_INSPIRATION"]),(0,c.co)("creators",["SET_CURRENT_CREATOR","CLEAN_GRADE_INFO"])),eo=(0,i._)({},(0,c.FH)("creators",["LOAD_AGGREGATION_CARD_DATA","LOAD_TABLE_DATA"]));n(23391);var ei=(0,i._)({},(0,c.FH)("creators",["GET_TEXT_INCOME_INFO","GET_TEXT_INCOME","GET_TEXT_INCOME_APPLY_INFO","TEXT_INCOME_APPLY","GET_INCOME_AUTHORIZE","GET_DOMAIN_LIST"]),(0,c.co)("creators",["SWITCH_DOMAIN_MODAL"])),ea=(0,i._)({},(0,c.FH)("creators",["GET_KNOWLEDGE_TASK_INFO","GET_KNOWLEDGE_TASK_DETAIL","GET_KNOWLEDGE_BENEFIT","GET_KNOWLEDGE_QUESTIONS","GET_CLOSED_TASKS","GET_RUNNING_TASKS","RECEIVE_TASK"])),ec=(0,i._)({},(0,c.FH)("profilePoster",["LOAD_CREATOR_POSTER_CONFIG"])),es={creatorPosterConfig:{},creatorPosterData:{}},eu=(0,i._)({},(0,c.FH)("creators",["GET_USER_STATUS","OPEN_SAFEGUARD_RIGHTS","CONFIRM_SAFEGUARD_RIGHTS","POST_PROTECT_CONTENT","GET_PROTECT_INFRINGEMENT","GET_PROTECT_CONTENT","POST_INFRINGEMENT","INGORE_INFRINGEMENT","POST_INFRINGEMENT_MATERIAL","GET_PROTECT_STATISTIC","GET_PROTECT_CONTENT_DETAIL","GET_PROTECT_WHITE","POST_PROTECT_WHITE","UPDATE_PROTECT_WHITE","GET_SAFEGUARD_RIGHTS_SKU"])),el=n(76931),ed=n.n(el),ep=(0,i._)({},(0,c.FH)("creators",["LOAD_CREATOR_SCHOOL_KM_DATA","LOAD_CREATOR_SCHOOL_CONTENT_DETAIL","LOAD_MY_RECENTLY_STUDING","LOG_STUDING"])),ef={tabs:[],contents:[],banner:null,entities:{}},eh=(0,i._)({},(0,c.FH)("creators",["LOAD_USER_INFO","LOAD_GRADUATE_INFO"]));(0,i._)({},(0,c.FH)("creators",["LOAD_VIDEO_DISTRIBUTION_LIST","LOAD_VIDEO_DISTRIBUTION_MAPS","VIDEO_DISTRIBUTION_AUTH","VIDEO_DISTRIBUTION_ANSWER_DELETE","LOAD_VIDEO_DISTRIBUTION_RESOURCE"])),n(57266);var e_=(0,i._)({},(0,c.FH)("creators",["GET_VIDEO_SUPPORT_BASE_STATISTICS","GET_TEXT_SUPPORT_BASE_STATISTICS","GET_VIDEO_SUPPORT_CONTENT_STATISTICS","GET_TEXT_SUPPORT_CONTENT_STATISTICS","GET_VIDEO_SUPPORT_BANNER","GET_VIDEO_SUPPORT_DAILY_STATISTICS","GET_VIDEO_SUPPORT_USER_SHOW_STATUS","GET_VIDEO_SUPPORT_USER_STATUS","APPLY_VIDEO_SUPPORT"])),em=(0,r.combineReducers)({common:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{applyStatus:{},rightsStatus:{}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,c=t.meta;switch(n){case N.GET_CREATOR_APPLY_STATUS.success:return(0,a._)((0,i._)({},e),{applyStatus:(0,i._)({},r)});case N.GET_CREATOR_APPLY_STATUS.failure:if(t.err&&403===t.err.status)return(0,a._)((0,i._)({},e),{guide:!0});break;case N.READ_NOTIFICATION.success:return(0,a._)((0,i._)({},e),{applyStatus:(0,a._)((0,i._)({},e.applyStatus),{notification:(0,a._)((0,i._)({},e.applyStatus.notification),(0,o._)({},(0,d.camelize)(t.meta.type),0))})});case N.GET_CREATOR_RIGHTS_STATUS.success:return(0,a._)((0,i._)({},e),{rightsStatus:(0,a._)((0,i._)({},e.rightsStatus),(0,o._)({},c.rightsId,r))})}return e},bayesDomains:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,n=arguments.length>1?arguments[1]:void 0,r=n.payload;return n.type===A.LOAD_BAYES_DOMAINS_STATUES.success?(0,a._)((0,i._)({},t),{status:r}):n.type===A.LOAD_BAYES_DOMAINS_OPYTIONAL.success?(0,a._)((0,i._)({},t),{options:r}):n.type===A.LOAD_CONTENTS.success?(0,a._)((0,i._)({},t),{contents:{data:(0,l._)((null===(e=t.contents)||void 0===e?void 0:e.data)||[]).concat((0,l._)(r.data)),paging:r.paging}}):t},school:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ef,t=arguments.length>1?arguments[1]:void 0,n=t.meta,r=t.payload;switch(t.type){case ep.LOAD_CREATOR_SCHOOL_KM_DATA.success:var c=(void 0===n?{}:n).stateKey;return(0,a._)((0,i._)({},e),(0,o._)({},c,ed()(r,{tabs:"data.tabs",contents:"data.tabContents",banner:"data.banners"}[c])));case ep.LOAD_CREATOR_SCHOOL_CONTENT_DETAIL.success:var s=r.data.filter(Boolean).reduce(function(e,t){return(0,a._)((0,i._)({},e),(0,o._)({},t.id,t))},{});return(0,a._)((0,i._)({},e),{entities:(0,i._)({},e.entities,s)})}return e},faq:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Y.GET_ACADEMY_TABS.success:var n=t.payload.data;return(0,a._)((0,i._)({},e),{isDrained:!0,tabs:n.tabs});case Y.GET_ACADEMY_ARTICLES.success:var r=t.payload.data;return(0,a._)((0,i._)({},e),{article:r.contents.reduce(function(e,t){return(0,a._)((0,i._)({},e),(0,o._)({},t.id,t))},e.article)})}return e},knowledgeIncome:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,o=t.meta;switch(n){case ei.SWITCH_DOMAIN_MODAL:return(0,a._)((0,i._)({},e),{domainModalStatus:o});case ei.GET_TEXT_INCOME_INFO.success:return(0,a._)((0,i._)({},e),{textIncomeInfo:r});case ei.GET_TEXT_INCOME_INFO.failure:return(0,a._)((0,i._)({},e),{textIncomeInfo:{error:!0}});case ei.GET_TEXT_INCOME.success:return(0,a._)((0,i._)({},e),{textIncomeAmount:r});case ei.GET_INCOME_AUTHORIZE.success:return(0,a._)((0,i._)({},e),{tabAuthorize:r});case ei.GET_INCOME_AUTHORIZE.failure:return(0,a._)((0,i._)({},e),{tabAuthorize:{error:!0}});case ei.GET_TEXT_INCOME_APPLY_INFO.success:return(0,a._)((0,i._)({},e),{textIncomeApplyInfo:r});case ei.GET_TEXT_INCOME_APPLY_INFO.failure:return(0,a._)((0,i._)({},e),{textIncomeApplyInfo:{error:!0}})}return e},safeguardRights:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case eu.GET_USER_STATUS.success:return(0,a._)((0,i._)({},e),{userStatus:r});case eu.GET_PROTECT_STATISTIC.success:return(0,a._)((0,i._)({},e),{protectStatistic:r});case eu.GET_PROTECT_CONTENT_DETAIL.success:return(0,a._)((0,i._)({},e),{protectContentDetail:r});case eu.GET_PROTECT_WHITE.success:return(0,a._)((0,i._)({},e),{protectWhiteList:r});case eu.GET_SAFEGUARD_RIGHTS_SKU.success:return(0,a._)((0,i._)({},e),{skuData:r})}return e},analytics:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{all:{},answer:{},zvideo:{},article:{},pin:{},singleContent:{}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,c=t.meta;switch(n){case S.LOAD_ANALYTICS_AGGREGATION.success:var s=c.stateKey;return(0,a._)((0,i._)({},e),(0,o._)({},s,(0,a._)((0,i._)({},e[s]),{aggregation:r})));case S.LOAD_ANALYTICS_FOLLOW_PROFILE.success:return(0,a._)((0,i._)({},e),{followProfile:r});case S.LOAD_ANALYTICS_AGGREGATION_V2.success:var u=c.stateKey;return(0,a._)((0,i._)({},e),(0,o._)({},u,(0,a._)((0,i._)({},e[u]),{aggregationV2:r})));case S.LOAD_ANALYTICS_DAILY_TOTAL_DETAIL.success:var l=c.stateKey;return(0,a._)((0,i._)({},e),(0,o._)({},l,(0,a._)((0,i._)({},e[l]),{totalDetail:r})));case S.LOAD_ANALYTICS_DAILY_TOTAL_DETAIL_V2.success:var d=c.stateKey;return(0,a._)((0,i._)({},e),(0,o._)({},d,(0,a._)((0,i._)({},e[d]),{totalDetailV2:r})));case S.LOAD_ANALYTICS_DAILY_SINGLE_DETAIL.success:var p=c.stateKey;return(0,a._)((0,i._)({},e),(0,o._)({},p,(0,a._)((0,i._)({},e[p]),{singleDetail:r})));case S.LOAD_ANALYTICS_SINGLE_CONTENT_AGGREGATION.success:case S.LOAD_ANALYTICS_SINGLE_PIN_CONTENT_AGGREGATION.success:var f=c.stateKey;return(0,a._)((0,i._)({},e),{singleContent:(0,a._)((0,i._)({},e.singleContent),(0,o._)({},f,(0,a._)((0,i._)({},e.singleContent[f]),{aggregation:r})))});case S.LOAD_ANALYTICS_VISTER_PORTRAIT.success:var h=c.stateKey;return(0,a._)((0,i._)({},e),(0,o._)({},h,(0,a._)((0,i._)({},e[h]),{visterPortrait:r})));case S.LOAD_ANALYTICS_SINGLE_VISTER_PORTRAIT.success:var _=c.stateKey;return(0,a._)((0,i._)({},e),(0,o._)({},_,(0,a._)((0,i._)({},e[_]),{singleVisterPortrait:r})));case S.LOAD_ANALYTICS_SINGLE_CONTENT_DETAIL.success:case S.LOAD_ANALYTICS_SINGLE_PIN_CONTENT_DETAIL.success:var m=c.stateKey;return(0,a._)((0,i._)({},e),{singleContent:(0,a._)((0,i._)({},e.singleContent),(0,o._)({},m,(0,a._)((0,i._)({},e.singleContent[m]),{detail:r})))})}return e},account:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{growthLevel:{}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case y.GET_CREATOR_SETTINGS.success:return(0,a._)((0,i._)({},e),{settings:r.data});case y.PATCH_CREATOR_SETTINGS_INFO.success:return(0,a._)((0,i._)({},e),{settings:(0,i._)({},e.settings,t.data)});case y.GET_ACCOUNT_BINDING.success:return(0,a._)((0,i._)({},e),{accountBinding:r});case y.GET_VALIDATION_MSG.success:return(0,a._)((0,i._)({},e),{validationMsg:r});case y.GET_ACCOUNT_BINDING_SYNC.success:return(0,a._)((0,i._)({},e),{accountBindingSync:r});case y.GET_CREATOR_APPLY_INFO.success:return(0,a._)((0,i._)({},e),{applyConfigInfo:t.payload});case y.GET_GROWTH_LEVEL.success:var o=t.payload;return(0,a._)((0,i._)({},e),{growthLevel:(0,i._)({},e.growthLevel,o)})}return e},KMResource:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.meta;if(t.type===s.LOAD_KM_RESOURCE.success&&n.data){var c=r.stateKey;return(0,a._)((0,i._)({},e),(0,o._)({},c,n.data))}return e},training:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===eh.LOAD_USER_INFO.success?(0,a._)((0,i._)({},e),{userInfo:t.payload}):t.type===eh.LOAD_GRADUATE_INFO.success?(0,a._)((0,i._)({},e),{graduate:t.payload}):e},ToolsQuestion:h.ZP,ToolsHotspot:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{domains:[]},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,c=t.meta;switch(n){case f.GET_TOOLS_HOTSPOT_DOMAIN_LIST.success:return(0,a._)((0,i._)({},e),{domains:r.domains});case f.GET_TOOLS_HOTSPOT_LIST.success:return(0,a._)((0,i._)({},e),(0,o._)({},c.stateKey,r))}return e},ToolsRecommend:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e},ToolsCustomPromotion:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{itemLists:{},baseInfo:{}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case p.GET_CUSTOM_PROMOTION_STATUS.success:return(0,a._)((0,i._)({},e),{baseInfo:r});case p.GET_PROMOTION_ITEM_LIST.success:var c=t.itemType,s=t.offset,u=t.limit,d=t.payload,f=d.data,h=d.count,_=e.itemLists[c]||{count:h,data:Array.from({length:h},function(){return null})},m=(0,a._)((0,i._)({},_),{data:(0,l._)(_.data.slice(0,s)).concat((0,l._)(f),(0,l._)(_.data.slice(s+u)))});return(0,a._)((0,i._)({},e),{itemLists:(0,a._)((0,i._)({},e.itemLists),(0,o._)({},c,m))})}return e},ToolsSearchQuestion:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case g.GET_HOT_EVENT.success:return(0,a._)((0,i._)({},e),{hotEventsList:null==r?void 0:r.data});case g.LOAD_HOUR_HOT_QUESTION.success:return(0,a._)((0,i._)({},e),{hotHourQuestionList:null==r?void 0:r.data})}return e},editorSetting:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===j.GET_EDITOR_SETTING.success?(0,a._)((0,i._)({},e),{baseInfo:r}):e},MCNManage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===u.LOAD_MCN_HOMEPAGE.success?(0,a._)((0,i._)({},e),{mcnInfo:r}):e},knowledgeTasks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case ea.GET_KNOWLEDGE_TASK_INFO.success:return(0,a._)((0,i._)({},e),{knowledgeTaskInfo:null==r?void 0:r.data});case ea.GET_KNOWLEDGE_TASK_INFO.failure:return(0,a._)((0,i._)({},e),{knowledgeTaskInfo:{error:!0}});case ea.GET_KNOWLEDGE_TASK_DETAIL.success:return(0,a._)((0,i._)({},e),{knowledgeTaskDetail:null==r?void 0:r.data});case ea.GET_KNOWLEDGE_TASK_DETAIL.failure:return(0,a._)((0,i._)({},e),{knowledgeTaskDetail:{error:!0}});case ea.GET_KNOWLEDGE_BENEFIT.success:return(0,a._)((0,i._)({},e),{knowledgeBenefit:r});case ea.GET_KNOWLEDGE_BENEFIT.failure:return(0,a._)((0,i._)({},e),{knowledgeBenefit:{error:!0}})}return e},incomeAnalysis:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{income:{aggregation:{}}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===eo.LOAD_AGGREGATION_CARD_DATA.success?(0,a._)((0,i._)({},e),{income:(0,a._)((0,i._)({},e.income),{aggregation:r})}):e},creationManage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{editModal:{status:!1,type:z.videoSuccess}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case q.UPDATE_EDIT_MODAL_STATUS:var n=function(){var e=F().get(H,"edit");if(!e)return null;var t=e.sourceId,n=e.timestamp;return(F().delete(H),Date.now()-n>3e5)?null:t}(),r=t.payload||{},c=r.status,s=r.zvideoId,u=n||s,l=z.videoSucccess,d=z.videoEdit;if(c&&u)return(0,a._)((0,i._)({},e),{editModal:{status:c,type:n?l:d,sourceId:u}});return(0,a._)((0,i._)({},e),{editModal:(0,a._)((0,i._)({},e.editModal),{status:!1})});case q.GET_DRAFT_COUNT.success:var p,f,h,_,m,g=t.meta.contentType;if("zvideo"===g)return(0,a._)((0,i._)({},e),{draftCount:(0,a._)((0,i._)({},e.draftCount),(0,o._)({},g,null===(f=t.payload)||void 0===f?void 0:null===(h=f.paging)||void 0===h?void 0:h.totals))});if("pin"===g)return(0,a._)((0,i._)({},e),{draftCount:(0,a._)((0,i._)({},e.draftCount),(0,o._)({},g,null===(_=t.payload)||void 0===_?void 0:null===(m=_.data)||void 0===m?void 0:m.count))});return(0,a._)((0,i._)({},e),{draftCount:(0,a._)((0,i._)({},e.draftCount),(0,o._)({},g,null===(p=t.payload)||void 0===p?void 0:p.count))});case q.LOAD_ANALYSIS_STATUS.success:return(0,a._)((0,i._)({},e),{analysisStatus:t.payload})}return e},activity:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,c=t.meta;if(n===C.LOAD_ACTIVITY_LIST.success){var s,u=c.groupToken;return(0,a._)((0,i._)({},e),(0,o._)({},u,(0,a._)((0,i._)({},e[u],r),{data:(0,l._)((null===(s=e[u])||void 0===s?void 0:s.data)||[]).concat((0,l._)(r.data||[])),page:(0,a._)((0,i._)({},r.page),{isLoading:!1})})))}return e},announcement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,c=t.meta;if(n===I.LOAD_ANNOUNCEMENT_LIST.success){var s,u=c.stateKey,l=c.offset;return(0,a._)((0,i._)({},e),(0,o._)({},u,(0,a._)((0,i._)({},r),{data:(0,a._)((0,i._)({},null===(s=e[u])||void 0===s?void 0:s.data),(0,o._)({},l,r.data))})))}return e},home:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{currentCreatorUrlToken:null,rights:[],newRights:[],scoreInfo:{},menusShowControlByServer:{bVipRecomend:!1,creationRelationship:!1},newTasks:{creatorTask:{tasks:[],des:[]}},bannerList:[],recentlyCreated:[],homecard:{},homeData:{},creationInspiration:{creationInspirationV2:null,creationStatistics:null,checkinActivity:null}},o=arguments.length>1?arguments[1]:void 0,c=o.type,s=o.payload;switch(c){case er.GET_HOME_DATA.success:return(0,a._)((0,i._)({},r),{homeData:(0,i._)({},r.homeData,s)});case er.GET_HOME_DATA.failure:return(0,a._)((0,i._)({},r),{isHomepageForbidden:(null===(e=o.err)||void 0===e?void 0:null===(t=e.payload)||void 0===t?void 0:t.code)==="403"});case er.LOAD_NEW_TASK_HOME_CARD.success:return(0,a._)((0,i._)({},r),{homecard:s});case er.LOAD_NEW_TASK_HOME_CARD.failure:return(0,a._)((0,i._)({},r),{homecard:{error:!0}});case er.APPLY_CREATOR_RIGHTS.success:var u=o.meta,l=u.rightsId,d=u.isExperience,p=o.payload;return(0,a._)((0,i._)({},r),{newRights:r.newRights.map(function(e){return(0,a._)((0,i._)({},e),{status:e.id===l?p.status:e.status})}),rights:r.rights.map(function(e){return(0,a._)((0,i._)({},e),{status:e.id===l?d?"experience":p.status:e.status})})});case er.GET_CREATOR_NEW_RIGHTS.success:var f=o.payload.rights;return(0,a._)((0,i._)({},r),{newRights:void 0===f?[]:f});case er.GET_CREATOR_DIGITAL_ASSISTANT_RIGHTS.request:return(0,a._)((0,i._)({},r),{digitalAssistantRight:Object.assign({isLoading:!0},r.digitalAssistantRight)});case er.GET_CREATOR_DIGITAL_ASSISTANT_RIGHTS.success:var h=o.payload;return(0,a._)((0,i._)({},r),{digitalAssistantRight:Object.assign({isLoading:!1},h.data)});case er.GET_CREATOR_DIGITAL_ASSISTANT_RIGHTS.failure:return(0,a._)((0,i._)({},r),{digitalAssistantRight:Object.assign({isLoading:!1},r.digitalAssistantRight)});case er.LOAD_BVIP_RECOMMEND_MENU_SHOULD_SHOW.success:return(0,a._)((0,i._)({},r),{menusShowControlByServer:(0,a._)((0,i._)({},r.menusShowControlByServer),{bVipRecomend:s.data})});case er.LOAD_CREATION_RELATIONSHIP_MENU_SHOULD_SHOW.success:return(0,a._)((0,i._)({},r),{menusShowControlByServer:(0,a._)((0,i._)({},r.menusShowControlByServer),{creationRelationship:s.canRef})});case er.LOAD_CREATOR_SCORE_INFO.success:var _=o.payload;return(0,a._)((0,i._)({},r),{scoreInfo:_});case er.SET_CURRENT_CREATOR:return(0,a._)((0,i._)({},r),{currentCreatorUrlToken:s});case er.LOAD_BANNER_LIST.success:return(0,a._)((0,i._)({},r),{bannerList:(null==s?void 0:null===(n=s.data)||void 0===n?void 0:n.bannerList)||[]});case er.GET_LEVEL_UP_WINDOW_SHOW.success:return(0,a._)((0,i._)({},r),{upgradeInfo:s});case er.CLEAN_GRADE_INFO:return(0,a._)((0,i._)({},r),{upgradeInfo:(0,a._)((0,i._)({},r.upgradeInfo),{needPop:!1})});case er.LOAD_CREATION_INSPIRATION.success:var m=s.list,g=void 0===m?[]:m,T=(0,J._)(s,["list"]),E=(0,a._)((0,i._)({},T),{list:g});return g.forEach(function(e){"creation_inspiration_v2"===e.token?E.creationInspirationV2=e.data:"creation_statistics"===e.token?E.creationStatistics=e.data:("checkin_activity_intro"===e.token||"checkin_activity_progress"===e.token)&&(E.checkinActivity=e)}),(0,a._)((0,i._)({},r),{creationInspiration:E});case er.LOAD_CREATION_INSPIRATION.failure:return(0,a._)((0,i._)({},r),{creationInspiration:{error:!0}})}return r},videoSupport:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{textBenefit:{}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case e_.GET_VIDEO_SUPPORT_BASE_STATISTICS.success:return(0,a._)((0,i._)({},e),{base:r});case e_.GET_VIDEO_SUPPORT_BASE_STATISTICS.failure:return(0,a._)((0,i._)({},e),{base:{error:!0}});case e_.GET_TEXT_SUPPORT_BASE_STATISTICS.success:return(0,a._)((0,i._)({},e),{textBenefit:(0,a._)((0,i._)({},e.textBenefit),{base:r})});case e_.GET_TEXT_SUPPORT_BASE_STATISTICS.failure:return(0,a._)((0,i._)({},e),{textBenefit:(0,a._)((0,i._)({},e.textBenefit),{base:{error:!0}})});case e_.GET_VIDEO_SUPPORT_CONTENT_STATISTICS.success:return(0,a._)((0,i._)({},e),{content:r});case e_.GET_VIDEO_SUPPORT_CONTENT_STATISTICS.failure:return(0,a._)((0,i._)({},e),{content:{error:!0}});case e_.GET_TEXT_SUPPORT_CONTENT_STATISTICS.success:return(0,a._)((0,i._)({},e),{textBenefit:(0,a._)((0,i._)({},e.textBenefit),{content:r})});case e_.GET_TEXT_SUPPORT_CONTENT_STATISTICS.failure:return(0,a._)((0,i._)({},e),{textBenefit:(0,a._)((0,i._)({},e.textBenefit),{content:{error:!0}})});case e_.GET_VIDEO_SUPPORT_BANNER.success:return(0,a._)((0,i._)({},e),{banner:r});case e_.GET_VIDEO_SUPPORT_DAILY_STATISTICS.success:return(0,a._)((0,i._)({},e),{daily:r});case e_.GET_VIDEO_SUPPORT_DAILY_STATISTICS.failure:return(0,a._)((0,i._)({},e),{daily:{error:!0}});case e_.GET_VIDEO_SUPPORT_USER_SHOW_STATUS.success:return(0,a._)((0,i._)({},e),{userShowStatus:r});case e_.GET_VIDEO_SUPPORT_USER_SHOW_STATUS.failure:return(0,a._)((0,i._)({},e),{userShowStatus:{error:!0}});case e_.GET_VIDEO_SUPPORT_USER_STATUS.success:return(0,a._)((0,i._)({},e),{userStatus:r});case e_.GET_VIDEO_SUPPORT_USER_STATUS.failure:return(0,a._)((0,i._)({},e),{userStatus:{error:!0}})}return e},videoDistribution:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e},profilePoster:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:es,t=arguments.length>1?arguments[1]:void 0,n=t.payload;if(t.type===ec.LOAD_CREATOR_POSTER_CONFIG.success&&(null==n?void 0:n.data)){var r=JSON.parse(n.data),o=r.config,c=r.data;return(0,a._)((0,i._)({},e),{creatorPosterConfig:o,creatorPosterData:c})}return e}})},51921:function(e,t,n){"use strict";n.d(t,{Hp:function(){return p},Pq:function(){return _},sF:function(){return h}});var r=n(55164),o=n(49899),i=n(74135),a=n(46942),c=n.n(a),s=n(93292),u=n(80523),l=n(4661),d=n(59523),p=(0,r._)({},(0,l.FH)("currentUser",["GET","GET_COLUMN_CONTRIBUTIONS","UPDATE_FULLNAME","GET_REAL_NAME_STATUS"]),(0,l.co)("currentUser",["ACTIVE_USER"])),f=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n,a){var l=a.fnRefs;return(0,u.Z)(l,"fetchCurrentUser",function(){return(0,s.Z)(function(t){var n;return e((n=t.map(function(e){return e[0]}).flat(),{API:(0,r._)({types:p.GET,endpoint:"me"},n&&{query:{include:c()(n.map(i.decamelize)).join(",")}})}))},queueMicrotask)}).apply(void 0,(0,o._)(t))}};function h(e){return function(t,n){var r=(0,d.ib)(n());if(r){var o=e.filter(function(e){return!(e in r)});if(o.length)return t(f(o))}}}var _=function(e){return function(t,n){var r=n().currentUser;return t({API:{types:p.GET_COLUMN_CONTRIBUTIONS,endpoint:"/members/".concat(e||r,"/column-contributions"),method:"GET",query:{offset:0,limit:50,include:"data[*].column.articles_count,voteup_count"},fetchOptions:{credentials:"include"}}})}}},58909:function(e,t,n){"use strict";n.d(t,{Hp:function(){return o.Hp},ib:function(){return c.ib},wY:function(){return c.wY},ZP:function(){return s},sF:function(){return o.sF},Pq:function(){return o.Pq},sb:function(){return c.sb},dd:function(){return c.dd},W5:function(){return c.W5},pG:function(){return c.pG},cE:function(){return c.cE},me:function(){return a},xw:function(){return c.xw}});var r=n(55536),o=n(51921),i=n(98424),a=(0,r.combineReducers)({columnContributions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===o.Hp.GET_COLUMN_CONTRIBUTIONS.success?t.payload.data.map(function(e){return e.column}):e}}),c=n(59523),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.Hp.GET.success:return t.payload.urlToken;case i.Hp.UPDATE_AUTHINFO:return t.token||"";default:return e}}},59523:function(e,t,n){"use strict";n.d(t,{W5:function(){return s},cE:function(){return u},dd:function(){return f},ib:function(){return c},pG:function(){return d},sb:function(){return l},wY:function(){return a},xw:function(){return p}});var r=n(92258),o=n(31824),i=n(66263),a=function(e){return e.currentUser},c=(0,o.P1)(function(e){var t;return null===(t=e.entities)||void 0===t?void 0:t.users},a,function(e,t){if(t){if(e[t])return e[t];var n=Object.keys(e).find(function(n){return e[n].id===t});return n?e[n]:void 0}}),s=(0,o.P1)(c,function(e){return!!e&&"organization"===e.userType}),u=(0,o.P1)(c,function(e){var t;return null==e?void 0:null===(t=e.vipInfo)||void 0===t?void 0:t.isVip}),l=(0,o.P1)(c,function(e){var t;return null==e?void 0:null===(t=e.kvipInfo)||void 0===t?void 0:t.isVip});(0,o.P1)(c,function(e){var t;return null==e?void 0:null===(t=e.vipInfo)||void 0===t?void 0:t.renameAwaitDays}),(0,o.P1)(c,function(e){var t;return null==e?void 0:null===(t=e.vipInfo)||void 0===t?void 0:t.renameFrequency});var d=(0,o.P1)([c,function(e,t){return t}],function(e,t){return!!(e&&t&&e.id===t.id)}),p=function(e){return(0,r.useSelector)(function(t){return d(t,e)})};(0,o.P1)(c,function(e){var t;return[i.of.NO_SETTING,i.of.PASS].includes(null==e?void 0:null===(t=e.mcnUserInfo)||void 0===t?void 0:t.status)}),(0,o.P1)(c,function(e){var t;return(null==e?void 0:null===(t=e.mcnUserInfo)||void 0===t?void 0:t.availableSource)||[]});var f=(0,o.P1)(c,function(e){return!!(null==e?void 0:e.userType)&&"guest"!==e.userType})},74065:function(e,t,n){"use strict";n.d(t,{ZP:function(){return g},eJ:function(){return p},s1:function(){return d},mc:function(){return h},CU:function(){return f}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(55536),s=n(74135),u=n(4661),l=(0,o._)({},(0,u.FH)("draftHistory",["GET_HISTORY","GET_DRAFT","REVERT"]),(0,u.co)("draftHistory",["RESET"]));function d(e,t){return function(n,r){var o=r().draftHistory.history["".concat(e,"_").concat(t)];return n({meta:{type:e,id:t},API:{types:l.GET_HISTORY,endpoint:o&&o.next?o.next:"draft-histories",query:{objectType:e,objectId:t}}})}}function p(e,t){return{meta:{versionType:e,versionId:t},API:{types:l.GET_DRAFT,endpoint:"draft-history",query:{versionType:e,id:t}}}}function f(e,t){return{meta:{versionType:e,versionId:t},API:{types:l.REVERT,method:"POST",endpoint:"draft-history/revert",body:(0,s.decamelizeKeys)({versionType:e,id:t})}}}function h(e,t){return{type:l.RESET,meta:{type:e,id:t}}}function _(e){return"".concat(e.meta.type,"_").concat(e.meta.id)}function m(e){return"".concat(e.meta.versionType,"_").concat(e.meta.versionId)}var g=(0,c.combineReducers)({history:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l.GET_HISTORY.request:var n=_(t);return(0,r._)({},n,{items:e[n]?e[n].items:null,next:e[n]?e[n].next:null,isFetching:!0,isDrained:!1});case l.GET_HISTORY.success:var o=_(t);return(0,r._)({},o,{items:e[o]&&e[o].items?(0,a._)(e[o].items).concat((0,a._)(t.payload.data)):t.payload.data,next:t.payload.paging.next,isFetching:!1,isDrained:t.payload.paging.isEnd});case l.GET_HISTORY.failure:var i=_(t);return(0,r._)({},i,{items:e[i]?e[i].items:null,next:e[i]?e[i].next:null,isFetching:!1,isDrained:!0});case l.RESET:return{};default:return e}},drafts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l.GET_DRAFT.request:var n=m(t);return(0,i._)((0,o._)({},e),(0,r._)({},n,{data:null,isFetching:!0}));case l.GET_DRAFT.success:var a=m(t);return(0,i._)((0,o._)({},e),(0,r._)({},a,{data:t.payload,isFetching:!1}));case l.GET_DRAFT.failure:var c=m(t);return(0,i._)((0,o._)({},e),(0,r._)({},c,{data:null,isFetching:!1}));case l.RESET:return{};default:return e}}})},62039:function(e,t,n){"use strict";n.d(t,{Jb:function(){return f},P0:function(){return l},XO:function(){return p},ZP:function(){return h},aV:function(){return d}});var r=n(87320),o=n(55164),i=n(57477),a=n(4661),c=n(68455),s={emoticonGroupList:[],emoticonGroupDetail:{}},u=(0,o._)({},(0,a.FH)("emoticons",["GET_EMOTICONGROUP_LIST","GET_EMOTICONS_DETAIL"]),(0,a.co)("emoticons",["SAVE_EMOTICONS_TO_REDUX","CHANGE_SELECTED_EMOTICON_GROUP","CHANGE_SELECTED_EMOTICON_PANEL"]));function l(){return{API:{types:u.GET_EMOTICONGROUP_LIST,endpoint:"/me/sticker-groups"}}}function d(e){return{API:{types:u.GET_EMOTICONS_DETAIL,endpoint:"/sticker-groups/".concat(e),query:{business:"message"}},meta:{id:e}}}function p(e){return{type:u.CHANGE_SELECTED_EMOTICON_GROUP,meta:{id:e}}}function f(e){return{type:u.CHANGE_SELECTED_EMOTICON_PANEL,meta:{id:e}}}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;if(t.type===u.GET_EMOTICONGROUP_LIST.success){var n=t.payload.data;return(0,i._)((0,o._)({},e),{emoticonGroupList:n,curEmoticonGroupId:t.payload.data[0].id})}if(t.type===u.GET_EMOTICONS_DETAIL.success){var a=t.meta.id,l=(0,i._)((0,o._)({},e.emoticonGroupDetail),(0,r._)({},a,t.payload.data)),d=(0,c.GM)(l,e.emoticonGroupList);return(0,i._)((0,o._)({},e),{emoticonGroupDetail:l,emoticonPanelList:d})}if(t.type===u.SAVE_EMOTICONS_TO_REDUX){var p=t.meta.data.id,f=(0,i._)((0,o._)({},e.emoticonGroupDetail),(0,r._)({},p,t.meta.data)),h=(0,c.GM)(f,e.emoticonGroupList);return(0,i._)((0,o._)({},e),{emoticonGroupDetail:f,emoticonPanelList:h})}if(t.type===u.CHANGE_SELECTED_EMOTICON_GROUP){var _=t.meta.id;return(0,i._)((0,o._)({},e),{curEmoticonGroupId:_})}if(t.type===u.CHANGE_SELECTED_EMOTICON_PANEL){var m=t.meta.id;return(0,i._)((0,o._)({},e),{curEmoticonPanelId:m})}return e}},87441:function(e,t,n){"use strict";n.d(t,{N7:function(){return y},OW:function(){return T}});var r=n(87320),o=n(55164),i=n(57477),a=n(9813),c=n(92769),s=n.n(c),u=n(33720),l=n.n(u),d=n(21654),p=n(21389),f=n(44900),h=n(25364),_=n(82865),m=n(58909),g={users:{},questions:{},answers:{},articles:{},columns:{},topics:{},roundtables:{},favlists:{},comments:{},notifications:{},ebooks:{},activities:{},feeds:{},pins:{},promotions:{},drafts:{},chats:{},posts:{},zvideos:{},eduCourses:{},lineComments:{}};function T(e,t){return{type:"entities/PRODUCE_ANSWER",entitiesProducer:(0,a.Uy)(function(n){t(n.answers[e])})}}var E=function(e,t){var n=t.schema,r=t.id,o=t.urlToken;return n?e["".concat(n,"s")][o||r]:t},y=function(e,t){return E(e.entities,t)};t.ZP=l()(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,n=arguments.length>1?arguments[1]:void 0;if(n.type===m.Hp.GET.success)return n.payload.isZombie=(0,_.Eh)(),(0,i._)((0,o._)({},t),{users:s()((0,i._)((0,o._)({},t.users),(0,r._)({},n.payload.urlToken,(0,o._)({},t.users[n.payload.id],t.users[n.payload.urlToken],n.payload))),n.payload.id)});if(n.type===m.Hp.ACTIVE_USER)return(0,i._)((0,o._)({},t),{users:(0,i._)((0,o._)({},t.users),(0,r._)({},n.currentUser,(0,i._)((0,o._)({},t.users[n.currentUser]),{isActive:!0})))});if(n.entities&&(t=(0,h.Z)(t,"function"==typeof(null===(e=n.meta)||void 0===e?void 0:e.entitiesPrefilter)?n.meta.entitiesPrefilter(n.entities):n.entities)),n.entitiesProducer&&(t=n.entitiesProducer(t)),n.UPDATE){var a=n.type,c=n.payload,u=n.UPDATE,l=u.request,d=u.success,p=u.failure,f=u.update,T=n.err;if(a.endsWith("request")&&l&&(t=(0,h.Z)(t,"function"==typeof l?l(c,n):l)),a.endsWith("success")&&d&&(t=(0,h.Z)(t,"function"==typeof d?d(c,n):d)),a.endsWith("failure")&&p){var E="function"==typeof p?p(T):p;t=(0,h.Z)(t,E)}else f&&(t=(0,h.Z)(t,"function"==typeof f?f(c,n):f))}return t},(0,p.y)({users:f.r,favlists:d.B}))},98424:function(e,t,n){"use strict";n.d(t,{Ct:function(){return h},GM:function(){return d},Hp:function(){return u},JT:function(){return p},QS:function(){return f},ph:function(){return l}});var r=n(87320),o=n(55164),i=n(67516),a=n.n(i),c=n(66263),s=n(4661),u=(0,o._)({},(0,s.co)("env",["UPDATE_USERAGENT","SET_TRAFFICSOURCE","UPDATE_EDITION","SET_CTX","SET_THEME","SET_APP_HEADER_THEME","TOGGLE_ENABLE_SHORTCUT","GET_ANNOUNCEMENT","SET_REFERER","UPDATE_CONF","UPDATE_LOGGED","UPDATE_AUTHINFO","UPDATE_APPVIEW_CONFIG","UPDATE_TRAFFIC_FREE","SET_UDID","SET_MODE","SET_ENV_VARS","STASH_QUERY"]),(0,s.FH)("env",["GET_IPINFO"]));function l(){return{API:{types:u.GET_IPINFO,endpoint:"ip_info"},FAILSAFE:!0}}function d(e){return{type:u.UPDATE_USERAGENT,payload:e}}function p(e){return e?a().delete(c.Xq):a().set(c.Xq,!1),{type:u.TOGGLE_ENABLE_SHORTCUT,payload:e}}function f(e){var t=e||{},n=t.urlToken,i=t.id,a=(void 0===n?"":n)||i;return(0,o._)({type:u.UPDATE_AUTHINFO},e&&{token:a,entities:{users:(0,r._)({},a,e)}})}var h=function(e){return{type:u.SET_ENV_VARS,payload:e}}},7407:function(e,t,n){"use strict";n.d(t,{tQ:function(){return d.tQ},ZP:function(){return p},cM:function(){return d.cM},H8:function(){return d.H8},Hu:function(){return d.Hu},ze:function(){return d.ze},Xj:function(){return d.Xj},nR:function(){return d.nR},ph:function(){return u.ph},Kv:function(){return d.Kv},Ct:function(){return u.Ct},XE:function(){return d.XE},cq:function(){return d.cq},hV:function(){return d.hV},JT:function(){return u.JT},Uh:function(){return d.Uh},QS:function(){return u.QS},GM:function(){return u.GM},dD:function(){return d.dD}});var r=n(55164),o=n(57477),i=n(63306),a=n(55536),c=n(17132),s=n.n(c),u=n(98424),l=(0,a.combineReducers)({abV2:i.Z,userAgent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===u.Hp.UPDATE_USERAGENT){var n=t.payload;return(0,r._)({},e,s()(n))}return e},appViewConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===u.Hp.UPDATE_APPVIEW_CONFIG){var n=t.payload,i=n.can_auto_load_image,a=n.font_resize;return(0,o._)((0,r._)({},e),{can_auto_load_image:i,font_resize:a||1})}return e},ctx:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===u.Hp.SET_CTX?t.payload:e},trafficSource:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return t.type===u.Hp.SET_TRAFFICSOURCE?t.payload:e},edition:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{beijing:!1,baidu:!1,sogou:!1,baiduBeijing:!1,sogouBeijing:!1,sogouInput:!1,oppoSearch:!1},t=arguments.length>1?arguments[1]:void 0;return t.type===u.Hp.UPDATE_EDITION?(0,r._)({},e,t.payload):t.type===u.Hp.GET_IPINFO.success&&"北京"===t.payload.cityName?(0,o._)((0,r._)({},e),{beijing:!0,baiduBeijing:e.baidu,sogouBeijing:e.sogou}):e},theme:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return t.type===u.Hp.SET_THEME?"dark"===t.payload?"dark":"light":e},appHeaderTheme:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{current:"normal",disable:!0,normal:{bgColor:"GBK99A"},custom:{bgColor:"GBK99A"}},t=arguments.length>1?arguments[1]:void 0;if(t.type===u.Hp.SET_APP_HEADER_THEME){var n=t.payload||{current:"normal"};return(0,r._)({},e,n)}return e},enableShortcut:function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1?arguments[1]:void 0;return t.type===u.Hp.TOGGLE_ENABLE_SHORTCUT?t.payload:e},referer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return t.type===u.Hp.SET_REFERER?t.payload:e},xUDId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;return t.type===u.Hp.SET_UDID?t.payload:e},mode:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ssr",t=arguments.length>1?arguments[1]:void 0;return t.type===u.Hp.SET_MODE&&t.payload?t.payload:e},conf:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===u.Hp.UPDATE_CONF?(0,r._)({},e,t.payload):e},xTrafficFreeOrigin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if(t.type===u.Hp.UPDATE_TRAFFIC_FREE){var n=t.payload;return void 0===n?"":n}return e},ipInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===u.Hp.GET_IPINFO.success?t.payload:e},logged:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return t.type===u.Hp.UPDATE_LOGGED?t.payload:e},query:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===u.Hp.STASH_QUERY?t.payload:e},vars:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===u.Hp.SET_ENV_VARS?(0,r._)({},e,t.payload):e}}),d=n(68900),p=l},68900:function(e,t,n){"use strict";n.d(t,{H8:function(){return f},Hu:function(){return l},Kv:function(){return g},Uh:function(){return u},XE:function(){return h},Xj:function(){return y},cM:function(){return s},cq:function(){return m},dD:function(){return d},hV:function(){return C},nR:function(){return p},tQ:function(){return E},ze:function(){return _}});var r=n(92258),o=n(31824),i=n(66263),a=n(2493),c=n(58909),s=function(e){return e.env.edition},u=function(e){return e.env.userAgent},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.includeTablet,r=u(e),o=r.Mobile||r.iOS,i=r.Tablet;return void 0!==n&&n?o:o&&!i},d=function(e){return(0,r.useSelector)(function(t){return l(t,e)})},p=(0,o.P1)(u,function(e){return e.Zhihu||e.ZhihuHybrid}),f=(0,o.P1)(u,function(e){return!e.isBot}),h=(0,o.P1)(l,f,c.ib,function(e,t,n){return(t||!n)&&e}),_=(0,o.P1)(u,function(e){return e.Zhixuetang});(0,o.P1)(h,s,function(e,t){return e&&t.sogouBeijing});var m=(0,o.P1)(h,s,function(e,t){return e&&!t.sogouBeijing&&!t.miniProgram}),g=function(e){return e.env.referer},T=["zhihu.com/special/19590770"],E=(0,a.Z)(function(e){return e.env.abV2.config.paramMap},function(e,t){return t},function(e,t){var n,r,o=t.paramId;return t.mock,null!==(r=null==e?void 0:null===(n=e[o])||void 0===n?void 0:n.value)&&void 0!==r?r:null});function y(e){var t=e.env;return(null==t?void 0:t.trafficSource)==="office"}(0,o.P1)(m,function(e){return T.some(function(t){return e.env.referer.includes(t)})},function(e,t){return e&&!t});var C=function(e,t){var n,r=t.type,o=t.id;return!!i.o$[r]&&e.env.userAgent.Mobile&&(null===(n=i.o$[r])||void 0===n?void 0:n.includes(String(o)))}},35528:function(e,t,n){"use strict";n.d(t,{Hz:function(){return g},I3:function(){return T},NK:function(){return C},Vf:function(){return _},ZP:function(){return I},k1:function(){return E},n2:function(){return m},wU:function(){return y},xb:function(){return p}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(74135),s=n(28953),u=n(4661),l=n(74167),d=n(59523),p=(0,u.FH)("favlist",["GET_HOT_FAVLISTS","GET_CURRENT_USER_FAVLISTS","UPDATE_FOLLOWERS","UPDATE_FAVLIST_ITEM","ADD_FAVLIST"]),f=(0,u.co)("favlist",["UPDATE_FAV_RELATIONS","UPDATE_FAV_RELATED_CONTENT"]),h={answer:"answers",article:"articles",pin:"pins",zvideo:"zvideos"};function _(e,t){var n=t.type,o=t.id;return function(t,i){var a=i(),u=a.currentUser,d=a.entities;return t({meta:{currentUser:u,type:n,id:o},API:{types:p.ADD_FAVLIST,endpoint:"/collections",method:"POST",query:{include:"updated_time,answer_count,follower_count"},zsEncrypt:!0,bodyType:"json",body:(0,c.decamelizeKeys)(e)},schema:s.l.COLLECTION,UPDATE:{success:function(){var e,t=h[n],i=t?null===(e=d[t])||void 0===e?void 0:e[o]:null;if(i){var a=(0,l.L)(i,!0);return(0,r._)({},t,(0,r._)({},o,a))}return{}}}})}}function m(e,t){return function(n,r){var o=r(),i=o.currentUser,a=(o.favlists[i]||{}).paging,c=void 0===a?{}:a;return n({meta:{currentUser:i},API:{endpoint:c.next||"/collections/contents/".concat(e,"/").concat(t),types:p.GET_CURRENT_USER_FAVLISTS,query:c.next?void 0:{offset:0,limit:5}},schema:s.l.FAVLIST_ARRAY})}}function g(e,t){return function(n,r){return n({meta:{currentUser:r().currentUser},API:{endpoint:"/collections/contents/".concat(e,"/").concat(t),types:p.GET_CURRENT_USER_FAVLISTS,query:{offset:0,limit:5}},schema:s.l.FAVLIST_ARRAY})}}function T(e,t){return function(n,o){var i=o(),a=i.entities.favlists,c=(0,d.ib)(i).id,s=a[e],u=t?1:-1;return n({API:{types:p.UPDATE_FOLLOWERS,endpoint:"collections/".concat(e,"/followers").concat(t?"":"/".concat(c)),method:t?"POST":"DELETE"},UPDATE:{request:{favlists:(0,r._)({},e,{followerCount:s.followerCount+u,isFollowing:t})},failure:{favlists:(0,r._)({},e,s)}}})}}var E=function(e){var t=e.contentId,n=e.contentType,r=e.relations;return{type:f.UPDATE_FAV_RELATIONS,contentId:t,contentType:n,payload:{relations:r}}},y=function(e){var t=e.contentId,n=e.contentType,o=e.collected,i=h[n];return function(e,n){var a,c=n().entities,s=i?null===(a=c[i])||void 0===a?void 0:a[t]:null;return e({type:f.UPDATE_FAV_RELATED_CONTENT,UPDATE:{update:function(){if(s){var e=(0,l.L)(s,o);return(0,r._)({},i,(0,r._)({},t,e))}return{}}}})}};function C(e,t,n){return function(o,i){var a,s=i().entities,u=s.favlists[e].answerCount,d=null===(a=i().favlists.relations["".concat(n,"_").concat(t)])||void 0===a?void 0:a[e],f=d?{endpoint:"/collections/".concat(e,"/contents/").concat(t),method:"DELETE",query:(0,c.decamelizeKeys)({contentType:n})}:{endpoint:"/collections/".concat(e,"/contents"),method:"POST",query:(0,c.decamelizeKeys)({contentId:t,contentType:n})},_=f.endpoint,m=f.method,g=f.query;return o({API:{types:p.UPDATE_FAVLIST_ITEM,endpoint:_,method:m,query:g},meta:{contentType:n,contentId:t,collectionId:e,collected:!d},UPDATE:{request:function(){return{favlists:(0,r._)({},e,{answerCount:d?u-1:u+1})}},success:function(){var e,o=h[n],i=o?null===(e=s[o])||void 0===e?void 0:e[t]:null;if(i){var a=(0,l.L)(i,!1===d);return(0,r._)({},o,(0,r._)({},t,a))}return{}},failure:function(){return{favlists:(0,r._)({},e,{answerCount:u})}}}})}}var S={isFetching:!1,isDrained:!1,ids:[],offset:0,limit:10};function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{relations:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.ADD_FAVLIST.success:var n,c=t.meta,s=c.currentUser,u=c.type,l=c.id,d="".concat(u,"_").concat(l);return(0,i._)((0,o._)({},e),(n={},(0,r._)(n,s,(0,i._)((0,o._)({},e[s]),{ids:[t.payload.collection.id].concat((0,a._)(e[s].ids))})),(0,r._)(n,"relations",(0,i._)((0,o._)({},e.relations),(0,r._)({},d,(0,i._)((0,o._)({},e.relations[d]),(0,r._)({},t.payload.collection.id,!1))))),n));case p.GET_CURRENT_USER_FAVLISTS.request:var h=t.meta.currentUser;return(0,i._)((0,o._)({},e),(0,r._)({},h,(0,i._)((0,o._)({},S,e[h]),{isFetching:!0,isDrained:!1})));case p.GET_CURRENT_USER_FAVLISTS.success:var _=t.result,m=t.meta.currentUser,g=t.payload,T=_.filter(function(t){return!e[m].ids.includes(t)});return(0,i._)((0,o._)({},e),(0,r._)({},m,(0,i._)((0,o._)({},S,e[m]),{isFetching:!1,ids:(0,a._)(e[m].ids).concat((0,a._)(T)),isDrained:g.paging.isEnd,paging:g.paging})));case p.GET_CURRENT_USER_FAVLISTS.failure:var E=t.meta.currentUser;return(0,i._)((0,o._)({},e),(0,r._)({},E,(0,i._)((0,o._)({},e[E]),{isFetching:!1})));case f.UPDATE_FAV_RELATIONS:var y=t.contentId,C=t.contentType,I=t.payload,A="".concat(C,"_").concat(y);return(0,i._)((0,o._)({},e),{relations:(0,i._)((0,o._)({},e.relations),(0,r._)({},A,(0,o._)({},e.relations[A],I.relations)))});case p.UPDATE_FAVLIST_ITEM.success:var b=t.meta,w=b.contentId,Z=b.contentType,x=b.collectionId,k=b.collected,R="".concat(Z,"_").concat(w);return(0,i._)((0,o._)({},e),{relations:(0,i._)((0,o._)({},e.relations),(0,r._)({},R,(0,i._)((0,o._)({},e.relations[R]),(0,r._)({},x,k))))});default:return e}}},25364:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(15030),o=n(55164),i=n(83935);function a(e,t){return Object.keys(t).reduce(function(e,n){var a,c=t[n]||{},s=(a=e[n],Object.keys(c).reduce(function(e,t){var n,a=c[t],s=!!(a&&"object"==typeof a);return e[t]=s?(n=e[t],Object.keys(a).reduce(function(e,t){var n=e[t],o=a[t],c=!Array.isArray(n)&&(0,r._)(n,Object)&&(0,r._)(o,Object);return e[t]=c?(0,i.H)(n,o):o,e},(0,o._)({},n))):a,e},(0,o._)({},a)));return e[n]=s,e},(0,o._)({},e))}},45347:function(e,t,n){"use strict";n.d(t,{ZP:function(){return f},qS:function(){return u.q}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(55536);n(74135);var s=(0,n(4661).FH)("host",["GET_USER_PERMISSIONS","UPDATE_ROUNDTABLE_SUBJECT","GET_ROUNDTABLE_SUBJECT","GET_ROUNDTABLE_APPLICATIONS","GET_ONLINE_ROUNDTABLES","UPDATE_ROUNDTABLE_APPLY","CREATE_ROUNDTABLE_APPLY","GET_ROUNDTABLE_APPLY","GET_ROUNDTABLE_DETAIL","GET_ROUNDTABLE_INCLUDEDRESOURCE","GET_ROUNDTABLE_HOT_QUESTIONS","UPDATE_HIDDEN_ROUNDTABLE_INCLUDEDRESOURCE","UPDATE_ROUNDTABLE_INCLUDERESOURCE","TOGGLE_ROUNDTABLE_HOT_QUESTION_HIDDEN","POST_ROUNDTABLE_INCLUDEDRESOURCE","ADD_ROUNDTABLE_HOT_QUESTIONS","UPDATE_ROUNDTABLE_HOT_QUESTION","SEARCH_ROUNDTABLE_INCLUDED_RESOURCE","BATCH_ADD_ROUNDTABLE_INCLUDED_RESOURCE","GET_ROUNDTABLE_WARMUP_CONTENTS","TOGGLE_WARMUP_CONTENT_HIDDEN","SET_WARMUP_CONTENT_WEIGHT","GET_SPECIAL_APPLICATIONS","GET_SPECIAL_APPLY_CENSOR_HISTORY","GET_SPECIAL_DRAFT","SAVE_SPECIAL_DRAFT","SUBMIT_SPECIAL_APPLY"]),u=n(42412),l=n(9813),d=(0,c.combineReducers)({subjects:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===s.GET_ROUNDTABLE_SUBJECT.success){var n=t.payload.data;return(0,i._)((0,o._)({},e),(0,r._)({},n.id,n))}return e},applications:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{total:0},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,o=t.meta;return n===s.GET_ROUNDTABLE_APPLICATIONS.success?(0,u.q)(e,o.current,r):e},online:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{total:0},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload,o=t.meta;return n===s.GET_ONLINE_ROUNDTABLES.success?(0,u.q)(e,o.current,r):e},applies:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===s.GET_ROUNDTABLE_APPLY.success){var n=t.payload.data;return(0,i._)((0,o._)({},e),(0,r._)({},n.id,n))}return e},details:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.meta,a=t.payload;return t.type===s.GET_ROUNDTABLE_DETAIL.success?(0,i._)((0,o._)({},e),(0,r._)({},n.id,a.data)):e},includedResource:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload,d=t.meta;if(n===s.GET_ROUNDTABLE_INCLUDEDRESOURCE.success)return(0,i._)((0,o._)({},e),(0,r._)({},d.id,(0,o._)({},e[d.id],(0,u.q)(e[d.id]||{},d.current,c,{dataKey:"objectId"}))));if(n===s.UPDATE_HIDDEN_ROUNDTABLE_INCLUDEDRESOURCE.success)return(0,l.Uy)(e,function(e){e[d.id].entities[d.objectId].isDeleted=d.isDeleted});if(n===s.UPDATE_ROUNDTABLE_INCLUDERESOURCE.success)return(0,l.Uy)(e,function(e){Object.assign(e[d.id].entities[d.resource.objectId],d.body)});if(n===s.POST_ROUNDTABLE_INCLUDEDRESOURCE.success){var p=t.payload.payload;if(p){var f=p.objectId;return(0,l.Uy)(e,function(e){e[d.id].pages[1]=e[d.id].pages[1]?[f].concat((0,a._)(e[d.id].pages[1])):[f],e[d.id].entities[f]=p})}}return e},hotQuestions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,c=t.meta;return n===s.GET_ROUNDTABLE_HOT_QUESTIONS.success?(0,i._)((0,o._)({},e),(0,r._)({},c.id,(0,o._)({},e[c.id],(0,u.q)(e[c.id]||{},c.current,a,{dataKey:"question.id"})))):n===s.TOGGLE_ROUNDTABLE_HOT_QUESTION_HIDDEN.success?(0,l.Uy)(e,function(e){e[c.id].entities[c.questionId].isDeleted=c.isDeleted}):n===s.UPDATE_ROUNDTABLE_HOT_QUESTION.success?(0,l.Uy)(e,function(e){Object.assign(e[c.id].entities[c.question.id],c.body)}):e},warmupContents:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,c=t.meta;return n===s.GET_ROUNDTABLE_WARMUP_CONTENTS.success?(0,i._)((0,o._)({},e),(0,r._)({},c.roundtableId,(0,o._)({},e[c.roundtableId],(0,u.q)(e[c.roundtableId]||{},c.current,a,{dataKey:"id"})))):n===s.TOGGLE_WARMUP_CONTENT_HIDDEN.success?(0,l.Uy)(e,function(e){e[c.roundtableId].entities[c.contentId].isDeleted=c.isDeleted}):n===s.SET_WARMUP_CONTENT_WEIGHT.success?(0,l.Uy)(e,function(e){e[c.roundtableId].entities[c.contentId].weight=c.weight}):e},batchInclude:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload,c=t.meta;return n===s.SEARCH_ROUNDTABLE_INCLUDED_RESOURCE.success?(0,i._)((0,o._)({},e),(0,r._)({},c.id,(0,o._)({},e[c.id],(0,u.q)(e[c.id]||{},c.current,a)))):e}}),p=(0,c.combineReducers)({applications:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{total:0,pages:{},entities:{}},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.meta,o=t.payload;return n===s.GET_SPECIAL_APPLICATIONS.success?(0,u.q)(e,r.current,{total:o.paging.total,data:o.data}):e},censorHistory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.meta,c=t.payload;return n===s.GET_SPECIAL_APPLY_CENSOR_HISTORY.success?(0,i._)((0,o._)({},e),(0,r._)({},a.draftId,c.data)):e},drafts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;return n===s.GET_SPECIAL_DRAFT.success?(0,i._)((0,o._)({},e),(0,r._)({},a.draftId,a)):e}}),f=(0,c.combineReducers)({roundtable:d,special:p})},42412:function(e,t,n){"use strict";n.d(t,{q:function(){return s}});var r=n(87320),o=n(55164),i=n(57477),a=n(76931),c=n.n(a),s=function(e,t,n){var a,s=n.total,u=n.data,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},d=l.dataKey,p=void 0===d?"id":d,f=l.pagesKey,h=void 0===f?"pages":f,_=l.entitiesKey,m=void 0===_?"entities":_,g=l.totalKey,T=void 0===g?"total":g,E=u.map(function(e,n){return"index"===p?"".concat(t,"-").concat(n):c()(e,p)});return(0,i._)((0,o._)({},e),(a={},(0,r._)(a,T,s),(0,r._)(a,m,E.reduce(function(e,t,n){return e[t]=u[n],e},(0,o._)({},e[m]||{}))),(0,r._)(a,h,(0,i._)((0,o._)({},e[h]),(0,r._)({},t,E))),a))}},50605:function(e,t,n){"use strict";n.d(t,{k:function(){return o}});var r=(0,n(4661).FH)("interactText",["GET_INTERACT_TEXT"]);function o(e,t){return{API:{types:r.GET_INTERACT_TEXT,endpoint:"/".concat(e,"/").concat(t,"/segments")},FAILSAFE:!0}}},10416:function(e,t,n){"use strict";n.d(t,{T$:function(){return u},WW:function(){return l},ZP:function(){return d},yM:function(){return s}});var r=n(87320),o=n(55164),i=n(57477),a=n(4661),c=(0,o._)({},(0,a.FH)("label",["GET","GET_V3"])),s=function(e,t){return t&&e.label["".concat(t.type,"_").concat(t.id)]};function u(e,t){return{itemType:e,id:t,API:{types:c.GET,endpoint:"/".concat(e,"s/").concat(t,"/labels/v2")}}}function l(e,t){return{itemType:e,id:t,API:{types:c.GET_V3,endpoint:"/".concat(e,"s/").concat(t,"/labels/v3")}}}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===c.GET.success){var n=t.id,a=t.itemType,s=t.payload;e=(0,i._)((0,o._)({},e),(0,r._)({},"".concat(a,"_").concat(n),s))}if(t.type===c.GET_V3.success){var u=t.id,l=t.itemType,d=t.payload;e=(0,i._)((0,o._)({},e),(0,r._)({},"".concat(l,"_").concat(u),(null==d?void 0:d.endorsements)||[]))}return e}},69906:function(e,t,n){"use strict";n.d(t,{VZ:function(){return r.VZ},W2:function(){return r.W2},kf:function(){return i},Fd:function(){return r.Fd},QT:function(){return r.QT},TS:function(){return r.TS},V6:function(){return r.V6}});var r=n(98104),o=n(87320),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.itemsKey,r=void 0===n?"items":n;return e||(0,o._)({isFetching:!1,isDrained:!1},r,[])}},98104:function(e,t,n){"use strict";n.d(t,{Fd:function(){return h},QT:function(){return T},TS:function(){return g},V6:function(){return _},VZ:function(){return d},W2:function(){return p}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(75472),s=n.n(c),u=n(23391),l=n.n(u),d=10,p=5;function f(e){return e.id}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.mapActionToKey,c=void 0===n?f:n,s=t.additionalCase,u=t.additionalCaseTypes,l=t.addSuccessType,d=void 0===l?"addSuccessType does not exist":l,p=t.addAtTop,h=void 0===p||p,_=t.getExtraData,m=void 0===_?function(){}:_,g=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isDrained:!1,ids:[],newIds:[],totals:0,error:!1,errorPayload:null,antiSpider:!1},r=arguments.length>1?arguments[1]:void 0;switch(r.type){case T:return(0,i._)((0,o._)({},n),{isFetching:!0,error:!1,errorPayload:null,antiSpider:!1});case E:var c=n.ids,u=(r.result||[]).filter(function(e){return!e||!c.includes(e)}),l=r.isPrevious,p=r.isPrevDrained,f=r.isDrained,_=r.previous,g=r.next,C=r.totals,S=r.payload,I=r.needForceLogin,A=null,b=r.rootComment,w=r.topComments;A=b&&w?l?(0,a._)(u).concat((0,a._)(c)):[b].concat((0,a._)(w.result),(0,a._)(c),(0,a._)(u)):l?(0,a._)(u).concat((0,a._)(c)):(0,a._)(c).concat((0,a._)(u));var Z=l||!c.length,x=!l||!c.length,k=m(n,r);return(0,o._)((0,i._)((0,o._)((0,i._)((0,o._)({},n),{emptyText:(null==S?void 0:S.emptyText)||"",filterItems:null==S?void 0:S.filterItems,isFetching:!1,totals:C,topComments:w,ids:A,newIds:r.result,needForceLogin:I||!1}),Z?{isPrevDrained:p,previous:_}:{},x?{isDrained:f,next:g}:{}),{sensitiveLevel:null==S?void 0:S.sensitiveLevel,warning:null==S?void 0:S.warning,warningBox:null==S?void 0:S.warningBox,warnNotes:null==S?void 0:S.warnNotes}),(null==S?void 0:S.session)?{sessionId:S.session.id}:{},k);case y:if((null===(e=r.err)||void 0===e?void 0:null===(t=e.payload)||void 0===t?void 0:t.code)===101&&"ZERR_NOT_LOGIN"===r.err.payload.message)return(0,i._)((0,o._)({},n),{isFetching:!1,isDrained:!0,antiSpider:!0,errorPayload:null,ids:[]});return(0,i._)((0,o._)({},n),{isFetching:!1,isDrained:!0,error:!0,errorPayload:r.err||r.error,antiSpider:!1});case d:return"commercial"===r.question.questionType?n:(0,i._)((0,o._)({},n),{totals:n.totals+1,ids:h?[r.result].concat((0,a._)(n.ids)):(0,a._)(n.ids).concat([r.result]),newIds:h?[r.result].concat((0,a._)(n.newIds)):(0,a._)(n.newIds).concat([r.result])});default:if(s)return s(n,r);return n}},T=e.request,E=e.success,y=e.failure,C=(0,a._)(Object.values(e)).concat((0,a._)(void 0===u?[]:u),[d]);return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(C.includes(t.type)){var n=c(t);if(void 0!==n)return(0,i._)((0,o._)({},e),(0,r._)({},n,g(e[n],t)))}return e}}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.mapActionToKey,c=void 0===n?f:n,s=t.additionalCase,u=t.additionalCaseTypes,l=t.addSuccessType,d=void 0===l?"addSuccessType does not exist":l,p=t.addAtTop,h=void 0===p||p,_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{error:void 0,errorPayload:null,isLoadedOnce:!1,isDrained:!1,isFetching:!1,ids:[],totals:0},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.offset;switch(n){case m:return(0,i._)((0,o._)({},e),{isFetching:!0,error:void 0,errorPayload:null});case g:var c=t.totals,u=t.isDrained,l=t.result,p=t.limit,f=void 0===p?20:p,_=e.ids,E=(void 0===l?[]:l).filter(function(e){return!_.includes(e)}),y=_.slice(r,r+f).filter(Boolean),C=f-y.length-E.length,S=(0,a._)(y).concat((0,a._)(E),(0,a._)(C<=0?[]:Array.from({length:C}).map(function(){return!1}))),I=c||_.length+E.length;return _.length=I,(0,i._)((0,o._)({},e),{isDrained:u,isLoadedOnce:!0,isFetching:!1,ids:(0,a._)(_.slice(0,r)).concat((0,a._)(S),(0,a._)(_.slice(r+S.length))).slice(0,I),totals:c});case T:var A=t.limit,b=e.ids;return(0,i._)((0,o._)({},e),{error:Error(),errorPayload:t.err||t.error,isLoadedOnce:!0,isFetching:!1,isDrained:!0,ids:(0,a._)(b.slice(0,r)).concat((0,a._)(Array.from({length:A}).map(function(){return!1})))});case d:var w=e.ids,Z=e.totals;return(0,i._)((0,o._)({},e),{totals:Z+1,ids:h?[t.result].concat((0,a._)(w)):(0,a._)(w).concat([t.result])});default:if(s)return s(e,t);return e}},m=e.request,g=e.success,T=e.failure,E=(0,a._)(Object.values(e)).concat((0,a._)(void 0===u?[]:u),[d]);return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(E.includes(t.type)){var n=c(t);if(void 0!==n)return(0,i._)((0,o._)({},e),(0,r._)({},n,_(e[n],t)))}return e}}function m(e,t){if(Array.isArray(e))return e.concat(t)}var g=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return l().apply(void 0,[{}].concat((0,a._)(t),[m]))};function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.defaultState,a=t.mergeState,c=void 0===a?function(e,t){var n=e.items,r=t.result;return{items:n&&n.length?r.filter(function(e){return!n.find(function(t){return s()(t,e)})}):r,next:t.next}}:a,u=t.additionCase,l=t.keySelector,d=void 0===l?function(e){return e.id}:l,p=(0,o._)({isFetching:!1,isDrained:!1,errorPayload:null},n);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case e.request:return g(t,(0,r._)({},d(n),(0,i._)((0,o._)({},p),{isFetching:!0})));case e.success:var a=d(n),s=(n.payload||{}).paging,l=(void 0!==s&&s).isEnd;return g(t,(0,r._)({},a,(0,o._)({isFetching:!1,isDrained:l},c(t[a],n))));case e.failure:return g(t,(0,r._)({},d(n),{isFetching:!1,isDrained:!0,errorPayload:n.err||n.error}));default:if(u)return u(t,n);return t}}}},63315:function(e,t,n){"use strict";n.d(t,{L1:function(){return A},O:function(){return _},S7:function(){return E},Yu:function(){return g},ZP:function(){return Z},gf:function(){return b},qo:function(){return m},uJ:function(){return C},uM:function(){return I},zq:function(){return T}});var r=n(55164),o=n(57477),i=(n(49899),n(54231)),a=n(74135),c=n(80714),s=n(4785),u=n(43361),l=n(54826),d=n(66263),p=n(4661),f=n(67927),h=(0,r._)({},(0,p.FH)("login",["DIGITS","LOGIN","VALIDATE_LOGIN_FORM","VALIDATE_LOGIN_DIGITS","GET_WECHAT_SOCIAL_INFO","SMS_IDENTIFY","LOGIN_FOR_QUICK_REGISTER","QUICK_REGISTER"]),(0,p.co)("login",["RESET_LOGIN_VALIDATE_RESULT"]),(0,p.FH)("qrcodeLogin",["TOKEN","SCAN_STATUS"]));function _(e){return{API:{types:h.SMS_IDENTIFY,endpoint:"v3/oauth/guardians/verify",query:{phone_no:e},fetchOptions:{withDUBrowserID:!0}}}}function m(e){return{API:{types:h.SMS_IDENTIFY,endpoint:"v3/oauth/guardians/verify",method:"POST",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,s.Z)({phone_no:e}),withDUBrowserID:!0}}}}function g(e,t){var n={phoneNo:e};return t&&(n.smsType=t),c.Z.isMobileEntry||"1"!==c.Z.apollo.sign_flow_scene||(n.scene="digits_login"),function(e){return e({API:{types:h.DIGITS,endpoint:"v3/oauth/sign_in/digits",method:"POST",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,s.Z)((0,a.decamelizeKeys)(n)),withDUBrowserID:!0}}}).then(null,function(t){t&&t.err&&120001===t.err.payload.code&&e((0,f.c0)("页面已过期，请刷新重试","red"))})}}function T(e){return(c.Z.isMobileEntry||"1"!==c.Z.apollo.sign_flow_scene)&&delete e.scene,function(t){return t({API:{types:h.LOGIN,endpoint:"v3/oauth/sign_in",method:"POST",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,s.Z)((0,a.decamelizeKeys)(e)),withDUBrowserID:!0}},NOTIFICATION:!1}).catch(function(n){if(null==n?void 0:n.payload){var r=n.payload,o=r.code,a=r.message;if(null==e?void 0:e.refreshToken){(0,l.qz)(),i.ZP.increment("token.error.refresh.".concat(o));return}if(o!==d.fH)return t((0,f.c0)(120001===o?"页面已过期，请刷新重试":a,"red"))}})}}function E(){return{type:h.RESET_LOGIN_VALIDATE_RESULT}}function y(e){return(c.Z.isMobileEntry||"1"!==c.Z.apollo.sign_flow_scene)&&delete e.scene,{API:{types:h.VALIDATE_LOGIN_DIGITS,endpoint:"v3/oauth/validate/sign_in/digits",method:"POST",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,s.Z)((0,a.decamelizeKeys)(e)),withDUBrowserID:!0}}}}function C(e){return function(t){return(t(E()),"digits"===e.grantType)?(e.scene="digits_login",e.phoneNo=e.username,t(y(e)).then(function(n){if(n&&n.payload&&n.payload.success)return t(T(e))})):(e.scene="password_login",t(T(e)))}}var S=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return!1};function I(e){return function(t){return"digits"!==e.grantType?t(C(e)):(S("开始一键注册流程",{phoneNo:e.username}),t(E()),e.phoneNo=e.username,e.scene="digits_login",t(y(e)).then(function(n){var r,o;if(S("验证码校验结果",null==n?void 0:null===(r=n.payload)||void 0===r?void 0:r.success),null==n?void 0:null===(o=n.payload)||void 0===o?void 0:o.success)return t(function(t){return t({API:{endpoint:"v3/oauth/sign_in",types:h.LOGIN_FOR_QUICK_REGISTER,method:"POST",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,s.Z)((0,a.decamelizeKeys)(e)),withDUBrowserID:!0}},NOTIFICATION:!1}).catch(function(n){if(null==n?void 0:n.payload){var r=n.payload,o=r.code,a=r.message;if(null==e?void 0:e.refreshToken){(0,l.qz)(),i.ZP.increment("token.error.refresh.".concat(o));return}if(o===d.fH)throw n;t((0,f.c0)(120001===o?"页面已过期，请刷新重试":a,"red"))}throw n})}).catch(function(n){var r;if((null==n?void 0:null===(r=n.payload)||void 0===r?void 0:r.code)===d.fH)return S("用户未注册，发起自动注册"),t({API:{types:h.QUICK_REGISTER,endpoint:"v3/oauth/register",method:"POST",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,s.Z)((0,a.decamelizeKeys)({source:"com.zhihu.web",registerType:"phone_digits",phoneNo:e.phoneNo,digits:e.digits})),withDUBrowserID:!0}},NOTIFICATION:!1}).then(function(){S("注册成功，跳转");var e=new URLSearchParams(location.search).get("next")||"/";location.href=(0,u.Z)(e)}).catch(function(e){S("注册失败",null==e?void 0:e.payload);var n,r=(null==e?void 0:null===(n=e.payload)||void 0===n?void 0:n.message)||"注册失败，请重试";t((0,f.c0)(r,"red"))});throw n})}))}}function A(){return function(e){return e({API:{types:h.TOKEN,root:c.Z.fetchRoot.www,endpoint:"/api/v3/account/api/login/qrcode",method:"POST",fetchOptions:{credentials:"include",withDUBrowserID:!0}},NOTIFICATION:!1})}}function b(e){var t=e.token;return function(e){return e({API:{root:c.Z.fetchRoot.www,types:h.SCAN_STATUS,endpoint:"/api/v3/account/api/login/qrcode/".concat(t,"/scan_info"),method:"GET",fetchOptions:{credentials:"include",withDUBrowserID:!0}},NOTIFICATION:!1})}}var w={loginUnregisteredError:!1,loginBindWechatError:!1,loginConfirmError:null,sendDigitsError:null,needSMSIdentify:!1,validateDigitsError:!1,loginConfirmSucceeded:null,qrcodeLoginToken:"",qrcodeLoginScanStatus:0,qrcodeLoginError:null,qrcodeLoginReturnNewToken:!1};function Z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0,n=t.type;if(n===h.RESET_LOGIN_VALIDATE_RESULT)return(0,o._)((0,r._)({},w),{qrcodeLoginToken:e.qrcodeLoginToken,qrcodeLoginScanStatus:e.qrcodeLoginScanStatus,qrcodeLoginError:e.qrcodeLoginError,qrcodeLoginReturnNewToken:e.qrcodeLoginReturnNewToken});if(n===h.LOGIN.success||n===h.LOGIN_FOR_QUICK_REGISTER.success){var i=(null==t?void 0:t.payload)||{},a=i.verification,c=i.refreshToken;return c&&(0,l.ZP)(c),(0,o._)((0,r._)({},e),{loginConfirmSucceeded:!0,verification:a})}if(n===h.LOGIN.failure||n===h.LOGIN_FOR_QUICK_REGISTER.failure){var s=t.err.payload,u=(0,o._)((0,r._)({},e),{loginConfirmSucceeded:!1,loginUnregisteredError:s.code===d.fH,loginBindWechatError:100077===s.code,loginConfirmError:(0,r._)({},e.loginConfirmError,(0,p.O1)(s))});return n===h.LOGIN_FOR_QUICK_REGISTER.failure?s.code===d.fH?(0,o._)((0,r._)({},e),{loginConfirmSucceeded:!1,loginUnregisteredError:!1}):(0,o._)((0,r._)({},u),{loginUnregisteredError:!1}):u}if(n===h.DIGITS.failure)return(0,o._)((0,r._)({},e),{sendDigitsError:(0,r._)({},e.sendDigitsError,(0,p.O1)(t.err.payload)),needSMSIdentify:410001===t.err.payload.code});if(n===h.VALIDATE_LOGIN_DIGITS.failure)return(0,o._)((0,r._)({},e),{loginConfirmError:(0,r._)({},e.loginConfirmError,(0,p.O1)(t.err.payload))});if(n===h.VALIDATE_LOGIN_DIGITS.success)return t.payload.success?e:(0,o._)((0,r._)({},e),{loginConfirmError:(0,o._)((0,r._)({},e.loginConfirmError),{validateDigitsError:"验证码填写错误"})});if(n===h.TOKEN.failure||n===h.SCAN_STATUS.failure)return(0,o._)((0,r._)({},e),{qrcodeLoginError:t.err.payload});if(n===h.TOKEN.success)return(0,o._)((0,r._)({},e),{qrcodeLoginToken:t.payload.token,qrcodeLoginTokenExpires:t.payload.expiresAt,qrcodeLoginError:null});if(n===h.SCAN_STATUS.success){var f={qrcodeLoginError:null};return t.payload.accessToken?f.loginConfirmSucceeded=!0:(t.payload.newToken&&t.payload.newToken.token&&(f.qrcodeLoginReturnNewToken=!0),f.qrcodeLoginScanStatus=t.payload.status,f.qrcodeLoginToken=t.payload.newToken&&t.payload.newToken.token||e.qrcodeLoginToken,f.qrcodeLoginTokenExpires=t.payload.newToken&&t.payload.newToken.expiresAt||e.qrcodeLoginTokenExpires),(0,r._)({},e,f)}return e}},71240:function(e,t,n){"use strict";n.d(t,{ZP:function(){return d},ko:function(){return u}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899);n(74135),n(58909);var c=n(4661),s=(0,o._)({},(0,c.FH)("mcn",["AGREE_CONTRACT","AGREE_TARGET_SOURCE_CONTRACT","GET_BIND_INFO","SET_BIND_INFO","SET_PINDUODUO_BIND_INFO","REMOVE_BIND_INFO","GET_MEMBER_CATEGORY","SET_MEMBER_CATEGORY","GET_PRODUCER","GET_CATEGORY","GET_SECONDARY_CATEGORY","SEARCH_GOOD","GET_TAOBAO_GOOD","GENERATE_LINK_CARD","UPDATE_LINK_CARD","GET_HOT_CITIES","SEARCH_CITY","GET_CITY_DISTRICTS","LOAD_LIST","LOAD_MCN_PERMISSION","GET_LINK_CARD_URL","LOAD_MCN_BANNER","GET_MCN_QUESTION_RECOMMEND_TABS","GET_MCN_QUESTION_RECOMMEND_LIST","LOAD_REDPACKET","GET_MEMBER_STATUS"]),(0,c.co)("mcn",["CLEAN_CATEGORY","REMOVE_RECENT_ADDED_GOODS"]));function u(e){return{API:{types:s.UPDATE_LINK_CARD,endpoint:"/mcn/linkcard/".concat(e.id),method:"PUT",body:{title:e.title}}}}var l={bindInfo:{},memberCategoryList:[],producerList:[],categoryList:[],lists:{},banners:{},protocolStatus:{isAgreedNew:!0,isAgreedOld:!0},probationCountdownDays:0};function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;if(t.type===s.GET_BIND_INFO.success){var n=t.meta.source;return(0,i._)((0,o._)({},e),{bindInfo:(0,i._)((0,o._)({},e.bindInfo),(0,r._)({},n,t.payload))})}if(t.type===s.SET_BIND_INFO.success){var c=t.meta,u=c.source,d=c.pid;return(0,i._)((0,o._)({},e),{bindInfo:(0,i._)((0,o._)({},e.bindInfo),(0,r._)({},u,(0,i._)((0,o._)({},e.bindInfo[u]),{pid:d})))})}if(t.type===s.SET_PINDUODUO_BIND_INFO.success){var p=t.payload.pid;return(0,i._)((0,o._)({},e),{bindInfo:(0,i._)((0,o._)({},e.bindInfo),{pinduoduo:(0,i._)((0,o._)({},e.bindInfo.pinduoduo),{pid:p})})})}if(t.type===s.REMOVE_BIND_INFO.success){var f=t.meta.source;return(0,i._)((0,o._)({},e),{bindInfo:(0,i._)((0,o._)({},e.bindInfo),(0,r._)({},f,(0,i._)((0,o._)({},e.bindInfo[f]),{pid:"",store:{}})))})}if(t.type===s.GET_MEMBER_CATEGORY.success)return(0,i._)((0,o._)({},e),{memberCategoryList:t.payload.data});if(t.type===s.SET_MEMBER_CATEGORY.success){var h=t.meta.categoryList;return(0,i._)((0,o._)({},e),{memberCategoryList:h})}if(t.type===s.GET_PRODUCER.success)return(0,i._)((0,o._)({},e),{producerList:t.payload.data});if(t.type===s.CLEAN_CATEGORY)return(0,i._)((0,o._)({},e),{categoryList:[]});if(t.type===s.GET_CATEGORY.success)return(0,i._)((0,o._)({},e),{categoryList:t.payload.data});if(t.type===s.GET_SECONDARY_CATEGORY.success){var _=t.meta.categoryId;return(0,i._)((0,o._)({},e),{categoryList:e.categoryList.map(function(e){return e.id===_?(0,i._)((0,o._)({},e),{categoryList:t.payload.data}):e})})}if(t.type===s.LOAD_LIST.request){var m=t.meta.key;return(0,i._)((0,o._)({},e),{lists:(0,i._)((0,o._)({},e.lists),(0,r._)({},m,(0,i._)((0,o._)({},e.lists[m]),{isLoading:!0})))})}if(t.type===s.LOAD_LIST.success){var g=t.meta.key,T=t.payload,E=T.data,y=T.paging,C=y.next,S=y.isEnd;return(0,i._)((0,o._)({},e),{lists:(0,i._)((0,o._)({},e.lists),(0,r._)({},g,{data:(0,a._)(e.lists[g].data||[]).concat((0,a._)(E)),paging:{next:C,isEnd:S},isLoading:!1}))})}if(t.type===s.LOAD_LIST.failure){var I=t.meta.key;return(0,i._)((0,o._)({},e),{lists:(0,i._)((0,o._)({},e.lists),(0,r._)({},I,(0,i._)((0,o._)({},e.lists[I]),{isLoading:!1})))})}if(t.type===s.REMOVE_RECENT_ADDED_GOODS){var A,b,w=t.meta.skuid,Z=e.lists.recentAddedGoods;return Z?(0,i._)((0,o._)({},e),{lists:(0,i._)((0,o._)({},e.lists),{recentAddedGoods:(0,i._)((0,o._)({},Z),{data:null!==(b=null===(A=Z.data)||void 0===A?void 0:A.filter(function(e){return e.skuid!==w}))&&void 0!==b?b:[]})})}):e}if(t.type===s.LOAD_MCN_BANNER.success){var x=t.meta.stateKey,k=t.payload.data;return(0,i._)((0,o._)({},e),{banners:(0,i._)((0,o._)({},e.banners),(0,r._)({},x,k))})}if(t.type===s.AGREE_CONTRACT.success)return(0,i._)((0,o._)({},e),{protocolStatus:(0,i._)((0,o._)({},e.protocolStatus),{isAgreedNew:!0})});if(t.type===s.GET_MEMBER_STATUS.success){var R=t.payload,N=R.isAgreed,O=R.previousIsAgreed;return(0,i._)((0,o._)({},e),{protocolStatus:{isAgreedNew:N,isAgreedOld:O}})}if(t.type===s.LOAD_MCN_PERMISSION.success){var P=t.payload.probationCountdownDays;return(0,i._)((0,o._)({},e),{probationCountdownDays:P||0})}return e}},33530:function(e,t,n){"use strict";n.d(t,{$6:function(){return m},AW:function(){return p},ER:function(){return h},PO:function(){return _},UX:function(){return g},ZP:function(){return E},a9:function(){return d},ic:function(){return T},p1:function(){return f}});var r=n(87320),o=n(55164),i=n(57477),a=n(4785),c=n(4661),s=(0,c.FH)("menuIgnoreSet",["UNINTEREST_RECOMMEND","UNINTEREST_CONTENT","LOAD_FEEDBACK_CONTENT_TAGS","LOAD_BLOCKED_FEED_KEYWORDS","UPDATE_BLOCKED_FEED_KEYWORDS","BATCH_UPDATE_FEEDBACK_KEYWORDS","VERIFY_CUSTOM_FEED_KEYWORD","NO_RELEVANT_TO_RING"]),u=(0,c.co)("menuIgnoreSet",["TOGGLE_FILTER_MODAL"]),l={answer:"1",article:"2",zvideo:"3",pin:"5"};function d(e){var t=e.recommendId,n=e.contentType,o=e.contentId,i=e.uninterestType,c=e.feedDeliverType,u=void 0===c?"Normal":c;return function(e,c){var d=c(),p=d.topstory,f=d.entities,h=p.recommend.items.find(function(e){return e.id===t}).schema,_="".concat(h,"s"),m=f[_][t];return e({API:{types:s.UNINTEREST_RECOMMEND,endpoint:"/zrec-feedback/uninterested",method:"POST",body:(0,a.z)({scene_code:"RECOMMEND",content_type:l[n],content_token:o,uninterested_type:i,feed_deliver_type:u,desktop:!0})},UPDATE:{request:(0,r._)({},_,(0,r._)({},t,{isDelete:!0})),failure:(0,r._)({},_,(0,r._)({},t,m))}})}}function p(e){var t=e.contentType,n=e.contentId,r=e.uninterestType,o=e.feedDeliverType;return{API:{types:s.UNINTEREST_CONTENT,endpoint:"/zrec-feedback/uninterested",method:"POST",body:(0,a.z)({scene_code:"DETAIL_PAGE",content_type:l[t],content_token:n,uninterested_type:r,desktop:!0,feed_deliver_type:void 0===o?"Normal":o})}}}function f(e){var t=e.type,n=e.id,r=e.sceneCode,o=e.feedDeliverType;return{API:{types:s.LOAD_FEEDBACK_CONTENT_TAGS,endpoint:"/zrec-feedback/content-tags",query:{content_type:l[t],content_token:n,scene_code:void 0===r?"RECOMMEND":r,desktop:!0,feedback_type:"less_recommend",feed_deliver_type:void 0===o?"Normal":o}},meta:{type:t,id:n}}}function h(e){var t=e.sceneCode;return{API:{types:s.LOAD_BLOCKED_FEED_KEYWORDS,endpoint:"/zrec-feedback/block-keyword",query:(0,i._)((0,o._)({},t&&{scene_code:t}),{desktop:!0})}}}function _(e){var t=e.sceneCode,n=e.keywords;return{API:{types:s.UPDATE_BLOCKED_FEED_KEYWORDS,endpoint:"/zrec-feedback/block-keyword",method:"PUT",body:{scene_code:void 0===t?"RECOMMEND":t,keywords:n,desktop:!0}}}}function m(e){var t=e.sceneCode,n=e.type,o=e.id,i=e.tags,a=e.keywords,c=e.recommendId,u=e.feedDeliverType,d=void 0===u?"Normal":u;return"RECOMMEND"===t&&c?function(e,u){var p=u(),f=p.topstory,h=p.entities,_=f.recommend.items.find(function(e){return e.id===c}).schema,m="".concat(_,"s"),g=h[m][c];return e({API:{types:s.BATCH_UPDATE_FEEDBACK_KEYWORDS,endpoint:"/zrec-feedback/content/sub/agg/feedback",method:"POST",body:{scene_code:t,content_type:l[n],content_token:o,content_tags:i,keywords:a,feed_deliver_type:d,desktop:!0}},UPDATE:{request:(0,r._)({},m,(0,r._)({},c,{isDelete:!0})),failure:(0,r._)({},m,(0,r._)({},c,g))}})}:{API:{types:s.BATCH_UPDATE_FEEDBACK_KEYWORDS,endpoint:"/zrec-feedback/content/sub/agg/feedback",method:"POST",body:{scene_code:t,content_type:l[n],content_token:o,content_tags:i,keywords:a,feed_deliver_type:d,desktop:!0}}}}function g(e){var t=e.sceneCode,n=e.keyword;return{API:{types:s.VERIFY_CUSTOM_FEED_KEYWORD,endpoint:"/zrec-feedback/block-keyword-verify",query:{scene_code:void 0===t?"RECOMMEND":t,keyword:n,desktop:!0}},NOTIFICATION:{failure:function(e){return e.message}}}}function T(e){return{type:u.TOGGLE_FILTER_MODAL,payload:e}}function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.payload,a=t.meta;switch(t.type){case s.LOAD_FEEDBACK_CONTENT_TAGS.success:var c=a.type,l=a.id;return(0,i._)((0,o._)({},e),(0,r._)({},"".concat(c,"-").concat(l),(0,i._)((0,o._)({},e["".concat(c,"-").concat(l)]),{data:n.data})));case u.TOGGLE_FILTER_MODAL:var d=t.payload;return(0,i._)((0,o._)({},e),{showFilterModal:(0,o._)({},e.showFilterModal,d)})}return e}},38030:function(e,t,n){"use strict";n.d(t,{EV:function(){return T},Lw:function(){return E},fg:function(){return y},nB:function(){return C}});var r,o,i,a,c,s,u=n(87320),l=n(55164),d=n(57477),p=n(49899);n(74135);var f=n(55536),h=n(28953),_=n(58909),m=n(4661),g=(0,l._)({},(0,m.FH)("message",["GET_INBOXES","ADD","MARK_READ","UPDATE_COMMENTPERMISSION","UPDATE_RESHIPMENTSETTINGS"]),(0,m.co)("message",["CURRENT_TAB","INBOX_UNREAD_COUNT"]));function T(e){return function(t,n){var r=n(),o=r.messages,i=r.messages.currentTab,a=(!e&&o.data[i]||{}).next;return t({reFetch:e,currentTab:i,API:{types:g.GET_INBOXES,endpoint:a||("stranger"===i?"stranger_inbox":"inbox")},schema:h.l.MESSAGE_ARRAY})}}function E(e){return{currentTab:e,type:g.CURRENT_TAB}}function y(){return function(e,t){var n=t(),r=n.entities.messages,o=n.messages,i=o.currentTab,a=o.data[i].ids.filter(function(e){return r[e].unreadCount>0});return a.length?e({API:{types:g.MARK_READ,endpoint:"messages/actions/mark-as-read",method:"POST",body:{type:i,tokens:a}}}):null}}function C(e){var t=e.event_name,n=e.data;if("INBOX_UNREAD_COUNT"===t)return{type:g.INBOX_UNREAD_COUNT,payload:n}}t.ZP=(0,f.combineReducers)({data:(r=g.GET_INBOXES,o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case i:if(t.reFetch)return s;return(0,d._)((0,l._)({},e),{isFetching:!0});case a:var n=t.result,r=t.next,o=t.isDrained,u=e.ids;return(0,d._)((0,l._)({},e),{isFetching:!1,isDrained:o,next:r,ids:(0,p._)(u).concat((0,p._)(n.filter(function(e){return!u.includes(e)})))});case c:return(0,d._)((0,l._)({},e),{isFetching:!1,isDrained:!0});default:return e}},i=r.request,a=r.success,c=r.failure,s={isFetching:!1,isDrained:!1,ids:[]},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.currentTab;switch(n){case i:case a:case c:return(0,d._)((0,l._)({},e),(0,u._)({},r,o(e[r],t)));default:return e}}),currentTab:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common",t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.currentTab;return n===g.CURRENT_TAB?r:e},messageCount:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===g.INBOX_UNREAD_COUNT?r:n===_.Hp.GET.success?t.payload.messagesCount:e}})},67927:function(e,t,n){"use strict";n.d(t,{HR:function(){return T},V8:function(){return s},XR:function(){return p},ZP:function(){return E},_X:function(){return _},c0:function(){return m},zQ:function(){return u}});var r=n(87320),o=n(55164),i=n(57477),a=n(31824),c=(0,n(4661).co)("notification",["SHOW","CLEAR"]),s="global",u="comment",l="askQuestion",d="editQuestion",p="出错了！请稍后再试。",f={},h=[s,l,d,u],_=(0,a.P1)(function(e){return e.notification},function(e){return h.reduce(function(t,n){var r=e[n];return!t&&r||r&&r.timestamp>t.timestamp?r:t},null)});function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"white",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s,r=arguments.length>3?arguments[3]:void 0;return{type:c.SHOW,NOTIFICATION:{key:n,text:e,theme:t,zaProps:r}}}function g(e){return e.err?e.err.payload:e.result?e.result.error:null}function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p,n=e||{},r=n.code,o=n.message;return f[r]||o||t}function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.requestMethod,p=t.NOTIFICATION;if(n===c.CLEAR){var f=p.key;return(0,i._)((0,o._)({},e),(0,r._)({},f,null))}if(p&&!0!==p){var h=p.text,_=p.theme,m=p.success,E=p.failure,y=p.key,C=void 0===y?s:y,S=p.zaProps;if(h&&_)return(0,i._)((0,o._)({},e),(0,r._)({},C,{text:h,theme:_,timestamp:Date.now(),zaProps:S}));if(m&&n.endsWith("success")){var I="function"==typeof m?m(t.payload):m;return(0,i._)((0,o._)({},e),(0,r._)({},C,(0,o._)({text:"string"==typeof I&&I,theme:"white",timestamp:Date.now(),zaProps:S},I)))}if(E&&n.endsWith("failure")){var A=g(t),b="function"==typeof E?E(A,t):E;if(!b)return e;var w=T(A,b);return(0,i._)((0,o._)({},e),(0,r._)({},C,(0,o._)({text:w,theme:C===u||C===l||C===d?"red-ghost":"red",timestamp:Date.now(),zaProps:S},b)))}return e}if(!1!==p&&n.endsWith("failure")&&"GET"!==(void 0===a?"GET":a)){var Z=T(g(t));return(0,i._)((0,o._)({},e),(0,r._)({},s,{text:Z,theme:"red",timestamp:Date.now()}))}return e}},84210:function(e,t,n){"use strict";n.d(t,{Gm:function(){return V},ZP:function(){return et},J2:function(){return q},R8:function(){return X},XD:function(){return W},hr:function(){return N},_u:function(){return O},t:function(){return R},ck:function(){return P},cR:function(){return H}});var r=n(87320),o=n(55164),i=n(57477),a=n(71728),c=n(49899),s=n(74135),u=n(84),l=n(55536),d=n(28953),p=n(46467),f=n(44900),h=n(84054),_=n.n(h),m=n(80714),g=n(4661);function T(e){return e.id||e.key||"default"}var E=n(25809),y=n(10886),C=n(69906),S=n(40195),I=n(76741),A=n(28814),b=new u.fK.Array(d.l.ZVIDEO),w=new u.fK.Entity("lineComments",{},{idAttribute:"id",processStrategy:function(e){return e}}),Z=new u.fK.Array(w),x=(0,o._)({},(0,g.FH)("people",["GET","GET_MEMBER","GET_ACTIVITIES","GET_PUBLICATIONS","GET_ANSWERS","GET_ANSWERS_SORT_BY_VOTES","GET_ANSWERS_INCLUDED","GET_ZVIDEOS","GET_ARTICLES","GET_ARTICLES_SORT_BY_VOTES","GET_ARTICLES_INCLUDED","GET_PINS","GET_COLUMNS","GET_QUESTIONS","GET_COMMERCIAL_QUESTIONS","GET_FAVLISTS","GET_FOLLOWINGS","GET_FOLLOWERS","GET_FOLLOWING_COLUMNS","GET_FOLLOWING_QUESTIONS","GET_FOLLOWING_FAVLISTS","GET_FOLLOWING_TOPICS","GET_RELATIONS_VOTED","GET_RELATIONS_THANKED","GET_VOTE_ANSWERS","GET_VOTED_ANSWERS","GET_THANK_ANSWERS","GET_THANKED_ANSWERS","GET_IKNOW_FOLLOWERS","GET_TOPIC_ANSWERS","GET_ALL_FAVLISTS","GET_BRANDS","GET_CREATIONS","GET_CREATIONS_SORT_BY_VOTES","GET_CREATIONS_FEED","GET_INFINITY_INFO","UPDATE","UPDATE_SHIELD","DELETE_COLUMN","GET_BATCH_USERS","GET_PROFILE_INFINITY","GET_LINE_COMMENTS"]),(0,g.co)("people",["CHANGE_ANSWER_ORDER","CHANGE_ARTICLE_ORDER","CHANGE_ANSWERS_TOPIC","MARK_USER_STATUS","CLEAR_CREATION_FEED","TOGGLE_USER_BLOCKING"]));function k(e,t){return function(n,c){var s=c().entities.users[e],u=("string"==typeof t?{include:t}:t)||{},l=u.include,p=u.types,f=u.shouldOmitBadgeTitle,h=(0,a._)(u,["include","types","shouldOmitBadgeTitle"]);return n((0,o._)({API:{types:p||x.GET_MEMBER,endpoint:"members/".concat(encodeURIComponent(e)),query:{include:l}},schema:d.l.USER,UPDATE:{success:function(t){var n,a,c=(null==s?void 0:null===(n=s.badgeV2)||void 0===n?void 0:n.title)&&f&&(null===(a=t.badgeV2)||void 0===a?void 0:a.title);return{users:(0,r._)({},e,c?(0,i._)((0,o._)({},t),{badgeV2:(0,i._)((0,o._)({},t.badgeV2),{title:s.badgeV2.title})}):t)}}}},h))}}function R(e,t){return{type:x.TOGGLE_USER_BLOCKING,UPDATE:{update:{users:(0,r._)({},e,{isBlocking:t})}}}}function N(e){var t=e.urlToken,n=e.includeErrorStatus,o=e.shouldOmitBadgeTitle;return function(e){return e(k(t,{include:"xinzhi_creator,juror,locations,employments,gender,educations,business,mcn_company,voteup_count,thanked_Count,follower_count,following_count,cover_url,following_topic_count,following_question_count,following_favlists_count,following_columns_count,avatar_hue,answer_count,zvideo_count,articles_count,pins_count,question_count,columns_count,commercial_question_count,favorite_count,favorited_count,line_comment_count,logs_count,included_answers_count,included_articles_count,included_text,message_thread_token,account_status,is_intelligence,is_active,is_bind_phone,is_force_renamed,is_privacy_protected,is_blocking,is_blocked,hidden_following_members_by_user,is_following,is_followed,mutual_followees_count,vote_to_count,vote_from_count,thank_to_count,thank_from_count,thanked_count,description,hosted_live_count,participated_live_count,allow_message,widgets,realname,institution,industry_category,org_name,org_homepage,is_org_createpin_white_user,is_navigator,badge[?(type=best_answerer)].topics",types:x.GET,NOTIFICATION:!1,shouldOmitBadgeTitle:o})).catch(function(o){var i=o.payload,a=(void 0===i?{}:i).message;return n?e({type:x.MARK_USER_STATUS,UPDATE:{update:{users:(0,r._)({},t,{errorMessage:a})}}}):Promise.reject(o)})}}function O(e){return k(e,{include:"allow_message,is_followed,is_following,is_org,is_blocking,employments,answer_count,follower_count,articles_count,gender,badge[?(type=best_answerer)].topics",shouldOmitBadgeTitle:!0})}function P(e,t){return function(n,o){var i=o(),a=i.entities.users,c=i.currentUser,u=a[c],l=(0,s.decamelizeKeys)(t||e);return n({API:{types:x.UPDATE,endpoint:"me",method:"PUT",query:{include:"".concat(Object.keys(l).join(","),",cover_url,verify_apply")},fetchOptions:{zsEncrypt:!0,body:l}},UPDATE:{request:{users:(0,r._)({},c,e||u)},success:function(e){return{users:(0,r._)({},c,e)}},failure:{users:(0,r._)({},c,u)}}})}}var D=(0,r._)({},m.Z.isMobileEntry?"mobile":"desktop",!0);function L(e){var t=e.urlToken,n=e.topicId,r=e.types,i=e.resource,a=void 0===i?"answers":i,c=e.offset,s=void 0===c?0:c,u=e.sortBy,l=e.endpoint,p=e.limit,f=void 0===p?C.W2:p;return{urlToken:t,topicId:n,API:(0,o._)({types:r},l?{endpoint:l}:{endpoint:"members/".concat(encodeURIComponent(t),"/").concat(a),query:{include:"data[*].is_normal,admin_closed_comment,reward_info,is_collapsed,annotation_action,annotation_detail,collapse_reason,collapsed_by,suggest_edit,comment_count,can_comment,content,editable_content,attachment,voteup_count,reshipment_settings,comment_permission,created_time,updated_time,review_info,excerpt,paid_info,reaction_instruction,is_labeled,label_info,relationship.is_authorized,voting,is_author,is_thanked,is_nothelp,reaction,vessay_info;data[*].author.badge[?(type=best_answerer)].topics;data[*].author.kvip_info;data[*].author.vip_info;data[*].question.has_publishing_draft,relationship",offset:s,limit:f,sortBy:void 0===u?"created":u,ws_qiangzhisafe:"0"}}),limit:f,offset:s,schema:d.l.ANSWER_ARRAY}}function M(e,t){var n=t.endpoint,r=t.sortBy,o=void 0===r?"created":r,i=t.offset,a=t.limit,c={urlToken:e,endpoint:n,offset:i,limit:void 0===a?C.W2:a,types:{created:x.GET_ANSWERS,voteups:x.GET_ANSWERS_SORT_BY_VOTES,included:x.GET_ANSWERS_INCLUDED}[o]};return"included"===o?(c.resource="marked-answers",c.sortBy="created"):c.sortBy=o,L(c)}var B=_()({similar_zvideo:!0,creation_relationship:!0,reaction_instruction:!0,reaction:!0});function U(e,t){var n=t.endpoint,r=t.sortBy,i=void 0===r?"created":r,a=t.offset,c=void 0===a?0:a,s=t.limit,u=void 0===s?C.W2:s,l={created:x.GET_ARTICLES,voteups:x.GET_ARTICLES_SORT_BY_VOTES,included:x.GET_ARTICLES_INCLUDED};return{urlToken:e,offset:c,limit:u,API:(0,o._)({types:l[i]},n?{endpoint:n}:{endpoint:"members/".concat(encodeURIComponent(e),"/").concat("included"===i?"included-articles":"articles"),query:{include:"data[*].comment_count,suggest_edit,is_normal,thumbnail_extra_info,thumbnail,can_comment,comment_permission,admin_closed_comment,content,voteup_count,created,updated,upvoted_followees,voting,review_info,reaction_instruction,is_labeled,label_info,reaction,vessay_info;data[*].author.badge[?(type=best_answerer)].topics;data[*].author.kvip_info;data[*].author.vip_info;",offset:c,limit:u,sortBy:i,ws_qiangzhisafe:"0"}}),schema:d.l.ARTICLE_ARRAY}}function G(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.endpoint,r=t.offset,i=void 0===r?0:r,a=t.limit,c=void 0===a?C.VZ:a,s=t.isAll;return{urlToken:e,API:(0,o._)({types:s?x.GET_ALL_FAVLISTS:x.GET_FAVLISTS},n?{endpoint:n}:{endpoint:"people/".concat(encodeURIComponent(e),"/collections"),query:{include:"data[*].updated_time,answer_count,follower_count,creator,description,is_following,comment_count,created_time;data[*].creator.kvip_info;data[*].creator.vip_info",offset:i,limit:c}}),offset:i,schema:d.l.FAVLIST_ARRAY}}function F(e){var t=e.urlToken,n=e.resource,r=e.types,i=e.endpoint,a=e.offset,c=e.limit,s=e.page;return{urlToken:t,API:(0,o._)({types:r},i?{endpoint:i}:{endpoint:"members/".concat(encodeURIComponent(t),"/").concat(n),query:{include:"data[*].answer_count,articles_count,gender,follower_count,is_followed,is_following,badge[?(type=best_answerer)].topics",offset:a,limit:c}}),offset:a,limit:c,page:s,schema:d.l.USER_ARRAY}}function H(e,t){return function(n,o){var i=o().entities.users[e];return n({API:{types:x.UPDATE_SHIELD,endpoint:"members/".concat(encodeURIComponent(e),"/actions/block"),method:t?"POST":"DELETE"},UPDATE:{request:{users:(0,r._)({},e,{isBlocking:t})},failure:{users:(0,r._)({},e,i)}}})}}function z(e,t){var n=t.topicId,r=t.sortBy,i=void 0===r?"created":r,a=t.offset,c=void 0===a?0:a,s=t.limit,u=void 0===s?C.W2:s,l=t.endpoint,p={created:x.GET_CREATIONS,votenum:x.GET_CREATIONS_SORT_BY_VOTES};return{urlToken:e,offset:c,limit:u,topicId:n,API:(0,o._)({types:p[i]},l?{endpoint:l}:{endpoint:"members/".concat(encodeURIComponent(e),"/topics/").concat(n,"/creations"),query:{offset:c,limit:u,sortBy:i}}),schema:d.l.CREATION_ARRAY}}function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="/members/".concat(encodeURIComponent(e),"/profile/creations/feed"),i=t.type,a=void 0===i?"all":i;return function(e,i){var c,s=null===(c=i().people.creationsFeed)||void 0===c?void 0:c[a],u=((null==s?void 0:s.paging)||{}).next;return e({meta:{contentType:a},API:(0,o._)({types:x.GET_CREATIONS_FEED},u?{endpoint:u}:{endpoint:r,query:t}),FAILSAFE:n})}}function V(){return{type:x.CLEAR_CREATION_FEED}}function W(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.offset,a=n.limit,c=n.page,s=n.topicId;return function(n,u){var l,p,f,h,_,g,T,E,y,S,I,A,w,k,R,N,O,P,H,q,V,W,X,K,j,Y,Q,J,$,ee,et,en,er,eo,ei,ea,ec,es,eu,el,ed,ep,ef,eh,e_,em,ev,eg,eT,eE,ey,eC,eS,eI,eA,eb,ew,eZ,ex,ek,eR,eN,eO,eP,eD,eL,eM,eB,eU,eG,eF,eH,ez,eq,eV,eW,eX,eK,ej,eY,eQ,eJ,e$,e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,te,tt,tn,tr,to,ti=u(),ta=ti.people,tc=ti.currentUser,ts=(ta["".concat(t,"ByUser")][e]||{}).next,tu=r||!ts?{offset:r,limit:a,page:c}:{endpoint:ts,page:c};switch(t){case"activities":return n({urlToken:l=e,API:{types:x.GET_ACTIVITIES,endpoint:ts||"v3/moments/".concat(encodeURIComponent(l),"/activities"),query:!ts&&(0,i._)((0,o._)({limit:C.W2},D),{ws_qiangzhisafe:"0"}),headers:{"X-API-VERSION":"3.0.40"}},FAILSAFE:{timeout:3e3},schema:d.l.ACTIVITY_ARRAY});case"answers":return n(M(e,tu));case"answersSortByVotes":return n(M(e,(0,o._)({sortBy:"voteups"},tu)));case"answersIncluded":return n(M(e,(0,o._)({sortBy:"included"},tu)));case"votedAnswers":return n((p=e,f=tu.endpoint,L({urlToken:p,endpoint:f,offset:void 0===(h=tu.offset)?0:h,limit:void 0===(_=tu.limit)?C.W2:_,types:x.GET_VOTED_ANSWERS,resource:"relations/voted"})));case"thankedAnswers":return n((g=e,T=tu.endpoint,L({urlToken:g,endpoint:T,offset:void 0===(E=tu.offset)?0:E,limit:void 0===(y=tu.limit)?C.W2:y,types:x.GET_THANKED_ANSWERS,resource:"relations/thanked"})));case"voteAnswers":return n((S=e,I=tu.endpoint,L({urlToken:S,endpoint:I,offset:void 0===(A=tu.offset)?0:A,limit:void 0===(w=tu.limit)?C.W2:w,types:x.GET_VOTE_ANSWERS,resource:"relations/vote"})));case"thankAnswers":return n((k=e,R=tu.endpoint,L({urlToken:k,endpoint:R,offset:void 0===(N=tu.offset)?0:N,limit:void 0===(O=tu.limit)?C.W2:O,types:x.GET_THANK_ANSWERS,resource:"relations/thank"})));case"topicAnswers":return n((P=e,q=(H=(0,o._)({topicId:s},tu)).endpoint,V=H.topicId,L({topicId:V,urlToken:P,endpoint:q,offset:void 0===(W=H.offset)?0:W,limit:void 0===(X=H.limit)?C.W2:X,types:x.GET_TOPIC_ANSWERS,resource:"topics/".concat(V,"/answers")})));case"zvideos":return n((K=e,Y=void 0===(j=tu.offset)?0:j,J=void 0===(Q=tu.limit)?C.W2:Q,{urlToken:K,API:{types:x.GET_ZVIDEOS,endpoint:"/members/".concat(encodeURIComponent(K),"/zvideos"),query:{offset:Y,limit:J,similarAggregation:!0,include:B}},offset:Y,limit:J,schema:b}));case"articles":return n(U(e,tu));case"pins":return n(($=e,ee=tu.endpoint,en=void 0===(et=tu.offset)?0:et,eo=void 0===(er=tu.limit)?C.W2:er,{urlToken:$,API:(0,o._)({types:x.GET_PINS},ee?{endpoint:ee}:{endpoint:"/v2/pins/".concat(encodeURIComponent($),"/moments"),query:{offset:en,limit:eo,includes:"data[*].upvoted_followees,admin_closed_comment,reaction"}}),offset:en,limit:eo,schema:d.l.PIN_ARRAY}));case"articlesSortByVotes":return n(U(e,(0,o._)({sortBy:"voteups"},tu)));case"articlesIncluded":return n(U(e,(0,o._)({sortBy:"included"},tu)));case"columns":return n((ei=e,ea=tu.endpoint,es=void 0===(ec=tu.offset)?0:ec,el=void 0===(eu=tu.limit)?C.VZ:eu,{urlToken:ei,offset:es,API:(0,o._)({types:x.GET_COLUMNS},ea?{endpoint:ea}:{endpoint:"members/".concat(encodeURIComponent(ei),"/column-contributions"),query:{include:"data[*].column.intro,followers,articles_count,voteup_count,items_count",offset:es,limit:el}}),schema:d.l.COLUMN_CONTRIBUTION_ARRAY}));case"questions":return n((ed=e,ep=tu.endpoint,eh=void 0===(ef=tu.offset)?0:ef,em=void 0===(e_=tu.limit)?C.VZ:e_,{urlToken:ed,offset:eh,API:(0,o._)({types:x.GET_QUESTIONS},ep?{endpoint:ep}:{endpoint:"members/".concat(encodeURIComponent(ed),"/questions"),query:{include:"data[*].created,answer_count,follower_count,author,admin_closed_comment",offset:eh,limit:em,ws_qiangzhisafe:"0"}}),schema:d.l.QUESTION_ARRAY}));case"commercialQuestions":return n((ev=e,eg=tu.endpoint,eE=void 0===(eT=tu.offset)?0:eT,eC=void 0===(ey=tu.limit)?C.VZ:ey,{urlToken:ev,offset:eE,API:(0,o._)({types:x.GET_COMMERCIAL_QUESTIONS},eg?{endpoint:eg}:{endpoint:"members/".concat(encodeURIComponent(ev),"/commercial-questions"),query:{include:"data[*].created,answer_count,follower_count,author,is_muted,question_type,admin_closed_comment",offset:eE,limit:eC}}),schema:d.l.COMMERCIAL_QUESTION_ARRAY}));case"favlists":return n(G(e,tu));case"following":return n((eS=e,eI=tu.endpoint,eA=tu.offset,ew=void 0===(eb=tu.limit)?C.VZ:eb,F({urlToken:eS,types:x.GET_FOLLOWINGS,resource:"followees",offset:void 0===eA?0:eA,endpoint:eI,limit:ew})));case"followers":return n((eZ=e,ex=tu.endpoint,ek=tu.offset,eN=void 0===(eR=tu.limit)?C.VZ:eR,eO=tu.page,F({urlToken:eZ,types:x.GET_FOLLOWERS,resource:"followers",endpoint:ex,offset:void 0===ek?0:ek,limit:eN,page:eO})));case"mutuals":return n((eP=e,eD=tu.endpoint,eL=tu.offset,eB=void 0===(eM=tu.limit)?C.VZ:eM,(0,i._)((0,o._)({},F({urlToken:eP,types:x.GET_IKNOW_FOLLOWERS,resource:"relations/mutuals",offset:void 0===eL?0:eL,endpoint:eD,limit:eB})),{NOTIFICATION:!1})));case"followingColumns":return n((eU=e,eG=tu.endpoint,eH=void 0===(eF=tu.offset)?0:eF,eq=void 0===(ez=tu.limit)?C.VZ:ez,{urlToken:eU,API:(0,o._)({types:x.GET_FOLLOWING_COLUMNS},eG?{endpoint:eG}:{endpoint:"members/".concat(encodeURIComponent(eU),"/following-columns"),query:{include:"data[*].intro,followers,articles_count,voteup_count,items_count",offset:eH,limit:eq}}),offset:eH,schema:d.l.COLUMN_ARRAY}));case"followingQuestions":return n((eV=e,eW=tu.endpoint,eK=void 0===(eX=tu.offset)?0:eX,eY=void 0===(ej=tu.limit)?C.VZ:ej,{urlToken:eV,API:(0,o._)({types:x.GET_FOLLOWING_QUESTIONS},eW?{endpoint:eW}:{endpoint:"members/".concat(encodeURIComponent(eV),"/following-questions"),query:{include:"data[*].created,answer_count,follower_count,author",offset:eK,limit:eY}}),offset:eK,schema:d.l.QUESTION_ARRAY}));case"followingFavlists":return n((eQ=e,eJ=tu.endpoint,e0=void 0===(e$=tu.offset)?0:e$,e2=void 0===(e1=tu.limit)?C.VZ:e1,{urlToken:eQ,API:(0,o._)({types:x.GET_FOLLOWING_FAVLISTS},eJ?{endpoint:eJ}:{endpoint:"members/".concat(encodeURIComponent(eQ),"/following-favlists"),query:{include:"data[*].updated_time,answer_count,follower_count,creator,description,is_following,comment_count,created_time",offset:e0,limit:e2}}),offset:e0,schema:d.l.FAVLIST_ARRAY}));case"followingTopics":return n((e3=e,e4=tu.endpoint,e6=void 0===(e5=tu.offset)?0:e5,e8=void 0===(e7=tu.limit)?C.VZ:e7,{urlToken:e3,API:(0,o._)({types:x.GET_FOLLOWING_TOPICS},e4?{endpoint:e4}:{endpoint:"/topics/".concat(encodeURIComponent(e3),"/following_topics_contributions"),root:"".concat(m.Z.fetchRoot.www,"/api/v5.1/"),query:{include:"data[*].topic.introduction",offset:e6,limit:e8}}),offset:e6,schema:d.l.TOPIC_CONTRIBUTION_ARRAY}));case"publications":return n(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.endpoint,r=t.offset,i=void 0===r?0:r;return{urlToken:e,API:(0,o._)({types:x.GET_PUBLICATIONS},n?{endpoint:n}:{root:m.Z.fetchRoot.api,endpoint:"/books/people/".concat(encodeURIComponent(e),"/publications"),query:{offset:i,limit:5}}),offset:i,schema:d.l.EBOOK_ARRAY,FAILSAFE:!1}}(e,tu));case"allFavlists":e=e||tc;var tl=(ta["".concat(t,"ByUser")][e]||{}).next;return n(G(e,(0,o._)({isAll:!0},{endpoint:tl})));case"creations":return n(z(e,(0,o._)({topicId:s,sortBy:"created"},tu)));case"creationsSortByVotes":return n(z(e,(0,o._)({topicId:s,sortBy:"votenum"},tu)));case"lineComments":return n((e9=e,te=tu.endpoint,tn=void 0===(tt=tu.offset)?0:tt,to=void 0===(tr=tu.limit)?C.W2:tr,function(e,t){var n=t().entities.users[e9],r=(null==n?void 0:n.id)||e9;return e({urlToken:e9,API:(0,o._)({types:x.GET_LINE_COMMENTS},te?{endpoint:te}:{endpoint:"members/".concat(encodeURIComponent(r),"/segments"),query:{content_type:"all",offset:tn,limit:to}}),offset:tn,limit:to,schema:Z})}));default:return Promise.reject(Error("Mismatched loadItems ".concat(t)))}}}function X(e){return{API:{types:x.GET_BRANDS,endpoint:"/brand/".concat(e,"/brands")}}}var K=(0,C.V6)(x.GET_COLUMNS,{mapActionToKey:function(e){return e.urlToken}}),j=(0,C.V6)(x.DELETE_COLUMN,{mapActionToKey:function(e){return e}}),Y=(0,C.V6)(x.GET_FOLLOWING_TOPICS,{mapActionToKey:function(e){return e.urlToken},additionalCaseTypes:[I.Hp.UPDATE_FOLLOW.success],additionalCase:function(e,t){if(t.type===I.Hp.UPDATE_FOLLOW.success){var n=t.topicId,r=e.ids,a=e.totals;if(!r.includes(n))return(0,i._)((0,o._)({},e),{totals:a+1,ids:[n].concat((0,c._)(r))})}return e}}),Q=(0,C.V6)(x.GET_TOPIC_ANSWERS,{mapActionToKey:function(e){return e.topicId}}),J=(0,C.V6)(x.GET_CREATIONS,{mapActionToKey:function(e){return e.topicId}}),$=(0,C.V6)(x.GET_CREATIONS_SORT_BY_VOTES,{mapActionToKey:function(e){return e.topicId}}),ee=function(e){return e.urlToken},et=(0,l.combineReducers)({profileStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x.GET.failure:case x.GET.success:return(0,i._)((0,o._)({},e),(0,r._)({},t.result,(0,i._)((0,o._)({},t.payload&&{token:{id:t.payload.id,urlToken:t.payload.urlToken}}),{isFetching:!1,isDrained:!0})));default:return e}},activitiesByUser:(0,C.Fd)(x.GET_ACTIVITIES,{mapActionToKey:ee}),answersByUser:(0,C.Fd)(x.GET_ANSWERS,{mapActionToKey:ee}),answersSortByVotesByUser:(0,C.Fd)(x.GET_ANSWERS_SORT_BY_VOTES,{mapActionToKey:ee}),answersIncludedByUser:(0,C.Fd)(x.GET_ANSWERS_INCLUDED,{mapActionToKey:ee}),votedAnswersByUser:(0,C.Fd)(x.GET_VOTED_ANSWERS,{mapActionToKey:ee}),thankedAnswersByUser:(0,C.V6)(x.GET_THANKED_ANSWERS,{mapActionToKey:ee}),voteAnswersByUser:(0,C.V6)(x.GET_VOTE_ANSWERS,{mapActionToKey:ee}),thankAnswersByUser:(0,C.V6)(x.GET_THANK_ANSWERS,{mapActionToKey:ee}),topicAnswersByUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,o=t.urlToken;return Object.values(x.GET_TOPIC_ANSWERS).includes(n)?(0,r._)({},o,Q(e[o],t)):e},zvideosByUser:(0,C.V6)(x.GET_ZVIDEOS,{mapActionToKey:ee}),articlesByUser:(0,C.Fd)(x.GET_ARTICLES,{mapActionToKey:ee}),articlesSortByVotesByUser:(0,C.Fd)(x.GET_ARTICLES_SORT_BY_VOTES,{mapActionToKey:ee}),articlesIncludedByUser:(0,C.Fd)(x.GET_ARTICLES_INCLUDED,{mapActionToKey:ee}),pinsByUser:(0,C.Fd)(x.GET_PINS,{mapActionToKey:ee}),questionsByUser:m.Z.isMobileEntry?(0,C.Fd)(x.GET_QUESTIONS,{mapActionToKey:ee,addSuccessType:S.Hp.ADD.success}):(0,C.V6)(x.GET_QUESTIONS,{mapActionToKey:ee,addSuccessType:S.Hp.ADD.success}),commercialQuestionsByUser:(0,C.V6)(x.GET_COMMERCIAL_QUESTIONS,{mapActionToKey:ee}),favlistsByUser:(0,C.V6)(x.GET_FAVLISTS,{mapActionToKey:ee,additionalCaseTypes:[E.Hp.ADD.success,E.Hp.UPDATE.success,E.Hp.DELETE.success],additionalCase:E.Nn,addSuccessType:p.Z.ADD.SUCCESS}),followingByUser:(0,C.V6)(x.GET_FOLLOWINGS,{mapActionToKey:ee,additionalCaseTypes:[A.cw.UPDATE_FOLLOWERS.success],additionalCase:function(e,t){var n=t.type,r=t.expect,a=t.userUrlToken;if(n===A.cw.UPDATE_FOLLOWERS.success&&r){var s=e.ids,u=e.totals;if(!s.includes(a))return(0,i._)((0,o._)({},e),{totals:u+1,ids:[a].concat((0,c._)(s))})}return e}}),followersByUser:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{error:void 0,errorPayload:null,isLoadedOnce:!1,isDrained:!1,isFetching:!0,idsByPage:{},totals:0,currentPage:1,limit:20},t=arguments.length>1?arguments[1]:void 0,n=t.type,l=t.page;switch(n){case a:return(0,i._)((0,o._)({},e),{isFetching:!0,error:void 0,errorPayload:null});case s:var d=t.totals,f=t.isDrained,h=t.result,m=t.page,T=void 0===m?void 0===l?1:l:m,E=t.limit,y=(0,i._)((0,o._)({},e.idsByPage),(0,r._)({},T,void 0===h?[]:h));return(0,i._)((0,o._)({},e),{isDrained:f,isLoadedOnce:!0,isFetching:!1,idsByPage:y,totals:d,limit:E,currentPage:T});case u:return(0,i._)((0,o._)({},e),{error:Error("请求失败"),errorPayload:t.err||t.error,isLoadedOnce:!0,isFetching:!1,isDrained:!0});case _:var C=e.idsByPage,S=e.totals,I=e.currentPage,A=t.result,b=g?1:I,w=C[b]||[],Z=(0,i._)((0,o._)({},C),(0,r._)({},b,g?[A].concat((0,c._)(w)):(0,c._)(w).concat([A])));return(0,i._)((0,o._)({},e),{totals:S+1,idsByPage:Z});default:if(p)return p(e,t);return e}},a=e.request,s=e.success,u=e.failure,l=t.mapActionToKey,d=void 0===l?T:l,p=t.additionalCase,f=t.additionalCaseTypes,h=t.addSuccessType,_=void 0===h?"addSuccessType does not exist":h,m=t.addAtTop,g=void 0===m||m,E=(0,c._)(Object.values(e)).concat((0,c._)(void 0===f?[]:f),[_]);return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(E.includes(t.type)){var a=d(t);if(void 0!==a)return(0,i._)((0,o._)({},e),(0,r._)({},a,n(e[a],t)))}return e}}(x.GET_FOLLOWERS,{mapActionToKey:ee}),mutualsByUser:(0,C.Fd)(x.GET_IKNOW_FOLLOWERS,{mapActionToKey:ee}),followingColumnsByUser:(0,C.V6)(x.GET_FOLLOWING_COLUMNS,{mapActionToKey:ee,additionalCaseTypes:[y.Pu.UPDATE_FOLLOW.success],additionalCase:function(e,t){var n=t.type,r=t.expect,a=t.columnId;if(n===y.Pu.UPDATE_FOLLOW.success&&r){var s=e.ids,u=e.totals;if(!s.includes(a))return(0,i._)((0,o._)({},e),{totals:u+1,ids:[a].concat((0,c._)(s))})}return e}}),followingQuestionsByUser:(0,C.V6)(x.GET_FOLLOWING_QUESTIONS,{mapActionToKey:ee,addSuccessType:S.Hp.ADD.success}),followingFavlistsByUser:(0,C.V6)(x.GET_FOLLOWING_FAVLISTS,{mapActionToKey:ee}),followingTopicsByUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.urlToken;if(Object.values(x.GET_FOLLOWING_TOPICS).includes(n)){var c=t.result||[];t.result=c.map(function(e){return e.topic});var s=e[a]||{isFetching:!1,isDrained:!1,totals:0,ids:[],contributions:{}};return Y((0,i._)((0,o._)({},e),(0,r._)({},a,(0,i._)((0,o._)({},s),{contributions:c.reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t.topic,t.contributionsCount))},s.contributions)}))),t)}return e},publicationsByUser:(0,C.Fd)(x.GET_PUBLICATIONS,{mapActionToKey:ee}),columnsByUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.urlToken;if(Object.values(x.DELETE_COLUMN).includes(n)){var c=t.columnId,s=t.memberToken,u=e[s].ids;return j((0,i._)((0,o._)({},e),(0,r._)({},s,(0,i._)((0,o._)({},e[s]),{ids:u.map(function(e){if(e!==c)return e})}))),t)}if(Object.values(x.GET_COLUMNS).includes(n)){var l=t.result||[];t.result=l.map(function(e){return e.column});var d=e[a]||{isFetching:!1,isDrained:!1,totals:0,ids:[],contributions:{}};return K((0,i._)((0,o._)({},e),(0,r._)({},a,(0,i._)((0,o._)({},d),{contributions:l.reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t.column,t.contributionsCount))},d.contributions)}))),t)}return e},allFavlistsByUser:f.f,brands:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return t.type===x.GET_BRANDS.success?t.payload.data:e},creationsByUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,o=t.urlToken;return Object.values(x.GET_CREATIONS).includes(n)?(0,r._)({},o,J(e[o],t)):e},creationsSortByVotesByUser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,o=t.urlToken;return Object.values(x.GET_CREATIONS_SORT_BY_VOTES).includes(n)?(0,r._)({},o,$(e[o],t)):e},creationsFeed:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case x.GET_CREATIONS_FEED.request:var c=t.meta.contentType,s=e[c]||{isFetching:!0,isDrained:!1,paging:{},ids:[],items:[]};return(0,i._)((0,o._)({},e),(0,r._)({},c,(0,C.TS)(s,{isFetching:!0})));case x.GET_CREATIONS_FEED.failure:var u=t.meta.contentType;return(0,i._)((0,o._)({},e),(0,r._)({},u,(0,C.TS)(e[u],{isFetching:!1,isDrained:!0})));case x.GET_CREATIONS_FEED.success:var l=a.data,d=a.paging;if(!l||!d)return e;var p=t.meta.contentType,f=d.isStart,h=d.isEnd,_=e[p],m=l.map(function(e){var t=e.content,n=e.notiSubtype;return(0,i._)((0,o._)({},t),{contentType:n})}).filter(function(e){var t=e.urlToken;return!t||!_.ids.includes(t)}),g=(0,C.TS)(_,{isFetching:!1,isDrained:!f&&h||f&&h,paging:d,ids:m.map(function(e){return e.urlToken}),items:m});return(0,i._)((0,o._)({},e),(0,r._)({},p,g));case x.CLEAR_CREATION_FEED:return{};default:return e}},lineCommentsByUser:(0,C.Fd)(x.GET_LINE_COMMENTS,{mapActionToKey:ee}),infinity:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===x.GET_INFINITY_INFO.success){var n=t.meta,a=t.payload;return(0,i._)((0,o._)({},e),(0,r._)({},n,a))}return e},batchUsers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===x.GET_BATCH_USERS.success){var n=t.payload;return(0,o._)({},e,n)}return e},profileInfinity:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;if(t.type===x.GET_PROFILE_INFINITY.success){var n=t.payload;return(0,o._)({},e,n)}return e}})},70236:function(e,t,n){"use strict";n.d(t,{A0:function(){return f},Gr:function(){return T},JS:function(){return g},Jb:function(){return p},Qw:function(){return y},T8:function(){return h},ZQ:function(){return C},iJ:function(){return E},q$:function(){return m},uC:function(){return _}});var r=n(87320),o=n(55164),i=n(57477),a=n(28953),c=n(80714),s=n(4661),u=n(74167),l=n(69906),d=n(67927),p=(0,s.FH)("pin",["LIKE","REACTION","DELETE","GET_VOTERS","CREATE_PINS","GET_LINK_CONTENT","GET_PIN_CONTENT","LOAD_HOT_TOPIC","FETCH_RECOMMAND_TOPIC","ADD_TOPIC","UPDATE_VOTE_PIN","UPDATE_LIKE_PIN","LOAD_PIN_RELATION_ENDORSEMENT","GET_UPVOTERS","CHANGE_COMMENT_PERMISSION","GET_PAID_COLUMN_INFO","LOAD_TAGORE_CATEGORY"]);function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.notification,o=void 0===n||n;return function(t,n){var i=n().entities.pins[e],a=i.reaction,c=(void 0===a?{}:a).relation,s=!(void 0===c?{}:c).liked;return t({id:e,API:{types:p.UPDATE_LIKE_PIN,endpoint:"pins/".concat(e,"/likers"),method:s?"POST":"DELETE",body:{is_real_pin_like:!0}},UPDATE:{request:function(){var t=(0,u.c)(i,s);return{pins:(0,r._)({},e,t)}},failure:{pins:(0,r._)({},e,i)}},NOTIFICATION:{failure:!!o&&d.XR}})}}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.notification,o=void 0===n||n;return function(t,n){var i=n().entities.pins[e],a=i.likeCount,c=i.virtuals,s=(void 0===c?{}:c).isLiked;return t({id:e,API:{types:p.LIKE,endpoint:"pins/".concat(e,"/likers"),method:s?"delete":"post"},UPDATE:{request:{pins:(0,r._)({},e,{likeCount:a+(s?-1:1),virtuals:{isLiked:!s}})},failure:{pins:(0,r._)({},e,i)}},NOTIFICATION:{failure:!!o&&d.XR}})}}function _(e,t){return function(n,a){var c,s,u,l,d,f,h=a().entities,_=h.pins,m=h.users,g=(void 0===_?{}:_)[e],T=g.author||{},E=T.urlToken,y=null===(c=g.reaction)||void 0===c?void 0:null===(s=c.relation)||void 0===s?void 0:s.vote,C=y===t.toUpperCase(),S=0;return"up"===t&&(S="UP"===y?-1:1),"down"===t&&(S="UP"===y?-1:0),n({API:{types:p.UPDATE_VOTE_PIN,endpoint:"pins/".concat(e,"/voters/").concat(t),method:C?"DELETE":"POST",body:{not_sync_moments:!0}},UPDATE:{request:{pins:(0,r._)({},e,(0,i._)((0,o._)({},g),{reaction:(0,i._)((0,o._)({},g.reaction),{relation:(0,i._)((0,o._)({},g.reaction.relation),{vote:C?"Neutral":t.toUpperCase()}),statistics:(0,i._)((0,o._)({},g.reaction.statistics),{upVoteCount:(null!==(d=null===(u=g.reaction.statistics)||void 0===u?void 0:u.upVoteCount)&&void 0!==d?d:0)+S})})})),users:(0,r._)({},E,{voteupCount:(null!==(f=null===(l=(void 0===m?{}:m)[E])||void 0===l?void 0:l.voteupCount)&&void 0!==f?f:0)+S})},failure:{pins:(0,r._)({},e,g),users:(0,r._)({},E,T)}}})}}function m(e){return function(t,n){var o=n().entities.pins[e];return t({API:{types:p.DELETE,endpoint:"pins/".concat(e),method:"DELETE"},UPDATE:{request:{pins:(0,r._)({},e,{isDelete:!0})},failure:{pins:(0,r._)({},e,o)}}})}}function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.title,r=e.content,o=t.type,i=t.keyword;return{API:{types:p.FETCH_RECOMMAND_TOPIC,endpoint:"/content/publish/topics/recommend",root:"".concat(c.Z.fetchRoot.api),method:"POST",body:{title:n||"",content:r||""},query:{recommend_type:o||"pin",key_word:i||""}}}}function T(e){return{API:{types:p.ADD_TOPIC,endpoint:"/topics",method:"POST",body:{name:e}}}}function E(e){return{API:{types:p.LOAD_PIN_RELATION_ENDORSEMENT,endpoint:"/pins/".concat(e,"/relationship"),query:{desktop:!0}},meta:{id:e},FAILSAFE:!0}}function y(e){return function(t,n){var r=n().pins.upvoters,i=((void 0===r?{}:r)[e]||{}).next;return t({id:e,API:(0,o._)({types:p.GET_UPVOTERS},i?{endpoint:i}:{endpoint:"pins/".concat(e,"/upvoters"),query:{offset:0,limit:l.VZ}}),schema:a.l.USER_ARRAY})}}function C(e){return{API:{types:p.GET_PAID_COLUMN_INFO,endpoint:"/column/paid-column/card?content_type=pin&content_id=".concat(e),method:"GET"},id:e}}},30841:function(e,t,n){"use strict";n.d(t,{Gr:function(){return s.Gr},ZP:function(){return l},q$:function(){return s.q$},JS:function(){return s.JS},ZQ:function(){return s.ZQ},iJ:function(){return s.iJ},T8:function(){return s.T8},A0:function(){return s.A0},uC:function(){return s.uC}});var r=n(87320),o=n(55164),i=n(57477),a=n(55536),c=n(69906),s=n(70236);n(66263);var u=(0,a.combineReducers)({reviewing:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if("pins/SET_REVIEWING_ERROR"===t.type){var n=t.payload,a=n.id,c=n.error;return(0,i._)((0,o._)({},e),(0,r._)({},a,c))}return e},upvoters:(0,c.Fd)(s.Jb.GET_UPVOTERS),relationEndorsement:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.meta,c=t.payload;return n===s.Jb.LOAD_PIN_RELATION_ENDORSEMENT.success?(0,i._)((0,o._)({},e),(0,r._)({},a.id,c)):e},paidColumnInfo:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return n.type===s.Jb.GET_PAID_COLUMN_INFO.success?(0,i._)((0,o._)({},t),(0,r._)({},n.id,null===(e=n.payload)||void 0===e?void 0:e.data)):t}});(0,n(31824).P1)(function(e,t){return{pin:e.entities.pins[t],users:e.entities.users}},function(e){var t=e.pin,n=e.users;return t?"string"==typeof t.author?Object.assign({},t,{author:n[t.author]}):t:{}});var l=u},92638:function(e,t,n){"use strict";n.d(t,{Ug:function(){return k},ZP:function(){return R},oT:function(){return A},mh:function(){return w},ZK:function(){return S},dR:function(){return b},d9:function(){return I},U3:function(){return Z},iF:function(){return x}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(80714),s=n(4661),u=n(4667),l=n.n(u),d=n(84),p=function(e){return e.ringId||e.id},f=n(71728),h=n(94009),_=function(e){return Object.fromEntries(Object.entries(e).filter(function(e){var t=(0,h._)(e,2);return null!=(t[0],t[1])}))},m=function(e){var t,n;return e?_((0,i._)((0,o._)({},e),{myLevel:null!==(t=e.levelInfo)&&void 0!==t?t:e.myLevel,levelInfo:null!==(n=e.levelInfo)&&void 0!==n?n:e.myLevel})):e},g=function(e){if(e.__adapted)return e;var t=e.isFollow,n=e.followStatus,r=e.avatar,a=e.userToken,c=e.userId,s=e.hashId,u=e.ringHeadline,l=e.name,d=e.headline,p=e.isFollowing,h=e.isFollowed,g=e.avatarUrl,T=e.urlToken,E=e.url,y=e.id,C=(0,f._)(e,["isFollow","followStatus","avatar","userToken","userId","hashId","ringHeadline","name","headline","isFollowing","isFollowed","avatarUrl","urlToken","url","id"]);return{__adapted:!0,standardizedFields:_({name:l,urlToken:T||a,avatarUrl:r||g,headline:d,isFollowing:void 0!==p?p:void 0!==n?1===n||3===n:void 0!==t?t:void 0,isFollowed:3===n||2===n||h,id:y||s||c,url:E}),ringSpecificFields:m((0,i._)((0,o._)({},C),{ringHeadline:u||d}))}},T=l()(function(){return new d.fK.Entity("users",{},{idAttribute:"urlToken",processStrategy:function(e){return g(e).standardizedFields}})}),E=l()(function(){var e;return new d.fK.Entity("rings",{admins:new d.fK.Array(new d.fK.Object({urlToken:T(),ringUserKey:new d.fK.Entity("ringUsers",{ringId:E(),urlToken:T()},{idAttribute:function(t){var n,r;return n=e||t.ringId,r=t.urlToken||t.userToken,"".concat(n,"__").concat(r)},processStrategy:function(t){var n=g(t),r=n.standardizedFields,i=n.ringSpecificFields;return(0,o._)({urlToken:r,ringId:e||t.ringId},i)}})}))},{idAttribute:p,processStrategy:function(e,t){return Array.isArray(e.admins)?(0,i._)((0,o._)({},e),{admins:e.admins.map(function(e){var n=g(e),r=n.standardizedFields,i=n.ringSpecificFields;return{urlToken:e,ringUserKey:(0,o._)({isAdmin:!0,ringId:p(t),urlToken:r.urlToken},i)}})}):e}})}),y=(0,s.FH)("publishedModal",["GET_PUBLISHED_CONTENT_COUNT","GET_RELATED_RINGS","GET_RECOMMENDED_RINGS","GET_CAN_MESSAGE_USERS","GET_RING_SEARCH_RESULTS","GET_USER_SEARCH_RESULTS","GET_AI_TO_PIN_PERMISSION"]),C="publishedModal/CLEAR_SEARCH_RESULTS";function S(e,t){return{API:{types:y.GET_PUBLISHED_CONTENT_COUNT,endpoint:"creator/publish/feedback/v2?content_id=".concat(e,"&content_type=").concat(t)}}}function I(){return{API:{root:c.Z.fetchRoot.www,types:y.GET_RELATED_RINGS,endpoint:"/content/publish/configs?scene=ring_config"}}}function A(e,t){return{API:{root:c.Z.fetchRoot.api,types:y.GET_AI_TO_PIN_PERMISSION,endpoint:"/ai/generate/pin/permissions?content_id=".concat(e,"&content_type=").concat(t)}}}function b(e){return{meta:{pinId:e},API:{types:y.GET_RECOMMENDED_RINGS,endpoint:"/rings/v1/pin/recommend_rings?pin_id=".concat(e)},FAILSAFE:{timeout:3e3}}}function w(){return function(e,t){var n,r,o=((null===(n=t().publishedModal)||void 0===n?void 0:n.canMessageUsers)||{}).paging,i=null!==(r=null==o?void 0:o.next)&&void 0!==r?r:"/messages/should_chat_users";return e({API:{types:y.GET_CAN_MESSAGE_USERS,endpoint:i},FAILSAFE:{timeout:3e3}})}}function Z(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var o,i=((null===(o=r().publishedModal)||void 0===o?void 0:o.ringSearchResults)||{}).paging,a=!t&&(null==i?void 0:i.next)?i.next:"/rings/v1/editor/search?content=".concat(encodeURIComponent(e));return n({meta:{isReset:t},API:{types:y.GET_RING_SEARCH_RESULTS,endpoint:a},schema:[E()]})}}function x(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var o=(r().publishedModal.userSearchResults||{}).paging,i=!t&&(null==o?void 0:o.next)?o.next:"/content/publish/autocomplete/users?token=".concat(encodeURIComponent(e));return n({meta:{isReset:t},API:{types:y.GET_USER_SEARCH_RESULTS,endpoint:i}})}}function k(){return{type:C}}function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{relatedRings:[]},t=arguments.length>1?arguments[1]:void 0,n=t.payload,c=t.meta;switch(t.type){case y.GET_PUBLISHED_CONTENT_COUNT.success:return(0,i._)((0,o._)({},e),{publishedContentCount:n.data.creation.contentNum});case y.GET_RELATED_RINGS.success:var s,u,l=null==n?void 0:null===(s=n.data)||void 0===s?void 0:null===(u=s.ringConfig)||void 0===u?void 0:u.editorList;if(!l||!Array.isArray(l)||0===l.length)return(0,i._)((0,o._)({},e),{relatedRings:[]});var d=l.filter(function(e){return!!e.canSelect});return(0,i._)((0,o._)({},e),{relatedRings:d});case y.GET_AI_TO_PIN_PERMISSION.success:return(0,i._)((0,o._)({},e),{aiToPinPermission:n});case y.GET_RECOMMENDED_RINGS.success:var p,f=(n.rings||[]).filter(function(e){return!1!==e.canSelect}),h=c.pinId,_=null===(p=e.recommendedRings)||void 0===p?void 0:p[h],m=_&&_.data&&_.data.length>0?(0,a._)(_.data).concat((0,a._)(f)):f,g=new Map,T={data:m=m.filter(function(e){var t=e.id;return!(!t||g.has(t))&&(g.set(t,!0),!0)}),paging:n.paging||{isEnd:!0,isStart:!0,next:""}};return(0,i._)((0,o._)({},e),{recommendedRings:(0,i._)((0,o._)({},e.recommendedRings),(0,r._)({},h,T))});case y.GET_CAN_MESSAGE_USERS.success:var E=e.canMessageUsers,S=E&&E.data&&E.data.length>0?(0,a._)(E.data).concat((0,a._)(n.data)):n.data,I=new Map;return S=S.filter(function(e){var t=e.id;return!(!t||I.has(t))&&(I.set(t,!0),!0)}),(0,i._)((0,o._)({},e),{canMessageUsers:{data:S,paging:n.paging}});case y.GET_RING_SEARCH_RESULTS.success:var A=e.ringSearchResults,b=!(c||{}).isReset&&A&&A.data&&A.data.length>0?(0,a._)(A.data).concat((0,a._)(n.data)):n.data,w=new Map;return b=b.filter(function(e){var t=e.id;return!(!t||w.has(t))&&(w.set(t,!0),!0)}),(0,i._)((0,o._)({},e),{ringSearchResults:{data:b,paging:n.paging}});case y.GET_USER_SEARCH_RESULTS.success:var Z=e.userSearchResults,x=!(c||{}).isReset&&Z&&Z.data&&Z.data.length>0?(0,a._)(Z.data).concat((0,a._)(n.data)):n.data,k=new Map;return x=x.filter(function(e){var t=e.id;return!(!t||k.has(t))&&(k.set(t,!0),!0)}),(0,i._)((0,o._)({},e),{userSearchResults:{data:x,paging:n.paging}});case C:return(0,i._)((0,o._)({},e),{ringSearchResults:void 0,userSearchResults:void 0})}return e}},19680:function(e,t,n){"use strict";n.d(t,{F7:function(){return g},Lw:function(){return m},VN:function(){return T},_T:function(){return h}});var r=n(87320),o=n(55164),i=n(57477),a=n(94009),c=n(49899),s=n(55536),u=n(28953),l=n(58909),d=n(4661),p=(0,o._)({},(0,d.FH)("pushNotifications",["GET_DEFAULT","GET_FOLLOW","GET_VOTE_THANK","MARK_ALL_READ"]),(0,d.co)("pushNotifications",["ADD","CURRENT_TAB"])),f={default:p.GET_DEFAULT,follow:p.GET_FOLLOW,vote_thank:p.GET_VOTE_THANK};function h(e){return function(t,n){var r=n(),o=r.pushNotifications,i=r.pushNotifications.currentTab,a=(!e&&o[i]||{}).next;return t({reFetch:e,API:{types:f[i],endpoint:a||"notifications/v2/".concat(i)},schema:u.l.NOTIFICATION_ARRAY})}}function _(e){var t=e.request,n=e.success,r=e.failure,a={isFetching:!1,isDrained:!1,ids:[]};return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,s=arguments.length>1?arguments[1]:void 0;switch(s.type){case t:if(s.reFetch)return a;return(0,i._)((0,o._)({},e),{isFetching:!0});case n:var u=s.result,l=s.next,d=s.isDrained,p=e.ids;return(0,i._)((0,o._)({},e),{isFetching:!1,isDrained:d,next:l,ids:(0,c._)(p).concat((0,c._)(u.filter(function(e){return!p.includes(e)})))});case r:return(0,i._)((0,o._)({},e),{isFetching:!1,isDrained:!1});default:return e}}}function m(e){return{type:p.CURRENT_TAB,currentTab:e}}function g(e){return{type:p.ADD,payload:e}}function T(){return function(e,t){var n=t().pushNotifications.currentTab;return e({API:{types:p.MARK_ALL_READ,endpoint:"notifications/v2/".concat(n,"/actions/readall"),method:"POST"},tab:n})}}var E={default:0,follow:0,vote_thank:0};t.ZP=(0,s.combineReducers)({default:_(p.GET_DEFAULT),follow:_(p.GET_FOLLOW),vote_thank:_(p.GET_VOTE_THANK),currentTab:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.currentTab;return n===p.CURRENT_TAB?r:e},notificationsCount:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0,n=t.type;if(n===p.ADD){var i=(0,a._)(t.payload,3);return{default:i[0],follow:i[1],vote_thank:i[2]}}if(n===l.Hp.GET.success){var c=t.payload;return{default:c.defaultNotificationsCount,follow:c.followNotificationsCount,vote_thank:c.voteThankNotificationsCount}}return n===p.MARK_ALL_READ.success?(0,o._)({},e,(0,r._)({},t.tab,0)):e}})},31021:function(e,t,n){"use strict";n.d(t,{Gl:function(){return O},Hp:function(){return h},IF:function(){return R},J_:function(){return N},Kd:function(){return T},Kx:function(){return m},Ky:function(){return y},PW:function(){return D},R5:function(){return w},XX:function(){return C},_u:function(){return b},dY:function(){return I},eI:function(){return L},k9:function(){return g},nH:function(){return E},po:function(){return S},qX:function(){return Z},uF:function(){return x},uN:function(){return A},vL:function(){return k},yV:function(){return _},zp:function(){return P}});var r=n(87320),o=n(55164),i=n(57477),a=n(94648),c=n(74135),s=n(28953),u=n(84054),l=n.n(u);n(74351);var d=n(80714);n(40195);var p=n(66263),f=n(4661);n(8866),n(69906),n(67927);var h=(0,f.FH)("question",["GET","GET_TITLE","ADD","VOTE","DELETE","UPDATE","GET_INVITERS","GET_ALL_INVITERS","DELETE_INVITERS","GET_INVITEES","GET_FOLLOWERS","UPDATE_FOLLOWERS","GET_LATERS_COUNT","GET_LATERS","GET_INVITED_QUESTIONS_COUNT","GET_INVITED_QUESTIONS","IGNORE_INVITED_QUESTION","UPDATE_LATER","UPDATE_ANONYMOUS","CREATE_REDIRECTION","REVOKE_REDIRECTION","GET_BIO","CHOOSE_BIO","GET_SIMILAR_QUESTIONS","GET_RELATED_COMMODITIES","GET_ANSWERS","GET_UPDATED_ANSWERS","GET_COLLAPSED_ANSWERS","GET_HIDDEN_ANSWERS","GET_A11Y_ANSWERS","GET_NOTIFICATION_ANSWER_TOKENS","GET_INVITATION_CANDIDATES","GET_WAITING_QUESTIONS","DELETE_WAITING_QUESTION","DELETE_TOOLS_QUESTION_INVITED","GET_BIOS","UPDATE_INVITATION","UPDATE_LOCK","TOGGLE_QUESTION_EDIT_LOCK","GET_DRAFT","ADD_DRAFT","GET_ATTACHED_POST_TO_DRAFT","UPDATE_DRAFT","DELETE_DRAFT","GET_BRAND","GET_BRAND_QUESTION_ADVANCED_STYLE","UPDATE_BRAND_QUESTION_ADVANCED_STYLE","GET_BRAND_QUESTION_RECOMMENDATION","GET_BRAND_QUESTION_PERMISSION","GET_BRAND_QUESTION_OPEN_STATUS","UPDATE_BRAND_QUESTION_OPEN_STATUS","GET_BRAND_QUESTION_RED_PACKET","GET_BRAND_QUESTION_PRIZE","GET_BRAND_QUESTION_ANSWER_SUMMARIES","GET_BRAND_QUESTION_WINNERS","CREATE_BRAND_QUESTION_PRIZE","SET_BRAND_QUESTION_WINNERS","GET_CONCERNED_FOLLOWERS","GET_ANSWER_COUNT","UPDATE_COMMENT_PERMISSION","GET_META_TOPICS","LOAD_RELATED_BLUESTAR_RANKLIST","GET_RELATED_SEARCH","GET_AUTO_INVITATION","OPEN_AUTO_INVITATION","CLOSE_AUTO_INVITATION","UPDATE_ONCE_INVITE","GET_SIMPLE_CONCERNED_FOLLOWERS","UPDATE_VOTE_TOPIC","GET_DISCLAIMERS","GET_QUESTION_SHARE","GET_READING_MEMBERSHIP","GET_BRAND_QUESTION_ANSWER_MARK","PUT_BRAND_QUESTION_ANSWER_MARK","PUT_BRAND_QUESTION_STATUS","GET_BRAND_QUESTION_STATUSINFO","GET_QUESTION_BANNER","OPEN_BUS_VIP","QUERY_BUS_VIP_STATUS","QUERY_DEFAULT_SETTINGS","QUERY_QUESTION_DRAFT","UPDATE_MARKDOWN_ENABLED","GET_AI_TASK","GET_ACCOUNT_BINDING","REMOVE_SESSION"]),_=(0,f.co)("question",["REMOVE_RED_PACKET","SHOW_MOBILE_SIGN_IN_MODAL"]),m=l()({is_visible:!0,related_cards:!0,ad_track_url:!0,review_info:!0,mute_info:!0,detail:!0,editable_detail:!0,comment_count:!0,can_comment:!0,comment_permission:!0,admin_closed_comment:!0,answer_count:!0,collapsed_answer_count:!0,follower_count:!0,visit_count:!0,topics:!0,author:!0,show_author:!0,invisible_author:!0,show_encourage_author:!0,excerpt:!0,thumbnail_info:!0,voteup_count:!0,is_editable:!0,is_normal:!0,status:!0,redirection:!0,question_type:!0,is_labeled:!0,is_muted:!0,created:!0,updated_time:!0,has_publishing_draft:!0,annotation_detail:!0,relationship:{is_author:!0,voting:!0,is_anonymous:!0,is_following:!0,can_edit:!0,can_collapse_answers:!0,can_stick_answers:!0,can_lock:!0,can_vote:!0,my_answer:!0},is_bannered:!0,event:!0,reaction_instruction:!0,ai_summary:!0});function g(e,t){var n=e.id,i=e.optimisticData,a=t.entities.questions[n];return{type:h.UPDATE.request,UPDATE:{request:{questions:(0,r._)({},n,(0,o._)({},a,i))}}}}function T(e,t){var n=e.id;return{type:h.UPDATE.success,payload:t,schema:s.l.QUESTION,UPDATE:{success:function(e){return{questions:(0,r._)({},n,e)}}},NOTIFICATION:{key:"updateQuestion",success:function(e){return{id:e.id}}}}}function E(e,t,n){var o=e.id,i=n.entities.questions[o];return{type:h.UPDATE.failure,err:t,UPDATE:{failure:{questions:(0,r._)({},o,i)}},NOTIFICATION:{key:"updateQuestion",failure:function(e){return{code:e.code}}}}}function y(e){return{type:_.SHOW_MOBILE_SIGN_IN_MODAL,payload:e}}function C(e,t){return function(n,a){var c=a(),s=c.currentUser,u=c.entities,l=u.users,d=u.questions,p=l[s],f=d[e],_=t?1:-1,m={types:h.UPDATE_FOLLOWERS,endpoint:"questions/".concat(e,"/followers"),method:t?"POST":"DELETE"};return n(f?{meta:{id:e,expect:t},API:m,UPDATE:{request:{users:(0,r._)({},s,{followingQuestionCount:p.followingQuestionCount+_}),questions:(0,r._)({},e,{followerCount:f.followerCount+_,relationship:(0,i._)((0,o._)({},f.relationship||{}),{isFollowing:t})})},failure:{users:(0,r._)({},s,p),questions:(0,r._)({},e,f)}}}:{meta:{id:e,expect:t},API:m})}}function S(e,t){return function(n,a){var c=a(),s=c.currentUser,u=c.entities,l=u.users,d=u.questions,f=u.answers,_=l[s],m=d[e],g=m.relationship,T=g.myAnswer,E=g.isAnonymous,y=T&&T.answerId?f[T.answerId]:null;return t="boolean"==typeof t?t:!E,n({API:{types:h.UPDATE_ANONYMOUS,endpoint:"questions/".concat(e,"/anonyms"),method:t?"POST":"DELETE"},UPDATE:{request:{questions:(0,r._)({},e,{relationship:(0,i._)((0,o._)({},m.relationship),{isAnonymous:t})}),answers:y?(0,r._)({},y.id,{author:t?p.aK:_}):{}},failure:{questions:(0,r._)({},e,m),answers:y?(0,r._)({},y.id,y):{}}}})}}function I(e){return{id:e,API:{types:h.GET_DRAFT,endpoint:"questions/".concat(e,"/draft"),query:{include:"question,schedule"}},schema:s.l.DRAFT,NOTIFICATION:{failure:"草稿加载失败"},UPDATE:{success:function(t){return t.question?(0,r._)({},"question_".concat(e),{attachment:t.attachment}):{drafts:(0,r._)({},"question_".concat(e),null)}}}}}function A(e,t,n,a,s,u){return function(l,d){var p="question_".concat(e),f=d().entities.drafts;return l({API:{types:h.ADD_DRAFT,endpoint:"questions/".concat(e,"/draft"),method:"POST",body:(0,c.decamelizeKeys)({content:t,deltaTime:n,draftType:a,attachment:s,settings:u}),fetchOptions:{zsAutoSignature:!1}},UPDATE:{request:{drafts:(0,r._)({},p,{editableContent:t,draftType:a,attachment:s,updating:!0,updated:!1,updateFailed:!1})},success:function(e){return{drafts:(0,r._)({},p,{createdTime:e.createdTime,updatedTime:e.updatedTime,updating:!1,updated:!0,updateFailed:!1})}},failure:{drafts:(0,r._)({},p,(0,i._)((0,o._)({},f[p]),{updating:!1,updated:!1,updateFailed:!0,updatedTime:Math.floor(Date.now()/1e3)}))}}})}}function b(e,t,n,a,s,u){return function(l,d){var p="question_".concat(e),f=d().entities.drafts;return l({API:{types:h.UPDATE_DRAFT,endpoint:"questions/".concat(e,"/draft"),method:"PUT",body:(0,c.decamelizeKeys)({content:t,deltaTime:n,draftType:a,attachment:s,settings:u}),fetchOptions:{zsSignature:!1}},UPDATE:{request:{drafts:(0,r._)({},p,{editableContent:t,draftType:a,attachment:s,updating:!0,updated:!1,updateFailed:!1})},success:function(e){return{drafts:(0,r._)({},p,{createdTime:e.createdTime,updatedTime:e.updatedTime,updating:!1,updated:!0,updateFailed:!1})}},failure:{drafts:(0,r._)({},p,(0,i._)((0,o._)({},f[p]),{updating:!1,updated:!1,updateFailed:!0,updatedTime:Math.floor(Date.now()/1e3)}))}}})}}function w(e){return function(t,n){var o="question_".concat(e),i=n().entities.drafts;return t({API:{types:h.DELETE_DRAFT,endpoint:"questions/".concat(e,"/draft"),method:"DELETE"},UPDATE:{request:{drafts:(0,r._)({},o,null)},failure:{drafts:i}}})}}function Z(e){return{id:e,API:{types:h.GET_ALL_INVITERS,endpoint:"questions/".concat(e,"/inviters"),query:{with_answered:!0,with_ignored:!0,with_admin:!0}},schema:s.l.USER_ARRAY}}function x(e){return{API:{endpoint:"questions/".concat(e,"/bios"),types:h.GET_BIOS}}}function k(e,t){return function(n,r){var a=r().topic.bios;return n({API:{endpoint:"questions/".concat(e,"/bio"),types:h.CHOOSE_BIO,body:(0,c.decamelizeKeys)({type:t.type,topicId:(t.topic||{}).id}),method:"POST"},id:e,bio:(0,i._)((0,o._)({},t),{bio:a[(t.topic||{}).id]})})}}function R(e){return{API:{types:h.GET_BIO,endpoint:"questions/".concat(e,"/bio")},id:e}}function N(e){return{id:e,API:{types:h.GET_DISCLAIMERS,endpoint:"/questions/".concat(e,"/disclaimers")}}}function O(){return{API:{types:h.QUERY_DEFAULT_SETTINGS,endpoint:"/editor/default-settings",method:"GET"}}}function P(e){return{API:{types:h.UPDATE_MARKDOWN_ENABLED,endpoint:"editor/default-settings",method:"PUT",body:{common_settings:(0,c.decamelizeKeys)(e)}}}}function D(e){return{API:{types:h.QUERY_QUESTION_DRAFT,endpoint:"/questions/".concat(e,"/draft"),method:"GET"}}}function L(){return{API:{method:"GET",types:h.GET_ACCOUNT_BINDING,endpoint:"editor/import/account_binding",root:d.Z.fetchRoot.www},FAILSAFE:!0}}(0,a.I)(function(){var e,t=(null===(e=d.Z.apollo)||void 0===e?void 0:e.include_reaction)==="1";return l()({data:[{is_normal:!0,admin_closed_comment:!0,reward_info:!0,is_collapsed:!0,annotation_action:!0,annotation_detail:!0,collapse_reason:!0,is_sticky:!0,collapsed_by:!0,suggest_edit:!0,comment_count:!0,can_comment:!0,content:!0,editable_content:!0,attachment:!0,voteup_count:!0,reshipment_settings:!0,comment_permission:!0,created_time:!0,updated_time:!0,review_info:!0,relevant_info:!0,question:!0,excerpt:!0,relationship:{is_authorized:!0,is_author:!0,voting:!0,is_thanked:!0,is_nothelp:!0},is_labeled:!0,paid_info:!0,paid_info_content:!0,author:{follower_count:!0,badge:[{topics:!0}],vip_info:!0,kvip_info:!0},settings:{table_of_content:{enabled:!0}},reaction:t,reaction_instruction:!0,segment_infos:!0,allow_segment_interaction:!0,hot_comment:!0}]})})},40195:function(e,t,n){"use strict";n.d(t,{Hp:function(){return I.Hp},uN:function(){return I.uN},em:function(){return N},vL:function(){return I.vL},nH:function(){return I.nH},k9:function(){return I.k9},Kd:function(){return I.Kd},ZP:function(){return O},R5:function(){return I.R5},qX:function(){return I.qX},eI:function(){return I.eI},IF:function(){return I.IF},SZ:function(){return k},gW:function(){return x},uF:function(){return I.uF},J_:function(){return I.J_},dY:function(){return I.dY},hh:function(){return R},Gl:function(){return I.Gl},Kx:function(){return I.Kx},Md:function(){return Z},Ky:function(){return I.Ky},_u:function(){return I._u},zp:function(){return I.zp},po:function(){return I.po},XX:function(){return I.XX}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(46942),s=n.n(c),u=n(55536),l=[{name:"total",text:"所有人",filterBy:"",countKey:"questionTotalCount"},{name:"followees",text:"我关注的人",filterBy:"followees",countKey:"questionFolloweeCount"}];n(85879);var d=n(43998),p=n(34473),f=n(48498),h=n(57032),_=n(42951),m=n(30577),g=n(60811);n(82806),n(87641),n(69383),n(99447),n(30722),n(44169),n(31142);var T=n(44893),E="pc_panel",y=[{name:"recommend",queryName:"",icon:d.$,text:"为你推荐",request:{endpoint:"creators/question_route/pc_member_related/recommend",query:{pageSource:E}}},{name:"invite",queryName:"invite",icon:p.y,text:"邀请回答",request:{endpoint:"notifications/v3/timeline/entry/invite",query:{invite_with_time_slice:1}}},{name:"newest",queryName:"new",icon:f.k,text:"最新问题",request:{endpoint:"/creators/question_route/pc_member_related/newest",query:{pageSource:E,include:T.UH}}},{name:"hot",queryName:"hot",icon:h.ZV,text:"人气问题",request:{endpoint:"creators/question_route/pc_member_related/hot",query:{pageSource:E}}}];_.T,m.xl,f.k,g.RF;var C=n(8866),S=n(69906),I=n(31021),A=(0,S.Fd)(I.Hp.GET_NOTIFICATION_ANSWER_TOKENS,{mapActionToKey:function(e){return e.notificationId}}),b=(0,u.combineReducers)({followers:(0,S.Fd)(I.Hp.GET_FOLLOWERS),concernedFollowers:(0,S.Fd)(I.Hp.GET_CONCERNED_FOLLOWERS),answers:(0,S.Fd)(I.Hp.GET_ANSWERS,{addSuccessType:C.uJ.ADD.success,addAtTop:!1,additionalCaseTypes:[C.uJ.RESTORE.success,C.uJ.COLLAPSE.success],additionalCase:function(e,t){return t.type!==C.uJ.RESTORE.success||e.ids.includes(t.result)?e:(0,i._)((0,o._)({},e),{ids:(0,a._)(e.ids).concat([t.result])})}}),hiddenAnswers:(0,S.Fd)(I.Hp.GET_HIDDEN_ANSWERS,{addSuccessType:C.uJ.ADD.success,addAtTop:!1,additionalCaseTypes:[C.uJ.RESTORE.success,C.uJ.COLLAPSE.success],additionalCase:function(e,t){return t.type!==C.uJ.RESTORE.success||e.ids.includes(t.result)?e:(0,i._)((0,o._)({},e),{ids:(0,a._)(e.ids).concat([t.result])})}}),updatedAnswers:(0,S.Fd)(I.Hp.GET_UPDATED_ANSWERS,{addSuccessType:C.uJ.ADD.success,addAtTop:!1,additionalCaseTypes:[C.uJ.RESTORE.success],additionalCase:function(e,t){return t.type!==C.uJ.RESTORE.success||e.ids.includes(t.result)?e:(0,i._)((0,o._)({},e),{ids:(0,a._)(e.ids).concat([t.result])})}}),ariaAnswers:function(e,t){return(0,S.Fd)(I.Hp.GET_A11Y_ANSWERS)(e,t)},collapsedAnswers:function(e,t){return(0,S.Fd)(I.Hp.GET_COLLAPSED_ANSWERS)(e,t)},notificationAnswers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.type;if(Object.values(I.Hp.GET_NOTIFICATION_ANSWER_TOKENS).includes(r)){if(r===I.Hp.GET_NOTIFICATION_ANSWER_TOKENS.success){var o=n.data,i=n.paging,a=i.isEnd,c=i.next;t.result=o,t.isDrained=a,t.next=c}return A(e,t)}return e},invitedQuestions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t.name,{count:null,isEnd:!1,isLoading:!1,questions:[]}))},{}),t=arguments.length>1?arguments[1]:void 0;if(t.type===I.Hp.GET_INVITED_QUESTIONS_COUNT.success)return l.reduce(function(e,n){return(0,i._)((0,o._)({},e),(0,r._)({},n.name,(0,i._)((0,o._)({},e[n.name]),{count:t.payload.data[n.countKey]})))},e);if(t.type===I.Hp.GET_INVITED_QUESTIONS.request){var n=t.meta.typeName;return(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},e[n]),{isLoading:!0})))}if(t.type===I.Hp.GET_INVITED_QUESTIONS.success){var c=t.meta.typeName,s=t.payload,u=s.paging,d=s.data;return(0,i._)((0,o._)({},e),(0,r._)({},c,(0,i._)((0,o._)({},e[c]),{isEnd:u.isEnd,isLoading:!1,questions:(0,a._)(e[c].questions).concat((0,a._)(d))})))}return e},laterQuestions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{count:null,isEnd:!1,isLoading:!1,questions:[]},t=arguments.length>1?arguments[1]:void 0;if(t.type===I.Hp.GET_LATERS_COUNT.success)return(0,i._)((0,o._)({},e),{count:t.payload.count});if(t.type===I.Hp.UPDATE_LATER.success)return(0,i._)((0,o._)({},e),{count:e.count+(t.meta.expect?1:-1)});if(t.type===I.Hp.GET_LATERS.request)return(0,i._)((0,o._)({},e),{isLoading:!0});if(t.type===I.Hp.GET_LATERS.success){var n=t.payload,r=n.paging,c=n.data;return(0,i._)((0,o._)({},e),{isEnd:r.isEnd,isLoading:!1,questions:(0,a._)(e.questions).concat((0,a._)(c))})}return e},waitingQuestions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y.reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t.name,{isEnd:!1,isLoading:!1,questions:[]}))},{}),t=arguments.length>1?arguments[1]:void 0;if(t.type===I.Hp.GET_WAITING_QUESTIONS.request){var n=t.meta.type;return(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},e[n]),{isLoading:!0})))}if(t.type===I.Hp.GET_WAITING_QUESTIONS.success){var c=t.meta.type,s=t.payload,u=s.paging,l=s.data;return(0,i._)((0,o._)({},e),(0,r._)({},c,{paging:u,isEnd:u.isEnd,isLoading:!1,questions:(0,a._)(e[c].questions).concat((0,a._)(l))}))}if(t.type===I.Hp.UPDATE_FOLLOWERS.success){var d=t.meta,p=d.id,f=d.expect;return Object.keys(e).reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t,(0,i._)((0,o._)({},e[t]),{questions:e[t].questions.map(function(e){return e.question.id===p?(0,i._)((0,o._)({},e),{question:(0,i._)((0,o._)({},e.question),{relationship:(0,i._)((0,o._)({},e.question.relationship),{isFollowing:f})})}):e})})))},e)}return e},invitationCandidates:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return(0,a._)(Object.values(I.Hp.GET_INVITATION_CANDIDATES)).concat((0,a._)(Object.values(I.Hp.UPDATE_INVITATION)),(0,a._)(Object.values(I.Hp.UPDATE_ONCE_INVITE))).includes(t.type)?(0,r._)({},t.id,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isDrained:!1,items:[],searchItems:[],onceDisabled:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I.Hp.GET_INVITATION_CANDIDATES.request:return(0,i._)((0,o._)({},e),{isFetching:!0});case I.Hp.GET_INVITATION_CANDIDATES.success:return(0,i._)((0,o._)({},e),(0,r._)({isFetching:!1,isDrained:!0},t.keyword?"searchItems":"items",t.result));case I.Hp.GET_INVITATION_CANDIDATES.failure:return(0,i._)((0,o._)({},e),{isFetching:!1});case I.Hp.UPDATE_ONCE_INVITE.success:var n=e.items.map(function(e){return(0,i._)((0,o._)({},e),{isInvited:!0})});return(0,i._)((0,o._)({},e),{items:n});case I.Hp.UPDATE_ONCE_INVITE.request:return(0,i._)((0,o._)({},e),{onceDisabled:!0});case I.Hp.UPDATE_INVITATION.request:case I.Hp.UPDATE_INVITATION.failure:var c=e.items,s=e.searchItems,u=c.findIndex(function(e){return e.member===t.urlToken}),l=s.findIndex(function(e){return e.member===t.urlToken});if(u>=0){var d=c[u];return(0,i._)((0,o._)({},e),{items:(0,a._)(c.slice(0,u)).concat([(0,i._)((0,o._)({},d),{isInvited:!d.isInvited})],(0,a._)(c.slice(u+1)))})}if(l>=0){var p=s[l];return(0,i._)((0,o._)({},e),{searchItems:(0,a._)(s.slice(0,l)).concat([(0,i._)((0,o._)({},p),{isInvited:!p.isInvited})],(0,a._)(s.slice(l+1)))})}return e;default:return e}}(e[t.id],t)):e},inviters:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===I.Hp.GET_INVITERS.success){var n=t.id,a=t.payload.data;return(0,i._)((0,o._)({},e),(0,r._)({},n,a))}if(t.type===I.Hp.GET_ALL_INVITERS.success){var c=t.id,s=t.payload.data;return(0,i._)((0,o._)({},e),(0,r._)({},"".concat(c,"_all"),s))}return e},invitees:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return(0,a._)(Object.values(I.Hp.GET_INVITEES)).concat((0,a._)(Object.values(I.Hp.UPDATE_INVITATION)),(0,a._)(Object.values(I.Hp.UPDATE_ONCE_INVITE))).includes(t.type)?(0,r._)({},t.id,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,isDrained:!1,items:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I.Hp.GET_INVITEES.request:return(0,i._)((0,o._)({},e),{isFetching:!0});case I.Hp.GET_INVITEES.success:return(0,i._)((0,o._)({},e),{isFetching:!1,isDrained:!0,items:t.result});case I.Hp.GET_INVITEES.failure:return(0,i._)((0,o._)({},e),{isFetching:!1});case I.Hp.UPDATE_ONCE_INVITE.success:var n=e.items,r=t.userTokens,c=(0,a._)(n);return(0,i._)((0,o._)({},e),{items:s()((0,a._)(r).concat((0,a._)(c)))});case I.Hp.UPDATE_INVITATION.request:var u=t.urlToken,l=e.items,d=l.indexOf(u),p=(0,a._)(l);if(d<0)return(0,i._)((0,o._)({},e),{items:[u].concat((0,a._)(p))});return p.splice(d,1),(0,i._)((0,o._)({},e),{items:(0,a._)(p),deleteIndex:d});case I.Hp.UPDATE_INVITATION.failure:var f=t.urlToken,h=e.items,_=h.indexOf(f),m=(0,a._)(h);if(_>=0)return m.splice(f,1),(0,i._)((0,o._)({},e),{items:(0,a._)(m)});return m.splice(e.deleteIndex,0,f),(0,i._)((0,o._)({},e),{items:(0,a._)(m),deleteIndex:-1});default:return e}}(e[t.id],t)):e},similarQuestions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===I.Hp.GET_SIMILAR_QUESTIONS.success){var n=t.id,a=t.payload.data;return(0,i._)((0,o._)({},e),(0,r._)({},n,a))}return e},questionBanners:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===I.Hp.GET_QUESTION_BANNER.success){var n=t.id,a=t.payload.data;return(0,i._)((0,o._)({},e),(0,r._)({},n,a))}return e},relatedCommodities:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===I.Hp.GET_RELATED_COMMODITIES.success){var n=t.id,a=t.payload,c=a.data,s=a.attachedInfo;return c.attachedInfo=s,(0,i._)((0,o._)({},e),(0,r._)({},n,c))}return e},bio:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,a=e[n]||{};return t.type===I.Hp.GET_BIO.success?(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},a),{result:t.payload}))):t.type===I.Hp.CHOOSE_BIO.success?(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},a),{result:t.bio}))):e},brand:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===I.Hp.GET_BRAND.success?t.payload:e},permission:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===I.Hp.GET_BRAND_QUESTION_PERMISSION.success?t.payload:e},adverts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===I.Hp.GET_ANSWERS.success&&t.payload.adInfo){var n=t.payload.adInfo,i=n.position,a=n.ad,c=n.adjson;return(0,o._)({},e,(0,r._)({},i,{ad:a,adjson:c}))}return e},advancedStyle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===I.Hp.GET_BRAND_QUESTION_ADVANCED_STYLE.success?t.payload:e},commonAnswerCount:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return t.type===I.Hp.GET_ANSWER_COUNT.success?t.payload.answerCount:t.type===C.uJ.COLLAPSE.success?"nobody"===t.answer.collapsedBy?e-1:e+1:e},hiddenAnswerCount:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return t.type===I.Hp.GET_ANSWER_COUNT.success?t.payload.hiddenAnswerCount:t.type===C.uJ.COLLAPSE.success?"org"===t.collapsedBy||"advertiser"===t.collapsedBy?e+1:e-1:e},topicMeta:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isLoading:{}},t=arguments.length>1?arguments[1]:void 0;if(t.type===I.Hp.GET_META_TOPICS.request){var n=t.id;return(0,i._)((0,o._)({},e),{isLoading:(0,i._)((0,o._)({},e.isLoading),(0,r._)({},n,!0))})}if(t.type===I.Hp.GET_META_TOPICS.success){var a,c=t.payload,s=t.id;return(0,i._)((0,o._)({},e),(a={},(0,r._)(a,s,c),(0,r._)(a,"isLoading",(0,i._)((0,o._)({},e.isLoading),(0,r._)({},s,!1))),a))}if(t.type===I.Hp.GET_META_TOPICS.failure){var u=t.id;return(0,i._)((0,o._)({},e),{isLoading:(0,i._)((0,o._)({},e.isLoading),(0,r._)({},u,!1))})}return e},bluestarRanklist:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===I.Hp.LOAD_RELATED_BLUESTAR_RANKLIST.success){var n=t.payload,a=t.id;return(0,i._)((0,o._)({},e),(0,r._)({},a,n))}return e},relatedSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===I.Hp.GET_RELATED_SEARCH.success){var n=t.id,a=t.payload;return(0,i._)((0,o._)({},e),(0,r._)({},n,a))}return e},autoInvitation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===I.Hp.GET_AUTO_INVITATION.success){var n=t.payload,a=void 0===n?{}:n,c=t.id;return(0,i._)((0,o._)({},e),(0,r._)({},c,a))}if(t.type===I.Hp.OPEN_AUTO_INVITATION.success){var s=t.id,u=e[s];return(0,i._)((0,o._)({},e),(0,r._)({},s,(0,i._)((0,o._)({},u),{status:"open"})))}if(t.type===I.Hp.CLOSE_AUTO_INVITATION.success){var l=t.id,d=e[l];return(0,i._)((0,o._)({},e),(0,r._)({},l,(0,i._)((0,o._)({},d),{status:"close"})))}return e},simpleConcernedFollowers:(0,S.Fd)(I.Hp.GET_SIMPLE_CONCERNED_FOLLOWERS),draftStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===I.Hp.GET_DRAFT.request){var n=t.id;return(0,i._)((0,o._)({},e),(0,r._)({},n,{loading:!0}))}if(t.type===I.Hp.GET_DRAFT.success||t.type===I.Hp.GET_DRAFT.failure){var a=t.id;return(0,i._)((0,o._)({},e),(0,r._)({},a,{loading:!1}))}return e},disclaimers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===I.Hp.GET_DISCLAIMERS.success){var n=t.id,a=t.payload.data;return(0,i._)((0,o._)({},e),(0,r._)({},n,a))}return e},isShowMobileSignInModal:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return t.type===I.yV.SHOW_MOBILE_SIGN_IN_MODAL?t.payload:e},aiTask:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return t.type===I.Hp.GET_AI_TASK.success?t.payload:e}}),w=n(31824);function Z(e,t){var n=t.id;return(e.entities.questions||{})[n]}function x(e){var t;return(null==e?void 0:null===(t=e.muteInfo)||void 0===t?void 0:t.type)==="special_mute"}function k(e){var t,n,r,o,i=!!(null==e?void 0:null===(t=e.relationship)||void 0===t?void 0:null===(n=t.myAnswer)||void 0===n?void 0:n.answerId);return(null==e?void 0:null===(r=e.muteInfo)||void 0===r?void 0:r.type)==="freeze"||(null==e?void 0:null===(o=e.reactionInstruction)||void 0===o?void 0:o.rEACTIONDISBAND)==="HIDE"&&i}function R(e){return e.question?e.question.permission:{}}function N(e,t){return e.question.inviters["".concat(t,"_all")]}n(28814),(0,w.P1)(function(e){return e.question.adverts},function(e){return[0].concat((0,a._)(Object.keys(e||{}).map(Number).sort(function(e,t){return e-t})))});var O=b},35586:function(e,t,n){"use strict";n.d(t,{O8:function(){return s},ZP:function(){return u},m3:function(){return c}});var r=n(87320),o=n(55164),i=n(57477),a=(0,n(4661).co)("readStatus",["UPDATE"]);function c(e,t){return{type:a.UPDATE,data:{item:e,isRead:t}}}function s(e,t){if(t){var n=t.type,r=t.id,o=e.readStatus[n];if("answer"===n||"article"===n)return!!(o&&o[r])}return!0}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===a.UPDATE){var n=t.data,c=n.item,s=c.type,u=c.id,l=n.isRead;return(0,i._)((0,o._)({},e),(0,r._)({},s,(0,i._)((0,o._)({},e[s]),(0,r._)({},u,l))))}return e}},72238:function(e,t,n){"use strict";n.d(t,{Gz:function(){return g},To:function(){return _},ZP:function(){return E},cP:function(){return m},mA:function(){return h}});var r=n(10840),o=n(20382),i=n(55164),a=n(57477),c=n(74135),s=n(81897),u=n.n(s),l=n(4785),d=n(66263),p=n(4661),f=(0,i._)({},(0,p.FH)("register",["DIGITS","REGISTER","VALIDATE_DIGITS","VALIDATE_REGISTER_FORM","GET_WECHAT_SOCIAL_INFO"]),(0,p.co)("register",["RESET_REGISTER_VALIDATE_RESULT"]));function h(){return{type:f.RESET_REGISTER_VALIDATE_RESULT}}function _(e){return{API:{types:f.VALIDATE_REGISTER_FORM,endpoint:"v3/oauth/validate/register_form",method:"POST",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,l.Z)((0,c.decamelizeKeys)(e)),withDUBrowserID:!0}}}}function m(e){var t=(0,r._)({},(0,o._)(e));return function(e){return e(h()),e(_(t)).then(function(n){n.payload.success&&e(function(e){return e(h()),e({API:{types:f.REGISTER,endpoint:"v3/oauth/register",method:"POST",fetchOptions:{credentials:"include",zsEncrypt:!0,body:(0,l.Z)((0,c.decamelizeKeys)(t)),withDUBrowserID:!0}},NOTIFICATION:!1})})})}}var g=function(e,t){return function(n){var r=u().get("atoken"),o=u().get("atoken_expired_in");if(!r)return Promise.reject();var i=(0,l.z)((0,c.decamelizeKeys)({socialType:e,appkey:d.M5[t||e],expires_at:o,accessToken:r,source:"com.zhihu.web"}));return n({API:{types:f.GET_WECHAT_SOCIAL_INFO,endpoint:"/v3/oauth/social/info",method:"POST",body:i,fetchOptions:{credentials:"include",withDUBrowserID:!0}},NOTIFICATION:!1})}},T={registerValidateSucceeded:null,registerValidateErrors:{},registerConfirmError:null,sendDigitsError:null,registerConfirmSucceeded:null};function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0,n=t.type;if(n===f.VALIDATE_REGISTER_FORM.success){var r=t.payload;return(0,a._)((0,i._)({},e),{registerValidateSucceeded:!!r.success,registerValidateErrors:(0,i._)({},e.registerValidateErrors,r)})}return n===f.VALIDATE_REGISTER_FORM.failure?(0,a._)((0,i._)({},e),{registerConfirmError:(0,p.O1)(t.err.payload)}):n===f.RESET_REGISTER_VALIDATE_RESULT?(0,i._)({},T):n===f.REGISTER.success?(0,a._)((0,i._)({},e),{registerConfirmSucceeded:!0}):n===f.REGISTER.failure?(0,a._)((0,i._)({},e),{registerConfirmSucceeded:!1,registerConfirmError:(0,p.O1)(t.err.payload)}):n===f.DIGITS.failure?(0,a._)((0,i._)({},e),{sendDigitsError:t.err.payload.message}):n===f.VALIDATE_DIGITS.failure?(0,a._)((0,i._)({},e),{registerValidateErrors:(0,i._)({},e.registerValidateErrors,(0,p.O1)(t.err.payload))}):e}},39041:function(e,t,n){"use strict";n.d(t,{ZP:function(){return y},bG:function(){return T},Jg:function(){return p},$T:function(){return d},gT:function(){return f},ij:function(){return E},OO:function(){return h}});var r=n(87320),o=n(55164),i=n(57477),a=n(28953),c=n(4785),s=(0,n(4661).FH)("republish",["GET_ARTICLE_REPUBLISH_REQUESTS","GET_ALL_REPUBLISH_REQUESTS","POST_ARTICLE_REPUBLISH","UPDATE_REPUBLISH_PERMISSION"]),u={cancel:"canceled",approve:"approved",reject:"rejected"},l={column:"column_owner",article:"article_author"};function d(e){return{meta:{entityType:"article"},API:{types:s.GET_ARTICLE_REPUBLISH_REQUESTS,endpoint:"/articles/".concat(e,"/republish-requests")},FAILSAFE:!0,schema:a.l.REPUBLISH_ARRAY}}function p(e,t){var n=l[t];return function(r,o){var i,c,u=(null!==(c=null===(i=o().republish)||void 0===i?void 0:i[t])&&void 0!==c?c:{}).paging,l=(null==u?void 0:u.isEnd)===!1?u.next:"/members/".concat(e,"/republish-requests?role=").concat(n,"&version=2");return r({meta:{id:e,entityType:t},API:{types:s.GET_ALL_REPUBLISH_REQUESTS,endpoint:l},FAILSAFE:!0,schema:a.l.REPUBLISH_ARRAY})}}function f(e){var t=e.requestId,n=e.action,i=e.articleId,a=e.columnId;return{API:{types:s.POST_ARTICLE_REPUBLISH,endpoint:"/articles/".concat(i,"/republish"),method:"POST",body:(0,o._)({action:n},"create"===n?{column:a}:{request_id:t})},meta:{articleId:i,requestId:t,result:n},UPDATE:{success:function(){return{republishes:(0,r._)({},t,{state:u[n]})}}}}}function h(e,t){return function(n,o){var i=o().entities.articles[e];return n({API:{types:s.UPDATE_REPUBLISH_PERMISSION,endpoint:"/articles/".concat(e,"/copyright-permission"),method:"PUT",body:(0,c.Z)({copyright_permission:t})},UPDATE:{request:{articles:(0,r._)({},e,{copyrightPermission:t})},failure:{articles:(0,r._)({},e,i)}}})}}var _=n(71728),m=function(e,t){return(null==t?void 0:t[0])?t.map(function(t){var n,r=t.object,a=r.id,c=r.schema,s=t.destination,u=t.proposer,l=t.approver,d=(0,_._)(t,["object","destination","proposer","approver"]);return(0,i._)((0,o._)({},d),{object:null===(n=e.entities["".concat(c,"s")])||void 0===n?void 0:n[a],destination:e.entities.columns[s],approver:e.entities.users[l],proposer:e.entities.users[u]})}):[]},g=function(e){var t=e.isAuthor,n=e.isProfile,r=e.requestType;return n?"approver":t&&"self_recommend"===r?"proposer":"approver"},T=function(e,t){var n=t.isAuthor,r=t.isProfile,o=t.entityType,i=t.requestType,a=e.entities.republishes||{},c=Object.keys(a).map(function(e){return a[e]}).filter(function(){var t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=g({isAuthor:n,isProfile:r,requestType:i});if("column"===o)return a[c]===e.currentUser&&"self_recommend"===a.requestType;var s=i||"invite";return a[c]===e.currentUser&&(null===(t=a.object)||void 0===t?void 0:t.schema)===o&&a.requestType===s});return m(e,c)},E=function(e){var t=e.entities.republishes||{},n=Object.keys(t).map(function(e){return t[e]}).filter(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.proposer===e.currentUser&&"pending"===t.state&&"self_recommend"===t.requestType});return m(e,n)},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.meta,c=t.payload;if(n===s.GET_ARTICLE_REPUBLISH_REQUESTS.request||n===s.GET_ARTICLE_REPUBLISH_REQUESTS.failure||n===s.GET_ALL_REPUBLISH_REQUESTS.failure||n===s.GET_ALL_REPUBLISH_REQUESTS.request){var u=a.entityType;return(0,i._)((0,o._)({},e),(0,r._)({},u,(0,i._)((0,o._)({},e[u]),{isLoading:n===s.GET_ARTICLE_REPUBLISH_REQUESTS.request||n===s.GET_ALL_REPUBLISH_REQUESTS.request})))}if(n===s.GET_ALL_REPUBLISH_REQUESTS.success||n===s.GET_ARTICLE_REPUBLISH_REQUESTS.success){var l=a.entityType,d=c.paging;return(0,i._)((0,o._)({},e),(0,r._)({},l,(0,i._)((0,o._)({},e[l]),{paging:d,isLoading:!1})))}return e}},67036:function(e,t,n){"use strict";n.d(t,{$j:function(){return g},Ad:function(){return h},OC:function(){return m},ZP:function(){return y},i3:function(){return _}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(74135),s=n(95769),u=n.n(s),l=n(66263),d=n(4661);n(69906);var p=n(67927),f=(0,o._)({},(0,d.FH)("reward",["ADD_REWARD","GET_REWARD_USER","ADD_ARTICLE_REWARD","GET_REWARD_USER_DETAILS","GET_ARTICLE_REWARD_USER","GET_PAGING_ARTICLE_REWARD_USER","GET_PAGING_ARTICLE_REWARD_USER_DETAILS","UPDATE_ARTICLE_REWARD","UPDATE_REWARD_FOLLOWERS"]),(0,d.co)("reward",["REMOVE_TRADE_NUMBER","ADD_REWARD_TAGLINE","ON_REWARD_SUCCESS","UPDATE_ENTITIES_USERS","UPDATE_QUESTION_REWARDINFO"]));function h(e,t){return function(n,r){var o=r().reward,i=o.answer,a=o.article,c=Object.keys(i).length>0,s=c?i:a,u=Object.keys(s)[0],d=Object.values(s)[0].users,h=d.filter(function(t){return t.urlToken===e})[0],_=d.indexOf(h);return n(h.isBlocked?(0,p.c0)(l.T$.blocked,"red"):{id:u,user:h,count:t?1:-1,index:_,expect:t,rewardType:c?"answer":"article",API:{types:f.UPDATE_REWARD_FOLLOWERS,endpoint:"members/".concat(h.urlToken,"/followers"),method:t?"POST":"DELETE"}})}}function _(e,t,n){return function(r){var o={tagline:t};return"boolean"==typeof n&&(o.canTip=n),r({API:{types:f.UPDATE_ARTICLE_REWARD,endpoint:"/articles/".concat(e),method:"PUT",body:(0,c.decamelizeKeys)({tipjarSetting:o})},id:e,tagline:t,canTip:n})}}function m(e,t){return{type:f.ADD_REWARD_TAGLINE,text:e,id:t}}function g(e,t){return{type:f.UPDATE_QUESTION_REWARDINFO,questionId:e,isRewardable:t}}function T(e){var t=[];return e.forEach(function(e){var n=e.amount,r=e.created,o=e.rewarder;o.amount=n,o.rewardCreated=r;var i=t.findIndex(function(e){return e.urlToken===o.urlToken});if(-1!==i){t[i].amount+=o.amount;return}t.push(o)}),t}var E={answer:{},article:{},question:{}};function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload,s=t.id;if(n===f.ADD_REWARD.success)return(0,i._)((0,o._)({},e),{answer:(0,i._)((0,o._)({},e.answer),(0,r._)({},s,{users:e.answer[s].users,tradeNumber:c.tradeNumber}))});if(n===f.REMOVE_TRADE_NUMBER){var l=t.appsType;return(0,i._)((0,o._)({},e),(0,r._)({},l,(0,i._)((0,o._)({},e[l]),(0,r._)({},s,{users:e.answer[s].users,tradeNumber:""}))))}if(n===f.ADD_REWARD_TAGLINE)return(0,i._)((0,o._)({},e),{answer:(0,i._)((0,o._)({},e.answer),(0,r._)({},s,{users:e.answer[s].users,tradeNumber:e[s].tradeNumber,rewardTagline:t.text}))});if(n===f.GET_REWARD_USER.success)return(0,i._)((0,o._)({},e),{answer:(0,i._)((0,o._)({},e.answer),(0,r._)({},s,{users:e.answer[s]?u()((0,a._)(e.answer[s].users).concat((0,a._)(c.data)),"id"):c.data,endpoint:c.paging.next}))});if(n===f.ON_REWARD_SUCCESS){var d=t.users,p=t.appsType;return(0,i._)((0,o._)({},e),(0,r._)({},p,(0,i._)((0,o._)({},e[p]),(0,r._)({},s,{users:d}))))}if(n===f.GET_REWARD_USER_DETAILS.success){var h=T(c.data);return(0,i._)((0,o._)({},e),{answer:(0,i._)((0,o._)({},e.answer),(0,r._)({},s,{users:e.answer[s]?u()((0,a._)(e.answer[s].users).concat((0,a._)(h)),"id"):h,notice:c.notice,endpoint:c.paging.next}))})}if(n===f.UPDATE_QUESTION_REWARDINFO){var _=t.questionId,m=t.isRewardable;return(0,i._)((0,o._)({},e),{question:(0,i._)((0,o._)({},e.question),(0,r._)({},_,{isRewardable:m}))})}else if(n===f.GET_ARTICLE_REWARD_USER.success)return(0,i._)((0,o._)({},e),{article:(0,i._)((0,o._)({},e.article),(0,r._)({},s,(0,o._)({},c)))});else if(n===f.GET_PAGING_ARTICLE_REWARD_USER.success){var g=c.data,y=c.paging.next;return(0,i._)((0,o._)({},e),{article:(0,i._)((0,o._)({},e.article),(0,r._)({},s,(0,i._)((0,o._)({},e.article[s]),{users:g,endpoint:y})))})}else if(n===f.GET_PAGING_ARTICLE_REWARD_USER_DETAILS.success){var C=c.data,S=c.paging.next,I=c.notice,A=T(C);return(0,i._)((0,o._)({},e),{article:(0,i._)((0,o._)({},e.article),(0,r._)({},s,(0,i._)((0,o._)({},e.article[s]),{users:A,notice:I,endpoint:S})))})}else if(n===f.UPDATE_ARTICLE_REWARD.success){var b=t.tagline,w=t.canTip;return(0,i._)((0,o._)({},e),{article:(0,i._)((0,o._)({},e.article),(0,r._)({},s,(0,i._)((0,o._)({},e.article[s]),{bio:b,canTip:w})))})}else if(n===f.ADD_ARTICLE_REWARD.success)return(0,i._)((0,o._)({},e),{article:(0,i._)((0,o._)({},e.article),(0,r._)({},s,(0,i._)((0,o._)({},e.article[s]),{tradeNumber:c.tradeNumber})))});else if(n===f.UPDATE_REWARD_FOLLOWERS.request){var Z=t.rewardType,x=t.id,k=t.user,R=t.count,N=t.expect,O=t.index,P=e[Z][x].users.map(function(e,t){return t===O&&(e.followerCount=k.followerCount+R,e.isFollowing=N),e});return(0,i._)((0,o._)({},e),(0,r._)({},Z,(0,i._)((0,o._)({},e[Z]),(0,r._)({},x,(0,i._)((0,o._)({},e[Z][x]),{users:P})))))}else if(n===f.UPDATE_REWARD_FOLLOWERS.failure){var D=t.rewardType,L=t.id,M=t.user,B=t.index,U=e[D][L].users.map(function(e,t){var n=e;return B===t&&(n=M),n});return(0,i._)((0,o._)({},e),(0,r._)({},D,(0,i._)((0,o._)({},e[D]),(0,r._)({},L,(0,i._)((0,o._)({},e[D][L]),{users:U})))))}return e}},87964:function(e,t,n){"use strict";n.d(t,{ZP:function(){return _},OQ:function(){return f}});var r=n(87320),o=n(55164),i=n(57477),a=n(97379),c=n.n(a),s=n(54463),u=n.n(s);n(28953);var l=n(4661),d="roundtable",p=(0,o._)({},(0,l.FH)(d,["LOAD_OLD_ROUNDTABLE","LOAD_ROUNDTABLE_LIST","LOAD_ROUNDTABLE_DETAIL","LOAD_ROUNDTABLE_HOT_QUESTIONS","LOAD_ROUNDTABLE_WARM_UP_CONTENTS","LOAD_ROUNDTABLE_HOT_DISCUSSIONS","LOAD_ROUNDTABLE_SELECTED_CONTENTS","TOGGLE_FOLLOW_ROUNDTABLE"]),(0,l.co)(d,["EMPTY_ROUNDTABLE"]));function f(e){return function(t,n){var o=n().entities.roundtables[e],i=o.isFollowing,a=o.followersCount;return t({API:{types:p.TOGGLE_FOLLOW_ROUNDTABLE,endpoint:"roundtables/".concat(e,"/followers"),method:i?"DELETE":"POST"},UPDATE:{request:{roundtables:(0,r._)({},e,{isFollowing:!i,followersCount:i?a-1:a+1})},failure:{roundtables:(0,r._)({},e,o)}}})}}var h={hotQuestions:{},warmupContents:{},hotDiscussions:{},selectedContents:{},roundtables:{}},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case p.LOAD_ROUNDTABLE_LIST.request:return(0,i._)((0,o._)({},e),{roundtables:(0,i._)((0,o._)({},e.roundtables),{isLoading:!0})});case p.LOAD_ROUNDTABLE_LIST.failure:return(0,i._)((0,o._)({},e),{roundtables:(0,i._)((0,o._)({},e.roundtables),{isLoading:!1})});case p.LOAD_ROUNDTABLE_LIST.success:if(a){var s=a.data,l=a.paging;return(0,i._)((0,o._)({},e),{roundtables:(0,i._)((0,o._)({},e.roundtables),{isLoading:!1,paging:l,data:u()(e.roundtables.data,s,"urlToken")})})}return(0,i._)((0,o._)({},e),{roundtables:(0,i._)((0,o._)({},e.roundtables),{isLoading:!1})});case p.LOAD_ROUNDTABLE_HOT_QUESTIONS.request:var d=t.meta.urlToken;return(0,i._)((0,o._)({},e),{hotQuestions:(0,i._)((0,o._)({},e.hotQuestions),(0,r._)({},d,(0,i._)((0,o._)({},e.hotQuestions[d]),{isLoading:!0})))});case p.LOAD_ROUNDTABLE_HOT_QUESTIONS.failure:var f=t.meta.urlToken;return(0,i._)((0,o._)({},e),{hotQuestions:(0,i._)((0,o._)({},e.hotQuestions),(0,r._)({},f,(0,i._)((0,o._)({},e.hotQuestions[f]),{isLoading:!1})))});case p.LOAD_ROUNDTABLE_HOT_QUESTIONS.success:var _,m=t.meta.urlToken,g=a.data,T=a.paging,E=g.map(function(e){var t=e.question,n=e.answers;return t?{question:{id:t.id},answers:n.map(function(e){return{id:e.id}})}:null});return(0,i._)((0,o._)({},e),{hotQuestions:(0,i._)((0,o._)({},e.hotQuestions),(0,r._)({},m,(0,i._)((0,o._)({},e.hotQuestions[m]),{isLoading:!1,paging:T,data:c()(null===(_=e.hotQuestions[m])||void 0===_?void 0:_.data,E)})))});case p.LOAD_ROUNDTABLE_WARM_UP_CONTENTS.request:var y=t.meta.urlToken;return(0,i._)((0,o._)({},e),{warmupContents:(0,i._)((0,o._)({},e.warmupContents),(0,r._)({},y,(0,i._)((0,o._)({},e.warmupContents[y]),{isLoading:!0})))});case p.LOAD_ROUNDTABLE_WARM_UP_CONTENTS.failure:var C=t.meta.urlToken;return(0,i._)((0,o._)({},e),{warmupContents:(0,i._)((0,o._)({},e.warmupContents),(0,r._)({},C,(0,i._)((0,o._)({},e.warmupContents[C]),{isLoading:!1})))});case p.LOAD_ROUNDTABLE_WARM_UP_CONTENTS.success:var S=t.meta.urlToken,I=a.data.map(function(e){return{question:{id:e.id}}});return(0,i._)((0,o._)({},e),{warmupContents:(0,i._)((0,o._)({},e.warmupContents),(0,r._)({},S,(0,i._)((0,o._)({},e.warmupContents[S]),{isLoading:!1,data:I})))});case p.LOAD_ROUNDTABLE_HOT_DISCUSSIONS.request:var A=t.meta.urlToken;return(0,i._)((0,o._)({},e),{hotDiscussions:(0,i._)((0,o._)({},e.hotDiscussions),(0,r._)({},A,(0,i._)((0,o._)({},e.hotDiscussions[A]),{isLoading:!0})))});case p.LOAD_ROUNDTABLE_HOT_DISCUSSIONS.failure:var b=t.meta.urlToken;return(0,i._)((0,o._)({},e),{hotDiscussions:(0,i._)((0,o._)({},e.hotDiscussions),(0,r._)({},b,(0,i._)((0,o._)({},e.hotDiscussions[b]),{isLoading:!1})))});case p.LOAD_ROUNDTABLE_HOT_DISCUSSIONS.success:var w,Z=t.meta.urlToken,x=a.paging,k=a.data.map(function(e){var t=e.question,n=e.answers,r=e.article;return t?{question:{id:t.id},answers:(null==n?void 0:n.map(function(e){return{id:e.id}}))||[]}:r?{article:{id:r.id}}:null});return(0,i._)((0,o._)({},e),{hotDiscussions:(0,i._)((0,o._)({},e.hotDiscussions),(0,r._)({},Z,(0,i._)((0,o._)({},e.hotDiscussions[Z]),{isLoading:!1,paging:x,data:c()(null===(w=e.hotDiscussions[Z])||void 0===w?void 0:w.data,k)})))});case p.LOAD_ROUNDTABLE_SELECTED_CONTENTS.request:var R=t.meta.urlToken;return(0,i._)((0,o._)({},e),{selectedContents:(0,i._)((0,o._)({},e.selectedContents),(0,r._)({},R,(0,i._)((0,o._)({},e.selectedContents[R]),{isLoading:!0})))});case p.LOAD_ROUNDTABLE_SELECTED_CONTENTS.failure:var N=t.meta.urlToken;return(0,i._)((0,o._)({},e),{selectedContents:(0,i._)((0,o._)({},e.selectedContents),(0,r._)({},N,(0,i._)((0,o._)({},e.selectedContents[N]),{isLoading:!1})))});case p.LOAD_ROUNDTABLE_SELECTED_CONTENTS.success:var O,P=t.meta.urlToken,D=a.paging,L=a.data.map(function(e){var t=e.answer,n=e.article;return t?{answer:{id:t.id}}:n?{article:{id:n.id}}:null});return(0,i._)((0,o._)({},e),{selectedContents:(0,i._)((0,o._)({},e.selectedContents),(0,r._)({},P,(0,i._)((0,o._)({},e.selectedContents[P]),{isLoading:!1,paging:D,data:c()(null===(O=e.selectedContents[P])||void 0===O?void 0:O.data,L)})))});case p.EMPTY_ROUNDTABLE:return(0,o._)({},e,h);default:return e}}},40861:function(e,t,n){"use strict";n.d(t,{ZP:function(){return s},kB:function(){return c}});var r=n(87320),o=n(55164),i=n(57477),a=(0,n(4661).FH)("shareText",["GET"]);function c(e,t){return{id:e,shareType:t,API:{types:a.GET,endpoint:"".concat(t,"s/").concat(e),query:{include:"share_text"}}}}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===a.GET.success){var n=t.id,c=t.shareType,s=t.payload.shareText;return(0,i._)((0,o._)({},e),(0,r._)({},"".concat(c).concat(n),s))}return e}},55344:function(e,t,n){"use strict";n.d(t,{X2:function(){return g},yS:function(){return m}});var r=n(9338),o=n(55164),i=n(57477),a=n(30971),c=n(74135),s=n(18837),u=n.n(s),l=n(46942),d=n.n(l),p=n(31824),f=n(93292),h=n(80523),_=(0,n(4661).FH)("switches",["GET","GET_VIP_SWITCHES"]),m=["hong-yuan-81-63","te-bie-mi-wang","15101089713","lewisiii","zhihuadmin","fei-xiao-gui","yan-sha-long","dong-hua-si-shu","bei-sen-80-3","2c0db1125100e7229cf159f66d859f8e","807e863f27d8bdb7d3bde20a991ace1d","c64379c8e25578f97e29c6395401d234","869e3a50498ee9f9b4e062267f4d7007","3d198a56310c02c4a83efb9f4a4c027e","41cd5c7249081389da3a523b3cb0629b","dbe159e1503acb112148055bb5b87e1d","07738e6e3211b95849334a4dc95a60a0","bab986472d44f9caa8d2c875f225b216","3b4c31848309b4109a738ee0e523cad7"],g=function(e){var t;return t=(0,r._)(function(t,n){return(0,a.__generator)(this,function(r){switch(r.label){case 0:return[4,Promise.all(e.map(function(e){return t(function(t,n,r){var o=r.fnRefs;return(0,h.Z)(o,"loadSwitches",function(){return u()((0,f.Z)(function(e){return t(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return function(t,n){var r=n(),o=r.currentUser,i=r.switches;if(o){var a=e.filter(function(e){return!(e in i)});if(a.length)return t({API:{types:_.GET,endpoint:"me/switches",query:{include:d()(a.map(c.decamelize)).join(",")}},meta:{couldSuperVideoUpload:-1!==m.indexOf(o)},NOTIFICATION:!1,FAILSAFE:!0})}}}(e.flat()))},queueMicrotask))})(e)})}))];case 1:return r.sent(),[2,n().switches]}})}),function(e,n){return t.apply(this,arguments)}};function T(e){return e.switches&&e.switches.vipSwitches}(0,p.P1)(T,function(e){return e&&e.mAINSWITCH&&e.sPEEDRENAME}),(0,p.P1)(T,function(e){return e&&e.mAINSWITCH&&e.vIPICON}),(0,p.P1)(T,function(e){return e&&e.mAINSWITCH&&e.wIDGET}),t.ZP=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _.GET.success:return(0,i._)((0,o._)({},e,t.payload),{couldSuperVideoUpload:t.meta.couldSuperVideoUpload});case _.GET_VIP_SWITCHES.success:return(0,i._)((0,o._)({},e),{vipSwitches:t.payload});default:return e}}},76741:function(e,t,n){"use strict";n.d(t,{Hp:function(){return X},HV:function(){return Y},ZP:function(){return eo},hX:function(){return K},KS:function(){return J},rl:function(){return Q}});var r,o=n(87320),i=n(55164),a=n(57477),c=n(49899),s=n(74135),u=n(71549),l=n.n(u),d=n(55536),p=n(69906),f=n(40195),h=n(85879),_=n(84),m=n(57045),g=n(28953),T=n(80714),E=n(65744),y=n(4661),C=n(58909),S=n(31824),I=n(87441),A=n(28814),b=function(e){return e&&e.items},w=function(e,t){var n=t.id;return e.entities.topics[n]},Z=function(e,t){var n=t.id;return e.topic.parent[n]};(0,S.P1)(Z,b);var x=(0,S.P1)(function(e,t){var n=t.id;return e.topic.children[n]},b),k=function(e,t){var n=t.id;return e.topic.bestAnswerers[n]};(0,S.P1)(k,b);var R=function(e){return function(t,n){var r=n.id;return t.topic[e][r]}},N=function(e){return(0,S.P1)(function(e){return e},(0,S.P1)(e,p.kf),function(e,t){return(0,a._)((0,i._)({},t),{items:(t.items||[]).map(function(t){return{sourceTopic:w(e,{id:t.sourceTopic}),target:(0,I.N7)(e,t.target)}})})})},O=R("top");N(O);var P=R("hot");N(P);var D=R("newest");N(D);var L=R("unanswered");N(L);var M=R("questions");N(M);var B=R("zivdeo");N(B);var U=R("zvideo-new");N(U);var G=R("pin20");N(G);var F=R("pin20-new");N(F);var H=R("pin");N(H);var z=R("followers");(0,S.P1)(function(e){return e},(0,S.P1)(z,p.kf),function(e,t){return(0,a._)((0,i._)({},t),{items:(t.items||[]).map(function(t){return(0,A.np)(e,{id:t})})})});var q=R("contributors");(0,S.P1)(function(e){return e},(0,S.P1)(q,p.kf),function(e,t){return(0,a._)((0,i._)({},t),{items:t.items||[]})});var V=(0,S.P1)(function(e,t){var n=t.id;return e.topic.intro[n]},function(e){return e&&e.abstract});(0,S.P1)([V,function(e,t){return t}],function(e,t){var n=t.sid;return e.filter(function(e){return e.sid!==n})}),(0,S.P1)([V,function(e,t){return t}],function(e,t){return t.rank.map(function(t){return e.find(function(e){return e.sid===t})})}),(0,S.P1)(k,x,Z,function(e,t,n){return e&&t&&n}),(0,S.P1)(w,function(e){if(e.showIntro)return!0;var t=e&&e.meta&&e.meta.category;return!!t&&(["variety_show","tv","movie","book","game"].includes(t)||t.startsWith("n_"))});var W={topicBasicMessage:"topicBasicMessage"},X=(0,y.FH)("topic",["GET","GET_VOTE","CREATE","GET_STICKY","GET_INTRO","GET_INDEX","GET_TOP","GET_HOT","GET_NEWEST","GET_ESSENCE_STICKY","UPDATE_ESSENCE_STICKY","GET_UNANSWERED","GET_QUESTIONS","GET_ZVIDEO","GET_ZVIDEO_NEW","GET_PIN20","GET_PIN20_NEW","GET_PIN","GET_PARENT","GET_CHILDREN","GET_BESTANSWERERS","GET_WIKI_META","GET_WIKI_EDIT_INFO","GET_COMMITTED_WIKI","VOTE_WIKI","GET_FOLLOWERS","GET_CONTRIBUTORS","UPDATE_FOLLOW","UPDATE_BIO","UPDATE","UPDATE_INTRO","GET_META_CATEGORIES","GET_META_CATEGORY","CREATE_META","UPDATE_META","GET_META","UPDATE_TOPIC_CONTRIBUTOR_FOLLOWERS","GET_CREATOR_WALL","GET_CREATOR_WALL_ENTRY","GET_CREATOR_WALL_USER_INFO","UPDATE_VOTE_TOPIC","COMMIT_WIKI","CREATE_ABSTRACT","UPDATE_ABSTRACT_RANK","DELETE_ABSTRACT","GET_LANDING_BASIC_DATA","GET_LANDING_EXCELLENT_ITEMS","GET_LANDING_EXCELLENT_EDITORS","GET_LANDING_CATALOG","GET_LANDING_ENTRIES","APPLY_LANDING_PERMISSION"]);function K(e){return{id:e,API:{types:X.GET,endpoint:"topics/".concat(e),query:{include:"introduction,questions_count,best_answers_count,followers_count,is_following,header_card"},root:"".concat(T.Z.fetchRoot.www,"/api/v5.1/")},UPDATE:{success:function(t){return(0,o._)({},"topics",(0,o._)({},e,function(e,t){var n=t.include,r=(void 0===n?{}:n).vote,o=t.permission,c=void 0===o?{}:o,s=c.isMetaEditable,u=c.isIndexEditable,l=c.viewCommit,d=c.editBaike,p=c.createBaike,f=c.addMoreInfo,h=t.include,_=void 0===h?{}:h,m=_.vote,g=void 0===m?{}:m,T=g.score,E=g.disliked,y=g.liked,C=_.meta,S=t.excerpt,I=t.introduction,A=t.wikiDescription,b=t.name,w=t.subtitle,Z=t.avatarUrl,x=t.pubInfo,k=void 0===x?{}:x,R=k.status,N=k.pubDate,O=t.themeConfig,P=(void 0===O?{}:O).avatarStyle;if(e===W.topicBasicMessage)return(0,a._)((0,i._)({},t),{relationship:{isMetaEditable:s},vote:(0,a._)((0,i._)({},r),{ratio:T,status:E?"dislike":y?"like":"none"}),headerCard:{description1:void 0===S?"":S,description2:void 0===I?"":I,wikiDescription:void 0===A?"":A,title:void 0===b?"":b,subtitle:void 0===w?"":w,avatarUrl:Z,pubInfo:{status:R,pubDate:N},config:{avatarType:P}},meta:void 0===C?{}:C,isIndexEditable:u,viewCommit:l,editBaike:d,createBaike:p,addMoreInfo:f})}("topicBasicMessage",t)))}}}}var j=/创建 ([\w\W]*) 话题/;function Y(e){return{API:{types:X.CREATE,endpoint:"/topics",method:"POST",body:{name:function e(t){return j.test(t)?e(t.match(j)[1]):t}(e)}},NOTIFICATION:{failure:function(t){return 269!==t.code||((0,E.t)((0,h.BX)("div",{children:["该话题被暂停使用，请",(0,h.tZ)("a",{style:{color:"#3e7ac2"},href:"//".concat(T.Z.wwwHost,"/messages/3d198a56310c02c4a83efb9f4a4c027e?").concat(m.stringify({message:"我想要创建「".concat(e,"」话题，系统提示被暂停使用，需要恢复")})),children:"私信「知一声」"}),"申请恢复创建"]}),{delay:6e3}),!1)}}}}function Q(e,t){return{API:{types:X.UPDATE_BIO,endpoint:"/topics/".concat(e,"/bio"),body:(0,s.decamelizeKeys)({bio:t}),method:"PUT"},id:e,bio:t}}function J(e,t){return function(n,r){var c,s=r(),u=(0,C.ib)(s),l=w(s,{id:e}),d=(t=void 0===t?!l.isFollowing:t)?1:-1,p={request:{},failure:{}};return l&&(p.request.topics=(0,o._)({},e,{isFollowing:t}),p.failure.topics=(0,o._)({},e,l)),u&&(p.request.users=(0,o._)({},u.urlToken,{followingTopicCount:u.followingTopicCount+d}),p.failure.users=(0,o._)({},u.urlToken,u)),n((0,i._)((0,a._)((0,i._)({},u&&{urlToken:u.urlToken}),{topicId:e,UPDATE:p}),(c=t,{API:{types:X.UPDATE_FOLLOW,endpoint:"topics/".concat(e,"/followers"),method:c?"POST":"DELETE"}})))}}function $(e,t){var n=t.resource,r=t.endpoint,o=t.types,c=t.query,s="".concat(T.Z.fetchRoot.www,"/api");return{id:e,API:(0,a._)((0,i._)({types:o},r?{root:s,endpoint:r}:{root:s,endpoint:"/v5.1/topics/".concat(e,"/feeds/").concat(n,"/v2"),query:{include:"data[?(target.type=topic_sticky_module)].target.data[?(target.type=answer)].target.content,relationship.is_authorized,is_author,voting,is_thanked,is_nothelp;data[?(target.type=topic_sticky_module)].target.data[?(target.type=answer)].target.is_normal,comment_count,voteup_count,content,relevant_info,excerpt.author.badge[?(type=best_answerer)].topics;data[?(target.type=topic_sticky_module)].target.data[?(target.type=article)].target.content,voteup_count,comment_count,voting,author.badge[?(type=best_answerer)].topics;data[?(target.type=topic_sticky_module)].target.data[?(target.type=people)].target.answer_count,articles_count,gender,follower_count,is_followed,is_following,badge[?(type=best_answerer)].topics;data[?(target.type=answer)].target.annotation_detail,content,hermes_label,is_labeled,relationship.is_authorized,is_author,voting,is_thanked,is_nothelp,answer_type;data[?(target.type=answer)].target.author.badge[?(type=best_answerer)].topics;data[?(target.type=answer)].target.paid_info;data[?(target.type=article)].target.annotation_detail,content,hermes_label,is_labeled,author.badge[?(type=best_answerer)].topics;data[?(target.type=question)].target.annotation_detail,comment_count;"}}),{query:c}),schema:g.l.TOPIC_FEED_ARRAY}}function ee(e,t){return function(n,r){return function(o,i){var a=(e(i(),{id:n})||{}).next,c=r||{},s=c.offset,u=c.limit,l=s||!a?{offset:s,limit:u}:{endpoint:a};return o(t(n,l))}}}ee(O,function(e,t){return $(e,(0,a._)((0,i._)({},t),{resource:"top_activity",types:X.GET_TOP}))}),ee(P,function(e,t){return $(e,(0,a._)((0,i._)({},t),{resource:"essence",types:X.GET_HOT}))}),ee(D,function(e,t){return $(e,(0,a._)((0,i._)({},t),{resource:"timeline_activity",types:X.GET_NEWEST}))});var et={collection:"favlist",live_course:"liveCourse",search_course:"liveCourse",search_special:"liveSpecial",publication:"ebook",people:"user",topic_sticky_module:"topicStickyModule",edu_section:"eduSection"};new _.fK.Array(new _.fK.Object({data:new _.fK.Array({target:new _.fK.Union({answer:g.l.ANSWER,article:g.l.ARTICLE,zvideo:g.l.ZVIDEO,pin:g.l.PIN},function(e){var t=e.type;return et[t]||t}),sourceTopic:g.l.TOPIC})})),ee(L,function(e,t){return $(e,(0,a._)((0,i._)({},t),{resource:"top_question",types:X.GET_UNANSWERED}))}),ee(M,function(e,t){return $(e,(0,a._)((0,i._)({},t),{resource:"new_question",types:X.GET_QUESTIONS}))}),ee(B,function(e,t){return $(e,(0,a._)((0,i._)({},t),{resource:"top_zvideo",types:X.GET_ZVIDEO}))}),ee(U,function(e,t){return $(e,(0,a._)((0,i._)({},t),{resource:"new_zvideo",types:X.GET_ZVIDEO_NEW}))}),ee(G,function(e,t){return $(e,(0,a._)((0,i._)({},t),{resource:"pin-hot",types:X.GET_PIN20}))}),ee(F,function(e,t){return $(e,(0,a._)((0,i._)({},t),{resource:"pin-new",types:X.GET_PIN20_NEW}))}),ee(H,function(e,t){return $(e,(0,a._)((0,i._)({},t),{resource:"pin-new",types:X.GET_PIN,query:{offset:0,limit:30}}))}),ee(z,function(e,t){var n=t.offset,r=t.limit,o=void 0===r?20:r,a=t.endpoint;return{id:e,API:(0,i._)({types:X.GET_FOLLOWERS},a?{endpoint:a}:{endpoint:"topics/".concat(e,"/followers"),query:{offset:n,limit:o,include:"data[*].gender,answer_count,articles_count,follower_count,is_following,is_followed"}}),offset:n,limit:o,schema:g.l.USER_ARRAY}}),ee(q,function(e,t){var n=t.offset,r=t.limit,o=void 0===r?20:r,a=t.endpoint;return{id:e,API:(0,i._)({types:X.GET_CONTRIBUTORS},a?{endpoint:a}:{endpoint:"topics/".concat(e,"/contributors"),query:{offset:n,limit:o,include:"data[*].gender,is_following,is_followed"}}),offset:n,limit:o,schema:g.l.USER_ARRAY}});var en=Object.prototype.hasOwnProperty;function er(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(n.type===e){var r=n.payload,a=n.id;return(0,i._)({},t,r.data?(0,o._)({},a,{items:r.data,next:(r.paging||{}).next,isDrained:(r.paging||{}).isEnd}):(0,o._)({},a,n.result||r))}return t}}var eo=(0,d.combineReducers)((r={bios:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f.Hp.GET_BIOS.request:return(0,a._)((0,i._)({},e),{isFetching:!0});case f.Hp.GET_BIOS.success:return t.payload.data.reduce(function(e,t){var n=t.topic.id,r=t.bio;return(0,a._)((0,i._)({},e),(0,o._)({},n,r))},(0,a._)((0,i._)({},e),{isFetching:!1}));case f.Hp.GET_BIOS.failure:return(0,a._)((0,i._)({},e),{isFetching:!1});case X.UPDATE_BIO.success:return(0,a._)((0,i._)({},e),(0,o._)({},t.id,t.bio));default:return e}},hot:(0,p.QT)(X.GET_HOT),newest:(0,p.QT)(X.GET_NEWEST),top:(0,p.QT)(X.GET_TOP),sticky:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===X.GET_ESSENCE_STICKY.success?t.payload||null:e},pin:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id;switch(t.type){case X.GET_PIN.success:return(0,o._)({},n,(0,a._)((0,i._)({data:t.result},e[n]),{isFetching:!1,isDrained:!0}));case X.GET_PIN.request:return(0,o._)({},n,(0,a._)((0,i._)({},e[n]),{isFetching:!0,isDrained:!0}));default:return e}},unanswered:(0,p.QT)(X.GET_UNANSWERED),questions:(0,p.QT)(X.GET_QUESTIONS),zivdeo:(0,p.QT)(X.GET_ZVIDEO),"zvideo-new":(0,p.QT)(X.GET_ZVIDEO_NEW),pin20:(0,p.QT)(X.GET_PIN20),"pin20-new":(0,p.QT)(X.GET_PIN20_NEW),followers:(0,p.QT)(X.GET_FOLLOWERS),contributors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.id;switch(t.type){case X.GET_CONTRIBUTORS.request:return(0,a._)((0,i._)({},e),(0,o._)({},r,(0,a._)((0,i._)({},e[r]),{isFetching:!0,isDrained:!1})));case X.GET_CONTRIBUTORS.success:return(0,i._)({},e,n.data?(0,o._)({},r,{items:n.data,next:(n.paging||{}).next,isDrained:(n.paging||{}).isEnd,isFetching:!1}):(0,o._)({},r,t.result||n));case X.GET_CONTRIBUTORS.failure:return(0,a._)((0,i._)({},e),(0,o._)({},r,(0,a._)((0,i._)({},e[r]),{isFetching:!1,isDrained:!0})));case X.UPDATE_TOPIC_CONTRIBUTOR_FOLLOWERS.success:var c=t.userUrlToken,s=e[r].items.map(function(e){var t=e.author,n=e.author,r=n.urlToken,o=n.isFollowing;return r===c?(0,a._)((0,i._)({},e),{author:(0,a._)((0,i._)({},t),{isFollowing:!o})}):e});return(0,a._)((0,i._)({},e),(0,o._)({},r,(0,a._)((0,i._)({},e[r]),{items:s})));default:return e}},parent:er(X.GET_PARENT.success),children:er(X.GET_CHILDREN.success),bestAnswerers:er(X.GET_BESTANSWERERS.success)},(0,o._)(r,"wikiMeta",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id;switch(t.type){case X.GET_WIKI_META.success:return(0,a._)((0,i._)({},e),(0,o._)({},n,t.payload));case X.VOTE_WIKI.success:var r=t.upVote,c=e[n].voteInfo.num;return(0,a._)((0,i._)({},e),(0,o._)({},n,(0,a._)((0,i._)({},e[n]),{hasVoted:r,voteInfo:{num:r?c+1:c-1}})));default:return e}}),(0,o._)(r,"index",er(X.GET_INDEX.success)),(0,o._)(r,"intro",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,r=t.topicAbstract,c=t.topicRestAbstract,s=t.topicRankedAbstract;switch(t.type){case X.GET_INTRO.success:return(0,a._)((0,i._)({},e),(0,o._)({},n,t.payload));case X.DELETE_ABSTRACT.request:return(0,a._)((0,i._)({},e),(0,o._)({},n,(0,a._)((0,i._)({},e[n]),{abstract:c})));case X.UPDATE_ABSTRACT_RANK.request:return(0,a._)((0,i._)({},e),(0,o._)({},n,(0,a._)((0,i._)({},e[n]),{abstract:void 0===s?[]:s})));case X.DELETE_ABSTRACT.failure:case X.UPDATE_ABSTRACT_RANK.failure:return(0,a._)((0,i._)({},e),(0,o._)({},n,(0,a._)((0,i._)({},e[n]),{abstract:r})));default:return e}}),(0,o._)(r,"meta",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case X.GET_META.success:return(0,a._)((0,i._)({},e),(0,o._)({},t.id,t.payload.data));case X.UPDATE_META.success:var n=t.id,r=t.payload,c=e[n];return(0,a._)((0,i._)({},e),(0,o._)({},n,c.map(function(e){var t=e.target;if("Table"===t.type)return(0,a._)((0,i._)({},e),{target:(0,a._)((0,i._)({},e.target),{value:t.value.map(function(e){var t=(0,s.camelize)(e.target.name);return en.call(r,t)?(0,a._)((0,i._)({},e),{target:(0,a._)((0,i._)({},e.target),{value:r[t].value})}):e})})});if(Array.isArray(t))return(0,a._)((0,i._)({},e),{target:t.map(function(e){var t=(0,s.camelize)(e.target.name);return en.call(r,t)?(0,a._)((0,i._)({},e),{target:(0,a._)((0,i._)({},e.target),{value:r[t].value})}):e})});var n=(0,s.camelize)(t.name);return en.call(r,n)?(0,a._)((0,i._)({},e),{target:(0,a._)((0,i._)({},e.target),{value:r[n].value})}):e})));default:return e}}),(0,o._)(r,"schema",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case X.GET_META_CATEGORIES.success:return(0,a._)((0,i._)({},e),{categories:t.payload.data});case X.GET_META_CATEGORY.success:return(0,a._)((0,i._)({},e),{category:(0,a._)((0,i._)({},e.category),(0,o._)({},t.category,t.payload.schema))});default:return e}}),(0,o._)(r,"creatorWall",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.id;if(t.type===X.GET_CREATOR_WALL.request)return l()(e,(0,o._)({},r,{paging:{loading:!0}}));if(t.type===X.GET_CREATOR_WALL.success){var s=e[r],u=(void 0===s?{}:s).items,d=void 0===u?[]:u;return(0,a._)((0,i._)({},e),(0,o._)({},r,(0,a._)((0,i._)({},n),{items:(0,c._)(d).concat((0,c._)(t.result)),paging:(0,a._)((0,i._)({},n.paging),{loading:!1})})))}return e}),(0,o._)(r,"wikiEditInfo",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,r=t.type,c=t.payload;if(r===X.GET_WIKI_EDIT_INFO.success){var s=c.canEdit,u=c.hasCommit;return void 0===s||void 0===u?e:(0,a._)((0,i._)({},e),(0,o._)({},n,c))}return e}),(0,o._)(r,"committedWiki",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.id,r=t.type,c=t.payload;if(r===X.GET_COMMITTED_WIKI.success){var s=c.data;return s?(0,a._)((0,i._)({},e),(0,o._)({},n,s)):e}return e}),(0,o._)(r,"landingBasicData",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===X.GET_LANDING_BASIC_DATA.success?r:e}),(0,o._)(r,"landingExcellentItems",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===X.GET_LANDING_EXCELLENT_ITEMS.success?r.excellentItems:e}),(0,o._)(r,"landingExcellentEditors",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===X.GET_LANDING_EXCELLENT_EDITORS.success?r.editors:e}),(0,o._)(r,"landingCatalog",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===X.GET_LANDING_CATALOG.success?r.data:e}),(0,o._)(r,"landingEntries",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;return n===X.GET_LANDING_ENTRIES.success?r:e}),r))},42308:function(e,t,n){"use strict";n.d(t,{ZP:function(){return g},Ix:function(){return m},x1:function(){return _}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(97614),s=n(74135),u=n(85009),l=n(77440),d=n(4661),p=new Proxy({},{get:function(){return function(){}}}),f=(0,d.FH)("upload",["IMAGE","VIDEO"]);function h(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return p.info("创建API上传Action",{uploadId:n,sourceType:r,valueType:void 0===e?"undefined":(0,c._)(e),endpoint:"/uploaded_images",hasNotification:"default"!==n}),(0,o._)({NOTIFICATION:"default"!==n&&{failure:"上传失败"},uploadId:n},(t=new FormData,"string"==typeof e?t.append("url",e):t.append("picture",e),r&&t.append("source",r),{API:{types:f.IMAGE,endpoint:"/uploaded_images",method:"POST",body:t,headers:{Accept:"application/json"},fetchOptions:{credentials:"include",signal:null==i?void 0:i.signal}}}))}var _=(0,l.aF)(u.ZP,!0),m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;return function(c){var u="string"!=typeof e;return(p.info("6️⃣ 上传策略判断",{uploadId:t,strategy:u?"OSS 直传":"旧的 /uploaded_images 上传"}),u)?(p.info("7️⃣ OSS直传开始",{uploadId:t,fileSize:e.size}),_(e,{source:r,autoRotate:o},{timeoutMs:3e4,abortController:i}).then(function(e){return p.info("8️⃣ OSS直传成功",{uploadId:t,imageUrl:e.src,hash:e.hash}),c({type:f.IMAGE.success,uploadId:t,payload:(0,s.camelizeKeys)(e)})},function(o){var s;if((null==o?void 0:o.name)==="AbortError"||(null==i?void 0:null===(s=i.signal)||void 0===s?void 0:s.aborted))throw p.info("上传被取消",{uploadId:t,error:o.message||"Aborted"}),o;if(p.info("OSS直传失败，降级到API上传",{uploadId:t,error:o.message||"Unknown error",fallbackStrategy:"API"}),n.g.raven){var u=Error(o.message);u.name="UploadError",n.g.raven.captureException(u),n.g.raven.captureException(o)}return(0,l.aF)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return c(h.apply(void 0,(0,a._)(t)))})(e,t,r,i)})):(0,l.aF)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return c(h.apply(void 0,(0,a._)(t)))})(e,t,r,i)}};function g(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f.IMAGE.request:case f.IMAGE.failure:return(0,i._)((0,o._)({},e),(0,r._)({},t.uploadId,null));case f.IMAGE.success:return(0,i._)((0,o._)({},e),(0,r._)({},t.uploadId,{url:t.payload.src,rawWidth:t.payload.dataRawwidth,rawHeight:t.payload.dataRawheight,id:t.payload.hash}));case f.VIDEO.request:case f.VIDEO.failure:return(0,i._)((0,o._)({},e),{video:null});case f.VIDEO.success:return(0,i._)((0,o._)({},e),{video:t.payload});default:return e}}},96354:function(e,t,n){"use strict";n.d(t,{Yr:function(){return c},ZP:function(){return l},nh:function(){return s}});var r=n(55164),o=n(57477),i=n(4661),a=(0,r._)({},(0,i.FH)("userProfit",["GET_MEMBER_STATUS","UPDATE_MEMBER_STATUS","GET_USER_PROFIT_PERMISSION","GET_LINK_CARD_LIMIT"]));function c(){return{API:{types:a.GET_USER_PROFIT_PERMISSION,endpoint:"mcn/permission/profit"}}}function s(){return{API:{types:a.GET_LINK_CARD_LIMIT,endpoint:"mcn/v2/limit/linkcard"}}}var u={permission:{permissionStatus:{zhiZixuan:0,recommend:-1,task:0,plugin:0,infinity:0},visible:!1},linkCardLimit:0};function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;return t.type===a.GET_USER_PROFIT_PERMISSION.success?(0,o._)((0,r._)({},e),{permission:t.payload}):t.type===a.GET_LINK_CARD_LIMIT.success?(0,o._)((0,r._)({},e),{linkCardLimit:t.payload.data}):e}},28814:function(e,t,n){"use strict";n.d(t,{KX:function(){return d},cw:function(){return u},np:function(){return l}});var r=n(87320),o=n(84),i=n(28953),a=n(4661),c=n(67927),s=n(66263),u=(0,a.FH)("user",["UPDATE_FOLLOWERS","LOAD_USER_DMP_CROWD","RECOMMEND_FOLLOW_PEOPLE_TOPSTORY"]),l=function(e,t){var n=t.urlToken,r=t.id,o=e.entities.users,i=void 0===o?{}:o;return i[n||r]||i[Object.keys(i).find(function(e){return i[e].id===r})]};function d(e,t){return function(n,o){var i,a,l=o(),d=l.entities.users,p=l.currentUser,f=d[e]||{};if(f.isBlocked)return n((0,c.c0)(s.T$.blocked,"red"));var h=d[p],_=t?1:-1;return n({urlToken:p,userUrlToken:e,expect:t,API:{types:u.UPDATE_FOLLOWERS,endpoint:"members/".concat(e,"/followers"),method:t?"POST":"DELETE"},UPDATE:{request:{users:(i={},(0,r._)(i,f.urlToken,{followerCount:f.followerCount+_,isFollowing:t}),(0,r._)(i,h.urlToken,{followingCount:h.followingCount+_}),i)},failure:{users:(a={},(0,r._)(a,f.urlToken,f),(0,r._)(a,h.urlToken,h),a)},success:function(e){return{users:(0,r._)({},f.urlToken,e)}}}})}}new o.fK.Array(new o.fK.Object({actor:i.l.USER}))},37209:function(e,t,n){"use strict";n.d(t,{Ty:function(){return p},ZP:function(){return h},hK:function(){return d},o2:function(){return l}});var r=n(87320),o=n(55164),i=n(57477);n(74351);var a=n(80714),c=n(4661),s="".concat(a.Z.fetchRoot.lens,"/api"),u=(0,o._)({},(0,c.FH)("VIDEO",["GET","GET_DETAILS","CREATE","GET_VIDEO_DEFAULT_COVER"]));function l(e){return{id:e,API:{types:u.GET,root:s,endpoint:"/embedded_videos/".concat(e)}}}function d(e){return{id:e,API:{types:u.GET_DETAILS,root:"".concat(a.Z.fetchRoot.lens,"/api/v4"),endpoint:"/videos/".concat(e)}}}function p(e){return{API:{types:u.CREATE,root:s,endpoint:"/embedded_videos",method:"POST",body:{url:e}}}}var f={data:{},shareVideoDetail:{},last:{}};function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u.GET.success:return(0,i._)((0,o._)({},e),{data:(0,i._)((0,o._)({},e.data),(0,r._)({},t.id,t.payload))});case u.CREATE.success:return(0,i._)((0,o._)({},e),{data:(0,i._)((0,o._)({},e.data),(0,r._)({},t.payload.id,t.payload)),last:t.payload});case u.GET_DETAILS.success:return(0,i._)((0,o._)({},e),{shareVideoDetail:t.payload});default:return e}}},23561:function(e,t,n){"use strict";n.d(t,{Z:function(){return l},v:function(){return s}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=(0,n(4661).FH)("zhida",["FETCH_QA_SIDEBAR_ZHIDA_BANNER","FETCH_ANSWER_BOTTOM_ZHIDA_BANNER"]);function s(e){return{API:{types:c.FETCH_ANSWER_BOTTOM_ZHIDA_BANNER,endpoint:"/ai_ingress/community/answer/".concat(e,"/query")},meta:{id:e},FAILSAFE:!0}}var u={sidebar:{answer:{},question:{}},answerBottom:{}};function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0,n=t.type,s=t.payload,l=t.meta;if(n===c.FETCH_QA_SIDEBAR_ZHIDA_BANNER.success){var d=l.questionId,p=l.answerId,f=s.query,h=s.routerUrl,_=s.userList,m=s.userCount,g=p?"answer":"question",T=p||d;return(0,i._)((0,o._)({},e),{sidebar:(0,i._)((0,o._)({},e.sidebar),(0,r._)({},g,(0,i._)((0,o._)({},e[g]),(0,r._)({},T,{title:f,url:h,avatars:null==_?void 0:_.map(function(e){return e.avatarUrl}),amount:m}))))})}if(n===c.FETCH_ANSWER_BOTTOM_ZHIDA_BANNER.success){var E=s.data,y=l.id;return(0,i._)((0,o._)({},e),{answerBottom:(0,i._)((0,o._)({},e.answerBottom),(0,r._)({},y,(0,a._)(E)))})}return e}},41492:function(e,t,n){"use strict";n.d(t,{l0:function(){return W},ER:function(){return x},P6:function(){return H},ZP:function(){return j},B$:function(){return X},b_:function(){return q},eJ:function(){return M},My:function(){return V},Dc:function(){return K},XT:function(){return z},zg:function(){return F},Hi:function(){return R},SL:function(){return Z},jl:function(){return G},Fn:function(){return I},SM:function(){return L},DQ:function(){return P},Es:function(){return D},dc:function(){return b},W2:function(){return N},MM:function(){return k},XD:function(){return B},qO:function(){return w}});var r=n(87320),o=n(55164),i=n(57477),a=n(49899),c=n(74135),s=n(54463),u=n.n(s),l=n(84);n(92258);var d=n(55536),p=n(28953),f=n(84054),h=n.n(f),_=n(80714),m=n(4661),g=n(74167),T=(0,o._)({},(0,m.FH)("zvideoRecruit",["GET_FORM","POST_FORM"])),E={form:{platform:"",nickname:"",followerCount:"",domain:"",contact:""},submited:!1,ranking:[]},y=(0,o._)({},(0,m.FH)("zvideo",["GET","GET_INSERTABLE_ZVIDEOS","VOTE","LIKE","CHANGE_COMMENT_PERMISSION","TOGGLE_VISIBLE_STATUS","GET_DELETE_PROMPT_TEXT","REMOVE","GET_RECOMMENDATIONS","GET_CAMPAIGN","GET_CAMPAIGN_VIDEO","GET_CAMPAIGN_DETAIL","GET_CAMPAIGN_VIDEO_LIST","GET_TAGORE_CATEGORY","GET_TAGORE_RECOMMEND_CATEGORY","GET_MATCH_TOPIC","GET_CONTRIBUTABLE_ZVIDEO_CAMPAIGN","CREATE_DRAFT","GET_DRAFT","UPDATE_DRAFT","REMOVE_DRAFT","PUBLISH_DRAFT","PUBLISH_SCHEDULED_DRAFT","GET_ZVIDEO_BANNERS","UPDATE_ZVIDEO_UPLOAD_FEEDBACK","GET_QY_ACTIVITY","GET_TALK_ACTIVITY","GET_PARTY2022_ACTIVITY","GET_BATCHVIDEOS","GET_PUBLISH_LIMIT","LOAD_CREATION_REFERENCES","GET_SIMILAR_ZVIDEOS","GET_ZVIDEO_COLLECTION_LIST","GET_STICKY_PAGE_CONTENT","TOGGLE_ALLOW_STATUS","GET_COOP_AUTH","GET_IS_READ_PROTOCOL","AGREE_COOP_PROTOCOL","GET_COLLECT_LIST","CHECK_STICKY_LINK","GET_VIDEO_SOURCE","GET_PAID_COLUMN_INFO"])),C=new l.fK.Union({answer:p.l.ANSWER,zvideo:p.l.ZVIDEO},function(e){var t=e.type;return(0,c.camelize)(t)}),S=new l.fK.Array(C);function I(){return function(e,t){var n=(t().zvideos.insertable||{}).paging;return e({API:{types:y.GET_INSERTABLE_ZVIDEOS,endpoint:(null==n?void 0:n.next)||"/zvideos/insertable"}})}}var A=new l.fK.Entity("zvideos",{author:p.l.USER,creationRelationship:{coCreation:{refTo:{contents:[{answer:{author:p.l.USER},article:{author:p.l.USER}}]}}}},{idAttribute:function(e){return"zvideo_answer"===e.type?"zvideo_answer:".concat(e.id,":").concat(e.video.videoId):"zvideo_article"===e.type?"zvideo_article:".concat(e.id,":").concat(e.video.videoId):e.id?e.id:e.zvideoId}});function b(e){return{API:{types:y.GET,endpoint:"zvideos/".concat(e),query:{include:h()({reaction_instruction:!0,contribute:!0,creation_relationship:!0,ip_info:!0,reaction:!0})}},schema:A}}function w(e,t){return function(n,a){var c={API:{types:y.VOTE,method:"POST",endpoint:"zvideos/".concat(e,"/voters"),body:{voting:t},fetchOptions:{zsSignature:!0}}},s=a().entities.zvideos[e];if(s){var u,l=1===t?1:1===s.voting?-1:0;c=(0,i._)((0,o._)({},c),{UPDATE:{success:{zvideos:(0,r._)({},e,{voting:t,voteupCount:(null!==(u=s.voteupCount)&&void 0!==u?u:s.voteCount)+l})}}})}return n(c)}}function Z(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.notification,i=void 0===o||o;return function(n,o){var a={API:{types:y.LIKE,method:t?"POST":"DELETE",endpoint:"zvideos/".concat(e,"/likers"),fetchOptions:{zsSignature:!0}},NOTIFICATION:i},c=o().entities.zvideos[e];return c&&(a.UPDATE={success:function(){var n=(0,g.c)(c,t);return{zvideos:(0,r._)({},e,n)}}}),n(a)}}function x(e,t){return function(n,a){var s,u={API:{types:y.CHANGE_COMMENT_PERMISSION,method:"PUT",endpoint:"zvideos/".concat(e,"/comment_permission"),body:(0,c.decamelizeKeys)({commentPermission:t}),fetchOptions:{zsSignature:!0}}};return(null===(s=a().entities.zvideos)||void 0===s?void 0:s[e])&&(u=(0,i._)((0,o._)({},u),{UPDATE:{success:{zvideos:(0,r._)({},e,{commentPermission:t})}}})),n(u)}}function k(e){return function(t,n){var a=n().entities.zvideos[e],s=!a.isVisible,u={API:{types:y.TOGGLE_VISIBLE_STATUS,method:"PUT",endpoint:"zvideos/".concat(e,"/is_visible"),body:(0,c.decamelizeKeys)({isVisible:s}),fetchOptions:{zsSignature:!0}}};return a&&(u=(0,i._)((0,o._)({},u),{UPDATE:{success:{zvideos:(0,r._)({},e,{isVisible:s})}}})),t(u)}}function R(e){return{API:{types:y.GET_DELETE_PROMPT_TEXT,endpoint:"zvideos/".concat(e,"/delete-prompt")},FAILSAFE:!0}}function N(e){return{API:{types:y.REMOVE,method:"DELETE",endpoint:"zvideos/".concat(e),fetchOptions:{zsSignature:!0}}}}var O=[{title:"热门",name:"hot"},{title:"最新",name:"latest"}];function P(){return{API:{types:y.GET_TAGORE_CATEGORY,endpoint:"/tagore/categories/tree"}}}function D(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,n=e.title,r=e.content;return{API:{types:y.GET_TAGORE_RECOMMEND_CATEGORY,endpoint:"/tagore/categories/recommend",query:(0,c.decamelizeKeys)({type:t,title:n,content:r})}}}function L(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,n=e.text,r=e.offset,o=e.limit,i=e.firstLevelCategoryId,a=e.secondLevelCategoryId;return{API:{types:y.GET_MATCH_TOPIC,endpoint:"/recommendations/match-topics",query:(0,c.decamelizeKeys)({type:t,text:n,offset:void 0===r?0:r,limit:o,firstLevelCategoryId:i,secondLevelCategoryId:a})}}}function M(e){return{API:{types:y.GET_DRAFT,endpoint:"zvideos/drafts/".concat(e),method:"GET"}}}function B(e,t){return{API:{types:y.UPDATE_DRAFT,endpoint:"zvideos/drafts/".concat(e),method:"PATCH",body:(0,c.decamelizeKeys)(t)}}}var U=new l.fK.Object({authors:new l.fK.Array(new l.fK.Object({author:p.l.USER}))}),G=function(e){return{meta:{id:e},API:{types:y.LOAD_CREATION_REFERENCES,endpoint:"zvideos/".concat(e,"/creation-references")},schema:U}};function F(e){return function(t,n){var r=e.collection_id,o=(n().zvideos.zvideoCollection[r]||{}).paging;return t({meta:{id:r},API:{types:y.GET_ZVIDEO_COLLECTION_LIST,method:"POST",body:e,endpoint:(null==o?void 0:o.next)||"zvideo-collections/feeds",query:{limit:6,include:"answer"}},schema:S})}}var H=function(e){return{API:{types:y.CHECK_STICKY_LINK,method:"GET",endpoint:"/creation-relationship/content/qualification/v2",query:{text:e}}}},z=function(e){var t=e.type,n=e.id,r="",i="",a={};return"article"===t?(r="articles/".concat(n),i=_.Z.fetchRoot.zhuanlan,a={fetchOptions:{credentials:"include"}}):"answer"===t&&(r="answers/".concat(n),i="/api/v4/",a={query:{include:"thumbnail_info,is_visible,paid_info,paid_info_content,admin_closed_comment,reward_info,annotation_action,annotation_detail,collapse_reason,is_normal,is_sticky,collapsed_by,suggest_edit,comment_count,can_comment,content,editable_content,voteup_count,reshipment_settings,comment_permission,created_time,updated_time,review_info,relevant_info,question,excerpt,attachment,relationship.is_authorized,voting,is_thanked,is_author,is_nothelp,is_labeled;author.vip_info;author.kvip_info,badge[*].topics;settings.table_of_content.enabled"}}),{API:(0,o._)({types:y.GET_STICKY_PAGE_CONTENT,endpoint:r,root:i},a)}};function q(){return{API:{types:y.GET_COOP_AUTH,endpoint:"creation-relationship/creator/qualification",method:"GET"}}}function V(){return{API:{types:y.GET_IS_READ_PROTOCOL,endpoint:"creation-relationship/cocreation/agreement",method:"GET"}}}function W(){return{API:{types:y.AGREE_COOP_PROTOCOL,endpoint:"creation-relationship/cocreation/set/agree",method:"POST"}}}function X(e){return function(t,n){if(0===n().zvideos.collectData.list.length&&!e||e)return t({API:{types:y.GET_COLLECT_LIST,method:"GET",endpoint:e||"creation-relationship/fav-list?".concat(new URLSearchParams({offset:0,limit:10}).toString())}})}}function K(e){return{API:{types:y.GET_PAID_COLUMN_INFO,endpoint:"/column/paid-column/card?content_type=zvideo&content_id=".concat(e),method:"GET"},id:e}}var j=(0,d.combineReducers)({campaignVideoList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===y.GET_CAMPAIGN_DETAIL.success){var n=t.meta.id,c=t.payload.tabList;return(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},t.payload),{zvideos:c.reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t.tabId,{isLoading:!1,paging:{isEnd:!1,next:null},data:[]}))},{})})))}if(t.type===y.GET_CAMPAIGN_VIDEO_LIST.request||t.type===y.GET_CAMPAIGN_VIDEO_LIST.failure){var s=t.meta,u=s.id,l=s.tabId,d=t.type===y.GET_CAMPAIGN_VIDEO_LIST.request;return(0,i._)((0,o._)({},e),(0,r._)({},u,(0,i._)((0,o._)({},e[u]),{zvideos:(0,i._)((0,o._)({},e[u].zvideos),(0,r._)({},l,(0,i._)((0,o._)({},e[u].zvideos[l]),{isLoading:d})))})))}if(t.type===y.GET_CAMPAIGN_VIDEO_LIST.success){var p=t.meta,f=p.id,h=p.tabId,_=t.payload,m=_.paging,g=_.data;return(0,i._)((0,o._)({},e),(0,r._)({},f,(0,i._)((0,o._)({},e[f]),{zvideos:(0,i._)((0,o._)({},e[f].zvideos),(0,r._)({},h,(0,i._)((0,o._)({},e[f].zvideos[h]),{isLoading:!1,paging:m,data:(0,a._)(e[f].zvideos[h].data).concat((0,a._)(g))})))})))}return e},campaigns:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===y.GET_CAMPAIGN.success){var n=t.meta.id;return(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},t.payload),{zvideos:O.reduce(function(e,t){return(0,i._)((0,o._)({},e),(0,r._)({},t.name,{isLoading:!1,paging:{isEnd:!1,next:null},data:[]}))},{})})))}if(t.type===y.GET_CAMPAIGN_VIDEO.request||t.type===y.GET_CAMPAIGN_VIDEO.failure){var c=t.meta,s=c.id,u=c.typeName,l=t.type===y.GET_CAMPAIGN_VIDEO.request;return(0,i._)((0,o._)({},e),(0,r._)({},s,(0,i._)((0,o._)({},e[s]),{zvideos:(0,i._)((0,o._)({},e[s].zvideos),(0,r._)({},u,(0,i._)((0,o._)({},e[s].zvideos[u]),{isLoading:l})))})))}if(t.type===y.GET_CAMPAIGN_VIDEO.success){var d=t.meta,p=d.id,f=d.typeName,h=t.payload,_=h.paging,m=h.data;return(0,i._)((0,o._)({},e),(0,r._)({},p,(0,i._)((0,o._)({},e[p]),{zvideos:(0,i._)((0,o._)({},e[p].zvideos),(0,r._)({},f,(0,i._)((0,o._)({},e[p].zvideos[f]),{isLoading:!1,paging:_,data:(0,a._)(e[p].zvideos[f].data).concat((0,a._)(m))})))})))}return e},tagoreCategory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(t.type===y.GET_TAGORE_CATEGORY.success){var n=t.payload.data;return Array.isArray(n)?n:[]}return e},recommendations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y.GET_RECOMMENDATIONS.request:return(0,i._)((0,o._)({},e),(0,r._)({},t.key,(0,i._)((0,o._)({},e[t.key]),{isLoading:!0})));case y.GET_RECOMMENDATIONS.success:return(0,i._)((0,o._)({},e),(0,r._)({},t.key,(0,i._)((0,o._)({},e[t.key]),{isLoading:!1,paging:t.payload.paging,data:(0,a._)(e[t.key].data||[]).concat((0,a._)(t.payload.data))})));case y.GET_RECOMMENDATIONS.failure:return(0,i._)((0,o._)({},e),(0,r._)({},t.key,(0,i._)((0,o._)({},e[t.key]),{isLoading:!1})));default:return e}},insertable:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y.GET_INSERTABLE_ZVIDEOS.request:case y.GET_INSERTABLE_ZVIDEOS.failure:return(0,i._)((0,o._)({},e),{isLoading:t.type===y.GET_INSERTABLE_ZVIDEOS.request});case y.GET_INSERTABLE_ZVIDEOS.success:return(0,i._)((0,o._)({},e),{isLoading:!1,paging:t.payload.paging,data:u()(e.data,t.payload.data,"id")});default:return e}},recruit:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;if(t.type===T.GET_FORM.success){var n=t.payload;e=(0,i._)((0,o._)({},e),{form:(0,o._)({},e.form,n),submited:!0})}return e},qyActivityData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===y.GET_QY_ACTIVITY.success?(0,o._)({},e,t.payload):e},talkActivityData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===y.GET_TALK_ACTIVITY.success?(0,o._)({},e,t.payload):e},party2022ActivityData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===y.GET_PARTY2022_ACTIVITY.success?(0,o._)({},e,t.payload):e},batchVideos:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.meta,a=t.payload;return t.type===y.GET_BATCHVIDEOS.success?(0,i._)((0,o._)({},e),(0,r._)({},n,a)):e},creationReferences:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===y.LOAD_CREATION_REFERENCES.success?(0,i._)((0,o._)({},e),(0,r._)({},t.meta.id,t.result)):e},zvideoCollection:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===y.GET_ZVIDEO_COLLECTION_LIST.request||t.type===y.GET_ZVIDEO_COLLECTION_LIST.failure){var n=t.meta.id,c=e[n]||{};return(0,i._)((0,o._)({},e),(0,r._)({},n,(0,i._)((0,o._)({},c),{isLoading:t.type===y.GET_ZVIDEO_COLLECTION_LIST.request})))}if(t.type===y.GET_ZVIDEO_COLLECTION_LIST.success){var s=t.meta.id,u=t.payload.paging,l=t.result,d=e[s]||{},p=d.items||[];return(0,i._)((0,o._)({},e),(0,r._)({},s,(0,i._)((0,o._)({},d),{paging:u,items:(0,a._)(p).concat((0,a._)(l)),isLoading:!1})))}return e},zvideoGrant:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===y.TOGGLE_ALLOW_STATUS.success?(0,o._)({},e,t.payload):e},collectData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!1,list:[]},t=arguments.length>1?arguments[1]:void 0;return t.type===y.GET_COLLECT_LIST.success?(0,o._)((0,i._)((0,o._)({},e),{isFetching:!1,list:e.list.concat(t.payload.data)}),t.payload.paging):t.type===y.GET_COLLECT_LIST.request||t.type===y.GET_COLLECT_LIST.failure?(0,i._)((0,o._)({},e),{isFetching:!0}):e},videoSource:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isLoaded:!1},t=arguments.length>1?arguments[1]:void 0;if(t.type===y.GET_VIDEO_SOURCE.success){var n=t.payload,r=n.topic,a=n.title;return r&&r.length>0&&r.map(function(e){return(0,i._)((0,o._)({},e),{urlToken:e.id})}),{isLoaded:!0,zvideoType:"original",title:a,topics:r}}return e},paidColumnInfo:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return n.type===y.GET_PAID_COLUMN_INFO.success?(0,i._)((0,o._)({},t),(0,r._)({},n.id,null===(e=n.payload)||void 0===e?void 0:e.data)):t}})},15408:function(e,t,n){"use strict";n.d(t,{Z:function(){return A}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(57477),l=n(71728),d=n(85626),p=n(85879),f=n(54231),h=n(87363),_=n(92258),m=n(55536),g=n(63638),T=n(33510),E=n(4607),y=n(50373);function C(){return n.e(7454).then(n.bind(n,47454))}function S(e){return(0,p.tZ)(y.Z,(0,u._)((0,s._)({},e),{getComponent:C}))}var I=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(e){var i;return(0,o._)(this,n),i=t.call(this,e),(0,a._)((0,r._)(i),"handleSignFlowModalOpen",function(e){i.setState({signFlowModalType:e,signFlowModalShown:!0}),f.ZP.increment("logIn.modal.show.count",1)}),(0,a._)((0,r._)(i),"handleSignFlowModalClose",function(){var e=i.props.onClose;i.setState({signFlowModalShown:!1},function(){"function"==typeof e&&e()}),f.ZP.increment("logIn.modal.close.count",1)}),(0,a._)((0,r._)(i),"handleLogin",function(e){var t=i.props.loginButton,n=void 0===t?{}:t,r=n.props&&n.props.onClick;"function"==typeof r&&r(e),i.handleSignFlowModalOpen("login")}),(0,a._)((0,r._)(i),"handleRegister",function(e){var t=i.props.registerButton,n=t.props&&t.props.onClick;"function"==typeof n&&n(e),i.handleSignFlowModalOpen("register")}),e.defaultType?i.state={signFlowModalType:e.defaultType,signFlowModalShown:!0}:(i.state={signFlowModalType:"initial",signFlowModalShown:!1},f.ZP.increment("logIn.modal.show.count",1)),i}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.signFlowModalType,r=t.signFlowModalShown,o=this.props,i=o.loginButton,a=o.loginButtonWithZa,c=o.registerButton,d=o.children,f=o.wrapperClassName,_=(0,l._)(o,["loginButton","loginButtonWithZa","registerButton","children","wrapperClassName"]);return(0,p.BX)("div",{className:f,children:[a&&(0,h.cloneElement)(a,{onClick:this.handleLogin}),i&&(0,p.tZ)(g.ZAShow,{zaType:"Button",zaText:"login",as:(0,h.forwardRef)(function(t,n){return(0,h.cloneElement)(i,{onClick:e.handleLogin,ref:n})})}),c&&(0,h.cloneElement)(c,{onClick:this.handleRegister}),d,r&&(0,p.BX)(p.HY,{children:[(0,p.tZ)(S,(0,u._)((0,s._)({},_),{signType:n,onClose:this.handleSignFlowModalClose})),(0,p.tZ)(T.A,{})]})]})}}]),n}(h.Component),A=(0,m.compose)(E.x,(0,_.connect)(function(){return{showQrcodeFirst:!1}},null))(I)},69140:function(e,t,n){"use strict";n.r(t),n.d(t,{BIND_PHONE:function(){return ee},CONFIRM_BIND_PHONE:function(){return $},CONFIRM_UNBIND:function(){return er},LOGIN_WITH_PHONE:function(){return et},NEED_UNBIND:function(){return en},SAFETY_VERIFICATION:function(){return eo},default:function(){return ea}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(85626),u=n(85879),l=n(14168),d=n.n(l),p=n(87363),f=n(92258),h=n(55536),_=n(11786),m=n(45842),g=n(6366),T=n(58909),E=n(66263),y=n(67927),C=n(55164),S=n(57477),I=n(51679),A=n(49695),b=n(69383),w=n(63638),Z=n(74128),x=n(25452),k=n(16850),R=n(65357),N=n(71670),O=n(87843),P=n(80487),D=n(71728),L=n(79065),M=n(49899),B=n(7407),U=n(25773),G=n(25669),F=n(34150);function H(){var e=(0,L._)(["","s 后可重发"]);return H=function(){return e},e}var z=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){return(0,o._)(this,n),t.apply(this,arguments)}return(0,i._)(n,[{key:"render",value:function(){var e=this.props,t=e.countDownEvent,n=e.startAtOnce,r=e.interceptTime,o=e.resetText,i=e.manualValidateError,a=e.onChange,c=e.validations,s=e.countDownEndEvent,l=e.reStartTime,d=e.isIOS,p=e.isMobile,f=e.maxLength,h=void 0===f?E.Bg:f,_=(0,D._)(e,["countDownEvent","startAtOnce","interceptTime","resetText","manualValidateError","onChange","validations","countDownEndEvent","reStartTime","isIOS","isMobile","maxLength"]);return(0,u.BX)("div",{className:"SignFlow SignFlow-smsBindPhoneInputContainer",children:[(0,u.tZ)(F.Z,(0,C._)({name:"digits",className:"SignFlow-smsBindPhoneInput",type:d?"tel":"number",errorMessageClassName:p?"SignFlow-smsBindPhoneInputErrorMask-Mobile":"SignFlow-smsBindPhoneInputErrorMask",maxLength:h,placeholder:"输入 ".concat(h," 位验证码"),manualValidateError:i,onChange:a,validations:[{type:"required",message:"请填写验证码",className:"SignFlow-smsInputBindPhoneRequiredErrorMask"}].concat((0,M._)(c||[]))},_)),(0,u.tZ)(U.Z,{className:"SignFlow-smsBindPhoneInputButton",preset:"plain",initialText:"发送验证码",resetText:o,countingText:(0,G.Z)(H(),"count"),startAtOnce:n,event:t,countDownEndEvent:s,interceptTime:r,reStartTime:l})]})}}]),n}(p.Component);(0,a._)(z,"propTypes",{countDownEvent:d().func.isRequired,startAtOnce:d().bool,interceptTime:d().number,resetText:d().string,manualValidateError:d().string}),(0,a._)(z,"defaultProps",{startAtOnce:!1,resetText:"重发验证码"});var q=(0,f.connect)(function(e){return{isIOS:e.env.userAgent.iOS,isMobile:(0,B.Hu)(e)}})(z),V=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"zaRef",(0,p.createRef)()),(0,a._)((0,r._)(e),"state",{selectedCountry:{code:"+86",name:"中国"},phoneNo:null,smsInputInterceptTime:-1,manualError:null,showFooter:!1,sendValidationCodeButtonText:"发送验证码",identifyingCodeError:null}),(0,a._)((0,r._)(e),"testPhoneNo",function(){var t=e.state,n=t.selectedCountry.code,r=t.phoneNo;return"+86"!==n||/^\d{11}$/.test(r)}),(0,a._)((0,r._)(e),"handleChange",function(t){return function(n){e.setState((0,a._)({},t,n))}}),(0,a._)((0,r._)(e),"handleSendDigits",function(t){var n=e.props.isMobile;e.zaRef.current.trackEvent({eventType:"Click",elementLocation:{type:"Button",moduleId:e.isSocialRegister?"reg_mobile_verification_code_button":""}});var r=e.props,o=r.requestPhoneVerificationCode,i=r.onVipUnbind,a=e.state,c=a.selectedCountry.code,s=a.phoneNo,u=a.manualError;if(b.Z.trackEvent(t.target,{action:"GetCaptcha"}),e.testPhoneNo())return o("".concat(c).concat(s)).then(function(){e.setState({manualError:null})}).catch(function(t){var n=t.payload,r=void 0===n?{}:n,o=r.message;if(!(r.code===E.W0&&"function"==typeof i&&i({phoneNo:s})))return e.setState({manualError:o,smsInputInterceptTime:Date.now()})});var l=n?"手机号错误":"请输入正确的手机号";return e.setState({manualError:u===l?" ".concat(l):l,smsInputInterceptTime:Date.now()})}),(0,a._)((0,r._)(e),"trackSubmitResult",function(t){e.zaRef.current.trackEvent({eventType:"Click",elementLocation:{type:"Button",moduleId:e.isSocialRegister?"reg_mobile_setting_confirm_button":""}},{configMap:{bindResult:t?"1":"0"}})}),(0,a._)((0,r._)(e),"handleSubmit",function(t){var n=t.phoneNo,r=t.digits,o=e.props,i=o.updatePhoneNumber,a=o.onSuccess,c=o.onNeedUnbind,s=e.state,u=s.selectedCountry.code,l=s.identifyingCodeError;i("".concat(u).concat(n),r).then(function(t){var r=t.payload,o=r.data,i=r.success;return(e.trackSubmitResult(i),i)?a():c({phoneNumber:n,bindName:o.bindedAccountFullname,requiredName:o.requestAccountFullname})}).catch(function(t){e.trackSubmitResult(!1);var n=t.payload,r=void 0===n?{}:n,o=r.code,i=r.message;o===E.o7&&e.setState({identifyingCodeError:l===i?" ".concat(i):i})})}),(0,a._)((0,r._)(e),"handleZaOK",function(e){b.Z.trackEvent(e.target,{action:"Ok"})}),(0,a._)((0,r._)(e),"renderContent",function(){var t=e.state,n=t.smsInputInterceptTime,r=t.manualError,o=t.sendValidationCodeButtonText,i=t.identifyingCodeError,a=e.props.isMobile;return(0,u.BX)(w.ZAShow,{zaType:"Popup",zaModuleId:e.isSocialRegister?"reg_mobile_setting_popup":"",ref:function(t){e.container=t},children:[(0,u.tZ)(w.ZARef,{ref:e.zaRef}),a&&(0,u.tZ)("div",{css:function(e){return{color:e.colors.GBK03A,fontWeight:"bold",fontSize:17,lineHeight:"24px",padding:"0 24px",marginTop:-18}},children:"绑定手机号，享受知乎完整功能 ~"}),(0,u.BX)(O.Z,{className:"SignFlow BindPhoneForm",onSubmit:e.handleSubmit,style:a?{marginTop:0,padding:"0 24px"}:{},children:[(0,u.tZ)(N.l,{selectClassName:"BindPhone-select",children:(0,u.tZ)(P.Z,{type:"register",supportedCountriesShown:!0,manualValidateError:r,onSelect:e.handleChange("selectedCountry"),onChange:e.handleChange("phoneNo")})}),(0,u.tZ)(q,{resetText:o,interceptTime:n,countDownEvent:e.handleSendDigits,manualValidateError:i},"sms-input"),!a&&(0,u.tZ)("div",{className:"BindPhone-helpWrapper",children:(0,u.tZ)(x.ZP,{className:"BindPhone-helpText",preset:"link",onClick:function(){e.setState({showFooter:!0})},children:"需要帮助？"})}),a?(0,u.tZ)(I.Z,{css:{marginTop:60},children:(0,u.tZ)(w.ZAClick,{zaType:"Button",zaModuleId:"bind_enter_zhihu_button",as:A.z,colorPreset:"primary",type:"submit",label:"确认",size:"l",children:"确认"})}):(0,u.tZ)(x.ZP,{css:{display:"block",width:"220px",margin:"55px auto 0"},preset:"primary",color:"blue",type:"submit",onClick:e.handleZaOK,children:"确认"})]})]})}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){b.Z.setModule(this.container,{module:"BindPhoneForm"}),b.Z.trackCardShow(this.container)}},{key:"isSocialRegister",get:function(){return(0,R.wb)()}},{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.modalProps,r=void 0===n?{}:n,o=e.isMobile,i=this.state.showFooter;return(0,u.tZ)(Z.Z,(0,S._)((0,C._)({title:o?null:"设置手机号",subtitle:o?null:"绑定手机号后，您可以解锁知乎的提问、回答、评论等更多功能。",footer:i?"如需要帮助，请联系 i@zhihu.com，我们会尽快帮你解决":null,onClose:t,size:o?"fullPage":"default"},r),{children:this.renderContent()}))}}]),n}(p.Component);(0,a._)(V,"propTypes",{requestPhoneVerificationCode:d().func.isRequired,updatePhoneNumber:d().func.isRequired,onClose:d().func.isRequired,onSuccess:d().func.isRequired,onNeedUnbind:d().func.isRequired,isMobile:d().bool.isRequired});var W=(0,k.$)()(V),X=n(80714),K=n(31142),j=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"zaKnowMore",function(e){b.Z.trackEvent(e.target,{action:"OpenUrl",name:"了解更多"})}),(0,a._)((0,r._)(e),"toBindPhone",function(t){var n=e.props.onBindPhone;b.Z.trackEvent(t.target,{action:"OpenUrl",name:"去绑定手机"}),n()}),(0,a._)((0,r._)(e),"handleClose",function(t){var n=e.props,r=n.onClose,o=n.config.canWrite;b.Z.trackEvent(t.target,{action:"Cancel",name:o?"暂不绑定":"取消"}),r()}),(0,a._)((0,r._)(e),"renderContent",function(){var t=e.props.config,n=t.tip,r=t.canWrite;return(0,u.BX)("div",{ref:function(t){e.container=t},children:[(0,u.BX)("p",{children:[n,(0,u.tZ)(K.Z,{preset:"link",target:"_blank",href:"https://zhuanlan.zhihu.com/p/27257715",onClick:e.zaKnowMore,children:"了解更多"})]}),(0,u.BX)("div",{className:"BindPhone-buttonSection",children:[(0,u.tZ)(K.Z,{className:"BindPhone-button",onClick:e.handleClose,children:r?"暂不绑定":"取消"}),(0,u.tZ)(x.ZP,{className:"BindPhone-button",preset:"primary",color:"blue",onClick:e.toBindPhone,children:"去绑定手机"})]})]})}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){b.Z.setModule(this.container,{module:"BindPhoneForm"}),b.Z.trackCardShow(this.container)}},{key:"render",value:function(){var e=this.props.onClose;return(0,u.tZ)(Z.Z,{className:X.Z.isMobileEntry&&"BindPhoneMobileModal",title:"绑定手机",onClose:e,size:X.Z.isMobileEntry?"small":"default",children:this.renderContent()})}}]),n}(p.Component);(0,a._)(j,"propTypes",{config:d().object,onClose:d().func,onBindPhone:d().func});var Y=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleUnbind",function(t){var n=e.props,r=n.onSuccess,o=n.monopolizePhoneNumber,i=n.showNotification;b.Z.trackEvent(t.target,{action:"Click",name:"确认解绑"}),o().then(function(){return i("绑定成功！","white"),r()})}),(0,a._)((0,r._)(e),"handleCancel",function(t){var n=e.props.onCancel;b.Z.trackEvent(t.target,{action:"Click",name:"暂不绑定"}),n()}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){b.Z.setModule(this.container,{module:"BindPhoneVerifyForm"}),b.Z.trackCardShow(this.container)}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,r=t.bindName;return(0,u.tZ)(Z.Z,{className:X.Z.isMobileEntry&&"ConfirmUnbindMobileModal",title:"解绑手机",onClose:n,size:X.Z.isMobileEntry?"small":"default",children:(0,u.BX)("div",{ref:function(t){e.container=t},children:[(0,u.tZ)("p",{children:(0,u.tZ)("b",{children:"解绑操作无法撤销。"})}),X.Z.isMobileEntry&&(0,u.tZ)("br",{}),(0,u.BX)("p",{children:["如果你没有其他登录方式，你将无法再使用账号「",r,"」。"]}),(0,u.BX)("div",{className:"BindPhone-buttonSection",children:[(0,u.tZ)(x.ZP,{className:"BindPhone-button",onClick:this.handleUnbind,children:"确认解绑"}),(0,u.tZ)(x.ZP,{className:"BindPhone-button",preset:"primary",color:"blue",onClick:this.handleCancel,children:"暂不绑定"})]})]})})}}]),n}(p.Component);(0,a._)(Y,"propTypes",{onClose:d().func.isRequired,onSuccess:d().func.isRequired,onCancel:d().func.isRequired,bindName:d().string.isRequired,showNotification:d().func.isRequired,monopolizePhoneNumber:d().string.isRequired});var Q=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleCancel",function(t){var n=e.props.onClose;b.Z.trackEvent(t.target,{action:"Cancel",name:"不绑定"}),n()}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){b.Z.setModule(this.container,{module:"BindMailForm"}),b.Z.trackCardShow(this.container)}},{key:"render",value:function(){var e=this,t=this.props.onClose;return(0,u.tZ)(Z.Z,{className:X.Z.isMobileEntry&&"LoginWithPhoneMobileModal",title:"手机号绑定成功",onClose:t,size:X.Z.isMobileEntry?"small":"default",children:(0,u.BX)("div",{ref:function(t){e.container=t},children:[(0,u.tZ)("p",{children:"由于你此前绑定的邮箱未经验证，未来请使用手机号登录知乎。"}),(0,u.tZ)(x.ZP,{className:"BindPhone-remindLoginWithPhoneButton",onClick:this.handleCancel,preset:"primary",color:"blue",children:"知道了"})]})})}}]),n}(p.Component);(0,a._)(Q,"propTypes",{onClose:d().func});var J=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleCancel",function(t){var n=e.props.onCancel;b.Z.trackEvent(t.target,{action:"Click",name:"暂不绑定"}),n()}),(0,a._)((0,r._)(e),"handleConfirm",function(t){var n=e.props.onConfirm;b.Z.trackEvent(t.target,{action:"Click",name:"确认解绑"}),n()}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){b.Z.setModule(this.container,{module:"BindPhoneFailForm"}),b.Z.trackCardShow(this.container)}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,r=t.phoneNumber,o=t.bindName,i=t.requiredName;return(0,u.tZ)(Z.Z,{className:X.Z.isMobileEntry&&"NeedUnbindMobileModal",title:"绑定失败",onClose:n,size:X.Z.isMobileEntry?"small":"default",children:(0,u.BX)("div",{ref:function(t){e.container=t},children:[(0,u.BX)("p",{children:["你所输入的手机号 ",r," 已经被绑定到账号「",o,"」。"]}),X.Z.isMobileEntry&&(0,u.tZ)("br",{}),(0,u.BX)("p",{children:["你可以选择将该手机号从该账号中解绑，并绑定至当前账号「",i,"」。"]}),X.Z.isMobileEntry&&(0,u.tZ)("br",{}),(0,u.tZ)("p",{children:(0,u.BX)("b",{children:["解绑后，你将无法再通过手机号登录原账号「",o,"」。"]})}),(0,u.BX)("div",{className:"BindPhone-buttonSection",children:[(0,u.tZ)(x.ZP,{className:"BindPhone-button",onClick:this.handleConfirm,children:"确认解绑"}),(0,u.tZ)(x.ZP,{className:"BindPhone-button",preset:"primary",color:"blue",onClick:this.handleCancel,children:"暂不绑定"})]})]})})}}]),n}(p.Component);(0,a._)(J,"propTypes",{onClose:d().func.isRequired,onCancel:d().func.isRequired,onConfirm:d().func.isRequired,phoneNumber:d().string.isRequired,bindName:d().string.isRequired,requiredName:d().string.isRequired});var $="CONFIRM_BIND_PHONE",ee="BIND_PHONE",et="LOGIN_WITH_PHONE",en="NEED_UNBIND",er="CONFIRM_UNBIND",eo="SAFETY_VERIFICATION",ei=function(e){(0,c._)(n,e);var t=(0,s._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{}),(0,a._)((0,r._)(e),"handleBindPhoneSuccess",function(){var t=e.props,n=t.needShowLoginWithPhoneNumber,r=t.showNotification,o=t.onToggle,i=t.onSuccess;return(null==i||i(),n)?e.goToStep(et)():(r("绑定成功！","white"),setTimeout(function(){return location.reload()},2e3),o())}),(0,a._)((0,r._)(e),"handleNeedUnbind",function(t){var n=t.bindName,r=t.phoneNumber,o=t.requiredName;return e.setState({bindName:n,phoneNumber:r,requiredName:o,step:en})}),(0,a._)((0,r._)(e),"goToStep",function(t){return function(){return e.setState({step:t})}}),(0,a._)((0,r._)(e),"handleCloseWithReload",function(){return location.reload()}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){(0,this.props.fillCurrentUserIfNeeded)(["email","isActive","isBindPhone"])}},{key:"componentDidUpdate",value:function(e){e.currentStep!==this.props.currentStep&&this.goToStep(this.props.currentStep)()}},{key:"render",value:function(){var e=this,t=this.props,n=t.shown,r=t.requestPhoneVerificationCode,o=t.updatePhoneNumber,i=t.monopolizePhoneNumber,a=t.showNotification,c=t.config,s=t.account,l=t.unlockTicketByDigits,d=t.requestUnlockTicket,p=t.unlockTicketByPassword,f=t.onToggle,h=t.isBindPhone,m=t.isZombie,g=t.onSuccess,T=this.state,E=T.step,y=T.bindName,C=T.phoneNumber,S=T.requiredName;return n?E===$?(0,u.tZ)(j,{onBindPhone:this.goToStep(eo),onClose:f,config:c}):E===ee?(0,u.tZ)(W,{onClose:f,onSuccess:this.handleBindPhoneSuccess,onNeedUnbind:this.handleNeedUnbind,requestPhoneVerificationCode:r,updatePhoneNumber:o}):E===et?(0,u.tZ)(Q,{onClose:this.handleCloseWithReload}):E===en?(0,u.tZ)(J,{onClose:f,onCancel:this.goToStep(ee),onConfirm:this.goToStep(er),bindName:y,phoneNumber:C,requiredName:S}):E===er?(0,u.tZ)(Y,{onClose:f,onSuccess:this.handleBindPhoneSuccess,onCancel:this.goToStep(ee),bindName:y,monopolizePhoneNumber:i,showNotification:a}):E===eo?(0,u.tZ)(_.c,{isShown:!0,account:s,unlockTicketByDigits:l,requestUnlockTicket:d,unlockTicketByPassword:p,onClose:f,onSuccess:function(){m&&h||e.goToStep(ee)(),null==g||g()},zaModuleName:"BindMailForm"}):null:null}}]),n}(p.Component);(0,a._)(ei,"propTypes",{shown:d().bool.isRequired,onToggle:d().func.isRequired,needShowLoginWithPhoneNumber:d().bool.isRequired,config:d().object.isRequired,requestPhoneVerificationCode:d().func.isRequired,updatePhoneNumber:d().func.isRequired,monopolizePhoneNumber:d().func.isRequired,onSuccess:d().func});var ea=(0,h.compose)(m.Z,(0,f.connect)(function(e,t){var n=e.account,r=t.currentUser,o=r.isActive,i=r.email,a=r.isZombie,c=r.isBindPhone;return{account:n,hasActiveEmail:o&&i,needShowLoginWithPhoneNumber:!o&&!!i,config:E.xR,isZombie:a,isBindPhone:c}},{requestPhoneVerificationCode:g.L3,updatePhoneNumber:g.Rv,monopolizePhoneNumber:g.t_,showNotification:y.c0,getUnlockRequest:g.F4,unlockTicketByDigits:g.LC,requestUnlockTicket:g.MM,unlockTicketByPassword:g.Hr,fillCurrentUserIfNeeded:T.sF}))(ei)},65357:function(e,t,n){"use strict";n.d(t,{Ww:function(){return a},o$:function(){return s},wb:function(){return c}});var r=n(67516),o=n.n(r),i="ftasl";function a(){o().set(i,"1")}function c(){return o().get(i)||!1}function s(){o().delete(i)}},82865:function(e,t,n){"use strict";n.d(t,{Eh:function(){return u},Fu:function(){return s},dq:function(){return c}});var r=n(67516),o=n.n(r),i=n(54231),a="vIsZ";function c(e){e&&(o().set(a,null==e?void 0:e.isZombie),i.ZP.increment("logIn.zombieStatus.write.count"))}function s(){o().delete(a),i.ZP.increment("logIn.zombieStatus.delete.count")}function u(){return o().get(a)||!1}},77350:function(e,t,n){"use strict";n.d(t,{p:function(){return d}});var r=n(94009),o=n(49899),i=n(85879),a=n(91850),c=n(65733),s=n(87363),u=n(80714),l=n(50953),d=(0,s.createContext)({}),p=function(e){var t=e.children,n=(0,l.Z)(["isRealname"]),u=(0,r._)((0,a.k)(!1),2),p=u[0],f=u[1],h=(0,c.A)(function(e){return function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];(n||{}).isRealname?e.apply(void 0,(0,o._)(r)):f.on()}}),_=(0,c.A)(function(){return f.off()}),m=(0,s.useMemo)(function(){return{realNameRequired:h,realNameModalShown:p,closeRealNameModal:_}},[p]);return(0,i.tZ)(d.Provider,{value:m,children:t})};t.Z=function(e){var t=e.path,n=e.children;return(0,s.useMemo)(function(){return!(t.match(/\/story\/\d+$/)||t.match(/\/authorize$/)||"errorpage"===u.Z.currentEntry)},[t])?(0,i.tZ)(p,{children:n}):n}},84954:function(e,t,n){"use strict";n.d(t,{w:function(){return f},ru:function(){return T}});var r=n(85879),o=n(87363),i=n(74128),a=n(81037),c=n(80714),s=function(e){var t=e.onClose,n=e.shown,s=(0,o.useCallback)(function(){location.href="https://".concat(c.Z.wwwHost,"/authenticate/intro")},[]);return(0,r.tZ)(i.Z,{title:"账号实名制认证",onClose:t,size:c.Z.isMobileEntry?"fullPage":"default",children:n&&(0,r.BX)("div",{className:"RealNameModal",children:[(0,r.tZ)("p",{children:"根据相关法律法规，您需要完成真实身份核验后方可使用提问、回答、评论等功能。"}),(0,r.tZ)("p",{children:"你可以通过以下方式完成实名制认证。"}),(0,r.BX)("p",{children:["如有其它问题可私信联系"," ",(0,r.tZ)("a",{href:"https://www.zhihu.com/messages/-10029",children:"知乎管理员"})," ","进行咨询沟通"]}),(0,r.tZ)("div",{className:"RealNameModal-buttonGroup",children:(0,r.tZ)(a.ZP,{preset:"primary",color:"blue",onClick:s,children:"身份证件信息认证"})})]})})},u=n(77350),l=n(14914),d=n(50953),p=function(){var e=(0,d.Z)(["isRealname"]),t=(0,o.useContext)(u.p),n=t.closeRealNameModal,i=t.realNameModalShown,a=(e||{}).isRealname;return(0,r.tZ)(r.HY,{children:!1===a&&(0,r.tZ)(s,{onClose:n,shown:i})})},f=(0,l.withRouter)(function(e){var t=e.location.pathname;return(0,o.useMemo)(function(){return!(t.match(/\/story\/\d+$/)||t.match(/\/authorize$/)||"errorpage"===c.Z.currentEntry)},[t])?(0,r.tZ)(p,{}):null}),h=n(55164),_=n(57477),m=n(84871),g=n.n(m),T=function(e){return g()(function(t){var n=(0,o.useContext)(u.p).realNameRequired;return(0,r.tZ)(e,(0,_._)((0,h._)({},t),{realNameRequired:n}))},e)}},80487:function(e,t,n){"use strict";n.d(t,{Z:function(){return Z}});var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(57477),l=n(71728),d=n(85626),p=n(85879),f=n(92769),h=n.n(f),_=n(14168),m=n.n(_),g=n(87363),T=n(77880),E=n(80714),y=n(4607),C=n(71670),S=n(34150),I=n(94009),A=n(83921),b=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleChange",function(t){var n=(0,I._)(t.target.value.match(/\+\d+/),1)[0];e.codeDiv.innerHTML=n;var r=e.props.items.findIndex(function(e){return e.code===n});e.props.onChange(t.target.value,r)}),e}return(0,i._)(n,[{key:"render",value:function(){var e=this,t=this.props.items;return(0,p.BX)("div",{className:"MobileContriesSelect",children:[(0,p.BX)("div",{className:"MobileContriesSelect-content",children:[(0,p.tZ)("div",{ref:function(t){e.codeDiv=t},children:"+ 86"}),(0,p.tZ)("select",{onChange:this.handleChange,children:t.map(function(e,t){var n=e.name,r=e.code;return(0,p.tZ)("option",{value:"".concat(n," ").concat(r),children:"".concat(n," ").concat(r)},t)})})]}),(0,p.tZ)(A.ji,{})]})}}]),n}(g.Component),w=function(e){(0,c._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"state",{selectedCountry:null}),(0,a._)((0,r._)(e),"handleSelect",function(t,n){var r=e.props,o=r.supportedCountries,i=r.onSelect,a=o[n];e.setState({selectedCountry:a}),i(a)}),e}return(0,i._)(n,[{key:"render",value:function(){var e=h()(this.props,["getSupportedCountries","onSelect"]),t=e.supportedCountries,n=e.onChange,r=e.defaultPhoneNo,o=e.type,i=e.defaultSelectedCountry,a=e.supportedCountriesShown,c=e.placeholderPrefix,u=void 0===c?"":c,d=e.getPlaceholder,f=e.selectClassName,_=(0,l._)(e,["supportedCountries","onChange","defaultPhoneNo","type","defaultSelectedCountry","supportedCountriesShown","placeholderPrefix","getPlaceholder","selectClassName"]),m=this.state.selectedCountry||i,g=m.name,y=m.code,C=!!(a&&t&&t.length);return(0,p.BX)("div",{className:"SignFlow-account",children:[C&&(0,p.BX)(p.HY,{children:[(0,p.tZ)("div",{className:"SignFlow-supportedCountriesSelectContainer",children:!!t&&!!t.length&&(E.Z.isMobileEntry?(0,p.tZ)(b,{items:t,onChange:this.handleSelect}):(0,p.tZ)(T.Z,{plain:!0,targetClassName:f,text:"".concat(g," ").concat(y),onChange:this.handleSelect,children:t.map(function(e,t){var n=e.name,r=e.code;return(0,p.tZ)(T.W,{value:"".concat(n," ").concat(r)},t)})}))}),(0,p.tZ)("span",{className:"SignFlow-accountSeperator",children:"\xa0"})]}),(0,p.tZ)(S.Z,(0,s._)({className:"SignFlow-accountInputContainer",name:"register"===o?"phoneNo":"username",inputClassName:"SignFlow-accountInput",placeholder:d(o,u),onChange:n,defaultValue:r,validations:[{type:"required",message:d(o,"请输入")}],type:"digits"===o||"register"===o?"tel":"text"},_))]})}}]),n}(g.Component);(0,a._)(w,"propTypes",{defaultPhoneNo:m().string,defaultSelectedCountry:m().object,supportedCountries:m().array,onSelect:m().func,onChange:m().func,type:m().oneOf(["register","digits","password"]).isRequired,supportedCountriesShown:m().bool,placeholderPrefix:m().string,getPlaceholder:m().func}),(0,a._)(w,"defaultProps",{defaultPhoneNo:"",defaultSelectedCountry:{name:"中国",code:"+86"},supportedCountriesShown:!0,getPlaceholder:function(e,t){return"".concat(t).concat("digits"===e||"register"===e?"手机号":"手机号或邮箱")}});var Z=(0,y.x)(function(e){var t=(0,C.h)().selectClassName;return(0,p.tZ)(w,(0,u._)((0,s._)({},e),{selectClassName:t}))})},34150:function(e,t,n){"use strict";var r=n(20857),o=n(22107),i=n(94707),a=n(87320),c=n(86325),s=n(55164),u=n(71728),l=n(85626),d=n(85879),p=n(67814),f=n.n(p),h=n(92769),_=n.n(h),m=n(14168),g=n.n(m),T=n(87363),E=n(9887),y=n(87843),C=function(e){(0,c._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,a._)((0,r._)(e),"handleErrorHide",function(){e.getValidationMessage()&&e.setState({errorMaskShown:!1},function(){e.clearValidations({errorMaskShown:!0},function(){return e.inputEl.focus()})})}),(0,a._)((0,r._)(e),"handleKeyUp",function(t){(8===t.keyCode||9===t.keyCode)&&e.clearValidations()}),(0,a._)((0,r._)(e),"handleChange",function(t){var n=t.target.value,r=e.props.onChange;e.setValue(n),"function"==typeof r&&r(n)}),e}return(0,i._)(n,[{key:"componentDidMount",value:function(){var e=this.props.defaultValue;e&&this.setValue(e),this.setState({errorMaskShown:!0})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.manualValidateError,r=t.type,o=t.smsType,i=e.manualValidateError,a=e.type,c=e.defaultValue,s=e.smsType;!n&&i||"string"==typeof n&&n!==i?this.addManualValidation(i):n&&!i&&this.clearValidations({errorMaskShown:!0}),(r!==a||o!==s)&&(this.setValue(c),this.clearValidations({errorMaskShown:!0}))}},{key:"render",value:function(){var e,t=this,n=_()(this.props,["validations","defaultValue","onChange","smsType","manualValidateError","dispatch"]),r=n.className,o=n.inputClassName,i=n.errorMessageClassName,c=(0,u._)(n,["className","inputClassName","errorMessageClassName"]),l=(this.state||{}).errorMaskShown,p=this.getValue(),h=this.getValidationMessage();return(0,d.BX)("div",{className:f()("SignFlowInput",r),children:[(0,d.tZ)(E.Z,(0,s._)({onRef:function(e){t.inputEl=e},value:p,onChange:this.handleChange,onKeyUp:this.handleKeyUp,onClick:this.handleErrorHide,onBlur:function(){return t.validate()},className:o},c)),(0,d.tZ)("div",{className:f()("SignFlowInput-errorMask",this.getValidationClassName(),(e={},(0,a._)(e,i,h),(0,a._)(e,"SignFlowInput-requiredErrorMask",!p),(0,a._)(e,"SignFlowInput-errorMask--hidden",!h||!l),e)),onClick:this.handleErrorHide,children:h})]})}}]),n}(T.Component);(0,a._)(C,"propTypes",{inputClassName:g().string,errorMessageClassName:g().string,manualValidateError:g().node}),t.Z=(0,y.$)()(C)},29065:function(e,t,n){"use strict";var r=n(55164),o=n(36907),i=n.n(o),a=n(23768);t.Z=function(e,t){var n=Date.now(),o="com.zhihu.web",c=new(i())("SHA-1","TEXT");return c.setHMACKey("d1b964811afb40118a12068ff74a12f4","TEXT"),c.update(e),c.update(a.ym),c.update(o),c.update(String(n)),(0,r._)({clientId:a.ym,grantType:e,timestamp:n,source:o,signature:c.getHMAC("HEX")},t)}},72925:function(e,t,n){"use strict";n.d(t,{N:function(){return a},g:function(){return i}});var r=n(67516),o=n.n(r);function i(){return o().get("lastuser")||o().get("lastuser:email")}function a(e){o().set("lastuser",e)}},76295:function(e,t,n){"use strict";n.d(t,{ZP:function(){return i}});var r=n(55462),o=n(80714);function i(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?void r.Z.supportsAction("account/showLoginDialog").then(function(e){e?(0,r.Z)("account/showLoginDialog").dispatch({next:location.href}):location.href="zhihu://".concat(t?"signup":"signin","?next=").concat(encodeURIComponent(location.pathname+location.search))}):function(e){if("column"===o.Z.currentEntry){var t;return t="https://"+o.Z.zhuanlanHost+location.pathname+location.search,void(location.href="".concat(e?"/signup":"/signin","?next=").concat(encodeURIComponent(t)))}location.href="".concat(e?"/signup":"/signin","?next=").concat(encodeURIComponent(location.pathname+location.search))}(t)}},45471:function(e,t,n){"use strict";n.d(t,{uq:function(){return C},Vy:function(){return r.Z},$7:function(){return A},t:function(){return Z},gl:function(){return x.g}});var r=n(15408),o=n(20857),i=n(22107),a=n(94707),c=n(87320),s=n(86325),u=n(55164),l=n(57477),d=n(85626),p=n(85879),f=n(82644),h=n(67814),_=n.n(h),m=n(87363),g=n(74128),T=n(25452),E=n(80714),y=n(76295),C=function(e){(0,s._)(n,e);var t=(0,d._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),(0,c._)((0,o._)(e),"handleSignUp",function(){(0,y.ZP)(e.props.isAppView,!0)}),(0,c._)((0,o._)(e),"handleSignIn",function(){(0,y.ZP)(e.props.isAppView)}),e}return(0,a._)(n,[{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.isAppView;return(0,p.tZ)(g.Z,{title:"注册/登录后即可继续操作",size:E.Z.isMobileEntry?"small":"default",className:_()("AppAuthentication",{"AppAuthentication--appView":n}),closeButton:!1,onClose:t,children:(0,p.BX)("div",{className:"AppAuthentication-buttonContainer",children:[!n&&(0,p.tZ)(T.ZP,{preset:"plain",className:"AppAuthentication-closeButton",onClick:t,"aria-label":"关闭",children:(0,p.tZ)(f.HN,{size:16,name:"remove"})}),!E.Z.isMobileEntry&&(0,p.tZ)(T.ZP,{className:"AppAuthentication-button",color:"blue",preset:"primary",onClick:this.handleSignUp,children:"注册"}),(0,p.BX)(T.ZP,(0,l._)((0,u._)({className:"AppAuthentication-button",onClick:this.handleSignIn},E.Z.isMobileEntry?{color:"blue",preset:"primary"}:{}),{children:[E.Z.isMobileEntry?"注册或":"","登录"]}))]})})}}]),n}(m.Component);n(84954);var S=n(14168),I=n.n(S),A=function(e){(0,s._)(n,e);var t=(0,d._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return(0,a._)(n,[{key:"render",value:function(){var e=this.context.handleBindPhoneModalToggle;return(0,p.tZ)(T.ZP,{css:{display:"inline-block",border:"none"},preset:"link",onClick:e,children:"激活账号"})}}]),n}(m.Component);(0,c._)(A,"contextTypes",{handleBindPhoneModalToggle:I().func});var b=n(50373),w=function(){return Promise.resolve().then(n.bind(n,69140))},Z=function(e){(0,s._)(n,e);var t=(0,d._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return(0,a._)(n,[{key:"render",value:function(){return(0,p.tZ)(b.Z,(0,u._)({getComponent:w},this.props))}}]),n}(m.Component),x=n(72925)},71670:function(e,t,n){"use strict";n.d(t,{h:function(){return u},l:function(){return l}});var r=n(85879),o=n(87363),i=n(88329),a=n.n(i),c=function(e){return console.error("该组件没有设置 LoginV2ContextProvider，使用的是默认 Context value。"),e},s=(0,o.createContext)({get captchaNeeded(){return c(!1)},get captchaV2(){return c(void 0)},get captchaV2Ref(){return c({current:null})},get continueActionRef(){return c({current:null})},get handleChange(){return c(a())},get handleChangeType(){return c(a())},get handleSendDigits(){return c(a())},get selectClassName(){return c("")},get setState(){return c(a())},get testPhoneNo(){return c(a())}}),u=function(){return(0,o.useContext)(s)},l=function(e){var t=e.handleChangeType,n=e.setState,i=e.handleChange,a=e.testPhoneNo,c=e.handleSendDigits,u=e.continueActionRef,l=e.captchaV2Ref,d=e.captchaNeeded,p=e.selectClassName,f=e.captchaV2,h=e.children,_=(0,o.useMemo)(function(){return{handleChangeType:t,handleChange:i,testPhoneNo:a,handleSendDigits:c,selectClassName:p,setState:n,continueActionRef:u,captchaV2Ref:l,captchaNeeded:d,captchaV2:f}},[t,i,a,c,p,n,u,l,d,f]);return(0,r.tZ)(s.Provider,{value:_,children:h})}},71981:function(e,t,n){"use strict";var r=n(55164),o=n(57477),i=n(71728),a=n(85879),c=n(1733),s=n(16e3);t.Z=function(e){var t=e.checked,n=e.children,u=(0,i._)(e,["checked","children"]);return(0,a.BX)(c.sN,(0,o._)((0,r._)({},u),{children:[(0,a.tZ)("span",{css:{display:"inline-block",width:24,marginLeft:-24},children:t&&(0,a.tZ)(s.Y,{text:!0,center:!0})}),n]}))}},45790:function(e,t,n){"use strict";n.d(t,{x:function(){return c}});var r=n(85879),o=n(30473),i=n(87363),a=n(37630),c=function(e){var t=e.children;return(0,r.tZ)(r.HY,{children:i.Children.toArray(t).filter(function(e){return(0,o.D)(e)&&"boolean"!=typeof e&&""!==e}).map(function(e,t){return(0,r.BX)(i.Fragment,{children:[t>0&&a.Y,e]},t)})})}},14804:function(e,t,n){"use strict";n.d(t,{C:function(){return r}});var r=function(e){return(0,e.children)()}},62880:function(e,t,n){"use strict";n.d(t,{Yi:function(){return u},dh:function(){return l}});var r=n(79065),o=n(85879),i=n(41402);n(87363);var a=n(92258);function c(){var e=(0,r._)(["\n        height: constant(safe-area-inset-top);\n        height: env(safe-area-inset-top);\n        ","\n      "]);return c=function(){return e},e}function s(){var e=(0,r._)(["\n        height: constant(safe-area-inset-bottom);\n        height: env(safe-area-inset-bottom);\n        ","\n      "]);return s=function(){return e},e}var u=function(e){var t=e.minHeight,n=(0,a.useSelector)(function(e){return e.env.conf.xSafeAreaInsetTop});return(0,o.tZ)("div",{css:(0,i.iv)(c(),n?"height: ".concat(n,"px;"):""),style:{minHeight:t}})},l=function(e){var t=e.minHeight,n=(0,a.useSelector)(function(e){return e.env.conf.xSafeAreaInsetBottom});return(0,o.tZ)("div",{css:(0,i.iv)(s(),n?"height: ".concat(n,"px;"):""),style:{minHeight:t}})}},88257:function(e,t,n){"use strict";var r=n(85879),o=n(39658),i=n(63638);t.Z=function(e){var t=e.pageInfo,n=e.pageOptions;return(0,i.usePageInfo)(t,n),(0,r.tZ)(o.ql,{children:(0,r.tZ)("meta",{name:"za-config",content:JSON.stringify(t)})})}},1606:function(e,t,n){"use strict";n.d(t,{Ib:function(){return T}});var r=n(55164),o=n(57477),i=n(94009),a=n(85879),c=n(91850),s=n(38151),u=n(65733),l=n(84871),d=n.n(l),p=n(87363),f=n(63638),h=function(e){return void 0!==e},_=function(){if(h(document.visibilityState));else if(h(document.webkitVisibilityState))return"webkit";else if(h(document.mozVisibilityState))return"moz";return""},m=function(e){var t=_(),n="".concat(t,"visibilitychange"),r="".concat(t).concat(t?"V":"v","isibilityState"),o=function(){e(document[r])};return document.addEventListener(n,o),function(){return document.removeEventListener(n,o)}},g=function(e){var t=e.children,n=e.index,r=e.itemComponentProps.onToggleExpand,o=(0,i._)((0,c.k)(!1),2),l=o[0],d=o[1],h=(0,i._)((0,s.Y)(),2),_=h[0],g=h[1],T=(0,p.useRef)(0),E=(0,f.useTracker)().UNSAFE_trackEventWithoutDyeing,y=(0,u.A)(function(){g&&l&&(T.current=Date.now())}),C=(0,u.A)(function(){if(0!==T.current){var e=Date.now()-T.current;T.current=0,E({action:"ModuleDisappear",elementLocation:{type:"Card",moduleId:"content_card",moduleIndex:n}},{configMap:{module_duration:String(e)}})}}),S=(0,u.A)(function(e){null==r||r(e),e&&!l?d.on():!e&&l&&d.off()});(0,p.useEffect)(function(){if(0===T.current){y();return}(g&&!l||!g&&l)&&C()},[C,y,g,l]);var I=(0,u.A)(function(){g&&l&&C()});(0,p.useEffect)(function(){return I},[I]);var A=(0,u.A)(function(){y()}),b=(0,u.A)(function(){l&&C()}),w=(0,u.A)(function(e){"hidden"===e?b():"visible"===e&&A()});return(0,p.useEffect)(function(){var e=m(w);return window.addEventListener("blur",b),window.addEventListener("focus",A),function(){e(),window.removeEventListener("blur",b),window.removeEventListener("focus",A)}},[]),(0,a.tZ)("div",{ref:_,children:(0,p.cloneElement)(t,{onToggleExpand:S})})},T=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){return d()(function(i){var c=i.zaInfos,s=void 0===c?{}:c,u=i.shouldTrackReadDuration,l=i.index;return(0,a.tZ)(f.ZAEnv,(0,o._)((0,r._)({},"function"==typeof e?e(i):e),{children:(0,a.tZ)(f.ZAEvent,(0,o._)((0,r._)({zaType:"Card"},void 0!==s.index&&{view:{elementLocation:{card:{index:Number(s.index)}}}}),{zaModuleId:s.moduleId,zaModuleIndex:s.moduleIndex,zaBlock:(null==t?void 0:t.block)||s.block,shouldTrackClick:s.shouldTrackClick,shouldTrackShow:!0,children:void 0!==u&&u?(0,a.tZ)(g,{itemComponentProps:i,index:l||(null==s?void 0:s.index),children:(0,a.tZ)(n,(0,r._)({},i))}):(0,a.tZ)(n,(0,r._)({},i))}))}))},n)}}},30170:function(e,t,n){"use strict";e.exports=n.p+"assets/background_blue.970aad09.svg"},93029:function(e,t,n){"use strict";e.exports=n.p+"assets/liukanshan_paper.6d897558.svg"},92258:function(e,t,n){e.exports=n(28470)(2450)},55536:function(e,t,n){e.exports=n(28470)(4944)},37237:function(e,t,n){e.exports=n(28470)(6079)},14914:function(e,t,n){e.exports=n(28470)(7094)},87363:function(e){"use strict";e.exports=React},61533:function(e){"use strict";e.exports=ReactDOM},37831:function(e){"use strict";e.exports=ReactDOMServer},28470:function(e){"use strict";e.exports=vendor_0a4b7e6075d4524d4cc2},12787:function(){},64824:function(){}},function(e){e.O(0,[6754,2850,8885,3550,4260,7749,5546,887,7050,1160],function(){return e(e.s=31504)}),e.O()}]);
//# sourceMappingURL=column.app.d14b184a39485093d426.js.map